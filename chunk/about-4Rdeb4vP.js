import{useNetwork as Z,useSystemBack as Y,useViewModel as D,observeState as L,xcsApp as i,CheckAppVersionEvent as ee,SetAutoUpdateDeviceExtEvent as te,OpenSafetyUrlEvent as oe,OpenPrivacyUrlEvent as le,OpenTermsUrlEvent as ae,OpenAppUpdateUrlEvent as ne,__unplugin_components_0 as se,_export_sfc as ie}from"./main-f7BGirYr.js";import{WifiViewModel as ce,CheckIsWifiOpenEvent as re}from"./wifiviewmodel-2Do6mA4t.js";import"../assets/index-FfF0Lcw0.js";import{SettingViewModel as ue}from"./settingviewmodel-IPUaoc4k.js";import{useI18n as pe}from"./importmap-vue-i18n-LlhaB8iP.js";import{useRouter as de}from"./importmap-vue-router-aHGpzyJi.js";import{defineComponent as me,watch as _e,ref as u,computed as S,onMounted as ve,onUnmounted as fe,openBlock as c,createElementBlock as d,createVNode as m,withCtx as _,unref as w,Fragment as T,createBaseVNode as n,toDisplayString as v,createCommentVNode as be,renderList as B,createBlock as U,normalizeClass as he}from"./importmap-vue-u6Q_1Jji.js";import{NavBar as we,Space as Oe,Switch as ge,Cell as ke,CellGroup as Ve}from"./importmap-vant-Ij4SMMwJ.js";var l=(o=>(o[o.VERSION=0]="VERSION",o[o.AUTO_UPDATE=1]="AUTO_UPDATE",o[o.PROTOCOL_USER=2]="PROTOCOL_USER",o[o.PROTOCOL_PRIVACY=3]="PROTOCOL_PRIVACY",o[o.CONTACT=4]="CONTACT",o[o.SAFE=5]="SAFE",o))(l||{});const Ae={class:"app-name"},Se={key:0,class:"app-version"},Te={class:"software-content"},Ue={class:"fl"},Ce={key:0,class:"flex"},Re={class:"main-bottom"},xe={class:"copyright-info"},ye={class:"copyright-info"},Ie=1e3,Ee=me({__name:"About",setup(o){const f=Z().isOnline,O=de(),{t}=pe();_e(()=>f.value,e=>{e||i.modal.showToast({msg:t("mobile.common.check_update_fail"),uniqueId:"app_upload_error",icon:"error"})}),Y(()=>(O.back(),!0));const C=u("xTool Creative Space"),g=u(!1),R=S(()=>a.uiState.autoCheckExtUpdate),x=S(()=>a.uiState.currentAppVersion),k=u(""),r=u(""),a=D(ue),y=D(ce),b=u(null);let h=0,V=null;const F=u();let M="20230525";const P=()=>{h++,h>=5&&i.modal.showRenameModal({name:F.value,title:t("mobile.connect.placeholder_password"),inputType:"password",confirmTxt:t("common.msg.ok"),maxLength:8,onConfirm:e=>{e===M?(O.push({path:"/local-debugg"}),clearTimeout(V),h=0):i.modal.showToast({msg:"密码错误",icon:"error",duration:3e3})}}),V=setTimeout(()=>{clearTimeout(V),h=0},Ie)};L(()=>a.uiState.checkUpdateResult,e=>{e&&e.latestVersion?(k.value=t("mobile.about.need_update"),r.value=e.latestVersion,g.value=!0,e.downloadUrl[0]):(k.value=t("mobile.about.not_update"),r.value="latest",g.value=!1)});const W=S(()=>[[{label:l.VERSION,title:t("mobile.common.app_version"),des:"",value:r.value==="latest"||!r.value?"":`v${r.value}`,description:f.value?k.value:""},{label:l.AUTO_UPDATE,title:t("setting.auto_update_device_ext"),des:"",description:""}],[{label:l.PROTOCOL_USER,title:t("mobile.about.protocol_user"),des:"",description:""},{label:l.PROTOCOL_PRIVACY,title:t("mobile.about.privacy_policy"),des:"",description:""},{label:l.SAFE,title:t("mobile.about.safe_privacy"),des:"",description:""}]]);function q(e){a.sendEvent(new te(e))}const z=()=>{a.sendEvent(new ee(!1))};ve(()=>{f.value||i.modal.showToast({msg:t("mobile.common.check_update_fail"),uniqueId:"app_upload_error",icon:"error"}),z()});const $=e=>{switch(e){case l.VERSION:G();break;case l.PROTOCOL_USER:a.sendEvent(new ae);break;case l.PROTOCOL_PRIVACY:a.sendEvent(new le);break;case l.SAFE:a.sendEvent(new oe);break}},I=u(1),G=async()=>{let e=!0;try{await y.sendEvent(new re),e=y.uiState.isWifiOpen,g.value?a.sendEvent(new ne):(I.value>0&&!r.value&&e&&(i.modal.showToast({msg:t("mobile.common.check_for_updates"),duration:400}),I.value--),b.value=setTimeout(()=>{r.value&&f.value?i.modal.showToast({msg:t("mobile.common.app_latest"),uniqueId:"app_latest_version"}):e||i.modal.showToast({msg:t("mobile.common.check_update_fail"),uniqueId:"app_upload_error",icon:"error"})},400))}catch(p){console.error(p),i.modal.showToast({msg:t("mobile.common.check_update_fail"),uniqueId:"app_upload_error",icon:"error"})}};return fe(()=>{clearInterval(b==null?void 0:b.value)}),(e,p)=>{const A=se,j=we,H=ge,J=ke,K=Ve,Q=Oe;return c(),d(T,null,[m(j,{fixed:"",placeholder:"",title:w(t)("mobile.common.about_software")},{left:_(()=>[m(A,{name:"arrow_left",size:"24px",class:"f-s-24 arrow_left",onClick:p[0]||(p[0]=E=>w(O).back())})]),_:1},8,["title"]),m(Q,{direction:"vertical",fill:"",class:"content-wrap"},{default:_(()=>[n("section",null,[n("div",{class:"software-info",onClick:P},[m(A,{class:"f-s-60 app-logo",name:"user-setting-xTool-logo",size:"60px"}),n("div",Ae,v(C.value),1),x.value?(c(),d("div",Se,v(`v${x.value}`),1)):be("",!0)])]),n("section",Te,[(c(!0),d(T,null,B(W.value,(E,X)=>(c(),U(K,{key:X,border:!1,inset:"",class:"about-cell-group"},{default:_(()=>[(c(!0),d(T,null,B(E,s=>(c(),U(J,{key:s.label,class:"about-cell",title:s.title,label:s.description,center:"",value:s.value,"title-class":"title-class","label-class":"label-class","value-class":"right-cell",onClick:N=>$(s.label)},{title:_(()=>[n("div",{class:he(["custom-cell-title",s.description?"cell-description":"label-none"])},[n("span",Ue,v(s.title),1)],2)]),"right-icon":_(()=>[s.label===w(l).AUTO_UPDATE?(c(),d("div",Ce,[m(H,{modelValue:R.value,"onUpdate:modelValue":p[1]||(p[1]=N=>R.value=N),"active-color":"#28BE44",class:"mk-switch",onChange:q},null,8,["modelValue"])])):(c(),U(A,{key:1,class:"arrow_right f-s-22",name:"arrow_right",size:"22px"}))]),_:2},1032,["title","label","value","onClick"]))),128))]),_:2},1024))),128))]),n("div",Re,[n("div",xe,v(C.value),1),n("div",ye,v(w(t)("setting.copyright",{previousYear:new Date().getFullYear()-1,year:new Date().getFullYear()})),1)])]),_:1})],64)}}}),$e=ie(Ee,[["__scopeId","data-v-d9b1cbf0"]]);export{$e as default};
