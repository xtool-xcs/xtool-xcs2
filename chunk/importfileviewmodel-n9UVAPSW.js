import{BaseViewModel as h,sensorsTrack as a,ButtonNames as o,EventNames as n,xcsApp as p,AppType as f,importFileManager as y,loaderMap as u}from"./main-f7BGirYr.js";class w{constructor(e){this.type=e}}class P extends h{createState(){return{showLoading:!1}}setEventHandler(){this.registerEventHandler(w,this.handleImportFile)}async handleImportFile(e){var s;if(e.type===0?a(n.addProjectClick,{elementId:o.camera}):e.type===1?a(n.addProjectClick,{elementId:o.image}):e.type===2?a(n.addProjectClick,{elementId:o.file}):e.type===4&&a(n.addProjectClick,{elementId:o.xcsFile}),e.type===0&&!await this.hasCameraPermission()){const i=p.appType===f.App;await p.modal.showConfirmDialog({title:i?"mobile.toast.camera_not_authorized":"ipad.editor.camera_title",msg:i?"mobile.toast.camera_not_authorized_text":"ipad.editor.camera_content",confirmButtonText:"ipad.editor.go_system_setting",cancelButtonText:"ipad.editor.know"})&&((s=window.MeApi)==null||s.permission.openAppPermissionPage());return}y.selectFileByType(e.type).then(async t=>{if(t){const i=Object.keys(u),r=(t.split(".").pop()||"").toLowerCase(),m=e.type===3&&!t.endsWith(".xcs"),d=e.type===2&&!i.includes(r),l=e.type===4&&!t.endsWith(".xcs")&&!i.includes(r);m||d||l?p.modal.showToast({msg:"mobile.projects.not_support_import_file"}):(this.updateState({showLoading:!0}),this.sendEffect({importSuccess:{filePath:t}}))}}).finally(()=>{this.updateState({showLoading:!1})})}async hasCameraPermission(){var s;const e=await((s=window.MeApi)==null?void 0:s.permission.grantCameraPermission());return e==="undefined"?!1:e}}export{w as ImportFileEvent,P as ImportFileViewModel};
