var Uee=Object.defineProperty;var Gee=(n,e,t)=>e in n?Uee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var E=(n,e,t)=>(Gee(n,typeof e!="symbol"?e+"":e,t),t),QI=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var S=(n,e,t)=>(QI(n,e,"read from private field"),t?t.call(n):e.get(n)),ke=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Qe=(n,e,t,i)=>(QI(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var XI=(n,e,t,i)=>({set _(r){Qe(n,e,r,t)},get _(){return S(n,e,i)}}),Ht=(n,e,t)=>(QI(n,e,"access private method"),t);import{MBService_2 as hl,gLinkGlobal as hv,isNativeEnvironment_1 as e6,fileHelper as Hee,commonjsGlobal as un,getAugmentedNamespace as iO,getDefaultExportFromCjs as Ld,__vitePreload as Pi,path as t6,lodashExports as Wv}from"../assets/index-FfF0Lcw0.js";import{ref as ee,getCurrentScope as n6,onScopeDispose as i6,unref as Be,computed as te,toRef as ri,readonly as kp,customRef as Vee,watch as yt,getCurrentInstance as jv,onMounted as Zn,defineComponent as Fe,onUpdated as zee,isVNode as r6,shallowReactive as QP,EffectScope as pT,reactive as qr,effectScope as rO,markRaw as s6,hasInjectionContext as $ee,inject as Er,isRef as Td,isReactive as sO,toRaw as Uu,nextTick as Yi,toRefs as o6,onBeforeUnmount as qo,createVNode as ye,render as kN,openBlock as V,createElementBlock as le,createBaseVNode as ue,mergeProps as ht,createBlock as Ie,withCtx as be,createCommentVNode as $e,renderSlot as Fs,toDisplayString as Te,createSlots as Pr,normalizeStyle as On,createTextVNode as Gt,Fragment as vt,renderList as Fn,onUnmounted as L0,resolveDynamicComponent as Uo,normalizeClass as St,withDirectives as tg,withModifiers as dr,normalizeProps as jo,guardReactiveProps as ch,Comment as gT,provide as ju,h as Ue,Teleport as Wee,onActivated as a6,onDeactivated as l6,onBeforeMount as oO,shallowRef as jee,watchEffect as Qv,Transition as dv,vShow as c6,cloneVNode as Qee,Text as Xee,useAttrs as mT,pushScopeId as u6,popScopeId as h6,resolveDirective as Yee,createApp as d6,resolveComponent as XP,defineAsyncComponent as qee,createStaticVNode as Kee,TransitionGroup as Jee}from"./importmap-vue-u6Q_1Jji.js";import{useRoute as N0,useRouter as B0,createRouter as Zee,createWebHashHistory as ete}from"./importmap-vue-router-aHGpzyJi.js";import{createI18n as tte,useI18n as Yt}from"./importmap-vue-i18n-LlhaB8iP.js";import{showToast as aO,Popup as Ko,Image as ng,Button as Hi,Dialog as F0,Toast as nte,Field as Jo,Cell as Oi,NumberKeyboard as f6,Loading as ite,Picker as lO,Space as Gs,Radio as U0,RadioGroup as vT,showConfirmDialog as p6,Slider as ig,Switch as G0,Col as rte,Row as ste,Tab as cO,Tabs as uO,Checkbox as _T,CheckboxGroup as g6,DropdownMenu as m6,Uploader as v6,Divider as hO,CellGroup as ote,ActionSheet as ate,showDialog as ON,NavBar as lte,Circle as cte,FloatingBubble as ute,ConfigProvider as hte,stdin_default as dte}from"./importmap-vant-Ij4SMMwJ.js";class fte extends hl{processEvent(e){}appContentId(){return this.request("appContentId",[],5e3)}getOsPlatform(){return this.request("getOsPlatform",[],5e3)}updateAppVersion(e){return this.request("updateAppVersion",[e],5e3)}getAppVersion(){return this.request("getAppVersion",[],2e3)}getAppBuildVersion(){return this.request("getAppBuildVersion",[],2e3)}openBrowser(e){return this.request("openBrowser",[e],1e3)}exit(){return this.request("exit",[],5e3)}getFetchFileHost(){return this.request("getFetchFileHost",[],5e3)}pagePathChange(e){return this.request("pagePathChange",[e],5e3)}setStatusBar(e,t){return this.request("setStatusBar",[e,t],5e3)}reloadData(){return this.request("reloadData",[],5e3)}getAppFilePath(){return this.request("getAppFilePath",[],5e3)}url2InterceptorUrl(e){return this.request("url2InterceptorUrl",[e],5e3)}}class pte extends hl{processEvent(e){throw new Error("Method not implemented.")}getAllSensorEventInfo(){return this.request("getAllSensorEventInfo",{},5e3)}insertSensorEventInfo(e){return this.request("insertSensorEventInfo",{info:e},5e3)}deleteAllSensorEventInfo(){return this.request("deleteAllSensorEventInfo",{},5e3)}}class gte extends hl{constructor(){super(...arguments);E(this,"_events",{})}processEvent(t){}on(t,i){return this._events[t]||(this._events[t]=[]),this._events[t].push(i),this}emit(t,...i){const r=this._events[t];for(const s of r)s(...i);return this}off(t,i){if(i)return this._events[t]&&(this._events[t]=this._events[t].filter(r=>i!==r)),this}once(t,i){let r=(...s)=>{i.apply(this,...s),this.off(t,r)};return r=r.bind(this),this.on(t,r),this}}class mte extends gte{dispose(){if(hv.isBrowser())return!0;this.request("dispose",[],5e3)}async list(e){await this.request("listenTcp",[20001],5e3),console.log(`--- list: ${e}`);const t=["224.0.1.77",2e4];this.request("sendUdpData",t,3e4)}async ip(){return this.request("getLocalIp",{},5e3)}processEvent(e){if(e.eventName==="listenTcp"){console.log("receiver emit");const t={ip:e.data,type:"UDP"};this.emit("receiver",t);return}else if(e.eventName==="sendUdpData"){const t=JSON.parse(e.data);this.emit("receiver",t)}}}class vte extends hl{processEvent(e){}getFontPaths(){return this.request("getFontPaths",hv.gLinkFetchHost===""?[]:[hv.gLinkFetchHost],15e3)}}class _te extends hl{processEvent(e){throw new Error("Method not implemented.")}async imageOptimize(e){return this.request("imageOptimize",[e],15e3)}}function yte(){let n,e;return function(){n=[],e={};const i=window.location.search.substr(1);if(i!==""){const r=i.split("&");for(let s=0,o=r.length;s<o;s++)if(r[s]!==""){const a=r[s].split("=");a.length===1||a.length===2&&a[1]===""?(n.push([""]),e[a[0]]=n.length-1):typeof a[0]>"u"||a[0]===""||(typeof e[a[0]]>"u"?(n.push([a[1]]),e[a[0]]=n.length-1):n[e[a[0]]].push(a[1]))}}}(),{param:t=>{try{return typeof t=="number"?n[t][0]:n[e[t]][0]}catch{}},paramValues:t=>{try{return typeof t=="number"?n[t]:n[e[t]]}catch{}},hasParam:t=>typeof t=="string"?typeof e[t]<"u":!1,paramMap:()=>{const t={};try{for(const i in e)t[i]=n[e[i]]}catch{}return t}}}class Ate extends hl{constructor(){super(...arguments);E(this,"fileHandler");E(this,"shareFile");E(this,"dataHandler")}processEvent(t){}setOpenFileHandle(t){this.fileHandler=t}callOpenFileHandler(t){const{filePath:i,newProject:r}=t;console.log(`callOpenFileHandler filePath:${i}`),this.fileHandler(i,!!(r??!0))}setOpenDataHandle(t){this.dataHandler=t}callOpenDataHandle(t){console.log(`callOpenDataHandle data =======> ${t}`),this.dataHandler(t)}getFile(){return console.log(`fileUrl:${this.shareFile}`),this.shareFile}setFile(t){this.shareFile=t}parseOpenFilePath(){const t=yte();t.param("fileUrl")!==void 0?this.shareFile=decodeURIComponent(t.param("fileUrl")):this.shareFile=""}}class bte extends hl{processEvent(e){throw new Error("Method not implemented.")}async size(){return this.request("size",[],5e3)}async path(){return this.request("path",[],5e3)}switchLevel(e){return this.request("switchLevel",[e],0)}clear(){return this.request("clear",[],0)}openLog(){return this.request("openLog",[1],0)}emit(e,t,...i){if(t==="error")return this.request("emitLog",[e,t,i],0)}}class wte extends hl{constructor(){super(...arguments);E(this,"nativeStorageData",{})}processEvent(t){throw new Error("Method not implemented.")}openSafari(t){var i,r,s;(s=(r=(i=window.webkit)==null?void 0:i.messageHandlers)==null?void 0:r.openNativeAction)==null||s.postMessage({method:"openUrl",url:t})}shareFile(t){var i,r,s;(s=(r=(i=window.webkit)==null?void 0:i.messageHandlers)==null?void 0:r.openNativeAction)==null||s.postMessage({method:"shareFile",url:t})}needBackgroundTask(t){var i,r,s;(s=(r=(i=window.webkit)==null?void 0:i.messageHandlers)==null?void 0:r.openNativeAction)==null||s.postMessage({method:"needBackgroundTask",isNeed:t})}deviceWarning(t){var i,r,s;(s=(r=(i=window.webkit)==null?void 0:i.messageHandlers)==null?void 0:r.openNativeAction)==null||s.postMessage({method:"deviceWarning",isWarning:t})}mainWindowLoaded(){var t,i,r,s;(t=window.LinkNative)==null||t.mainWindowLoaded(),(s=(r=(i=window.webkit)==null?void 0:i.messageHandlers)==null?void 0:r.openNativeAction)==null||s.postMessage({method:"mainWindowLoaded"})}print(t,i,r){return this.request("print",[t,i,r],15e4)}hookLocalStorage(){var r,s;if(!(((s=(r=window.webkit)==null?void 0:r.messageHandlers)==null?void 0:s.LinkNative)!==void 0))return;this.nativeStorageData=window.nativeStorageData;const i=(o=>{const a=o.localStorage,l=this;return{setItem:(c,u)=>{l.nativeSetItem(c,u),a.setItem(c,u)},getItem:c=>{var d;const u=a.getItem(c);if(u!==null&&typeof u<"u")return u;const h=(d=l.nativeStorageData)==null?void 0:d[c];return h!==null&&typeof h<"u"?(a.setItem(c,h),h):u},removeItem:c=>{l.nativeRemoveItem(c),a.removeItem(c)},clear:()=>{l.nativeClear(),a.clear()},key:c=>a.key(c)}})(window);Object.defineProperty(window,"localStorage",{value:i,writable:!0})}async nativeSetItem(t,i){const r=new Object;return r[t]=i,this.nativeStorageData&&(this.nativeStorageData[t]=i),this.request("nativeSetItem",[r],5e3)}nativeRemoveItem(t){var i;return(i=this.nativeStorageData)==null||delete i[t],this.request("nativeRemoveItem",[t],5e3)}nativeClear(){return this.nativeStorageData={},this.request("nativeClear",[],5e3)}takePicture(t,i,r,s,o,a=[],l=""){return this.request("takePicture",[t,i,r,s,o,a,l],60*60*1e3)}correctPicture(t,i,r,s,o,a=[],l=""){return this.request("correctPicture",[t,i,r,s,o,a,l],60*60*1e3)}updateLanguageType(t){return this.request("updateLanguageType",[t],5e3)}isNetConnection(){return this.request("isNetConnection",[],5e3)}openWebInApp(t){return this.request("openWebInApp",[t],5e3)}async isAllowReviews(){return await this.request("isAllowReviews",[],5e3)}showAppReviews(){return this.request("showAppReviews",[],5e3)}async pasteboardHaveContent(){return this.request("pasteboardHaveContent",[],2e3)}async copyToPasteboard(t){return this.request("copyToPasteboard",[t],60*60*1e3)}async pasteFromPasteboard(){return this.request("pasteFromPasteboard",[],60*60*1e3)}async generateImpactFeedback(){return this.request("generateImpactFeedback",[],5e3)}}class xte extends hl{constructor(){super(...arguments);E(this,"pingHeartCheckInfo",new Map)}processEvent(t){if(t.eventName==="pingHeartCheck"){const i=t.data[0];this.pingHeartTimeOut(i)}}async pingOnceCheck(t,i){return console.log("pingOnceCheck---",t,i),!0}pingHeartKillPorcess(t){console.log(`pingHeartStop -> ${t}`),this.request("pingHeartStop",[t],3e3)}pingHeartTimeOut(t){if(hv.isBrowser())return;const i=this.pingHeartCheckInfo.get(t);typeof i<"u"&&i()}pingHeartCheck(t,i,r){return this.pingHeartCheckInfo.set(t,i),this.request("pingHeartCheck",[t,r.maxCount,r.timeout],5e3),this.pingHeartKillPorcess.bind(this)}isIgnorePingResult(t,i){this.request("isIgnorePingResult",[t,i],5e3)}}const pl=6e5;class Cte extends hl{processEvent(e){}isLocationOpen(){return this.request("isLocationOpen",[],pl)}openLocationPage(){return this.request("openLocationPage",[],pl)}openAppPermissionPage(){return this.request("openAppPermissionPage",[],60*60*1e3)}isGrantedLocationPermission(){return this.request("isGrantedLocationPermission",[],pl)}isAccuracyLocationOpen(){return this.request("isAccuracyLocationOpen",[],pl)}grantLocationPermission(){return this.request("grantLocationPermission",[],pl)}isGrantedInternetPermission(){return this.request("isGrantedInternetPermission",[],pl)}grantInternetPermission(){return this.request("grantInternetPermission",[],pl)}isGrantedCameraPermission(){return console.log("------grantCameraPermission"),this.request("isGrantedCameraPermission",[],pl)}grantCameraPermission(){return console.log("----grantCameraPermission"),this.request("grantCameraPermission",[],pl)}isGrantedPhotoPermission(){return console.log("------isGrantedPhotoPermission"),this.request("isGrantedPhotoPermission",[],pl)}grantPhotoPermission(){return console.log("----grantPhotoPermission"),this.request("grantPhotoPermission",[],pl)}}class Ete extends hl{processEvent(e){}correct_M1(e,t,i){return this.request("correct_M1",[e,t,i],15e3)}correct_P2(e,t,i,r,s,o){return this.request("correct_P2",[e,t,i,r,s,o],15e3)}measurement(e,t,i,r){return this.request("measurement",[e,t,i,r],15e3)}correct_p1(e,t,i,r,s){return this.request("correct_p1",[e,t,i||0,r,s],15e3)}apply_second_calib(e,t){return this.request("apply_second_calib",[e,t],3e4)}bitmap_dataToGray(e){return this.request("bitmap_dataToGray",[e],3e4)}bitmap_calDataWithMode(e,t,i,r,s=250){return this.request("bitmap_calDataWithMode",[e,t,i,r,s],3e4)}bitmap_resize(e,t,i,r,s){return this.request("bitmap_resize",[e,t,i,r,s],3e4)}bitmap_grayDataToImg(e,t,i){return this.request("bitmap_grayDataToImg",[e,t,i],3e4)}process_path(e,t){return this.request("process_path",[e,t],3e4)}calcuProcTime_file(e){const t=window.MeApi.fileHelper.getPath(e);return this.request("calcuProcTime_file",[t],3e5)}genGCode(e){const{inputDir:t,outputFile:i,funcName:r="genGCodeSync",manifestName:s="manifest.json",toolType:o=1}=e,a=`${window.MeApi.appDataPath}/`;return this.request("genGCode",[a+t,a+i,r,s,o],6e5)}activeGcodeGenerate(){return"success"}killGcodeGenerate(){return this.request("genGCodeCancel",[],15e3)}svgJsonToPng(e){return this.request("svgJsonToPng",[e.svgJsonPath,e.pngDir],3e4)}estimatedTime(e){const{inputDir:t,type:i,workingType:r=0}=e;return this.request("estimatedTime",[t,i,r],3e5)}genGcodeToPoints(e){return this.request("genGcodeToPoints",[e],3e5)}genGcodeToImage(e,t,i){const r=window.MeApi.fileHelper.getPath(e);return this.request("genGcodeToImage",[r,t,i],3e5)}cancelGcodeToImage(){return this.request("cancelGcodeToImage",[],1e4)}correctImage({imagePath:e,jsonPath:t,calibPath:i}){const r=`${window.MeApi.appDataPath}/`,s={srcImagePath:r+e,dstImagePath:r+i,calibJsonPath:r+t};return this.request("correct_gs002",[s.srcImagePath,s.dstImagePath,s.calibJsonPath],6e4)}gs002CoincideMeasure({urlIp:e}){const t=e;return this.request("gs002CoincideMeasure",[t],3e5)}gs002Measure({measurePath:e,irJsonPata:t,floatGX:i,floatGY:r}){const s=`${window.MeApi.appDataPath}/`,o={srcImagePath:s+e,globalIRData:s+t,GX:i,GY:r};return this.request("measurement_gs002",[o.srcImagePath,o.globalIRData,o.GX,o.GY],3e5)}svgToImage(e){const{svgFilename:t,imgW:i,imgH:r,pngFilename:s}=e;return this.request("svgToPngSync",[t,i,r,s],6e4)}}class Tte extends hl{processEvent(e){}isWifiOpen(){return this.request("isWifiOpen",[],5e3)}getWifiName(){return this.request("getWifiName",[],5e3)}openWifiPage(){return this.request("openWifiPage",[],5e3)}connectWifi(e,t){return this.request("connectWifi",[e,t],3e4)}getWifiList(){return this.request("getWifiList","",1e4)}}if(!e6){const{fetch:n}=window;window.fetch=async(...e)=>{const[t]=e;let i=t.toString();return console.log("tempResource",i),i.startsWith("xcsfetch://xcsfile/localhost/")||i.startsWith("xcsfetch://xcsfile")||i.startsWith("xcsfetch://xcsfilelocalhost/")?(i=i.replace("xcsfetch://xcsfile/localhost/",""),i=i.replace("xcsfetch://xcsfilelocalhost/",""),i=i.replace("xcsfetch://xcsfile",""),await n(`http://${window.serverIp}:12332/readfile?filePath=${i}`,{method:"post",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/octet-stream",Expires:"0","Cache-Control":"no-cache",Pragma:"no-cache"}})):n(...e)}}var hW,dW;window.MeApi={database:new pte("xcsDatabase"),discovery:new mte("xnet"),fileHelper:Hee,logger:new bte("xlog"),openFile:new Ate("open_file"),ping:new xte("xping"),image:new _te("ximage"),font:new vte("xfont"),openNative:new wte("xnative"),wifi:new Tte("xwifi"),permission:new Cte("xpermission"),app:new fte("xapp"),wasmKit:new Ete("xwasm"),appDataPath:window.appDataPath||((hW=window.LinkNative)==null?void 0:hW.getAPPHomePath()),version:window.appVersion||((dW=window.LinkNative)==null?void 0:dW.getAppVersion())||"",postMessageToMainHook:null,fontList:()=>[],imageOptimize:n=>window.MeApi.image.imageOptimize(n),getFontPaths:()=>window.MeApi.font.getFontPaths(),mainWindowLoaded:()=>{window.MeApi.openNative.mainWindowLoaded()},getAppVersion:()=>window.MeApi.app.getAppVersion(),getOsPlatform:()=>window.MeApi.app.getOsPlatform(),appContentId:()=>window.MeApi.app.appContentId(),updateAppVersion:async n=>await window.MeApi.app.updateAppVersion(n),getFetchFileHost:()=>hv.gLinkFetchHost,uploadGcode:async(n,e,t)=>{const{useFormData:i=!1,headCode:r="",tailCode:s="",onProgress:o=()=>{},onCancel:a=()=>{}}=t;return window.MeApi.fileHelper.uploadGcode(n,r,s,e,i,o,a,t.contentType)},uploadGcodeNew:async n=>(n.contentType="text/plain",window.MeApi.uploadGcode(n.url,n.path,n)),deviceService:{closeConnect:n=>{window.MeApi.postMessageToMain("closeConnect",n)}},postMessageToMain:(n,e)=>{if(window.MeApi.postMessageToMainHook)return window.MeApi.postMessageToMainHook(n,e)},setPostMessageToMainHook:n=>{window.MeApi.postMessageToMainHook=n}};window.MeApi.fs=window.MeApi.fileHelper;window.xcm=window.MeApi.wasmKit;window.MeApi.fileHelper.getAPPHomePath();window.MeApi.openFile.parseOpenFilePath();var fW,pW;(pW=(fW=window.MeApi)==null?void 0:fW.openNative)==null||pW.hookLocalStorage();window.VITE_APP=!0;window.VITE_PHONE=!0;window.ME={};var ZA;class Ite{constructor(){ke(this,ZA,void 0);E(this,"isShowFramingPane",ee(!1));E(this,"isShowProcessingPanel",ee(!1))}setAppContext(e){Qe(this,ZA,e)}get appContext(){return S(this,ZA)}}ZA=new WeakMap;const Ms=new Ite;let Ste=class{constructor(){E(this,"items",[])}push(e){this.items.push(e)}pop(){return this.isEmpty()?null:this.items.pop()}peek(){return this.isEmpty()?null:this.items[this.items.length-1]}isEmpty(){return this.items.length===0}clear(){this.items=[]}};class Op{static async isIphone(){return!window.LinkNative}static async isAndroid(){return!!window.LinkNative}static async isWifiOpen(){const e=await window.MeApi.wifi.isWifiOpen();return console.log("isWifiOpen: ",e),e}static async openWifiPage(){await window.MeApi.wifi.openWifiPage()}static openBrowser(e){var t,i;(i=(t=window.MeApi)==null?void 0:t.app)==null||i.openBrowser(e)}static async requestNetPermission(){return window.MeApi&&await Op.isIphone()?await window.MeApi.permission.grantInternetPermission():!0}static async hastNetPermission(){return window.MeApi&&await Op.isIphone()?await window.MeApi.permission.isGrantedInternetPermission():!0}static async ignorePing(e,t,i){return e=[nt.F1,nt.P2].includes(t)?!0:e,window.MeApi.ping.isIgnorePingResult(e,i)}}const Pte="identity_SN",H0=(n,e)=>{var t;(t=window.sensors)==null||t.track(n,e)},oft=n=>{H0("evokePassport",n)},Mte=n=>{var e;(e=window.sensors)==null||e.bind(Pte,n)};let ty=null;const YP=n=>{var e;if(n){const{power:t,name:i,snCode:r,type:s,version:o,showVersion:a="",id:l,standByTime:c,workTime:u,workTimes:h,taskTimes:d,taskTotal:f}=n;(e=window.sensors)==null||e.registerPage({deviceInfo:{power:t,connectType:s,extId:l,name:i,snCode:r,version:a||o.toString(),standByTime:c,workTime:u,workTimes:h||d||f}}),Mte(r??l),ty=n}},Rte=n=>{H0("exportGCode",{result:n.result,type:n.type})},YI=n=>{H0("updateFirmware",{result:n.result,type:n.type,currentVersion:n.currentVersion,latestVersion:n.latestVersion})},Dte=(n,e)=>{const t=ty,i=n&&(n==null?void 0:n.snCode)!==(ty==null?void 0:ty.snCode);i&&YP(n),e(),i&&YP(t)},aft=(n,e)=>{Dte(e,()=>{H0("processingResult",n)})},kte=n=>{H0("generateGCode",{gcodeSize:n.gcodeSize,timeUse:n.timeUse})};function _6(n,e){return function(){return n.apply(e,arguments)}}const{toString:Ote}=Object.prototype,{getPrototypeOf:dO}=Object,yT=(n=>e=>{const t=Ote.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Wc=n=>(n=n.toLowerCase(),e=>yT(e)===n),AT=n=>e=>typeof e===n,{isArray:Xv}=Array,Ky=AT("undefined");function Lte(n){return n!==null&&!Ky(n)&&n.constructor!==null&&!Ky(n.constructor)&&Ka(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const y6=Wc("ArrayBuffer");function Nte(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&y6(n.buffer),e}const Bte=AT("string"),Ka=AT("function"),A6=AT("number"),bT=n=>n!==null&&typeof n=="object",Fte=n=>n===!0||n===!1,Tx=n=>{if(yT(n)!=="object")return!1;const e=dO(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Ute=Wc("Date"),Gte=Wc("File"),Hte=Wc("Blob"),Vte=Wc("FileList"),zte=n=>bT(n)&&Ka(n.pipe),$te=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Ka(n.append)&&((e=yT(n))==="formdata"||e==="object"&&Ka(n.toString)&&n.toString()==="[object FormData]"))},Wte=Wc("URLSearchParams"),jte=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function V0(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,r;if(typeof n!="object"&&(n=[n]),Xv(n))for(i=0,r=n.length;i<r;i++)e.call(null,n[i],i,n);else{const s=t?Object.getOwnPropertyNames(n):Object.keys(n),o=s.length;let a;for(i=0;i<o;i++)a=s[i],e.call(null,n[a],a,n)}}function b6(n,e){e=e.toLowerCase();const t=Object.keys(n);let i=t.length,r;for(;i-- >0;)if(r=t[i],e===r.toLowerCase())return r;return null}const w6=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,x6=n=>!Ky(n)&&n!==w6;function qP(){const{caseless:n}=x6(this)&&this||{},e={},t=(i,r)=>{const s=n&&b6(e,r)||r;Tx(e[s])&&Tx(i)?e[s]=qP(e[s],i):Tx(i)?e[s]=qP({},i):Xv(i)?e[s]=i.slice():e[s]=i};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&V0(arguments[i],t);return e}const Qte=(n,e,t,{allOwnKeys:i}={})=>(V0(e,(r,s)=>{t&&Ka(r)?n[s]=_6(r,t):n[s]=r},{allOwnKeys:i}),n),Xte=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Yte=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},qte=(n,e,t,i)=>{let r,s,o;const a={};if(e=e||{},n==null)return e;do{for(r=Object.getOwnPropertyNames(n),s=r.length;s-- >0;)o=r[s],(!i||i(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&dO(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},Kte=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},Jte=n=>{if(!n)return null;if(Xv(n))return n;let e=n.length;if(!A6(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},Zte=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&dO(Uint8Array)),ene=(n,e)=>{const i=(n&&n[Symbol.iterator]).call(n);let r;for(;(r=i.next())&&!r.done;){const s=r.value;e.call(n,s[0],s[1])}},tne=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},nne=Wc("HTMLFormElement"),ine=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,r){return i.toUpperCase()+r}),LN=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),rne=Wc("RegExp"),C6=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};V0(t,(r,s)=>{let o;(o=e(r,s,n))!==!1&&(i[s]=o||r)}),Object.defineProperties(n,i)},sne=n=>{C6(n,(e,t)=>{if(Ka(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(Ka(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},one=(n,e)=>{const t={},i=r=>{r.forEach(s=>{t[s]=!0})};return Xv(n)?i(n):i(String(n).split(e)),t},ane=()=>{},lne=(n,e)=>(n=+n,Number.isFinite(n)?n:e),qI="abcdefghijklmnopqrstuvwxyz",NN="0123456789",E6={DIGIT:NN,ALPHA:qI,ALPHA_DIGIT:qI+qI.toUpperCase()+NN},cne=(n=16,e=E6.ALPHA_DIGIT)=>{let t="";const{length:i}=e;for(;n--;)t+=e[Math.random()*i|0];return t};function une(n){return!!(n&&Ka(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const hne=n=>{const e=new Array(10),t=(i,r)=>{if(bT(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[r]=i;const s=Xv(i)?[]:{};return V0(i,(o,a)=>{const l=t(o,r+1);!Ky(l)&&(s[a]=l)}),e[r]=void 0,s}}return i};return t(n,0)},dne=Wc("AsyncFunction"),fne=n=>n&&(bT(n)||Ka(n))&&Ka(n.then)&&Ka(n.catch),st={isArray:Xv,isArrayBuffer:y6,isBuffer:Lte,isFormData:$te,isArrayBufferView:Nte,isString:Bte,isNumber:A6,isBoolean:Fte,isObject:bT,isPlainObject:Tx,isUndefined:Ky,isDate:Ute,isFile:Gte,isBlob:Hte,isRegExp:rne,isFunction:Ka,isStream:zte,isURLSearchParams:Wte,isTypedArray:Zte,isFileList:Vte,forEach:V0,merge:qP,extend:Qte,trim:jte,stripBOM:Xte,inherits:Yte,toFlatObject:qte,kindOf:yT,kindOfTest:Wc,endsWith:Kte,toArray:Jte,forEachEntry:ene,matchAll:tne,isHTMLForm:nne,hasOwnProperty:LN,hasOwnProp:LN,reduceDescriptors:C6,freezeMethods:sne,toObjectSet:one,toCamelCase:ine,noop:ane,toFiniteNumber:lne,findKey:b6,global:w6,isContextDefined:x6,ALPHABET:E6,generateString:cne,isSpecCompliantForm:une,toJSONObject:hne,isAsyncFn:dne,isThenable:fne};function zn(n,e,t,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),r&&(this.response=r)}st.inherits(zn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:st.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const T6=zn.prototype,I6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{I6[n]={value:n}});Object.defineProperties(zn,I6);Object.defineProperty(T6,"isAxiosError",{value:!0});zn.from=(n,e,t,i,r,s)=>{const o=Object.create(T6);return st.toFlatObject(n,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),zn.call(o,n.message,e,t,i,r),o.cause=n,o.name=n.name,s&&Object.assign(o,s),o};const pne=null;function KP(n){return st.isPlainObject(n)||st.isArray(n)}function S6(n){return st.endsWith(n,"[]")?n.slice(0,-2):n}function BN(n,e,t){return n?n.concat(e).map(function(r,s){return r=S6(r),!t&&s?"["+r+"]":r}).join(t?".":""):e}function gne(n){return st.isArray(n)&&!n.some(KP)}const mne=st.toFlatObject(st,{},null,function(e){return/^is[A-Z]/.test(e)});function wT(n,e,t){if(!st.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=st.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,m){return!st.isUndefined(m[g])});const i=t.metaTokens,r=t.visitor||u,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&st.isSpecCompliantForm(e);if(!st.isFunction(r))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(st.isDate(p))return p.toISOString();if(!l&&st.isBlob(p))throw new zn("Blob is not supported. Use a Buffer instead.");return st.isArrayBuffer(p)||st.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,g,m){let v=p;if(p&&!m&&typeof p=="object"){if(st.endsWith(g,"{}"))g=i?g:g.slice(0,-2),p=JSON.stringify(p);else if(st.isArray(p)&&gne(p)||(st.isFileList(p)||st.endsWith(g,"[]"))&&(v=st.toArray(p)))return g=S6(g),v.forEach(function(y,A){!(st.isUndefined(y)||y===null)&&e.append(o===!0?BN([g],A,s):o===null?g:g+"[]",c(y))}),!1}return KP(p)?!0:(e.append(BN(m,g,s),c(p)),!1)}const h=[],d=Object.assign(mne,{defaultVisitor:u,convertValue:c,isVisitable:KP});function f(p,g){if(!st.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(p),st.forEach(p,function(v,_){(!(st.isUndefined(v)||v===null)&&r.call(e,v,st.isString(_)?_.trim():_,g,d))===!0&&f(v,g?g.concat(_):[_])}),h.pop()}}if(!st.isObject(n))throw new TypeError("data must be an object");return f(n),e}function FN(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function fO(n,e){this._pairs=[],n&&wT(n,this,e)}const P6=fO.prototype;P6.append=function(e,t){this._pairs.push([e,t])};P6.toString=function(e){const t=e?function(i){return e.call(this,i,FN)}:FN;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function vne(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function M6(n,e,t){if(!e)return n;const i=t&&t.encode||vne,r=t&&t.serialize;let s;if(r?s=r(e,t):s=st.isURLSearchParams(e)?e.toString():new fO(e,t).toString(i),s){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class UN{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){st.forEach(this.handlers,function(i){i!==null&&e(i)})}}const R6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},_ne=typeof URLSearchParams<"u"?URLSearchParams:fO,yne=typeof FormData<"u"?FormData:null,Ane=typeof Blob<"u"?Blob:null,bne={isBrowser:!0,classes:{URLSearchParams:_ne,FormData:yne,Blob:Ane},protocols:["http","https","file","blob","url","data"]},D6=typeof window<"u"&&typeof document<"u",wne=(n=>D6&&["ReactNative","NativeScript","NS"].indexOf(n)<0)(typeof navigator<"u"&&navigator.product),xne=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Cne=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:D6,hasStandardBrowserEnv:wne,hasStandardBrowserWebWorkerEnv:xne},Symbol.toStringTag,{value:"Module"})),Mc={...Cne,...bne};function Ene(n,e){return wT(n,new Mc.classes.URLSearchParams,Object.assign({visitor:function(t,i,r,s){return Mc.isNode&&st.isBuffer(t)?(this.append(i,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function Tne(n){return st.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Ine(n){const e={},t=Object.keys(n);let i;const r=t.length;let s;for(i=0;i<r;i++)s=t[i],e[s]=n[s];return e}function k6(n){function e(t,i,r,s){let o=t[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=t.length;return o=!o&&st.isArray(r)?r.length:o,l?(st.hasOwnProp(r,o)?r[o]=[r[o],i]:r[o]=i,!a):((!r[o]||!st.isObject(r[o]))&&(r[o]=[]),e(t,i,r[o],s)&&st.isArray(r[o])&&(r[o]=Ine(r[o])),!a)}if(st.isFormData(n)&&st.isFunction(n.entries)){const t={};return st.forEachEntry(n,(i,r)=>{e(Tne(i),r,t,0)}),t}return null}function Sne(n,e,t){if(st.isString(n))try{return(e||JSON.parse)(n),st.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const pO={transitional:R6,adapter:["xhr","http"],transformRequest:[function(e,t){const i=t.getContentType()||"",r=i.indexOf("application/json")>-1,s=st.isObject(e);if(s&&st.isHTMLForm(e)&&(e=new FormData(e)),st.isFormData(e))return r&&r?JSON.stringify(k6(e)):e;if(st.isArrayBuffer(e)||st.isBuffer(e)||st.isStream(e)||st.isFile(e)||st.isBlob(e))return e;if(st.isArrayBufferView(e))return e.buffer;if(st.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return Ene(e,this.formSerializer).toString();if((a=st.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return wT(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),Sne(e)):e}],transformResponse:[function(e){const t=this.transitional||pO.transitional,i=t&&t.forcedJSONParsing,r=this.responseType==="json";if(e&&st.isString(e)&&(i&&!this.responseType||r)){const o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?zn.from(a,zn.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mc.classes.FormData,Blob:Mc.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};st.forEach(["delete","get","head","post","put","patch"],n=>{pO.headers[n]={}});const gO=pO,Pne=st.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Mne=n=>{const e={};let t,i,r;return n&&n.split(`
`).forEach(function(o){r=o.indexOf(":"),t=o.substring(0,r).trim().toLowerCase(),i=o.substring(r+1).trim(),!(!t||e[t]&&Pne[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},GN=Symbol("internals");function x_(n){return n&&String(n).trim().toLowerCase()}function Ix(n){return n===!1||n==null?n:st.isArray(n)?n.map(Ix):String(n)}function Rne(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}const Dne=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function KI(n,e,t,i,r){if(st.isFunction(i))return i.call(this,e,t);if(r&&(e=t),!!st.isString(e)){if(st.isString(i))return e.indexOf(i)!==-1;if(st.isRegExp(i))return i.test(e)}}function kne(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function One(n,e){const t=st.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(r,s,o){return this[i].call(this,e,r,s,o)},configurable:!0})})}let xT=class{constructor(e){e&&this.set(e)}set(e,t,i){const r=this;function s(a,l,c){const u=x_(l);if(!u)throw new Error("header name must be a non-empty string");const h=st.findKey(r,u);(!h||r[h]===void 0||c===!0||c===void 0&&r[h]!==!1)&&(r[h||l]=Ix(a))}const o=(a,l)=>st.forEach(a,(c,u)=>s(c,u,l));return st.isPlainObject(e)||e instanceof this.constructor?o(e,t):st.isString(e)&&(e=e.trim())&&!Dne(e)?o(Mne(e),t):e!=null&&s(t,e,i),this}get(e,t){if(e=x_(e),e){const i=st.findKey(this,e);if(i){const r=this[i];if(!t)return r;if(t===!0)return Rne(r);if(st.isFunction(t))return t.call(this,r,i);if(st.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=x_(e),e){const i=st.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||KI(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let r=!1;function s(o){if(o=x_(o),o){const a=st.findKey(i,o);a&&(!t||KI(i,i[a],a,t))&&(delete i[a],r=!0)}}return st.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let i=t.length,r=!1;for(;i--;){const s=t[i];(!e||KI(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){const t=this,i={};return st.forEach(this,(r,s)=>{const o=st.findKey(i,s);if(o){t[o]=Ix(r),delete t[s];return}const a=e?kne(s):String(s).trim();a!==s&&delete t[s],t[a]=Ix(r),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return st.forEach(this,(i,r)=>{i!=null&&i!==!1&&(t[r]=e&&st.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(r=>i.set(r)),i}static accessor(e){const i=(this[GN]=this[GN]={accessors:{}}).accessors,r=this.prototype;function s(o){const a=x_(o);i[a]||(One(r,o),i[a]=!0)}return st.isArray(e)?e.forEach(s):s(e),this}};xT.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);st.reduceDescriptors(xT.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(i){this[t]=i}}});st.freezeMethods(xT);const Qu=xT;function JI(n,e){const t=this||gO,i=e||t,r=Qu.from(i.headers);let s=i.data;return st.forEach(n,function(a){s=a.call(t,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function O6(n){return!!(n&&n.__CANCEL__)}function z0(n,e,t){zn.call(this,n??"canceled",zn.ERR_CANCELED,e,t),this.name="CanceledError"}st.inherits(z0,zn,{__CANCEL__:!0});function Lne(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new zn("Request failed with status code "+t.status,[zn.ERR_BAD_REQUEST,zn.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}const Nne=Mc.hasStandardBrowserEnv?{write(n,e,t,i,r,s){const o=[n+"="+encodeURIComponent(e)];st.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),st.isString(i)&&o.push("path="+i),st.isString(r)&&o.push("domain="+r),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Bne(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function Fne(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function L6(n,e){return n&&!Bne(e)?Fne(n,e):e}const Une=Mc.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let i;function r(s){let o=s;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return i=r(window.location.href),function(o){const a=st.isString(o)?r(o):o;return a.protocol===i.protocol&&a.host===i.host}}():function(){return function(){return!0}}();function Gne(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Hne(n,e){n=n||10;const t=new Array(n),i=new Array(n);let r=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=i[s];o||(o=c),t[r]=l,i[r]=c;let h=s,d=0;for(;h!==r;)d+=t[h++],h=h%n;if(r=(r+1)%n,r===s&&(s=(s+1)%n),c-o<e)return;const f=u&&c-u;return f?Math.round(d*1e3/f):void 0}}function HN(n,e){let t=0;const i=Hne(50,250);return r=>{const s=r.loaded,o=r.lengthComputable?r.total:void 0,a=s-t,l=i(a),c=s<=o;t=s;const u={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&c?(o-s)/l:void 0,event:r};u[e?"download":"upload"]=!0,n(u)}}const Vne=typeof XMLHttpRequest<"u",zne=Vne&&function(n){return new Promise(function(t,i){let r=n.data;const s=Qu.from(n.headers).normalize();let{responseType:o,withXSRFToken:a}=n,l;function c(){n.cancelToken&&n.cancelToken.unsubscribe(l),n.signal&&n.signal.removeEventListener("abort",l)}let u;if(st.isFormData(r)){if(Mc.hasStandardBrowserEnv||Mc.hasStandardBrowserWebWorkerEnv)s.setContentType(!1);else if((u=s.getContentType())!==!1){const[g,...m]=u?u.split(";").map(v=>v.trim()).filter(Boolean):[];s.setContentType([g||"multipart/form-data",...m].join("; "))}}let h=new XMLHttpRequest;if(n.auth){const g=n.auth.username||"",m=n.auth.password?unescape(encodeURIComponent(n.auth.password)):"";s.set("Authorization","Basic "+btoa(g+":"+m))}const d=L6(n.baseURL,n.url);h.open(n.method.toUpperCase(),M6(d,n.params,n.paramsSerializer),!0),h.timeout=n.timeout;function f(){if(!h)return;const g=Qu.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),v={data:!o||o==="text"||o==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:g,config:n,request:h};Lne(function(y){t(y),c()},function(y){i(y),c()},v),h=null}if("onloadend"in h?h.onloadend=f:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(f)},h.onabort=function(){h&&(i(new zn("Request aborted",zn.ECONNABORTED,n,h)),h=null)},h.onerror=function(){i(new zn("Network Error",zn.ERR_NETWORK,n,h)),h=null},h.ontimeout=function(){let m=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const v=n.transitional||R6;n.timeoutErrorMessage&&(m=n.timeoutErrorMessage),i(new zn(m,v.clarifyTimeoutError?zn.ETIMEDOUT:zn.ECONNABORTED,n,h)),h=null},Mc.hasStandardBrowserEnv&&(a&&st.isFunction(a)&&(a=a(n)),a||a!==!1&&Une(d))){const g=n.xsrfHeaderName&&n.xsrfCookieName&&Nne.read(n.xsrfCookieName);g&&s.set(n.xsrfHeaderName,g)}r===void 0&&s.setContentType(null),"setRequestHeader"in h&&st.forEach(s.toJSON(),function(m,v){h.setRequestHeader(v,m)}),st.isUndefined(n.withCredentials)||(h.withCredentials=!!n.withCredentials),o&&o!=="json"&&(h.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&h.addEventListener("progress",HN(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&h.upload&&h.upload.addEventListener("progress",HN(n.onUploadProgress)),(n.cancelToken||n.signal)&&(l=g=>{h&&(i(!g||g.type?new z0(null,n,h):g),h.abort(),h=null)},n.cancelToken&&n.cancelToken.subscribe(l),n.signal&&(n.signal.aborted?l():n.signal.addEventListener("abort",l)));const p=Gne(d);if(p&&Mc.protocols.indexOf(p)===-1){i(new zn("Unsupported protocol "+p+":",zn.ERR_BAD_REQUEST,n));return}h.send(r||null)})},JP={http:pne,xhr:zne};st.forEach(JP,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const VN=n=>`- ${n}`,$ne=n=>st.isFunction(n)||n===null||n===!1,N6={getAdapter:n=>{n=st.isArray(n)?n:[n];const{length:e}=n;let t,i;const r={};for(let s=0;s<e;s++){t=n[s];let o;if(i=t,!$ne(t)&&(i=JP[(o=String(t)).toLowerCase()],i===void 0))throw new zn(`Unknown adapter '${o}'`);if(i)break;r[o||"#"+s]=i}if(!i){const s=Object.entries(r).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(VN).join(`
`):" "+VN(s[0]):"as no adapter specified";throw new zn("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i},adapters:JP};function ZI(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new z0(null,n)}function zN(n){return ZI(n),n.headers=Qu.from(n.headers),n.data=JI.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),N6.getAdapter(n.adapter||gO.adapter)(n).then(function(i){return ZI(n),i.data=JI.call(n,n.transformResponse,i),i.headers=Qu.from(i.headers),i},function(i){return O6(i)||(ZI(n),i&&i.response&&(i.response.data=JI.call(n,n.transformResponse,i.response),i.response.headers=Qu.from(i.response.headers))),Promise.reject(i)})}const $N=n=>n instanceof Qu?n.toJSON():n;function fv(n,e){e=e||{};const t={};function i(c,u,h){return st.isPlainObject(c)&&st.isPlainObject(u)?st.merge.call({caseless:h},c,u):st.isPlainObject(u)?st.merge({},u):st.isArray(u)?u.slice():u}function r(c,u,h){if(st.isUndefined(u)){if(!st.isUndefined(c))return i(void 0,c,h)}else return i(c,u,h)}function s(c,u){if(!st.isUndefined(u))return i(void 0,u)}function o(c,u){if(st.isUndefined(u)){if(!st.isUndefined(c))return i(void 0,c)}else return i(void 0,u)}function a(c,u,h){if(h in e)return i(c,u);if(h in n)return i(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u)=>r($N(c),$N(u),!0)};return st.forEach(Object.keys(Object.assign({},n,e)),function(u){const h=l[u]||r,d=h(n[u],e[u],u);st.isUndefined(d)&&h!==a||(t[u]=d)}),t}const B6="1.6.5",mO={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{mO[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const WN={};mO.transitional=function(e,t,i){function r(s,o){return"[Axios v"+B6+"] Transitional option '"+s+"'"+o+(i?". "+i:"")}return(s,o,a)=>{if(e===!1)throw new zn(r(o," has been removed"+(t?" in "+t:"")),zn.ERR_DEPRECATED);return t&&!WN[o]&&(WN[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}};function Wne(n,e,t){if(typeof n!="object")throw new zn("options must be an object",zn.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let r=i.length;for(;r-- >0;){const s=i[r],o=e[s];if(o){const a=n[s],l=a===void 0||o(a,s,n);if(l!==!0)throw new zn("option "+s+" must be "+l,zn.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new zn("Unknown option "+s,zn.ERR_BAD_OPTION)}}const ZP={assertOptions:Wne,validators:mO},yh=ZP.validators;let rC=class{constructor(e){this.defaults=e,this.interceptors={request:new UN,response:new UN}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=fv(this.defaults,t);const{transitional:i,paramsSerializer:r,headers:s}=t;i!==void 0&&ZP.assertOptions(i,{silentJSONParsing:yh.transitional(yh.boolean),forcedJSONParsing:yh.transitional(yh.boolean),clarifyTimeoutError:yh.transitional(yh.boolean)},!1),r!=null&&(st.isFunction(r)?t.paramsSerializer={serialize:r}:ZP.assertOptions(r,{encode:yh.function,serialize:yh.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&st.merge(s.common,s[t.method]);s&&st.forEach(["delete","get","head","post","put","patch","common"],p=>{delete s[p]}),t.headers=Qu.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let u,h=0,d;if(!l){const p=[zN.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,c),d=p.length,u=Promise.resolve(t);h<d;)u=u.then(p[h++],p[h++]);return u}d=a.length;let f=t;for(h=0;h<d;){const p=a[h++],g=a[h++];try{f=p(f)}catch(m){g.call(this,m);break}}try{u=zN.call(this,f)}catch(p){return Promise.reject(p)}for(h=0,d=c.length;h<d;)u=u.then(c[h++],c[h++]);return u}getUri(e){e=fv(this.defaults,e);const t=L6(e.baseURL,e.url);return M6(t,e.params,e.paramsSerializer)}};st.forEach(["delete","get","head","options"],function(e){rC.prototype[e]=function(t,i){return this.request(fv(i||{},{method:e,url:t,data:(i||{}).data}))}});st.forEach(["post","put","patch"],function(e){function t(i){return function(s,o,a){return this.request(fv(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}rC.prototype[e]=t(),rC.prototype[e+"Form"]=t(!0)});const Sx=rC;let jne=class F6{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const i=this;this.promise.then(r=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](r);i._listeners=null}),this.promise.then=r=>{let s;const o=new Promise(a=>{i.subscribe(a),s=a}).then(r);return o.cancel=function(){i.unsubscribe(s)},o},e(function(s,o,a){i.reason||(i.reason=new z0(s,o,a),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new F6(function(r){e=r}),cancel:e}}};const Qne=jne;function Xne(n){return function(t){return n.apply(null,t)}}function Yne(n){return st.isObject(n)&&n.isAxiosError===!0}const eM={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(eM).forEach(([n,e])=>{eM[e]=n});const qne=eM;function U6(n){const e=new Sx(n),t=_6(Sx.prototype.request,e);return st.extend(t,Sx.prototype,e,{allOwnKeys:!0}),st.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return U6(fv(n,r))},t}const fi=U6(gO);fi.Axios=Sx;fi.CanceledError=z0;fi.CancelToken=Qne;fi.isCancel=O6;fi.VERSION=B6;fi.toFormData=wT;fi.AxiosError=zn;fi.Cancel=fi.CanceledError;fi.all=function(e){return Promise.all(e)};fi.spread=Xne;fi.isAxiosError=Yne;fi.mergeConfig=fv;fi.AxiosHeaders=Qu;fi.formToJSON=n=>k6(st.isHTMLForm(n)?new FormData(n):n);fi.getAdapter=N6.getAdapter;fi.HttpStatusCode=qne;fi.default=fi;const{Axios:Kne,AxiosError:G6,CanceledError:Jne,isCancel:Zne,CancelToken:eie,VERSION:tie,all:nie,Cancel:iie,isAxiosError:rie,spread:sie,toFormData:oie,AxiosHeaders:aie,HttpStatusCode:lie,formToJSON:cie,getAdapter:uie,mergeConfig:hie}=fi,die=Object.freeze(Object.defineProperty({__proto__:null,Axios:Kne,AxiosError:G6,AxiosHeaders:aie,Cancel:iie,CancelToken:eie,CanceledError:Jne,HttpStatusCode:lie,VERSION:tie,all:nie,default:fi,formToJSON:cie,getAdapter:uie,isAxiosError:rie,isCancel:Zne,mergeConfig:hie,spread:sie,toFormData:oie},Symbol.toStringTag,{value:"Module"}));var xr={},pv={},vO={},H6={exports:{}};/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */(function(n,e){(function(t){var i;if(n.exports=t(),i=!0,!i){var r=window.Cookies,s=window.Cookies=t();s.noConflict=function(){return window.Cookies=r,s}}})(function(){function t(){for(var s=0,o={};s<arguments.length;s++){var a=arguments[s];for(var l in a)o[l]=a[l]}return o}function i(s){return s.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function r(s){function o(){}function a(c,u,h){if(!(typeof document>"u")){h=t({path:"/"},o.defaults,h),typeof h.expires=="number"&&(h.expires=new Date(new Date*1+h.expires*864e5)),h.expires=h.expires?h.expires.toUTCString():"";try{var d=JSON.stringify(u);/^[\{\[]/.test(d)&&(u=d)}catch{}u=s.write?s.write(u,c):encodeURIComponent(String(u)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),c=encodeURIComponent(String(c)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var f="";for(var p in h)h[p]&&(f+="; "+p,h[p]!==!0&&(f+="="+h[p].split(";")[0]));return document.cookie=c+"="+u+f}}function l(c,u){if(!(typeof document>"u")){for(var h={},d=document.cookie?document.cookie.split("; "):[],f=0;f<d.length;f++){var p=d[f].split("="),g=p.slice(1).join("=");!u&&g.charAt(0)==='"'&&(g=g.slice(1,-1));try{var m=i(p[0]);if(g=(s.read||s)(g,m)||i(g),u)try{g=JSON.parse(g)}catch{}if(h[m]=g,c===m)break}catch{}}return c?h[c]:h}}return o.set=a,o.get=function(c){return l(c,!1)},o.getJSON=function(c){return l(c,!0)},o.remove=function(c,u){a(c,"",t(u,{expires:-1}))},o.defaults={},o.withConverter=r,o}return r(function(){})})})(H6);var fie=H6.exports,pie=un&&un.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(vO,"__esModule",{value:!0});const gie=pie(fie);class V6{static get(e){if(localStorage.length===0)return null;if(e){const t=localStorage.getItem(e);if(t!==null)try{return JSON.parse(t)}catch{return t}}else{const t=Object.keys(localStorage),i={};return t.forEach(r=>{i[r]=this.get(r)}),i}return null}static getJSON(e){return this.get(e)}static set(e,t){localStorage.setItem(e,JSON.stringify(t))}static remove(e){e?localStorage.removeItem(e):localStorage.clear()}}V6.defaults={};class CT{static get storage(){return this.strategy==="cookie"?this.cookie:this.local}static config(e){e&&(this.storage.defaults=e)}static get(e){return e?this.storage.get(e):this.storage.getJSON(e)}static set(e,t,i){this.storage.set(e,t,i)}static remove(e,t){this.storage.remove(e,t)}}vO.default=CT;CT.strategy="localstorage";CT.cookie=gie.default;CT.local=V6;var $0={};const mie=iO(die);var vie=un&&un.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty($0,"__esModule",{value:!0});$0.mr=void 0;const _ie=vie(mie);let z6=class{constructor(){this.axios=_ie.default.create({timeout:3e4,transformRequest:[e=>JSON.stringify(e)],transformResponse:[e=>JSON.parse(e)]}),this.interceptors()}interceptors(){this.axios.interceptors.request.use(e=>(e.headers["Content-Type"]="application/json;charset=UTF-8",Promise.resolve(e)),e=>Promise.reject(e)),this.axios.interceptors.response.use(e=>{const{status:t,data:i}=e;return t===200&&i.code===0?Promise.resolve(i.data):Promise.reject(i)},e=>Promise.reject(e))}apis(e){const t=this,i=Object.keys(e),r={};return i.forEach(s=>{const o=e[s].split(" ");let[a,l="GET"]=o;l=l.toLowerCase(),Object.defineProperty(r,s,{value(...c){const u=l.toUpperCase();if(u==="GET")return t.axios.get(a,...c);if(u==="POST")return t.axios.post(a,...c);if(u==="PUT")return t.axios.put(a,...c);if(u==="PATCH")return t.axios.patch(a,...c);if(u==="DELETE")return t.axios.delete(a,...c);const h=Object.assign({url:a,method:l},c);return t.axios(h)}})}),r}};$0.default=z6;$0.mr=new z6;var W0={};Object.defineProperty(W0,"__esModule",{value:!0});W0.QUERY=void 0;const yie={dev:{xtool:{us:{page:"https://dev-web.makeblock.com/xtool-passport/index.html#/",api:"https://passport-api-dev.makeblock.com/v1"},eu:{page:"https://dev-web.makeblock.com/xtool-passport/index.html#/",api:"https://passport-api-dev.makeblock.com/v1"},cn:{page:"https://dev-web.makeblock.com/xtool-passport/index.html#/",api:"https://passport-api-dev.makeblock.com/v1"}},makeblock:{us:{page:"https://dev-web.makeblock.com/passport/index.html#/",api:"https://passport-api-dev.makeblock.com/v1"},eu:{page:"https://dev-web.makeblock.com/passport/index.html#/",api:"https://passport-api-dev.makeblock.com/v1"},cn:{page:"https://dev-web.makeblock.com/passport/index.html#/",api:"https://passport-api-dev.makeblock.com/v1"}}},test:{xtool:{us:{page:"https://test-web.xtool.com/xtool-passport/index.html#/",api:"https://passport-api-test.xtool.com/v1"},eu:{page:"https://test-web.mblock.cc/xtool-passport/index.html#/",api:"https://passport-api-test.mblock.cc/v1"},cn:{page:"https://test-web.makeblock.com/xtool-passport/index.html#/",api:"https://passport-api-test.makeblock.com/v1"}},makeblock:{us:{page:"https://test-web.makeblock.com/passport/index.html#/",api:"https://passport-api-test.makeblock.com/v1"},eu:{page:"https://test-web.mblock.cc/passport/index.html#/",api:"https://passport-api-test.makeblock.com/v1"},cn:{page:"https://test-web.makeblock.com/passport/index.html#/",api:"https://passport-api-test.makeblock.com/v1"}}},prod:{xtool:{us:{page:"https://passport.xtool.com/#/",api:"https://passport-api.xtool.com/v1"},eu:{page:"https://passport.xtool.com/#/",api:"https://passport-api.xtool.com/v1"},cn:{page:"https://passport.xtool.com/#/",api:"https://passport-api.xtool.com/v1"}},makeblock:{us:{page:"https://passport.mblock.cc/#/",api:"https://passport-api.mblock.cc/v1"},eu:{page:"https://passport.mblock.cc/#/",api:"https://passport-api.mblock.cc/v1"},cn:{page:"https://passport.makeblock.com/#/",api:"https://passport-api.makeblock.com/v1"}}}};W0.QUERY={PLATFORM:"p",REDIRECT:"r",MODE:"md",SHOW_SWITCH_HOST:"sh",SHOW_SOCIAL_LOGIN:"sl",SHOW_SWITCH_LOGIN_REGISTER:"lr",ONLY_PHONE_LOGIN:"op",USE_LOCALSTORAGE:"uls",USE_RELOGIN:"rl",HIDE_LOGO:"hl",LOGO:"lo",TEXT_LOGO:"tlo",SUB_TEXT_LOGO:"stlo",COPYRIGHT:"cr",ORG_CODE:"oc",TOKEN:"ut",CLEAR_TOKEN:"cut",COOKIES_SAME_SITE:"sameSite",COOKIES_SECURE:"secure",APP_VERSION:"av",SYSTEM:"s",ORIGIN:"o",CUSTOM_IMAGE:"img"};W0.default=yie;var _O={exports:{}},Tm=typeof Reflect=="object"?Reflect:null,jN=Tm&&typeof Tm.apply=="function"?Tm.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},Px;Tm&&typeof Tm.ownKeys=="function"?Px=Tm.ownKeys:Object.getOwnPropertySymbols?Px=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Px=function(e){return Object.getOwnPropertyNames(e)};function Aie(n){console&&console.warn&&console.warn(n)}var $6=Number.isNaN||function(e){return e!==e};function Ci(){Ci.init.call(this)}_O.exports=Ci;_O.exports.once=Cie;Ci.EventEmitter=Ci;Ci.prototype._events=void 0;Ci.prototype._eventsCount=0;Ci.prototype._maxListeners=void 0;var QN=10;function ET(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Ci,"defaultMaxListeners",{enumerable:!0,get:function(){return QN},set:function(n){if(typeof n!="number"||n<0||$6(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");QN=n}});Ci.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ci.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||$6(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function W6(n){return n._maxListeners===void 0?Ci.defaultMaxListeners:n._maxListeners}Ci.prototype.getMaxListeners=function(){return W6(this)};Ci.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")jN(l,this,t);else for(var c=l.length,u=q6(l,c),i=0;i<c;++i)jN(u[i],this,t);return!0};function j6(n,e,t,i){var r,s,o;if(ET(t),s=n._events,s===void 0?(s=n._events=Object.create(null),n._eventsCount=0):(s.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),s=n._events),o=s[e]),o===void 0)o=s[e]=t,++n._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),r=W6(n),r>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=o.length,Aie(a)}return n}Ci.prototype.addListener=function(e,t){return j6(this,e,t,!1)};Ci.prototype.on=Ci.prototype.addListener;Ci.prototype.prependListener=function(e,t){return j6(this,e,t,!0)};function bie(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Q6(n,e,t){var i={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},r=bie.bind(i);return r.listener=t,i.wrapFn=r,r}Ci.prototype.once=function(e,t){return ET(t),this.on(e,Q6(this,e,t)),this};Ci.prototype.prependOnceListener=function(e,t){return ET(t),this.prependListener(e,Q6(this,e,t)),this};Ci.prototype.removeListener=function(e,t){var i,r,s,o,a;if(ET(t),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():wie(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Ci.prototype.off=Ci.prototype.removeListener;Ci.prototype.removeAllListeners=function(e){var t,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this};function X6(n,e,t){var i=n._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?t?[r.listener||r]:[r]:t?xie(r):q6(r,r.length)}Ci.prototype.listeners=function(e){return X6(this,e,!0)};Ci.prototype.rawListeners=function(e){return X6(this,e,!1)};Ci.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):Y6.call(n,e)};Ci.prototype.listenerCount=Y6;function Y6(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ci.prototype.eventNames=function(){return this._eventsCount>0?Px(this._events):[]};function q6(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n[i];return t}function wie(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function xie(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function Cie(n,e){return new Promise(function(t,i){function r(o){n.removeListener(e,s),i(o)}function s(){typeof n.removeListener=="function"&&n.removeListener("error",r),t([].slice.call(arguments))}K6(n,e,s,{once:!0}),e!=="error"&&Eie(n,r,{once:!0})})}function Eie(n,e,t){typeof n.on=="function"&&K6(n,"error",e,t)}function K6(n,e,t,i){if(typeof n.on=="function")i.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function r(s){i.once&&n.removeEventListener(e,r),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var uh=_O.exports;const j0=Ld(uh);var sC={},J6={},TT={},ls={};Object.defineProperty(ls,"__esModule",{value:!0});ls.SYSTEM_TYPE=ls.XTOOL_PLATFORM=ls.MAKEBLOCK_PLATFORM=ls.AREA=ls.DOMAIN_SPACE=ls.MESSAGE_TYPE=ls.CLIENT_ENV=ls.PAGE_MODE=void 0;var XN;(function(n){n.PAGE="page",n.WIN="win",n.FULL_WIN="full-win"})(XN||(ls.PAGE_MODE=XN={}));var YN;(function(n){n.DEV="dev",n.TEST="test",n.PROD="prod",n.LOCAL="local"})(YN||(ls.CLIENT_ENV=YN={}));var qN;(function(n){n.LOGIN="login",n.LOGOUT="logout",n.REGISTER="register",n.FINDPWD="findpwd",n.SWITCH_HSOT="switchHost"})(qN||(ls.MESSAGE_TYPE=qN={}));var KN;(function(n){n.MAKEBLOCK="makeblock",n.XTOOL="xtool"})(KN||(ls.DOMAIN_SPACE=KN={}));var JN;(function(n){n.EU="eu",n.CN="cn",n.US="us"})(JN||(ls.AREA=JN={}));var ZN;(function(n){n.MBLOCK_WEB="mblock_web",n.MBLOCK_PC="mblock_pc",n.MBLOCK_MOBILE="mblock_mobile",n.ONE_BOX="one_box",n.STEAM_PLATFORM_STU="steam_platform_stu",n.STEAM_PLATFORM_TEACHER="steam_platform_teacher",n.COMMUNITY="community",n.EXT_BUILDER="ext_builder",n.MAKEX="makex",n.MAKE_D2V="makeblock_d2v"})(ZN||(ls.MAKEBLOCK_PLATFORM=ZN={}));var eB;(function(n){n.XCS="xcs",n.PROJECTS="projects",n.SUPPORT="support",n.X_ART="xart",n.SMB="smb",n.PASSPORT="passport",n.FOCUSAUR="focusaur",n.XCS_CMS="xcs_cms",n.MARKETING="marketing",n.MATERIALS_LAB="materials_lab"})(eB||(ls.XTOOL_PLATFORM=eB={}));var tB;(function(n){n.PC="pc",n.PAD="pad",n.MOBILE="mobile",n.APP="app",n.OS="os"})(tB||(ls.SYSTEM_TYPE=tB={}));var Rc={};Object.defineProperty(Rc,"__esModule",{value:!0});Rc.LANG_KEY=Rc.TOKEN_KEY=Rc.MESSAGE_ORIGIN_NAME=Rc.POST_MESSAGE_SOURCE=void 0;Rc.POST_MESSAGE_SOURCE="makeblock-passport";Rc.MESSAGE_ORIGIN_NAME="passport-client";Rc.TOKEN_KEY="utoken";Rc.LANG_KEY="IntlLang";(function(n){var e=un&&un.__createBinding||(Object.create?function(i,r,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(r,s);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[s]}}),Object.defineProperty(i,o,a)}:function(i,r,s,o){o===void 0&&(o=s),i[o]=r[s]}),t=un&&un.__exportStar||function(i,r){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(r,s)&&e(r,i,s)};Object.defineProperty(n,"__esModule",{value:!0}),t(ls,n),t(Rc,n)})(TT);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.openLoginModal=n.closeLoginModal=void 0;const e=TT,t=600,i=520,r={position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:19999,backgroundColor:"rgba(57, 57, 57, 0.15)",display:"flex",justifyContent:"center",alignItems:"center"},s={width:"400px",height:`${t}px`,boxSizing:"border-box",zIndex:2e4,borderRadius:"20px",boxShadow:"0 2px 10px 2px rgba(0, 0, 0, 0.1)",overflow:"hidden",backgroundColor:"white",position:"relative"},o={width:"100vw",height:"100vh",borderRadius:"0"},a={position:"absolute",top:"0.3rem",right:"0.4rem",zIndex:"100",cursor:"pointer",fontSize:"20px",width:"24px",height:"24px",display:"flex",justifyContent:"center",alignItems:"center"},l={boxSizing:"border-box",width:"100%",height:"100%"},c={modal:"passport-modal-container",content:"passport-modal-content",closeBtn:"passport-modal-close-btn",iframe:"passport-modal-iframe"},u=p=>{const g=document.querySelector(`#${c.modal}`);g&&g.remove&&(g.remove(),window.postMessage({action:"close-passport-modal",reason:p}),window.removeEventListener("message",h))};n.closeLoginModal=u;const h=p=>{const g=p.data,{action:m,payload:v}=g;if(m==="win-height-change"){const _=document.querySelector(`#${c.content}`);if(_){const y=v>i?v:i;_.style.height=`${y}px`}}},d=p=>{const g=p.data,{action:m,from:v}=g;if(m==="hide-modal-close"&&["xtool-passport-web"].some(_=>_===v)){const _=document.querySelector(`#${c.closeBtn}`);_&&(_.style.display="none")}},f=(p,g)=>{const m=p,v=g===e.PAGE_MODE.FULL_WIN;if(g===e.PAGE_MODE.WIN&&(window.removeEventListener("message",h),window.addEventListener("message",h),window.removeEventListener("message",d),window.addEventListener("message",d)),document.querySelector(`#${c.modal}`))return;const A=`
    <style>
      @media (max-width: 576px) {
        #passport-modal-content {
          width: 100% !important;
          height: 100% !important;
          border-radius: 0px !important;
        }
      }
    </style>
  `,w=document.querySelector("body"),b=`<div id="${c.modal}" >
                ${A}
            <div id="${c.content}" >
                <span id="${c.closeBtn}">×</span>
                <iframe id="${c.iframe}" src="${m}" frameborder="0"></iframe>
            </div>
        </div>`,C=document.createElement("div");C.innerHTML+=b,w==null||w.append(C);const I=document.querySelector(`#${c.modal}`),x=document.querySelector(`#${c.content}`),T=document.querySelector(`#${c.closeBtn}`),O=document.querySelector(`#${c.iframe}`),F=()=>{(0,n.closeLoginModal)("click-close-btn")};T.onclick=F;const G=(B,R)=>{if(B)for(const P in R)B.style[P]=R[P]};G(I,r),G(x,v?Object.assign({},s,o):s),G(T,a),G(O,l)};n.openLoginModal=f})(J6);var IT={};Object.defineProperty(IT,"__esModule",{value:!0});IT.systemLang=void 0;const Tie=()=>{const{language:n,languages:e}=navigator;return n||(console.log(["=>language",n]),Array.isArray(e)&&e.length>0?e[0]:null)};IT.systemLang=Tie;(function(n){var e=un&&un.__createBinding||(Object.create?function(i,r,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(r,s);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[s]}}),Object.defineProperty(i,o,a)}:function(i,r,s,o){o===void 0&&(o=s),i[o]=r[s]}),t=un&&un.__exportStar||function(i,r){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(r,s)&&e(r,i,s)};Object.defineProperty(n,"__esModule",{value:!0}),t(J6,n),t(IT,n)})(sC);var Iie=un&&un.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Sie=un&&un.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Z6=un&&un.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Iie(e,n,t);return Sie(e,n),e},eS=un&&un.__classPrivateFieldSet||function(n,e,t,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(n,t):r?r.value=t:e.set(n,t),t},C_=un&&un.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},Pie=un&&un.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},Mx,ny,iy;Object.defineProperty(pv,"__esModule",{value:!0});pv.MRequest=void 0;const Ah=Pie(vO),oC=Z6($0),tr=Z6(W0),Mie=uh,tS=sC,Dr=TT;let Rie=class extends Mie.EventEmitter{constructor(e){super(),this._area=Dr.AREA.CN,this._domainSpace=Dr.DOMAIN_SPACE.MAKEBLOCK,Mx.set(this,{}),this._env=Dr.CLIENT_ENV.PROD,this._platform="",ny.set(this,""),this._redirect=location.href,this._mode=Dr.PAGE_MODE.PAGE,this._showSwitchHost=!0,this._showSwitchLoginRegister=!0,this._showSocialLogin=!0,this._onlyPhoneLogin=!1,this._useLocalstorage=!1,this._useReLogin=!1,this._logo="",this._textLogo="",this._subTextLogo="",this._hideLogo=!1,this._copyright="",this._orgCode="",this._appVersion="",this._system="",this._origin="",this._customImage="",iy.set(this,null),this.tokenChange=m=>{this.emit("tokenChange",m)},this.langChange=m=>{this.emit("langChange",m)};const{search:t,hash:i}=location,r=new URLSearchParams(t||i),s=this.getRootDomain();r.get("uls")||(Ah.default.strategy="cookie",Ah.default.config({domain:`.${s}`,expires:60*24*365})),r.get("rl")==="1"&&(this.token="");const{domainSpace:o,platform:a,system:l,mode:c,appVersion:u,area:h,origin:d,customImage:f,redirect:p,lang:g}=e;this.domainSpace=o,this.platform=a,this.mode=c,l&&(this.system=l),l&&(this.system=l),u&&(this.appVersion=u),h&&(this.area=h),d&&(this.origin=d),f&&(this.customImage=f),p!==void 0&&(this.redirect=p),g&&(this.lang=g)}get area(){return this._area}set area(e){this._area=e}set domainSpace(e){this._domainSpace=e}get domainSpace(){return this._domainSpace}get storage(){return Ah.default}get domain(){return tr.default[this._env][this._domainSpace][this._area]}set cookieConfig(e){Ah.default.config(e),eS(this,Mx,e,"f")}set env(e){this._env=e}get env(){return this._env}set platform(e){this._platform=e}get platform(){return this._platform}get lang(){return Ah.default.get(Dr.LANG_KEY)||C_(this,ny,"f")||(0,tS.systemLang)()||"en"}set lang(e){const t=C_(this,ny,"f"),i=this.lang;Ah.default.set(Dr.LANG_KEY,e),eS(this,ny,e,"f"),(t!==i||i!==e||t!==e)&&this.langChange(e)}set redirect(e){this._redirect=e}set mode(e){this._mode=e}set showSwitchHost(e){this._showSwitchHost=e}set showSwitchLoginRegister(e){this._showSwitchLoginRegister=e}set showSocialLogin(e){this._showSocialLogin=e}set onlyPhoneLogin(e){this._onlyPhoneLogin=e}set useLocalstorage(e){this._useLocalstorage=e}set useReLogin(e){this._useReLogin=e}set logo(e){this._logo=e}set textLogo(e){this._textLogo=e}set subTextLogo(e){this._subTextLogo=e}set hideLogo(e){this._hideLogo=e}set copyright(e){this._copyright=e}set orgCode(e){this._orgCode=e}set appVersion(e){const t=this.appVersion;this._appVersion=e,this.appVersion!==t&&this.appVersionChange(this.appVersion)}get appVersion(){return this._appVersion}set system(e){this._system=e}get system(){return this._system}set origin(e){this._origin=e}get origin(){return this._origin||this.platform}set customImage(e){this._customImage=e}get customImage(){return this._customImage}get baseUrl(){return`${this.domain.page}${this.lang}`}queryString(){const e=new URLSearchParams,{sameSite:t,secure:i}=C_(this,Mx,"f");return this._platform&&e.append(tr.QUERY.PLATFORM,this._platform),this._redirect&&e.append(tr.QUERY.REDIRECT,this._redirect),[Dr.PAGE_MODE.WIN,Dr.PAGE_MODE.FULL_WIN].some(r=>r===this._mode)&&e.append(tr.QUERY.MODE,this._mode),this._showSwitchHost===!1&&e.append(tr.QUERY.SHOW_SWITCH_HOST,"false"),this._showSwitchLoginRegister===!1&&e.append(tr.QUERY.SHOW_SWITCH_LOGIN_REGISTER,"0"),this._showSocialLogin===!1&&e.append(tr.QUERY.SHOW_SOCIAL_LOGIN,"0"),this._onlyPhoneLogin===!0&&e.append(tr.QUERY.ONLY_PHONE_LOGIN,"1"),this._useLocalstorage===!0&&e.append(tr.QUERY.USE_LOCALSTORAGE,"1"),this._useReLogin===!0&&e.append(tr.QUERY.REDIRECT,"1"),this._logo&&e.append(tr.QUERY.LOGO,this._logo),this._textLogo&&e.append(tr.QUERY.TEXT_LOGO,this._textLogo),this._subTextLogo&&e.append(tr.QUERY.SUB_TEXT_LOGO,this._textLogo),this._hideLogo===!0&&e.append(tr.QUERY.HIDE_LOGO,"1"),this._copyright&&e.append(tr.QUERY.COPYRIGHT,this._copyright),this._orgCode&&e.append(tr.QUERY.ORG_CODE,this._orgCode),this._appVersion&&e.append(tr.QUERY.APP_VERSION,this._appVersion),this._system&&e.append(tr.QUERY.SYSTEM,this._system),this._origin&&e.append(tr.QUERY.ORIGIN,this._origin),this._customImage&&e.append(tr.QUERY.CUSTOM_IMAGE,this._customImage),t&&e.append(tr.QUERY.COOKIES_SAME_SITE,t),i!==void 0&&e.append(tr.QUERY.COOKIES_SECURE,`${i}`),e.toString()}get url(){return`${this.baseUrl}/login?${this.queryString()}`}get stuLoginUrl(){return`${this.baseUrl}/login/stu?${this.queryString()}`}get profile(){return`${this.baseUrl}/profile?ut=${this.token}`}getUrl(e){return`${this.baseUrl}/${e}?${this.queryString()}`}get token(){return this.storage.get(Dr.TOKEN_KEY)||C_(this,iy,"f")}set token(e){const t=C_(this,iy,"f"),i=this.token;e?Ah.default.set(Dr.TOKEN_KEY,e):Ah.default.remove(Dr.TOKEN_KEY),eS(this,iy,e,"f"),(t!==i||i!==e||t!==e)&&(console.log(["=> token change",t,i,e]),this.tokenChange(e))}getMessageClientState(){return{domainSpace:this.domainSpace,platform:this.platform,system:this.system,token:this.token||"",lang:this.lang,area:this.area,env:this.env}}onStateListener(e){this.on("tokenChange",t=>{e({type:"token",value:t})}),this.on("langChange",t=>{e({type:"lang",value:t})})}appVersionChange(e){this.emit("appVersionChange",e)}set close(e){this._close=e}set switchHost(e){this._switchHost=e}listenMessage(){const e=i=>{const{source:r,payload:s}=i.data;if(r===Dr.POST_MESSAGE_SOURCE){const{type:o}=s;if(o===Dr.MESSAGE_TYPE.LOGIN||o===Dr.MESSAGE_TYPE.REGISTER||o===Dr.MESSAGE_TYPE.FINDPWD){const{token:a}=s;a&&(this.token=a),typeof this._close=="function"&&(this._close(s),t())}o===Dr.MESSAGE_TYPE.SWITCH_HSOT&&typeof this._switchHost=="function"&&this._switchHost(s.data)}},t=()=>{this._close=void 0,window.removeEventListener("message",e)};return window.addEventListener("message",e),t}logout(){this.isInIframe&&window.parent.postMessage({action:`${this._domainSpace}-${Dr.MESSAGE_TYPE.LOGOUT}`,from:Dr.MESSAGE_ORIGIN_NAME,platform:this.platform},"*");const e=this.token;if(!e)return Promise.reject(new Error("utoken is empty."));this.token=null;const t=`${this.domain.api}/user/logout`;return oC.mr.axios.post(t,{},{headers:{utoken:e}})}userInfo(){const e=this.token;if(!e)return Promise.reject(new Error("utoken is empty."));const t=`${this.domain.api}/user/basic`;return oC.mr.axios.get(t,{headers:{utoken:e}})}getRootDomain(e=document.location.hostname){const t=e.split("."),i=t.length;return i<=2?e:(t.splice(0,i-2),t.join("."))}openLoginModal(e){this.close=t=>{(0,tS.closeLoginModal)(),e&&e(t)},this.listenMessage(),(0,tS.openLoginModal)(this.url,this._mode)}get isInIframe(){return window.self!==window.parent}openModal(e){if(this.isInIframe){let t;const i=new Date().getTime(),r=`${this._domainSpace}-${Dr.MESSAGE_TYPE.LOGIN}`,s=u=>{const h=u.data;(h==null?void 0:h.action)===`${r}-${i}`&&(t=!!(h!=null&&h.notOpenModal))};window.addEventListener("message",s),window.parent.postMessage({action:r,key:i,from:Dr.MESSAGE_ORIGIN_NAME,platform:this.platform},"*");const o=5;let a=0,l;const c=()=>{if(a++,t!==void 0||a>o){if(window.removeEventListener("message",s),t)return;this.openLoginModal(e),clearTimeout(l);return}l=setTimeout(c,10)};c();return}this.openLoginModal(e)}checkAuthByProfile(){return new Promise(e=>{const t=new URLSearchParams,i=this.token||`${new Date().getTime()}`;t.append(tr.QUERY.TOKEN,i);const r=`${this.baseUrl}/profile/settings?${t.toString()}&${this.queryString()}`,s="check-auth-by-profile",o=()=>{const g=document.querySelector(`#${s}`);g&&(g==null||g.remove())};o();const a=g=>{const m=g.data,{action:v,ut:_="",userInfo:y={},msg:A}=m;v===`profile-settings-ut-cb-${i}`&&(e({ut:_,userInfo:y,msg:A}),o(),window.removeEventListener("message",a),clearTimeout(f))};window.addEventListener("message",a);const l=document.querySelector("body"),c=`
        <div style="position: fixed; z-index: -1; width: 0; height: 0;">
          <iframe id="checkAuthByProfile-iframe" src="${r}" frameborder="0"></iframe>
        </div>
      `,u=document.createElement("div");u.id=s,u.innerHTML+=c,l==null||l.append(u);const h=60;let d=0,f;const p=()=>{if(d++,d>h){e({ut:"",userInfo:{},msg:"Receive messages timeout"}),o(),window.removeEventListener("message",a),clearTimeout(f);return}f=setTimeout(p,1e3)};p()})}};Mx=new WeakMap,ny=new WeakMap,iy=new WeakMap;oC.mr.axios.interceptors.request.use(n=>{const{url:e,params:t={}}=n;if(e){let i=e.match(/(:[^{:&/|_}]*)/g);Array.isArray(i)&&i.length>0&&i.forEach(r=>{const s=r.replace(":","");s.length>=1&&s in t&&(n.url=e.replace(r,t[s]),delete n.params[s])})}return Promise.resolve(n)},n=>Promise.reject(n));pv.MRequest=oC.default;pv.default=Rie;(function(n){var e=un&&un.__createBinding||(Object.create?function(s,o,a,l){l===void 0&&(l=a);var c=Object.getOwnPropertyDescriptor(o,a);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[a]}}),Object.defineProperty(s,l,c)}:function(s,o,a,l){l===void 0&&(l=a),s[l]=o[a]}),t=un&&un.__exportStar||function(s,o){for(var a in s)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&e(o,s,a)},i=un&&un.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(n,"__esModule",{value:!0});const r=i(pv);t(pv,n),t(TT,n),n.default=r.default})(xr);const Die=Ld(xr),Pa=new Die({domainSpace:xr.DOMAIN_SPACE.XTOOL,platform:xr.XTOOL_PLATFORM.XCS,mode:xr.PAGE_MODE.WIN,area:xr.AREA.US,redirect:""}),xb={prod:{url:"https://xcs-api.xtool.com",xArt:"https://xart.xtool.com",passport:"https://passport-api.xtool.com",projects:"https://projects.xtool.com",support:"https://s.xtool.com/support",commonApi:"https://api.xtool.com",smb:"https://smb.xtool.com",material:"https://mt.xtool.com"},test:{url:"https://xcs-api-test.makeblock.com",xArt:"https://test-web.makeblock.com/aigp/index.html",passport:"https://passport-api-test.xtool.com",projects:"https://xtool-community-test.makeblock.com",support:"https://xtool-support-test.makeblock.com",commonApi:"https://api-test.makeblock.com",smb:"https://test-web.makeblock.com/smb-web/index.html",material:"https://material-test.makeblock.com"},test_us:{url:"https://xcs-api-test.xtool.com",xArt:"https://test-web.xtool.com/aigp/index.html",passport:"https://passport-api-test.xtool.com",projects:"https://projects-test.xtool.com",support:"https://support-test.xtool.com",commonApi:"https://api-test.xtool.com",smb:"https://test-web.xtool.com/smb-web/index.html",material:"https://material-test.xtool.com"},dev:{url:"https://xcs-api-dev.makeblock.com",xArt:"https://dev-web.makeblock.com/aigp/index.html",passport:"https://passport-api-dev.xtool.com",projects:"https://xtool-community-dev.makeblock.com",support:"https://xtool-support-dev.makeblock.com",commonApi:"https://api-dev.makeblock.com",smb:"https://dev-web.makeblock.com/smb-web/index.html",material:"https://material-dev.makeblock.com"}},Cb={prod:{[xr.AREA.CN]:"https://api.makeblock.com",[xr.AREA.EU]:"https://api.mblock.cc",[xr.AREA.US]:"https://api.xtool.com"},test_us:"https://api-test.xtool.com",test:"https://api-test.makeblock.com",dev:"https://api-dev.makeblock.com"},kie=()=>{let n=Cb.prod[Pa.area];const e=localStorage.getItem("testEnv")||"";return e==="test"?n=Cb.test:e==="test_us"?n=Cb.test_us:e==="dev"&&(n=Cb.dev),n},nl=()=>{let n=xb.prod,e="localMaterials";Pa.cookieConfig={sameSite:"None",secure:!0,expires:60*24*365,domain:`.${Pa.getRootDomain()}`},Pa.env=xr.CLIENT_ENV.PROD;const t=localStorage.getItem("testEnv")||"";return t==="test"?(n=xb.test,e="localMaterials_testEnv",Pa.area=xr.AREA.CN,Pa.env=xr.CLIENT_ENV.TEST):t==="test_us"?(n=xb.test_us,e="localMaterials_testUSEnv",Pa.area=xr.AREA.US,Pa.env=xr.CLIENT_ENV.TEST):t==="dev"&&(n=xb.dev,e="localMaterials_devEnv",Pa.area=xr.AREA.CN,Pa.env=xr.CLIENT_ENV.DEV),{domain:n,LOCAL_MATERIALS:e,client:Pa}},e8="uToken",ST=()=>localStorage.getItem(e8)||"",Oie=n=>{localStorage.setItem(e8,n),Pa.token=n},yO="/v1",Lie="/v2",Nie={withCredentials:!1,timeout:6e4,headers:{"content-type":"application/json;charset=UTF-8"}},PT=fi.create(Nie),Bie=n=>(console.log("axios error",n,n.message),n.message,n.response&&console.log(n.response),Promise.reject(n));PT.interceptors.response.use(n=>(n.data.code!==0,Promise.resolve(n.data)),Bie);function AO(){return{baseURL:nl().domain.url,withCredentials:!1,timeout:6e4,headers:{"content-type":"application/json;charset=UTF-8"}}}function Fie(n,e){return PT.get(n,{...AO(),...e})}function Uie(n,e,t){return PT.patch(n,e,{...AO(),...t})}function Gie(n,e){return PT.delete(n,{...AO(),...e})}function Hie(n){const e=[];for(const t in n)typeof n[t]!="string"&&typeof n[t]!="number"?n[t].forEach(r=>{e.push(`${t}=${r}`)}):e.push(t+"="+n[t]);return e.join("&")}const bO=()=>({"content-type":"application/json;charset=UTF-8",uToken:ST()}),Vie=n=>Fie(`${yO}/web/my/files`,{params:n,paramsSerializer:{serialize:Hie},headers:bO()}),zie=(n,e)=>Uie(`${yO}/web/my/file/${n}/name`,e,{headers:bO()}),$ie=n=>Gie(`${yO}/web/my/file/${n}`,{headers:bO()});function Q0(n){return new Promise((e,t)=>{fi({method:"get",timeout:6e4,...n}).then(i=>{i.data.code===0?e(i.data.data):t(i.data)}).catch(i=>t(i))})}const MT=()=>{const{domain:n}=nl();return n.url+Lie},Wie=async n=>await Q0({baseURL:MT(),url:"/web/materials",params:n}),jie=async n=>await Q0({method:"post",baseURL:MT(),url:"/web/materials/increment",data:{data:n}}),Qie=async()=>await Q0({baseURL:MT(),url:"/public/data/type/material_category/items"}),Xie=async n=>await Q0({baseURL:MT(),url:`/web/material-para/${n}`}),Yie=localStorage.getItem("testEnv")||"",nB={dev:"https://user-api-dev.makeblock.com",test:"https://user-api-test.makeblock.com",test_us:"https://user-api-test.xtool.com",production:"https://user-api.xtool.com"},qie=async()=>{let n=nB[Yie];return n||(n=nB.production),await Q0({baseURL:n,url:"/v1/safety/getPrizeInfo",headers:{"content-type":"application/json;charset=UTF-8",uToken:ST()}})};function RT(n){return n6()?(i6(n),!0):!1}function Ql(n){return typeof n=="function"?n():Be(n)}const wO=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Kie=Object.prototype.toString,t8=n=>Kie.call(n)==="[object Object]",dd=()=>{},tM=Jie();function Jie(){var n,e;return wO&&((n=window==null?void 0:window.navigator)==null?void 0:n.userAgent)&&(/iP(ad|hone|od)/.test(window.navigator.userAgent)||((e=window==null?void 0:window.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function Zie(n,e){function t(...i){return new Promise((r,s)=>{Promise.resolve(n(()=>e.apply(this,i),{fn:e,thisArg:this,args:i})).then(r).catch(s)})}return t}function ere(n,e={}){let t,i,r=dd;const s=a=>{clearTimeout(a),r(),r=dd};return a=>{const l=Ql(n),c=Ql(e.maxWait);return t&&s(t),l<=0||c!==void 0&&c<=0?(i&&(s(i),i=null),Promise.resolve(a())):new Promise((u,h)=>{r=e.rejectOnCancel?h:u,c&&!i&&(i=setTimeout(()=>{t&&s(t),i=null,u(a())},c)),t=setTimeout(()=>{i&&s(i),i=null,u(a())},l)})}}const iB={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function tre(...n){if(n.length!==1)return ri(...n);const e=n[0];return typeof e=="function"?kp(Vee(()=>({get:e,set:dd}))):ee(e)}function n8(n,e=200,t={}){return Zie(ere(e,t),n)}function nre(n){return Array.from(new Set(n))}function ire(n,e){return n.reduce((t,i)=>(t.some(r=>e(i,r,n))||t.push(i),t),[])}function dft(n,e){return te(()=>{const t=Ql(n).map(i=>Ql(i));return e?ire(t,e):nre(t)})}function i8(n){var e;const t=Ql(n);return(e=t==null?void 0:t.$el)!=null?e:t}const xO=wO?window:void 0;function Im(...n){let e,t,i,r;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,i,r]=n,e=xO):[e,t,i,r]=n,!e)return dd;Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);const s=[],o=()=>{s.forEach(u=>u()),s.length=0},a=(u,h,d,f)=>(u.addEventListener(h,d,f),()=>u.removeEventListener(h,d,f)),l=yt(()=>[i8(e),Ql(r)],([u,h])=>{if(o(),!u)return;const d=t8(h)?{...h}:h;s.push(...t.flatMap(f=>i.map(p=>a(u,f,p,d))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return RT(c),c}const rre=500,sre=10;function ore(n,e,t){var i,r;const s=te(()=>i8(n));let o,a;function l(){o&&(clearTimeout(o),o=void 0),a=void 0}function c(p){var g,m,v,_;(g=t==null?void 0:t.modifiers)!=null&&g.self&&p.target!==s.value||(l(),(m=t==null?void 0:t.modifiers)!=null&&m.prevent&&p.preventDefault(),(v=t==null?void 0:t.modifiers)!=null&&v.stop&&p.stopPropagation(),a={x:p.x,y:p.y},o=setTimeout(()=>e(p),(_=t==null?void 0:t.delay)!=null?_:rre))}function u(p){var g,m,v,_;if((g=t==null?void 0:t.modifiers)!=null&&g.self&&p.target!==s.value||!a||(t==null?void 0:t.distanceThreshold)===!1)return;(m=t==null?void 0:t.modifiers)!=null&&m.prevent&&p.preventDefault(),(v=t==null?void 0:t.modifiers)!=null&&v.stop&&p.stopPropagation();const y=p.x-a.x,A=p.y-a.y;Math.sqrt(y*y+A*A)>=((_=t==null?void 0:t.distanceThreshold)!=null?_:sre)&&l()}const h={capture:(i=t==null?void 0:t.modifiers)==null?void 0:i.capture,once:(r=t==null?void 0:t.modifiers)==null?void 0:r.once},d=[Im(s,"pointerdown",c,h),Im(s,"pointermove",u,h),Im(s,["pointerup","pointerleave"],l,h)];return()=>d.forEach(p=>p())}function are(){const n=ee(!1);return jv()&&Zn(()=>{n.value=!0}),n}function lre(n){const e=are();return te(()=>(e.value,!!n()))}function cre(n,e={}){const{immediate:t=!0,fpsLimit:i=void 0,window:r=xO}=e,s=ee(!1),o=i?1e3/i:null;let a=0,l=null;function c(d){if(!s.value||!r)return;const f=d-(a||d);if(o&&f<o){l=r.requestAnimationFrame(c);return}n({delta:f,timestamp:d}),a=d,l=r.requestAnimationFrame(c)}function u(){!s.value&&r&&(s.value=!0,l=r.requestAnimationFrame(c))}function h(){s.value=!1,l!=null&&r&&(r.cancelAnimationFrame(l),l=null)}return t&&u(),RT(h),{isActive:kp(s),pause:h,resume:u}}function DT(n={}){const{window:e=xO}=n,t=e==null?void 0:e.navigator,i=lre(()=>t&&"connection"in t),r=ee(!0),s=ee(!1),o=ee(void 0),a=ee(void 0),l=ee(void 0),c=ee(void 0),u=ee(void 0),h=ee(void 0),d=ee("unknown"),f=i.value&&t.connection;function p(){t&&(r.value=t.onLine,o.value=r.value?void 0:Date.now(),a.value=r.value?Date.now():void 0,f&&(l.value=f.downlink,c.value=f.downlinkMax,h.value=f.effectiveType,u.value=f.rtt,s.value=f.saveData,d.value=f.type))}return e&&(Im(e,"offline",()=>{r.value=!1,o.value=Date.now()}),Im(e,"online",()=>{r.value=!0,a.value=Date.now()})),f&&Im(f,"change",p,!1),p(),{isSupported:i,isOnline:r,saveData:s,offlineAt:o,onlineAt:a,downlink:l,downlinkMax:c,effectiveType:h,rtt:u,type:d}}var fd=(n=>(n.BEST="best",n.HIGH="high",n.MEDIUM="medium",n))(fd||{});const r8=":";var ef=(n=>(n.COMMON_VIEW_EVENT_PREFIX="COMMON_VIEW",n.HOME_VIEW_EVENT_PREFIX="HOME_VIEW",n.MAIN_PROCESS="MAIN_PROCESS",n.PROJECT_VIEW_EVENT_PREFIX="PROJECT_VIEW",n.EMBED_PAGE_EVENT_PREFIX="EMBED_PAGE",n.MESSAGE_VIEW_EVENT_PREFIX="MESSAGE_VIEW",n))(ef||{}),up=(n=>(n.FirstMinimize="FirstMinimize",n.SetLearning="SetLearning",n.PrepareDeleteTab="PrepareDeleteTab",n.PrepareAddEmbedTab="PrepareAddEmbedTab",n.PrepareAddNewTab="PrepareAddNewTab",n.CloseTab="CloseTab",n.GetTabInfo="GetTabInfo",n.UpdateTabInfo="UpdateTabInfo",n.MenuCloseTab="MenuCloseTab",n.DeleteTab="DeleteTab",n.ChangeTab="ChangeTab",n.ToggleSetting="ToggleSetting",n.ToggleTaskList="ToggleTaskList",n.ToggleConfirmModal="ToggleConfirmModal",n.Login="Login",n.Logout="Logout",n.StartToDeleteViews="StartToDeleteViews",n.ToMessageCenter="ToMessageCenter",n.UpdateLangOptions="UpdateLangOptions",n.GetFontList="GetFontList",n.GetProcessTaskInfo="GetProcessTaskInfo",n.FullProjectView="FullProjectView",n.CheckSoftwareUpdate="CheckSoftwareUpdate",n.ReloadProject="ReloadProject",n.showLearningGuide="showLearningGuide",n.GetUserInfo="GetUserInfo",n))(up||{}),s8=(n=>(n.LoginResult="LoginResult",n.LogoutResult="LogoutResult",n))(s8||{}),o8=(n=>(n.ShowTabContextMenu="ShowTabContextMenu",n.UpdateProjectRenameData="UpdateProjectRenameData",n.ExitCanvasEditing="ExitCanvasEditing",n.UpdateProjectRenameVisible="UpdateProjectRenameVisible",n.SaveConfirm="SaveConfirm",n.LoginResult="LoginResult",n.LogoutResult="LogoutResult",n.UpdateUsedDevice="UpdateUsedDevice",n.ReconnectDevice="ReconnectDevice",n.CancelProcess="CancelProcess",n.StartProcess="StartProcess",n.PauseProcess="PauseProcess",n.StopProcess="StopProcess",n.DeviceDisconnect="DeviceDisconnect",n.DeviceMessage="DeviceMessage",n.DeviceError="DeviceError",n.CallProcessing="CallProcessing",n.AddNewViewProject="AddNewViewProject",n.UpdateCurrentInstanceId="UpdateCurrentInstanceId",n))(o8||{}),a8=(n=>(n.openUrl="openUrl",n))(a8||{}),CO=(n=>(n.SendToMessageCenter="SendToMessageCenter",n))(CO||{}),l8=(n=>(n.ShowTabContextMenu="ShowTabContextMenu",n.AddNewView="AddNewView",n.DeleteView="DeleteView",n.ChangeView="ChangeView",n.ToggleCommonView="ToggleCommonView",n.ToggleMessageView="ToggleMessageView",n.ViewResized="ViewResized",n.CloseWindow="CloseWindow",n.MinimizeWindow="MinimizeWindow",n.MaximizeWindow="MaximizeWindow",n.GetProjectViewId="GetProjectViewId",n.QuitApp="QuitApp",n.ReloadProjectView="ReloadProjectView",n.ShowAppContextMenu="ShowAppContextMenu",n.UpdateLanguage="UpdateLanguage",n))(l8||{}),c8=typeof global=="object"&&global&&global.Object===Object&&global,ure=typeof self=="object"&&self&&self.Object===Object&&self,dl=c8||ure||Function("return this")(),il=dl.Symbol,u8=Object.prototype,hre=u8.hasOwnProperty,dre=u8.toString,E_=il?il.toStringTag:void 0;function fre(n){var e=hre.call(n,E_),t=n[E_];try{n[E_]=void 0;var i=!0}catch{}var r=dre.call(n);return i&&(e?n[E_]=t:delete n[E_]),r}var pre=Object.prototype,gre=pre.toString;function mre(n){return gre.call(n)}var vre="[object Null]",_re="[object Undefined]",rB=il?il.toStringTag:void 0;function nc(n){return n==null?n===void 0?_re:vre:rB&&rB in Object(n)?fre(n):mre(n)}function Qo(n){return n!=null&&typeof n=="object"}var yre="[object Symbol]";function Lp(n){return typeof n=="symbol"||Qo(n)&&nc(n)==yre}function Xu(n,e){for(var t=-1,i=n==null?0:n.length,r=Array(i);++t<i;)r[t]=e(n[t],t,n);return r}var Rt=Array.isArray,Are=1/0,sB=il?il.prototype:void 0,oB=sB?sB.toString:void 0;function X0(n){if(typeof n=="string")return n;if(Rt(n))return Xu(n,X0)+"";if(Lp(n))return oB?oB.call(n):"";var e=n+"";return e=="0"&&1/n==-Are?"-0":e}var bre=/\s/;function wre(n){for(var e=n.length;e--&&bre.test(n.charAt(e)););return e}var xre=/^\s+/;function h8(n){return n&&n.slice(0,wre(n)+1).replace(xre,"")}function vs(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var aB=NaN,Cre=/^[-+]0x[0-9a-f]+$/i,Ere=/^0b[01]+$/i,Tre=/^0o[0-7]+$/i,Ire=parseInt;function aC(n){if(typeof n=="number")return n;if(Lp(n))return aB;if(vs(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=vs(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=h8(n);var t=Ere.test(n);return t||Tre.test(n)?Ire(n.slice(2),t?2:8):Cre.test(n)?aB:+n}var lB=1/0,Sre=17976931348623157e292;function Pre(n){if(!n)return n===0?n:0;if(n=aC(n),n===lB||n===-lB){var e=n<0?-1:1;return e*Sre}return n===n?n:0}function rg(n){var e=Pre(n),t=e%1;return e===e?t?e-t:e:0}function Yv(n){return n}var Mre="[object AsyncFunction]",Rre="[object Function]",Dre="[object GeneratorFunction]",kre="[object Proxy]";function mt(n){if(!vs(n))return!1;var e=nc(n);return e==Rre||e==Dre||e==Mre||e==kre}var nS=dl["__core-js_shared__"],cB=function(){var n=/[^.]+$/.exec(nS&&nS.keys&&nS.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function Ore(n){return!!cB&&cB in n}var Lre=Function.prototype,Nre=Lre.toString;function sg(n){if(n!=null){try{return Nre.call(n)}catch{}try{return n+""}catch{}}return""}var Bre=/[\\^$.*+?()[\]{}|]/g,Fre=/^\[object .+?Constructor\]$/,Ure=Function.prototype,Gre=Object.prototype,Hre=Ure.toString,Vre=Gre.hasOwnProperty,zre=RegExp("^"+Hre.call(Vre).replace(Bre,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $re(n){if(!vs(n)||Ore(n))return!1;var e=mt(n)?zre:Fre;return e.test(sg(n))}function Wre(n,e){return n==null?void 0:n[e]}function og(n,e){var t=Wre(n,e);return $re(t)?t:void 0}var nM=og(dl,"WeakMap"),uB=Object.create,jre=function(){function n(){}return function(e){if(!vs(e))return{};if(uB)return uB(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}();function d8(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}function Qre(){}function EO(n,e){var t=-1,i=n.length;for(e||(e=Array(i));++t<i;)e[t]=n[t];return e}var Xre=800,Yre=16,qre=Date.now;function Kre(n){var e=0,t=0;return function(){var i=qre(),r=Yre-(i-t);if(t=i,r>0){if(++e>=Xre)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}function Jre(n){return function(){return n}}var lC=function(){try{var n=og(Object,"defineProperty");return n({},"",{}),n}catch{}}(),Zre=lC?function(n,e){return lC(n,"toString",{configurable:!0,enumerable:!1,value:Jre(e),writable:!0})}:Yv;const ese=Zre;var f8=Kre(ese);function tse(n,e){for(var t=-1,i=n==null?0:n.length;++t<i&&e(n[t],t,n)!==!1;);return n}function TO(n,e,t,i){for(var r=n.length,s=t+(i?1:-1);i?s--:++s<r;)if(e(n[s],s,n))return s;return-1}function nse(n){return n!==n}function ise(n,e,t){for(var i=t-1,r=n.length;++i<r;)if(n[i]===e)return i;return-1}function Y0(n,e,t){return e===e?ise(n,e,t):TO(n,nse,t)}function rse(n,e){var t=n==null?0:n.length;return!!t&&Y0(n,e,0)>-1}var sse=9007199254740991,ose=/^(?:0|[1-9]\d*)$/;function q0(n,e){var t=typeof n;return e=e??sse,!!e&&(t=="number"||t!="symbol"&&ose.test(n))&&n>-1&&n%1==0&&n<e}function kT(n,e,t){e=="__proto__"&&lC?lC(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}function qv(n,e){return n===e||n!==n&&e!==e}var ase=Object.prototype,lse=ase.hasOwnProperty;function IO(n,e,t){var i=n[e];(!(lse.call(n,e)&&qv(i,t))||t===void 0&&!(e in n))&&kT(n,e,t)}function ag(n,e,t,i){var r=!t;t||(t={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(t[a],n[a],a,t,n):void 0;l===void 0&&(l=n[a]),r?kT(t,a,l):IO(t,a,l)}return t}var hB=Math.max;function p8(n,e,t){return e=hB(e===void 0?n.length-1:e,0),function(){for(var i=arguments,r=-1,s=hB(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=t(o),d8(n,this,a)}}function OT(n,e){return f8(p8(n,e,Yv),n+"")}var cse=9007199254740991;function SO(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=cse}function hh(n){return n!=null&&SO(n.length)&&!mt(n)}function gv(n,e,t){if(!vs(t))return!1;var i=typeof e;return(i=="number"?hh(t)&&q0(e,t.length):i=="string"&&e in t)?qv(t[e],n):!1}function PO(n){return OT(function(e,t){var i=-1,r=t.length,s=r>1?t[r-1]:void 0,o=r>2?t[2]:void 0;for(s=n.length>3&&typeof s=="function"?(r--,s):void 0,o&&gv(t[0],t[1],o)&&(s=r<3?void 0:s,r=1),e=Object(e);++i<r;){var a=t[i];a&&n(e,a,i,s)}return e})}var use=Object.prototype;function LT(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||use;return n===t}function hse(n,e){for(var t=-1,i=Array(n);++t<n;)i[t]=e(t);return i}var dse="[object Arguments]";function dB(n){return Qo(n)&&nc(n)==dse}var g8=Object.prototype,fse=g8.hasOwnProperty,pse=g8.propertyIsEnumerable,mv=dB(function(){return arguments}())?dB:function(n){return Qo(n)&&fse.call(n,"callee")&&!pse.call(n,"callee")};function gse(){return!1}var m8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,fB=m8&&typeof module=="object"&&module&&!module.nodeType&&module,mse=fB&&fB.exports===m8,pB=mse?dl.Buffer:void 0,vse=pB?pB.isBuffer:void 0,_se=vse||gse;const vv=_se;var yse="[object Arguments]",Ase="[object Array]",bse="[object Boolean]",wse="[object Date]",xse="[object Error]",Cse="[object Function]",Ese="[object Map]",Tse="[object Number]",Ise="[object Object]",Sse="[object RegExp]",Pse="[object Set]",Mse="[object String]",Rse="[object WeakMap]",Dse="[object ArrayBuffer]",kse="[object DataView]",Ose="[object Float32Array]",Lse="[object Float64Array]",Nse="[object Int8Array]",Bse="[object Int16Array]",Fse="[object Int32Array]",Use="[object Uint8Array]",Gse="[object Uint8ClampedArray]",Hse="[object Uint16Array]",Vse="[object Uint32Array]",$i={};$i[Ose]=$i[Lse]=$i[Nse]=$i[Bse]=$i[Fse]=$i[Use]=$i[Gse]=$i[Hse]=$i[Vse]=!0;$i[yse]=$i[Ase]=$i[Dse]=$i[bse]=$i[kse]=$i[wse]=$i[xse]=$i[Cse]=$i[Ese]=$i[Tse]=$i[Ise]=$i[Sse]=$i[Pse]=$i[Mse]=$i[Rse]=!1;function zse(n){return Qo(n)&&SO(n.length)&&!!$i[nc(n)]}function K0(n){return function(e){return n(e)}}var v8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,py=v8&&typeof module=="object"&&module&&!module.nodeType&&module,$se=py&&py.exports===v8,iS=$se&&c8.process,_v=function(){try{var n=py&&py.require&&py.require("util").types;return n||iS&&iS.binding&&iS.binding("util")}catch{}}(),gB=_v&&_v.isTypedArray,Wse=gB?K0(gB):zse;const NT=Wse;var jse=Object.prototype,Qse=jse.hasOwnProperty;function _8(n,e){var t=Rt(n),i=!t&&mv(n),r=!t&&!i&&vv(n),s=!t&&!i&&!r&&NT(n),o=t||i||r||s,a=o?hse(n.length,String):[],l=a.length;for(var c in n)(e||Qse.call(n,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||q0(c,l)))&&a.push(c);return a}function y8(n,e){return function(t){return n(e(t))}}var Xse=y8(Object.keys,Object),Yse=Object.prototype,qse=Yse.hasOwnProperty;function A8(n){if(!LT(n))return Xse(n);var e=[];for(var t in Object(n))qse.call(n,t)&&t!="constructor"&&e.push(t);return e}function Ks(n){return hh(n)?_8(n):A8(n)}function Kse(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var Jse=Object.prototype,Zse=Jse.hasOwnProperty;function eoe(n){if(!vs(n))return Kse(n);var e=LT(n),t=[];for(var i in n)i=="constructor"&&(e||!Zse.call(n,i))||t.push(i);return t}function Kv(n){return hh(n)?_8(n,!0):eoe(n)}var mB=PO(function(n,e,t,i){ag(e,Kv(e),n,i)}),toe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,noe=/^\w*$/;function MO(n,e){if(Rt(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||Lp(n)?!0:noe.test(n)||!toe.test(n)||e!=null&&n in Object(e)}var Jy=og(Object,"create");function ioe(){this.__data__=Jy?Jy(null):{},this.size=0}function roe(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var soe="__lodash_hash_undefined__",ooe=Object.prototype,aoe=ooe.hasOwnProperty;function loe(n){var e=this.__data__;if(Jy){var t=e[n];return t===soe?void 0:t}return aoe.call(e,n)?e[n]:void 0}var coe=Object.prototype,uoe=coe.hasOwnProperty;function hoe(n){var e=this.__data__;return Jy?e[n]!==void 0:uoe.call(e,n)}var doe="__lodash_hash_undefined__";function foe(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Jy&&e===void 0?doe:e,this}function Np(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}Np.prototype.clear=ioe;Np.prototype.delete=roe;Np.prototype.get=loe;Np.prototype.has=hoe;Np.prototype.set=foe;function poe(){this.__data__=[],this.size=0}function BT(n,e){for(var t=n.length;t--;)if(qv(n[t][0],e))return t;return-1}var goe=Array.prototype,moe=goe.splice;function voe(n){var e=this.__data__,t=BT(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():moe.call(e,t,1),--this.size,!0}function _oe(n){var e=this.__data__,t=BT(e,n);return t<0?void 0:e[t][1]}function yoe(n){return BT(this.__data__,n)>-1}function Aoe(n,e){var t=this.__data__,i=BT(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}function dh(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}dh.prototype.clear=poe;dh.prototype.delete=voe;dh.prototype.get=_oe;dh.prototype.has=yoe;dh.prototype.set=Aoe;var Zy=og(dl,"Map");function boe(){this.size=0,this.__data__={hash:new Np,map:new(Zy||dh),string:new Np}}function woe(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function FT(n,e){var t=n.__data__;return woe(e)?t[typeof e=="string"?"string":"hash"]:t.map}function xoe(n){var e=FT(this,n).delete(n);return this.size-=e?1:0,e}function Coe(n){return FT(this,n).get(n)}function Eoe(n){return FT(this,n).has(n)}function Toe(n,e){var t=FT(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}function fh(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}fh.prototype.clear=boe;fh.prototype.delete=xoe;fh.prototype.get=Coe;fh.prototype.has=Eoe;fh.prototype.set=Toe;var Ioe="Expected a function";function RO(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError(Ioe);var t=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=t.cache;if(s.has(r))return s.get(r);var o=n.apply(this,i);return t.cache=s.set(r,o)||s,o};return t.cache=new(RO.Cache||fh),t}RO.Cache=fh;var Soe=500;function Poe(n){var e=RO(n,function(i){return t.size===Soe&&t.clear(),i}),t=e.cache;return e}var Moe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Roe=/\\(\\)?/g,Doe=Poe(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(Moe,function(t,i,r,s){e.push(r?s.replace(Roe,"$1"):i||t)}),e});function nh(n){return n==null?"":X0(n)}function Jv(n,e){return Rt(n)?n:MO(n,e)?[n]:Doe(nh(n))}var koe=1/0;function Zv(n){if(typeof n=="string"||Lp(n))return n;var e=n+"";return e=="0"&&1/n==-koe?"-0":e}function J0(n,e){e=Jv(e,n);for(var t=0,i=e.length;n!=null&&t<i;)n=n[Zv(e[t++])];return t&&t==i?n:void 0}function We(n,e,t){var i=n==null?void 0:J0(n,e);return i===void 0?t:i}function DO(n,e){for(var t=-1,i=e.length,r=n.length;++t<i;)n[r+t]=e[t];return n}var vB=il?il.isConcatSpreadable:void 0;function Ooe(n){return Rt(n)||mv(n)||!!(vB&&n&&n[vB])}function kO(n,e,t,i,r){var s=-1,o=n.length;for(t||(t=Ooe),r||(r=[]);++s<o;){var a=n[s];e>0&&t(a)?e>1?kO(a,e-1,t,i,r):DO(r,a):i||(r[r.length]=a)}return r}function b8(n){var e=n==null?0:n.length;return e?kO(n,1):[]}function w8(n){return f8(p8(n,void 0,b8),n+"")}var OO=y8(Object.getPrototypeOf,Object),Loe="[object Object]",Noe=Function.prototype,Boe=Object.prototype,x8=Noe.toString,Foe=Boe.hasOwnProperty,Uoe=x8.call(Object);function Id(n){if(!Qo(n)||nc(n)!=Loe)return!1;var e=OO(n);if(e===null)return!0;var t=Foe.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&x8.call(t)==Uoe}var Goe="[object DOMException]",Hoe="[object Error]";function C8(n){if(!Qo(n))return!1;var e=nc(n);return e==Hoe||e==Goe||typeof n.message=="string"&&typeof n.name=="string"&&!Id(n)}var Voe=OT(function(n,e){try{return d8(n,void 0,e)}catch(t){return C8(t)?t:new Error(t)}});function LO(n,e,t){var i=-1,r=n.length;e<0&&(e=-e>r?0:r+e),t=t>r?r:t,t<0&&(t+=r),r=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=n[i+e];return s}function E8(n,e,t){var i=n.length;return t=t===void 0?i:t,!e&&t>=i?n:LO(n,e,t)}var zoe="\\ud800-\\udfff",$oe="\\u0300-\\u036f",Woe="\\ufe20-\\ufe2f",joe="\\u20d0-\\u20ff",Qoe=$oe+Woe+joe,Xoe="\\ufe0e\\ufe0f",Yoe="\\u200d",qoe=RegExp("["+Yoe+zoe+Qoe+Xoe+"]");function T8(n){return qoe.test(n)}function Koe(n){return n.split("")}var I8="\\ud800-\\udfff",Joe="\\u0300-\\u036f",Zoe="\\ufe20-\\ufe2f",eae="\\u20d0-\\u20ff",tae=Joe+Zoe+eae,nae="\\ufe0e\\ufe0f",iae="["+I8+"]",iM="["+tae+"]",rM="\\ud83c[\\udffb-\\udfff]",rae="(?:"+iM+"|"+rM+")",S8="[^"+I8+"]",P8="(?:\\ud83c[\\udde6-\\uddff]){2}",M8="[\\ud800-\\udbff][\\udc00-\\udfff]",sae="\\u200d",R8=rae+"?",D8="["+nae+"]?",oae="(?:"+sae+"(?:"+[S8,P8,M8].join("|")+")"+D8+R8+")*",aae=D8+R8+oae,lae="(?:"+[S8+iM+"?",iM,P8,M8,iae].join("|")+")",cae=RegExp(rM+"(?="+rM+")|"+lae+aae,"g");function uae(n){return n.match(cae)||[]}function sM(n){return T8(n)?uae(n):Koe(n)}function hae(n){return function(e){e=nh(e);var t=T8(e)?sM(e):void 0,i=t?t[0]:e.charAt(0),r=t?E8(t,1).join(""):e.slice(1);return i[n]()+r}}var dae=hae("toUpperCase");function fae(n,e,t,i){var r=-1,s=n==null?0:n.length;for(i&&s&&(t=n[++r]);++r<s;)t=e(t,n[r],r,n);return t}function pae(n){return function(e){return n==null?void 0:n[e]}}var gae=dl.isFinite,mae=Math.min;function NO(n){var e=Math[n];return function(t,i){if(t=aC(t),i=i==null?0:mae(rg(i),292),i&&gae(t)){var r=(nh(t)+"e").split("e"),s=e(r[0]+"e"+(+r[1]+i));return r=(nh(s)+"e").split("e"),+(r[0]+"e"+(+r[1]-i))}return e(t)}}var k8=NO("ceil"),vae=Math.ceil,_ae=Math.max;function yae(n,e,t){(t?gv(n,e,t):e===void 0)?e=1:e=_ae(rg(e),0);var i=n==null?0:n.length;if(!i||e<1)return[];for(var r=0,s=0,o=Array(vae(i/e));r<i;)o[s++]=LO(n,r,r+=e);return o}function O8(n,e,t){return n===n&&(t!==void 0&&(n=n<=t?n:t),e!==void 0&&(n=n>=e?n:e)),n}function Aae(){this.__data__=new dh,this.size=0}function bae(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function wae(n){return this.__data__.get(n)}function xae(n){return this.__data__.has(n)}var Cae=200;function Eae(n,e){var t=this.__data__;if(t instanceof dh){var i=t.__data__;if(!Zy||i.length<Cae-1)return i.push([n,e]),this.size=++t.size,this;t=this.__data__=new fh(i)}return t.set(n,e),this.size=t.size,this}function Xl(n){var e=this.__data__=new dh(n);this.size=e.size}Xl.prototype.clear=Aae;Xl.prototype.delete=bae;Xl.prototype.get=wae;Xl.prototype.has=xae;Xl.prototype.set=Eae;function Tae(n,e){return n&&ag(e,Ks(e),n)}function Iae(n,e){return n&&ag(e,Kv(e),n)}var L8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_B=L8&&typeof module=="object"&&module&&!module.nodeType&&module,Sae=_B&&_B.exports===L8,yB=Sae?dl.Buffer:void 0,AB=yB?yB.allocUnsafe:void 0;function N8(n,e){if(e)return n.slice();var t=n.length,i=AB?AB(t):new n.constructor(t);return n.copy(i),i}function BO(n,e){for(var t=-1,i=n==null?0:n.length,r=0,s=[];++t<i;){var o=n[t];e(o,t,n)&&(s[r++]=o)}return s}function B8(){return[]}var Pae=Object.prototype,Mae=Pae.propertyIsEnumerable,bB=Object.getOwnPropertySymbols,FO=bB?function(n){return n==null?[]:(n=Object(n),BO(bB(n),function(e){return Mae.call(n,e)}))}:B8;function Rae(n,e){return ag(n,FO(n),e)}var Dae=Object.getOwnPropertySymbols,F8=Dae?function(n){for(var e=[];n;)DO(e,FO(n)),n=OO(n);return e}:B8;function kae(n,e){return ag(n,F8(n),e)}function U8(n,e,t){var i=e(n);return Rt(n)?i:DO(i,t(n))}function oM(n){return U8(n,Ks,FO)}function G8(n){return U8(n,Kv,F8)}var aM=og(dl,"DataView"),lM=og(dl,"Promise"),Sm=og(dl,"Set"),wB="[object Map]",Oae="[object Object]",xB="[object Promise]",CB="[object Set]",EB="[object WeakMap]",TB="[object DataView]",Lae=sg(aM),Nae=sg(Zy),Bae=sg(lM),Fae=sg(Sm),Uae=sg(nM),tf=nc;(aM&&tf(new aM(new ArrayBuffer(1)))!=TB||Zy&&tf(new Zy)!=wB||lM&&tf(lM.resolve())!=xB||Sm&&tf(new Sm)!=CB||nM&&tf(new nM)!=EB)&&(tf=function(n){var e=nc(n),t=e==Oae?n.constructor:void 0,i=t?sg(t):"";if(i)switch(i){case Lae:return TB;case Nae:return wB;case Bae:return xB;case Fae:return CB;case Uae:return EB}return e});const Bp=tf;var Gae=Object.prototype,Hae=Gae.hasOwnProperty;function Vae(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&Hae.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var cC=dl.Uint8Array;function UO(n){var e=new n.constructor(n.byteLength);return new cC(e).set(new cC(n)),e}function zae(n,e){var t=e?UO(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}var $ae=/\w*$/;function Wae(n){var e=new n.constructor(n.source,$ae.exec(n));return e.lastIndex=n.lastIndex,e}var IB=il?il.prototype:void 0,SB=IB?IB.valueOf:void 0;function jae(n){return SB?Object(SB.call(n)):{}}function H8(n,e){var t=e?UO(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var Qae="[object Boolean]",Xae="[object Date]",Yae="[object Map]",qae="[object Number]",Kae="[object RegExp]",Jae="[object Set]",Zae="[object String]",ele="[object Symbol]",tle="[object ArrayBuffer]",nle="[object DataView]",ile="[object Float32Array]",rle="[object Float64Array]",sle="[object Int8Array]",ole="[object Int16Array]",ale="[object Int32Array]",lle="[object Uint8Array]",cle="[object Uint8ClampedArray]",ule="[object Uint16Array]",hle="[object Uint32Array]";function dle(n,e,t){var i=n.constructor;switch(e){case tle:return UO(n);case Qae:case Xae:return new i(+n);case nle:return zae(n,t);case ile:case rle:case sle:case ole:case ale:case lle:case cle:case ule:case hle:return H8(n,t);case Yae:return new i;case qae:case Zae:return new i(n);case Kae:return Wae(n);case Jae:return new i;case ele:return jae(n)}}function V8(n){return typeof n.constructor=="function"&&!LT(n)?jre(OO(n)):{}}var fle="[object Map]";function ple(n){return Qo(n)&&Bp(n)==fle}var PB=_v&&_v.isMap,gle=PB?K0(PB):ple,mle="[object Set]";function vle(n){return Qo(n)&&Bp(n)==mle}var MB=_v&&_v.isSet,_le=MB?K0(MB):vle,yle=1,Ale=2,ble=4,z8="[object Arguments]",wle="[object Array]",xle="[object Boolean]",Cle="[object Date]",Ele="[object Error]",$8="[object Function]",Tle="[object GeneratorFunction]",Ile="[object Map]",Sle="[object Number]",W8="[object Object]",Ple="[object RegExp]",Mle="[object Set]",Rle="[object String]",Dle="[object Symbol]",kle="[object WeakMap]",Ole="[object ArrayBuffer]",Lle="[object DataView]",Nle="[object Float32Array]",Ble="[object Float64Array]",Fle="[object Int8Array]",Ule="[object Int16Array]",Gle="[object Int32Array]",Hle="[object Uint8Array]",Vle="[object Uint8ClampedArray]",zle="[object Uint16Array]",$le="[object Uint32Array]",Ni={};Ni[z8]=Ni[wle]=Ni[Ole]=Ni[Lle]=Ni[xle]=Ni[Cle]=Ni[Nle]=Ni[Ble]=Ni[Fle]=Ni[Ule]=Ni[Gle]=Ni[Ile]=Ni[Sle]=Ni[W8]=Ni[Ple]=Ni[Mle]=Ni[Rle]=Ni[Dle]=Ni[Hle]=Ni[Vle]=Ni[zle]=Ni[$le]=!0;Ni[Ele]=Ni[$8]=Ni[kle]=!1;function Pm(n,e,t,i,r,s){var o,a=e&yle,l=e&Ale,c=e&ble;if(t&&(o=r?t(n,i,r,s):t(n)),o!==void 0)return o;if(!vs(n))return n;var u=Rt(n);if(u){if(o=Vae(n),!a)return EO(n,o)}else{var h=Bp(n),d=h==$8||h==Tle;if(vv(n))return N8(n,a);if(h==W8||h==z8||d&&!r){if(o=l||d?{}:V8(n),!a)return l?kae(n,Iae(o,n)):Rae(n,Tae(o,n))}else{if(!Ni[h])return r?n:{};o=dle(n,h,a)}}s||(s=new Xl);var f=s.get(n);if(f)return f;s.set(n,o),_le(n)?n.forEach(function(m){o.add(Pm(m,e,t,m,n,s))}):gle(n)&&n.forEach(function(m,v){o.set(v,Pm(m,e,t,v,n,s))});var p=c?l?G8:oM:l?Kv:Ks,g=u?void 0:p(n);return tse(g||n,function(m,v){g&&(v=m,m=n[v]),IO(o,v,Pm(m,e,t,v,n,s))}),o}var Wle=4;function jle(n){return Pm(n,Wle)}var Qle=1,Xle=4;function pn(n){return Pm(n,Qle|Xle)}var Yle="__lodash_hash_undefined__";function qle(n){return this.__data__.set(n,Yle),this}function Kle(n){return this.__data__.has(n)}function eA(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new fh;++e<t;)this.add(n[e])}eA.prototype.add=eA.prototype.push=qle;eA.prototype.has=Kle;function j8(n,e){for(var t=-1,i=n==null?0:n.length;++t<i;)if(e(n[t],t,n))return!0;return!1}function Q8(n,e){return n.has(e)}var Jle=1,Zle=2;function X8(n,e,t,i,r,s){var o=t&Jle,a=n.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(n),u=s.get(e);if(c&&u)return c==e&&u==n;var h=-1,d=!0,f=t&Zle?new eA:void 0;for(s.set(n,e),s.set(e,n);++h<a;){var p=n[h],g=e[h];if(i)var m=o?i(g,p,h,e,n,s):i(p,g,h,n,e,s);if(m!==void 0){if(m)continue;d=!1;break}if(f){if(!j8(e,function(v,_){if(!Q8(f,_)&&(p===v||r(p,v,t,i,s)))return f.push(_)})){d=!1;break}}else if(!(p===g||r(p,g,t,i,s))){d=!1;break}}return s.delete(n),s.delete(e),d}function Y8(n){var e=-1,t=Array(n.size);return n.forEach(function(i,r){t[++e]=[r,i]}),t}function GO(n){var e=-1,t=Array(n.size);return n.forEach(function(i){t[++e]=i}),t}var ece=1,tce=2,nce="[object Boolean]",ice="[object Date]",rce="[object Error]",sce="[object Map]",oce="[object Number]",ace="[object RegExp]",lce="[object Set]",cce="[object String]",uce="[object Symbol]",hce="[object ArrayBuffer]",dce="[object DataView]",RB=il?il.prototype:void 0,rS=RB?RB.valueOf:void 0;function fce(n,e,t,i,r,s,o){switch(t){case dce:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case hce:return!(n.byteLength!=e.byteLength||!s(new cC(n),new cC(e)));case nce:case ice:case oce:return qv(+n,+e);case rce:return n.name==e.name&&n.message==e.message;case ace:case cce:return n==e+"";case sce:var a=Y8;case lce:var l=i&ece;if(a||(a=GO),n.size!=e.size&&!l)return!1;var c=o.get(n);if(c)return c==e;i|=tce,o.set(n,e);var u=X8(a(n),a(e),i,r,s,o);return o.delete(n),u;case uce:if(rS)return rS.call(n)==rS.call(e)}return!1}var pce=1,gce=Object.prototype,mce=gce.hasOwnProperty;function vce(n,e,t,i,r,s){var o=t&pce,a=oM(n),l=a.length,c=oM(e),u=c.length;if(l!=u&&!o)return!1;for(var h=l;h--;){var d=a[h];if(!(o?d in e:mce.call(e,d)))return!1}var f=s.get(n),p=s.get(e);if(f&&p)return f==e&&p==n;var g=!0;s.set(n,e),s.set(e,n);for(var m=o;++h<l;){d=a[h];var v=n[d],_=e[d];if(i)var y=o?i(_,v,d,e,n,s):i(v,_,d,n,e,s);if(!(y===void 0?v===_||r(v,_,t,i,s):y)){g=!1;break}m||(m=d=="constructor")}if(g&&!m){var A=n.constructor,w=e.constructor;A!=w&&"constructor"in n&&"constructor"in e&&!(typeof A=="function"&&A instanceof A&&typeof w=="function"&&w instanceof w)&&(g=!1)}return s.delete(n),s.delete(e),g}var _ce=1,DB="[object Arguments]",kB="[object Array]",Eb="[object Object]",yce=Object.prototype,OB=yce.hasOwnProperty;function Ace(n,e,t,i,r,s){var o=Rt(n),a=Rt(e),l=o?kB:Bp(n),c=a?kB:Bp(e);l=l==DB?Eb:l,c=c==DB?Eb:c;var u=l==Eb,h=c==Eb,d=l==c;if(d&&vv(n)){if(!vv(e))return!1;o=!0,u=!1}if(d&&!u)return s||(s=new Xl),o||NT(n)?X8(n,e,t,i,r,s):fce(n,e,l,t,i,r,s);if(!(t&_ce)){var f=u&&OB.call(n,"__wrapped__"),p=h&&OB.call(e,"__wrapped__");if(f||p){var g=f?n.value():n,m=p?e.value():e;return s||(s=new Xl),r(g,m,t,i,s)}}return d?(s||(s=new Xl),vce(n,e,t,i,r,s)):!1}function UT(n,e,t,i,r){return n===e?!0:n==null||e==null||!Qo(n)&&!Qo(e)?n!==n&&e!==e:Ace(n,e,t,i,UT,r)}var bce=1,wce=2;function xce(n,e,t,i){var r=t.length,s=r,o=!i;if(n==null)return!s;for(n=Object(n);r--;){var a=t[r];if(o&&a[2]?a[1]!==n[a[0]]:!(a[0]in n))return!1}for(;++r<s;){a=t[r];var l=a[0],c=n[l],u=a[1];if(o&&a[2]){if(c===void 0&&!(l in n))return!1}else{var h=new Xl;if(i)var d=i(c,u,l,n,e,h);if(!(d===void 0?UT(u,c,bce|wce,i,h):d))return!1}}return!0}function q8(n){return n===n&&!vs(n)}function Cce(n){for(var e=Ks(n),t=e.length;t--;){var i=e[t],r=n[i];e[t]=[i,r,q8(r)]}return e}function K8(n,e){return function(t){return t==null?!1:t[n]===e&&(e!==void 0||n in Object(t))}}function Ece(n){var e=Cce(n);return e.length==1&&e[0][2]?K8(e[0][0],e[0][1]):function(t){return t===n||xce(t,n,e)}}function Tce(n,e){return n!=null&&e in Object(n)}function J8(n,e,t){e=Jv(e,n);for(var i=-1,r=e.length,s=!1;++i<r;){var o=Zv(e[i]);if(!(s=n!=null&&t(n,o)))break;n=n[o]}return s||++i!=r?s:(r=n==null?0:n.length,!!r&&SO(r)&&q0(o,r)&&(Rt(n)||mv(n)))}function Z8(n,e){return n!=null&&J8(n,e,Tce)}var Ice=1,Sce=2;function Pce(n,e){return MO(n)&&q8(e)?K8(Zv(n),e):function(t){var i=We(t,n);return i===void 0&&i===e?Z8(t,n):UT(e,i,Ice|Sce)}}function Mce(n){return function(e){return e==null?void 0:e[n]}}function Rce(n){return function(e){return J0(e,n)}}function Dce(n){return MO(n)?Mce(Zv(n)):Rce(n)}function ic(n){return typeof n=="function"?n:n==null?Yv:typeof n=="object"?Rt(n)?Pce(n[0],n[1]):Ece(n):Dce(n)}function kce(n,e,t,i){for(var r=-1,s=n==null?0:n.length;++r<s;){var o=n[r];e(i,o,t(o),n)}return i}function Oce(n){return function(e,t,i){for(var r=-1,s=Object(e),o=i(e),a=o.length;a--;){var l=o[n?a:++r];if(t(s[l],l,s)===!1)break}return e}}var ej=Oce();function Lce(n,e){return n&&ej(n,e,Ks)}function Nce(n,e){return function(t,i){if(t==null)return t;if(!hh(t))return n(t,i);for(var r=t.length,s=e?r:-1,o=Object(t);(e?s--:++s<r)&&i(o[s],s,o)!==!1;);return t}}var Z0=Nce(Lce);function Bce(n,e,t,i){return Z0(n,function(r,s,o){e(i,r,t(r),o)}),i}function Fce(n,e){return function(t,i){var r=Rt(t)?kce:Bce,s=e?e():{};return r(t,n,ic(i),s)}}var sS=function(){return dl.Date.now()},Uce="Expected a function",Gce=Math.max,Hce=Math.min;function Fc(n,e,t){var i,r,s,o,a,l,c=0,u=!1,h=!1,d=!0;if(typeof n!="function")throw new TypeError(Uce);e=aC(e)||0,vs(t)&&(u=!!t.leading,h="maxWait"in t,s=h?Gce(aC(t.maxWait)||0,e):s,d="trailing"in t?!!t.trailing:d);function f(b){var C=i,I=r;return i=r=void 0,c=b,o=n.apply(I,C),o}function p(b){return c=b,a=setTimeout(v,e),u?f(b):o}function g(b){var C=b-l,I=b-c,x=e-C;return h?Hce(x,s-I):x}function m(b){var C=b-l,I=b-c;return l===void 0||C>=e||C<0||h&&I>=s}function v(){var b=sS();if(m(b))return _(b);a=setTimeout(v,g(b))}function _(b){return a=void 0,d&&i?f(b):(i=r=void 0,o)}function y(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function A(){return a===void 0?o:_(sS())}function w(){var b=sS(),C=m(b);if(i=arguments,r=this,l=b,C){if(a===void 0)return p(l);if(h)return clearTimeout(a),a=setTimeout(v,e),f(l)}return a===void 0&&(a=setTimeout(v,e)),o}return w.cancel=y,w.flush=A,w}function cM(n,e,t){(t!==void 0&&!qv(n[e],t)||t===void 0&&!(e in n))&&kT(n,e,t)}function Vce(n){return Qo(n)&&hh(n)}function uM(n,e){if(!(e==="constructor"&&typeof n[e]=="function")&&e!="__proto__")return n[e]}function zce(n){return ag(n,Kv(n))}function $ce(n,e,t,i,r,s,o){var a=uM(n,t),l=uM(e,t),c=o.get(l);if(c){cM(n,t,c);return}var u=s?s(a,l,t+"",n,e,o):void 0,h=u===void 0;if(h){var d=Rt(l),f=!d&&vv(l),p=!d&&!f&&NT(l);u=l,d||f||p?Rt(a)?u=a:Vce(a)?u=EO(a):f?(h=!1,u=N8(l,!0)):p?(h=!1,u=H8(l,!0)):u=[]:Id(l)||mv(l)?(u=a,mv(a)?u=zce(a):(!vs(a)||mt(a))&&(u=V8(l))):h=!1}h&&(o.set(l,u),r(u,l,i,s,o),o.delete(l)),cM(n,t,u)}function HO(n,e,t,i,r){n!==e&&ej(e,function(s,o){if(r||(r=new Xl),vs(s))$ce(n,e,o,t,HO,i,r);else{var a=i?i(uM(n,o),s,o+"",n,e,r):void 0;a===void 0&&(a=s),cM(n,o,a)}},Kv)}var tj=PO(function(n,e,t,i){HO(n,e,t,i)});function Wce(n,e,t){for(var i=-1,r=n==null?0:n.length;++i<r;)if(t(e,n[i]))return!0;return!1}function jce(n){var e=n==null?0:n.length;return e?n[e-1]:void 0}function Qce(n,e,t){n=nh(n),e=X0(e);var i=n.length;t=t===void 0?i:O8(rg(t),0,i);var r=t;return t-=e.length,t>=0&&n.slice(t,r)==e}function Xce(n,e){return Xu(e,function(t){return[t,n[t]]})}function Yce(n){var e=-1,t=Array(n.size);return n.forEach(function(i){t[++e]=[i,i]}),t}var qce="[object Map]",Kce="[object Set]";function Jce(n){return function(e){var t=Bp(e);return t==qce?Y8(e):t==Kce?Yce(e):Xce(e,n(e))}}var Zce=Jce(Ks),eue={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tue=pae(eue);const nue=tue;var nj=/[&<>"']/g,iue=RegExp(nj.source);function rue(n){return n=nh(n),n&&iue.test(n)?n.replace(nj,nue):n}function ij(n,e){var t=[];return Z0(n,function(i,r,s){e(i,r,s)&&t.push(i)}),t}function uC(n,e){var t=Rt(n)?BO:ij;return t(n,ic(e))}function rj(n){return function(e,t,i){var r=Object(e);if(!hh(e)){var s=ic(t);e=Ks(e),t=function(a){return s(r[a],a,r)}}var o=n(e,t,i);return o>-1?r[s?e[o]:o]:void 0}}var sue=Math.max;function pd(n,e,t){var i=n==null?0:n.length;if(!i)return-1;var r=t==null?0:rg(t);return r<0&&(r=sue(i+r,0)),TO(n,ic(e),r)}var Bo=rj(pd),oue=Math.max,aue=Math.min;function lue(n,e,t){var i=n==null?0:n.length;if(!i)return-1;var r=i-1;return t!==void 0&&(r=rg(t),r=t<0?oue(i+r,0):aue(r,i-1)),TO(n,ic(e),r,!0)}var cue=rj(lue);function sj(n,e){var t=-1,i=hh(n)?Array(n.length):[];return Z0(n,function(r,s,o){i[++t]=e(r,s,o)}),i}function Zi(n,e){var t=Rt(n)?Xu:sj;return t(n,ic(e))}var oj=NO("floor"),uue=Object.prototype,hue=uue.hasOwnProperty,Fr=Fce(function(n,e,t){hue.call(n,t)?n[t].push(e):kT(n,t,[e])});function due(n,e){return n>e}var fue=Object.prototype,pue=fue.hasOwnProperty;function gue(n,e){return n!=null&&pue.call(n,e)}function Ds(n,e){return n!=null&&J8(n,e,gue)}var mue="[object String]";function pi(n){return typeof n=="string"||!Rt(n)&&Qo(n)&&nc(n)==mue}function aj(n,e){return Xu(e,function(t){return n[t]})}function vue(n){return n==null?[]:aj(n,Ks(n))}var _ue=Math.max;function da(n,e,t,i){n=hh(n)?n:vue(n),t=t&&!i?rg(t):0;var r=n.length;return t<0&&(t=_ue(r+t,0)),pi(n)?t<=r&&n.indexOf(e,t)>-1:!!r&&Y0(n,e,t)>-1}function yue(n,e){return e.length<2?n:J0(n,LO(e,0,-1))}var Aue="[object Boolean]";function tA(n){return n===!0||n===!1||Qo(n)&&nc(n)==Aue}var bue="[object Map]",wue="[object Set]",xue=Object.prototype,Cue=xue.hasOwnProperty;function wt(n){if(n==null)return!0;if(hh(n)&&(Rt(n)||typeof n=="string"||typeof n.splice=="function"||vv(n)||NT(n)||mv(n)))return!n.length;var e=Bp(n);if(e==bue||e==wue)return!n.size;if(LT(n))return!A8(n).length;for(var t in n)if(Cue.call(n,t))return!1;return!0}function Fl(n,e){return UT(n,e)}var Eue="[object Number]";function tn(n){return typeof n=="number"||Qo(n)&&nc(n)==Eue}function hC(n){return tn(n)&&n!=+n}function Fp(n){return n==null}function cr(n){return n===null}function gi(n){return n===void 0}function Tue(n,e,t){for(var i=-1,r=n.length;++i<r;){var s=n[i],o=e(s);if(o!=null&&(a===void 0?o===o&&!Lp(o):t(o,a)))var a=o,l=s}return l}function lj(n){return n&&n.length?Tue(n,Yv,due):void 0}function Iue(n,e){for(var t,i=-1,r=n.length;++i<r;){var s=e(n[i]);s!==void 0&&(t=t===void 0?s:t+s)}return t}var Ln=PO(function(n,e,t){HO(n,e,t)}),Sue="Expected a function";function Pue(n){if(typeof n!="function")throw new TypeError(Sue);return function(){var e=arguments;switch(e.length){case 0:return!n.call(this);case 1:return!n.call(this,e[0]);case 2:return!n.call(this,e[0],e[1]);case 3:return!n.call(this,e[0],e[1],e[2])}return!n.apply(this,e)}}function cj(n,e){return e=Jv(e,n),n=yue(n,e),n==null||delete n[Zv(jce(e))]}function Mue(n){return Id(n)?void 0:n}var Rue=1,Due=2,kue=4,eb=w8(function(n,e){var t={};if(n==null)return t;var i=!1;e=Xu(e,function(s){return s=Jv(s,n),i||(i=s.length>1),s}),ag(n,G8(n),t),i&&(t=Pm(t,Rue|Due|kue,Mue));for(var r=e.length;r--;)cj(t,e[r]);return t});function uj(n,e,t,i){if(!vs(n))return n;e=Jv(e,n);for(var r=-1,s=e.length,o=s-1,a=n;a!=null&&++r<s;){var l=Zv(e[r]),c=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(r!=o){var u=a[l];c=i?i(u,l,a):void 0,c===void 0&&(c=vs(u)?u:q0(e[r+1])?[]:{})}IO(a,l,c),a=a[l]}return n}function Oue(n,e,t){for(var i=-1,r=e.length,s={};++i<r;){var o=e[i],a=J0(n,o);t(a,o)&&uj(s,Jv(o,n),a)}return s}function Lue(n,e){var t=n.length;for(n.sort(e);t--;)n[t]=n[t].value;return n}function Nue(n,e){if(n!==e){var t=n!==void 0,i=n===null,r=n===n,s=Lp(n),o=e!==void 0,a=e===null,l=e===e,c=Lp(e);if(!a&&!c&&!s&&n>e||s&&o&&l&&!a&&!c||i&&o&&l||!t&&l||!r)return 1;if(!i&&!s&&!c&&n<e||c&&t&&r&&!i&&!s||a&&t&&r||!o&&r||!l)return-1}return 0}function Bue(n,e,t){for(var i=-1,r=n.criteria,s=e.criteria,o=r.length,a=t.length;++i<o;){var l=Nue(r[i],s[i]);if(l){if(i>=a)return l;var c=t[i];return l*(c=="desc"?-1:1)}}return n.index-e.index}function Fue(n,e,t){e.length?e=Xu(e,function(s){return Rt(s)?function(o){return J0(o,s.length===1?s[0]:s)}:s}):e=[Yv];var i=-1;e=Xu(e,K0(ic));var r=sj(n,function(s,o,a){var l=Xu(e,function(c){return c(s)});return{criteria:l,index:++i,value:s}});return Lue(r,function(s,o){return Bue(s,o,t)})}function Uue(n,e){return Oue(n,e,function(t,i){return Z8(n,i)})}var gr=w8(function(n,e){return n==null?{}:Uue(n,e)});function Gue(n,e,t,i){for(var r=t-1,s=n.length;++r<s;)if(i(n[r],e))return r;return-1}var Hue=Array.prototype,LB=Hue.splice;function Vue(n,e,t,i){var r=i?Gue:Y0,s=-1,o=e.length,a=n;for(n===e&&(e=EO(e)),t&&(a=Xu(n,K0(t)));++s<o;)for(var l=0,c=e[s],u=t?t(c):c;(l=r(a,u,l,i))>-1;)a!==n&&LB.call(a,l,1),LB.call(n,l,1);return n}function zue(n,e){return n&&n.length&&e&&e.length?Vue(n,e):n}var $ue=OT(zue),Wue=Array.prototype,jue=Wue.splice;function Que(n,e){for(var t=n?e.length:0,i=t-1;t--;){var r=e[t];if(t==i||r!==s){var s=r;q0(r)?jue.call(n,r,1):cj(n,r)}}return n}function Xue(n,e,t,i,r){return r(n,function(s,o,a){t=i?(i=!1,s):e(t,s,o,a)}),t}function Yue(n,e,t){var i=Rt(n)?fae:Xue,r=arguments.length<3;return i(n,ic(e),t,r,Z0)}function que(n,e){var t=Rt(n)?BO:ij;return t(n,Pue(ic(e)))}function dC(n,e){var t=[];if(!(n&&n.length))return t;var i=-1,r=[],s=n.length;for(e=ic(e);++i<s;){var o=n[i];e(o,i,n)&&(t.push(o),r.push(i))}return Que(n,r),t}var Kue=Array.prototype,Jue=Kue.reverse;function hj(n){return n==null?n:Jue.call(n)}var hM=NO("round");function Ft(n,e,t){return n==null?n:uj(n,e,t)}function Zue(n,e){var t;return Z0(n,function(i,r,s){return t=e(i,r,s),!t}),!!t}function ehe(n,e,t){var i=Rt(n)?j8:Zue;return t&&gv(n,e,t)&&(e=void 0),i(n,ic(e))}var Wa=OT(function(n,e){if(n==null)return[];var t=e.length;return t>1&&gv(n,e[0],e[1])?e=[]:t>2&&gv(e[0],e[1],e[2])&&(e=[e[0]]),Fue(n,kO(e,1),[])});function the(n,e,t){return n=nh(n),t=t==null?0:O8(rg(t),0,n.length),e=X0(e),n.slice(t,t+e.length)==e}function nhe(n){return n&&n.length?Iue(n,Yv):0}var dj=Object.prototype,ihe=dj.hasOwnProperty;function NB(n,e,t,i){return n===void 0||qv(n,dj[t])&&!ihe.call(i,t)?e:n}var rhe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function she(n){return"\\"+rhe[n]}var ohe=/<%=([\s\S]+?)%>/g;const fj=ohe;var ahe=/<%-([\s\S]+?)%>/g;const lhe=ahe;var che=/<%([\s\S]+?)%>/g;const uhe=che;var BB={escape:lhe,evaluate:uhe,interpolate:fj,variable:"",imports:{_:{escape:rue}}},hhe="Invalid `variable` option passed into `_.template`",dhe=/\b__p \+= '';/g,fhe=/\b(__p \+=) '' \+/g,phe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ghe=/[()=,{}\[\]\/\s]/,mhe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tb=/($^)/,vhe=/['\n\r\u2028\u2029\\]/g,_he=Object.prototype,FB=_he.hasOwnProperty;function yhe(n,e,t){var i=BB.imports._.templateSettings||BB;t&&gv(n,e,t)&&(e=void 0),n=nh(n),e=mB({},e,i,NB);var r=mB({},e.imports,i.imports,NB),s=Ks(r),o=aj(r,s),a,l,c=0,u=e.interpolate||Tb,h="__p += '",d=RegExp((e.escape||Tb).source+"|"+u.source+"|"+(u===fj?mhe:Tb).source+"|"+(e.evaluate||Tb).source+"|$","g"),f=FB.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+`
`:"";n.replace(d,function(m,v,_,y,A,w){return _||(_=y),h+=n.slice(c,w).replace(vhe,she),v&&(a=!0,h+=`' +
__e(`+v+`) +
'`),A&&(l=!0,h+=`';
`+A+`;
__p += '`),_&&(h+=`' +
((__t = (`+_+`)) == null ? '' : __t) +
'`),c=w+m.length,m}),h+=`';
`;var p=FB.call(e,"variable")&&e.variable;if(!p)h=`with (obj) {
`+h+`
}
`;else if(ghe.test(p))throw new Error(hhe);h=(l?h.replace(dhe,""):h).replace(fhe,"$1").replace(phe,"$1;"),h="function("+(p||"obj")+`) {
`+(p?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(a?", __e = _.escape":"")+(l?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+h+`return __p
}`;var g=Voe(function(){return Function(s,f+"return "+h).apply(void 0,o)});if(g.source=h,C8(g))throw g;return g}var Ahe="Expected a function";function bhe(n,e,t){var i=!0,r=!0;if(typeof n!="function")throw new TypeError(Ahe);return vs(t)&&(i="leading"in t?!!t.leading:i,r="trailing"in t?!!t.trailing:r),Fc(n,e,{leading:i,maxWait:e,trailing:r})}function whe(n,e){for(var t=n.length;t--&&Y0(e,n[t],0)>-1;);return t}function xhe(n,e){for(var t=-1,i=n.length;++t<i&&Y0(e,n[t],0)>-1;);return t}function pj(n,e,t){if(n=nh(n),n&&(t||e===void 0))return h8(n);if(!n||!(e=X0(e)))return n;var i=sM(n),r=sM(e),s=xhe(i,r),o=whe(i,r)+1;return E8(i,s,o).join("")}var Che=1/0,Ehe=Sm&&1/GO(new Sm([,-0]))[1]==Che?function(n){return new Sm(n)}:Qre,The=200;function Ihe(n,e,t){var i=-1,r=rse,s=n.length,o=!0,a=[],l=a;if(t)o=!1,r=Wce;else if(s>=The){var c=e?null:Ehe(n);if(c)return GO(c);o=!1,r=Q8,l=new eA}else l=e?[]:a;e:for(;++i<s;){var u=n[i],h=e?e(u):u;if(u=t||u!==0?u:0,o&&h===h){for(var d=l.length;d--;)if(l[d]===h)continue e;e&&l.push(h),a.push(u)}else r(l,h,t)||(l!==a&&l.push(h),a.push(u))}return a}function Ja(n){return n&&n.length?Ihe(n):[]}const She="xcs-www",sm={LOG:"log",INFO:"info",ERROR:"error",WARN:"warn",DEBUG:"debug"};function Rx(n){if(Array.isArray(n)){const t=n.slice(0,3);return n.length>3&&t.push(`... ${n.length-3} more data.`),t.map(i=>Rx(i))}else if(typeof n=="object"&&n!==null){const t=Object.keys(n),i=t.slice(0,3),r={};for(const s of i)r[s]=Rx(n[s]);if(Object.keys(n).length>3){for(const s in n)t.includes(s)||(r[s]=Rx(n[s]));r["... more"]=t.slice(2,t.length-1)}return r}else return n}const Phe=(n,e)=>{if(e===sm.ERROR){const[t]=n;if(pi(t))return n;const{message:i,stack:r,reason:s}=t||{};return{message:i,stack:r,reason:s}}return Rx(n)},T_=(n,e)=>{try{if(console&&typeof console[e]=="function"&&console[e](n),window.MeApi){const t=Phe(n,e);window.MeApi.logger.emit(She,e,t)}}catch(t){console.error(["=> write error",t,e,n])}},Tt={log(...n){T_(n,sm.LOG)},info(...n){T_(n,sm.INFO)},error(...n){T_(n,sm.ERROR)},warn(...n){T_(n,sm.WARN)},debug(...n){T_(n,sm.DEBUG)},switchLevel:n=>{var e;return(e=window.MeApi)==null?void 0:e.logger.switchLevel(n)},openLog:()=>{var n;return(n=window.MeApi)==null?void 0:n.logger.openLog()}};var gW;(gW=window.MeApi)==null||gW.openFile;var mW;const Ri=(mW=window.MeApi)==null?void 0:mW.fileHelper;var vW;(vW=window.MeApi)==null||vW.getFontPaths;var _W;(_W=window.MeApi)==null||_W.getOsPlatform;var yW;(yW=window.MeApi)==null||yW.getOsInfo;var AW;(AW=window.MeApi)==null||AW.driver;var bW;(bW=window.MeApi)==null||bW.serial;var wW;(wW=window.MeApi)==null||wW.ping;var xW;(xW=window.MeApi)==null||xW.isMac;var CW;(CW=window.MeApi)==null||CW.isArm;var EW;const GT=(EW=window.MeApi)==null?void 0:EW.version;var TW;(TW=window.MeApi)==null||TW.imageOptimize;var IW;(IW=window.MeApi)==null||IW.svgOptimize;var SW;(SW=window.MeApi)==null||SW.discovery;var PW;(PW=window.MeApi)==null||PW.path;var MW;(MW=window.MeApi)==null||MW.uploadGcode;var RW;(RW=window.MeApi)==null||RW.uploadGcodeNew;var DW;(DW=window.MeApi)==null||DW.mainWindowLoaded;var kW;(kW=window.MeApi)==null||kW.closeWindow;var OW;(OW=window.MeApi)==null||OW.startByUrlScheme;var LW;const Js=(LW=window.MeApi)==null?void 0:LW.appDataPath;var NW;const yr=(NW=window.MeApi)==null?void 0:NW.fs,ca=window==null?void 0:window.xcm,oS=(n,e)=>{var i;let t="";return Object.keys(up).indexOf(n)>=0&&(t=ef.COMMON_VIEW_EVENT_PREFIX),Object.keys(s8).indexOf(n)>=0&&(t=ef.HOME_VIEW_EVENT_PREFIX),Object.keys(o8).indexOf(n)>=0&&(t=ef.PROJECT_VIEW_EVENT_PREFIX),Object.keys(a8).indexOf(n)>=0&&(t=ef.EMBED_PAGE_EVENT_PREFIX),Object.keys(l8).indexOf(n)>=0&&(t=ef.MAIN_PROCESS),Object.keys(CO).indexOf(n)>=0&&(t=ef.MESSAGE_VIEW_EVENT_PREFIX),(i=window.MeApi)==null?void 0:i.postMessageToMain(`${t}${r8}${n}`,e)};var BW;(BW=window.MeApi)==null||BW.sendMessageToMain;var FW;const aS=(FW=window.MeApi)==null?void 0:FW.postMessageToAllView;var UW;(UW=window.MeApi)==null||UW.devices;var GW;const lS=(GW=window.MeApi)==null?void 0:GW.deviceService;var HW;(HW=window.MeApi)==null||HW.sliceImage;async function Mhe(n,e){const t=[];n.forEach(r=>{var s;(s=r==null?void 0:r.displays)==null||s.forEach(o=>{if(o.type===e){const a=o;t.push({base64:a.base64})}})});const i=t.map(r=>Rhe(r.base64).catch(Tt.warn));return Promise.all(i)}function Rhe(n){return new Promise((e,t)=>{const i=new Image;i.onload=()=>{e(i)},i.onerror=()=>{t()},i.src=n})}function nf(n,e={defaultValue:null}){typeof n!="string"&&(n=String(n));let t;try{t=JSON.parse(n),t===null&&(e.defaultValue===null||(e.allowNull??!1)||(t=e.defaultValue))}catch{t=e.defaultValue}return t}function fft(n){return JSON.stringify(n,(i,r)=>r instanceof Map?{dataType:"Map",value:Array.from(r.entries())}:r)}function Dhe(n=!1){return!!nf(localStorage.getItem("ACCURATE_HIT_AREA"),{defaultValue:n})}const khe=100,I_=33143,VO="#2366ff",gj="#fe0002",nA="#000000",ii=VO,Ohe=100,Lhe=[gj,"#ff7f56","#e1c000","#00c715","#00befe",VO,"#a958ff",nA],Nhe={"#fe0002":"{Red}","#ff7f56":"{Orange}","#e1c000":"{Yellow}","#00c715":"{Green}","#00befe":"{Cyan}","#2366ff":"{Blue}","#a958ff":"{Purple}","#000000":"{Black}"},pft={"#fe0002":"editor.layer.red","#ff7f56":"editor.layer.orange","#e1c000":"editor.layer.yellow","#00c715":"editor.layer.green","#00befe":"editor.layer.cyan","#2366ff":"editor.layer.blue","#a958ff":"editor.layer.purple","#000000":"editor.layer.black"};fd.BEST+"",fd.HIGH+"",fd.MEDIUM+"";const UB=[{label:"device.common.grayscale",value:"grayscale"},{label:"device.common.jarvis",value:"Jarvis"},{label:"device.common.bayer",value:"Bayer"},{label:"device.common.floyd",value:"Floyd"},{label:"device.common.stucki",value:"Stucki"},{label:"device.common.atkinson",value:"Atkinson"},{label:"device.common.sierra",value:"Sierra"}],Bhe="https://s.xtool.com/doc/plug-in/notes";var Sl=(n=>(n.CONNECTED="CONNECTED",n.CLOSED="CLOSED",n.ERROR="ERROR",n.RECEIVE="RECEIVE",n))(Sl||{}),mj=(n=>(n[n.READY=0]="READY",n[n.UPLOADING=1]="UPLOADING",n[n.WORKING=2]="WORKING",n[n.PAUSE=3]="PAUSE",n[n.ABORT=4]="ABORT",n[n.CANCEL=5]="CANCEL",n[n.DONE=6]="DONE",n))(mj||{}),Fhe=(n=>(n.LASER_PLANE="LASER_PLANE",n.LASER_CYLINDER="LASER_CYLINDER",n.FREE_PLANE="FREE_PLANE",n.PASS_THROUGH="PASS_THROUGH",n.KNIFE_CUT="KNIFE_CUT",n.PRINTER_KNIFE_CUT="PRINTER_KNIFE_CUT",n.SUPER_LASER_PLANE="SUPER_LASER_PLANE",n.LASER_CONVEYOR_FEEDER="LASER_CONVEYOR_FEEDER",n.LASER_EXTENDER="LASER_EXTENDER",n.CURVE_PROCESS="CURVE_PROCESS",n.FLOOR_PLANE="FLOOR_PLANE",n.PASSIVE_KNIFE_CUT="PASSIVE_KNIFE_CUT",n.ACTIVE_KNIFE_CUT="ACTIVE_KNIFE_CUT",n.PRESS_PRINT="PRESS_PRINT",n.DISC_PRESS_CUT="DISC_PRESS_CUT",n.BRUSH_PAINTING="BRUSH_PAINTING",n.INK_PRINT="INK_PRINT",n.SCREEN_PRINT="SCREEN_PRINT",n.FREE_COMBINATION="FREE_COMBINATION",n.BATCH_PROCESS="BATCH_PROCESS",n.CONVEYOR_EXTENSION="CONVEYOR_EXTENSION",n))(Fhe||{}),zO=(n=>(n[n.text=0]="text",n[n.textWithArgs=1]="textWithArgs",n[n.textWithEvent=2]="textWithEvent",n))(zO||{});const Uhe={catch_data_empty:"device.process.catch_data_empty",no_elements:"device.process.no_elements",no_vector_elements:"device.process.no_vector_elements",element_out_zoom:"device.process.element_out_zoom",device_is_working:"device.process.device_is_working",request_status_fail:"device.process.request_status_fail",device_is_offline:"device.process.device_is_offline",thickness_is_empty:"device.process.thickness_is_empty"};var Pf=(n=>(n.LEFT="left",n.RIGHT="right",n.TOP="top",n.BOTTOM="bottom",n.CENTER="center",n))(Pf||{}),vj=(n=>(n.P_IDLE="P_IDLE",n.P_WORK="P_WORK",n.UPGRADE="UPGRADE",n.P_SLEEP="P_SLEEP",n.P_ERROR="P_ERROR",n.P_WIFI_CONFIG="P_WIFI_CONFIG",n.P_TESTING="P_TESTING",n.P_MEASURE="P_MEASURE",n.P_WORKING=" P_WORKING",n.WORK="Work",n.P_PAUSE="P_PAUSE",n.P_WORK_DONE="P_WORK_DONE",n.P_USB_KEY_LOCK="P_USB_KEY_LOCK",n.P_AUTOFOCUS="P_AUTOFOCUS",n))(vj||{}),kh=(n=>(n.BITMAP="BITMAP",n.VECTOR="VECTOR",n))(kh||{}),$O=(n=>(n.OUTLINE="outline",n.RECT="rect",n.SCAN="scan",n))($O||{}),_j=(n=>(n.VECTOR_CUTTING="VECTOR_CUTTING",n.VECTOR_ENGRAVING="VECTOR_ENGRAVING",n.FILL_VECTOR_ENGRAVING="FILL_VECTOR_ENGRAVING",n.BITMAP_ENGRAVING="BITMAP_ENGRAVING",n.KNIFE_CUTTING="KNIFE_CUTTING",n.BRUSH_PAINTING_LINE="BRUSH_PAINTING_LINE",n.BRUSH_PAINTING_BLOCK="BRUSH_PAINTING_BLOCK",n.INK_PRINT="INK_PRINT",n))(_j||{}),yj=(n=>(n[n.P2_RULE_ONE=3]="P2_RULE_ONE",n[n.S1=2]="S1",n[n.P2_RULE_TWO=1]="P2_RULE_TWO",n[n.F1=4]="F1",n[n.M1=5]="M1",n[n.D1=5]="D1",n[n.D1Pro=5]="D1Pro",n[n.F1Ultra=6]="F1Ultra",n[n["D1Pro 2.0"]=5]="D1Pro 2.0",n))(yj||{}),WO=(n=>(n.VECTOR="Vector",n.BITMAP="bitmap",n))(WO||{}),Aj=(n=>(n.LEFT_TO_RIGHT="leftToRight",n.TOP_TO_BOTTOM="topToBottom",n))(Aj||{}),bj=(n=>(n.Z_MODE="zMode",n.ONEWAY="oneWay",n))(bj||{}),jO=(n=>(n.NORMAL="normal",n.DOT="dot",n))(jO||{}),wj=(n=>(n.NONE="None",n.TAB_NUMBER="TabNumber",n.TAB_DIST="TabDist",n))(wj||{}),dM=(n=>(n.DEVICE_ONE="001",n.DEVICE_FOUR="004",n))(dM||{}),ss=(n=>(n.CURVE_MEASURE="CURVE_MEASURE",n.CURVE_MEASURE_CANCEL="CURVE_MEASURE_CANCEL",n.SET_CURVE_PREVIEW_DISABLED="SET_CURVE_PREVIEW_DISABLED",n.CURVE_PREVIEW="CURVE_PREVIEW",n.MARK_POSITION="MARK_POSITION",n.MARK_POSITION_DONE="MARK_POSITION_DONE",n.MARK_POSITION_CANCEL="MARK_POSITION_CANCEL",n.UPDATE_PROCESSING_AREA="UPDATE_PROCESSING_AREA",n.BATCH_UPDATE_PROCESSING_AREA="BATCH_UPDATE_PROCESSING_AREA",n.UPDATE_DEVICE_INFO="UPDATE_DEVICE_INFO",n.DEVICE_STATE_CHANGE="DEVICE_STATE_CHANGE",n.UPDATE_CANVAS_BACK_DROP="UPDATE_CANVAS_BACK_DROP",n.CLEAN_CANVAS_BACK_DROP="CLEAN_CANVAS_BACK_DROP",n.DESTROY_CANVAS_PLUGIN="DESTROY_CANVAS_PLUGIN",n.UPDATE_CANVAS_LOCAL_BACK_DROP="UPDATE_CANVAS_LOCAL_BACK_DROP",n.SET_HAS_CLOSE_IMG="SET_HAS_CLOSE_IMG",n.MOVE_CYLINDER="MOVE_CYLINDER",n.UPDATE_POWER="UPDATE_POWER",n.UPDATE_GMODE="UPDATE_GMODE",n.SET_KEEP_ALIVE_MESSAGE="SET_KEEP_ALIVE_MESSAGE",n.UPDATE_WALK_BORDER_PARAMS="UPDATE_WALK_BORDER_PARAMS",n.UPDATE_WALK_BORDER_TIP_MODAL_VISIBLE="UPDATE_WALK_BORDER_TIP_MODAL_VISIBLE",n.UPDATE_AUTO_FOCUS_REMAIN_MODAL_VISIBLE="UPDATE_AUTO_FOCUS_REMAIN_MODAL_VISIBLE",n.UPDATE_PROCESSING_STATE="UPDATE_PROCESSING_STATE",n.DEVICE_SETTING_MODAL_VISIBLE="DEVICE_SETTING_MODAL_VISIBLE",n.UPDATE_PROCESSING_MODE_DATA="UPDATE_PROCESSING_MODE_DATA",n.UPDATE_WIFI_CONFIG_CONNECTED="UPDATE_WIFI_CONFIG_CONNECTED",n.UPDATE_INIT_ORIGIN_STATUS="UPDATE_INIT_ORIGIN_STATUS",n.UPDATE_GCODE_PERCENT="UPDATE_GCODE_PERCENT",n.UPDATE_STEP="UPDATE_STEP",n))(ss||{}),QO=(n=>(n.UPDATE_PROCESSING_AREA="UPDATE_PROCESSING_AREA",n.UPDATE_CANVAS_INIT_STATUS="UPDATE_CANVAS_INIT_STATUS",n.UPDATE_DISPLAYS_STATUS="UPDATE_DISPLAYS_STATUS",n.UPDATE_SELECTED_ATTR_STATUS="UPDATE_SELECTED_ATTR_STATUS",n.UPDATE_CYLINDER_STATUS="UPDATE_CYLINDER_STATUS",n.CLEAR_ALL_CYLINDER="CLEAR_ALL_CYLINDER",n.CANCEL_CURRENT_CYLINDER="CANCEL_CURRENT_CYLINDER",n.UPDATE_CURVE_PREVIEW_DISABLED="UPDATE_CURVE_PREVIEW_DISABLED",n))(QO||{}),ja=(n=>(n.ETH="ETH",n.WIFI="WIFI",n.SERIAL="SERIAL",n.USB="USB",n))(ja||{}),It=(n=>(n.IDLE="IDLE",n.FRAME_READY="FRAME_READY",n.FRAME_WORKING="FRAME_WORKING",n.BEFORE_START="BEFORE_START",n.START_PROCESS="START_PROCESS",n.PAUSE_PROCESS="PAUSE_PROCESS",n.CANCEL_PROCESS="CANCEL_PROCESS",n.FINISH_PROCESS="FINISH_PROCESS",n.WORK="Work",n.SLEEP="SLEEP",n.DRAIN="drain",n.ERROR="error",n.MODE_CHANGE="MODE_CHANGE",n.HEAT_STARTED="HEAT_STARTED",n.AUTOFOCUS="AUTOFOCUS",n.MEASURE="MEASURE",n.DISCONNECT="DISCONNECT",n))(It||{}),xl=(n=>(n.PREVIEW="PREVIEW",n.UPLOAD="UPLOAD",n.PROCESSING="PROCESSING",n.FINISH="Finish",n))(xl||{}),iA=(n=>(n.COUNT="count",n.DISTANCE="distance",n))(iA||{}),XO=(n=>(n.DRAG_DROP="DRAG_DROP",n.AUTO="AUTO",n.MANUAL="MANUAL",n))(XO||{}),gy=(n=>(n[n.CHECK_SHOULD_UPLOAD=0]="CHECK_SHOULD_UPLOAD",n[n.DOWNLOAD_FILE=1]="DOWNLOAD_FILE",n[n.MD5=2]="MD5",n[n.UNZIP_FILE=3]="UNZIP_FILE",n[n.COPY_FILE=4]="COPY_FILE",n[n.UPDATE_MANIFEST=5]="UPDATE_MANIFEST",n[n.NETWORK_DISCONNECT=6]="NETWORK_DISCONNECT",n))(gy||{}),fM=(n=>(n.PC="PC",n.PHONE="PHONE",n.PAD="PAD",n))(fM||{});const Ghe={CANCEL:"CANCEL"};function Hhe(n,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(i=>{Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i)||Object.create(null))})})}const dm=(n,e)=>{const t=(e==null?void 0:e.layerData)||{},i=(e==null?void 0:e.layerNames)||{};let r=lj(Zi(t,u=>u.order))||0;const s=u=>{var d;let h=(d=t[u])==null?void 0:d.name;return h||(r++,h=i[u]??Nhe[u]),h},o=u=>{var d;let h=(d=t[u])==null?void 0:d.order;return h||(h=r+1),h},a=[];for(const u in n){const{name:h,order:d}=n&&n[u]||{};a.push({key:u,order:d||o(u),label:h||s(u),visible:!0,color:u,locked:!1,isLeaf:!0})}a.sort((u,h)=>h.order-u.order);let l=[];a.length>0&&(l=a);const c={};return l.forEach(u=>{u.key&&(c[u.key]={name:u.label,order:u.order,visible:u.visible})}),{treeData:l,newLayerData:c}},yv=(n,e)=>{if(!n||!e)return 0;const t=n.split("."),i=e.split(".");for(let r=0;r<t.length||r<i.length;++r){let s=0,o=0;if(r<t.length&&(s=parseInt(t[r])),r<i.length&&(o=parseInt(i[r])),s>o)return 1;if(s<o)return-1}return 0},xj=(n="1.0.0")=>{const e=n.split("."),t=parseInt(e[0],10),i=parseInt(e[1],10),r=parseInt(e[2],10);return t*1e4+i*100+r},fC=n=>new Promise(e=>{setTimeout(e,n)});var lg=(n=>(n.AppVer="mockAppVersion",n.DeviceId="mockUpdateDeviceId",n.FirmwareVer="mockFirmwareVersion",n.ExtVer="mockExtVersion",n.l10nVer="mockL10nVersion",n))(lg||{});const HT=(n,e)=>{const t=localStorage.getItem(n);return t||e||""},pM=()=>{const n=new AbortController;return{signal:n.signal,cancel(){n.abort()}}},Vhe="8080",gM=(n,e=Vhe)=>`http://${n}:${e}`;var Hm;const Em=class Em{static get request(){return S(Em,Hm)||Qe(Em,Hm,fi.create({timeout:7e3})),S(Em,Hm)}};Hm=new WeakMap,ke(Em,Hm,void 0);let rA=Em;const Cj=n=>{const{params:e,baseURL:t,url:i}=n||{},r=new URLSearchParams(e).toString();let s=`${t||""}${i}`;return r&&(s+=`?${r}`),s},Ej=n=>Id(n)?n:"";rA.request.interceptors.request.use(n=>{const{data:e}=n;return Tt.debug("=> request",Cj(n),Ej(e)),n},n=>(Tt.error(n),Promise.reject(n)));rA.request.interceptors.response.use(n=>{const{config:e,data:t}=n;return Tt.debug("=> response result",Cj(e),Ej(t)),n},n=>(Tt.error(n),Promise.reject(n)));const sA=async(n,e,t)=>{const{url:i="",type:r="get",params:s,data:o,transformResult:a,...l}=n,{url:c,params:u,data:h,...d}=e||{};let f;Id(h)?f=Object.assign({},o,h):f=h;const p={url:pi(c)?`${i+c}`:i,method:r,params:{...s,...u},data:f||o,...l,...d};try{let g=await rA.request(p).then(m=>m.data);if(Id(g)&&"code"in g)if(g.code===0)g=g.data;else return i==="/device/machineInfo"?g:Promise.reject(g);return mt(a)?a(g):g}catch(g){return g!=null&&g.name&&delete g.name,t===!0?g:Promise.reject(g)}},Ib=new Map;function Tj(n,e){const t={cancel:i=>{const r=Ib.get(i);return mt(r)&&(r(),Ib.delete(i)),Promise.resolve("")}};return n.forEach(i=>{const{name:r,url:s="",type:o="get",params:a,timeout:l=3e3,list:c,port:u,transformResponse:h,headers:d,transformRequest:f,...p}=i;t[r]=async g=>{const m=v=>{let _=[];return v&&_.push(v),g!=null&&g.transformResponse&&(Rt(g==null?void 0:g.transformResponse)?_=_.concat(g==null?void 0:g.transformResponse):_.push(g==null?void 0:g.transformResponse)),_};try{let v;if(Rt(c)&&!wt(c)){const _=c.map(A=>{const{url:w="",type:b="get",params:C,port:I,timeout:x=3e3,transformResponse:T,transformRequest:O,headers:F}=A,G={...C};return G!=null&&G.cmd&&typeof g=="string"&&(G.cmd=`${G.cmd} ${g}`),fi({baseURL:gM(e,I),url:w,method:b,timeout:x,params:G,transformRequest:O,headers:F,transformResponse:m(T),...p}).catch(B=>Promise.resolve(B))});v=(await Promise.all(_)).map(A=>A.data),mt(h)&&(v=h(v)),console.log({name:r,url:s,params:a,result:v})}else{const _={...a};_.cmd!==void 0&&typeof g=="string"&&(_.cmd?_.cmd=`${_.cmd} ${g}`:_.cmd=g);const y=fi.CancelToken,A=await fi({baseURL:gM(e,u),url:g!=null&&g.url?s+g.url:s,method:o,timeout:l,params:{..._,...g==null?void 0:g.params},data:(g==null?void 0:g.data)||o.toLocaleLowerCase()==="post"&&g,transformRequest:f,transformResponse:m(h),headers:d,cancelToken:new y(w=>{Ib.set(r,w)}),onDownloadProgress:w=>{mt(g==null?void 0:g.onDownloadProgress)&&(g==null||g.onDownloadProgress(w))},onUploadProgress:w=>{mt(g==null?void 0:g.onUploadProgress)&&(g==null||g.onUploadProgress(w))},...p});Ib.delete(r),v=A.data}return v}catch(v){return new Error(v)}}}),t}const VT=(n,e,t)=>{const i={};return n.forEach(r=>{const{name:s,list:o,port:a,transformResult:l,cmd:c,...u}=r,h=gM(e,a);i[s]=(d,f)=>{if((d==null?void 0:d.method)==="info")return Promise.resolve({baseUrl:h,...u});if(Rt(o)&&!wt(o)){const p=o.map(g=>{const m={baseURL:h,...u,...g};return c&&mt(t)?t(c,d,m):sA(m,d,f??!0)});return mt(l)?Promise.all(p).then(g=>l(g)):Promise.all(p)}else return c&&mt(t)?t(c,d,u):sA({baseURL:h,transformResult:l,...u},d,f)}}),i},{domain:Ij}=nl(),zhe=`${Ij.commonApi}/efficacy/v1/package/version/latest`,$he=`${Ij.commonApi}/efficacy/v1/packages/version/latest`,Sj=n=>{var e;if(!(!pi(n)||wt(n)))return(e=n.match(/\d+/g))==null?void 0:e.slice(0,4).map((t,i)=>Number(i===3?t.toString().substring(0,2):t))},Whe={appVer:"",delay:1e3},Pj=async(n,e,t)=>{const i=Object.assign({},Whe,t);i.delay>0&&await fC(i.delay),i.appVer&&(i.appVer=HT(lg.AppVer,i.appVer));const r={domain:"xcs",region:"en",contentId:e};return Rt(n)?Qhe(n,r,i):jhe(n,r,i)},Mj=n=>{const e=HT(lg.DeviceId);e&&(n.deviceId=e)},jhe=async(n,e,t)=>{try{t.mockKey&&(n=HT(t.mockKey,n));const i=Sj(n);if(gi(i))return Promise.reject(`[xcs error] can't parse version '${n}'`);const r={...e,contentVersion:i==null?void 0:i.join("."),extraFilter:t.extraFilter||[]};Mj(r);const s=await sA({url:zhe,method:"post",data:r});console.log("mblock===>","check update result",r,s);const{version:o="",advice:a,extra:l={}}=s||{},c=yv(o,n)>0||mt(t.checkSubVersion)&&t.checkSubVersion(l);if(c&&!wt(s==null?void 0:s.contents)){let u=!1;const{minAppVersion:h,...d}=l;h&&(u=yv(t.appVer,h)<0);const f=s.contents.map(g=>g.url),p=s.contents.map(g=>g.md5);return{shouldUpdate:c,latestVersion:o,downloadUrl:f,subVersions:d,changeLog:s.description,forceUpdate:a===1,appVersionLow:u,md5List:p}}return null}catch(i){return console.log("mblock===>","check update err",i),Promise.reject(i)}},Qhe=async(n,e,t)=>{var i;try{const r={...e,packages:n};(i=r.packages)==null||i.forEach(a=>{var c;const l=HT(lg.FirmwareVer,(c=Sj(a.contentVersion))==null?void 0:c.join("."));a.contentVersion=l}),Mj(r);const s=await sA({url:$he,method:"post",data:r}),o=s.length>0;if(o){const a={},l={};s.forEach(g=>{const{id:m,contents:v}=g;l[m]=Zi(v,"md5")[0],a[m]=Zi(v,"url")[0]});const c=Zi(s,"version").join(","),u=Zi(s,"description").flat(),h={zh:Zi(u,"zh").join(`
`),en:Zi(u,"en").join(`
`)},d=Zi(s,"advice"),f=Zi(s,"extra.minAppVersion");let p=!1;return f.length>0&&(p=f.map(m=>m?yv(t.appVer,m):0).includes(-1)),console.log({version:c,urlList:a,advices:d,changeLog:h,minAppVersions:f}),{shouldUpdate:o,changeLog:h,latestVersion:c,downloadUrl:a,forceUpdate:d.includes(1),appVersionLow:p,md5List:l}}return null}catch(r){return Promise.reject(r)}},Xhe=async(n,e)=>{try{const{errorCorrectionLevel:t="H",width:i=1e3}=e,r=document.createElement("canvas");return await(await Pi(()=>import("./browser-Z_hN-7k_.js").then(o=>o.browser),__vite__mapDeps([]),import.meta.url)).toCanvas(r,n,{margin:2,width:i,errorCorrectionLevel:t}),r.toDataURL("image/png")}catch(t){return Tt.error("生成二维码出错",t),null}},Yhe=async(n,e)=>{try{const t=(await Pi(()=>import("./jsbarcode-mnEjUZ4Q.js").then(u=>u.JsBarcode),__vite__mapDeps([0,1]),import.meta.url)).default,{format:i="CODE128",displayValue:r=!1,margin:s=5,width:o=4,height:a=200}=e??{},l=document.createElement("canvas");return t(l,n,{format:i,displayValue:r,margin:s,width:o,height:a}),l.toDataURL("image/png")}catch(t){return Tt.error("生成一维码出错",t),null}},Rj=n=>{const e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});n.dispatchEvent(e)},qhe=(n,e)=>{const t=document.createElement("a");t.setAttribute("download",e||"image.png"),t.setAttribute("href",n),t.setAttribute("target","_blank"),Rj(t)},pC=(n,e)=>{const t=window.URL.createObjectURL(e);qhe(t,n),window.URL.revokeObjectURL(t)},Khe=(n,e)=>{const t=document.createElement("canvas"),i=t.getContext("2d");return t.width=n,t.height=e,{canvas:t,ctx:i}};function Jhe(n){const e=document.createElement("canvas");e.width=n.width,e.height=n.height;const t=e.getContext("2d");return t==null||t.putImageData(n,0,0),e}const gft=(n,e="image/jpeg")=>new Promise((t,i)=>{const r=new Image;r.src=Zhe(n,e),r.onload=()=>{t(r)},r.onerror=i}),Zhe=(n,e="image/jpeg")=>{const{canvas:t,ctx:i}=Khe(n.width,n.height);return i==null||i.putImageData(n,0,0),t.toDataURL(e)},GB=n=>new Promise(async(e,t)=>{const i=URL.createObjectURL(n),r=new Image;r.src=i,r.onload=()=>{URL.revokeObjectURL(i),e(r)},r.onerror=t}),cS=n=>new Promise(async(e,t)=>{if(pi(n)){const s=await tde(n);n=new Blob([s])}const i=URL.createObjectURL(n),r=new Image;r.src=i,r.onload=()=>{URL.revokeObjectURL(i),e(r)},r.onerror=t}),mM=(n,e="text")=>{var t;if(pi(n)){const i=(t=window.MeApi)==null?void 0:t.fileHelper;return i?e==="text"?i.read2Str(n):i.read2Buffer(n):Promise.reject(`read file error. path: ${n}`)}return new Promise((i,r)=>{const s=new FileReader;s.onload=()=>{i(s.result)},s.onerror=()=>{r(`read file error. path: ${n}`)},e==="text"?s.readAsText(n):s.readAsArrayBuffer(n)})},zT=async n=>{var e;if(pi(n)){const t=(e=window.MeApi)==null?void 0:e.fileHelper;if(t){const i=await t.read2Buffer(n),r=new Blob([i]);return mM(r)}}return mM(n)},HB=(n,e)=>typeof e=="object"&&e!==null&&e.dataType==="Map"&&e.value instanceof Array?new Map(e.value):e,ede=n=>{var e;if(pi(n)){const t=(e=window.MeApi)==null?void 0:e.fileHelper;if(t)return t.read2Str(n).then(i=>JSON.parse(i,HB))}return zT(n).then(t=>JSON.parse(t,HB))},tde=async n=>mM(n,"arraybuffer");class nde extends Error{}const Dj=(n,e)=>{var r;console.log(["=> openFileDialog"]);const t=(r=window.MeApi)==null?void 0:r.fileHelper;if(t)return t.openDialog({filters:[{name:"file",extensions:n}],type:e});const i=()=>{let s=document.querySelector("#fileDialog");return s instanceof HTMLInputElement||(s=document.createElement("input"),s.id="fileDialog",s.style.position="absolute",s.style.visibility="hidden",s.style.top="-100%",s.setAttribute("type","file")),s};return new Promise((s,o)=>{let a=null,l=!1;const c=i(),u=()=>{c.value=""};n&&(Rt(n)&&(n=`.${n.join(",.")}`),c.setAttribute("accept",n));const h=()=>{console.log(["=> openFileDialog: handleClick"]),l=!0},d=p=>{var g;if(console.log(["=> openFileDialog: handleChange",(g=p==null?void 0:p.target)==null?void 0:g.files]),clearTimeout(a),p){const m=p.target.files;if(m.length>0){s(m[0]),u();return}}u(),o(new nde("cancel open file."))},f=()=>{console.log(["= openFileDialog: window handleFocus"]),l&&(l=!1,clearTimeout(a),a=setTimeout(()=>{d()},1e3))};c.onchange=d,c.onclick=h,window.addEventListener("focus",f,{once:!0}),Rj(c)})},ide=(n,e)=>{var i;const t=(i=window.MeApi)==null?void 0:i.fileHelper;if(t&&n)return t.rename(n,e)},kj=async(n,e,t=!1,i={})=>{var s;const r=(s=window.MeApi)==null?void 0:s.fileHelper;if(r)return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),r.save(n,e,{write:"utf8",save:{defaultPath:n,...i},saveAs:t});if(e instanceof ArrayBuffer){const o=new Blob([e]);pC(n,o)}else if(pi(e)){const o=new File([e],n);pC(n,o)}else Tt.warn(["=> not support save file content",{fp:n,content:e}])},rde=n=>{var e,t;return(e=window.MeApi)!=null&&e.path?(t=window.MeApi)==null?void 0:t.path.extname(n):t6.extname(n)},sde=(n,e)=>{var t,i;return(t=window.MeApi)!=null&&t.path?(i=window.MeApi)==null?void 0:i.path.basename(n,e):t6.basename(n,e)},ode=n=>new Promise(e=>{fetch(n).then(t=>t.blob()).then(t=>{let{type:i}=t;i=/^image\/svg/.test(i)?i.replace(/\+xml$/,""):i;const s=new File([t],`imageName.${i.substring(i.lastIndexOf("/")+1)}`,{type:i});e(s)})}),ade=n=>{const e=r=>{const s=document.createElement("canvas");s.width=r.width,s.height=r.height;const o=s.getContext("2d");return o.filter=`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" > <filter id="posterize"> <feComponentTransfer> <feFuncR type="discrete" tableValues="0,0.2,0.4,0.6,0.8,1" /> <feFuncG type="discrete" tableValues="0,0.2,0.4,0.6,0.8,1" /> <feFuncB type="discrete" tableValues="0,0.2,0.4,0.6,0.8,1" /> <feFuncA type="discrete" tableValues="0,1" /> </feComponentTransfer> </filter> </svg>#posterize')`,o.drawImage(r,0,0),o.getImageData(0,0,s.width,s.height)},t=Jhe(n),i=e(t);return{imageData:i,width:i.width,height:i.height}};function rf(n={},e="en"){if(!n)return"";const t=r=>typeof r=="string"&&r,i=r=>t(n[r])?n[r]:null;return i(e)??(e.startsWith("zh")?i("zh-HK")??i("zh-TW")??i("zh-Hant")??i("zh"):null)??i("en")??Object.values(n).find(r=>t(r))??""}function VB(n){return typeof n=="string"&&n}const lde=n=>{let e=1/0,t=1/0,i=-1/0,r=-1/0;return n.forEach(s=>{const{x:o,y:a,width:l,height:c}=s;e=Math.min(o,e),t=Math.min(a,t),i=Math.max(o+(l||0),i),r=Math.max(a+(c||0),r)}),{minX:e,minY:t,maxX:i,maxY:r}},zB=n=>{const e=localStorage.getItem(n);if(e)try{return JSON.parse(e)}catch(t){return Tt.error(`解析localStorage中的值报错 ${n}`,t),null}return null},cde={id:0,power:0,name:{zh:"device.common.user_defined_material",en:"device.common.user_defined_material"},image:"",thickness:null,isDangerous:!1,diameter:null,perimeter:null,processingData:{VECTOR_CUTTING:{power:1,speed:16,repeat:1,enableBreakPoint:!1,breakPointSize:.5,breakPointCount:2,breakPointPower:0},VECTOR_ENGRAVING:{power:1,speed:20,repeat:1},FILL_VECTOR_ENGRAVING:{power:1,speed:80,repeat:1,density:100,bitmapMode:"grayscale",bitmapScanMode:"zMode"},BITMAP_ENGRAVING:{power:1,speed:80,repeat:1,density:100,bitmapMode:"grayscale",bitmapScanMode:"zMode"},KNIFE_CUTTING:{cutPressure:45,speed:40,repeat:1},BRUSH_PAINTING_LINE:{brushPressure:1,speed:1,repeat:1},BRUSH_PAINTING_BLOCK:{brushPressure:1,speed:1,repeat:1},ACTIVE_PRESS:{cutPressure:45,speed:40,repeat:1},ACTIVE_KNIFE_CUT:{cutPressure:45,speed:40,repeat:1},ACTIVE_DISC_PRESS:{cutPressure:45,speed:40,repeat:1},INK_PRINT:{speed:40,repeat:1}}},ude=()=>JSON.parse(localStorage.getItem(nl().LOCAL_MATERIALS)||"[]"),hde=({identifier:n,power:e,deviceMode:t,materialList:i,laserSource:r})=>{const{VECTOR_CUTTING:s,VECTOR_ENGRAVING:o,FILL_VECTOR_ENGRAVING:a,BITMAP_ENGRAVING:l,KNIFE_CUTTING:c,RELIEF:u}=cn,h=[];return i.forEach(({id:d,name:f,thickness:p,diameter:g,perimeter:m,machineParas:v,images:_,isDangerous:y})=>{var G,B,R,P,k,L,H,U,$,j,Q;cr(v)&&(v=[]);const A={},w={},b=(ne,ve,Pe,De)=>{if(Rt(Pe)){const Xe=Pe.map(Ne=>v.find(et=>{var ze,de;return((ze=et.processingMode)==null?void 0:ze.code)===De&&et.processingType.code===ne&&et.laserPower.code===Ne.toString()&&et.deviceMode.code===ve&&((de=et.laserSource)==null?void 0:de.code)===r})).filter(Ne=>Ne);return wt(Xe)?void 0:Xe.length===1?Xe[0]:Xe.find(et=>{var ze;return((ze=et.laserSource)==null?void 0:ze.code)===r})}else return v.find(Xe=>{var Ne;return((Ne=Xe.processingMode)==null?void 0:Ne.code)===De&&Xe.processingType.code===ne&&Xe.laserPower.code===(Pe==null?void 0:Pe.toString())&&Xe.deviceMode.code===ve})},C=b(s,n,e,t),I=b(o,n,e,t),x=b(a,n,e,t),T=b(l,n,e,t),O=b(u,n,e,t),F=b(c,n,e,t);if(C&&(A[s]={processingLightSource:((G=C==null?void 0:C.laserSource)==null?void 0:G.code)||"blue",power:C.power,speed:C.speed,repeat:C.repeat},C.paraMatrix&&(w[s]=C.paraMatrix)),I&&(A[o]={processingLightSource:((B=I==null?void 0:I.laserSource)==null?void 0:B.code)||"blue",power:I.power,speed:I.speed,repeat:I.repeat,frequency:I.frequency},I.paraMatrix&&(w[o]=I.paraMatrix)),x&&(A[a]={processingLightSource:((R=x==null?void 0:x.laserSource)==null?void 0:R.code)||"blue",power:x.power,speed:x.speed,repeat:x.repeat,frequency:x.frequency,density:Number(((P=x.density)==null?void 0:P.name)||""),bitmapMode:(k=x.bitmapMode)==null?void 0:k.name},x.paraMatrix&&(w[a]=x.paraMatrix)),T){const ne=Number(((L=T.density)==null?void 0:L.name)||"");A[l]={processingLightSource:((H=T==null?void 0:T.laserSource)==null?void 0:H.code)||"blue",power:T.power,speed:T.speed,repeat:T.repeat,frequency:T.frequency,density:ne>0?ne:void 0,bitmapMode:(U=T.bitmapMode)==null?void 0:U.name,dpi:T.dpi,dotDuration:T.dotTime,powerMinMaxRange:[T.minPower>0?T.minPower:1,T.power]},T.paraMatrix&&(w[l]=T.paraMatrix)}if(O){const ne=Number((($=O.density)==null?void 0:$.name)||"");A[u]={processingLightSource:((j=O==null?void 0:O.laserSource)==null?void 0:j.code)||"blue",power:O.power,speed:O.speed,repeat:O.repeat,frequency:O.frequency,density:ne>0?ne:void 0,bitmapMode:(Q=O.bitmapMode)==null?void 0:Q.name,sliceNumber:O.sliceNumber,zAxisMove:O.zAxisMove,zLayers:O.zLayers,zDecline:O.zDecline},O.paraMatrix&&(w[u]=O.paraMatrix)}if(F&&(A[c]={cutPressure:F.cutPressure,speed:F.speed,repeat:F.repeat},F.paraMatrix&&(w[c]=F.paraMatrix)),!wt(A)){const[ne]=_??[];h.push({id:d,name:f,image:ne,isDangerous:y,thickness:p,diameter:g,perimeter:m,power:e,processingData:A,paraMatrix:w})}}),h},Oj=(n,e)=>{const t=[];return e.forEach(i=>{let r=!1;n.forEach(s=>{i.processingData[s]&&(r=!0)}),r&&t.push(i)}),t},dde=async(n,e,t,i,r)=>{var o;const s=(o=window.MeApi)==null?void 0:o.fileHelper;if(s)return await s.saveXCS(n,e,t,i,r);{const a=new File([e],n);pC(n,a)}},fde=n=>{const e=n.split("/");let t=e[e.length-1];t=t.slice(0,-4);try{return decodeURIComponent(t)}catch(i){return console.log("decodeURIComponent fail =====> ",i),t}},uS=(n,e={x:1,y:1},t=!1,i=!0,r=0,s=0)=>{let o="";for(let a=0;a<n.length;a++){for(let l=0;l<n[a].length;l++){const c=t&&![0,n[a].length-1].includes(l);l?o+=c?"Q":"L":o+="M",o+=c?`${r+(n[a][l].x+n[a][l-1].x)/2/e.x} ${s+(n[a][l].y+n[a][l-1].y)/2/e.y} ${r+(n[a][l].x+n[a][l+1].x)/2/e.x} ${s+(n[a][l].y+n[a][l+1].y)/2/e.y}`:`${r+n[a][l].x/e.x}, ${s+n[a][l].y/e.y}`}i&&(o+="Z")}return o===""&&(o="M0,0"),o},pde=(n,e)=>{const{x:t=0,y:i=0,scaleX:r=1,scaleY:s=1}=e;for(let o=0;o<n.length;o++)for(let a=0;a<n[o].length;a++)n[o][a].x=t+n[o][a].x/r,n[o][a].y=i+n[o][a].y/s},Sb=n=>`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" style="stroke: #000000;fill: none;stroke-width: 1px;" xml:space="preserve">
    <path d="${n}" />
  </svg>`,hS=n=>{if(!n)return"";const e=n.match(/<path\s+d="([^"]+)"/)||[];return e.length>1?e[1]:""},vM=()=>"mobile";function ih(n){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ih(n)}function Xo(n){if(n===null||n===!0||n===!1)return NaN;var e=Number(n);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function Gr(n,e){if(e.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+e.length+" present")}function io(n){Gr(1,arguments);var e=Object.prototype.toString.call(n);return n instanceof Date||ih(n)==="object"&&e==="[object Date]"?new Date(n.getTime()):typeof n=="number"||e==="[object Number]"?new Date(n):((typeof n=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function gde(n,e){Gr(2,arguments);var t=io(n).getTime(),i=Xo(e);return new Date(t+i)}var mde={};function e_(){return mde}function Lj(n){var e=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return e.setUTCFullYear(n.getFullYear()),n.getTime()-e.getTime()}var vde=6e4,_de=36e5,yde=1e3;function Ade(n){return Gr(1,arguments),n instanceof Date||ih(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function bde(n){if(Gr(1,arguments),!Ade(n)&&typeof n!="number")return!1;var e=io(n);return!isNaN(Number(e))}function Nj(n,e){Gr(2,arguments);var t=Xo(e);return gde(n,-t)}var wde=864e5;function xde(n){Gr(1,arguments);var e=io(n),t=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var i=e.getTime(),r=t-i;return Math.floor(r/wde)+1}function Av(n){Gr(1,arguments);var e=1,t=io(n),i=t.getUTCDay(),r=(i<e?7:0)+i-e;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function Bj(n){Gr(1,arguments);var e=io(n),t=e.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(t+1,0,4),i.setUTCHours(0,0,0,0);var r=Av(i),s=new Date(0);s.setUTCFullYear(t,0,4),s.setUTCHours(0,0,0,0);var o=Av(s);return e.getTime()>=r.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function Cde(n){Gr(1,arguments);var e=Bj(n),t=new Date(0);t.setUTCFullYear(e,0,4),t.setUTCHours(0,0,0,0);var i=Av(t);return i}var Ede=6048e5;function Fj(n){Gr(1,arguments);var e=io(n),t=Av(e).getTime()-Cde(e).getTime();return Math.round(t/Ede)+1}function Up(n,e){var t,i,r,s,o,a,l,c;Gr(1,arguments);var u=e_(),h=Xo((t=(i=(r=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&r!==void 0?r:u.weekStartsOn)!==null&&i!==void 0?i:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=io(n),f=d.getUTCDay(),p=(f<h?7:0)+f-h;return d.setUTCDate(d.getUTCDate()-p),d.setUTCHours(0,0,0,0),d}function YO(n,e){var t,i,r,s,o,a,l,c;Gr(1,arguments);var u=io(n),h=u.getUTCFullYear(),d=e_(),f=Xo((t=(i=(r=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&r!==void 0?r:d.firstWeekContainsDate)!==null&&i!==void 0?i:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(h+1,0,f),p.setUTCHours(0,0,0,0);var g=Up(p,e),m=new Date(0);m.setUTCFullYear(h,0,f),m.setUTCHours(0,0,0,0);var v=Up(m,e);return u.getTime()>=g.getTime()?h+1:u.getTime()>=v.getTime()?h:h-1}function Tde(n,e){var t,i,r,s,o,a,l,c;Gr(1,arguments);var u=e_(),h=Xo((t=(i=(r=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&r!==void 0?r:u.firstWeekContainsDate)!==null&&i!==void 0?i:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1),d=YO(n,e),f=new Date(0);f.setUTCFullYear(d,0,h),f.setUTCHours(0,0,0,0);var p=Up(f,e);return p}var Ide=6048e5;function Uj(n,e){Gr(1,arguments);var t=io(n),i=Up(t,e).getTime()-Tde(t,e).getTime();return Math.round(i/Ide)+1}function hi(n,e){for(var t=n<0?"-":"",i=Math.abs(n).toString();i.length<e;)i="0"+i;return t+i}var Sde={y:function(e,t){var i=e.getUTCFullYear(),r=i>0?i:1-i;return hi(t==="yy"?r%100:r,t.length)},M:function(e,t){var i=e.getUTCMonth();return t==="M"?String(i+1):hi(i+1,2)},d:function(e,t){return hi(e.getUTCDate(),t.length)},a:function(e,t){var i=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];case"aaaa":default:return i==="am"?"a.m.":"p.m."}},h:function(e,t){return hi(e.getUTCHours()%12||12,t.length)},H:function(e,t){return hi(e.getUTCHours(),t.length)},m:function(e,t){return hi(e.getUTCMinutes(),t.length)},s:function(e,t){return hi(e.getUTCSeconds(),t.length)},S:function(e,t){var i=t.length,r=e.getUTCMilliseconds(),s=Math.floor(r*Math.pow(10,i-3));return hi(s,t.length)}};const bh=Sde;var Cg={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Pde={G:function(e,t,i){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"});case"GGGGG":return i.era(r,{width:"narrow"});case"GGGG":default:return i.era(r,{width:"wide"})}},y:function(e,t,i){if(t==="yo"){var r=e.getUTCFullYear(),s=r>0?r:1-r;return i.ordinalNumber(s,{unit:"year"})}return bh.y(e,t)},Y:function(e,t,i,r){var s=YO(e,r),o=s>0?s:1-s;if(t==="YY"){var a=o%100;return hi(a,2)}return t==="Yo"?i.ordinalNumber(o,{unit:"year"}):hi(o,t.length)},R:function(e,t){var i=Bj(e);return hi(i,t.length)},u:function(e,t){var i=e.getUTCFullYear();return hi(i,t.length)},Q:function(e,t,i){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return hi(r,2);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,i){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return hi(r,2);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,i){var r=e.getUTCMonth();switch(t){case"M":case"MM":return bh.M(e,t);case"Mo":return i.ordinalNumber(r+1,{unit:"month"});case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,i){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return hi(r+1,2);case"Lo":return i.ordinalNumber(r+1,{unit:"month"});case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,i,r){var s=Uj(e,r);return t==="wo"?i.ordinalNumber(s,{unit:"week"}):hi(s,t.length)},I:function(e,t,i){var r=Fj(e);return t==="Io"?i.ordinalNumber(r,{unit:"week"}):hi(r,t.length)},d:function(e,t,i){return t==="do"?i.ordinalNumber(e.getUTCDate(),{unit:"date"}):bh.d(e,t)},D:function(e,t,i){var r=xde(e);return t==="Do"?i.ordinalNumber(r,{unit:"dayOfYear"}):hi(r,t.length)},E:function(e,t,i){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"});case"EEEE":default:return i.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,i,r){var s=e.getUTCDay(),o=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return hi(o,2);case"eo":return i.ordinalNumber(o,{unit:"day"});case"eee":return i.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(s,{width:"short",context:"formatting"});case"eeee":default:return i.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,i,r){var s=e.getUTCDay(),o=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return hi(o,t.length);case"co":return i.ordinalNumber(o,{unit:"day"});case"ccc":return i.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(s,{width:"narrow",context:"standalone"});case"cccccc":return i.day(s,{width:"short",context:"standalone"});case"cccc":default:return i.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,i){var r=e.getUTCDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return hi(s,t.length);case"io":return i.ordinalNumber(s,{unit:"day"});case"iii":return i.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(r,{width:"short",context:"formatting"});case"iiii":default:return i.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,i){var r=e.getUTCHours(),s=r/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,i){var r=e.getUTCHours(),s;switch(r===12?s=Cg.noon:r===0?s=Cg.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,i){var r=e.getUTCHours(),s;switch(r>=17?s=Cg.evening:r>=12?s=Cg.afternoon:r>=4?s=Cg.morning:s=Cg.night,t){case"B":case"BB":case"BBB":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,i){if(t==="ho"){var r=e.getUTCHours()%12;return r===0&&(r=12),i.ordinalNumber(r,{unit:"hour"})}return bh.h(e,t)},H:function(e,t,i){return t==="Ho"?i.ordinalNumber(e.getUTCHours(),{unit:"hour"}):bh.H(e,t)},K:function(e,t,i){var r=e.getUTCHours()%12;return t==="Ko"?i.ordinalNumber(r,{unit:"hour"}):hi(r,t.length)},k:function(e,t,i){var r=e.getUTCHours();return r===0&&(r=24),t==="ko"?i.ordinalNumber(r,{unit:"hour"}):hi(r,t.length)},m:function(e,t,i){return t==="mo"?i.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):bh.m(e,t)},s:function(e,t,i){return t==="so"?i.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):bh.s(e,t)},S:function(e,t){return bh.S(e,t)},X:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();if(o===0)return"Z";switch(t){case"X":return WB(o);case"XXXX":case"XX":return sf(o);case"XXXXX":case"XXX":default:return sf(o,":")}},x:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"x":return WB(o);case"xxxx":case"xx":return sf(o);case"xxxxx":case"xxx":default:return sf(o,":")}},O:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+$B(o,":");case"OOOO":default:return"GMT"+sf(o,":")}},z:function(e,t,i,r){var s=r._originalDate||e,o=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+$B(o,":");case"zzzz":default:return"GMT"+sf(o,":")}},t:function(e,t,i,r){var s=r._originalDate||e,o=Math.floor(s.getTime()/1e3);return hi(o,t.length)},T:function(e,t,i,r){var s=r._originalDate||e,o=s.getTime();return hi(o,t.length)}};function $B(n,e){var t=n>0?"-":"+",i=Math.abs(n),r=Math.floor(i/60),s=i%60;if(s===0)return t+String(r);var o=e||"";return t+String(r)+o+hi(s,2)}function WB(n,e){if(n%60===0){var t=n>0?"-":"+";return t+hi(Math.abs(n)/60,2)}return sf(n,e)}function sf(n,e){var t=e||"",i=n>0?"-":"+",r=Math.abs(n),s=hi(Math.floor(r/60),2),o=hi(r%60,2);return i+s+t+o}var jB=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Gj=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Mde=function(e,t){var i=e.match(/(P+)(p+)?/)||[],r=i[1],s=i[2];if(!s)return jB(e,t);var o;switch(r){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",jB(r,t)).replace("{{time}}",Gj(s,t))},_M={p:Gj,P:Mde},Rde=["D","DD"],Dde=["YY","YYYY"];function Hj(n){return Rde.indexOf(n)!==-1}function Vj(n){return Dde.indexOf(n)!==-1}function gC(n,e,t){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var kde={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ode=function(e,t,i){var r,s=kde[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+r:r+" ago":r};const Lde=Ode;function dS(n){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.width?String(e.width):n.defaultWidth,i=n.formats[t]||n.formats[n.defaultWidth];return i}}var Nde={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Bde={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Fde={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ude={date:dS({formats:Nde,defaultWidth:"full"}),time:dS({formats:Bde,defaultWidth:"full"}),dateTime:dS({formats:Fde,defaultWidth:"full"})};const Gde=Ude;var Hde={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Vde=function(e,t,i,r){return Hde[e]};const zde=Vde;function S_(n){return function(e,t){var i=t!=null&&t.context?String(t.context):"standalone",r;if(i==="formatting"&&n.formattingValues){var s=n.defaultFormattingWidth||n.defaultWidth,o=t!=null&&t.width?String(t.width):s;r=n.formattingValues[o]||n.formattingValues[s]}else{var a=n.defaultWidth,l=t!=null&&t.width?String(t.width):n.defaultWidth;r=n.values[l]||n.values[a]}var c=n.argumentCallback?n.argumentCallback(e):e;return r[c]}}var $de={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Wde={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},jde={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Qde={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Xde={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Yde={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},qde=function(e,t){var i=Number(e),r=i%100;if(r>20||r<10)switch(r%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},Kde={ordinalNumber:qde,era:S_({values:$de,defaultWidth:"wide"}),quarter:S_({values:Wde,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:S_({values:jde,defaultWidth:"wide"}),day:S_({values:Qde,defaultWidth:"wide"}),dayPeriod:S_({values:Xde,defaultWidth:"wide",formattingValues:Yde,defaultFormattingWidth:"wide"})};const Jde=Kde;function P_(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.width,r=i&&n.matchPatterns[i]||n.matchPatterns[n.defaultMatchWidth],s=e.match(r);if(!s)return null;var o=s[0],a=i&&n.parsePatterns[i]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(a)?efe(a,function(h){return h.test(o)}):Zde(a,function(h){return h.test(o)}),c;c=n.valueCallback?n.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;var u=e.slice(o.length);return{value:c,rest:u}}}function Zde(n,e){for(var t in n)if(n.hasOwnProperty(t)&&e(n[t]))return t}function efe(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return t}function tfe(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.match(n.matchPattern);if(!i)return null;var r=i[0],s=e.match(n.parsePattern);if(!s)return null;var o=n.valueCallback?n.valueCallback(s[0]):s[0];o=t.valueCallback?t.valueCallback(o):o;var a=e.slice(r.length);return{value:o,rest:a}}}var nfe=/^(\d+)(th|st|nd|rd)?/i,ife=/\d+/i,rfe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},sfe={any:[/^b/i,/^(a|c)/i]},ofe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},afe={any:[/1/i,/2/i,/3/i,/4/i]},lfe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},cfe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ufe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},hfe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},dfe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ffe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},pfe={ordinalNumber:tfe({matchPattern:nfe,parsePattern:ife,valueCallback:function(e){return parseInt(e,10)}}),era:P_({matchPatterns:rfe,defaultMatchWidth:"wide",parsePatterns:sfe,defaultParseWidth:"any"}),quarter:P_({matchPatterns:ofe,defaultMatchWidth:"wide",parsePatterns:afe,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:P_({matchPatterns:lfe,defaultMatchWidth:"wide",parsePatterns:cfe,defaultParseWidth:"any"}),day:P_({matchPatterns:ufe,defaultMatchWidth:"wide",parsePatterns:hfe,defaultParseWidth:"any"}),dayPeriod:P_({matchPatterns:dfe,defaultMatchWidth:"any",parsePatterns:ffe,defaultParseWidth:"any"})};const gfe=pfe;var mfe={code:"en-US",formatDistance:Lde,formatLong:Gde,formatRelative:zde,localize:Jde,match:gfe,options:{weekStartsOn:0,firstWeekContainsDate:1}};const qO=mfe;var vfe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_fe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yfe=/^'([^]*?)'?$/,Afe=/''/g,bfe=/[a-zA-Z]/;function Sd(n,e,t){var i,r,s,o,a,l,c,u,h,d,f,p,g,m,v,_,y,A;Gr(2,arguments);var w=String(e),b=e_(),C=(i=(r=t==null?void 0:t.locale)!==null&&r!==void 0?r:b.locale)!==null&&i!==void 0?i:qO,I=Xo((s=(o=(a=(l=t==null?void 0:t.firstWeekContainsDate)!==null&&l!==void 0?l:t==null||(c=t.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&a!==void 0?a:b.firstWeekContainsDate)!==null&&o!==void 0?o:(h=b.locale)===null||h===void 0||(d=h.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(I>=1&&I<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var x=Xo((f=(p=(g=(m=t==null?void 0:t.weekStartsOn)!==null&&m!==void 0?m:t==null||(v=t.locale)===null||v===void 0||(_=v.options)===null||_===void 0?void 0:_.weekStartsOn)!==null&&g!==void 0?g:b.weekStartsOn)!==null&&p!==void 0?p:(y=b.locale)===null||y===void 0||(A=y.options)===null||A===void 0?void 0:A.weekStartsOn)!==null&&f!==void 0?f:0);if(!(x>=0&&x<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!C.localize)throw new RangeError("locale must contain localize property");if(!C.formatLong)throw new RangeError("locale must contain formatLong property");var T=io(n);if(!bde(T))throw new RangeError("Invalid time value");var O=Lj(T),F=Nj(T,O),G={firstWeekContainsDate:I,weekStartsOn:x,locale:C,_originalDate:T},B=w.match(_fe).map(function(R){var P=R[0];if(P==="p"||P==="P"){var k=_M[P];return k(R,C.formatLong)}return R}).join("").match(vfe).map(function(R){if(R==="''")return"'";var P=R[0];if(P==="'")return wfe(R);var k=Pde[P];if(k)return!(t!=null&&t.useAdditionalWeekYearTokens)&&Vj(R)&&gC(R,e,String(n)),!(t!=null&&t.useAdditionalDayOfYearTokens)&&Hj(R)&&gC(R,e,String(n)),k(F,R,C.localize,G);if(P.match(bfe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+P+"`");return R}).join("");return B}function wfe(n){var e=n.match(yfe);return e?e[1].replace(Afe,"'"):n}function xfe(n,e){if(n==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}function QB(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function Cfe(n,e){if(n){if(typeof n=="string")return QB(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return QB(n,e)}}function XB(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Cfe(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var i=0,r=function(){};return{s:r,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(c){throw c},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var c=t.next();return s=c.done,c},e:function(c){o=!0,a=c},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function Lt(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function yM(n,e){return yM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},yM(n,e)}function Wn(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&yM(n,e)}function mC(n){return mC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mC(n)}function zj(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zj=function(){return!!n})()}function Efe(n,e){if(e&&(ih(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lt(n)}function jn(n){var e=zj();return function(){var i=mC(n),r;if(e){var s=mC(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return Efe(this,r)}}function Gn(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Tfe(n,e){if(ih(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(ih(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $j(n){var e=Tfe(n,"string");return ih(e)=="symbol"?e:String(e)}function YB(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,$j(i.key),i)}}function Hn(n,e,t){return e&&YB(n.prototype,e),t&&YB(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Mt(n,e,t){return e=$j(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var Ife=10,Wj=function(){function n(){Gn(this,n),Mt(this,"priority",void 0),Mt(this,"subPriority",0)}return Hn(n,[{key:"validate",value:function(t,i){return!0}}]),n}(),Sfe=function(n){Wn(t,n);var e=jn(t);function t(i,r,s,o,a){var l;return Gn(this,t),l=e.call(this),l.value=i,l.validateValue=r,l.setValue=s,l.priority=o,a&&(l.subPriority=a),l}return Hn(t,[{key:"validate",value:function(r,s){return this.validateValue(r,this.value,s)}},{key:"set",value:function(r,s,o){return this.setValue(r,s,this.value,o)}}]),t}(Wj),Pfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",Ife),Mt(Lt(i),"subPriority",-1),i}return Hn(t,[{key:"set",value:function(r,s){if(s.timestampIsSet)return r;var o=new Date(0);return o.setFullYear(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()),o.setHours(r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()),o}}]),t}(Wj),ei=function(){function n(){Gn(this,n),Mt(this,"incompatibleTokens",void 0),Mt(this,"priority",void 0),Mt(this,"subPriority",void 0)}return Hn(n,[{key:"run",value:function(t,i,r,s){var o=this.parse(t,i,r,s);return o?{setter:new Sfe(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(t,i,r){return!0}}]),n}(),Mfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",140),Mt(Lt(i),"incompatibleTokens",["R","u","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"G":case"GG":case"GGG":return o.era(r,{width:"abbreviated"})||o.era(r,{width:"narrow"});case"GGGGG":return o.era(r,{width:"narrow"});case"GGGG":default:return o.era(r,{width:"wide"})||o.era(r,{width:"abbreviated"})||o.era(r,{width:"narrow"})}}},{key:"set",value:function(r,s,o){return s.era=o,r.setUTCFullYear(o,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Tr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Tc={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Ir(n,e){return n&&{value:e(n.value),rest:n.rest}}function or(n,e){var t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function Ic(n,e){var t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};var i=t[1]==="+"?1:-1,r=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:i*(r*_de+s*vde+o*yde),rest:e.slice(t[0].length)}}function jj(n){return or(Tr.anyDigitsSigned,n)}function vr(n,e){switch(n){case 1:return or(Tr.singleDigit,e);case 2:return or(Tr.twoDigits,e);case 3:return or(Tr.threeDigits,e);case 4:return or(Tr.fourDigits,e);default:return or(new RegExp("^\\d{1,"+n+"}"),e)}}function vC(n,e){switch(n){case 1:return or(Tr.singleDigitSigned,e);case 2:return or(Tr.twoDigitsSigned,e);case 3:return or(Tr.threeDigitsSigned,e);case 4:return or(Tr.fourDigitsSigned,e);default:return or(new RegExp("^-?\\d{1,"+n+"}"),e)}}function KO(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Qj(n,e){var t=e>0,i=t?e:1-e,r;if(i<=50)r=n||100;else{var s=i+50,o=Math.floor(s/100)*100,a=n>=s%100;r=n+o-(a?100:0)}return t?r:1-r}function Xj(n){return n%400===0||n%4===0&&n%100!==0}var Rfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",130),Mt(Lt(i),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){var a=function(c){return{year:c,isTwoDigitYear:s==="yy"}};switch(s){case"y":return Ir(vr(4,r),a);case"yo":return Ir(o.ordinalNumber(r,{unit:"year"}),a);default:return Ir(vr(s.length,r),a)}}},{key:"validate",value:function(r,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(r,s,o){var a=r.getUTCFullYear();if(o.isTwoDigitYear){var l=Qj(o.year,a);return r.setUTCFullYear(l,0,1),r.setUTCHours(0,0,0,0),r}var c=!("era"in s)||s.era===1?o.year:1-o.year;return r.setUTCFullYear(c,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Dfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",130),Mt(Lt(i),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){var a=function(c){return{year:c,isTwoDigitYear:s==="YY"}};switch(s){case"Y":return Ir(vr(4,r),a);case"Yo":return Ir(o.ordinalNumber(r,{unit:"year"}),a);default:return Ir(vr(s.length,r),a)}}},{key:"validate",value:function(r,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(r,s,o,a){var l=YO(r,a);if(o.isTwoDigitYear){var c=Qj(o.year,l);return r.setUTCFullYear(c,0,a.firstWeekContainsDate),r.setUTCHours(0,0,0,0),Up(r,a)}var u=!("era"in s)||s.era===1?o.year:1-o.year;return r.setUTCFullYear(u,0,a.firstWeekContainsDate),r.setUTCHours(0,0,0,0),Up(r,a)}}]),t}(ei),kfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",130),Mt(Lt(i),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s){return vC(s==="R"?4:s.length,r)}},{key:"set",value:function(r,s,o){var a=new Date(0);return a.setUTCFullYear(o,0,4),a.setUTCHours(0,0,0,0),Av(a)}}]),t}(ei),Ofe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",130),Mt(Lt(i),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s){return vC(s==="u"?4:s.length,r)}},{key:"set",value:function(r,s,o){return r.setUTCFullYear(o,0,1),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Lfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",120),Mt(Lt(i),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"Q":case"QQ":return vr(s.length,r);case"Qo":return o.ordinalNumber(r,{unit:"quarter"});case"QQQ":return o.quarter(r,{width:"abbreviated",context:"formatting"})||o.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(r,{width:"wide",context:"formatting"})||o.quarter(r,{width:"abbreviated",context:"formatting"})||o.quarter(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=1&&s<=4}},{key:"set",value:function(r,s,o){return r.setUTCMonth((o-1)*3,1),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Nfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",120),Mt(Lt(i),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"q":case"qq":return vr(s.length,r);case"qo":return o.ordinalNumber(r,{unit:"quarter"});case"qqq":return o.quarter(r,{width:"abbreviated",context:"standalone"})||o.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(r,{width:"wide",context:"standalone"})||o.quarter(r,{width:"abbreviated",context:"standalone"})||o.quarter(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=1&&s<=4}},{key:"set",value:function(r,s,o){return r.setUTCMonth((o-1)*3,1),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Bfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Mt(Lt(i),"priority",110),i}return Hn(t,[{key:"parse",value:function(r,s,o){var a=function(c){return c-1};switch(s){case"M":return Ir(or(Tr.month,r),a);case"MM":return Ir(vr(2,r),a);case"Mo":return Ir(o.ordinalNumber(r,{unit:"month"}),a);case"MMM":return o.month(r,{width:"abbreviated",context:"formatting"})||o.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(r,{width:"wide",context:"formatting"})||o.month(r,{width:"abbreviated",context:"formatting"})||o.month(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){return r.setUTCMonth(o,1),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Ffe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",110),Mt(Lt(i),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){var a=function(c){return c-1};switch(s){case"L":return Ir(or(Tr.month,r),a);case"LL":return Ir(vr(2,r),a);case"Lo":return Ir(o.ordinalNumber(r,{unit:"month"}),a);case"LLL":return o.month(r,{width:"abbreviated",context:"standalone"})||o.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(r,{width:"wide",context:"standalone"})||o.month(r,{width:"abbreviated",context:"standalone"})||o.month(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){return r.setUTCMonth(o,1),r.setUTCHours(0,0,0,0),r}}]),t}(ei);function Ufe(n,e,t){Gr(2,arguments);var i=io(n),r=Xo(e),s=Uj(i,t)-r;return i.setUTCDate(i.getUTCDate()-s*7),i}var Gfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",100),Mt(Lt(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"w":return or(Tr.week,r);case"wo":return o.ordinalNumber(r,{unit:"week"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=53}},{key:"set",value:function(r,s,o,a){return Up(Ufe(r,o,a),a)}}]),t}(ei);function Hfe(n,e){Gr(2,arguments);var t=io(n),i=Xo(e),r=Fj(t)-i;return t.setUTCDate(t.getUTCDate()-r*7),t}var Vfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",100),Mt(Lt(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"I":return or(Tr.week,r);case"Io":return o.ordinalNumber(r,{unit:"week"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=53}},{key:"set",value:function(r,s,o){return Av(Hfe(r,o))}}]),t}(ei),zfe=[31,28,31,30,31,30,31,31,30,31,30,31],$fe=[31,29,31,30,31,30,31,31,30,31,30,31],Wfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",90),Mt(Lt(i),"subPriority",1),Mt(Lt(i),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"d":return or(Tr.date,r);case"do":return o.ordinalNumber(r,{unit:"date"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){var o=r.getUTCFullYear(),a=Xj(o),l=r.getUTCMonth();return a?s>=1&&s<=$fe[l]:s>=1&&s<=zfe[l]}},{key:"set",value:function(r,s,o){return r.setUTCDate(o),r.setUTCHours(0,0,0,0),r}}]),t}(ei),jfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",90),Mt(Lt(i),"subpriority",1),Mt(Lt(i),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"D":case"DD":return or(Tr.dayOfYear,r);case"Do":return o.ordinalNumber(r,{unit:"date"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){var o=r.getUTCFullYear(),a=Xj(o);return a?s>=1&&s<=366:s>=1&&s<=365}},{key:"set",value:function(r,s,o){return r.setUTCMonth(0,o),r.setUTCHours(0,0,0,0),r}}]),t}(ei);function JO(n,e,t){var i,r,s,o,a,l,c,u;Gr(2,arguments);var h=e_(),d=Xo((i=(r=(s=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(l=a.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:h.weekStartsOn)!==null&&r!==void 0?r:(c=h.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=io(n),p=Xo(e),g=f.getUTCDay(),m=p%7,v=(m+7)%7,_=(v<d?7:0)+p-g;return f.setUTCDate(f.getUTCDate()+_),f}var Qfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",90),Mt(Lt(i),"incompatibleTokens",["D","i","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"E":case"EE":case"EEE":return o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=JO(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Xfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",90),Mt(Lt(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o,a){var l=function(u){var h=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+h};switch(s){case"e":case"ee":return Ir(vr(s.length,r),l);case"eo":return Ir(o.ordinalNumber(r,{unit:"day"}),l);case"eee":return o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"eeeee":return o.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=JO(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Yfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",90),Mt(Lt(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o,a){var l=function(u){var h=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+h};switch(s){case"c":case"cc":return Ir(vr(s.length,r),l);case"co":return Ir(o.ordinalNumber(r,{unit:"day"}),l);case"ccc":return o.day(r,{width:"abbreviated",context:"standalone"})||o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"});case"ccccc":return o.day(r,{width:"narrow",context:"standalone"});case"cccccc":return o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(r,{width:"wide",context:"standalone"})||o.day(r,{width:"abbreviated",context:"standalone"})||o.day(r,{width:"short",context:"standalone"})||o.day(r,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(r,s){return s>=0&&s<=6}},{key:"set",value:function(r,s,o,a){return r=JO(r,o,a),r.setUTCHours(0,0,0,0),r}}]),t}(ei);function qfe(n,e){Gr(2,arguments);var t=Xo(e);t%7===0&&(t=t-7);var i=1,r=io(n),s=r.getUTCDay(),o=t%7,a=(o+7)%7,l=(a<i?7:0)+t-s;return r.setUTCDate(r.getUTCDate()+l),r}var Kfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",90),Mt(Lt(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){var a=function(c){return c===0?7:c};switch(s){case"i":case"ii":return vr(s.length,r);case"io":return o.ordinalNumber(r,{unit:"day"});case"iii":return Ir(o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a);case"iiiii":return Ir(o.day(r,{width:"narrow",context:"formatting"}),a);case"iiiiii":return Ir(o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a);case"iiii":default:return Ir(o.day(r,{width:"wide",context:"formatting"})||o.day(r,{width:"abbreviated",context:"formatting"})||o.day(r,{width:"short",context:"formatting"})||o.day(r,{width:"narrow",context:"formatting"}),a)}}},{key:"validate",value:function(r,s){return s>=1&&s<=7}},{key:"set",value:function(r,s,o){return r=qfe(r,o),r.setUTCHours(0,0,0,0),r}}]),t}(ei),Jfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",80),Mt(Lt(i),"incompatibleTokens",["b","B","H","k","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"a":case"aa":case"aaa":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(KO(o),0,0,0),r}}]),t}(ei),Zfe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",80),Mt(Lt(i),"incompatibleTokens",["a","B","H","k","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"b":case"bb":case"bbb":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(KO(o),0,0,0),r}}]),t}(ei),epe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",80),Mt(Lt(i),"incompatibleTokens",["a","b","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"B":case"BB":case"BBB":return o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(r,{width:"wide",context:"formatting"})||o.dayPeriod(r,{width:"abbreviated",context:"formatting"})||o.dayPeriod(r,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(r,s,o){return r.setUTCHours(KO(o),0,0,0),r}}]),t}(ei),tpe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",70),Mt(Lt(i),"incompatibleTokens",["H","K","k","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"h":return or(Tr.hour12h,r);case"ho":return o.ordinalNumber(r,{unit:"hour"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=12}},{key:"set",value:function(r,s,o){var a=r.getUTCHours()>=12;return a&&o<12?r.setUTCHours(o+12,0,0,0):!a&&o===12?r.setUTCHours(0,0,0,0):r.setUTCHours(o,0,0,0),r}}]),t}(ei),npe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",70),Mt(Lt(i),"incompatibleTokens",["a","b","h","K","k","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"H":return or(Tr.hour23h,r);case"Ho":return o.ordinalNumber(r,{unit:"hour"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=23}},{key:"set",value:function(r,s,o){return r.setUTCHours(o,0,0,0),r}}]),t}(ei),ipe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",70),Mt(Lt(i),"incompatibleTokens",["h","H","k","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"K":return or(Tr.hour11h,r);case"Ko":return o.ordinalNumber(r,{unit:"hour"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=11}},{key:"set",value:function(r,s,o){var a=r.getUTCHours()>=12;return a&&o<12?r.setUTCHours(o+12,0,0,0):r.setUTCHours(o,0,0,0),r}}]),t}(ei),rpe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",70),Mt(Lt(i),"incompatibleTokens",["a","b","h","H","K","t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"k":return or(Tr.hour24h,r);case"ko":return o.ordinalNumber(r,{unit:"hour"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){return s>=1&&s<=24}},{key:"set",value:function(r,s,o){var a=o<=24?o%24:o;return r.setUTCHours(a,0,0,0),r}}]),t}(ei),spe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",60),Mt(Lt(i),"incompatibleTokens",["t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"m":return or(Tr.minute,r);case"mo":return o.ordinalNumber(r,{unit:"minute"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=59}},{key:"set",value:function(r,s,o){return r.setUTCMinutes(o,0,0),r}}]),t}(ei),ope=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",50),Mt(Lt(i),"incompatibleTokens",["t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s,o){switch(s){case"s":return or(Tr.second,r);case"so":return o.ordinalNumber(r,{unit:"second"});default:return vr(s.length,r)}}},{key:"validate",value:function(r,s){return s>=0&&s<=59}},{key:"set",value:function(r,s,o){return r.setUTCSeconds(o,0),r}}]),t}(ei),ape=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",30),Mt(Lt(i),"incompatibleTokens",["t","T"]),i}return Hn(t,[{key:"parse",value:function(r,s){var o=function(l){return Math.floor(l*Math.pow(10,-s.length+3))};return Ir(vr(s.length,r),o)}},{key:"set",value:function(r,s,o){return r.setUTCMilliseconds(o),r}}]),t}(ei),lpe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",10),Mt(Lt(i),"incompatibleTokens",["t","T","x"]),i}return Hn(t,[{key:"parse",value:function(r,s){switch(s){case"X":return Ic(Tc.basicOptionalMinutes,r);case"XX":return Ic(Tc.basic,r);case"XXXX":return Ic(Tc.basicOptionalSeconds,r);case"XXXXX":return Ic(Tc.extendedOptionalSeconds,r);case"XXX":default:return Ic(Tc.extended,r)}}},{key:"set",value:function(r,s,o){return s.timestampIsSet?r:new Date(r.getTime()-o)}}]),t}(ei),cpe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",10),Mt(Lt(i),"incompatibleTokens",["t","T","X"]),i}return Hn(t,[{key:"parse",value:function(r,s){switch(s){case"x":return Ic(Tc.basicOptionalMinutes,r);case"xx":return Ic(Tc.basic,r);case"xxxx":return Ic(Tc.basicOptionalSeconds,r);case"xxxxx":return Ic(Tc.extendedOptionalSeconds,r);case"xxx":default:return Ic(Tc.extended,r)}}},{key:"set",value:function(r,s,o){return s.timestampIsSet?r:new Date(r.getTime()-o)}}]),t}(ei),upe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",40),Mt(Lt(i),"incompatibleTokens","*"),i}return Hn(t,[{key:"parse",value:function(r){return jj(r)}},{key:"set",value:function(r,s,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),t}(ei),hpe=function(n){Wn(t,n);var e=jn(t);function t(){var i;Gn(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),Mt(Lt(i),"priority",20),Mt(Lt(i),"incompatibleTokens","*"),i}return Hn(t,[{key:"parse",value:function(r){return jj(r)}},{key:"set",value:function(r,s,o){return[new Date(o),{timestampIsSet:!0}]}}]),t}(ei),dpe={G:new Mfe,y:new Rfe,Y:new Dfe,R:new kfe,u:new Ofe,Q:new Lfe,q:new Nfe,M:new Bfe,L:new Ffe,w:new Gfe,I:new Vfe,d:new Wfe,D:new jfe,E:new Qfe,e:new Xfe,c:new Yfe,i:new Kfe,a:new Jfe,b:new Zfe,B:new epe,h:new tpe,H:new npe,K:new ipe,k:new rpe,m:new spe,s:new ope,S:new ape,X:new lpe,x:new cpe,t:new upe,T:new hpe},fpe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ppe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,gpe=/^'([^]*?)'?$/,mpe=/''/g,vpe=/\S/,_pe=/[a-zA-Z]/;function qB(n,e,t,i){var r,s,o,a,l,c,u,h,d,f,p,g,m,v,_,y,A,w;Gr(3,arguments);var b=String(n),C=String(e),I=e_(),x=(r=(s=i==null?void 0:i.locale)!==null&&s!==void 0?s:I.locale)!==null&&r!==void 0?r:qO;if(!x.match)throw new RangeError("locale must contain match property");var T=Xo((o=(a=(l=(c=i==null?void 0:i.firstWeekContainsDate)!==null&&c!==void 0?c:i==null||(u=i.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&l!==void 0?l:I.firstWeekContainsDate)!==null&&a!==void 0?a:(d=I.locale)===null||d===void 0||(f=d.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(T>=1&&T<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var O=Xo((p=(g=(m=(v=i==null?void 0:i.weekStartsOn)!==null&&v!==void 0?v:i==null||(_=i.locale)===null||_===void 0||(y=_.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&m!==void 0?m:I.weekStartsOn)!==null&&g!==void 0?g:(A=I.locale)===null||A===void 0||(w=A.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&p!==void 0?p:0);if(!(O>=0&&O<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(C==="")return b===""?io(t):new Date(NaN);var F={firstWeekContainsDate:T,weekStartsOn:O,locale:x},G=[new Pfe],B=C.match(ppe).map(function(Xe){var Ne=Xe[0];if(Ne in _M){var et=_M[Ne];return et(Xe,x.formatLong)}return Xe}).join("").match(fpe),R=[],P=XB(B),k;try{var L=function(){var Ne=k.value;!(i!=null&&i.useAdditionalWeekYearTokens)&&Vj(Ne)&&gC(Ne,C,n),!(i!=null&&i.useAdditionalDayOfYearTokens)&&Hj(Ne)&&gC(Ne,C,n);var et=Ne[0],ze=dpe[et];if(ze){var de=ze.incompatibleTokens;if(Array.isArray(de)){var lt=R.find(function(Ce){return de.includes(Ce.token)||Ce.token===et});if(lt)throw new RangeError("The format string mustn't contain `".concat(lt.fullToken,"` and `").concat(Ne,"` at the same time"))}else if(ze.incompatibleTokens==="*"&&R.length>0)throw new RangeError("The format string mustn't contain `".concat(Ne,"` and any other token at the same time"));R.push({token:et,fullToken:Ne});var he=ze.run(b,Ne,x.match,F);if(!he)return{v:new Date(NaN)};G.push(he.setter),b=he.rest}else{if(et.match(_pe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+et+"`");if(Ne==="''"?Ne="'":et==="'"&&(Ne=ype(Ne)),b.indexOf(Ne)===0)b=b.slice(Ne.length);else return{v:new Date(NaN)}}};for(P.s();!(k=P.n()).done;){var H=L();if(ih(H)==="object")return H.v}}catch(Xe){P.e(Xe)}finally{P.f()}if(b.length>0&&vpe.test(b))return new Date(NaN);var U=G.map(function(Xe){return Xe.priority}).sort(function(Xe,Ne){return Ne-Xe}).filter(function(Xe,Ne,et){return et.indexOf(Xe)===Ne}).map(function(Xe){return G.filter(function(Ne){return Ne.priority===Xe}).sort(function(Ne,et){return et.subPriority-Ne.subPriority})}).map(function(Xe){return Xe[0]}),$=io(t);if(isNaN($.getTime()))return new Date(NaN);var j=Nj($,Lj($)),Q={},ne=XB(U),ve;try{for(ne.s();!(ve=ne.n()).done;){var Pe=ve.value;if(!Pe.validate(j,F))return new Date(NaN);var De=Pe.set(j,Q,F);Array.isArray(De)?(j=De[0],xfe(Q,De[1])):j=De}}catch(Xe){ne.e(Xe)}finally{ne.f()}return j}function ype(n){return n.match(gpe)[1].replace(mpe,"'")}var VW,zW,$W,WW,jW,QW;const ui=class ui{static get savePath(){return`${Sd(new Date,"yyyy-MM-dd-HH-mm-ss")}.json`}static async setProcessParam(e){await ui.setFileProcessParam(e),ui.setLocalProcessParam(e)}static setLocalProcessParam(e){localStorage.setItem(ui.LOCAL_KEY,JSON.stringify(e))}static async setFileProcessParam(e){try{mt(ui.writeProcessParam)&&(await ui.writeProcessParam(JSON.stringify(e),ui.FILE_NAME),console.log(["=> setFileProcessParam success",e]))}catch(t){console.log(["=> setFileProcessParam fail",t])}}static async getProcessParam(){if(ui.readProcessParam)try{const e=await ui.getFileProcessParam();return Rt(e)?Promise.resolve(e):Promise.reject(`${JSON.stringify(e)} is not array`)}catch(e){if(e==="file is not exists."){const t=ui.getLocalProcessParam();return Promise.resolve(t)}return Promise.reject(e)}else{const e=ui.getLocalProcessParam();return Promise.resolve(e)}}static getLocalProcessParam(){let e=JSON.parse(localStorage.getItem(ui.LOCAL_KEY)||"[]");return Rt(e)||(e=[]),e}static async getFileProcessParam(){try{if(mt(ui.readProcessParam)){const e=await ui.readProcessParam(ui.FILE_NAME);return console.log(["=> getFileProcessParam success",e]),Promise.resolve(e)}else return Promise.reject(new Error("ProcessParamUtil.readProcessParam is not a function"))}catch(e){return console.log(["=> getFileProcessParam fail",e]),Promise.reject(e)}}static async exportProcessParamFile(e){try{if(mt(ui.saveFile)){const t=await ui.saveFile(ui.savePath,JSON.stringify(e),!1,{filters:[{name:"processParam",extensions:["json"]}]});return console.log(["=> exportProcessParamFile success",t]),Promise.resolve(t)}else return Promise.reject(new Error("ProcessParamUtil.saveFile is not a function"))}catch(t){return console.log(["=> exportProcessParamFile fail",t]),Promise.reject(t)}}static async readFileData(e){try{if(mt(ui.read2JSON)){const t=await ui.read2JSON(e);return Promise.resolve(t)}else return Promise.reject(new Error("ProcessParamUtil.read2JSON is not a function"))}catch(t){return console.log(["=> exportProcessParamFile fail",t]),Promise.reject(t)}}};E(ui,"MAX_PARAMS_NUM",30),E(ui,"LOCAL_KEY","MY_PROCESSING_TYPE_DATA"),E(ui,"SUPPORT_LINK","https://s.xtool.com/project/custom-parameter"),E(ui,"FILE_NAME","process_param.json"),E(ui,"readProcessParam",(zW=(VW=window.MeApi)==null?void 0:VW.fileHelper)==null?void 0:zW.readProcessParam),E(ui,"writeProcessParam",(WW=($W=window.MeApi)==null?void 0:$W.fileHelper)==null?void 0:WW.writeProcessParam),E(ui,"read2JSON",(QW=(jW=window.MeApi)==null?void 0:jW.fileHelper)==null?void 0:QW.read2JSON),E(ui,"saveFile",kj);let Mf=ui;const Ape=60*60*24*30;class bpe{constructor({prefixKey:e="",storage:t=localStorage}={}){E(this,"storage");E(this,"prefixKey");this.storage=t,this.prefixKey=e}getKey(e){return`${this.prefixKey}${e}`.toUpperCase()}set(e,t){const i=JSON.stringify(t);this.storage.setItem(this.getKey(e),i)}get(e,t=null){const i=this.storage.getItem(this.getKey(e));if(i)try{return JSON.parse(i)}catch{return t}return t}remove(e){this.storage.removeItem(this.getKey(e))}clear(){this.storage.clear()}setCookie(e,t,i=Ape){document.cookie=`${this.getKey(e)}=${t}; Max-Age=${i}`}getCookie(e){const t=document.cookie.split("; ");for(let i=0,r=t.length;i<r;i++){const s=t[i].split("=");if(s[0]===this.getKey(e))return s[1]}return""}removeCookie(e){this.setCookie(e,1,-1)}clearCookie(){const e=document.cookie.match(/[^ =;]+(?==)/g);if(e)for(let t=e.length;t--;)document.cookie=e[t]+"=0;expire="+new Date(0).toUTCString()}}let fS=null;const bv=()=>(fS||(fS=new bpe),fS),wpe=n=>{typeof n=="function"&&n()},Yj=(n,e=3e3,t)=>{const{immediate:i=!1}=t??{};let r=null;const s=(a=!1)=>{a===!0&&o(),r=setTimeout(()=>{wpe(n)},e)},o=()=>{r&&(clearTimeout(r),r=null)};return i===!0&&s(),{start:s,stop:o}};var Mm=(n=>(n.OLD="old",n.NEW="new",n))(Mm||{});const xpe=.0393700787;var _C=(n=>(n.MM="mm",n.IN="in",n))(_C||{}),qj=(n=>(n[n.MM=1]="MM",n[n.IN=xpe]="IN",n))(qj||{});const Kj=n=>({mm:{fractionDigits:2,step:1,scale:1,current:"mm"},in:{fractionDigits:3,step:.04,scale:qj.IN,current:"in"}})[n],Jj="SETTING_UNIT",Cpe=n=>{localStorage.setItem(Jj,n)},Epe=()=>localStorage.getItem(Jj)??"mm",Tpe=()=>{const n=Epe();return Object.assign({},{scale:2,current:"mm",fractionDigits:2,step:1},Kj(n))},Ipe=({x:n,y:e,width:t,height:i})=>{const r=n+t,s=e+i;return`M${n}, ${e}L${r}, ${e}L${r}, ${s}L${n}, ${s}Z`},KB={0:1,1:25.4,2:304.8,3:1609344,4:1,5:10,6:1e3,7:1e6,8:254e-7,9:.0254,10:914.4,11:1e-7,12:1e-6,13:.001,14:100,15:1e4,16:1e5,17:1e12,18:1496e11,19:94607e14,20:30857e15},Spe=72,M_=25.4/Spe,JB={0:1,1:M_,2:M_,3:M_,4:M_,5:M_,6:10,7:1,8:25.4,9:.352778,10:4.23333};function Ppe(n){return(n===void 0||!(n in KB))&&(n=0),KB[n]}function ZB(n){return(n===void 0||!(n in JB))&&(n=0),JB[n]}const ZO=(n,e,t)=>{if((n==null?void 0:n.indexOf("https"))===-1)return n;let i=n;return(e||t)&&(i+="?x-oss-process=image",e&&(i+=`/resize,${e},limit_0`),t&&(i+=`/interlace,1/format,${t}`)),i};var zt=(n=>(n.LASER_PLANE="LASER_PLANE",n.LASER_CYLINDER="LASER_CYLINDER",n.FREE_PLANE="FREE_PLANE",n.PASS_THROUGH="PASS_THROUGH",n.SUPER_LASER_PLANE="SUPER_LASER_PLANE",n.KNIFE_CUT="KNIFE_CUT",n.PRINTER_KNIFE_CUT="PRINTER_KNIFE_CUT",n.LASER_CONVEYOR_FEEDER="LASER_CONVEYOR_FEEDER",n.CURVE_PROCESS="CURVE_PROCESS",n.LASER_CYLINDER_CURVED_SURFACE="LASER_CYLINDER_CURVED_SURFACE",n.LASER_EXTENDER="LASER_EXTENDER",n.FLOOR_PLANE="FLOOR_PLANE",n.PASSIVE_KNIFE_CUT="PASSIVE_KNIFE_CUT",n.ACTIVE_KNIFE_CUT="ACTIVE_KNIFE_CUT",n.PRESS_PRINT="PRESS_PRINT",n.DISC_PRESS_CUT="DISC_PRESS_CUT",n.BRUSH_PAINTING="BRUSH_PAINTING",n.INK_PRINT="INK_PRINT",n.SCREEN_PRINT="SCREEN_PRINT",n.FREE_COMBINATION="FREE_COMBINATION",n.BATCH_PROCESS="BATCH_PROCESS",n.CONVEYOR_EXTENSION="CONVEYOR_EXTENSION",n.RELIEF_PROCESS="RELIEF_PROCESS",n))(zt||{}),cn=(n=>(n.VECTOR_CUTTING="VECTOR_CUTTING",n.VECTOR_ENGRAVING="VECTOR_ENGRAVING",n.FILL_VECTOR_ENGRAVING="FILL_VECTOR_ENGRAVING",n.BITMAP_ENGRAVING="BITMAP_ENGRAVING",n.KNIFE_CUTTING="KNIFE_CUTTING",n.ACTIVE_KNIFE_CUT="ACTIVE_KNIFE_CUT",n.ACTIVE_PRESS="ACTIVE_PRESS",n.ACTIVE_DISC_PRESS="ACTIVE_DISC_PRESS",n.BRUSH_PAINTING_LINE="BRUSH_PAINTING_LINE",n.BRUSH_PAINTING_BLOCK="BRUSH_PAINTING_BLOCK",n.INK_PRINT="INK_PRINT",n.RELIEF="RELIEF",n))(cn||{}),Yu=(n=>(n.AUTO="auto",n.LAYER="layer",n))(Yu||{}),Dc=(n=>(n.GROUP="group",n.SEPARATE="separate",n.SMART="smart",n.DEFAULT="default",n))(Dc||{}),Zs=(n=>(n.AUTO="auto",n.CUSTOM="custom",n.NO_SUPPORT="noSupport",n))(Zs||{});const Mpe={D1:[zt.LASER_PLANE,zt.SUPER_LASER_PLANE],D1Pro:[zt.LASER_PLANE,zt.SUPER_LASER_PLANE,zt.SCREEN_PRINT],"D1Pro 2.0":[zt.LASER_PLANE,zt.SUPER_LASER_PLANE,zt.SCREEN_PRINT],S1:[zt.LASER_PLANE,zt.SCREEN_PRINT],M1:[zt.LASER_PLANE,zt.PASS_THROUGH],P2:[zt.LASER_PLANE,zt.FREE_PLANE],P1:[zt.LASER_PLANE],F1:[zt.LASER_PLANE,zt.FREE_PLANE],F1Ultra:[zt.LASER_PLANE,zt.CONVEYOR_EXTENSION]},Rpe=["F1","F1Ultra"],Dpe=(n,e,t)=>{const i=Mpe[e];if(da(i,t)){n.supportDreedyTsp=da(Rpe,e);const{pathPlanning:s,processPath:o=Yu.AUTO}=n;if(s===Zs.NO_SUPPORT||gi(s))switch(o){case Yu.AUTO:n.pathPlanning=Zs.AUTO,n.fillPlanning=Dc.GROUP,n.isProcessByLayer=!1,n.dreedyTsp=!0;break;case Yu.LAYER:n.isProcessByLayer=!0,n.pathPlanning=Zs.CUSTOM,n.fillPlanning=Dc.SEPARATE,n.dreedyTsp=!1;break}}else n.pathPlanning=Zs.NO_SUPPORT,n.fillPlanning=Dc.SEPARATE};var Un=(n=>(n.CUSTOMIZE="customize",n.OFFICIAL="official",n))(Un||{});const Ea={[cn.VECTOR_ENGRAVING]:{lineColor:16421416,fillColor:16421416,isFill:!1},[cn.FILL_VECTOR_ENGRAVING]:{lineColor:16421416,fillColor:16421416,isFill:!0},[cn.VECTOR_CUTTING]:{lineColor:10036991,fillColor:10036991,isFill:!1},[cn.BITMAP_ENGRAVING]:{lineColor:16421416,fillColor:16421416,isFill:!0},[cn.KNIFE_CUTTING]:{lineColor:2597107,fillColor:2597107,isFill:!1},[cn.ACTIVE_PRESS]:{lineColor:2597107,fillColor:2597107,isFill:!1},[cn.ACTIVE_KNIFE_CUT]:{lineColor:2597107,fillColor:2597107,isFill:!1},[cn.ACTIVE_DISC_PRESS]:{lineColor:2597107,fillColor:2597107,isFill:!1},[cn.BRUSH_PAINTING_LINE]:{lineColor:2597107,fillColor:2597107,isFill:!1},[cn.BRUSH_PAINTING_BLOCK]:{lineColor:2597107,fillColor:2597107,isFill:!0},[cn.INK_PRINT]:{lineColor:2597107,fillColor:2597107,isFill:!1},[cn.RELIEF]:{lineColor:16421416,fillColor:16421416,isFill:!0}},kpe=["material","thickness","perimeter","diameter"];var $h,Tu,Qs,xo,Vm,Xs,Ot,Uf,e0,_i,Gf;class Ope extends j0{constructor(t,i,r,s){super();ke(this,Qs);E(this,"_canvasManager");ke(this,$h,void 0);ke(this,Tu,void 0);ke(this,Vm,void 0);ke(this,Xs,void 0);ke(this,Ot,{});ke(this,Uf,{});ke(this,e0,{});ke(this,_i,"");ke(this,Gf,[]);Qe(this,$h,t),Qe(this,Tu,i),Qe(this,Vm,r),Qe(this,Xs,s)}get canvasManager(){return this._canvasManager}set canvasManager(t){this._canvasManager=t}set defaultDeviceValues(t){Qe(this,$h,t)}set defaultElementValue(t){mt(t)?Qe(this,Tu,t):Qe(this,Tu,t)}set getSpeedScope(t){Qe(this,Vm,t)}set getProcessingTypes(t){Qe(this,Xs,t)}get data(){return S(this,Ot)}get projectData(){const t=new Map;return Object.keys(S(this,Ot)).forEach(i=>{const r=this.getCurrentDeviceData(i);t.set(i,r)}),t}getCurrentDeviceData(t){const i=pn(S(this,Ot)[t])||{},{mode:r,data:s={},displays:o={}}=i;Ft(i,"data",{[r]:{...s}});const a=new Map;return Object.keys(o).forEach(l=>{a.set(l,o[l])}),Ft(i,"displays",a),i}setProjectData(t,i,r,s){const o={},a=pn(t),l=[];a.forEach((c,u)=>{var g;const h=We(c,"mode"),d=We(c,`data.${h}`),f=We(c,"displays"),p={};Dpe(d,s||"",h),f.forEach((m,v)=>{var A;const y=(((A=i.find(w=>w.id===u))==null?void 0:A.displays)||[]).find(w=>w.id===v);if(y){const w=We(m,"type","");let b=We(m,"processingType","");const C=this.getImageType(y.type),I=S(this,Xs).call(this,{mode:h,imageType:C});if(!wt(I)&&!I.some(F=>F.value===b)&&(b=I[0].value,Ft(m,"processingType",b),Ft(m,"isFill",!!Ea[b].isFill)),w===kh.BITMAP&&!wt(I)&&!I.some(F=>F.value===b)&&(b=I[0].value,Ft(m,"processingType",b),Ft(m,"isFill",!!Ea[b].isFill)),w!==kh.BITMAP){const F=I.find(B=>B.isFill===!0);y.isFill&&F&&b!==F.value&&Ft(m,"processingType",F.value);const G=I.find(B=>B.isFill===!1);!y.isFill&&F&&b===(F==null?void 0:F.value)&&Ft(m,"processingType",(G==null?void 0:G.value)||cn.VECTOR_ENGRAVING),Ft(m,"isFill",y.isFill)}const x=Ds(m,"processIgnore");let T=We(m,"processIgnore",!1);const O=We(m,"data",{});Object.keys(O).forEach(F=>{var P;const G=We(O,`${b}.materialType`,"");![Un.CUSTOMIZE,Un.OFFICIAL].includes(G)&&!r.some(k=>k.id===G)&&Ft(O,`${b}.materialType`,Un.CUSTOMIZE);const B=O[F].parameter;if(Ds(O[F],"processIgnore")&&!x){const k=(P=O[F])==null?void 0:P.processIgnore;k!==T&&k&&(T=k),delete O[F].processIgnore}Object.keys(B).forEach(k=>{[Un.CUSTOMIZE,Un.OFFICIAL].includes(k)&&(B[k]=Object.assign({},S(this,Qs,xo)[F]||{},B[k]))})}),Ft(m,"processIgnore",T),p[v]=m}}),o[u]={mode:h,data:d,displays:p},(g=this.canvasManager)==null||g.canvasList.forEach((m,v)=>{if(v===u){const y=m.exportCanvasJSON().map(b=>{if(!p[b.id])return{id:b.id,type:b.type,isFill:b.isFill,sourceId:b.sourceId}}).filter(b=>b);if(!wt(y)){const b={sourceCanvasId:u,targetCanvasId:u,displayJSONs:y};l.push(b)}const A=S(this,Xs).call(this,{mode:h});let w=cn.VECTOR_ENGRAVING;!wt(A)&&Ea[A[0].value]&&(w=A[0].value),m.updateDisplayConfig({updateCanvasDisplay:!1,enableFill:A.some(b=>b.isFill),...Ea[w]})}})}),Qe(this,Ot,pn(o)),l.forEach(c=>{this.setDisplays(c)}),console.log(["=> dataSource set ProjectData",o,t,S(this,Ot),l])}batchUpdateOfficialMaterial(t){Object.keys(S(this,Ot)).forEach(i=>{const r=We(S(this,Ot)[i],"data.material")||0,s=t.find(o=>o.id===r);if(r&&s){this.officialMaterial={id:i,value:s};const o=We(S(this,Ot),`${i}.displays`,{});Object.keys(o).forEach(a=>{const l=We(o,`${a}.data`,{});Object.keys(l).forEach(c=>{const u=gr(s.processingData[c],Ks(S(this,Qs,xo)[c]));wt(u)?(delete l[`${c}.parameter.official`],We(l,`${c}.materialType`)===Un.OFFICIAL&&Ft(l,`${c}.materialType`,Un.CUSTOMIZE)):Ft(l,`${c}.parameter.official`,Object.assign(pn(S(this,Qs,xo)[c])||{},u))})})}})}get currentDeviceData(){return this.getCurrentDeviceData(S(this,_i))}get currentDeviceModeData(){const{mode:t,data:i={}}=S(this,Ot)[S(this,_i)]||{};return{mode:t,...i}}resetData(t){const i={};t.forEach(r=>{const s=S(this,$h)[r.mode||""]?{mode:r.mode,data:r.data}:void 0;i[r.id]=this.setDefaultCanvasData(r.id,s),Ft(S(this,Ot),`${r.id}`,pn(i[r.id])),r.displays.forEach(o=>{const a=this.setDefaultDisplayData(r.id,o);Ft(i,`${r.id}.displays.${o.id}`,a)})}),Qe(this,Ot,pn(i))}resetCurrentData(t){const i={},r=t.length;for(let s=0;s<r;s++){const o=t[s];if(o.id===S(this,_i)){i[o.id]=this.setDefaultCanvasData(o.id),o.displays.forEach(a=>{const l=this.setDefaultDisplayData(o.id,a);Ft(S(this,Ot),`${o.id}.displays.${a.id}`,l)});break}}}set officialMaterial(t){S(this,Uf)[t.id]=t.value}getOfficialMaterial(t){return S(this,Uf)[t||S(this,_i)]}set customProcessData(t){S(this,e0)[t.id]=t}getCustomProcessData(t){const i=S(this,e0)[t];if(i){const{processingType:r=""}=i,s=Ks(S(this,Qs,xo)[r]);return gr(i,s)}return{}}batchUpdateCustomProcessData(t){t.forEach(i=>{this.customProcessData=i})}get canvasId(){return S(this,_i)}set canvasId(t){t&&(Qe(this,_i,t),this.setCanvas(t))}setCanvas(t){t&&!Ds(S(this,Ot),t)&&(S(this,Ot)[t]=this.setDefaultCanvasData(t))}removeCanvas(t){t&&Ds(S(this,Ot),t)&&delete S(this,Ot)[t]}setDefaultCanvasData(t,i){var a;const r=(i==null?void 0:i.mode)||zt.LASER_PLANE,s={...pn(S(this,$h)[r])||{},...gr((i==null?void 0:i.data)||{},kpe)},o={mode:r,data:s,displays:{}};return(a=this.canvasManager)==null||a.canvasList.forEach((l,c)=>{if(c===t){const u=S(this,Xs).call(this,{mode:r});let h=cn.VECTOR_ENGRAVING;!wt(u)&&Ea[u[0].value]&&(h=u[0].value),l.updateDisplayConfig({updateCanvasDisplay:!1,enableFill:u.some(d=>d.isFill),...Ea[h]})}}),o}get elements(){return S(this,Gf)}set elements(t){Qe(this,Gf,t),t.forEach(i=>{const r=`${S(this,_i)}.displays.${i.id}`;if(!Ds(S(this,Ot),r)){const s=this.setDefaultDisplayData(S(this,_i),i);Ft(S(this,Ot),r,s)}})}getImageType(t){return t===kh.BITMAP?kh.BITMAP:kh.VECTOR}getDefaultProcessingType(t,i,r){const s=S(this,Xs).call(this,{mode:t,imageType:i}),o=s.filter(l=>l.isFill===r);let a;return wt(o)?wt(s)?a=i===kh.BITMAP?cn.BITMAP_ENGRAVING:cn.VECTOR_ENGRAVING:a=s[0].value:a=o[0].value,a}setDefaultDisplayData(t,i){const{type:r,isFill:s,processIgnore:o}=i,a=this.getImageType(r),l=Un.CUSTOMIZE,c=We(S(this,Ot),`${t}.mode`,zt.LASER_PLANE);let u=this.getDefaultProcessingType(c,a,s);i.processingType&&i.processingType!==u&&S(this,Xs).call(this,{mode:c,imageType:a}).filter(g=>g.isFill===s).some(g=>g.value===i.processingType)&&(u=i.processingType);const h={};Object.keys(S(this,Qs,xo)).forEach(p=>{S(this,Xs).call(this,{imageType:a}).forEach(m=>{m.value===p&&(h[m.value]={materialType:l,parameter:{customize:{...pn(S(this,Qs,xo)[p])}}})})});const d=We(S(this,Ot),`${t}.data.material`)||0,f=S(this,Uf)[t];return d&&f&&f.id&&Object.keys(f.processingData).forEach(p=>{Ft(h,`${p}.materialType`,Un.OFFICIAL),Ft(h,`${p}.parameter.official`,{...pn(S(this,Qs,xo)[p]),...gr(f.processingData[p],Ks(S(this,Qs,xo)[p]))})}),{isFill:s,type:r,processingType:u,data:h,processIgnore:!!o}}setProcessDataValues(t,i){const r={default:a=>{this.setProcessParamValues(a,t,i)},processIgnore:a=>{Ft(S(this,Ot),`${S(this,_i)}.displays.${a}.processIgnore`,i)},processHead:a=>{this.setProcessHead(a,i)},processingType:a=>{this.setProcessingType(a,i)},materialType:a=>{this.setMaterialType(a,i)},saveParam:a=>{this.saveParam(a,i)},matrixParam:a=>{this.setMatrixParam(a,i)}},s=["processingType","materialType","saveParam"].includes(t),o=s?this.getDeviceFormValues():{};S(this,Gf).forEach(({id:a})=>{if((r[t]||r.default)(a),s){const c=We(S(this,Ot),`${this.canvasId}.displays.${a}`,{});this.updateSpeed(o,c)}}),t==="processingType"&&this.updateSelectedAttributes(i)}updateSelectedAttributes(t){var i;(i=this.canvasManager)==null||i.canvas.updateSelectedAttributes(Ea[t])}setMatrixParam(t,i={}){const r=We(S(this,Ot),`${S(this,_i)}.displays.${t}`,{}),s=We(r,"processingType"),o=We(r,`data.${s}.materialType`);if(o!=="customize"){const u=We(r,`data.${s}.parameter.${o!=="official"?"customize":"official"}`,{});Ft(r,`data.${s}.materialType`,"customize"),Ft(r,`data.${s}.parameter.customize`,{...u,...i})}else{const l=We(r,`data.${s}.parameter.customize`,{});Ft(r,`data.${s}.parameter.customize`,{...l,...i})}}setMatrixParamFromOutside(t){const i=We(S(this,Ot),`${S(this,_i)}.displays`,{});Object.keys(i).forEach(r=>{const s=i[r],o=We(s,"processingType")||"";if(o!==t.processingType)return;const a={};Object.keys(t.matrix).forEach(c=>{const u=We(s,`data.${o}.parameter.${Un.OFFICIAL}.${c}`);a[c]=u}),Fl(t.matrix,a)?this.setMaterialType(r,{materialType:Un.OFFICIAL,data:{}}):this.setMatrixParam(r,t.matrix)})}setProcessParamValues(t,i,r){const s=We(S(this,Ot),`${S(this,_i)}.displays.${t}`,{}),o=We(s,"processingType")||"",a=We(s,`data.${o}.materialType`);if(a!==Un.CUSTOMIZE){const d=a!==Un.OFFICIAL?Un.CUSTOMIZE:Un.OFFICIAL,f=We(s,`data.${o}.parameter.${d}`,{});Ft(s,`data.${o}.materialType`,Un.CUSTOMIZE),Ft(s,`data.${o}.parameter.customize`,{...f})}const c=We(s,`data.${o}.parameter.customize.${i}`),u=this.transformProcessParamValues(i,r,c);Ft(s,`data.${o}.parameter.customize.${i}`,u),this.powerMinMaxRangeToPower(s,o,i,u)}powerMinMaxRangeToPower(t,i,r,s){if(r==="powerMinMaxRange"){const o=Wa(s);Ft(t,`data.${i}.parameter.customize.power`,o[1])}}transformProcessParamValues(t,i,r){let s=i;if(t==="powerMinMaxRange"){r=Wa(r);const o=i[0],a=i[1];if(!tn(o)&&tn(a)){const l=r[0];a>l?s=[l,a]:s=r}else if(tn(o)&&!tn(a)){const l=r[1];o<l?s=[o,l]:s=r}else!tn(o)&&!tn(a)&&(s=r)}return s}saveParam(t,i){const r=i.processingType;gi(r)||(this.setMaterialType(t,{materialType:i.id,data:i.data}),this.customProcessData=i)}setProcessingType(t,i){Ft(S(this,Ot),`${S(this,_i)}.displays.${t}.processingType`,i);const{isFill:r}=Ea[i];tA(r)&&Ft(S(this,Ot),`${S(this,_i)}.displays.${t}.isFill`,r)}setProcessHead(t,i){Ft(S(this,Ot),`${S(this,_i)}.displays.${t}.processHead`,i);const r=We(S(this,Ot),`${S(this,_i)}.displays.${t}.type`,""),s=this.getImageType(r),o=We(S(this,Ot),`${S(this,_i)}.mode`),a=S(this,Xs).call(this,{mode:o,imageType:s}),l=uC(a,{processHead:[i]});console.log(["=====> processingTypeList",l]),this.setProcessDataValues("processingType",l[0].value)}setMaterialType(t,i){const{materialType:r,data:s}=i,o=We(S(this,Ot),`${S(this,_i)}.displays.${t}.processingType`)||"",a=We(S(this,Ot),`${S(this,_i)}.displays.${t}`,{}),l=We(a,`data.${o}.materialType`);let c=We(a,`data.${o}.parameter.customize`,{});l===Un.OFFICIAL&&(c=We(a,`data.${o}.parameter.official`,{}));const u=Ks(S(this,Qs,xo)[o]);Ft(a,`data.${o}.materialType`,r),Ft(a,`data.${o}.parameter.customize`,{...gr(c,u),...gr(s,u)})}removeProcessingParam(t){Object.keys(S(this,Ot)).forEach(i=>{const r=We(S(this,Ot),`${i}.displays`,{});Object.keys(r).forEach(s=>{const o=We(r,`${s}.data`,{});Object.keys(o).forEach(a=>{We(o,`${a}.materialType`,"")===t&&Ft(o,`${a}.materialType`,Un.CUSTOMIZE)})})})}assignProcessDataValues(t,i){const r=Object.assign({},t,i);return Object.keys(r).forEach(s=>{Ds(t,s)&&!Fl(r[s],t[s])&&(r[s]=null)}),r}getProcessDataValues(){let t={};return S(this,Gf).map(({id:i},r)=>{const s=We(S(this,Ot),`${S(this,_i)}.displays.${i}`,{}),o=We(s,"processIgnore"),a=We(s,"processingType"),l=We(s,`data.${a}.materialType`,""),c=[Un.CUSTOMIZE,Un.OFFICIAL].includes(l)?l:Un.CUSTOMIZE,u=We(s,`data.${a}.parameter.${c}`)||{},h={processIgnore:o,processingType:a,materialType:l,...u};return(h==null?void 0:h.bitmapMode)==="Grayscale"&&(h.bitmapMode="grayscale"),r===0?t=h:t=this.assignProcessDataValues(t,h),h}),t}getSaveParamValues(){const t=this.getProcessDataValues(),i={};return Object.keys(t).forEach(r=>{["processIgnore","processingType","materialType"].includes(r)||(i[r]=t[r])}),i}getDeviceFormValues(){const t=We(S(this,Ot),`${this.canvasId}.mode`,""),i=We(S(this,Ot),`${this.canvasId}.data`,{});return{mode:t,...i}}setDeviceFormValues(t,i){const r={default:()=>{Ft(S(this,Ot),`${this.canvasId}.data.${t}`,i)},mode:()=>{this.setDeviceMode(i)},material:()=>{this.setMaterial(i)},diameter:()=>{Ft(S(this,Ot),`${this.canvasId}.data.diameter`,i),Ft(S(this,Ot),`${this.canvasId}.data.perimeter`,tn(i)?Math.round(i*Math.PI*10)/10:null)},perimeter:()=>{Ft(S(this,Ot),`${this.canvasId}.data.diameter`,tn(i)?Math.round(i*10/Math.PI)/10:null),Ft(S(this,Ot),`${this.canvasId}.data.perimeter`,i)}};if((r[t]||r.default)(),["mode","material","rotaryAttachmentType","diameter","perimeter"].includes(t)){const o=this.getDeviceFormValues(),a=We(S(this,Ot),`${this.canvasId}.displays`,{});Object.keys(a).forEach(l=>{this.updateSpeed(o,a[l])})}}setMaterial(t){const{justUpdateProcessingData:i,...r}=t,{id:s,thickness:o=null,processingData:a}=t;let{diameter:l=null,perimeter:c=null}=t;l=l||null,c=l?l*Math.PI:null,s>0?this.officialMaterial={value:r,id:S(this,_i)}:delete S(this,Uf)[S(this,_i)];const u=s,h=We(S(this,Ot),`${this.canvasId}.data`,{});i||Object.assign(h,{material:u,diameter:l,perimeter:c,thickness:o}),Ft(S(this,Ot),`${this.canvasId}.data`,h);const d=We(S(this,Ot),`${this.canvasId}.displays`,{});Object.keys(d).forEach(f=>{const p=We(d,`${f}.data`,{});Object.keys(p).forEach(g=>{const m=gr(a[g],Ks(S(this,Qs,xo)[g]));!wt(m)&&s?(i||Ft(p,`${g}.materialType`,Un.OFFICIAL),Ft(p,`${g}.parameter.official`,Object.assign(pn(S(this,Qs,xo)[g])||{},m))):(Ft(p,`${g}.materialType`,Un.CUSTOMIZE),delete p[`${g}.parameter.official`])})})}setDeviceMode({value:t,processingTypeList:i}){var p,g;const r=pn(S(this,$h)[t]||{}),s=We(S(this,Ot),`${this.canvasId}.data`)||{},{material:o=0,thickness:a=null,perimeter:l=null,diameter:c=null}=s;Ft(S(this,Ot),`${this.canvasId}.mode`,t),Ft(S(this,Ot),`${this.canvasId}.data`,Object.assign(r,{material:o,thickness:a,perimeter:l,diameter:c}));const u=We(S(this,Ot),`${this.canvasId}.displays`,{}),h=[];Object.keys(u).forEach(m=>{const v=We(u,`${m}.type`,""),_=this.getImageType(v),y=We(u,`${m}.processingType`),A=uC(i,w=>w.imageType===_).map(w=>w.value);if(!wt(A)&&!A.includes(y)){Ft(u,`${m}.processingType`,A[0]);const{isFill:w,fillColor:b,lineColor:C}=Ea[A[0]]||{};Ft(u,`${m}.isFill`,w),h.push({id:m,config:{isFill:w,fillColor:b,lineColor:C}})}}),(p=this.canvasManager)==null||p.canvas.updateMultiDisplayConfig(h);const d=S(this,Xs).call(this,{mode:t}),f={updateCanvasDisplay:!1,enableFill:d.some(m=>m.isFill),...Ea[wt(d)?cn.VECTOR_ENGRAVING:d[0].value]};console.log(["=>updateDisplayConfigData",f]),(g=this.canvasManager)==null||g.canvas.updateDisplayConfig(f)}updateSpeed(t,i){const r=We(i,"processingType",""),s=We(i,"type",""),o=this.getImageType(s),a=We(t,"mode",""),l=S(this,Xs).call(this,{mode:a,imageType:o});if(wt(l))return;const c=We(i,`data.${r}.parameter`,{}),u=We(i,`data.${r}.materialType`,Un.CUSTOMIZE);Object.keys(c).forEach(h=>{const d=S(this,Vm).call(this,t,{processingType:r}),f=We(c[h],"speed",1);let p=f;if(f>d.max)p=d.max;else if(f<d.max&&u!==Un.CUSTOMIZE)if(u===Un.OFFICIAL&&h===Un.OFFICIAL){const g=this.getOfficialMaterial(),m=We(g,`processingData.${r}.speed`,f);p=Math.min(m,d.max)}else{const g=this.getCustomProcessData(u),m=We(g,"data.speed",f);p=Math.min(m,d.max)}Ft(c[h],"speed",p)})}get currentModeData(){return We(S(this,Ot),`${S(this,_i)}.data`)}setDisplays(t){var a,l;const{sourceCanvasId:i,targetCanvasId:r,displayJSONs:s=[]}=t;if(wt(s))return;const o=[];s.forEach(c=>{var f;const u=`${r}.displays.${c.id}`;if(Ds(S(this,Ot),u))return;let h=pn(We(S(this,Ot),`${i}.displays.${c.sourceId}`)||We(S(this,Ot),`${r}.displays.${c.sourceId}`));if(gi(h))h=pn(this.setDefaultDisplayData(r,c));else if(i!==r){const p=We(S(this,Ot),`${r}.mode`,zt.LASER_PLANE),g=We(S(this,Ot),`${i}.data.material`),m=We(S(this,Ot),`${r}.data.material`);if(We(h,"type")!==kh.BITMAP){const _=S(this,Xs).call(this,{mode:p}),y=We(h,"processingType",cn.VECTOR_ENGRAVING);if(!_.some(A=>A.value===y)){const A=this.getImageType(c.type),w=this.getDefaultProcessingType(p,A,c.isFill);Ft(h,"processingType",w),Ft(h,"isFill",c.isFill),o.push({id:c.id,config:Ea[w]})}}if(g!==0&&m===0){const _=We(h,"data");Object.keys(_).forEach(y=>{Ft(_[y],"materialType",Un.CUSTOMIZE),delete _[y].parameter.official})}if(g!==m&&m>0){const _=(f=this.getOfficialMaterial())==null?void 0:f.processingData,y=We(h,"data",{});Object.keys(y).forEach(A=>{const w=gr(_[A],Ks(S(this,Qs,xo)[A]));w&&(Ft(y,`${A}.materialType`,Un.OFFICIAL),Ft(y,`${A}.parameter.official`,Object.assign(pn(S(this,Qs,xo)[A])||{},w)))})}}const d=this.getDeviceFormValues();this.updateSpeed(d,h),Ft(S(this,Ot),u,pn(h))}),(l=(a=this.canvasManager)==null?void 0:a.canvas)==null||l.updateMultiDisplayConfig(o)}updateParamTest(t){const{testDisplays:i,textDisplays:r}=t;i.forEach(s=>{const o=`${S(this,_i)}.displays.${s.id}`;if(Ds(S(this,Ot),o)){const a=We(S(this,Ot),o),l=We(a,"processingType"),c=We(a,`data.${l}.materialType`),u=We(a,`data.${l}.parameter.${c===Un.OFFICIAL?Un.OFFICIAL:Un.CUSTOMIZE}`);c!==Un.CUSTOMIZE&&Ft(a,`data.${l}.materialType`,Un.CUSTOMIZE),Ft(a,`data.${l}.parameter.customize`,{...u,...s.value})}}),r.ids.forEach(s=>{const o=`${S(this,_i)}.displays.${s}`;if(Ds(S(this,Ot),o)){const a=We(S(this,Ot),o),l=We(a,`data.${r.processingType}.parameter.customize`);Ft(a,`data.${r.processingType}.parameter.customize`,{...l,...r.value})}})}checkProcessingType(){Object.keys(S(this,Ot)).forEach(t=>{var o;const{mode:i,displays:r={}}=S(this,Ot)[t],s=[];Object.keys(r).forEach(a=>{const{processingType:l,type:c,isFill:u}=r[a],h=this.getImageType(c);if(!S(this,Xs).call(this,{mode:i,imageType:h}).includes(l)){const f=this.getDefaultProcessingType(i,h,u);Ft(r[a],"processingType",f);const p=Ea[f]||{};tA(p==null?void 0:p.isFill)&&Ft(r[a],"isFill",p.isFill),s.push({id:a,config:p})}}),(o=this.canvasManager)==null||o.canvasList.forEach((a,l)=>{l===t&&a.updateMultiDisplayConfig(s)})})}dispose(){this.removeAllListeners()}}$h=new WeakMap,Tu=new WeakMap,Qs=new WeakSet,xo=function(){return mt(S(this,Tu))?S(this,Tu).call(this):S(this,Tu)},Vm=new WeakMap,Xs=new WeakMap,Ot=new WeakMap,Uf=new WeakMap,e0=new WeakMap,_i=new WeakMap,Gf=new WeakMap;const co=class co extends j0{static init(e,t){var r;co.clear();const i=new Ope(e.deviceDataValues,mt(e.elementDataValues)?e.elementDataValues.bind(e):e.elementDataValues,e.getSpeedScope.bind(e),e.getProcessingTypes.bind(e));i.canvasManager=t,co.dataSource=i,e.dataSource=i,(r=t.canvas)==null||r.clearSelected(),console.log(["=> data source init"])}static update(e){var t;co.dataSource&&(co.dataSource.defaultElementValue=mt(e.elementDataValues)?e.elementDataValues.bind(e):e.elementDataValues,co.dataSource.defaultDeviceValues=e.deviceDataValues,co.dataSource.getSpeedScope=(t=e.getSpeedScope)==null?void 0:t.bind(e),co.dataSource.getProcessingTypes=e.getProcessingTypes.bind(e),e.dataSource=co.dataSource)}static clear(){co.dataSource&&(co.dataSource.emit("reset"),co.dataSource.dispose(),co.dataSource=void 0)}};E(co,"dataSource");let fo=co;const gd=[{name:"xTool M1",extId:"M1",versionId:"18",workspaceId:"xcs-ext-m1",tagName:"M1",path:new URL(""+new URL("../assets/index-lXLiKA_G.ts",import.meta.url).href,import.meta.url).href},{name:"xTool D1",extId:"D1",versionId:"30",workspaceId:"xcs-ext-d1",tagName:"D1",path:new URL(""+new URL("../assets/index-zBLZ0usb.ts",import.meta.url).href,import.meta.url).href},{name:"xTool D1 Pro",extId:"D1Pro",versionId:"31",workspaceId:"xcs-ext-d1-pro",tagName:"D1Pro",path:new URL(""+new URL("../assets/index-GpFU4Ktl.ts",import.meta.url).href,import.meta.url).href},{name:"xTool D1 Pro 2.0",extId:"D1Pro 2.0",versionId:"33",alias:["D1Pro2"],workspaceId:"xcs-ext-d1-pro2",tagName:"D1Pro 2.0",path:new URL(""+new URL("../assets/index-KFs3mx5M.ts",import.meta.url).href,import.meta.url).href},{name:"xTool P1",extId:"P1",versionId:"15",workspaceId:"xcs-ext-p1",tagName:"P1",path:new URL(""+new URL("../assets/index-s0qsmEsb.ts",import.meta.url).href,import.meta.url).href},{name:"xTool P2",extId:"P2",versionId:"21",workspaceId:"xcs-ext-p2",tagName:"P2",path:new URL(""+new URL("../assets/index-_9g5jaEl.ts",import.meta.url).href,import.meta.url).href},{name:"xTool F1",extId:"F1",versionId:"51",workspaceId:"xcs-ext-f1",tagName:"F1",path:new URL(""+new URL("../assets/index-CaHpySvW.ts",import.meta.url).href,import.meta.url).href},{name:"xTool S1",extId:"S1",versionId:"32",alias:["D2"],workspaceId:"xcs-ext-d2",tagName:"S1",path:new URL(""+new URL("../assets/index-PLjAwlvQ.ts",import.meta.url).href,import.meta.url).href},{name:"xTool M2",extId:"M2",versionId:"41",workspaceId:"xcs-ext-m1-lite",tagName:"M2",path:new URL(""+new URL("../assets/index-Hhd6fdIX.ts",import.meta.url).href,import.meta.url).href},{name:"xTool F1 Ultra",extId:"F1Ultra",versionId:"52",workspaceId:"xcs-ext-f1-ultra",tagName:"F1Ultra",path:new URL(""+new URL("../assets/index-SE-2jzPb.ts",import.meta.url).href,import.meta.url).href}];var AM=function(n,e){return AM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},AM(n,e)};function tb(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");AM(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function mft(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function Lpe(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function Zj(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(i=1,r&&(s=c[0]&2?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,r=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],r=0}finally{i=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function wv(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bM(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),r,s=[],o;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return s}function wM(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||Array.prototype.slice.call(e))}function Rm(n){return this instanceof Rm?(this.v=n,this):new Rm(n)}function Npe(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){i[d]&&(r[d]=function(f){return new Promise(function(p,g){s.push([d,f,p,g])>1||a(d,f)})})}function a(d,f){try{l(i[d](f))}catch(p){h(s[0][3],p)}}function l(d){d.value instanceof Rm?Promise.resolve(d.value.v).then(c,u):h(s[0][2],d)}function c(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Bpe(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof wv=="function"?wv(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){o=n[s](o),r(a,l,o.done,o.value)})}}function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}function to(n){return typeof n=="function"}function eQ(n){var e=function(i){Error.call(i),i.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var pS=eQ(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(i,r){return r+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function xM(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var $T=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,i,r,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=wv(o),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(g){e={error:g}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(to(u))try{u()}catch(g){s=g instanceof pS?g.errors:[g]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var d=wv(h),f=d.next();!f.done;f=d.next()){var p=f.value;try{eF(p)}catch(g){s=s??[],g instanceof pS?s=wM(wM([],bM(s)),bM(g.errors)):s.push(g)}}}catch(g){i={error:g}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(i)throw i.error}}}if(s)throw new pS(s)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)eF(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&xM(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&xM(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),tQ=$T.EMPTY;function nQ(n){return n instanceof $T||n&&"closed"in n&&to(n.remove)&&to(n.add)&&to(n.unsubscribe)}function eF(n){to(n)?n():n.unsubscribe()}var iQ={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},rQ={setTimeout:function(n,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];return setTimeout.apply(void 0,wM([n,e],bM(t)))},clearTimeout:function(n){var e=rQ.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function sQ(n){rQ.setTimeout(function(){throw n})}function CM(){}function Dx(n){n()}var eL=function(n){tb(e,n);function e(t){var i=n.call(this)||this;return i.isStopped=!1,t?(i.destination=t,nQ(t)&&t.add(i)):i.destination=Hpe,i}return e.create=function(t,i,r){return new EM(t,i,r)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}($T),Fpe=Function.prototype.bind;function gS(n,e){return Fpe.call(n,e)}var Upe=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(i){Pb(i)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(i){Pb(i)}else Pb(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){Pb(t)}},n}(),EM=function(n){tb(e,n);function e(t,i,r){var s=n.call(this)||this,o;if(to(t)||!t)o={next:t??void 0,error:i??void 0,complete:r??void 0};else{var a;s&&iQ.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return s.unsubscribe()},o={next:t.next&&gS(t.next,a),error:t.error&&gS(t.error,a),complete:t.complete&&gS(t.complete,a)}):o=t}return s.destination=new Upe(o),s}return e}(eL);function Pb(n){sQ(n)}function Gpe(n){throw n}var Hpe={closed:!0,next:CM,error:Gpe,complete:CM},tL=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Vpe(n){return n}function zpe(n){return n.length===0?Vpe:n.length===1?n[0]:function(t){return n.reduce(function(i,r){return r(i)},t)}}var Pd=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,i){var r=this,s=Wpe(e)?e:new EM(e,t,i);return Dx(function(){var o=r,a=o.operator,l=o.source;s.add(a?a.call(s,l):l?r._subscribe(s):r._trySubscribe(s))}),s},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var i=this;return t=tF(t),new t(function(r,s){var o=new EM({next:function(a){try{e(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});i.subscribe(o)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[tL]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return zpe(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=tF(e),new e(function(i,r){var s;t.subscribe(function(o){return s=o},function(o){return r(o)},function(){return i(s)})})},n.create=function(e){return new n(e)},n}();function tF(n){var e;return(e=n??iQ.Promise)!==null&&e!==void 0?e:Promise}function $pe(n){return n&&to(n.next)&&to(n.error)&&to(n.complete)}function Wpe(n){return n&&n instanceof eL||$pe(n)&&nQ(n)}function jpe(n){return to(n==null?void 0:n.lift)}function Qpe(n){return function(e){if(jpe(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function nF(n,e,t,i,r){return new Xpe(n,e,t,i,r)}var Xpe=function(n){tb(e,n);function e(t,i,r,s,o,a){var l=n.call(this,t)||this;return l.onFinalize=o,l.shouldUnsubscribe=a,l._next=i?function(c){try{i(c)}catch(u){t.error(u)}}:n.prototype._next,l._error=s?function(c){try{s(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;n.prototype.unsubscribe.call(this),!i&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(eL),Ype=eQ(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),oA=function(n){tb(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var i=new iF(this,this);return i.operator=t,i},e.prototype._throwIfClosed=function(){if(this.closed)throw new Ype},e.prototype.next=function(t){var i=this;Dx(function(){var r,s;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var o=wv(i.currentObservers),a=o.next();!a.done;a=o.next()){var l=a.value;l.next(t)}}catch(c){r={error:c}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(r)throw r.error}}}})},e.prototype.error=function(t){var i=this;Dx(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=t;for(var r=i.observers;r.length;)r.shift().error(t)}})},e.prototype.complete=function(){var t=this;Dx(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var i=t.observers;i.length;)i.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var i=this,r=this,s=r.hasError,o=r.isStopped,a=r.observers;return s||o?tQ:(this.currentObservers=null,a.push(t),new $T(function(){i.currentObservers=null,xM(a,t)}))},e.prototype._checkFinalizedStatuses=function(t){var i=this,r=i.hasError,s=i.thrownError,o=i.isStopped;r?t.error(s):o&&t.complete()},e.prototype.asObservable=function(){var t=new Pd;return t.source=this,t},e.create=function(t,i){return new iF(t,i)},e}(Pd),iF=function(n){tb(e,n);function e(t,i){var r=n.call(this)||this;return r.destination=t,r.source=i,r}return e.prototype.next=function(t){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.next)===null||r===void 0||r.call(i,t)},e.prototype.error=function(t){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.error)===null||r===void 0||r.call(i,t)},e.prototype.complete=function(){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||i===void 0||i.call(t)},e.prototype._subscribe=function(t){var i,r;return(r=(i=this.source)===null||i===void 0?void 0:i.subscribe(t))!==null&&r!==void 0?r:tQ},e}(oA),qpe=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function Kpe(n){return to(n==null?void 0:n.then)}function Jpe(n){return to(n[tL])}function Zpe(n){return Symbol.asyncIterator&&to(n==null?void 0:n[Symbol.asyncIterator])}function ege(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function tge(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var nge=tge();function ige(n){return to(n==null?void 0:n[nge])}function rge(n){return Npe(this,arguments,function(){var t,i,r,s;return Zj(this,function(o){switch(o.label){case 0:t=n.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,Rm(t.read())];case 3:return i=o.sent(),r=i.value,s=i.done,s?[4,Rm(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,Rm(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function sge(n){return to(n==null?void 0:n.getReader)}function oge(n){if(n instanceof Pd)return n;if(n!=null){if(Jpe(n))return age(n);if(qpe(n))return lge(n);if(Kpe(n))return cge(n);if(Zpe(n))return oQ(n);if(ige(n))return uge(n);if(sge(n))return hge(n)}throw ege(n)}function age(n){return new Pd(function(e){var t=n[tL]();if(to(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function lge(n){return new Pd(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function cge(n){return new Pd(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,sQ)})}function uge(n){return new Pd(function(e){var t,i;try{for(var r=wv(n),s=r.next();!s.done;s=r.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){t={error:a}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}e.complete()})}function oQ(n){return new Pd(function(e){dge(n,e).catch(function(t){return e.error(t)})})}function hge(n){return oQ(rge(n))}function dge(n,e){var t,i,r,s;return Lpe(this,void 0,void 0,function(){var o,a;return Zj(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=Bpe(n),l.label=1;case 1:return[4,t.next()];case 2:if(i=l.sent(),!!i.done)return[3,4];if(o=i.value,e.next(o),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),r={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),i&&!i.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Mb(n){return Qpe(function(e,t){var i=new oA;t.next(i.asObservable());var r=function(s){i.error(s),t.error(s)};return e.subscribe(nF(t,function(s){return i==null?void 0:i.next(s)},function(){i.complete(),t.complete()},r)),oge(n).subscribe(nF(t,function(){i.complete(),t.next(i=new oA)},CM,r)),function(){i==null||i.unsubscribe(),i=null}})}const aQ=250,lQ=4*60;let fge={delay:aQ,maxTry:lQ,until:null};function pge(){return Object.assign({},fge)}let cQ=60*1e3;var uQ=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function hQ(n=cQ){return new Promise(e=>setTimeout(e,n))}function dQ(n,e=cQ,t=new mge("function did not complete within allowed time")){return uQ(this,void 0,void 0,function*(){const i=Symbol("DELAY_EXPIRED"),r=yield Promise.race([n(),gge(e,i)]);if(r===i)throw t;return r})}const gge=(n,e)=>uQ(void 0,void 0,void 0,function*(){return yield hQ(n),e});let mge=class extends Error{constructor(){super(...arguments),this.isTimeout=!0}};function vge(n,e){const t=Object.assign(Object.assign({},pge()),e);return Object.assign(Object.assign({},t),{currentTry:n,maxTry:t.maxTry||lQ,delay:_ge(t.delay),until:t.until?t.until:()=>!0})}function _ge(n){return n===void 0?()=>aQ:typeof n=="function"?n:()=>n}class yge extends Error{constructor(e=void 0){super("function did not complete within allowed number of attempts"),this.lastResult=e,this.tooManyTries=!0}getLastResult(){return this.lastResult}}function Age(n){return n.tooManyTries===!0}var nL=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function bge(n,e){return nL(this,void 0,void 0,function*(){const t=vge(1,e);return yield fQ(n,t)})}function fQ(n,e){return nL(this,void 0,void 0,function*(){const t=e.currentTry<e.maxTry;try{const i=yield n();if(e.until(i))return i;if(t)return yield rF(n,e,i);throw new yge(i)}catch(i){if(!Age(i)&&t)return e.onError&&e.onError(i),yield rF(n,e);throw e.onMaxRetryFunc&&e.onMaxRetryFunc(i),i}})}function rF(n,e,t){return nL(this,void 0,void 0,function*(){const i=e.delay({currentTry:e.currentTry,maxTry:e.maxTry,lastDelay:e.lastDelay,lastResult:t});yield hQ(i);const r=Object.assign(Object.assign({},e),{currentTry:e.currentTry+1});return yield fQ(n,r)})}let Rb;const wge=new Uint8Array(16);function xge(){if(!Rb&&(Rb=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Rb))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rb(wge)}const Cs=[];for(let n=0;n<256;++n)Cs.push((n+256).toString(16).slice(1));function Cge(n,e=0){return Cs[n[e+0]]+Cs[n[e+1]]+Cs[n[e+2]]+Cs[n[e+3]]+"-"+Cs[n[e+4]]+Cs[n[e+5]]+"-"+Cs[n[e+6]]+Cs[n[e+7]]+"-"+Cs[n[e+8]]+Cs[n[e+9]]+"-"+Cs[n[e+10]]+Cs[n[e+11]]+Cs[n[e+12]]+Cs[n[e+13]]+Cs[n[e+14]]+Cs[n[e+15]]}const Ege=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),sF={randomUUID:Ege};function Gp(n,e,t){if(sF.randomUUID&&!e&&!n)return sF.randomUUID();n=n||{};const i=n.random||(n.rng||xge)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(let r=0;r<16;++r)e[t+r]=i[r];return e}return Cge(i)}var Ml,zm,XW;let t_=(XW=class extends j0{constructor(t){super();ke(this,Ml,void 0);E(this,"subject",new oA);ke(this,zm,new Map);t&&(Qe(this,Ml,new t),S(this,Ml).addEventListener("error",i=>{console.log(["=> WorkerBasic error",i]),this.emit("error",i)}),S(this,Ml).addEventListener("message",i=>{We(i.data,"reqId")?(console.log("============socket.onmessage by send ",i.data),this.subject.next(i.data)):(console.log("============socket.onmessage ",i.data),this.emit("message",i.data))}))}get worker(){return S(this,Ml)}request(t,i=0){if(!S(this,Ml))return Promise.reject("worker is not define.");const r=()=>new Promise((s,o)=>{var c;const a=Gp();S(this,zm).set(a,o),(c=S(this,Ml))==null||c.postMessage({...t,reqId:a});const l=this.subject.subscribe(u=>{var h;if(u.reqId===a)return S(this,zm).delete(a),l.unsubscribe(),u.error||u.type==="error"?(console.log("terminate gcode worker"),(h=S(this,Ml))==null||h.terminate(),o(u.error)):s(u.data)})});return i>0?dQ(r,i,new Error("worker request error")):r()}destroy(){var t;S(this,zm).forEach(i=>{mt(i)&&i(new Error("worker did destroy"))}),this.removeAllListeners(),(t=S(this,Ml))==null||t.terminate()}},Ml=new WeakMap,zm=new WeakMap,XW);function Tge(n){return new Worker(""+new URL("../assets/socketWorker-uv0vs9xD.js",import.meta.url).href,{name:n==null?void 0:n.name})}class pQ extends t_{constructor(){super(Tge)}async create(e,t=!1){try{return await this.request({type:"createSocket",data:{url:e,isHeartbeat:t}},8e3)}catch(i){return this.close(),this.destroy(),Promise.reject(i)}}close(){return this.request({type:"closeSocket"})}}const Ige=n=>`ws://${n}:8081`;let Sge=class extends uh.EventEmitter{constructor(t){super();E(this,"ip");E(this,"isOpen",!1);E(this,"webRequest",!0);E(this,"callbacks");E(this,"socketWorker");E(this,"heartbeatTimeout",12e3);E(this,"heartbeatTimeoutFn");E(this,"isHeartbeat",!1);E(this,"closePing",()=>{});this.ip=t,this.callbacks={onClose(){},onReceive(){},onError(){}},this.heartbeatTimeoutFn=Yj(()=>{console.warn("=> socket heartbeat timeout"),this.heartbeatTimeoutFn.stop(),this.close()},this.heartbeatTimeout)}get socketUrl(){return Ige(this.ip)}get connectIdentify(){return this.ip}async setup(t,i=!1){this.isHeartbeat=i,Tt.info(["=> setup NetServer",this.ip,{useSocket:t}]),this.setupCallbacks(),t&&await this.setupSocket(),await this.checkIpOnline(),this.isOpen=!0}async setupSocket(){return Tt.info(["=> setupSocket",this.ip]),new Promise(async(t,i)=>{this.socketWorker=new pQ;const r={open:()=>{console.log(["opened",this.ip]),t(!0),this.isOpen=!0},message:s=>{this.emit(Sl.RECEIVE,s)},close:()=>{Tt.info(["=> service message socket closed.",this.ip]),this.emit(Sl.CLOSED),this.socketWorker.destroy(),i(),this.isOpen=!1},error:s=>{Tt.error(["=> service message socket error",this.ip,s]),i(s),this.isOpen=!1},heartbeat:()=>{this.heartbeatTimeoutFn.start(!0),t(!0)}};this.socketWorker.on("message",({type:s,data:o})=>{const a=r[s];mt(a)&&a(o)}),this.socketWorker.on("error",s=>{i(s)});try{await this.socketWorker.create(this.socketUrl,this.isHeartbeat)}catch(s){i(s),this.isOpen=!1}})}setupCallbacks(){this.on(Sl.CLOSED,()=>{mt(this.callbacks.onClose)&&this.callbacks.onClose()}),this.on(Sl.ERROR,()=>{mt(this.callbacks.onError)&&this.callbacks.onError()}),this.on(Sl.RECEIVE,t=>{mt(this.callbacks.onReceive)&&this.callbacks.onReceive(t)})}onReceive(t){const i=r=>{console.log({chunk:r}),mt(t)&&t(r)};return this.on(Sl.RECEIVE,i),()=>{this.off(Sl.RECEIVE,i)}}setCallbacks(t){Tt.debug(["=> socket setCallback"]),this.callbacks=Object.assign(this.callbacks,t)}hasOpen(){return this.isOpen}apiParser(t){return Tj(t,this.ip)}apiParserNext(t){const i=(r,s,o)=>{const a=(h,d)=>this.socketWorker.request({type:"execCmd",data:{cmd:h,args:s,...d}});mt(r)&&(r=r(s));const{dataTransform:l,...c}=o.options||{};let u;if(Rt(r)){const h=[];r.forEach(d=>{h.push(a(d,{...c,type:o.type}))}),u=Promise.all(h)}else u=a(r,{...c,type:o.type});return u.then(h=>mt(l)?l(h):h)};return VT(t,this.ip,i.bind(this))}async checkIpOnline(){var i,r,s;if(!((i=window.MeApi)!=null&&i.ping))return!1;const t=await((r=window.MeApi)==null?void 0:r.ping.pingOnceCheck(this.ip));if(!t)return this.isOpen=!1,Promise.reject(`device is online ${t}`);this.isOpen=!0,this.closePing=(s=window.MeApi)==null?void 0:s.ping.pingHeartCheck(this.ip,()=>{this.close()},{maxCount:5,timeout:2})}close(){this.closeSocket(),this.dispose()}closeSocket(){var t;return(t=this.socketWorker)==null?void 0:t.close()}dispose(){var t;this.isOpen=!1,mt(this.closePing)&&this.closePing(this.ip),this.closePing=()=>{},this.emit(Sl.CLOSED),this.callbacks={onClose(){},onReceive(){},onError(){}},this.removeAllListeners(),(t=this.socketWorker)==null||t.destroy()}};const oF=["201.234.3.1","201.234.4.1"],Pge=[{name:"version",timeout:3e3,list:[{url:"/system",params:{action:"version"},transformResult(n){return We(n,"version")}},{url:"/system",params:{action:"version_v2"},transformResult(n){return We(n,"package_version",n)}}]},{name:"info",timeout:3e3,list:[{url:"/system",params:{action:"get_dev_name"},transformResult(n){return We(n,"name",n)}},{url:"/system",params:{action:"mac"},transformResult(n){return We(n,"mac",pj(n,`
`))}}]}],iL=async(n,e,t)=>{const i=VT(Pge,n);try{const s=(await i.version({signal:t})).find(u=>pi(u));if(!s)return null;const o=await i.info({signal:t}),[a,l]=o.map(u=>pi(u)||tn(u)?u:""),c={ip:n,version:s,name:a,mac:l};return console.log(["=> data",c,n]),mt(e)&&e(c),c}catch(r){Tt.error(r)}return null};var TM={exports:{}},IM={exports:{}},SM={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=t;function t(i){return function(...r){if(i===null)throw new Error("Callback was already called.");var s=i;i=null,s.apply(this,r)}}n.exports=e.default})(SM,SM.exports);var Mge=SM.exports,ph={};Object.defineProperty(ph,"__esModule",{value:!0});ph.fallback=gQ;ph.wrap=mQ;var Rge=ph.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,Dge=ph.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,kge=ph.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function gQ(n){setTimeout(n,0)}function mQ(n){return(e,...t)=>n(()=>e(...t))}var ry;Rge?ry=queueMicrotask:Dge?ry=setImmediate:kge?ry=process.nextTick:ry=gQ;ph.default=mQ(ry);var PM={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0});class t{constructor(){this.head=this.tail=null,this.length=0}removeLink(s){return s.prev?s.prev.next=s.next:this.head=s.next,s.next?s.next.prev=s.prev:this.tail=s.prev,s.prev=s.next=null,this.length-=1,s}empty(){for(;this.head;)this.shift();return this}insertAfter(s,o){o.prev=s,o.next=s.next,s.next?s.next.prev=o:this.tail=o,s.next=o,this.length+=1}insertBefore(s,o){o.prev=s.prev,o.next=s,s.prev?s.prev.next=o:this.head=o,s.prev=o,this.length+=1}unshift(s){this.head?this.insertBefore(this.head,s):i(this,s)}push(s){this.tail?this.insertAfter(this.tail,s):i(this,s)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var s=this.head;s;)yield s.data,s=s.next}remove(s){for(var o=this.head;o;){var{next:a}=o;s(o)&&this.removeLink(o),o=a}return this}}e.default=t;function i(r,s){r.length=1,r.head=r.tail=s}n.exports=e.default})(PM,PM.exports);var Oge=PM.exports,lc={},Db={exports:{}},MM={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(...i){var r=i.pop();return t.call(this,i,r)}},n.exports=e.default})(MM,MM.exports);var Lge=MM.exports,aF;function Nge(){return aF||(aF=1,function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=l;var t=Lge,i=a(t),r=ph,s=a(r),o=rL();function a(h){return h&&h.__esModule?h:{default:h}}function l(h){return(0,o.isAsync)(h)?function(...d){const f=d.pop(),p=h.apply(this,d);return c(p,f)}:(0,i.default)(function(d,f){var p;try{p=h.apply(this,d)}catch(g){return f(g)}if(p&&typeof p.then=="function")return c(p,f);f(null,p)})}function c(h,d){return h.then(f=>{u(d,null,f)},f=>{u(d,f&&(f instanceof Error||f.message)?f:new Error(f))})}function u(h,d,f){try{h(d,f)}catch(p){(0,s.default)(g=>{throw g},p)}}n.exports=e.default}(Db,Db.exports)),Db.exports}var lF;function rL(){if(lF)return lc;lF=1,Object.defineProperty(lc,"__esModule",{value:!0}),lc.isAsyncIterable=lc.isAsyncGenerator=lc.isAsync=void 0;var n=Nge(),e=t(n);function t(a){return a&&a.__esModule?a:{default:a}}function i(a){return a[Symbol.toStringTag]==="AsyncFunction"}function r(a){return a[Symbol.toStringTag]==="AsyncGenerator"}function s(a){return typeof a[Symbol.asyncIterator]=="function"}function o(a){if(typeof a!="function")throw new Error("expected a function");return i(a)?(0,e.default)(a):a}return lc.default=o,lc.isAsync=i,lc.isAsyncGenerator=r,lc.isAsyncIterable=s,lc}(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=h;var t=Mge,i=u(t),r=ph,s=u(r),o=Oge,a=u(o),l=rL(),c=u(l);function u(d){return d&&d.__esModule?d:{default:d}}function h(d,f,p){if(f==null)f=1;else if(f===0)throw new RangeError("Concurrency must not be zero");var g=(0,c.default)(d),m=0,v=[];const _={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function y(B,R){_[B].push(R)}function A(B,R){const P=(...k)=>{w(B,P),R(...k)};_[B].push(P)}function w(B,R){if(!B)return Object.keys(_).forEach(P=>_[P]=[]);if(!R)return _[B]=[];_[B]=_[B].filter(P=>P!==R)}function b(B,...R){_[B].forEach(P=>P(...R))}var C=!1;function I(B,R,P,k){if(k!=null&&typeof k!="function")throw new Error("task callback must be a function");G.started=!0;var L,H;function U(j,...Q){if(j)return P?H(j):L();if(Q.length<=1)return L(Q[0]);L(Q)}var $=G._createTaskItem(B,P?U:k||U);if(R?G._tasks.unshift($):G._tasks.push($),C||(C=!0,(0,s.default)(()=>{C=!1,G.process()})),P||!k)return new Promise((j,Q)=>{L=j,H=Q})}function x(B){return function(R,...P){m-=1;for(var k=0,L=B.length;k<L;k++){var H=B[k],U=v.indexOf(H);U===0?v.shift():U>0&&v.splice(U,1),H.callback(R,...P),R!=null&&b("error",R,H.data)}m<=G.concurrency-G.buffer&&b("unsaturated"),G.idle()&&b("drain"),G.process()}}function T(B){return B.length===0&&G.idle()?((0,s.default)(()=>b("drain")),!0):!1}const O=B=>R=>{if(!R)return new Promise((P,k)=>{A(B,(L,H)=>{if(L)return k(L);P(H)})});w(B),y(B,R)};var F=!1,G={_tasks:new a.default,_createTaskItem(B,R){return{data:B,callback:R}},*[Symbol.iterator](){yield*G._tasks[Symbol.iterator]()},concurrency:f,payload:p,buffer:f/4,started:!1,paused:!1,push(B,R){return Array.isArray(B)?T(B)?void 0:B.map(P=>I(P,!1,!1,R)):I(B,!1,!1,R)},pushAsync(B,R){return Array.isArray(B)?T(B)?void 0:B.map(P=>I(P,!1,!0,R)):I(B,!1,!0,R)},kill(){w(),G._tasks.empty()},unshift(B,R){return Array.isArray(B)?T(B)?void 0:B.map(P=>I(P,!0,!1,R)):I(B,!0,!1,R)},unshiftAsync(B,R){return Array.isArray(B)?T(B)?void 0:B.map(P=>I(P,!0,!0,R)):I(B,!0,!0,R)},remove(B){G._tasks.remove(B)},process(){if(!F){for(F=!0;!G.paused&&m<G.concurrency&&G._tasks.length;){var B=[],R=[],P=G._tasks.length;G.payload&&(P=Math.min(P,G.payload));for(var k=0;k<P;k++){var L=G._tasks.shift();B.push(L),v.push(L),R.push(L.data)}m+=1,G._tasks.length===0&&b("empty"),m===G.concurrency&&b("saturated");var H=(0,i.default)(x(B));g(R,H)}F=!1}},length(){return G._tasks.length},running(){return m},workersList(){return v},idle(){return G._tasks.length+m===0},pause(){G.paused=!0},resume(){G.paused!==!1&&(G.paused=!1,(0,s.default)(G.process))}};return Object.defineProperties(G,{saturated:{writable:!1,value:O("saturated")},unsaturated:{writable:!1,value:O("unsaturated")},empty:{writable:!1,value:O("empty")},drain:{writable:!1,value:O("drain")},error:{writable:!1,value:O("error")}}),G}n.exports=e.default})(IM,IM.exports);var Bge=IM.exports;(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(a,l){var c=(0,s.default)(a);return(0,i.default)((u,h)=>{c(u[0],h)},l,1)};var t=Bge,i=o(t),r=rL(),s=o(r);function o(a){return a&&a.__esModule?a:{default:a}}n.exports=e.default})(TM,TM.exports);var Fge=TM.exports;const vQ=Ld(Fge),Uge=()=>{const n=new AbortController;return{signal:n.signal,cancel(){n.abort()}}},Gge=50;var Ex,Wh,jh;let of=(Ex=class{static get q(){return S(this,Wh)||Qe(this,Wh,vQ((e,t)=>{e().finally(()=>{t()})},Gge)),S(this,Wh)}static get signal(){return S(this,jh)||Qe(this,jh,Uge()),S(this,jh)}static async dispose(){var t,i;if((t=S(this,Wh))==null||t.kill(),Qe(this,Wh,null),(i=S(this,jh))==null||i.cancel(),Qe(this,jh,null),!window.MeApi)return;const{discovery:e}=window.MeApi;e&&await e.dispose()}},Wh=new WeakMap,jh=new WeakMap,ke(Ex,Wh,void 0),ke(Ex,jh,void 0),Ex);const _Q=(n,e=[])=>{console.log(["=> sameGatewayIps",n]);const t=[];if(Rt(n))return n.forEach(a=>{t.push(..._Q(a,e))}),t;const[i,r,s,o]=n.split(".");for(let a=1;a<255;a++){if(Number(o)===a)continue;const l=[i,r,s,a].join(".");e.includes(l)||t.push(l)}return t},Hge=async n=>{try{const{discovery:e}=window.MeApi,t=[];if(e){await of.dispose();const i=[],r=h=>{t.some(f=>f.ip===h.ip)||(t.push(h),mt(n.onDiscover)&&n.onDiscover(h))},{signal:s}=of.signal,o=await e.ip(),a="192.168.40.1",l=h=>()=>iL(h,r,s),c=async()=>{e.on("receiver",async h=>{const{ip:d,name:f,version:p}=h;d&&(oF.includes(d)||d!==a&&(i.push(d),d&&p?r({ip:d,name:f,version:p}):of.q.pushAsync(l(d))))}),await e.list(),await e.dispose()};of.q.pushAsync(c);let u=Ja(_Q(o,[...i,...oF,a]));return u.length>100&&(u=u.slice(99).concat(u.slice(0,99))),u.forEach(h=>{of.q.pushAsync(l(h))}),await of.q.drain(),console.log(["=> 队列执行完成"]),t}return[]}catch(e){return Tt.error(e),[]}},Vge=()=>of.dispose(),zge=n=>iL(n),$ge=n=>new Sge(n);let Wge=class extends j0{constructor(t){super();E(this,"options");E(this,"port");this.options=t}get connectIdentify(){var t;return(t=this.port)==null?void 0:t.connectIdentify}async init(){var t,i,r,s;return(i=(t=window.MeApi)==null?void 0:t.serial)!=null&&i.open?(this.port=await((s=(r=window.MeApi)==null?void 0:r.serial)==null?void 0:s.open(this.options)),Tt.info("串口初始化",this.port.connectIdentify),this.port.on("data",o=>{this.emit(Sl.RECEIVE,o)}),this.port.on("close",()=>{Tt.info("检测到设备端口关闭",this.port.connectIdentify),this.emit(Sl.CLOSED)}),this):Promise.reject()}hasOpen(){var t;return(t=this.port)==null?void 0:t.hasOpen()}write(t,i,r){var s;return(s=this.port)==null?void 0:s.write.bind(this.port)(t,i,r)}onReceive(t){var i;return(i=this.port)==null?void 0:i.onReceive.bind(this.port)(t)}setCallbacks(t){var i;(i=this.port)==null||i.setCallbacks.bind(this.port)(t)}apiParser(t){var r;const i=(r=this.port)==null?void 0:r.apiParser.bind(this.port)(t);return i.uploadGcode=(...s)=>{var o;return(o=this.port)==null?void 0:o.uploadFile(...s)},i.updateFirmware=s=>{var o,a;return(a=(o=window.MeApi)==null?void 0:o.serial)==null?void 0:a.updateFirmware({...s,baud:115200,port:this.connectIdentify})},i.downloadFirmware=(...s)=>{var o,a;return(a=(o=window.MeApi)==null?void 0:o.serial)==null?void 0:a.downloadFirmware(...s)},i}getData(t,i,r=1e3){var s;return(s=this.port)==null?void 0:s.getData.bind(this.port)(t,i,r)}setData(t,i=[]){var r;return(r=this.port)==null?void 0:r.setData.bind(this.port)(t,i)}stopReadGcodeFile(){var t;return(t=this.port)==null?void 0:t.closeReadFile()}close(){var t;return(t=this.port)==null?void 0:t.close()}dispose(){this.removeAllListeners()}};const jge=n=>{var e,t,i;return(e=window.MeApi)!=null&&e.serial?(i=(t=window.MeApi)==null?void 0:t.serial)==null?void 0:i.list(n):Promise.reject()},Qge=n=>new Wge(n).init(),Xge=n=>n?Promise.all([n.getData("M99",void 0,1500),n.getData("M100",void 0,1500)]):Promise.reject(new Error("get device version error. port is unknown.")),Yge={open:Qge,list:jge,version:Xge},Eg={ethList:zge,wifiList:Hge,open:$ge,info:iL,stopList:Vge},kb=n=>{var i,r;if(!pi(n))return;if(new RegExp("[v|V]1\\.[0-9]+.[0-9]+ [b|B][0-9]+").test(n))return(i=gd.find(s=>s.versionId==="30"))==null?void 0:i.extId;const[,t]=n.match(/\d+/g)??[];return(r=gd.find(s=>s.versionId===t))==null?void 0:r.extId},qge="device-canvas-plugin";ja.SERIAL+"",{...Yge},ja.ETH+"",Eg.ethList,Eg.open,ja.WIFI+"",Eg.wifiList,Eg.open,ja.USB+"",Eg.ethList,Eg.open;var t0,Hf,Qh,Vf;class Kge{constructor(e,t,i){ke(this,t0,{});ke(this,Hf,"");ke(this,Qh,[]);ke(this,Vf,"");Qe(this,t0,e),Qe(this,Hf,t),S(this,Qh).push(i),Qe(this,Vf,this.value)}get key(){return S(this,Hf)}get value(){return pi(S(this,Hf))?We(S(this,t0),S(this,Hf)):null}addCallBack(e){return S(this,Qh).push(e),()=>{Qe(this,Qh,S(this,Qh).filter(t=>t!==e))}}check(){const e=this.value;if(JSON.stringify(e)===JSON.stringify(S(this,Vf))){for(const t of S(this,Qh))t(e,S(this,Vf));Qe(this,Vf,e)}}}t0=new WeakMap,Hf=new WeakMap,Qh=new WeakMap,Vf=new WeakMap;class Jge{constructor(){E(this,"updaters",[])}addUpdater(e){this.updaters.push(e)}getUpdater(e){return this.updaters.find(t=>t.checkOption.resId===e)}removeUpdater(e){dC(this.updaters,t=>t.checkOption.resId===e)}async checkShouldUpdate(e,t,i){const r=this.getUpdater(e);try{const s=await(r==null?void 0:r.check(!0,t,i));return s?s.shouldUpdate:!1}catch(s){return Tt.error("检测是否需要更新扩展出错",s),!1}}download(e,t){const i=this.getUpdater(e);return navigator.onLine?Promise.race([i==null?void 0:i.download(t).catch(r=>{let s=r;return r==="networkError"&&(s={name:gy.NETWORK_DISCONNECT,message:"network disconnect"}),Promise.reject(s)}),new Promise((r,s)=>{window.onoffline=()=>{i==null||i.dispose(),s({name:gy.NETWORK_DISCONNECT,message:"network disconnect"})}})]):Promise.reject({name:gy.NETWORK_DISCONNECT,message:"network disconnect"})}}class yQ{constructor(e){E(this,"checkOption");E(this,"checkResult",null);E(this,"downloading",!1);E(this,"downloadCancelable",null);this.checkOption={silent:!1,...e}}get shouldUpdate(){return this.checkResult?this.checkResult.shouldUpdate:!1}async check(e=!1,t,i=[],r=lg.ExtVer){if(console.log(["check",this.checkResult,e]),this.checkResult&&e===!1)return Promise.resolve(this.checkResult);const{resId:s}=this.checkOption,o=await Pj(t,s,{mockKey:r,extraFilter:i});return this.checkResult=o,o}async download(e={useTimestamp:!1}){const{useTimestamp:t}=e;console.log("download");const{downloadUrl:i}=this.checkResult||{};let{dest:r}=this.checkOption;if(this.downloading=!0,t){const l=Sd(new Date,"yyyy_MM_dd_HH_mm_ss");r=`${r}/${l}.ext`}const s=Array.isArray(i)?i[0]:i;if(!s){Tt.error("下载资源，未检测到有效下载地址");return}const o=this,a=await(Ri==null?void 0:Ri.downloadFile(s,{pathToSave:r,onProgress(l){},onCancel(l){o.downloadCancelable=l}}).finally(()=>{this.downloading=!1}));return Tt.log(["updater download",a]),a}dispose(){this.downloading&&mt(this.downloadCancelable)&&(console.log("取消下载扩展资源"),this.downloadCancelable(),this.downloadCancelable=null)}unZip(e,t){return Ri.unzipFile(e,t)}}class Zge extends uh.EventEmitter{}const eme={LOAD:"load",CONNECTED:"connected",BEFORE_UNLOADED:"beforeUnloaded",DISCONNECT:"disconnect",CHANGE:"change",ERROR:"error"};class tme extends Zge{constructor(){super(...arguments);E(this,"config");E(this,"_connected",!1);E(this,"connectType",ja.ETH);E(this,"_deviceInfo");E(this,"_deviceState");E(this,"_device");E(this,"_whenReceiveCmdResolveMap");E(this,"_apis",{});E(this,"_canvasId","")}get LIFECYCLE(){return eme}setupLifeCycle(){const{LIFECYCLE:t}=this;[{name:t.LOAD,listener:this.onLoad},{name:t.CONNECTED,listener:this.onConnected},{name:t.DISCONNECT,listener:this.onDisconnect},{name:t.CHANGE,listener:this.onChange},{name:t.BEFORE_UNLOADED,listener:this.onBeforeUnloaded}].forEach(({name:r,listener:s})=>{const o=()=>{};this.on(r,(s||o).bind(this))})}get connected(){return this==null?void 0:this._connected}set connected(t){this._connected=t}get info(){return this.deviceInfo}get deviceInfo(){return this._deviceInfo}set deviceInfo(t){var s;const{power:i}=t,{power:r=0}=this.deviceInfo||{};if(this.connected&&(i||i===0)&&(r||r===0)&&r.toString()!==i.toString()){Tt.info("=> SYSTEM_EVENT.UPDATE_DEVICE_INFO POWER",r,i),console.info("=> SYSTEM_EVENT.UPDATE_DEVICE_INFO POWER",r,i,this.connected,this.instanceId),lS==null||lS.closeConnect((s=this.device)==null?void 0:s.connectIdentity);return}this._deviceInfo=Object.assign({},this._deviceInfo,t),this.emit(ss.UPDATE_DEVICE_INFO,{...this._deviceInfo,instanceId:this.instanceId})}get deviceState(){return this._deviceState}set deviceState(t){this._deviceState=Object.assign({},this._deviceState,t),this.emit(ss.DEVICE_STATE_CHANGE,t)}get device(){return this._device}set device(t){this._device=t}get whenReceiveCmdResolveMap(){return this._whenReceiveCmdResolveMap||(this._whenReceiveCmdResolveMap=new Map),this._whenReceiveCmdResolveMap}whenReceiveCmd(t,i=3e4,r){return dQ(()=>new Promise((s,o)=>{console.log("[ 注册监听 ] >",t),this.whenReceiveCmdResolveMap.set(t,s),r==null||r.signal.addEventListener("abort",()=>{console.log("[ 中途取消 ] >",t),o(new Error("Aborted"))})}).finally(()=>{console.log("[ 删除监听 ] >",t),this.whenReceiveCmdResolveMap.delete(t)}),i,new Error(`wait ${t} timeout.`))}deviceCmdParsing(t){console.log(t)}get apis(){return this._apis}set apis(t){this._apis=t}async initDeviceInfo(){const i=await this.apis.deviceInfo({})||{};return this.updateDeviceInfo(i),i}updateDeviceInfo(t){this.deviceInfo=t}async initDeviceState(){const t=await this.apis.deviceState();return this.deviceState=t,t}get canvasId(){return this._canvasId}set canvasId(t){this._canvasId=t}}class nme extends uh.EventEmitter{}class ime{constructor(){E(this,"_config");E(this,"_exceptionsKeys")}get config(){return this._config}set config(e){this._config=e}get hooks(){return this._config.gcodeHooks}get contentId(){return this._config.firmwareContentId}get id(){return this._config.id}get deviceExceptions(){return this._config.deviceExceptions}get exceptionsKeys(){return this._exceptionsKeys||(this._exceptionsKeys=Zi(this.deviceExceptions,"code")),this._exceptionsKeys}getExceptionsByKey(e){const t=this.deviceExceptions;return t==null?void 0:t.find(i=>i.code===e)}get networkProtocols(){var e;return(e=this._config.protocols)==null?void 0:e.network}get serialProtocols(){var e;return(e=this._config.protocols)==null?void 0:e.serial}get processingArea(){return this._config.processingArea}get baseProcessingArea(){return this._config.processingArea.base}getProcessingAreaByKey(e){const t=this._config.processingArea.data.find(i=>i.key===e);return t||this.baseProcessingArea}getProtocolConfig(e){if([ja.ETH,ja.WIFI,ja.USB].includes(e))return this.networkProtocols;if(e===ja.SERIAL)return this.serialProtocols}}class rme{constructor(){E(this,"downloadCancelable",()=>{});E(this,"uploadCancelable",()=>{})}removeTag(){}downloadFirmware(e){const{signal:t,cancel:i}=pM();return this.downloadCancelable=i,sA({...e,url:e.url[0],timeout:0,params:{t:+new Date},responseType:"blob",signal:t})}async updateFirmware(e,t=!0){const{cancel:i}=pM();return this.uploadCancelable=i,Object.assign(e),t?this.apis.updateFirmwareHandshake().then(r=>r.result==="ok"?this.apis.updateFirmware(e):Promise.reject(r)):this.apis.updateFirmware(e)}async commonCheckVersion(e){const t=await this.apis.version(),i=yv(t,e);return console.log({version:e,primaryVersion:t,isPrimaryStatus:i}),i>=0?!0:Promise.reject(`commonCheckVersion error ${i}`)}async checkFirmwareUpdated(e,t,i){const{delay:r=1e3*30,loopCount:s=100,onCheckProgress:o=()=>{}}=t||{};Tt.info(["=> checkFirmwareUpdated",e]),await fC(r),Tt.info(["=> checkFirmwareUpdated delay done.",r]);for(let a=0;a<s;a++){try{return console.log(["=> checkFirmwareUpdated compare version count",a+1]),o(a),this.customCheckVersion?await this.customCheckVersion(i):await this.commonCheckVersion(e),!0}catch(l){Tt.error(["=> checkFirmwareUpdated",l])}await fC(2e3)}return Promise.reject("checkFirmwareUpdated can not match the version.")}}class sme extends uh.EventEmitter{constructor(){super(...arguments);E(this,"PROCESSING_STATE_CHANGE","PROCESSING_STATE_CHANGE");E(this,"processingState",mj.READY);E(this,"elementDataValues")}initProcessParams(t){console.log(t)}async startWalkBorder(t,i){console.log(t,i)}updateWalkBorderGcode(t){console.log(t)}autoFocus(t){console.log(t)}emitProcessingStateChange(t){if(t!==this.processingState){const i=this.processingState;this.processingState=t,this.emit(this.PROCESSING_STATE_CHANGE,{state:t,beforeState:i})}}}class ome{constructor(){E(this,"uiRef")}get ui(){return{}}get uiApp(){return{}}get projectData(){var e;return(e=this.uiRef)==null?void 0:e.value.getProjectData()}set projectData(e){var t;(t=this.uiRef)==null||t.value.setProjectData(e)}getProcessingData(e){var t;return(t=this.projectData)==null?void 0:t.data.get(e)}toCopyDisplay(e){var o;const{displayJSONs:t,sourceCanvasId:i,targetCanvasId:r}=e,s=t.map(a=>({source:{canvasId:i,displayId:a.sourceId},target:[{canvasId:r,displayId:a.id}]}));(o=this.uiRef)==null||o.value.copyDisplaysData(s)}setLastExtDisplaysData(e){var t;(t=this.uiRef)==null||t.value.setLastExtDisplaysData(e)}}const Ob=.0099,ame=(n,e)=>{const{left:t,top:i,width:r,height:s}=n,{x:o,y:a,width:l,height:c}=e,u=t+r,h=i+s,d=o===-1/0?l:o+l,f=a===-1/0?c:a+c;return t>o-Ob&&i>a-Ob&&u<d+Ob&&h<f+Ob},lme=(n,e)=>{let t=!0,i="";for(const r of e){const s=n[r];if(cr(s)||gi(s)||isNaN(s)){t=!1,i=r;break}}return{result:t,shortKey:i}};class cme{constructor(e,t){E(this,"checkRules");E(this,"connectType");this.checkRules=e;const{connectType:i="WIFI"}=t||{};this.connectType=i}check(e,t){if(e.elementCount.total===0)return{type:zO.text,text:"device.process.no_elements"};const{params:{processMode:r},extSecondaryType:s}=e,{elementCountRules:o,collisionRules:a,integrityDataRules:l,addonStatusRules:c}=mt(this.checkRules)?this.checkRules(s)[r]:this.checkRules[r],u=o?this.checkElementCount(e,o):null;if(u)return u;const h=a?this.checkCollision(e,t,a):null;if(h)return h;const d=l?this.checkDataIntegrity(e,l):null;if(d)return d;const f=c&&!e.isExportGcode?this.checkAddonStatus(e,c):null;return f||null}checkElementCount(e,t){console.log(["check element count =>",e,t]);const{checkFunctionList:i,handler:r}=t,{elementCount:s}=e;let o=null;for(const a of i){const{func:l,args:c,info:u}=a,h=l(s[c]);console.log(["tempResult =>",h,s[c]]),h||(o=r(u),console.log(o))}return o}checkCollision(e,t,i){const{checkSizeType:r,ignoredDirection:s,handler:o}=i,{width:a,height:l,startX:c=0,startY:u=0,endX:h,endY:d}=t,f={x:da(s,Pf.LEFT)?-1/0:c,y:da(s,Pf.TOP)?-1/0:u,width:da(s,Pf.RIGHT)?1/0:(h??a)-c,height:da(s,Pf.BOTTOM)?1/0:(d??l)-u};return ame(e[r],f)?null:o(e.params)}checkDataIntegrity(e,t){const{params:i}=e,{requireKeys:r,handler:s}=t,{result:o,shortKey:a}=lme(i,r);return console.log(["check data integrity =>",e,t,o]),o?null:s(a,i)}checkAddonStatus(e,t){const{addonCheckLists:i,rules:r}=t,{isWalkBorder:s}=e.params;let o=null;if(i.length>0)for(const a of i){const{checkKey:l,correctStatus:c,wrongStatus:u,handler:h,func:d,exemption:f=[],ignoreConnectType:p=[]}=r[a];if(p.includes(this.connectType))continue;if(s&&da(f,"walkBorder"))break;let g=null;if(console.log(["data.addonStatus",e.addonStatus]),d&&mt(d)?g=d(e.addonStatus,e.connected):g=e.addonStatus?e.addonStatus[l]:null,!cr(g)&&(c&&g!==c||g===u)){o=h();break}}return o}checkCurveGeneration(){}}const ume='# date=${time}\n# version=${version}\n# gc={"size":{"w":${size.w},"h":${size.h}}}\n# gc={"offset":{"x":${offset.x},"y":${offset.y}}}\n# gc={"start":{"x":${start.x},"y":${start.y}}}\n# gc=${gc}\n# gc={"renderSize":{"x":${printSize.x},"y":${printSize.y},"w":${printSize.width},"h":${printSize.height}}}\n# timeConfig=${timeConfig}\nG90\nG0 F3000\n',hme=["dpi","density","bitmapMode","powerMinMaxRange"],dme=["enableBreakPoint","planningMode"],fme=["power","speed","dotDuration","powerMinMaxRange","x","y"],AQ={dpi(n){n.dpi=n.dpi??n.density*2.54},density(n){n.density=n.density??n.dpi/2.54},bitmapMode(n){n.bitmapMode=n.bitmapMode??""},powerMinMaxRange(n){n.powerMinMaxRange=n.powerMinMaxRange??[0,n.power]},enableBreakPoint(n){n.enableBreakPoint=n.enableBreakPoint??!1},planningMode(n){n.planningMode=n.planningMode??"Default"}},pme={power(n){n.power=n.power*10},speed(n){n.speed=n.speed*60},dotDuration(n){n.dotDuration=n.dotDuration/10},powerMinMaxRange(n){let{powerMinMaxRange:e}=n;e=Wv.sortBy(e),n.powerMinMaxRange=[e[0]*10,e[1]*10]},x(n){n.x=Math.round(n.x*1e3)/1e3},y(n){n.y=Math.round(n.y*1e3)/1e3}},cc=(n,e)=>{const t=n*e/10,i=t%1>.1?Math.ceil(t):Math.floor(t);return i<1?1:i},cF=n=>`<path fill="none" stroke="#000" stroke-width="1" d="${n}" />`,uF=(n,e)=>`<path fill="#000" stroke="none" fill-rule="${e}" d="${n}"></path>`,Lb=(n,e,t,i)=>{const[,,r,s]=n;return`<svg xmlns="http://www.w3.org/2000/svg"  viewBox="${n.join(" ")}" width="${t??r}" height="${i??s}" id='fill-svg'>
${e}
</svg>`},gme=n=>{fme.forEach(e=>{!!n[e]&&pme[e](n)})},mme=n=>{hme.forEach(e=>{!!!n[e]&&AQ[e](n)})},vme=n=>{dme.forEach(e=>{!!!n[e]&&AQ[e](n)})},bQ="curve/surface.txt";class _me{constructor(){E(this,"head","");E(this,"tail","");E(this,"params",{processMode:"LASER_PLANE",start:{x:0,y:0,z:0},size:{w:0,h:0},offset:{x:0,y:0},rotate:!1,accel:2e3,maxPower:1e3,overScan:!1,version:"unknow",delta:.1,neg_sign:0,swap_xy:0,enableRelative:!1,surfacePath:`${Js}/${bQ}`});E(this,"elements",[]);E(this,"svgBody",[])}addElement(e){this.elements.push(e)}addFillSvg(e,t){this.svgBody.push({[t]:e})}updateElementData(e,t,i=!0){const r=t?{...yme,...e}:{...Ame,...e};i&&gme(r),this.elements.push(r)}clearElementData(){this.elements=[]}filterElementData(e){this.elements=Wv.filter(this.elements,t=>!e.includes(t.id))}updateGCodeHead(e){this.head=e}prefixGCodeHead(e){const t=e.concat(this.head);this.head=t}updateGcodeTail(e){this.tail=e}updateProcessParams(e){this.params=Object.assign(this.params,e)}toJSON(){return{head:this.head,tail:this.tail,params:this.params,elements:this.elements}}}const yme={powerMinMaxRange:[0,100],bitmapEngraveMode:jO.NORMAL,dotDuration:0,processDirection:{direct:Aj.LEFT_TO_RIGHT,angle:0},bitmapMode:"",overDist:0,type:WO.BITMAP,bitmapScanMode:bj.Z_MODE,backlashValue:0},Ame={planningMode:"Default",tab_type:wj.NONE,type:WO.VECTOR};var sL=(n=>(n.Grayscale="grayscale",n.Bayer="Bayer",n.Stucki="Stucki",n.Atkinson="Atkinson",n.Jarvis="Jarvis",n.Sierra="Sierra",n.Floyd="Floyd",n))(sL||{});function bme(n){return function(...e){var t=e.pop();return n.call(this,e,t)}}var wme=typeof queueMicrotask=="function"&&queueMicrotask,wQ=typeof setImmediate=="function"&&setImmediate,xQ=typeof process=="object"&&typeof process.nextTick=="function";function xme(n){setTimeout(n,0)}function Cme(n){return(e,...t)=>n(()=>e(...t))}var sy;wme?sy=queueMicrotask:wQ?sy=setImmediate:xQ?sy=process.nextTick:sy=xme;var my=Cme(sy);function Eme(n){return oL(n)?function(...e){const t=e.pop(),i=n.apply(this,e);return hF(i,t)}:bme(function(e,t){var i;try{i=n.apply(this,e)}catch(r){return t(r)}if(i&&typeof i.then=="function")return hF(i,t);t(null,i)})}function hF(n,e){return n.then(t=>{dF(e,null,t)},t=>{dF(e,t&&(t instanceof Error||t.message)?t:new Error(t))})}function dF(n,e,t){try{n(e,t)}catch(i){my(r=>{throw r},i)}}function oL(n){return n[Symbol.toStringTag]==="AsyncFunction"}function Tme(n){return n[Symbol.toStringTag]==="AsyncGenerator"}function Ime(n){return typeof n[Symbol.asyncIterator]=="function"}function er(n){if(typeof n!="function")throw new Error("expected a function");return oL(n)?Eme(n):n}function Rn(n,e){if(e||(e=n.length),!e)throw new Error("arity is undefined");function t(...i){return typeof i[e-1]=="function"?n.apply(this,i):new Promise((r,s)=>{i[e-1]=(o,...a)=>{if(o)return s(o);r(a.length>1?a:a[0])},n.apply(this,i)})}return t}function aL(n,e,t,i){e=e||[];var r=[],s=0,o=er(t);return n(e,(a,l,c)=>{var u=s++;o(a,(h,d)=>{r[u]=d,c(h)})},a=>{i(a,r)})}function WT(n){return n&&typeof n.length=="number"&&n.length>=0&&n.length%1===0}const Sme={};var jT=Sme;function n_(n){function e(...t){if(n!==null){var i=n;n=null,i.apply(this,t)}}return Object.assign(e,n),e}function Pme(n){return n[Symbol.iterator]&&n[Symbol.iterator]()}function Mme(n){var e=-1,t=n.length;return function(){return++e<t?{value:n[e],key:e}:null}}function Rme(n){var e=-1;return function(){var i=n.next();return i.done?null:(e++,{value:i.value,key:e})}}function Dme(n){var e=n?Object.keys(n):[],t=-1,i=e.length;return function r(){var s=e[++t];return s==="__proto__"?r():t<i?{value:n[s],key:s}:null}}function kme(n){if(WT(n))return Mme(n);var e=Pme(n);return e?Rme(e):Dme(n)}function cg(n){return function(...e){if(n===null)throw new Error("Callback was already called.");var t=n;n=null,t.apply(this,e)}}function fF(n,e,t,i){let r=!1,s=!1,o=!1,a=0,l=0;function c(){a>=e||o||r||(o=!0,n.next().then(({value:d,done:f})=>{if(!(s||r)){if(o=!1,f){r=!0,a<=0&&i(null);return}a++,t(d,l,u),l++,c()}}).catch(h))}function u(d,f){if(a-=1,!s){if(d)return h(d);if(d===!1){r=!0,s=!0;return}if(f===jT||r&&a<=0)return r=!0,i(null);c()}}function h(d){s||(o=!1,r=!0,i(d))}c()}var jc=n=>(e,t,i)=>{if(i=n_(i),n<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return i(null);if(Tme(e))return fF(e,n,t,i);if(Ime(e))return fF(e[Symbol.asyncIterator](),n,t,i);var r=kme(e),s=!1,o=!1,a=0,l=!1;function c(h,d){if(!o)if(a-=1,h)s=!0,i(h);else if(h===!1)s=!0,o=!0;else{if(d===jT||s&&a<=0)return s=!0,i(null);l||u()}}function u(){for(l=!0;a<n&&!s;){var h=r();if(h===null){s=!0,a<=0&&i(null);return}a+=1,t(h.value,h.key,cg(c))}l=!1}u()};function Ome(n,e,t,i){return jc(e)(n,er(t),i)}var lL=Rn(Ome,4);function Lme(n,e,t){t=n_(t);var i=0,r=0,{length:s}=n,o=!1;s===0&&t(null);function a(l,c){l===!1&&(o=!0),o!==!0&&(l?t(l):(++r===s||c===jT)&&t(null))}for(;i<s;i++)e(n[i],i,cg(a))}function Nme(n,e,t){return lL(n,1/0,e,t)}function Bme(n,e,t){var i=WT(n)?Lme:Nme;return i(n,er(e),t)}var ug=Rn(Bme,3);function Fme(n,e,t){return aL(ug,n,e,t)}var Ume=Rn(Fme,3);function Gme(n,e,t){return lL(n,1,e,t)}var i_=Rn(Gme,3);function Hme(n,e,t){return aL(i_,n,e,t)}Rn(Hme,3);class Vme{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}insertBefore(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):pF(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):pF(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var t=this.head;t;){var{next:i}=t;e(t)&&this.removeLink(t),t=i}return this}}function pF(n,e){n.length=1,n.head=n.tail=e}function zme(n,e,t){if(e==null)e=1;else if(e===0)throw new RangeError("Concurrency must not be zero");var i=er(n),r=0,s=[];const o={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function a(_,y){o[_].push(y)}function l(_,y){const A=(...w)=>{c(_,A),y(...w)};o[_].push(A)}function c(_,y){if(!_)return Object.keys(o).forEach(A=>o[A]=[]);if(!y)return o[_]=[];o[_]=o[_].filter(A=>A!==y)}function u(_,...y){o[_].forEach(A=>A(...y))}var h=!1;function d(_,y,A,w){if(w!=null&&typeof w!="function")throw new Error("task callback must be a function");v.started=!0;var b,C;function I(T,...O){if(T)return A?C(T):b();if(O.length<=1)return b(O[0]);b(O)}var x=v._createTaskItem(_,A?I:w||I);if(y?v._tasks.unshift(x):v._tasks.push(x),h||(h=!0,my(()=>{h=!1,v.process()})),A||!w)return new Promise((T,O)=>{b=T,C=O})}function f(_){return function(y,...A){r-=1;for(var w=0,b=_.length;w<b;w++){var C=_[w],I=s.indexOf(C);I===0?s.shift():I>0&&s.splice(I,1),C.callback(y,...A),y!=null&&u("error",y,C.data)}r<=v.concurrency-v.buffer&&u("unsaturated"),v.idle()&&u("drain"),v.process()}}function p(_){return _.length===0&&v.idle()?(my(()=>u("drain")),!0):!1}const g=_=>y=>{if(!y)return new Promise((A,w)=>{l(_,(b,C)=>{if(b)return w(b);A(C)})});c(_),a(_,y)};var m=!1,v={_tasks:new Vme,_createTaskItem(_,y){return{data:_,callback:y}},*[Symbol.iterator](){yield*v._tasks[Symbol.iterator]()},concurrency:e,payload:t,buffer:e/4,started:!1,paused:!1,push(_,y){return Array.isArray(_)?p(_)?void 0:_.map(A=>d(A,!1,!1,y)):d(_,!1,!1,y)},pushAsync(_,y){return Array.isArray(_)?p(_)?void 0:_.map(A=>d(A,!1,!0,y)):d(_,!1,!0,y)},kill(){c(),v._tasks.empty()},unshift(_,y){return Array.isArray(_)?p(_)?void 0:_.map(A=>d(A,!0,!1,y)):d(_,!0,!1,y)},unshiftAsync(_,y){return Array.isArray(_)?p(_)?void 0:_.map(A=>d(A,!0,!0,y)):d(_,!0,!0,y)},remove(_){v._tasks.remove(_)},process(){if(!m){for(m=!0;!v.paused&&r<v.concurrency&&v._tasks.length;){var _=[],y=[],A=v._tasks.length;v.payload&&(A=Math.min(A,v.payload));for(var w=0;w<A;w++){var b=v._tasks.shift();_.push(b),s.push(b),y.push(b.data)}r+=1,v._tasks.length===0&&u("empty"),r===v.concurrency&&u("saturated");var C=cg(f(_));i(y,C)}m=!1}},length(){return v._tasks.length},running(){return r},workersList(){return s},idle(){return v._tasks.length+r===0},pause(){v.paused=!0},resume(){v.paused!==!1&&(v.paused=!1,my(v.process))}};return Object.defineProperties(v,{saturated:{writable:!1,value:g("saturated")},unsaturated:{writable:!1,value:g("unsaturated")},empty:{writable:!1,value:g("empty")},drain:{writable:!1,value:g("drain")},error:{writable:!1,value:g("error")}}),v}function $me(n,e,t,i){i=n_(i);var r=er(t);return i_(n,(s,o,a)=>{r(e,s,(l,c)=>{e=c,a(l)})},s=>i(s,e))}Rn($me,4);function Wme(n,e,t,i){return aL(jc(e),n,t,i)}var CQ=Rn(Wme,4);function jme(n,e,t,i){var r=er(t);return CQ(n,e,(s,o)=>{r(s,(a,...l)=>a?o(a):o(a,l))},(s,o)=>{for(var a=[],l=0;l<o.length;l++)o[l]&&(a=a.concat(...o[l]));return i(s,a)})}var EQ=Rn(jme,4);function Qme(n,e,t){return EQ(n,1/0,e,t)}Rn(Qme,3);function Xme(n,e,t){return EQ(n,1,e,t)}Rn(Xme,3);function gh(n,e){return(t,i,r,s)=>{var o=!1,a;const l=er(r);t(i,(c,u,h)=>{l(c,(d,f)=>{if(d||d===!1)return h(d);if(n(f)&&!a)return o=!0,a=e(!0,c),h(null,jT);h()})},c=>{if(c)return s(c);s(null,o?a:e(!1))})}}function Yme(n,e,t){return gh(i=>i,(i,r)=>r)(ug,n,e,t)}Rn(Yme,3);function qme(n,e,t,i){return gh(r=>r,(r,s)=>s)(jc(e),n,t,i)}Rn(qme,4);function Kme(n,e,t){return gh(i=>i,(i,r)=>r)(jc(1),n,e,t)}Rn(Kme,3);function Jme(n,e,t){t=cg(t);var i=er(n),r=er(e),s;function o(l,...c){if(l)return t(l);l!==!1&&(s=c,r(...c,a))}function a(l,c){if(l)return t(l);if(l!==!1){if(!c)return t(null,...s);i(o)}}return a(null,!0)}Rn(Jme,3);function TQ(n){return(e,t,i)=>n(e,i)}function Zme(n,e,t){return ug(n,TQ(er(e)),t)}Rn(Zme,3);function eve(n,e,t,i){return jc(e)(n,TQ(er(t)),i)}var tve=Rn(eve,4);function nve(n,e,t){return tve(n,1,e,t)}var ive=Rn(nve,3);function rve(n){return oL(n)?n:function(...e){var t=e.pop(),i=!0;e.push((...r)=>{i?my(()=>t(...r)):t(...r)}),n.apply(this,e),i=!1}}function sve(n,e,t){return gh(i=>!i,i=>!i)(ug,n,e,t)}Rn(sve,3);function ove(n,e,t,i){return gh(r=>!r,r=>!r)(jc(e),n,t,i)}Rn(ove,4);function ave(n,e,t){return gh(i=>!i,i=>!i)(i_,n,e,t)}Rn(ave,3);function lve(n,e,t,i){var r=new Array(e.length);n(e,(s,o,a)=>{t(s,(l,c)=>{r[o]=!!c,a(l)})},s=>{if(s)return i(s);for(var o=[],a=0;a<e.length;a++)r[a]&&o.push(e[a]);i(null,o)})}function cve(n,e,t,i){var r=[];n(e,(s,o,a)=>{t(s,(l,c)=>{if(l)return a(l);c&&r.push({index:o,value:s}),a(l)})},s=>{if(s)return i(s);i(null,r.sort((o,a)=>o.index-a.index).map(o=>o.value))})}function QT(n,e,t,i){var r=WT(e)?lve:cve;return r(n,e,er(t),i)}function uve(n,e,t){return QT(ug,n,e,t)}Rn(uve,3);function hve(n,e,t,i){return QT(jc(e),n,t,i)}Rn(hve,4);function dve(n,e,t){return QT(i_,n,e,t)}Rn(dve,3);function fve(n,e){var t=cg(e),i=er(rve(n));function r(s){if(s)return t(s);s!==!1&&i(r)}return r()}Rn(fve,2);function pve(n,e,t,i){var r=er(t);return CQ(n,e,(s,o)=>{r(s,(a,l)=>a?o(a):o(a,{key:l,val:s}))},(s,o)=>{for(var a={},{hasOwnProperty:l}=Object.prototype,c=0;c<o.length;c++)if(o[c]){var{key:u}=o[c],{val:h}=o[c];l.call(a,u)?a[u].push(h):a[u]=[h]}return i(s,a)})}Rn(pve,4);function gve(n,e,t,i){i=n_(i);var r={},s=er(t);return jc(e)(n,(o,a,l)=>{s(o,a,(c,u)=>{if(c)return l(c);r[a]=u,l(c)})},o=>i(o,r))}Rn(gve,4);xQ?process.nextTick:wQ&&setImmediate;Rn((n,e,t)=>{var i=WT(e)?[]:{};n(e,(r,s,o)=>{er(r)((a,...l)=>{l.length<2&&([l]=l),i[s]=l,o(a)})},r=>t(r,i))},3);function mve(n,e){var t=er(n);return zme((i,r)=>{t(i[0],r)},e,1)}function vve(n,e){if(e=n_(e),!Array.isArray(n))return e(new TypeError("First argument to race must be an array of functions"));if(!n.length)return e();for(var t=0,i=n.length;t<i;t++)er(n[t])(e)}Rn(vve,2);function cL(n,e,t,i){const r=er(t);return QT(n,e,(s,o)=>{r(s,(a,l)=>{o(a,!l)})},i)}function _ve(n,e,t){return cL(ug,n,e,t)}Rn(_ve,3);function yve(n,e,t,i){return cL(jc(e),n,t,i)}Rn(yve,4);function Ave(n,e,t){return cL(i_,n,e,t)}Rn(Ave,3);function bve(n,e,t){return gh(Boolean,i=>i)(ug,n,e,t)}Rn(bve,3);function wve(n,e,t,i){return gh(Boolean,r=>r)(jc(e),n,t,i)}Rn(wve,4);function xve(n,e,t){return gh(Boolean,i=>i)(i_,n,e,t)}Rn(xve,3);function Cve(n,e,t){var i=er(e);return Ume(n,(s,o)=>{i(s,(a,l)=>{if(a)return o(a);o(a,{value:s,criteria:l})})},(s,o)=>{if(s)return t(s);t(null,o.sort(r).map(a=>a.value))});function r(s,o){var a=s.criteria,l=o.criteria;return a<l?-1:a>l?1:0}}Rn(Cve,3);function Eve(n,e){var t=null,i;return ive(n,(r,s)=>{er(r)((o,...a)=>{if(o===!1)return s(o);a.length<2?[i]=a:i=a,t=o,s(o?null:{})})},()=>e(t,i))}Rn(Eve);function Tve(n,e,t){t=cg(t);var i=er(e),r=er(n),s=[];function o(l,...c){if(l)return t(l);s=c,l!==!1&&r(a)}function a(l,c){if(l)return t(l);if(l!==!1){if(!c)return t(null,...s);i(o)}}return r(a)}Rn(Tve,3);function Ive(n,e){if(e=n_(e),!Array.isArray(n))return e(new Error("First argument to waterfall must be an array of functions"));if(!n.length)return e();var t=0;function i(s){var o=er(n[t++]);o(...s,cg(r))}function r(s,...o){if(s!==!1){if(s||t===n.length)return e(s,...o);i(o)}}i([])}Rn(Ive);function Sve(n){return new Worker(""+new URL("../assets/bitmapResizeWorker-TFP9rfqF.js",import.meta.url).href,{name:n==null?void 0:n.name})}class Pve extends t_{constructor(){super(Sve)}resize(e){return this.request({type:"resize",data:e})}imageProcess(e){return this.request({type:"imageProcess",data:e})}}function Mve(n){const e=uC(n,o=>tn(o)),t=(wt(n)?[]:n).join("");let i=0,r=0;const s=t.length;for(;r<s;){const o=t.charCodeAt(r).toString(2);i+=parseInt(o,2),r++}return i+=nhe(e),i}function gF(n,e){const{top:t,left:i,bottom:r,right:s}=n,[o,a,l,c]=e;return{top:Math.min(a,t),left:Math.min(o,i),bottom:Math.max(c,r),right:Math.max(l,s)}}const Rve=["bitmapScanMode","speed","repeat","processingLightSource","processIgnore","bitmapMode","processingType","powerMinMaxRange","power","frequency"],Dve=n=>{const{bitmapEngraveMode:e}=n,t=[...Rve];return e===jO.DOT?(t.push("dotDuration"),t.push("dpi")):t.push("density"),t},uL=new Map;uL.set("blue",20);uL.set("red",10);const mh=new Map;mh.set(cn.VECTOR_CUTTING,2);mh.set(cn.VECTOR_ENGRAVING,1);mh.set(cn.FILL_VECTOR_ENGRAVING,1);mh.set(cn.BITMAP_ENGRAVING,1);mh.set(cn.KNIFE_CUTTING,1);mh.set(cn.BRUSH_PAINTING_LINE,1);mh.set(cn.BRUSH_PAINTING_BLOCK,1);mh.set(cn.RELIEF,1);var $m,Wm,n0,Xh,zf,jm,Qm,i0,$f,r0,s0;class kve{constructor(){E(this,"source",new _me);E(this,"stopFlag",!1);ke(this,$m,async()=>{throw new Error("storageImage is no set.")});ke(this,Wm,100);ke(this,n0,[]);ke(this,Xh,{top:1/0,left:1/0,bottom:-1/0,right:-1/0});ke(this,zf,{top:1/0,left:1/0,bottom:-1/0,right:-1/0});ke(this,jm,0);ke(this,Qm,0);ke(this,i0,{});E(this,"processingParams",[]);E(this,"activeElementIds",[]);ke(this,$f,void 0);E(this,"isWalkBorder",!1);ke(this,r0,{});ke(this,s0,async()=>{throw new Error("getDisplayData is no set.")})}get folder(){return Nr.tempTask.originalData}get folderPath(){return Nr.tempTask.originalDataPath}get layerOrder(){return S(this,n0)}set layerOrder(e){Qe(this,n0,e)}get maxDensity(){return S(this,Wm)}set maxDensity(e){Qe(this,Wm,Math.max(e,S(this,Wm)))}set bitmapBounds(e){Qe(this,zf,gF(S(this,zf),e))}get boundingRect(){const{top:e,left:t,bottom:i,right:r}=S(this,Xh);return{...S(this,Xh),width:r-t,height:i-e}}get bitmapBoundingRect(){const{top:e,left:t,bottom:i,right:r}=S(this,zf);return{...S(this,zf),width:r-t,height:i-e}}set bounds(e){Qe(this,Xh,gF(S(this,Xh),e))}get storageImage(){return S(this,$m)}set storageImage(e){e&&Qe(this,$m,e)}get bitmapCount(){return S(this,jm)}get vectorCount(){return S(this,Qm)}get elementsTotal(){return S(this,jm)+S(this,Qm)}get processMode(){return this.source.params.processMode}set processingModeData(e){Qe(this,i0,Object.assign(e))}get processingModeData(){return S(this,i0)}get imgProcessQ(){return!S(this,$f)&&!this.stopFlag&&(Qe(this,$f,mve(async e=>{await e()},2)),S(this,$f).pause()),S(this,$f)}set elementsData(e){Qe(this,r0,e)}get elementsData(){return S(this,r0)}addImgProcessTask(e){this.imgProcessQ&&this.imgProcessQ.pushAsync(()=>this.stopFlag?(this.imgProcessQ.kill(),Promise.resolve("interrupt")):e())}get getDisplayData(){return S(this,s0)}set getDisplayData(e){Qe(this,s0,e)}parseDisplayConfig(e){if(wt(e))throw new Error("display config is empty.");const{processIgnore:t,processingType:i,data:r}=e,{materialType:s,parameter:o}=r[i];return{processIgnore:t,processingType:i,...o[s]??o.customize}}vectorPrepare(e){if(this.isWalkBorder)return;const{processingType:t}=e;t===cn.VECTOR_CUTTING&&(e.planningMode="InsideFirst"),e.filename=`${e.id}.svg`;const i=[e.x,e.y,e.width,e.height],r=Lb(i,e.path);Reflect.deleteProperty(e,"path"),vme(e),this.source.updateElementData(e),this.addImgProcessTask(()=>this.storageImage(`${this.folderPath}/${e.filename}`,r))}async bitmapPrepare(e){if(this.isWalkBorder)return;e.filename=`${e.id}.png`;const{processingMode:t}=this.processingModeData;t===zt.CURVE_PROCESS&&(e.bitmapMode=sL.Grayscale);const{extraPath:i,imgData:r,oWidth:s,oHeight:o,width:a,height:l,bitmapMode:c,dpi:u,dpiY:h}=e,d=e.density??u/2.54,f=e.densityY??e.density??(h??u)/2.54;e.dpi=[d*2.54,f*2.54];const p=`${this.folderPath}/${e.filename}`;if(e.cWidth=e.width,e.cHeight=e.height,r&&pi(r))e.width=cc(a,d),e.height=cc(l,f),this.source.addFillSvg(r,e.id);else{const m=cc(a,d),v=cc(l,f??d),_={bitmapMode:c,source:r,extraPath:i,width:a,height:l,destWidth:m,destHeight:v,oWidth:s,oHeight:o,keepAlpha:e==null?void 0:e.keepAlpha};if(i&&i.length>4){const A=await new QLe().resize(_);await this.storageImage(p,A,"copy")}else{const y=new Pve,A=await y.imageProcess(_);this.addImgProcessTask(async()=>this.storageImage(p,A.data,{width:m,height:v}).finally(()=>{y.destroy()}))}e.width=m,e.height=v}e.density=d,mme(e),Reflect.deleteProperty(e,"imgData"),Reflect.deleteProperty(e,"oWidth"),Reflect.deleteProperty(e,"oHeight"),this.source.updateElementData(e,!0);const g=u?u/2.54:d;return this.maxDensity=g,e}makeGroupKey(e){return Mve(e)}prepareDataForDisplay(e,t,i){var s;const r=[];for(const[o,a]of e)if(a){let l=this.parseDisplayConfig(a);if(i){const d=(s=Bo(t,["id",o]))==null?void 0:s.layerTag;l={...l,layerTag:d}}const c=Object.values({...l}).join("/"),u=this.calculateMergeIdKey(l),h={...l,id:o,gk:c,mergeIdKey:u,keepAlpha:a==null?void 0:a.keepAlpha};r.push(h)}return r}calculateMergeIdKey(e){const{processingType:t}=e;if(da([cn.VECTOR_ENGRAVING,cn.VECTOR_CUTTING],t))return null;const i=[];return Dve(e).forEach(s=>{e.hasOwnProperty(s)&&i.push(e[s])}),i.join("/")}async parseBitmapData(e){const{elementConfig:t,processingParams:i={}}=e;for(let r=0;r<t.length&&!this.stopFlag;r++){const{id:s,x:o,y:a,width:l,height:c,oWidth:u,oHeight:h,imgData:d,extraPath:f}=t[r];this.bounds=[o,a,o+l,a+c],await this.bitmapPrepare(Object.assign(i,{id:s,imgData:d,extraPath:f,x:o,y:a,width:l,height:c,oWidth:u,oHeight:h}))}}calculateCurrentGk(e,t){const{processingType:i,gk:r,id:s}=e.processingParams;return da([cn.VECTOR_ENGRAVING,cn.VECTOR_CUTTING,cn.KNIFE_CUTTING],i)||t&&da([cn.FILL_VECTOR_ENGRAVING,cn.BITMAP_ENGRAVING],i)?r:s}generateMergeId(e){const t=Fr(e,"mergeIdKey");Object.keys(t).forEach(i=>{if(i==="-1")return;const r=t[i],s=Math.round(Math.random()*1e4);r.forEach(o=>{const{processingParams:a}=o;a.merge_id=s})})}processingDataGroup(e,t,i){this.generateMergeId(e);const r={},s=e.length,o=i===Zs.AUTO?!1:t===Dc.GROUP;for(let a=0;a<s;a++){const{elementConfig:l,processingParams:c}=e[a],u=this.calculateCurrentGk(e[a],o);r.hasOwnProperty(u)||(r[u]={processingParams:c,elementConfig:[],index:a}),r[u].elementConfig.push(l)}return r}async parseVectorData(e,t=!0){const{processingParams:i,elementConfig:r}=e;let s=1/0,o=1/0,a=-1/0,l=-1/0;const c=[],u=r.length;for(let f=0;f<u&&!this.stopFlag;f++){const p=r[f],{x:g,y:m,width:v,height:_,path:y,dPath:A}=p;s=Math.min(s,g),o=Math.min(o,m),a=Math.max(a,g+v),l=Math.max(l,m+_),c.push(t?uF(y??A,p.fillRule??"nonzero"):cF(y??A))}const h=a-s,d=l-o;if(this.bounds=[s,o,s+h,o+d],t){const{density:f}=i,p=cc(h,f),g=cc(d,f),m=Lb([s,o,h,d],c.join(`
`),p,g);await this.bitmapPrepare(Object.assign({imgData:m,x:s,y:o,width:h,height:d},i))}else this.vectorPrepare(Object.assign({path:c.join(""),x:s,y:o,width:h,height:d,oWidth:h,oHeight:d},i))}groupByLayer(e,t){e.forEach(i=>{const r=i.elementConfig[0].layerTag,s=t?pd(this.layerOrder,o=>o===r):0;i.processingParams.layer_id=s+1})}calElePriority(e){e.forEach(t=>{const{processingLightSource:i="blue",processingType:r}=t.processingParams,s=Number(uL.get(i)+mh.get(r));t.processingParams.priority_id=s})}groupByRules({data:e,isGroupByLayer:t}){return this.groupByLayer(e,t),this.calElePriority(e),e}mergeBySameParams(e,t,i,r){const s=[];for(let l=0;l<t.length;l++){const c=t[l],u=Bo(e,["id",c.id]);if(u&&u.processIgnore)continue;this.activeElementIds.push(c.id);const h={gk:u.gk?u.gk:u.id,mergeIdKey:u.mergeIdKey?u.mergeIdKey:-1,elementConfig:c,processingParams:u};s.push(h)}const o=this.processingDataGroup(s,i,r),a=Object.values(o);return Wa(a,["index"])}checkIsByLayer(e,t,i){let r=!1;switch(e){case Zs.CUSTOM:r=i;break;case Zs.AUTO:r=!1;break;default:r=t===Yu.LAYER}return r}async mergeAndGroupData(e,t){const{processPath:i,pathPlanning:r,isProcessByLayer:s,fillPlanning:o}=this.processingModeData,a=this.checkIsByLayer(r,i,s);let l=[];const c=this.prepareDataForDisplay(t,e,a),u=this.mergeBySameParams(c,e,o,r);return l=this.groupByRules({data:u,isGroupByLayer:a}),l}getImageComposite(e,t){let i=Dc.SEPARATE;switch(e){case Zs.AUTO:i=Dc.SMART;break;case Zs.CUSTOM:i=t;break;case Zs.NO_SUPPORT:i=Dc.SEPARATE;break}return i}calculateBounds(e,t){for(let i=0;i<e.elementConfig.length;i++){const{x:r,y:s,width:o,height:a}=e.elementConfig[i];this.bounds=[r,s,r+o,s+a],t&&(this.bitmapBounds=[r,s,r+o,s+a])}}async calculateElementsCheckData(){var e;for(let t=0;t<this.elementsData.length;t++){const{elementConfig:i}=this.elementsData[t];for(let r=0;r<i.length;r++){const{type:s,isFill:o}=i[r];if((e=i[r])!=null&&e.nonCanvas)continue;const a=s.toUpperCase()==="BITMAP",l=!a&&o===!0;let c="";switch(a||l?c="BITMAP":c="VECTOR",c){case"BITMAP":XI(this,jm)._++,await this.calculateBounds(this.elementsData[t],!0);break;case"VECTOR":XI(this,Qm)._++,await this.calculateBounds(this.elementsData[t]);break}}}}async parse(e,t,i,r){wt(this.source.elements)||this.source.clearElementData();const{displays:s,mode:o,data:a}=t;this.layerOrder=hj(i),this.isWalkBorder=r,this.processingModeData={...a[o],processingMode:o},this.elementsData=await this.mergeAndGroupData(e,s),await this.calculateElementsCheckData();const{pathPlanning:l,fillPlanning:c,dreedyTsp:u=!1}=a[o],h=this.getImageComposite(l,c);console.log(h),this.source.updateProcessParams({processMode:o,imageComposite:h,imageCompositeCoefficient:3,imagePlanning:"default",dreedyTsp:u})}async saveImg(){for(let e=0;e<this.elementsData.length&&!this.stopFlag;e++){const{elementConfig:t,processingParams:i}=this.elementsData[e];this.processingParams.push(eb(i,"gk","id"));const{type:r,isFill:s}=t[0],o=r.toUpperCase()==="BITMAP",a=!o&&s===!0;let l="";switch(o?l="BITMAP":a?l=i.importVector?"VECTOR":"BITMAP":l="VECTOR",l){case"BITMAP":a?await this.parseVectorData(this.elementsData[e]):await this.parseBitmapData(this.elementsData[e]);break;case"VECTOR":await this.parseVectorData(this.elementsData[e],!1);break}Reflect.deleteProperty(this.elementsData[e],"processIgnore"),Reflect.deleteProperty(this.elementsData[e],"processingLightSource"),Reflect.deleteProperty(this.elementsData[e],"gk"),Reflect.deleteProperty(this.elementsData[e],"density")}}async createBorderElements(e,t,i){if(i){const[p,g,m,v]=i;this.bounds=[p,g,m,v]}const r=[this.boundingRect.left,this.boundingRect.top,this.boundingRect.width,this.boundingRect.height],{power:s,speed:o,mode:a,density:l=5}=t;this.source.clearElementData();const{left:c,top:u,width:h,height:d}=this.boundingRect,f={x:c,y:u,power:s*10,speed:o*60,layer_id:1,priority_id:1,repeat:1};if(a===$O.SCAN){const p=`${this.folderPath}/border.png`,g=`${this.folderPath}/border.svg`,m="border.png",v=cc(h,l),_=cc(d,l),y=Lb(r,uF(e,"evenodd"),v,_);await Ri.writeData(g,y),this.source.updateProcessParams({imagePlanning:"default"}),await ca.svgToImage({svgFilename:g,imgW:cc(Number(this.boundingRect.right-this.boundingRect.left),l),imgH:cc(Number(this.boundingRect.bottom-this.boundingRect.top),l),pngFilename:p}),this.source.updateElementData({...f,width:v,height:_,filename:m,dpi:[l*2.54,l*2.54],type:"bitmap",merge_id:-1},!0,!1)}else{const p=Lb(r,cF(e)),g="border.svg";this.source.updateElementData({...f,filename:g,planningMode:"Default",type:"Vector",overDist:0,processingLightSource:"blue",tab_type:"None",repeat:1},!1,!1),await S(this,$m).call(this,`${this.folderPath}/${g}`,p)}}async finishImgSave(){this.imgProcessQ.resume(),await this.imgProcessQ.drain(),console.log("finish image save")}async setup(e,t){await this.backupLastTaskData();const i=`${e??this.folderPath}/svg-body.json`;return this.addImgProcessTask(async()=>this.storageImage(i,JSON.stringify(this.source.svgBody,null,"  "))),this.addImgProcessTask(async()=>{const s=`${e??this.folderPath}/${t??"manifest.json"}`;return this.storageImage(s,JSON.stringify(this.toJSON(),null,"  "))}),this.imgProcessQ.resume(),await this.imgProcessQ.drain(),await ca.svgJsonToPng({svgJsonPath:i,pngDir:`${e??this.folderPath}/`})}async backupLastTaskData(){}toJSON(){return this.source.toJSON()}resetBounds(e){Qe(this,Xh,{top:1/0,left:1/0,bottom:-1/0,right:-1/0}),e&&(this.bounds=e)}}$m=new WeakMap,Wm=new WeakMap,n0=new WeakMap,Xh=new WeakMap,zf=new WeakMap,jm=new WeakMap,Qm=new WeakMap,i0=new WeakMap,$f=new WeakMap,r0=new WeakMap,s0=new WeakMap;var Ove={VITE_APP:"true",VITE_PHONE:"true",VITE_SENSORS_SHOW_LOG:"false",VITE_SENSORS_SERVERURl:"https://dataaccess.mblock.cc/sa?project=xcstest",VITE_SENSORS_ID_KEY:"identity_SN",VITE_CHECK_PACKAGE_API:"https://api.xtool.com/efficacy/v1/package/version/latest",VITE_CHECK_PACKAGES_API:"https://api.xtool.com/efficacy/v1/packages/version/latest",VITE_XTOOL_API:"https://xcs-api.xtool.com",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};class IQ extends uh.EventEmitter{}Hhe(IQ,[tme,nme,ime,sme,rme,ome]);var YW,qW,Wf,OE,o0,Yh;class Lve extends IQ{constructor(t,i){super();E(this,"version","1.0.0");ke(this,Wf,void 0);ke(this,OE,"");E(this,"appContext");ke(this,o0,{totalTime:""});E(this,"supportProcessingProgress",!1);E(this,"ignoreStatusInProcessing",[]);E(this,"hasCancelProcess",!1);ke(this,Yh,new Map);E(this,"isLearning",!1);E(this,"latestDeviceMessageId","");E(this,"hasUploadGcode",!1);E(this,"againProcess",!1);E(this,"againProcessStartPoint");E(this,"createTime");E(this,"builder",{gcode:()=>""});E(this,"processingModes",[]);E(this,"processingTypes",[]);E(this,"v2",!0);E(this,"runningStatus",vj.P_IDLE);E(this,"deviceDataValues",{});E(this,"checker");E(this,"canvasImgUrl","");E(this,"fileHelper",(YW=window.MeApi)==null?void 0:YW.fileHelper);E(this,"uploadGcodeHelper",(qW=window.MeApi)==null?void 0:qW.uploadGcode);E(this,"addonStatus");E(this,"dataSource");E(this,"customData");E(this,"_walkBorderParams",{power:3,speed:160});E(this,"dataParser");E(this,"shouldHandleEvent",[It.START_PROCESS,It.PAUSE_PROCESS,It.CANCEL_PROCESS,It.FINISH_PROCESS,It.DISCONNECT]);this.config=t,this.version=t.version??this.version,this.deviceInfo={cover:t.cover,detailCover:t.detailCover,snCode:"",power:t.power||0,version:""},this.setupLifeCycle(),this.config.checkRules&&(this.checker=new cme(this.config.checkRules,{connectType:this.config.connectType})),this.appContext=i}watch(t,i){if(S(this,Yh).has(t)){const s=S(this,Yh).get(t),o=s==null?void 0:s.addCallBack(i);return()=>{o&&o()}}const r=new Kge(this,t,i);return S(this,Yh).set(t,r),()=>{S(this,Yh).delete(t)}}notifyWatchers(t){const i=S(this,Yh).get(t);i==null||i.check()}get instanceId(){let t=this.id;return this.deviceInfo.snCode&&(t=`${t}:${this.deviceInfo.snCode}`),this.deviceInfo.power&&(t=`${this.id}:${this.deviceInfo.snCode}:${this.deviceInfo.power.toString()}`),t}get processingAreaKey(){return""}get serialportMode(){return this.connectType===ja.SERIAL}get isInProcessing(){const{processingStateMap:t={}}=this.config.process,i=t[this.deviceInfo.currentStatus],r=[It.PAUSE_PROCESS,It.BEFORE_START,It.START_PROCESS,It.DRAIN,It.HEAT_STARTED];return this.connected?r.includes(i)||r.includes(this.deviceInfo.currentStatus):!1}queryProcessingRightSideBarCom(t,i,r){const{rightSideBar:s={}}=this.config.process;return mt(s[t])?s[t](i,r):s[t]}queryProcessingHeaderCom(t){var s,o,a,l,c;const{currentStatus:i}=this.deviceInfo,{inProcessingHeader:r={}}=this.config.process;return t=((a=(o=(s=this.dataParser)==null?void 0:s.source)==null?void 0:o.params)==null?void 0:a.processMode)||t,mt(r[t])||mt(r[i])?((l=r[t])==null?void 0:l.call(r,i))||((c=r[i])==null?void 0:c.call(r,t)):r[i]}queryUploadRightSiderCom(t){const{uploadRightSiderBar:i={}}=this.config.process;return mt(i)?i(t):wt(i)?"":i}get xcsVersion(){return S(this,OE)}isSupportTaskId(){return this.deviceInfo.taskId!==void 0}get supportTaskId(){return this.isSupportTaskId()}getCanvasDataConfig(t){return{}}getProcessingSteps(t,i){return[]}getProcessingTypes(t){const{mode:i,imageType:r}=t;return this.processingTypes.filter(o=>i&&r?o.modes.includes(i)&&o.imageType===r:i?o.modes.includes(i):r?o.imageType===r:!0)}set walkBorderParams({speed:t,power:i,mode:r}){this._walkBorderParams.power=i,this._walkBorderParams.speed=t,r&&(this._walkBorderParams.mode=r)}get walkBorderParams(){return this._walkBorderParams}get walkBorderCheckKey(){return[]}get uploadGcodeCheckKey(){return[]}get restartProcessingCheckKey(){return[]}async deviceChecker(t){return!0}get updater(){if(S(this,Wf))return S(this,Wf);let t="";return t=`${Js}/exts/${GT}`,Qe(this,Wf,new yQ({resId:this.config.extContentId,dest:t})),S(this,Wf)}killGcodeWorker(){return this.dataParser.stopFlag=!0,ca.killGcodeGenerate()}async stopWalkBorder(){await this.apis.stopWalkBorder()}get id(){return this.config.id}get useSocket(){return this.config.canUseSocket}get walkBorderConfig(){const t=this.config.process.walkBorder,i=this.deviceInfo.power;return t[i]||t.default}setConfigs(t){this.apis.setConfigs(t)}async checkDeviceOnline(){if(!this.connected)return{type:zO.text,text:Uhe.device_is_offline}}async init(t,i){this.connectType=i,await this.setupDevice(t);const r=await this.initDeviceInfo();return this.apis.queryRunningStatus&&(this.runningStatus=await this.apis.queryRunningStatus()),this.checker&&(this.checker.connectType=i),{info:r}}async exportGcode(t,i){var s,o;const r=`${this.id}-${Sd(new Date,"yyyy-MM-dd HH-mm-ss")}.gc`;{const{head:a,tail:l}=this.dataParser.source;return(o=(s=window.MeApi)==null?void 0:s.fileHelper)==null?void 0:o.shareGCode(t,r,a,l)}}uploadByBuilder(t){const{url:i="",path:r="",options:s={}}=t;return this.uploadGcodeHelper(i,r,s)}uploadGCodeByNative(t){var o;const{url:i="",path:r="",options:s={}}=t;return(o=window.MeApi)==null?void 0:o.uploadGcodeNew({url:i,path:r,...s})}getCurrentArea(t){const i=this.config.processingArea.base,r=this.config.processingArea.data.find(s=>s.key===`${t}${this.processingAreaKey}`)||i;return{base:i,current:r}}async beforeGenGcode(t){console.log(t),this.generalGcodeNote(),await this.dataParser.setup()}genProcessParams(){}generalGcodeNote(){var w;const t=yhe(ume),i=this.appContext.version;console.log("general gcode note",this.dataParser);const{params:{id:r,offset:s,size:o,start:a,processMode:l,rotateMultiple:c=1,transform:u}}=this.dataParser.source,{boundingRect:{left:h,top:d,width:f,height:p}}=this.dataParser,g=(w=this.config.process.preview)==null?void 0:w.extendDirection[l],v={...r?{id:r}:{},keys:[u[0].targetKey.toLowerCase(),u[1].targetKey.toLowerCase()],rm:Number(c.toFixed(2))},_={width:Number(f.toFixed(4)),height:Number(p.toFixed(4)),x:Number(h.toFixed(4)),y:Number(d.toFixed(4))};g===Pf.RIGHT&&o.w<f+h&&(o.w=f+h),g===Pf.BOTTOM&&o.h<p+d&&(o.h=p+d);const y=this.config.process.timeConfig(l,this.deviceInfo.power),A=t({time:Sd(new Date,"yyyy_MM_dd_HH_mm_ss"),version:i,size:{w:Number(Math.abs(o.w).toFixed(4)),h:Number(Math.abs(o.h).toFixed(4))},offset:{x:Number(s.x.toFixed(4)),y:Number(s.y.toFixed(4))},start:{x:Number(Math.abs(a.x).toFixed(4)),y:Number(Math.abs(a.y)).toFixed(4)},gc:JSON.stringify(v),printSize:_,timeConfig:JSON.stringify(y)});return this.dataParser.source.prefixGCodeHead(A),A}async genTaskId(t){const i=Nr.createTask(this.id,this.deviceInfo.snCode),r=Nr.tempTask;t&&(r.id=t);const s=r.gcodePath,o=i.gcodePath;await this.fileHelper.copy(s,o)}async checkProcessData({canvasData:t,centralAxisPosition:i,isWalkBorder:r=!1,dataSource:s,isExportGcode:o=!1,extSecondaryType:a,layerOrder:l,currentDeviceData:c}){var p;const u=c||s.currentDeviceData;yr.emptyDirSync(Nr.tempTask.originalDataPath),await ca.activeGcodeGenerate(),this.dataParser=new kve,this.dataParser.storageImage=(g,m,v)=>{var _,y;return(y=(_=window==null?void 0:window.MeApi)==null?void 0:_.fileHelper)==null?void 0:y.writeData(g,m,v)},console.time("dataParser");try{await this.dataParser.parse(t,u,l,r)}catch(g){console.log(g)}const{current:h,base:d}=this.getCurrentArea(u.mode),f=h||d;if(!cr(i)){const{startX:g,startY:m}=vs(i)?{startX:(i==null?void 0:i.startX)||f.startX,startY:(i==null?void 0:i.startY)||f.startY}:{startX:i,startY:f.startY};f.startX=g,f.startY=m}return await this.genProcessParams(),(p=this.checker)==null?void 0:p.check({elementCount:{bitmap:this.dataParser.bitmapCount,vector:this.dataParser.vectorCount,total:this.dataParser.elementsTotal},elementBoundary:{...this.dataParser.boundingRect},params:{...this.dataParser.source.params,isWalkBorder:r},addonStatus:this.addonStatus,connected:this.connected,isExportGcode:o,extSecondaryType:a},f)}checkOverDict(){const t=this.dataParser.elementsData,{processDirection:{direct:i},accel:r}=this.dataParser.source.params;let s=!1;const{base:o}=this.config.processingArea;for(const a of t){const{elementConfig:l,processingParams:{processIgnore:c,processingType:u,speed:h}}=a;if(!(c||![cn.FILL_VECTOR_ENGRAVING,cn.BITMAP_ENGRAVING].includes(u))){if(s)break;for(const d of l){const{x:f,y:p,height:g,width:m}=d,v=i==="topToBottom",_=(h-0)**2/2/r,y=o.height-p-g,A=o.width-f-m;if(v&&(p<_||y<_)||!v&&(f<_||A<_)){s=!0;break}}}}return s}async calCulateEstimatedTime(t,i){var c;const r={inputDir:Nr.tempTask.gcodePath,type:t};tn(i)&&(r.workingType=i);const s=await((c=window==null?void 0:window.xcm)==null?void 0:c.estimatedTime(r));console.log("estimatedTimeResult =>",s);const{code:o,time:a}=s,l=tn(a)?a:-1;return this.taskDeviceInfo={totalTime:l},o?-1:l}async estimatedTime(){console.log(this.id);const t=yj[this.id];return await this.calCulateEstimatedTime(t)}get taskManager(){return Nr}async buildProcessGcode(t){try{if(!this.dataParser)return;await this.dataParser.saveImg(),await this.beforeGenGcode();const i={inputDir:Nr.tempTask.originalData,outputFile:Nr.tempTask.gcode,funcName:"genGCodeSync"};[zt.KNIFE_CUT,zt.PRINTER_KNIFE_CUT].includes(t)&&(i.toolType=2,i.funcName="M1LiteGenGCodeSync"),zt.CURVE_PROCESS===t&&(i.funcName="genCurveGcodeSync",this.id==="F1Ultra"&&(i.funcName="genCurveGcodeSync2"));const r=await(ca==null?void 0:ca.genGCode(i));return console.log("gcodeResult ==>",r),r}catch(i){console.log(i)}}async genSurface(t){var d;const{densityPoints:i,tension:r,smoothness:s}=t,o=s*20,a=i.reduce((f,p)=>{const g={x:p.x,y:p.y,z:p.z},m=p.colIndex;return gi(f[m])&&(f[m]=[]),f[m].push(g),f},[]),l={measureJson:JSON.stringify(a),divX:o,divY:o,tension:r/10},c=await(ca==null?void 0:ca.genSurfaceSync(l));console.log("genSurface ressult ==>",c);const u=JSON.parse(c.ResultJson),h=[];for(let f=o-1;f>=0;f--)for(let p=o-1;p>=0;p--)h.push(u[f][p]);return(d=this.fileHelper)==null||d.writeData(bQ,c.ResultJson),{points:h,range:{col:o,row:o}}}async setupDevice(t){this.apis=t.apis,this.device=t,this.deviceInfo={connectIdentity:t.connectIdentity}}takePicture(t){throw console.log({options:t}),new Error("device ext camera `takePicture` not implemented.")}get taskDetails(){var t,i,r,s;return{fileName:this.appContext.projectName,deviceName:`${this.config.id}-${this.deviceInfo.name}`,totalTime:(t=this.taskDeviceInfo)==null?void 0:t.totalTime,snCode:this.deviceInfo.snCode,filePath:"",imgUrl:"",cannotReconnect:((i=this.config)==null?void 0:i.cannotReconnect)??!1,finishTime:new Date().toLocaleString(),extInstanceId:this.instanceId,manualSet:!1,timeUse:0,processingMode:(r=this.taskDeviceInfo)==null?void 0:r.processingMode,processStartPoint:(s=this.taskDeviceInfo)==null?void 0:s.processStartPoint}}set taskDeviceInfo(t){Object.assign(S(this,o0),t)}get taskDeviceInfo(){return S(this,o0)}pushProcessingStatusToMessageCenter(t){var o;const i=()=>{const a=this.appContext.formatMsg,l={[It.DISCONNECT]:`${this.deviceInfo.name} ${a("device.message.device_disconnect_title")}  `,[It.FINISH_PROCESS]:`${this.deviceInfo.name} ${a("device.message.task_finish_title")}  `},c={[It.DISCONNECT]:a("device.message.device_disconnect_content"),[It.FINISH_PROCESS]:a("device.message.task_finish_content")};if(!l[t]||!c[t])return;const u={uuid:`${this.deviceInfo.snCode}${t}${this.latestDeviceMessageId}`,category:"device",title:l[t],content:c[t],isNotify:!0,isModal:!1};oS(CO.SendToMessageCenter,u)},r=this.taskManager.getTask(this.deviceInfo.snCode).id,s=this.deviceInfo.taskId===r;(this.supportTaskId&&s||!this.supportTaskId&&!((o=this.dataParser)!=null&&o.isWalkBorder))&&i()}async generateProcessingTask(t){var a;const{processingStateMap:i={}}=this.config.process,r=i[t]??t,s=this.taskManager.getTask(this.deviceInfo.snCode).id,o={currentStatus:r,id:s,...this.taskDetails,projectId:this.appContext.projectId};if(this.shouldHandleEvent.includes(r)&&(this.supportTaskId&&s!==""||!this.supportTaskId&&s)&&this.hasUploadGcode){if(r===It.START_PROCESS){const l=await oS(up.GetTabInfo,o.projectId);o.filePath=l.url,o.imgUrl=(a=this.taskDeviceInfo)==null?void 0:a.canvasSnapshotImg,o.fileName=l.fileName}await this.taskManager.updateTask(o),oS(up.GetProcessTaskInfo,o)}}async exportLog(t="xcs_device_log.gz"){if(Ove.VITE_PAD)return this.exportLogPad(t);try{const i=await this.apis.exportLog();await kj(t,i,!0,{filters:[]}),this.appContext.showMessage({type:"success",contentI18nKey:"device.setting.export_success"})}catch(i){if(i===Ghe.CANCEL)return;Rte({result:"fail",type:"too_large"}),console.log("导出gcode失败",i),this.appContext.showMessage({type:"error",contentI18nKey:"device.setting.export_fail"})}}async exportLogPad(t="xcs_device_log.gz"){try{const i=await this.apis.exportLog();pC(t,new Blob([i]))}catch{this.appContext.showMessage({type:"error",contentI18nKey:"device.setting.export_fail"})}}getSpeed(t,i){const{speed:r={}}=this._config.deviceMetaData??{},s=r[t.mode],o=this.deviceInfo.power,{rotaryAttachmentType:a}=t,{processingType:l}=i;let c=[],u=[];if(gi(s)){const f=Object.keys(r)[0];return r[f][0]}const h=s.filter(f=>f.type===l);a&&(c=h.filter(f=>f[a]));const d=wt(c)?h:c;return tn(o)&&o>0&&(u=d.filter(f=>f.power&&f.power.includes(o))),u[0]||c[0]||h[0]}getSpeedScope(t,i){const{VECTOR_ENGRAVING:r}=_j;if(i.processingType===r&&(t==null?void 0:t.rotaryAttachmentType)==="roller")return{max:25};if(i.processingType===r&&(t==null?void 0:t.rotaryAttachmentType)==="catch"){const o={max:120};return t.diameter&&t.diameter<32&&(o.max=Math.round(1.17*Math.PI*t.diameter)),o}const s=this.getSpeed(t,i);return{min:s==null?void 0:s.min,max:s==null?void 0:s.max}}onLoad(){}onConnected(){this.connected=!0}onDisconnect(){this.connected=!1,this.device=void 0,this.deviceInfo={currentStatus:It.DISCONNECT}}onChange(){throw new Error("Method not implemented.")}onBeforeUnloaded(){}dispose(){}toJSON(){return{info:this.info}}}Wf=new WeakMap,OE=new WeakMap,o0=new WeakMap,Yh=new WeakMap;const{START_PROCESS:Nve,DISCONNECT:Bve,CANCEL_PROCESS:Fve,FINISH_PROCESS:Uve}=It,mF="task/currentAndHistoryTask.json",Gve=20;var LE,qh,KW;let vF=(KW=class{constructor(e){ke(this,LE,Date.now().toString());ke(this,qh,"");const{extId:t,snCode:i,platform:r}=e;t?Qe(this,qh,`${r}_${t}_${i}_${S(this,LE)}`):Qe(this,qh,""),console.log(["Task constructor => ",S(this,qh)])}set id(e){Qe(this,qh,e)}get id(){return S(this,qh)}get gcode(){return this.parserPath("task/#id/gcode.txt")}get preview(){return this.parserPath("task/#id/preview.png")}get originalData(){return this.parserPath("task/#id/originalData/")}get border(){return this.parserPath("task/#id/border.txt")}get gcodePath(){return this.parserPath(`${Js}/task/#id/gcode.txt`)}get originalDataPath(){return this.parserPath(`${Js}/task/#id/originalData`)}get previewPath(){return this.parserPath(`${Js}/task/#id/preview.png`)}get borderPath(){return this.parserPath(`${Js}/task/#id/border.txt`)}get headCodePath(){return this.parserPath(`${Js}/task/#id/head.txt`)}get tailCodePath(){return this.parserPath(`${Js}/task/#id/tail.txt`)}get taskIdDataPath(){return this.parserPath("task/#id/")}parserPath(e){return e.replace(/task\/#id\//,`task/${this.id?`${this.id}/`:""}`)}},LE=new WeakMap,qh=new WeakMap,KW);var Xm;class Hve{constructor(){ke(this,Xm,{})}get tempTask(){return new vF({extId:"",snCode:"",platform:""})}get platform(){return fM.PHONE}get tasks(){return S(this,Xm)}getTask(e){return S(this,Xm)[e]??this.tempTask}createTask(e,t=""){const i={extId:e,snCode:t,platform:this.platform},r=new vF(i);return S(this,Xm)[t]=r,r}async updateTask(e){const t=await this.readTaskList();let i=!1;const r=t.map(o=>o.id===e.id?(i=!0,e.currentStatus===Bve&&(e!=null&&e.cannotReconnect)&&(e.manualSet=!0),tj({},o,e,(a,l)=>{if(l===""||l===void 0||l===0)return a})):o);e.currentStatus===Nve&&!i&&r.unshift(e);const s=r.filter(o=>o.currentStatus===Fve||o.currentStatus===Uve||o.manualSet===!0);if(s.length>Gve){const o=s.pop(),a=r.findIndex(l=>l.id===o.id);a!==-1&&r.splice(a,1)}console.log("updatedTaskData=>",r),await this.addTaskList(r)}async getLocalTaskDirs(){const e=`${Js}/task`;let t=await(yr==null?void 0:yr.readdirSync(e));return t=t.filter(i=>this.isTaskDir(i)),t}isTaskDir(e){const t=e.split("_");return!(t.length!==4||!Object.values(fM).includes(t[0]))}removeTaskDir(e){yr==null||yr.removeSync(e)}async readTaskList(){try{return await(yr==null?void 0:yr.readJSON(`${Js}/${mF}`))}catch{return[]}}async addTaskList(e){return await(yr==null?void 0:yr.writeJSON(`${Js}/${mF}`,e))}async readHeadAndTailCode(e,t){try{const i=this.getTask(e).taskIdDataPath;return await(yr==null?void 0:yr.read2Str(`${Js}/${i}/${t}.txt`))}catch{return[]}}async addHeadAndTailCode(e,t,i){const r=this.getTask(e).taskIdDataPath;return yr==null?void 0:yr.write(`${Js}/${r}/${t}.txt`,i)}}Xm=new WeakMap;const Nr=new Hve,Vve="2.9.1-2",zve={version:Vve};let _F=!1;function $ve(n){if(_F)return;const e=[`%c【m-canvas-core】 - ✰ ${n} ✰ `,"color: green; padding:5px 0;"];globalThis.console.log(...e),_F=!0}/*!
 * @pixi/math - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aA=Math.PI*2,XT=180/Math.PI,Yo=Math.PI/180,Yn;(function(n){n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC"})(Yn||(Yn={}));var Ae=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},n.prototype.copyTo=function(e){return e.set(this.x,this.y),e},n.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},n.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x=e,this.y=t,this},n.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},n}(),Nb=[new Ae,new Ae,new Ae,new Ae],Pt=function(){function n(e,t,i,r){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=0),this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(r),this.type=Yn.RECT}return Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(n,"EMPTY",{get:function(){return new n(0,0,0,0)},enumerable:!1,configurable:!0}),n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},n.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},n.prototype.contains=function(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height},n.prototype.intersects=function(e,t){if(!t){var i=this.x<e.x?e.x:this.x,r=this.right>e.right?e.right:this.right;if(r<=i)return!1;var s=this.y<e.y?e.y:this.y,o=this.bottom>e.bottom?e.bottom:this.bottom;return o>s}var a=this.left,l=this.right,c=this.top,u=this.bottom;if(l<=a||u<=c)return!1;var h=Nb[0].set(e.left,e.top),d=Nb[1].set(e.left,e.bottom),f=Nb[2].set(e.right,e.top),p=Nb[3].set(e.right,e.bottom);if(f.x<=h.x||d.y<=h.y)return!1;var g=Math.sign(t.a*t.d-t.b*t.c);if(g===0||(t.apply(h,h),t.apply(d,d),t.apply(f,f),t.apply(p,p),Math.max(h.x,d.x,f.x,p.x)<=a||Math.min(h.x,d.x,f.x,p.x)>=l||Math.max(h.y,d.y,f.y,p.y)<=c||Math.min(h.y,d.y,f.y,p.y)>=u))return!1;var m=g*(d.y-h.y),v=g*(h.x-d.x),_=m*a+v*c,y=m*l+v*c,A=m*a+v*u,w=m*l+v*u;if(Math.max(_,y,A,w)<=m*h.x+v*h.y||Math.min(_,y,A,w)>=m*p.x+v*p.y)return!1;var b=g*(h.y-f.y),C=g*(f.x-h.x),I=b*a+C*c,x=b*l+C*c,T=b*a+C*u,O=b*l+C*u;return!(Math.max(I,x,T,O)<=b*h.x+C*h.y||Math.min(I,x,T,O)>=b*p.x+C*p.y)},n.prototype.pad=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this},n.prototype.fit=function(e){var t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=r,this.height=Math.max(s-r,0),this},n.prototype.ceil=function(e,t){e===void 0&&(e=1),t===void 0&&(t=.001);var i=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=r-this.y,this},n.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=r,this.height=s-r,this},n.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},n}(),YT=function(){function n(e,t,i){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),this.x=e,this.y=t,this.radius=i,this.type=Yn.CIRC}return n.prototype.clone=function(){return new n(this.x,this.y,this.radius)},n.prototype.contains=function(e,t){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-e,s=this.y-t;return r*=r,s*=s,r+s<=i},n.prototype.getBounds=function(){return new Pt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},n.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},n}(),SQ=function(){function n(e,t,i,r){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=0),this.x=e,this.y=t,this.width=i,this.height=r,this.type=Yn.ELIP}return n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var i=(e-this.x)/this.width,r=(t-this.y)/this.height;return i*=i,r*=r,i+r<=1},n.prototype.getBounds=function(){return new Pt(this.x-this.width,this.y-this.height,this.width,this.height)},n.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},n}(),qu=function(){function n(){for(var e=arguments,t=[],i=0;i<arguments.length;i++)t[i]=e[i];var r=Array.isArray(t[0])?t[0]:t;if(typeof r[0]!="number"){for(var s=[],o=0,a=r.length;o<a;o++)s.push(r[o].x,r[o].y);r=s}this.points=r,this.type=Yn.POLY,this.closeStroke=!0}return n.prototype.clone=function(){var e=this.points.slice(),t=new n(e);return t.closeStroke=this.closeStroke,t},n.prototype.contains=function(e,t){for(var i=!1,r=this.points.length/2,s=0,o=r-1;s<r;o=s++){var a=this.points[s*2],l=this.points[s*2+1],c=this.points[o*2],u=this.points[o*2+1],h=l>t!=u>t&&e<(c-a)*((t-l)/(u-l))+a;h&&(i=!i)}return i},n.prototype.toString=function(){return"[@pixi/math:Polygon"+("closeStroke="+this.closeStroke)+("points="+this.points.reduce(function(e,t){return e+", "+t},"")+"]")},n}(),PQ=function(){function n(e,t,i,r,s){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=0),s===void 0&&(s=20),this.x=e,this.y=t,this.width=i,this.height=r,this.radius=s,this.type=Yn.RREC}return n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.radius)},n.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){var i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;var r=e-(this.x+i),s=t-(this.y+i),o=i*i;if(r*r+s*s<=o||(r=e-(this.x+this.width-i),r*r+s*s<=o)||(s=t-(this.y+this.height-i),r*r+s*s<=o)||(r=e-(this.x+i),r*r+s*s<=o))return!0}return!1},n.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+("width="+this.width+" height="+this.height+" radius="+this.radius+"]")},n}(),Gu=function(){function n(e,t,i,r){i===void 0&&(i=0),r===void 0&&(r=0),this._x=i,this._y=r,this.cb=e,this.scope=t}return n.prototype.clone=function(e,t){return e===void 0&&(e=this.cb),t===void 0&&(t=this.scope),new n(e,t,this._x,this._y)},n.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this},n.prototype.copyFrom=function(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},n.prototype.copyTo=function(e){return e.set(this._x,this._y),e},n.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},n.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),n}(),Dt=function(){function n(e,t,i,r,s,o){e===void 0&&(e=1),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=1),s===void 0&&(s=0),o===void 0&&(o=0),this.array=null,this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o}return n.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},n.prototype.set=function(e,t,i,r,s,o){return this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o,this},n.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},n.prototype.apply=function(e,t){t=t||new Ae;var i=e.x,r=e.y;return t.x=this.a*i+this.c*r+this.tx,t.y=this.b*i+this.d*r+this.ty,t},n.prototype.applyInverse=function(e,t){t=t||new Ae;var i=1/(this.a*this.d+this.c*-this.b),r=e.x,s=e.y;return t.x=this.d*i*r+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,t.y=this.a*i*s+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,t},n.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},n.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},n.prototype.rotate=function(e){var t=Math.cos(e),i=Math.sin(e),r=this.a,s=this.c,o=this.tx;return this.a=r*t-this.b*i,this.b=r*i+this.b*t,this.c=s*t-this.d*i,this.d=s*i+this.d*t,this.tx=o*t-this.ty*i,this.ty=o*i+this.ty*t,this},n.prototype.append=function(e){var t=this.a,i=this.b,r=this.c,s=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*r,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this},n.prototype.setTransform=function(e,t,i,r,s,o,a,l,c){return this.a=Math.cos(a+c)*s,this.b=Math.sin(a+c)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(i*this.a+r*this.c),this.ty=t-(i*this.b+r*this.d),this},n.prototype.prepend=function(e){var t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){var i=this.a,r=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},n.prototype.decompose=function(e){var t=this.a,i=this.b,r=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-r,s),l=Math.atan2(i,t),c=Math.abs(a+l);return c<1e-5||Math.abs(aA-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(r*r+s*s),e.position.x=this.tx+(o.x*t+o.y*r),e.position.y=this.ty+(o.x*i+o.y*s),e},n.prototype.invert=function(){var e=this.a,t=this.b,i=this.c,r=this.d,s=this.tx,o=e*r-t*i;return this.a=r/o,this.b=-t/o,this.c=-i/o,this.d=e/o,this.tx=(i*this.ty-r*s)/o,this.ty=-(e*this.ty-t*s)/o,this},n.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},n.prototype.clone=function(){var e=new n;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},n.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},n.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},n.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(n,"IDENTITY",{get:function(){return new n},enumerable:!1,configurable:!0}),Object.defineProperty(n,"TEMP_MATRIX",{get:function(){return new n},enumerable:!1,configurable:!0}),n}(),af=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],lf=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],cf=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],uf=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],RM=[],MQ=[],Bb=Math.sign;function Wve(){for(var n=0;n<16;n++){var e=[];RM.push(e);for(var t=0;t<16;t++)for(var i=Bb(af[n]*af[t]+cf[n]*lf[t]),r=Bb(lf[n]*af[t]+uf[n]*lf[t]),s=Bb(af[n]*cf[t]+cf[n]*uf[t]),o=Bb(lf[n]*cf[t]+uf[n]*uf[t]),a=0;a<16;a++)if(af[a]===i&&lf[a]===r&&cf[a]===s&&uf[a]===o){e.push(a);break}}for(var n=0;n<16;n++){var l=new Dt;l.set(af[n],lf[n],cf[n],uf[n],0,0),MQ.push(l)}}Wve();var Ki={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(n){return af[n]},uY:function(n){return lf[n]},vX:function(n){return cf[n]},vY:function(n){return uf[n]},inv:function(n){return n&8?n&15:-n&7},add:function(n,e){return RM[n][e]},sub:function(n,e){return RM[n][Ki.inv(e)]},rotate180:function(n){return n^4},isVertical:function(n){return(n&3)===2},byDirection:function(n,e){return Math.abs(n)*2<=Math.abs(e)?e>=0?Ki.S:Ki.N:Math.abs(e)*2<=Math.abs(n)?n>0?Ki.E:Ki.W:e>0?n>0?Ki.SE:Ki.SW:n>0?Ki.NE:Ki.NW},matrixAppendRotationInv:function(n,e,t,i){t===void 0&&(t=0),i===void 0&&(i=0);var r=MQ[Ki.inv(e)];r.tx=t,r.ty=i,n.append(r)}},nb=function(){function n(){this.worldTransform=new Dt,this.localTransform=new Dt,this.position=new Gu(this.onChange,this,0,0),this.scale=new Gu(this.onChange,this,1,1),this.pivot=new Gu(this.onChange,this,0,0),this.skew=new Gu(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return n.prototype.onChange=function(){this._localID++},n.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},n.prototype.toString=function(){return"[@pixi/math:Transform "+("position=("+this.position.x+", "+this.position.y+") ")+("rotation="+this.rotation+" ")+("scale=("+this.scale.x+", "+this.scale.y+") ")+("skew=("+this.skew.x+", "+this.skew.y+") ")+"]"},n.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},n.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var i=e.worldTransform,r=this.worldTransform;r.a=t.a*i.a+t.b*i.c,r.b=t.a*i.b+t.b*i.d,r.c=t.c*i.a+t.d*i.c,r.d=t.c*i.b+t.d*i.d,r.tx=t.tx*i.a+t.ty*i.c+i.tx,r.ty=t.tx*i.b+t.ty*i.d+i.ty,this._parentID=e._worldID,this._worldID++}},n.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!1,configurable:!0}),n.IDENTITY=new n,n}();/*!
 * @pixi/settings - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*!
 * @pixi/constants - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var yF;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(yF||(yF={}));var AF;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})(AF||(AF={}));var bF;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(bF||(bF={}));var wF;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(wF||(wF={}));var xF;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(xF||(xF={}));var CF;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(CF||(CF={}));var EF;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(EF||(EF={}));var TF;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(TF||(TF={}));var IF;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(IF||(IF={}));var DM;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(DM||(DM={}));var kM;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(kM||(kM={}));var OM;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(OM||(OM={}));var SF;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(SF||(SF={}));var PF;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(PF||(PF={}));var LM;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(LM||(LM={}));var vy;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})(vy||(vy={}));var MF;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(MF||(MF={}));var RF;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(RF||(RF={}));var NM;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(NM||(NM={}));var DF;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(DF||(DF={}));var RQ={createCanvas:function(n,e){var t=document.createElement("canvas");return t.width=n,t.height=e,t},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var n;return(n=document.baseURI)!==null&&n!==void 0?n:window.location.href},fetch:function(n,e){return fetch(n,e)}},mS=/iPhone/i,kF=/iPod/i,OF=/iPad/i,LF=/\biOS-universal(?:.+)Mac\b/i,vS=/\bAndroid(?:.+)Mobile\b/i,NF=/Android/i,Tg=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Fb=/Silk/i,Jc=/Windows Phone/i,BF=/\bWindows(?:.+)ARM\b/i,FF=/BlackBerry/i,UF=/BB10/i,GF=/Opera Mini/i,HF=/\b(CriOS|Chrome)(?:.+)Mobile/i,VF=/Mobile(?:.+)Firefox\b/i,zF=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function jve(n){return function(e){return e.test(n)}}function Qve(n){var e={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?e.userAgent=n:n&&n.userAgent&&(e={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var t=e.userAgent,i=t.split("[FBAN");typeof i[1]<"u"&&(t=i[0]),i=t.split("Twitter"),typeof i[1]<"u"&&(t=i[0]);var r=jve(t),s={apple:{phone:r(mS)&&!r(Jc),ipod:r(kF),tablet:!r(mS)&&(r(OF)||zF(e))&&!r(Jc),universal:r(LF),device:(r(mS)||r(kF)||r(OF)||r(LF)||zF(e))&&!r(Jc)},amazon:{phone:r(Tg),tablet:!r(Tg)&&r(Fb),device:r(Tg)||r(Fb)},android:{phone:!r(Jc)&&r(Tg)||!r(Jc)&&r(vS),tablet:!r(Jc)&&!r(Tg)&&!r(vS)&&(r(Fb)||r(NF)),device:!r(Jc)&&(r(Tg)||r(Fb)||r(vS)||r(NF))||r(/\bokhttp\b/i)},windows:{phone:r(Jc),tablet:r(BF),device:r(Jc)||r(BF)},other:{blackberry:r(FF),blackberry10:r(UF),opera:r(GF),firefox:r(VF),chrome:r(HF),device:r(FF)||r(UF)||r(GF)||r(VF)||r(HF)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}var Qa=Qve(globalThis.navigator);function Xve(){return!Qa.apple.device}function Yve(n){var e=!0;if(Qa.tablet||Qa.phone){if(Qa.apple.device){var t=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(t){var i=parseInt(t[1],10);i<11&&(e=!1)}}if(Qa.android.device){var t=navigator.userAgent.match(/Android\s([0-9.]*)/);if(t){var i=parseInt(t[1],10);i<7&&(e=!1)}}}return e?n:4}var xt={ADAPTER:RQ,MIPMAP_TEXTURES:OM.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:NM.NONE,SPRITE_MAX_TEXTURES:Yve(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:LM.AUTO,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:kM.CLAMP,SCALE_MODE:DM.LINEAR,PRECISION_VERTEX:vy.HIGH,PRECISION_FRAGMENT:Qa.apple.device?vy.HIGH:vy.MEDIUM,CAN_UPLOAD_SAME_BUFFER:Xve(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};/*!
 * @pixi/extensions - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/extensions is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _y=function(){return _y=Object.assign||function(e){for(var t=arguments,i,r=1,s=arguments.length;r<s;r++){i=t[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_y.apply(this,arguments)},ai;(function(n){n.Application="application",n.RendererPlugin="renderer-webgl-plugin",n.CanvasRendererPlugin="renderer-canvas-plugin",n.Loader="loader",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser"})(ai||(ai={}));var $F=function(n){if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");var e=typeof n.extension!="object"?{type:n.extension}:n.extension;n=_y(_y({},e),{ref:n})}if(typeof n=="object")n=_y({},n);else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},rc={_addHandlers:null,_removeHandlers:null,_queue:{},remove:function(){for(var n=arguments,e=this,t=[],i=0;i<arguments.length;i++)t[i]=n[i];return t.map($F).forEach(function(r){r.type.forEach(function(s){var o,a;return(a=(o=e._removeHandlers)[s])===null||a===void 0?void 0:a.call(o,r)})}),this},add:function(){for(var n=arguments,e=this,t=[],i=0;i<arguments.length;i++)t[i]=n[i];return t.map($F).forEach(function(r){r.type.forEach(function(s){var o=e._addHandlers,a=e._queue;o[s]?o[s](r):(a[s]=a[s]||[],a[s].push(r))})}),this},handle:function(n,e,t){var i=this._addHandlers=this._addHandlers||{},r=this._removeHandlers=this._removeHandlers||{};if(i[n]||r[n])throw new Error("Extension type "+n+" already has a handler");i[n]=e,r[n]=t;var s=this._queue;return s[n]&&(s[n].forEach(function(o){return e(o)}),delete s[n]),this},handleByMap:function(n,e){return this.handle(n,function(t){e[t.name]=t.ref},function(t){delete e[t.name]})},handleByList:function(n,e){return this.handle(n,function(t){var i,r;e.push(t.ref),n===ai.Loader&&((r=(i=t.ref).add)===null||r===void 0||r.call(i))},function(t){var i=e.indexOf(t.ref);i!==-1&&e.splice(i,1)})}};/*!
 * @pixi/ticker - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */xt.TARGET_FPMS=.06;var rl;(function(n){n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY"})(rl||(rl={}));var _S=function(){function n(e,t,i,r){t===void 0&&(t=null),i===void 0&&(i=0),r===void 0&&(r=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=i,this.once=r}return n.prototype.match=function(e,t){return t===void 0&&(t=null),this.fn===e&&this.context===t},n.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},n.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},n.prototype.destroy=function(e){e===void 0&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},n}(),Qi=function(){function n(){var e=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new _S(null,null,1/0),this.deltaMS=1/xt.TARGET_FPMS,this.elapsedMS=1/xt.TARGET_FPMS,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&e._requestId===null&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return n.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},n.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},n.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},n.prototype.add=function(e,t,i){return i===void 0&&(i=rl.NORMAL),this._addListener(new _S(e,t,i))},n.prototype.addOnce=function(e,t,i){return i===void 0&&(i=rl.NORMAL),this._addListener(new _S(e,t,i,!0))},n.prototype._addListener=function(e){var t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this},n.prototype.remove=function(e,t){for(var i=this._head.next;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(n.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},n.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},n.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},n.prototype.update=function(e){e===void 0&&(e=performance.now());var t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*xt.TARGET_FPMS;for(var r=this._head,s=r.next;s;)s=s.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(n.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,xt.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(e===0)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"shared",{get:function(){if(!n._shared){var e=n._shared=new n;e.autoStart=!0,e._protected=!0}return n._shared},enumerable:!1,configurable:!0}),Object.defineProperty(n,"system",{get:function(){if(!n._system){var e=n._system=new n;e.autoStart=!0,e._protected=!0}return n._system},enumerable:!1,configurable:!0}),n}(),DQ=function(){function n(){}return n.init=function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,rl.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Qi.shared:new Qi,e.autoStart&&this.start()},n.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},n.extension=ai.Application,n}(),kQ={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new r(u,h||l,d),p=t?t+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new i:delete l._events[c]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=t?t+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,p=new Array(f);d<f;d++)p[d]=h[d].fn;return p},a.prototype.listenerCount=function(c){var u=t?t+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,d,f,p){var g=t?t+c:c;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,_,y;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,h),!0;case 4:return m.fn.call(m.context,u,h,d),!0;case 5:return m.fn.call(m.context,u,h,d,f),!0;case 6:return m.fn.call(m.context,u,h,d,f,p),!0}for(y=1,_=new Array(v-1);y<v;y++)_[y-1]=arguments[y];m.fn.apply(m.context,_)}else{var A=m.length,w;for(y=0;y<A;y++)switch(m[y].once&&this.removeListener(c,m[y].fn,void 0,!0),v){case 1:m[y].fn.call(m[y].context);break;case 2:m[y].fn.call(m[y].context,u);break;case 3:m[y].fn.call(m[y].context,u,h);break;case 4:m[y].fn.call(m[y].context,u,h,d);break;default:if(!_)for(w=1,_=new Array(v-1);w<v;w++)_[w-1]=arguments[w];m[y].fn.apply(m[y].context,_)}}return!0},a.prototype.on=function(c,u,h){return s(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return s(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,d){var f=t?t+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!d||p.once)&&(!h||p.context===h)&&o(this,f);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==u||d&&!p[g].once||h&&p[g].context!==h)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&o(this,u)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(kQ);var qve=kQ.exports;const Zr=Ld(qve);var hL={exports:{}};hL.exports=qT;hL.exports.default=qT;function qT(n,e,t){t=t||2;var i=e&&e.length,r=i?e[0]*t:n.length,s=OQ(n,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,c,u,h,d,f;if(i&&(s=t_e(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(var p=t;p<r;p+=t)h=n[p],d=n[p+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-a,u-l),f=f!==0?32767/f:0}return lA(s,o,t,a,l,f,0),o}function OQ(n,e,t,i,r){var s,o;if(r===UM(n,e,t,i)>0)for(s=e;s<t;s+=i)o=WF(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=WF(s,n[s],n[s+1],o);return o&&KT(o,o.next)&&(uA(o),o=o.next),o}function Hp(n,e){if(!n)return n;e||(e=n);var t=n,i;do if(i=!1,!t.steiner&&(KT(t,t.next)||ar(t.prev,t,t.next)===0)){if(uA(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function lA(n,e,t,i,r,s,o){if(n){!o&&s&&o_e(n,i,r,s);for(var a=n,l,c;n.prev!==n.next;){if(l=n.prev,c=n.next,s?Jve(n,i,r,s):Kve(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),uA(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=Zve(Hp(n),e,t),lA(n,e,t,i,r,s,2)):o===2&&e_e(n,e,t,i,r,s):lA(Hp(n),e,t,i,r,s,1);break}}}}function Kve(n){var e=n.prev,t=n,i=n.next;if(ar(e,t,i)>=0)return!1;for(var r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,c=i.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,p=i.next;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&fm(r,a,s,l,o,c,p.x,p.y)&&ar(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Jve(n,e,t,i){var r=n.prev,s=n,o=n.next;if(ar(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=u<h?u<d?u:d:h<d?h:d,g=a>l?a>c?a:c:l>c?l:c,m=u>h?u>d?u:d:h>d?h:d,v=BM(f,p,e,t,i),_=BM(g,m,e,t,i),y=n.prevZ,A=n.nextZ;y&&y.z>=v&&A&&A.z<=_;){if(y.x>=f&&y.x<=g&&y.y>=p&&y.y<=m&&y!==r&&y!==o&&fm(a,u,l,h,c,d,y.x,y.y)&&ar(y.prev,y,y.next)>=0||(y=y.prevZ,A.x>=f&&A.x<=g&&A.y>=p&&A.y<=m&&A!==r&&A!==o&&fm(a,u,l,h,c,d,A.x,A.y)&&ar(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;y&&y.z>=v;){if(y.x>=f&&y.x<=g&&y.y>=p&&y.y<=m&&y!==r&&y!==o&&fm(a,u,l,h,c,d,y.x,y.y)&&ar(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;A&&A.z<=_;){if(A.x>=f&&A.x<=g&&A.y>=p&&A.y<=m&&A!==r&&A!==o&&fm(a,u,l,h,c,d,A.x,A.y)&&ar(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function Zve(n,e,t){var i=n;do{var r=i.prev,s=i.next.next;!KT(r,s)&&LQ(r,i,i.next,s)&&cA(r,s)&&cA(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),uA(i),uA(i.next),i=n=s),i=i.next}while(i!==n);return Hp(i)}function e_e(n,e,t,i,r,s){var o=n;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&c_e(o,a)){var l=NQ(o,a);o=Hp(o,o.next),l=Hp(l,l.next),lA(o,e,t,i,r,s,0),lA(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function t_e(n,e,t,i){var r=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=OQ(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(l_e(c));for(r.sort(n_e),s=0;s<r.length;s++)t=i_e(r[s],t);return t}function n_e(n,e){return n.x-e.x}function i_e(n,e){var t=r_e(n,e);if(!t)return e;var i=NQ(t,n);return Hp(i,i.next),Hp(t,t.next)}function r_e(n,e){var t=e,i=n.x,r=n.y,s=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){var a=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,c=o.x,u=o.y,h=1/0,d;t=o;do i>=t.x&&t.x>=c&&i!==t.x&&fm(r<u?i:s,r,c,u,r<u?s:i,r,t.x,t.y)&&(d=Math.abs(r-t.y)/(i-t.x),cA(t,n)&&(d<h||d===h&&(t.x>o.x||t.x===o.x&&s_e(o,t)))&&(o=t,h=d)),t=t.next;while(t!==l);return o}function s_e(n,e){return ar(n.prev,n,e.prev)<0&&ar(e.next,n,n.next)<0}function o_e(n,e,t,i){var r=n;do r.z===0&&(r.z=BM(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,a_e(r)}function a_e(n){var e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1);return n}function BM(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function l_e(n){var e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function fm(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function c_e(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!u_e(n,e)&&(cA(n,e)&&cA(e,n)&&h_e(n,e)&&(ar(n.prev,n,e.prev)||ar(n,e.prev,e))||KT(n,e)&&ar(n.prev,n,n.next)>0&&ar(e.prev,e,e.next)>0)}function ar(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function KT(n,e){return n.x===e.x&&n.y===e.y}function LQ(n,e,t,i){var r=Gb(ar(n,e,t)),s=Gb(ar(n,e,i)),o=Gb(ar(t,i,n)),a=Gb(ar(t,i,e));return!!(r!==s&&o!==a||r===0&&Ub(n,t,e)||s===0&&Ub(n,i,e)||o===0&&Ub(t,n,i)||a===0&&Ub(t,e,i))}function Ub(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Gb(n){return n>0?1:n<0?-1:0}function u_e(n,e){var t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&LQ(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function cA(n,e){return ar(n.prev,n,n.next)<0?ar(n,e,n.next)>=0&&ar(n,n.prev,e)>=0:ar(n,e,n.prev)<0||ar(n,n.next,e)<0}function h_e(n,e){var t=n,i=!1,r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function NQ(n,e){var t=new FM(n.i,n.x,n.y),i=new FM(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function WF(n,e,t,i){var r=new FM(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function uA(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function FM(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}qT.deviation=function(n,e,t,i){var r=e&&e.length,s=r?e[0]*t:n.length,o=Math.abs(UM(n,0,s,t));if(r)for(var a=0,l=e.length;a<l;a++){var c=e[a]*t,u=a<l-1?e[a+1]*t:n.length;o-=Math.abs(UM(n,c,u,t))}var h=0;for(a=0;a<i.length;a+=3){var d=i[a]*t,f=i[a+1]*t,p=i[a+2]*t;h+=Math.abs((n[d]-n[p])*(n[f+1]-n[d+1])-(n[d]-n[f])*(n[p+1]-n[d+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function UM(n,e,t,i){for(var r=0,s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}qT.flatten=function(n){for(var e=n[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,r=0;r<n.length;r++){for(var s=0;s<n[r].length;s++)for(var o=0;o<e;o++)t.vertices.push(n[r][s][o]);r>0&&(i+=n[r-1].length,t.holes.push(i))}return t};var d_e=hL.exports;const dL=Ld(d_e);var yC={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */yC.exports;(function(n,e){(function(t){var i=e&&!e.nodeType&&e,r=n&&!n.nodeType&&n,s=typeof un=="object"&&un;(s.global===s||s.window===s||s.self===s)&&(t=s);var o,a=2147483647,l=36,c=1,u=26,h=38,d=700,f=72,p=128,g="-",m=/^xn--/,v=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=l-c,w=Math.floor,b=String.fromCharCode,C;function I(U){throw new RangeError(y[U])}function x(U,$){for(var j=U.length,Q=[];j--;)Q[j]=$(U[j]);return Q}function T(U,$){var j=U.split("@"),Q="";j.length>1&&(Q=j[0]+"@",U=j[1]),U=U.replace(_,".");var ne=U.split("."),ve=x(ne,$).join(".");return Q+ve}function O(U){for(var $=[],j=0,Q=U.length,ne,ve;j<Q;)ne=U.charCodeAt(j++),ne>=55296&&ne<=56319&&j<Q?(ve=U.charCodeAt(j++),(ve&64512)==56320?$.push(((ne&1023)<<10)+(ve&1023)+65536):($.push(ne),j--)):$.push(ne);return $}function F(U){return x(U,function($){var j="";return $>65535&&($-=65536,j+=b($>>>10&1023|55296),$=56320|$&1023),j+=b($),j}).join("")}function G(U){return U-48<10?U-22:U-65<26?U-65:U-97<26?U-97:l}function B(U,$){return U+22+75*(U<26)-(($!=0)<<5)}function R(U,$,j){var Q=0;for(U=j?w(U/d):U>>1,U+=w(U/$);U>A*u>>1;Q+=l)U=w(U/A);return w(Q+(A+1)*U/(U+h))}function P(U){var $=[],j=U.length,Q,ne=0,ve=p,Pe=f,De,Xe,Ne,et,ze,de,lt,he,Ce;for(De=U.lastIndexOf(g),De<0&&(De=0),Xe=0;Xe<De;++Xe)U.charCodeAt(Xe)>=128&&I("not-basic"),$.push(U.charCodeAt(Xe));for(Ne=De>0?De+1:0;Ne<j;){for(et=ne,ze=1,de=l;Ne>=j&&I("invalid-input"),lt=G(U.charCodeAt(Ne++)),(lt>=l||lt>w((a-ne)/ze))&&I("overflow"),ne+=lt*ze,he=de<=Pe?c:de>=Pe+u?u:de-Pe,!(lt<he);de+=l)Ce=l-he,ze>w(a/Ce)&&I("overflow"),ze*=Ce;Q=$.length+1,Pe=R(ne-et,Q,et==0),w(ne/Q)>a-ve&&I("overflow"),ve+=w(ne/Q),ne%=Q,$.splice(ne++,0,ve)}return F($)}function k(U){var $,j,Q,ne,ve,Pe,De,Xe,Ne,et,ze,de=[],lt,he,Ce,se;for(U=O(U),lt=U.length,$=p,j=0,ve=f,Pe=0;Pe<lt;++Pe)ze=U[Pe],ze<128&&de.push(b(ze));for(Q=ne=de.length,ne&&de.push(g);Q<lt;){for(De=a,Pe=0;Pe<lt;++Pe)ze=U[Pe],ze>=$&&ze<De&&(De=ze);for(he=Q+1,De-$>w((a-j)/he)&&I("overflow"),j+=(De-$)*he,$=De,Pe=0;Pe<lt;++Pe)if(ze=U[Pe],ze<$&&++j>a&&I("overflow"),ze==$){for(Xe=j,Ne=l;et=Ne<=ve?c:Ne>=ve+u?u:Ne-ve,!(Xe<et);Ne+=l)se=Xe-et,Ce=l-et,de.push(b(B(et+se%Ce,0))),Xe=w(se/Ce);de.push(b(B(Xe,0))),ve=R(j,he,Q==ne),j=0,++Q}++j,++$}return de.join("")}function L(U){return T(U,function($){return m.test($)?P($.slice(4).toLowerCase()):$})}function H(U){return T(U,function($){return v.test($)?"xn--"+k($):$})}if(o={version:"1.4.1",ucs2:{decode:O,encode:F},decode:P,encode:k,toASCII:H,toUnicode:L},i&&r)if(n.exports==i)r.exports=o;else for(C in o)o.hasOwnProperty(C)&&(i[C]=o[C]);else t.punycode=o})(un)})(yC,yC.exports);var f_e=yC.exports,p_e=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var r=42;e[t]=r;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==r||o.enumerable!==!0)return!1}return!0},jF=typeof Symbol<"u"&&Symbol,g_e=p_e,m_e=function(){return typeof jF!="function"||typeof Symbol!="function"||typeof jF("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:g_e()},QF={foo:{}},v_e=Object,__e=function(){return{__proto__:QF}.foo===QF.foo&&!({__proto__:null}instanceof v_e)},y_e="Function.prototype.bind called on incompatible ",A_e=Object.prototype.toString,b_e=Math.max,w_e="[object Function]",XF=function(e,t){for(var i=[],r=0;r<e.length;r+=1)i[r]=e[r];for(var s=0;s<t.length;s+=1)i[s+e.length]=t[s];return i},x_e=function(e,t){for(var i=[],r=t||0,s=0;r<e.length;r+=1,s+=1)i[s]=e[r];return i},C_e=function(n,e){for(var t="",i=0;i<n.length;i+=1)t+=n[i],i+1<n.length&&(t+=e);return t},E_e=function(e){var t=this;if(typeof t!="function"||A_e.apply(t)!==w_e)throw new TypeError(y_e+t);for(var i=x_e(arguments,1),r,s=function(){if(this instanceof r){var u=t.apply(this,XF(i,arguments));return Object(u)===u?u:this}return t.apply(e,XF(i,arguments))},o=b_e(0,t.length-i.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(r=Function("binder","return function ("+C_e(a,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var c=function(){};c.prototype=t.prototype,r.prototype=new c,c.prototype=null}return r},T_e=E_e,fL=Function.prototype.bind||T_e,I_e=Function.prototype.call,S_e=Object.prototype.hasOwnProperty,P_e=fL,M_e=P_e.call(I_e,S_e),Bn,xv=SyntaxError,BQ=Function,Dm=TypeError,yS=function(n){try{return BQ('"use strict"; return ('+n+").constructor;")()}catch{}},hp=Object.getOwnPropertyDescriptor;if(hp)try{hp({},"")}catch{hp=null}var AS=function(){throw new Dm},R_e=hp?function(){try{return arguments.callee,AS}catch{try{return hp(arguments,"callee").get}catch{return AS}}}():AS,Ig=m_e(),D_e=__e(),os=Object.getPrototypeOf||(D_e?function(n){return n.__proto__}:null),om={},k_e=typeof Uint8Array>"u"||!os?Bn:os(Uint8Array),dp={"%AggregateError%":typeof AggregateError>"u"?Bn:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Bn:ArrayBuffer,"%ArrayIteratorPrototype%":Ig&&os?os([][Symbol.iterator]()):Bn,"%AsyncFromSyncIteratorPrototype%":Bn,"%AsyncFunction%":om,"%AsyncGenerator%":om,"%AsyncGeneratorFunction%":om,"%AsyncIteratorPrototype%":om,"%Atomics%":typeof Atomics>"u"?Bn:Atomics,"%BigInt%":typeof BigInt>"u"?Bn:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Bn:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Bn:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Bn:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Bn:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Bn:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Bn:FinalizationRegistry,"%Function%":BQ,"%GeneratorFunction%":om,"%Int8Array%":typeof Int8Array>"u"?Bn:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Bn:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Bn:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ig&&os?os(os([][Symbol.iterator]())):Bn,"%JSON%":typeof JSON=="object"?JSON:Bn,"%Map%":typeof Map>"u"?Bn:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ig||!os?Bn:os(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Bn:Promise,"%Proxy%":typeof Proxy>"u"?Bn:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Bn:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Bn:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ig||!os?Bn:os(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Bn:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ig&&os?os(""[Symbol.iterator]()):Bn,"%Symbol%":Ig?Symbol:Bn,"%SyntaxError%":xv,"%ThrowTypeError%":R_e,"%TypedArray%":k_e,"%TypeError%":Dm,"%Uint8Array%":typeof Uint8Array>"u"?Bn:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Bn:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Bn:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Bn:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Bn:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Bn:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Bn:WeakSet};if(os)try{null.error}catch(n){var O_e=os(os(n));dp["%Error.prototype%"]=O_e}var L_e=function n(e){var t;if(e==="%AsyncFunction%")t=yS("async function () {}");else if(e==="%GeneratorFunction%")t=yS("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=yS("async function* () {}");else if(e==="%AsyncGenerator%"){var i=n("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var r=n("%AsyncGenerator%");r&&os&&(t=os(r.prototype))}return dp[e]=t,t},YF={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ib=fL,AC=M_e,N_e=ib.call(Function.call,Array.prototype.concat),B_e=ib.call(Function.apply,Array.prototype.splice),qF=ib.call(Function.call,String.prototype.replace),bC=ib.call(Function.call,String.prototype.slice),F_e=ib.call(Function.call,RegExp.prototype.exec),U_e=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,G_e=/\\(\\)?/g,H_e=function(e){var t=bC(e,0,1),i=bC(e,-1);if(t==="%"&&i!=="%")throw new xv("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new xv("invalid intrinsic syntax, expected opening `%`");var r=[];return qF(e,U_e,function(s,o,a,l){r[r.length]=a?qF(l,G_e,"$1"):o||s}),r},V_e=function(e,t){var i=e,r;if(AC(YF,i)&&(r=YF[i],i="%"+r[0]+"%"),AC(dp,i)){var s=dp[i];if(s===om&&(s=L_e(i)),typeof s>"u"&&!t)throw new Dm("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:s}}throw new xv("intrinsic "+e+" does not exist!")},hg=function(e,t){if(typeof e!="string"||e.length===0)throw new Dm("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Dm('"allowMissing" argument must be a boolean');if(F_e(/^%?[^%]*%?$/,e)===null)throw new xv("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=H_e(e),r=i.length>0?i[0]:"",s=V_e("%"+r+"%",t),o=s.name,a=s.value,l=!1,c=s.alias;c&&(r=c[0],B_e(i,N_e([0,1],c)));for(var u=1,h=!0;u<i.length;u+=1){var d=i[u],f=bC(d,0,1),p=bC(d,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new xv("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(l=!0),r+="."+d,o="%"+r+"%",AC(dp,o))a=dp[o];else if(a!=null){if(!(d in a)){if(!t)throw new Dm("base intrinsic for "+e+" exists, but the property is not available.");return}if(hp&&u+1>=i.length){var g=hp(a,d);h=!!g,h&&"get"in g&&!("originalValue"in g.get)?a=g.get:a=a[d]}else h=AC(a,d),a=a[d];h&&!l&&(dp[o]=a)}}return a},FQ={exports:{}},z_e=hg,GM=z_e("%Object.defineProperty%",!0),HM=function(){if(GM)try{return GM({},"a",{value:1}),!0}catch{return!1}return!1};HM.hasArrayLengthDefineBug=function(){if(!HM())return null;try{return GM([],"length",{value:1}).length!==1}catch{return!0}};var UQ=HM,$_e=hg,kx=$_e("%Object.getOwnPropertyDescriptor%",!0);if(kx)try{kx([],"length")}catch{kx=null}var GQ=kx,W_e=UQ(),pL=hg,yy=W_e&&pL("%Object.defineProperty%",!0);if(yy)try{yy({},"a",{value:1})}catch{yy=!1}var j_e=pL("%SyntaxError%"),Sg=pL("%TypeError%"),KF=GQ,Q_e=function(e,t,i){if(!e||typeof e!="object"&&typeof e!="function")throw new Sg("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new Sg("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Sg("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Sg("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Sg("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Sg("`loose`, if provided, must be a boolean");var r=arguments.length>3?arguments[3]:null,s=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!KF&&KF(e,t);if(yy)yy(e,t,{configurable:o===null&&l?l.configurable:!o,enumerable:r===null&&l?l.enumerable:!r,value:i,writable:s===null&&l?l.writable:!s});else if(a||!r&&!s&&!o)e[t]=i;else throw new j_e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},HQ=hg,JF=Q_e,X_e=UQ(),ZF=GQ,eU=HQ("%TypeError%"),Y_e=HQ("%Math.floor%"),q_e=function(e,t){if(typeof e!="function")throw new eU("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||Y_e(t)!==t)throw new eU("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],r=!0,s=!0;if("length"in e&&ZF){var o=ZF(e,"length");o&&!o.configurable&&(r=!1),o&&!o.writable&&(s=!1)}return(r||s||!i)&&(X_e?JF(e,"length",t,!0,!0):JF(e,"length",t)),e};(function(n){var e=fL,t=hg,i=q_e,r=t("%TypeError%"),s=t("%Function.prototype.apply%"),o=t("%Function.prototype.call%"),a=t("%Reflect.apply%",!0)||e.call(o,s),l=t("%Object.defineProperty%",!0),c=t("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}n.exports=function(d){if(typeof d!="function")throw new r("a function is required");var f=a(e,o,arguments);return i(f,1+c(0,d.length-(arguments.length-1)),!0)};var u=function(){return a(e,s,arguments)};l?l(n.exports,"apply",{value:u}):n.exports.apply=u})(FQ);var K_e=FQ.exports,VQ=hg,zQ=K_e,J_e=zQ(VQ("String.prototype.indexOf")),Z_e=function(e,t){var i=VQ(e,!!t);return typeof i=="function"&&J_e(e,".prototype.")>-1?zQ(i):i};const eye={},tye=Object.freeze(Object.defineProperty({__proto__:null,default:eye},Symbol.toStringTag,{value:"Module"})),nye=iO(tye);var gL=typeof Map=="function"&&Map.prototype,bS=Object.getOwnPropertyDescriptor&&gL?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,wC=gL&&bS&&typeof bS.get=="function"?bS.get:null,tU=gL&&Map.prototype.forEach,mL=typeof Set=="function"&&Set.prototype,wS=Object.getOwnPropertyDescriptor&&mL?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,xC=mL&&wS&&typeof wS.get=="function"?wS.get:null,nU=mL&&Set.prototype.forEach,iye=typeof WeakMap=="function"&&WeakMap.prototype,Ay=iye?WeakMap.prototype.has:null,rye=typeof WeakSet=="function"&&WeakSet.prototype,by=rye?WeakSet.prototype.has:null,sye=typeof WeakRef=="function"&&WeakRef.prototype,iU=sye?WeakRef.prototype.deref:null,oye=Boolean.prototype.valueOf,aye=Object.prototype.toString,lye=Function.prototype.toString,cye=String.prototype.match,vL=String.prototype.slice,rd=String.prototype.replace,uye=String.prototype.toUpperCase,rU=String.prototype.toLowerCase,$Q=RegExp.prototype.test,sU=Array.prototype.concat,Cc=Array.prototype.join,hye=Array.prototype.slice,oU=Math.floor,VM=typeof BigInt=="function"?BigInt.prototype.valueOf:null,xS=Object.getOwnPropertySymbols,zM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ro=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Cv||!0)?Symbol.toStringTag:null,WQ=Object.prototype.propertyIsEnumerable,aU=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function lU(n,e){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||$Q.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var i=n<0?-oU(-n):oU(n);if(i!==n){var r=String(i),s=vL.call(e,r.length+1);return rd.call(r,t,"$&_")+"."+rd.call(rd.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return rd.call(e,t,"$&_")}var $M=nye,cU=$M.custom,uU=QQ(cU)?cU:null,dye=function n(e,t,i,r){var s=t||{};if(Nh(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Nh(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Nh(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Nh(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Nh(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return YQ(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?lU(e,l):l}if(typeof e=="bigint"){var c=String(e)+"n";return a?lU(e,c):c}var u=typeof s.depth>"u"?5:s.depth;if(typeof i>"u"&&(i=0),i>=u&&u>0&&typeof e=="object")return WM(e)?"[Array]":"[Object]";var h=Mye(s,i);if(typeof r>"u")r=[];else if(XQ(r,e)>=0)return"[Circular]";function d(G,B,R){if(B&&(r=hye.call(r),r.push(B)),R){var P={depth:s.depth};return Nh(s,"quoteStyle")&&(P.quoteStyle=s.quoteStyle),n(G,P,i+1,r)}return n(G,s,i+1,r)}if(typeof e=="function"&&!hU(e)){var f=bye(e),p=Hb(e,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+Cc.call(p,", ")+" }":"")}if(QQ(e)){var g=Cv?rd.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):zM.call(e);return typeof e=="object"&&!Cv?R_(g):g}if(Iye(e)){for(var m="<"+rU.call(String(e.nodeName)),v=e.attributes||[],_=0;_<v.length;_++)m+=" "+v[_].name+"="+jQ(fye(v[_].value),"double",s);return m+=">",e.childNodes&&e.childNodes.length&&(m+="..."),m+="</"+rU.call(String(e.nodeName))+">",m}if(WM(e)){if(e.length===0)return"[]";var y=Hb(e,d);return h&&!Pye(y)?"["+jM(y,h)+"]":"[ "+Cc.call(y,", ")+" ]"}if(gye(e)){var A=Hb(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!WQ.call(e,"cause")?"{ ["+String(e)+"] "+Cc.call(sU.call("[cause]: "+d(e.cause),A),", ")+" }":A.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Cc.call(A,", ")+" }"}if(typeof e=="object"&&o){if(uU&&typeof e[uU]=="function"&&$M)return $M(e,{depth:u-i});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(wye(e)){var w=[];return tU&&tU.call(e,function(G,B){w.push(d(B,e,!0)+" => "+d(G,e))}),dU("Map",wC.call(e),w,h)}if(Eye(e)){var b=[];return nU&&nU.call(e,function(G){b.push(d(G,e))}),dU("Set",xC.call(e),b,h)}if(xye(e))return CS("WeakMap");if(Tye(e))return CS("WeakSet");if(Cye(e))return CS("WeakRef");if(vye(e))return R_(d(Number(e)));if(yye(e))return R_(d(VM.call(e)));if(_ye(e))return R_(oye.call(e));if(mye(e))return R_(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===un)return"{ [object globalThis] }";if(!pye(e)&&!hU(e)){var C=Hb(e,d),I=aU?aU(e)===Object.prototype:e instanceof Object||e.constructor===Object,x=e instanceof Object?"":"null prototype",T=!I&&ro&&Object(e)===e&&ro in e?vL.call(Nd(e),8,-1):x?"Object":"",O=I||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",F=O+(T||x?"["+Cc.call(sU.call([],T||[],x||[]),": ")+"] ":"");return C.length===0?F+"{}":h?F+"{"+jM(C,h)+"}":F+"{ "+Cc.call(C,", ")+" }"}return String(e)};function jQ(n,e,t){var i=(t.quoteStyle||e)==="double"?'"':"'";return i+n+i}function fye(n){return rd.call(String(n),/"/g,"&quot;")}function WM(n){return Nd(n)==="[object Array]"&&(!ro||!(typeof n=="object"&&ro in n))}function pye(n){return Nd(n)==="[object Date]"&&(!ro||!(typeof n=="object"&&ro in n))}function hU(n){return Nd(n)==="[object RegExp]"&&(!ro||!(typeof n=="object"&&ro in n))}function gye(n){return Nd(n)==="[object Error]"&&(!ro||!(typeof n=="object"&&ro in n))}function mye(n){return Nd(n)==="[object String]"&&(!ro||!(typeof n=="object"&&ro in n))}function vye(n){return Nd(n)==="[object Number]"&&(!ro||!(typeof n=="object"&&ro in n))}function _ye(n){return Nd(n)==="[object Boolean]"&&(!ro||!(typeof n=="object"&&ro in n))}function QQ(n){if(Cv)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!zM)return!1;try{return zM.call(n),!0}catch{}return!1}function yye(n){if(!n||typeof n!="object"||!VM)return!1;try{return VM.call(n),!0}catch{}return!1}var Aye=Object.prototype.hasOwnProperty||function(n){return n in this};function Nh(n,e){return Aye.call(n,e)}function Nd(n){return aye.call(n)}function bye(n){if(n.name)return n.name;var e=cye.call(lye.call(n),/^function\s*([\w$]+)/);return e?e[1]:null}function XQ(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,i=n.length;t<i;t++)if(n[t]===e)return t;return-1}function wye(n){if(!wC||!n||typeof n!="object")return!1;try{wC.call(n);try{xC.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function xye(n){if(!Ay||!n||typeof n!="object")return!1;try{Ay.call(n,Ay);try{by.call(n,by)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function Cye(n){if(!iU||!n||typeof n!="object")return!1;try{return iU.call(n),!0}catch{}return!1}function Eye(n){if(!xC||!n||typeof n!="object")return!1;try{xC.call(n);try{wC.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function Tye(n){if(!by||!n||typeof n!="object")return!1;try{by.call(n,by);try{Ay.call(n,Ay)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function Iye(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function YQ(n,e){if(n.length>e.maxStringLength){var t=n.length-e.maxStringLength,i="... "+t+" more character"+(t>1?"s":"");return YQ(vL.call(n,0,e.maxStringLength),e)+i}var r=rd.call(rd.call(n,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Sye);return jQ(r,"single",e)}function Sye(n){var e=n.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+uye.call(e.toString(16))}function R_(n){return"Object("+n+")"}function CS(n){return n+" { ? }"}function dU(n,e,t,i){var r=i?jM(t,i):Cc.call(t,", ");return n+" ("+e+") {"+r+"}"}function Pye(n){for(var e=0;e<n.length;e++)if(XQ(n[e],`
`)>=0)return!1;return!0}function Mye(n,e){var t;if(n.indent==="	")t="	";else if(typeof n.indent=="number"&&n.indent>0)t=Cc.call(Array(n.indent+1)," ");else return null;return{base:t,prev:Cc.call(Array(e+1),t)}}function jM(n,e){if(n.length===0)return"";var t=`
`+e.prev+e.base;return t+Cc.call(n,","+t)+`
`+e.prev}function Hb(n,e){var t=WM(n),i=[];if(t){i.length=n.length;for(var r=0;r<n.length;r++)i[r]=Nh(n,r)?e(n[r],n):""}var s=typeof xS=="function"?xS(n):[],o;if(Cv){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in n)Nh(n,l)&&(t&&String(Number(l))===l&&l<n.length||Cv&&o["$"+l]instanceof Symbol||($Q.call(/[^\w$]/,l)?i.push(e(l,n)+": "+e(n[l],n)):i.push(l+": "+e(n[l],n))));if(typeof xS=="function")for(var c=0;c<s.length;c++)WQ.call(n,s[c])&&i.push("["+e(s[c])+"]: "+e(n[s[c]],n));return i}var _L=hg,r_=Z_e,Rye=dye,Dye=_L("%TypeError%"),Vb=_L("%WeakMap%",!0),zb=_L("%Map%",!0),kye=r_("WeakMap.prototype.get",!0),Oye=r_("WeakMap.prototype.set",!0),Lye=r_("WeakMap.prototype.has",!0),Nye=r_("Map.prototype.get",!0),Bye=r_("Map.prototype.set",!0),Fye=r_("Map.prototype.has",!0),yL=function(n,e){for(var t=n,i;(i=t.next)!==null;t=i)if(i.key===e)return t.next=i.next,i.next=n.next,n.next=i,i},Uye=function(n,e){var t=yL(n,e);return t&&t.value},Gye=function(n,e,t){var i=yL(n,e);i?i.value=t:n.next={key:e,next:n.next,value:t}},Hye=function(n,e){return!!yL(n,e)},Vye=function(){var e,t,i,r={assert:function(s){if(!r.has(s))throw new Dye("Side channel does not contain "+Rye(s))},get:function(s){if(Vb&&s&&(typeof s=="object"||typeof s=="function")){if(e)return kye(e,s)}else if(zb){if(t)return Nye(t,s)}else if(i)return Uye(i,s)},has:function(s){if(Vb&&s&&(typeof s=="object"||typeof s=="function")){if(e)return Lye(e,s)}else if(zb){if(t)return Fye(t,s)}else if(i)return Hye(i,s);return!1},set:function(s,o){Vb&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new Vb),Oye(e,s,o)):zb?(t||(t=new zb),Bye(t,s,o)):(i||(i={key:{},next:null}),Gye(i,s,o))}};return r},zye=String.prototype.replace,$ye=/%20/g,ES={RFC1738:"RFC1738",RFC3986:"RFC3986"},AL={default:ES.RFC3986,formatters:{RFC1738:function(n){return zye.call(n,$ye,"+")},RFC3986:function(n){return String(n)}},RFC1738:ES.RFC1738,RFC3986:ES.RFC3986},Wye=AL,TS=Object.prototype.hasOwnProperty,_f=Array.isArray,uc=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),jye=function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(_f(i)){for(var r=[],s=0;s<i.length;++s)typeof i[s]<"u"&&r.push(i[s]);t.obj[t.prop]=r}}},qQ=function(e,t){for(var i=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)typeof e[r]<"u"&&(i[r]=e[r]);return i},Qye=function n(e,t,i){if(!t)return e;if(typeof t!="object"){if(_f(e))e.push(t);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!TS.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var r=e;return _f(e)&&!_f(t)&&(r=qQ(e,i)),_f(e)&&_f(t)?(t.forEach(function(s,o){if(TS.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=n(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var a=t[o];return TS.call(s,o)?s[o]=n(s[o],a,i):s[o]=a,s},r)},Xye=function(e,t){return Object.keys(t).reduce(function(i,r){return i[r]=t[r],i},e)},Yye=function(n,e,t){var i=n.replace(/\+/g," ");if(t==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},qye=function(e,t,i,r,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var c=o.charCodeAt(l);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||s===Wye.RFC1738&&(c===40||c===41)){a+=o.charAt(l);continue}if(c<128){a=a+uc[c];continue}if(c<2048){a=a+(uc[192|c>>6]+uc[128|c&63]);continue}if(c<55296||c>=57344){a=a+(uc[224|c>>12]+uc[128|c>>6&63]+uc[128|c&63]);continue}l+=1,c=65536+((c&1023)<<10|o.charCodeAt(l)&1023),a+=uc[240|c>>18]+uc[128|c>>12&63]+uc[128|c>>6&63]+uc[128|c&63]}return a},Kye=function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],r=0;r<t.length;++r)for(var s=t[r],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var c=a[l],u=o[c];typeof u=="object"&&u!==null&&i.indexOf(u)===-1&&(t.push({obj:o,prop:c}),i.push(u))}return jye(t),e},Jye=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Zye=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},eAe=function(e,t){return[].concat(e,t)},tAe=function(e,t){if(_f(e)){for(var i=[],r=0;r<e.length;r+=1)i.push(t(e[r]));return i}return t(e)},KQ={arrayToObject:qQ,assign:Xye,combine:eAe,compact:Kye,decode:Yye,encode:qye,isBuffer:Zye,isRegExp:Jye,maybeMap:tAe,merge:Qye},JQ=Vye,Ox=KQ,wy=AL,nAe=Object.prototype.hasOwnProperty,fU={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},yu=Array.isArray,iAe=Array.prototype.push,ZQ=function(n,e){iAe.apply(n,yu(e)?e:[e])},rAe=Date.prototype.toISOString,pU=wy.default,js={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Ox.encode,encodeValuesOnly:!1,format:pU,formatter:wy.formatters[pU],indices:!1,serializeDate:function(e){return rAe.call(e)},skipNulls:!1,strictNullHandling:!1},sAe=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},IS={},oAe=function n(e,t,i,r,s,o,a,l,c,u,h,d,f,p,g,m){for(var v=e,_=m,y=0,A=!1;(_=_.get(IS))!==void 0&&!A;){var w=_.get(e);if(y+=1,typeof w<"u"){if(w===y)throw new RangeError("Cyclic object value");A=!0}typeof _.get(IS)>"u"&&(y=0)}if(typeof l=="function"?v=l(t,v):v instanceof Date?v=h(v):i==="comma"&&yu(v)&&(v=Ox.maybeMap(v,function(P){return P instanceof Date?h(P):P})),v===null){if(s)return a&&!p?a(t,js.encoder,g,"key",d):t;v=""}if(sAe(v)||Ox.isBuffer(v)){if(a){var b=p?t:a(t,js.encoder,g,"key",d);return[f(b)+"="+f(a(v,js.encoder,g,"value",d))]}return[f(t)+"="+f(String(v))]}var C=[];if(typeof v>"u")return C;var I;if(i==="comma"&&yu(v))p&&a&&(v=Ox.maybeMap(v,a)),I=[{value:v.length>0?v.join(",")||null:void 0}];else if(yu(l))I=l;else{var x=Object.keys(v);I=c?x.sort(c):x}for(var T=r&&yu(v)&&v.length===1?t+"[]":t,O=0;O<I.length;++O){var F=I[O],G=typeof F=="object"&&typeof F.value<"u"?F.value:v[F];if(!(o&&G===null)){var B=yu(v)?typeof i=="function"?i(T,F):T:T+(u?"."+F:"["+F+"]");m.set(e,y);var R=JQ();R.set(IS,m),ZQ(C,n(G,B,i,r,s,o,i==="comma"&&p&&yu(v)?null:a,l,c,u,h,d,f,p,g,R))}}return C},aAe=function(e){if(!e)return js;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||js.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=wy.default;if(typeof e.format<"u"){if(!nAe.call(wy.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=wy.formatters[i],s=js.filter;return(typeof e.filter=="function"||yu(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:js.addQueryPrefix,allowDots:typeof e.allowDots>"u"?js.allowDots:!!e.allowDots,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:js.charsetSentinel,delimiter:typeof e.delimiter>"u"?js.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:js.encode,encoder:typeof e.encoder=="function"?e.encoder:js.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:js.encodeValuesOnly,filter:s,format:i,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:js.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:js.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:js.strictNullHandling}},lAe=function(n,e){var t=n,i=aAe(e),r,s;typeof i.filter=="function"?(s=i.filter,t=s("",t)):yu(i.filter)&&(s=i.filter,r=s);var o=[];if(typeof t!="object"||t===null)return"";var a;e&&e.arrayFormat in fU?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var l=fU[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var c=l==="comma"&&e&&e.commaRoundTrip;r||(r=Object.keys(t)),i.sort&&r.sort(i.sort);for(var u=JQ(),h=0;h<r.length;++h){var d=r[h];i.skipNulls&&t[d]===null||ZQ(o,oAe(t[d],d,l,c,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,u))}var f=o.join(i.delimiter),p=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""},Ev=KQ,QM=Object.prototype.hasOwnProperty,cAe=Array.isArray,ns={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Ev.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},uAe=function(n){return n.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},eX=function(n,e){return n&&typeof n=="string"&&e.comma&&n.indexOf(",")>-1?n.split(","):n},hAe="utf8=%26%2310003%3B",dAe="utf8=%E2%9C%93",fAe=function(e,t){var i={__proto__:null},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=r.split(t.delimiter,s),a=-1,l,c=t.charset;if(t.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===dAe?c="utf-8":o[l]===hAe&&(c="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var u=o[l],h=u.indexOf("]="),d=h===-1?u.indexOf("="):h+1,f,p;d===-1?(f=t.decoder(u,ns.decoder,c,"key"),p=t.strictNullHandling?null:""):(f=t.decoder(u.slice(0,d),ns.decoder,c,"key"),p=Ev.maybeMap(eX(u.slice(d+1),t),function(g){return t.decoder(g,ns.decoder,c,"value")})),p&&t.interpretNumericEntities&&c==="iso-8859-1"&&(p=uAe(p)),u.indexOf("[]=")>-1&&(p=cAe(p)?[p]:p),QM.call(i,f)?i[f]=Ev.combine(i[f],p):i[f]=p}return i},pAe=function(n,e,t,i){for(var r=i?e:eX(e,t),s=n.length-1;s>=0;--s){var o,a=n[s];if(a==="[]"&&t.parseArrays)o=[].concat(r);else{o=t.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,c=parseInt(l,10);!t.parseArrays&&l===""?o={0:r}:!isNaN(c)&&a!==l&&String(c)===l&&c>=0&&t.parseArrays&&c<=t.arrayLimit?(o=[],o[c]=r):l!=="__proto__"&&(o[l]=r)}r=o}return r},gAe=function(e,t,i,r){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=i.depth>0&&o.exec(s),c=l?s.slice(0,l.index):s,u=[];if(c){if(!i.plainObjects&&QM.call(Object.prototype,c)&&!i.allowPrototypes)return;u.push(c)}for(var h=0;i.depth>0&&(l=a.exec(s))!==null&&h<i.depth;){if(h+=1,!i.plainObjects&&QM.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;u.push(l[1])}return l&&u.push("["+s.slice(l.index)+"]"),pAe(u,t,i,r)}},mAe=function(e){if(!e)return ns;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?ns.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?ns.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:ns.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:ns.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:ns.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ns.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:ns.comma,decoder:typeof e.decoder=="function"?e.decoder:ns.decoder,delimiter:typeof e.delimiter=="string"||Ev.isRegExp(e.delimiter)?e.delimiter:ns.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:ns.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:ns.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:ns.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:ns.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ns.strictNullHandling}},vAe=function(n,e){var t=mAe(e);if(n===""||n===null||typeof n>"u")return t.plainObjects?Object.create(null):{};for(var i=typeof n=="string"?fAe(n,t):n,r=t.plainObjects?Object.create(null):{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],l=gAe(a,i[a],t,typeof n=="string");r=Ev.merge(r,l,t)}return t.allowSparse===!0?r:Ev.compact(r)},_Ae=lAe,yAe=vAe,AAe=AL,bAe={formats:AAe,parse:yAe,stringify:_Ae},wAe=f_e;function Yl(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var xAe=/^([a-z0-9.+-]+:)/i,CAe=/:[0-9]*$/,EAe=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,TAe=["<",">",'"',"`"," ","\r",`
`,"	"],IAe=["{","}","|","\\","^","`"].concat(TAe),XM=["'"].concat(IAe),gU=["%","/","?",";","#"].concat(XM),mU=["/","?","#"],SAe=255,vU=/^[+a-z0-9A-Z_-]{0,63}$/,PAe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,MAe={javascript:!0,"javascript:":!0},YM={javascript:!0,"javascript:":!0},km={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},qM=bAe;function JT(n,e,t){if(n&&typeof n=="object"&&n instanceof Yl)return n;var i=new Yl;return i.parse(n,e,t),i}Yl.prototype.parse=function(n,e,t){if(typeof n!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var i=n.indexOf("?"),r=i!==-1&&i<n.indexOf("#")?"?":"#",s=n.split(r),o=/\\/g;s[0]=s[0].replace(o,"/"),n=s.join(r);var a=n;if(a=a.trim(),!t&&n.split("#").length===1){var l=EAe.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=qM.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var c=xAe.exec(a);if(c){c=c[0];var u=c.toLowerCase();this.protocol=u,a=a.substr(c.length)}if(t||c||a.match(/^\/\/[^@/]+@[^@/]+/)){var h=a.substr(0,2)==="//";h&&!(c&&YM[c])&&(a=a.substr(2),this.slashes=!0)}if(!YM[c]&&(h||c&&!km[c])){for(var d=-1,f=0;f<mU.length;f++){var p=a.indexOf(mU[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var g,m;d===-1?m=a.lastIndexOf("@"):m=a.lastIndexOf("@",d),m!==-1&&(g=a.slice(0,m),a=a.slice(m+1),this.auth=decodeURIComponent(g)),d=-1;for(var f=0;f<gU.length;f++){var p=a.indexOf(gU[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var v=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!v)for(var _=this.hostname.split(/\./),f=0,y=_.length;f<y;f++){var A=_[f];if(A&&!A.match(vU)){for(var w="",b=0,C=A.length;b<C;b++)A.charCodeAt(b)>127?w+="x":w+=A[b];if(!w.match(vU)){var I=_.slice(0,f),x=_.slice(f+1),T=A.match(PAe);T&&(I.push(T[1]),x.unshift(T[2])),x.length&&(a="/"+x.join(".")+a),this.hostname=I.join(".");break}}}this.hostname.length>SAe?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=wAe.toASCII(this.hostname));var O=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+O,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!MAe[u])for(var f=0,y=XM.length;f<y;f++){var G=XM[f];if(a.indexOf(G)!==-1){var B=encodeURIComponent(G);B===G&&(B=escape(G)),a=a.split(G).join(B)}}var R=a.indexOf("#");R!==-1&&(this.hash=a.substr(R),a=a.slice(0,R));var P=a.indexOf("?");if(P!==-1?(this.search=a.substr(P),this.query=a.substr(P+1),e&&(this.query=qM.parse(this.query)),a=a.slice(0,P)):e&&(this.search="",this.query={}),a&&(this.pathname=a),km[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var O=this.pathname||"",k=this.search||"";this.path=O+k}return this.href=this.format(),this};function RAe(n){return typeof n=="string"&&(n=JT(n)),n instanceof Yl?n.format():Yl.prototype.format.call(n)}Yl.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var e=this.protocol||"",t=this.pathname||"",i=this.hash||"",r=!1,s="";this.host?r=n+this.host:this.hostname&&(r=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=qM.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||km[e])&&r!==!1?(r="//"+(r||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):r||(r=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+r+t+o+i};function DAe(n,e){return JT(n,!1,!0).resolve(e)}Yl.prototype.resolve=function(n){return this.resolveObject(JT(n,!1,!0)).format()};Yl.prototype.resolveObject=function(n){if(typeof n=="string"){var e=new Yl;e.parse(n,!1,!0),n=e}for(var t=new Yl,i=Object.keys(this),r=0;r<i.length;r++){var s=i[r];t[s]=this[s]}if(t.hash=n.hash,n.href==="")return t.href=t.format(),t;if(n.slashes&&!n.protocol){for(var o=Object.keys(n),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(t[l]=n[l])}return km[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(n.protocol&&n.protocol!==t.protocol){if(!km[n.protocol]){for(var c=Object.keys(n),u=0;u<c.length;u++){var h=c[u];t[h]=n[h]}return t.href=t.format(),t}if(t.protocol=n.protocol,!n.host&&!YM[n.protocol]){for(var y=(n.pathname||"").split("/");y.length&&!(n.host=y.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),y[0]!==""&&y.unshift(""),y.length<2&&y.unshift(""),t.pathname=y.join("/")}else t.pathname=n.pathname;if(t.search=n.search,t.query=n.query,t.host=n.host||"",t.auth=n.auth,t.hostname=n.hostname||n.host,t.port=n.port,t.pathname||t.search){var d=t.pathname||"",f=t.search||"";t.path=d+f}return t.slashes=t.slashes||n.slashes,t.href=t.format(),t}var p=t.pathname&&t.pathname.charAt(0)==="/",g=n.host||n.pathname&&n.pathname.charAt(0)==="/",m=g||p||t.host&&n.pathname,v=m,_=t.pathname&&t.pathname.split("/")||[],y=n.pathname&&n.pathname.split("/")||[],A=t.protocol&&!km[t.protocol];if(A&&(t.hostname="",t.port=null,t.host&&(_[0]===""?_[0]=t.host:_.unshift(t.host)),t.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(y[0]===""?y[0]=n.host:y.unshift(n.host)),n.host=null),m=m&&(y[0]===""||_[0]==="")),g)t.host=n.host||n.host===""?n.host:t.host,t.hostname=n.hostname||n.hostname===""?n.hostname:t.hostname,t.search=n.search,t.query=n.query,_=y;else if(y.length)_||(_=[]),_.pop(),_=_.concat(y),t.search=n.search,t.query=n.query;else if(n.search!=null){if(A){t.host=_.shift(),t.hostname=t.host;var w=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;w&&(t.auth=w.shift(),t.hostname=w.shift(),t.host=t.hostname)}return t.search=n.search,t.query=n.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!_.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var b=_.slice(-1)[0],C=(t.host||n.host||_.length>1)&&(b==="."||b==="..")||b==="",I=0,x=_.length;x>=0;x--)b=_[x],b==="."?_.splice(x,1):b===".."?(_.splice(x,1),I++):I&&(_.splice(x,1),I--);if(!m&&!v)for(;I--;I)_.unshift("..");m&&_[0]!==""&&(!_[0]||_[0].charAt(0)!=="/")&&_.unshift(""),C&&_.join("/").substr(-1)!=="/"&&_.push("");var T=_[0]===""||_[0]&&_[0].charAt(0)==="/";if(A){t.hostname=T?"":_.length?_.shift():"",t.host=t.hostname;var w=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;w&&(t.auth=w.shift(),t.hostname=w.shift(),t.host=t.hostname)}return m=m||t.host&&_.length,m&&!T&&_.unshift(""),_.length>0?t.pathname=_.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=n.auth||t.auth,t.slashes=t.slashes||n.slashes,t.href=t.format(),t};Yl.prototype.parseHost=function(){var n=this.host,e=CAe.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};var kAe=JT,OAe=DAe,LAe=RAe;/*!
 * @pixi/constants - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Zl;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(Zl||(Zl={}));var Tv;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})(Tv||(Tv={}));var hA;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(hA||(hA={}));var Xt;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(Xt||(Xt={}));var pa;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(pa||(pa={}));var At;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(At||(At={}));var md;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(md||(md={}));var qt;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(qt||(qt={}));var dA;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(dA||(dA={}));var ga;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(ga||(ga={}));var Oc;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(Oc||(Oc={}));var sl;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(sl||(sl={}));var ol;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(ol||(ol={}));var Au;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(Au||(Au={}));var CC;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(CC||(CC={}));var $l;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})($l||($l={}));var Lr;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(Lr||(Lr={}));var KM;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(KM||(KM={}));var Cr;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(Cr||(Cr={}));var ql;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(ql||(ql={}));/*!
 * @pixi/utils - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Rf={parse:kAe,format:LAe,resolve:OAe};function gl(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}function NAe(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function BAe(n,e,t){return n.replace(new RegExp(NAe(e),"g"),t)}function FAe(n,e){for(var t="",i=0,r=-1,s=0,o,a=0;a<=n.length;++a){if(a<n.length)o=n.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),r=a,s=0;continue}}else if(t.length===2||t.length===1){t="",i=0,r=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..",i=2)}else t.length>0?t+="/"+n.slice(r+1,a):t=n.slice(r+1,a),i=a-r-1;r=a,s=0}else o===46&&s!==-1?++s:s=-1}return t}var tX={toPosix:function(n){return BAe(n,"\\","/")},isUrl:function(n){return/^https?:/.test(this.toPosix(n))},isDataUrl:function(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},hasProtocol:function(n){return/^[^/:]+:\//.test(this.toPosix(n))},getProtocol:function(n){gl(n),n=this.toPosix(n);var e="",t=/^file:\/\/\//.exec(n),i=/^[^/:]+:\/\//.exec(n),r=/^[^/:]+:\//.exec(n);if(t||i||r){var s=(t==null?void 0:t[0])||(i==null?void 0:i[0])||(r==null?void 0:r[0]);e=s,n=n.slice(s.length)}return e},toAbsolute:function(n,e,t){if(this.isDataUrl(n))return n;var i=this.toPosix(e??xt.ADAPTER.getBaseUrl()),r=this.toPosix(t??this.rootname(i));if(gl(n),n=this.toPosix(n),n.startsWith("/"))return tX.join(r,n.slice(1));var s=this.isAbsolute(n)?n:this.join(i,n);return s},normalize:function(n){if(n=this.toPosix(n),gl(n),n.length===0)return".";var e="",t=n.startsWith("/");this.hasProtocol(n)&&(e=this.rootname(n),n=n.slice(e.length));var i=n.endsWith("/");return n=FAe(n,!1),n.length>0&&i&&(n+="/"),t?"/"+n:e+n},isAbsolute:function(n){return gl(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join:function(){for(var n=arguments,e=[],t=0;t<arguments.length;t++)e[t]=n[t];if(e.length===0)return".";for(var i,r=0;r<e.length;++r){var s=e[r];gl(s),s.length>0&&(i===void 0?i=s:i+="/"+s)}return i===void 0?".":this.normalize(i)},dirname:function(n){if(gl(n),n.length===0)return".";n=this.toPosix(n);var e=n.charCodeAt(0),t=e===47,i=-1,r=!0,s=this.getProtocol(n),o=n;n=n.slice(s.length);for(var a=n.length-1;a>=1;--a)if(e=n.charCodeAt(a),e===47){if(!r){i=a;break}}else r=!1;return i===-1?t?"/":this.isUrl(o)?s+n:s:t&&i===1?"//":s+n.slice(0,i)},rootname:function(n){gl(n),n=this.toPosix(n);var e="";if(n.startsWith("/")?e="/":e=this.getProtocol(n),this.isUrl(n)){var t=n.indexOf("/",e.length);t!==-1?e=n.slice(0,t):e=n,e.endsWith("/")||(e+="/")}return e},basename:function(n,e){gl(n),e&&gl(e),n=this.toPosix(n);var t=0,i=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e.length===n.length&&e===n)return"";var o=e.length-1,a=-1;for(s=n.length-1;s>=0;--s){var l=n.charCodeAt(s);if(l===47){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===47){if(!r){t=s+1;break}}else i===-1&&(r=!1,i=s+1);return i===-1?"":n.slice(t,i)},extname:function(n){gl(n),n=this.toPosix(n);for(var e=-1,t=0,i=-1,r=!0,s=0,o=n.length-1;o>=0;--o){var a=n.charCodeAt(o);if(a===47){if(!r){t=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":n.slice(e,i)},parse:function(n){gl(n);var e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;n=this.toPosix(n);var t=n.charCodeAt(0),i=this.isAbsolute(n),r;e.root=this.rootname(n),i||this.hasProtocol(n)?r=1:r=0;for(var s=-1,o=0,a=-1,l=!0,c=n.length-1,u=0;c>=r;--c){if(t=n.charCodeAt(c),t===47){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),t===46?s===-1?s=c:u!==1&&(u=1):s!==-1&&(u=-1)}return s===-1||a===-1||u===0||u===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&i?e.base=e.name=n.slice(1,a):e.base=e.name=n.slice(o,a)):(o===0&&i?(e.name=n.slice(1,s),e.base=n.slice(1,a)):(e.name=n.slice(o,s),e.base=n.slice(o,a)),e.ext=n.slice(s,a)),e.dir=this.dirname(n),e},sep:"/",delimiter:":"};xt.RETINA_PREFIX=/@([0-9\.]+)x/;xt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var JM=!1,_U="6.5.2";function UAe(){JM=!0}function nX(n){var e;if(!JM){if(xt.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var t=[`
 %c %c %c PixiJS `+_U+" - ✰ "+n+` ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=globalThis.console).log.apply(e,t)}else globalThis.console&&globalThis.console.log("PixiJS "+_U+" - "+n+" - http://www.pixijs.com/");JM=!0}}var SS;function iX(){return typeof SS>"u"&&(SS=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:xt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!xt.ADAPTER.getWebGLRenderingContext())return!1;var t=xt.ADAPTER.createCanvas(),i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),r=!!(i&&i.getContextAttributes().stencil);if(i){var s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,r}catch{return!1}}()),SS}var GAe="#f0f8ff",HAe="#faebd7",VAe="#00ffff",zAe="#7fffd4",$Ae="#f0ffff",WAe="#f5f5dc",jAe="#ffe4c4",QAe="#000000",XAe="#ffebcd",YAe="#0000ff",qAe="#8a2be2",KAe="#a52a2a",JAe="#deb887",ZAe="#5f9ea0",e0e="#7fff00",t0e="#d2691e",n0e="#ff7f50",i0e="#6495ed",r0e="#fff8dc",s0e="#dc143c",o0e="#00ffff",a0e="#00008b",l0e="#008b8b",c0e="#b8860b",u0e="#a9a9a9",h0e="#006400",d0e="#a9a9a9",f0e="#bdb76b",p0e="#8b008b",g0e="#556b2f",m0e="#ff8c00",v0e="#9932cc",_0e="#8b0000",y0e="#e9967a",A0e="#8fbc8f",b0e="#483d8b",w0e="#2f4f4f",x0e="#2f4f4f",C0e="#00ced1",E0e="#9400d3",T0e="#ff1493",I0e="#00bfff",S0e="#696969",P0e="#696969",M0e="#1e90ff",R0e="#b22222",D0e="#fffaf0",k0e="#228b22",O0e="#ff00ff",L0e="#dcdcdc",N0e="#f8f8ff",B0e="#daa520",F0e="#ffd700",U0e="#808080",G0e="#008000",H0e="#adff2f",V0e="#808080",z0e="#f0fff0",$0e="#ff69b4",W0e="#cd5c5c",j0e="#4b0082",Q0e="#fffff0",X0e="#f0e68c",Y0e="#fff0f5",q0e="#e6e6fa",K0e="#7cfc00",J0e="#fffacd",Z0e="#add8e6",ebe="#f08080",tbe="#e0ffff",nbe="#fafad2",ibe="#d3d3d3",rbe="#90ee90",sbe="#d3d3d3",obe="#ffb6c1",abe="#ffa07a",lbe="#20b2aa",cbe="#87cefa",ube="#778899",hbe="#778899",dbe="#b0c4de",fbe="#ffffe0",pbe="#00ff00",gbe="#32cd32",mbe="#faf0e6",vbe="#ff00ff",_be="#800000",ybe="#66cdaa",Abe="#0000cd",bbe="#ba55d3",wbe="#9370db",xbe="#3cb371",Cbe="#7b68ee",Ebe="#00fa9a",Tbe="#48d1cc",Ibe="#c71585",Sbe="#191970",Pbe="#f5fffa",Mbe="#ffe4e1",Rbe="#ffe4b5",Dbe="#ffdead",kbe="#000080",Obe="#fdf5e6",Lbe="#808000",Nbe="#6b8e23",Bbe="#ffa500",Fbe="#ff4500",Ube="#da70d6",Gbe="#eee8aa",Hbe="#98fb98",Vbe="#afeeee",zbe="#db7093",$be="#ffefd5",Wbe="#ffdab9",jbe="#cd853f",Qbe="#ffc0cb",Xbe="#dda0dd",Ybe="#b0e0e6",qbe="#800080",Kbe="#663399",Jbe="#ff0000",Zbe="#bc8f8f",ewe="#4169e1",twe="#8b4513",nwe="#fa8072",iwe="#f4a460",rwe="#2e8b57",swe="#fff5ee",owe="#a0522d",awe="#c0c0c0",lwe="#87ceeb",cwe="#6a5acd",uwe="#708090",hwe="#708090",dwe="#fffafa",fwe="#00ff7f",pwe="#4682b4",gwe="#d2b48c",mwe="#008080",vwe="#d8bfd8",_we="#ff6347",ywe="#40e0d0",Awe="#ee82ee",bwe="#f5deb3",wwe="#ffffff",xwe="#f5f5f5",Cwe="#ffff00",Ewe="#9acd32",Twe={aliceblue:GAe,antiquewhite:HAe,aqua:VAe,aquamarine:zAe,azure:$Ae,beige:WAe,bisque:jAe,black:QAe,blanchedalmond:XAe,blue:YAe,blueviolet:qAe,brown:KAe,burlywood:JAe,cadetblue:ZAe,chartreuse:e0e,chocolate:t0e,coral:n0e,cornflowerblue:i0e,cornsilk:r0e,crimson:s0e,cyan:o0e,darkblue:a0e,darkcyan:l0e,darkgoldenrod:c0e,darkgray:u0e,darkgreen:h0e,darkgrey:d0e,darkkhaki:f0e,darkmagenta:p0e,darkolivegreen:g0e,darkorange:m0e,darkorchid:v0e,darkred:_0e,darksalmon:y0e,darkseagreen:A0e,darkslateblue:b0e,darkslategray:w0e,darkslategrey:x0e,darkturquoise:C0e,darkviolet:E0e,deeppink:T0e,deepskyblue:I0e,dimgray:S0e,dimgrey:P0e,dodgerblue:M0e,firebrick:R0e,floralwhite:D0e,forestgreen:k0e,fuchsia:O0e,gainsboro:L0e,ghostwhite:N0e,goldenrod:B0e,gold:F0e,gray:U0e,green:G0e,greenyellow:H0e,grey:V0e,honeydew:z0e,hotpink:$0e,indianred:W0e,indigo:j0e,ivory:Q0e,khaki:X0e,lavenderblush:Y0e,lavender:q0e,lawngreen:K0e,lemonchiffon:J0e,lightblue:Z0e,lightcoral:ebe,lightcyan:tbe,lightgoldenrodyellow:nbe,lightgray:ibe,lightgreen:rbe,lightgrey:sbe,lightpink:obe,lightsalmon:abe,lightseagreen:lbe,lightskyblue:cbe,lightslategray:ube,lightslategrey:hbe,lightsteelblue:dbe,lightyellow:fbe,lime:pbe,limegreen:gbe,linen:mbe,magenta:vbe,maroon:_be,mediumaquamarine:ybe,mediumblue:Abe,mediumorchid:bbe,mediumpurple:wbe,mediumseagreen:xbe,mediumslateblue:Cbe,mediumspringgreen:Ebe,mediumturquoise:Tbe,mediumvioletred:Ibe,midnightblue:Sbe,mintcream:Pbe,mistyrose:Mbe,moccasin:Rbe,navajowhite:Dbe,navy:kbe,oldlace:Obe,olive:Lbe,olivedrab:Nbe,orange:Bbe,orangered:Fbe,orchid:Ube,palegoldenrod:Gbe,palegreen:Hbe,paleturquoise:Vbe,palevioletred:zbe,papayawhip:$be,peachpuff:Wbe,peru:jbe,pink:Qbe,plum:Xbe,powderblue:Ybe,purple:qbe,rebeccapurple:Kbe,red:Jbe,rosybrown:Zbe,royalblue:ewe,saddlebrown:twe,salmon:nwe,sandybrown:iwe,seagreen:rwe,seashell:swe,sienna:owe,silver:awe,skyblue:lwe,slateblue:cwe,slategray:uwe,slategrey:hwe,snow:dwe,springgreen:fwe,steelblue:pwe,tan:gwe,teal:mwe,thistle:vwe,tomato:_we,turquoise:ywe,violet:Awe,wheat:bwe,white:wwe,whitesmoke:xwe,yellow:Cwe,yellowgreen:Ewe};function _s(n,e){return e===void 0&&(e=[]),e[0]=(n>>16&255)/255,e[1]=(n>>8&255)/255,e[2]=(n&255)/255,e}function bL(n){var e=n.toString(16);return e="000000".substring(0,6-e.length)+e,"#"+e}function fA(n){return typeof n=="string"&&(n=Twe[n.toLowerCase()]||n,n[0]==="#"&&(n=n.slice(1))),parseInt(n,16)}function al(n){return(n[0]*255<<16)+(n[1]*255<<8)+(n[2]*255|0)}function Iwe(){for(var n=[],e=[],t=0;t<32;t++)n[t]=t,e[t]=t;n[Xt.NORMAL_NPM]=Xt.NORMAL,n[Xt.ADD_NPM]=Xt.ADD,n[Xt.SCREEN_NPM]=Xt.SCREEN,e[Xt.NORMAL]=Xt.NORMAL_NPM,e[Xt.ADD]=Xt.ADD_NPM,e[Xt.SCREEN]=Xt.SCREEN_NPM;var i=[];return i.push(e),i.push(n),i}var wL=Iwe();function xL(n,e){return wL[e?1:0][n]}function rX(n,e,t,i){return t=t||new Float32Array(4),i||i===void 0?(t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e):(t[0]=n[0],t[1]=n[1],t[2]=n[2]),t[3]=e,t}function ZT(n,e){if(e===1)return(e*255<<24)+n;if(e===0)return 0;var t=n>>16&255,i=n>>8&255,r=n&255;return t=t*e+.5|0,i=i*e+.5|0,r=r*e+.5|0,(e*255<<24)+(t<<16)+(i<<8)+r}function CL(n,e,t,i){return t=t||new Float32Array(4),t[0]=(n>>16&255)/255,t[1]=(n>>8&255)/255,t[2]=(n&255)/255,(i||i===void 0)&&(t[0]*=e,t[1]*=e,t[2]*=e),t[3]=e,t}function sX(n,e){e===void 0&&(e=null);var t=n*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+t);for(var i=0,r=0;i<t;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e}function eI(n){if(n.BYTES_PER_ELEMENT===4)return n instanceof Float32Array?"Float32Array":n instanceof Uint32Array?"Uint32Array":"Int32Array";if(n.BYTES_PER_ELEMENT===2){if(n instanceof Uint16Array)return"Uint16Array"}else if(n.BYTES_PER_ELEMENT===1&&n instanceof Uint8Array)return"Uint8Array";return null}var Swe={Float32Array,Uint32Array,Int32Array,Uint8Array};function Pwe(n,e){for(var t=0,i=0,r={},s=0;s<n.length;s++)i+=e[s],t+=n[s].length;for(var o=new ArrayBuffer(t*4),a=null,l=0,s=0;s<n.length;s++){var c=e[s],u=n[s],h=eI(u);r[h]||(r[h]=new Swe[h](o)),a=r[h];for(var d=0;d<u.length;d++){var f=(d/c|0)*i+l,p=d%c;a[f+p]=u[d]}l+=c}return new Float32Array(o)}function pA(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function ZM(n){return!(n&n-1)&&!!n}function eR(n){var e=(n>65535?1:0)<<4;n>>>=e;var t=(n>255?1:0)<<3;return n>>>=t,e|=t,t=(n>15?1:0)<<2,n>>>=t,e|=t,t=(n>3?1:0)<<1,n>>>=t,e|=t,e|n>>1}function fp(n,e,t){var i=n.length,r;if(!(e>=i||t===0)){t=e+t>i?i-e:t;var s=i-t;for(r=e;r<s;++r)n[r]=n[r+t];n.length=s}}function Df(n){return n===0?0:n<0?-1:1}var Mwe=0;function Md(){return++Mwe}var yU={};function Go(n,e,t){if(t===void 0&&(t=3),!yU[e]){var i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+n):(i=i.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+`
Deprecated since v`+n),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+n),console.warn(i))),yU[e]=!0}}var tR={},Do=Object.create(null),Na=Object.create(null);function Rwe(){var n;for(n in Do)Do[n].destroy();for(n in Na)Na[n].destroy()}function Dwe(){var n;for(n in Do)delete Do[n];for(n in Na)delete Na[n]}var nR=function(){function n(e,t,i){this.canvas=xt.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=i||xt.RESOLUTION,this.resize(e,t)}return n.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.resize=function(e,t){this.canvas.width=Math.round(e*this.resolution),this.canvas.height=Math.round(t*this.resolution)},n.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(n.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=Math.round(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=Math.round(e)},enumerable:!1,configurable:!0}),n}();function oX(n){var e=n.width,t=n.height,i=n.getContext("2d"),r=i.getImageData(0,0,e,t),s=r.data,o=s.length,a={top:null,left:null,right:null,bottom:null},l=null,c,u,h;for(c=0;c<o;c+=4)s[c+3]!==0&&(u=c/4%e,h=~~(c/4/e),a.top===null&&(a.top=h),(a.left===null||u<a.left)&&(a.left=u),(a.right===null||a.right<u)&&(a.right=u+1),(a.bottom===null||a.bottom<h)&&(a.bottom=h));return a.top!==null&&(e=a.right-a.left,t=a.bottom-a.top+1,l=i.getImageData(a.left,a.top,e,t)),{height:t,width:e,data:l}}var aX=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function kwe(n){var e=aX.exec(n);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}var $b;function lX(n,e){if(e===void 0&&(e=globalThis.location),n.indexOf("data:")===0)return"";e=e||globalThis.location,$b||($b=document.createElement("a")),$b.href=n;var t=Rf.parse($b.href),i=!t.port&&e.port===""||t.port===e.port;return t.hostname!==e.hostname||!i||t.protocol!==e.protocol?"anonymous":""}function gA(n,e){var t=xt.RETINA_PREFIX.exec(n);return t?parseFloat(t[1]):e!==void 0?e:1}const Owe=Object.freeze(Object.defineProperty({__proto__:null,BaseTextureCache:Na,CanvasRenderTarget:nR,DATA_URI:aX,EventEmitter:Zr,ProgramCache:tR,TextureCache:Do,clearTextureCache:Dwe,correctBlendMode:xL,createIndicesForQuads:sX,decomposeDataUri:kwe,deprecation:Go,destroyTextureCache:Rwe,determineCrossOrigin:lX,earcut:dL,getBufferType:eI,getResolutionOfUrl:gA,hex2rgb:_s,hex2string:bL,interleaveTypedArrays:Pwe,isMobile:Qa,isPow2:ZM,isWebGLSupported:iX,log2:eR,nextPow2:pA,path:tX,premultiplyBlendMode:wL,premultiplyRgba:rX,premultiplyTint:ZT,premultiplyTintToRgba:CL,removeItems:fp,rgb2hex:al,sayHello:nX,sign:Df,skipHello:UAe,string2hex:fA,trimCanvas:oX,uid:Md,url:Rf},Symbol.toStringTag,{value:"Module"}));/*!
 * @pixi/display - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */xt.SORTABLE_CHILDREN=!1;var oi=function(){function n(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return n.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},n.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},n.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?Pt.EMPTY:(e=e||new Pt(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},n.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},n.prototype.addPointMatrix=function(e,t){var i=e.a,r=e.b,s=e.c,o=e.d,a=e.tx,l=e.ty,c=i*t.x+s*t.y+a,u=r*t.x+o*t.y+l;this.minX=Math.min(this.minX,c),this.maxX=Math.max(this.maxX,c),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},n.prototype.addQuad=function(e){var t=this.minX,i=this.minY,r=this.maxX,s=this.maxY,o=e[0],a=e[1];t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[2],a=e[3],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[4],a=e[5],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[6],a=e[7],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,this.minX=t,this.minY=i,this.maxX=r,this.maxY=s},n.prototype.addFrame=function(e,t,i,r,s){this.addFrameMatrix(e.worldTransform,t,i,r,s)},n.prototype.addFrameMatrix=function(e,t,i,r,s){var o=e.a,a=e.b,l=e.c,c=e.d,u=e.tx,h=e.ty,d=this.minX,f=this.minY,p=this.maxX,g=this.maxY,m=o*t+l*i+u,v=a*t+c*i+h;d=m<d?m:d,f=v<f?v:f,p=m>p?m:p,g=v>g?v:g,m=o*r+l*i+u,v=a*r+c*i+h,d=m<d?m:d,f=v<f?v:f,p=m>p?m:p,g=v>g?v:g,m=o*t+l*s+u,v=a*t+c*s+h,d=m<d?m:d,f=v<f?v:f,p=m>p?m:p,g=v>g?v:g,m=o*r+l*s+u,v=a*r+c*s+h,d=m<d?m:d,f=v<f?v:f,p=m>p?m:p,g=v>g?v:g,this.minX=d,this.minY=f,this.maxX=p,this.maxY=g},n.prototype.addVertexData=function(e,t,i){for(var r=this.minX,s=this.minY,o=this.maxX,a=this.maxY,l=t;l<i;l+=2){var c=e[l],u=e[l+1];r=c<r?c:r,s=u<s?u:s,o=c>o?c:o,a=u>a?u:a}this.minX=r,this.minY=s,this.maxX=o,this.maxY=a},n.prototype.addVertices=function(e,t,i,r){this.addVerticesMatrix(e.worldTransform,t,i,r)},n.prototype.addVerticesMatrix=function(e,t,i,r,s,o){s===void 0&&(s=0),o===void 0&&(o=s);for(var a=e.a,l=e.b,c=e.c,u=e.d,h=e.tx,d=e.ty,f=this.minX,p=this.minY,g=this.maxX,m=this.maxY,v=i;v<r;v+=2){var _=t[v],y=t[v+1],A=a*_+c*y+h,w=u*y+l*_+d;f=Math.min(f,A-s),g=Math.max(g,A+s),p=Math.min(p,w-o),m=Math.max(m,w+o)}this.minX=f,this.minY=p,this.maxX=g,this.maxY=m},n.prototype.addBounds=function(e){var t=this.minX,i=this.minY,r=this.maxX,s=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>s?e.maxY:s},n.prototype.addBoundsMask=function(e,t){var i=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,s=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(i<=s&&r<=o){var a=this.minX,l=this.minY,c=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=s>c?s:c,this.maxY=o>u?o:u}},n.prototype.addBoundsMatrix=function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},n.prototype.addBoundsArea=function(e,t){var i=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,s=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(i<=s&&r<=o){var a=this.minX,l=this.minY,c=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=s>c?s:c,this.maxY=o>u?o:u}},n.prototype.pad=function(e,t){e===void 0&&(e=0),t===void 0&&(t=e),this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},n.prototype.addFramePad=function(e,t,i,r,s,o){e-=s,t-=o,i+=s,r+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var iR=function(n,e){return iR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},iR(n,e)};function EL(n,e){iR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var rn=function(n){EL(e,n);function e(){var t=n.call(this)||this;return t.tempDisplayObjectParent=null,t.transform=new nb,t.alpha=1,t.visible=!0,t.renderable=!0,t.cullable=!1,t.cullArea=null,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new oi,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._maskRefCount=0,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}return e.mixin=function(t){for(var i=Object.keys(t),r=0;r<i.length;++r){var s=i[r];Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(t,s))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,i){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),i||(this._boundsRect||(this._boundsRect=new Pt),i=this._boundsRect),this._bounds.getRectangle(i)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new Pt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new oi);var i=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var s=this._bounds,o=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,t);return this.parent=r,this.transform=i,this._bounds=s,this._bounds.updateID+=this._boundsID-o,a},e.prototype.toGlobal=function(t,i,r){return r===void 0&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,i)},e.prototype.toLocal=function(t,i,r,s){return i&&(t=i.toGlobal(t,r,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,i,r,s,o,a,l,c,u){return t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=1),s===void 0&&(s=1),o===void 0&&(o=0),a===void 0&&(a=0),l===void 0&&(l=0),c===void 0&&(c=0),u===void 0&&(u=0),this.position.x=t,this.position.y=i,this.scale.x=r||1,this.scale.y=s||1,this.rotation=o,this.skew.x=a,this.skew.y=l,this.pivot.x=c,this.pivot.y=u,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new TL),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*XT},set:function(t){this.transform.rotation=t*Yo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask!==t){if(this._mask){var i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount--,i._maskRefCount===0&&(i.renderable=!0,i.isMask=!1))}if(this._mask=t,this._mask){var i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount===0&&(i.renderable=!1,i.isMask=!0),i._maskRefCount++)}}},enumerable:!1,configurable:!0}),e}(Zr),TL=function(n){EL(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.sortDirty=null,t}return e}(rn);rn.prototype.displayObjectUpdateTransform=rn.prototype.updateTransform;/*!
 * @pixi/constants - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var AU;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(AU||(AU={}));var bU;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})(bU||(bU={}));var wU;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(wU||(wU={}));var xU;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(xU||(xU={}));var CU;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(CU||(CU={}));var EU;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(EU||(EU={}));var TU;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(TU||(TU={}));var IU;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(IU||(IU={}));var SU;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(SU||(SU={}));var PU;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(PU||(PU={}));var MU;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(MU||(MU={}));var RU;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(RU||(RU={}));var DU;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(DU||(DU={}));var kU;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(kU||(kU={}));var OU;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(OU||(OU={}));var LU;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})(LU||(LU={}));var rR;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(rR||(rR={}));var NU;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(NU||(NU={}));var BU;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(BU||(BU={}));var FU;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(FU||(FU={}));function Lwe(n,e){return n.zIndex===e.zIndex?n._lastSortedIndex-e._lastSortedIndex:n.zIndex-e.zIndex}var mn=function(n){EL(e,n);function e(){var t=n.call(this)||this;return t.children=[],t.sortableChildren=xt.SORTABLE_CHILDREN,t.sortDirty=!1,t}return e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,i=[],r=0;r<arguments.length;r++)i[r]=t[r];if(i.length>1)for(var s=0;s<i.length;s++)this.addChild(i[s]);else{var o=i[0];o.parent&&o.parent.removeChild(o),o.parent=this,this.sortDirty=!0,o.transform._parentID=-1,this.children.push(o),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",o,this,this.children.length-1),o.emit("added",this)}return i[0]},e.prototype.addChildAt=function(t,i){if(i<0||i>this.children.length)throw new Error(t+"addChildAt: The index "+i+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(i,0,t),this._boundsID++,this.onChildrenChange(i),t.emit("added",this),this.emit("childAdded",t,this,i),t},e.prototype.swapChildren=function(t,i){if(t!==i){var r=this.getChildIndex(t),s=this.getChildIndex(i);this.children[r]=i,this.children[s]=t,this.onChildrenChange(r<s?r:s)}},e.prototype.getChildIndex=function(t){var i=this.children.indexOf(t);if(i===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return i},e.prototype.setChildIndex=function(t,i){if(i<0||i>=this.children.length)throw new Error("The index "+i+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);fp(this.children,r,1),this.children.splice(i,0,t),this.onChildrenChange(i)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,i=[],r=0;r<arguments.length;r++)i[r]=t[r];if(i.length>1)for(var s=0;s<i.length;s++)this.removeChild(i[s]);else{var o=i[0],a=this.children.indexOf(o);if(a===-1)return null;o.parent=null,o.transform._parentID=-1,fp(this.children,a,1),this._boundsID++,this.onChildrenChange(a),o.emit("removed",this),this.emit("childRemoved",o,this,a)}return i[0]},e.prototype.removeChildAt=function(t){var i=this.getChildAt(t);return i.parent=null,i.transform._parentID=-1,fp(this.children,t,1),this._boundsID++,this.onChildrenChange(t),i.emit("removed",this),this.emit("childRemoved",i,this,t),i},e.prototype.removeChildren=function(t,i){t===void 0&&(t=0),i===void 0&&(i=this.children.length);var r=t,s=i,o=s-r,a;if(o>0&&o<=s){a=this.children.splice(r,o);for(var l=0;l<a.length;++l)a[l].parent=null,a[l].transform&&(a[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var l=0;l<a.length;++l)a[l].emit("removed",this),this.emit("childRemoved",a[l],this,l);return a}else if(o===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,i=0,r=this.children.length;i<r;++i){var s=this.children[i];s._lastSortedIndex=i,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(Lwe),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,i=this.children.length;t<i;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var i=this.children[t];if(!(!i.visible||!i.renderable))if(i.calculateBounds(),i._mask){var r=i._mask.isMaskData?i._mask.maskObject:i._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(i._bounds,r._bounds)):this._bounds.addBounds(i._bounds)}else i.filterArea?this._bounds.addBoundsArea(i._bounds,i.filterArea):this._bounds.addBounds(i._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(t,i){i===void 0&&(i=!1);var r=n.prototype.getLocalBounds.call(this,t);if(!i)for(var s=0,o=this.children.length;s<o;++s){var a=this.children[s];a.visible&&a.updateTransform()}return r},e.prototype._calculateBounds=function(){},e.prototype._renderWithCulling=function(t){var i=t.renderTexture.sourceFrame;if(i.width>0&&i.height>0){var r,s;if(this.cullArea?(r=this.cullArea,s=this.worldTransform):this._render!==e.prototype._render&&(r=this.getBounds(!0)),r&&i.intersects(r,s))this._render(t);else if(this.cullArea)return;for(var o=0,a=this.children.length;o<a;++o){var l=this.children[o],c=l.cullable;l.cullable=c||!this.cullArea,l.render(t),l.cullable=c}}},e.prototype.render=function(t){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var i=0,r=this.children.length;i<r;++i)this.children[i].render(t)}},e.prototype.renderAdvanced=function(t){var i=this.filters,r=this._mask;if(i){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var s=0;s<i.length;s++)i[s].enabled&&this._enabledFilters.push(i[s])}var o=i&&this._enabledFilters&&this._enabledFilters.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==rR.NONE));if(o&&t.batch.flush(),i&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(var s=0,a=this.children.length;s<a;++s)this.children[s].render(t)}o&&t.batch.flush(),r&&t.mask.pop(this),i&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1;var i=typeof t=="boolean"?t:t&&t.children,r=this.removeChildren(0,this.children.length);if(i)for(var s=0;s<r.length;++s)r[s].destroy(t)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var i=this.getLocalBounds().width;i!==0?this.scale.x=t/i:this.scale.x=1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var i=this.getLocalBounds().height;i!==0?this.scale.y=t/i:this.scale.y=1,this._height=t},enumerable:!1,configurable:!0}),e}(rn);mn.prototype.containerUpdateTransform=mn.prototype.updateTransform;/*!
 * @pixi/runner - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var us=function(){function n(e){this.items=[],this._name=e,this._aliasCount=0}return n.prototype.emit=function(e,t,i,r,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");var c=this,u=c.name,h=c.items;this._aliasCount++;for(var d=0,f=h.length;d<f;d++)h[d][u](e,t,i,r,s,o,a,l);return h===this.items&&this._aliasCount--,this},n.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},n.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},n.prototype.remove=function(e){var t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},n.prototype.contains=function(e){return this.items.indexOf(e)!==-1},n.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},n.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(n.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),n}();Object.defineProperties(us.prototype,{dispatch:{value:us.prototype.emit},run:{value:us.prototype.emit}});/*!
 * @pixi/core - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */xt.PREFER_ENV=Qa.any?Zl.WEBGL:Zl.WEBGL2;xt.STRICT_TEXTURE_CACHE=!1;var mA=[];function tI(n,e){if(!n)return null;var t="";if(typeof n=="string"){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(n);i&&(t=i[1].toLowerCase())}for(var r=mA.length-1;r>=0;--r){var s=mA[r];if(s.test&&s.test(n,t))return new s(n,e)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var sR=function(n,e){return sR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},sR(n,e)};function Vi(n,e){sR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var oR=function(){return oR=Object.assign||function(e){for(var t=arguments,i,r=1,s=arguments.length;r<s;r++){i=t[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},oR.apply(this,arguments)};function Nwe(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}var Vp=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new us("setRealSize"),this.onUpdate=new us("update"),this.onError=new us("onError")}return n.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},n.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},n.prototype.resize=function(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(n.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),n.prototype.update=function(){this.destroyed||this.onUpdate.emit()},n.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),n.prototype.style=function(e,t,i){return!1},n.prototype.dispose=function(){},n.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},n.test=function(e,t){return!1},n}(),dg=function(n){Vi(e,n);function e(t,i){var r=this,s=i||{},o=s.width,a=s.height;if(!o||!a)throw new Error("BufferResource width or height invalid");return r=n.call(this,o,a)||this,r.data=t,r}return e.prototype.upload=function(t,i,r){var s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ol.UNPACK);var o=i.realWidth,a=i.realHeight;return r.width===o&&r.height===a?s.texSubImage2D(i.target,0,0,0,o,a,i.format,r.type,this.data):(r.width=o,r.height=a,s.texImage2D(i.target,0,r.internalFormat,o,a,0,i.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(Vp),Bwe={scaleMode:ga.NEAREST,format:At.RGBA,alphaMode:ol.NPM},In=function(n){Vi(e,n);function e(t,i){t===void 0&&(t=null),i===void 0&&(i=null);var r=n.call(this)||this;i=i||{};var s=i.alphaMode,o=i.mipmap,a=i.anisotropicLevel,l=i.scaleMode,c=i.width,u=i.height,h=i.wrapMode,d=i.format,f=i.type,p=i.target,g=i.resolution,m=i.resourceOptions;return t&&!(t instanceof Vp)&&(t=tI(t,m),t.internal=!0),r.resolution=g||xt.RESOLUTION,r.width=Math.round((c||0)*r.resolution)/r.resolution,r.height=Math.round((u||0)*r.resolution)/r.resolution,r._mipmap=o!==void 0?o:xt.MIPMAP_TEXTURES,r.anisotropicLevel=a!==void 0?a:xt.ANISOTROPIC_LEVEL,r._wrapMode=h||xt.WRAP_MODE,r._scaleMode=l!==void 0?l:xt.SCALE_MODE,r.format=d||At.RGBA,r.type=f||qt.UNSIGNED_BYTE,r.target=p||md.TEXTURE_2D,r.alphaMode=s!==void 0?s:ol.UNPACK,r.uid=Md(),r.touched=0,r.isPowerOfTwo=!1,r._refreshPOT(),r._glTextures={},r.dirtyId=0,r.dirtyStyleId=0,r.cacheId=null,r.valid=c>0&&u>0,r.textureCacheIds=[],r.destroyed=!1,r.resource=null,r._batchEnabled=0,r._batchLocation=0,r.parentTextureArray=null,r.setResource(t),r}return Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,i){var r;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),i!==void 0&&i!==this.mipmap&&(this.mipmap=i,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,i,r){return r=r||this.resolution,this.setRealSize(t*r,i*r,r)},e.prototype.setRealSize=function(t,i,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(i)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=ZM(this.realWidth)&&ZM(this.realHeight)},e.prototype.setResolution=function(t){var i=this.resolution;return i===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*i)/t,this.height=Math.round(this.height*i)/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Na[this.cacheId],delete Do[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,i,r){r===void 0&&(r=xt.STRICT_TEXTURE_CACHE);var s=typeof t=="string",o=null;if(s)o=t;else{if(!t._pixiId){var a=i&&i.pixiIdPrefix||"pixiid";t._pixiId=a+"_"+Md()}o=t._pixiId}var l=Na[o];if(s&&r&&!l)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return l||(l=new e(t,i),l.cacheId=o,e.addToCache(l,o)),l},e.fromBuffer=function(t,i,r,s){t=t||new Float32Array(i*r*4);var o=new dg(t,{width:i,height:r}),a=t instanceof Float32Array?qt.FLOAT:qt.UNSIGNED_BYTE;return new e(o,Object.assign(Bwe,s||{width:i,height:r,type:a}))},e.addToCache=function(t,i){i&&(t.textureCacheIds.indexOf(i)===-1&&t.textureCacheIds.push(i),Na[i]&&console.warn("BaseTexture added to the cache with an id ["+i+"] that already had an entry"),Na[i]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var i=Na[t];if(i){var r=i.textureCacheIds.indexOf(t);return r>-1&&i.textureCacheIds.splice(r,1),delete Na[t],i}}else if(t&&t.textureCacheIds){for(var s=0;s<t.textureCacheIds.length;++s)delete Na[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(Zr),nI=function(n){Vi(e,n);function e(t,i){var r=this,s=i||{},o=s.width,a=s.height;r=n.call(this,o,a)||this,r.items=[],r.itemDirtyIds=[];for(var l=0;l<t;l++){var c=new In;r.items.push(c),r.itemDirtyIds.push(-2)}return r.length=t,r._load=null,r.baseTexture=null,r}return e.prototype.initFromArray=function(t,i){for(var r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof Vp?this.addResourceAt(t[r],r):this.addResourceAt(tI(t[r],i),r))},e.prototype.dispose=function(){for(var t=0,i=this.length;t<i;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,i){if(!this.items[i])throw new Error("Index "+i+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[i].setResource(t),this},e.prototype.bind=function(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");n.prototype.bind.call(this,t);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=t,this.items[i].on("update",t.update,t)},e.prototype.unbind=function(t){n.prototype.unbind.call(this,t);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",t.update,t)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var i=this.items.map(function(s){return s.resource}).filter(function(s){return s}),r=i.map(function(s){return s.load()});return this._load=Promise.all(r).then(function(){var s=t.items[0],o=s.realWidth,a=s.realHeight;return t.resize(o,a),Promise.resolve(t)}),this._load},e}(Vp),IL=function(n){Vi(e,n);function e(t,i){var r=this,s=i||{},o=s.width,a=s.height,l,c;return Array.isArray(t)?(l=t,c=t.length):c=t,r=n.call(this,c,{width:o,height:a})||this,l&&r.initFromArray(l,i),r}return e.prototype.addBaseTextureAt=function(t,i){if(t.resource)this.addResourceAt(t.resource,i);else throw new Error("ArrayResource does not support RenderTexture");return this},e.prototype.bind=function(t){n.prototype.bind.call(this,t),t.target=md.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,i,r){var s=this,o=s.length,a=s.itemDirtyIds,l=s.items,c=t.gl;r.dirtyId<0&&c.texImage3D(c.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,o,0,i.format,r.type,null);for(var u=0;u<o;u++){var h=l[u];a[u]<h.dirtyId&&(a[u]=h.dirtyId,h.valid&&c.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,u,h.resource.width,h.resource.height,1,i.format,r.type,h.resource.source))}return!0},e}(nI),Uc=function(n){Vi(e,n);function e(t){var i=this,r=t,s=r.naturalWidth||r.videoWidth||r.width,o=r.naturalHeight||r.videoHeight||r.height;return i=n.call(this,s,o)||this,i.source=t,i.noSubImage=!1,i}return e.crossOrigin=function(t,i,r){r===void 0&&i.indexOf("data:")!==0?t.crossOrigin=lX(i):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")},e.prototype.upload=function(t,i,r,s){var o=t.gl,a=i.realWidth,l=i.realHeight;if(s=s||this.source,s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ol.UNPACK),!this.noSubImage&&i.target===o.TEXTURE_2D&&r.width===a&&r.height===l?o.texSubImage2D(o.TEXTURE_2D,0,0,0,i.format,r.type,s):(r.width=a,r.height=l,o.texImage2D(i.target,0,r.internalFormat,i.format,r.type,s)),!0},e.prototype.update=function(){if(!this.destroyed){var t=this.source,i=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(i,r),n.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(Vp),SL=function(n){Vi(e,n);function e(t){return n.call(this,t)||this}return e.test=function(t){var i=globalThis.OffscreenCanvas;return i&&t instanceof i?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(Uc),PL=function(n){Vi(e,n);function e(t,i){var r=this,s=i||{},o=s.width,a=s.height,l=s.autoLoad,c=s.linkBaseTexture;if(t&&t.length!==e.SIDES)throw new Error("Invalid length. Got "+t.length+", expected 6");r=n.call(this,6,{width:o,height:a})||this;for(var u=0;u<e.SIDES;u++)r.items[u].target=md.TEXTURE_CUBE_MAP_POSITIVE_X+u;return r.linkBaseTexture=c!==!1,t&&r.initFromArray(t,i),l!==!1&&r.load(),r}return e.prototype.bind=function(t){n.prototype.bind.call(this,t),t.target=md.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,i,r){if(!this.items[i])throw new Error("Index "+i+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,i);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=md.TEXTURE_CUBE_MAP_POSITIVE_X+i,t.parentTextureArray=this.baseTexture,this.items[i]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[i]=t,this},e.prototype.upload=function(t,i,r){for(var s=this.itemDirtyIds,o=0;o<e.SIDES;o++){var a=this.items[o];(s[o]<a.dirtyId||r.dirtyId<i.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(t,a,r),s[o]=a.dirtyId):s[o]<-1&&(t.gl.texImage2D(a.target,0,r.internalFormat,i.realWidth,i.realHeight,0,i.format,r.type,null),s[o]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(nI),iI=function(n){Vi(e,n);function e(t,i){var r=this;if(i=i||{},!(t instanceof HTMLImageElement)){var s=new Image;Uc.crossOrigin(s,t,i.crossorigin),s.src=t,t=s}return r=n.call(this,t)||this,!t.complete&&r._width&&r._height&&(r._width=0,r._height=0),r.url=t.src,r._process=null,r.preserveBitmap=!1,r.createBitmap=(i.createBitmap!==void 0?i.createBitmap:xt.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,r.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,r.bitmap=null,r._load=null,i.autoLoad!==!1&&r.load(),r}return e.prototype.load=function(t){var i=this;return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise(function(r,s){var o=i.source;i.url=o.src;var a=function(){i.destroyed||(o.onload=null,o.onerror=null,i.resize(o.width,o.height),i._load=null,i.createBitmap?r(i.process()):r(i))};o.complete&&o.src?a():(o.onload=a,o.onerror=function(l){s(l),i.onError.emit(l)})}),this._load)},e.prototype.process=function(){var t=this,i=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var r=globalThis.createImageBitmap,s=!i.crossOrigin||i.crossOrigin==="anonymous";return this._process=fetch(i.src,{mode:s?"cors":"no-cors"}).then(function(o){return o.blob()}).then(function(o){return r(o,0,0,i.width,i.height,{premultiplyAlpha:t.alphaMode===ol.UNPACK?"premultiply":"none"})}).then(function(o){return t.destroyed?Promise.reject():(t.bitmap=o,t.update(),t._process=null,Promise.resolve(t))}),this._process},e.prototype.upload=function(t,i,r){if(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),!this.createBitmap)return n.prototype.upload.call(this,t,i,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(n.prototype.upload.call(this,t,i,r,this.bitmap),!this.preserveBitmap){var s=!0,o=i._glTextures;for(var a in o){var l=o[a];if(l!==r&&l.dirtyId!==i.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,n.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return typeof t=="string"||t instanceof HTMLImageElement},e}(Uc),ML=function(n){Vi(e,n);function e(t,i){var r=this;return i=i||{},r=n.call(this,xt.ADAPTER.createCanvas())||this,r._width=0,r._height=0,r.svg=t,r.scale=i.scale||1,r._overrideWidth=i.width,r._overrideHeight=i.height,r._resolve=null,r._crossorigin=i.crossorigin,r._load=null,i.autoLoad!==!1&&r.load(),r}return e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise(function(i){if(t._resolve=function(){t.resize(t.source.width,t.source.height),i(t)},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}),this._load)},e.prototype._loadSvg=function(){var t=this,i=new Image;Uc.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=function(r){t._resolve&&(i.onerror=null,t.onError.emit(r))},i.onload=function(){if(t._resolve){var r=i.width,s=i.height;if(!r||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var o=r*t.scale,a=s*t.scale;(t._overrideWidth||t._overrideHeight)&&(o=t._overrideWidth||t._overrideHeight/s*r,a=t._overrideHeight||t._overrideWidth/r*s),o=Math.round(o),a=Math.round(a);var l=t.source;l.width=o,l.height=a,l._pixiId="canvas_"+Md(),l.getContext("2d").drawImage(i,0,0,r,s,0,0,o,a),t._resolve(),t._resolve=null}}},e.getSize=function(t){var i=e.SVG_SIZE.exec(t),r={};return i&&(r[i[1]]=Math.round(parseFloat(i[3])),r[i[5]]=Math.round(parseFloat(i[7]))),r},e.prototype.dispose=function(){n.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,i){return i==="svg"||typeof t=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||typeof t=="string"&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(Uc),RL=function(n){Vi(e,n);function e(t,i){var r=this;if(i=i||{},!(t instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);var o=t[0].src||t[0];Uc.crossOrigin(s,o,i.crossorigin);for(var a=0;a<t.length;++a){var l=document.createElement("source"),c=t[a],u=c.src,h=c.mime;u=u||t[a];var d=u.split("?").shift().toLowerCase(),f=d.slice(d.lastIndexOf(".")+1);h=h||e.MIME_TYPES[f]||"video/"+f,l.src=u,l.type=h,s.appendChild(l)}t=s}return r=n.call(this,t)||this,r.noSubImage=!0,r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=i.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=i.autoPlay!==!1,r._load=null,r._resolve=null,r._onCanPlay=r._onCanPlay.bind(r),r._onError=r._onError.bind(r),i.autoLoad!==!1&&r.load(),r}return e.prototype.update=function(t){if(!this.destroyed){var i=Qi.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i),(!this._updateFPS||this._msToNextUpdate<=0)&&(n.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(r){t.valid?r(t):(t._resolve=r,i.load())}),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&t.paused===!1&&t.ended===!1&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return t.readyState===3||t.readyState===4},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Qi.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Qi.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var i=this.valid;this.resize(t.videoWidth,t.videoHeight),!i&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(Qi.shared.remove(this.update,this),this._isConnectedToTicker=!1);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),n.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Qi.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Qi.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,i){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(i)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(Uc),DL=function(n){Vi(e,n);function e(t){return n.call(this,t)||this}return e.test=function(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&t instanceof ImageBitmap},e}(Uc);mA.push(iI,DL,SL,RL,ML,dg,PL,IL);var cX={__proto__:null,Resource:Vp,BaseImageResource:Uc,INSTALLED:mA,autoDetectResource:tI,AbstractMultiResource:nI,ArrayResource:IL,BufferResource:dg,CanvasResource:SL,CubeResource:PL,ImageResource:iI,SVGResource:ML,VideoResource:RL,ImageBitmapResource:DL},Fwe=function(n){Vi(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.upload=function(t,i,r){var s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ol.UNPACK);var o=i.realWidth,a=i.realHeight;return r.width===o&&r.height===a?s.texSubImage2D(i.target,0,0,0,o,a,i.format,r.type,this.data):(r.width=o,r.height=a,s.texImage2D(i.target,0,r.internalFormat,o,a,0,i.format,r.type,this.data)),!0},e}(dg),EC=function(){function n(e,t){this.width=Math.round(e||100),this.height=Math.round(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new us("disposeFramebuffer"),this.multisample=Cr.NONE}return Object.defineProperty(n.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),n.prototype.addColorTexture=function(e,t){return e===void 0&&(e=0),this.colorTextures[e]=t||new In(null,{scaleMode:ga.NEAREST,resolution:1,mipmap:sl.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},n.prototype.addDepthTexture=function(e){return this.depthTexture=e||new In(new Fwe(null,{width:this.width,height:this.height}),{scaleMode:ga.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:sl.OFF,format:At.DEPTH_COMPONENT,type:qt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},n.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},n.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},n.prototype.resize=function(e,t){if(e=Math.round(e),t=Math.round(t),!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],s=r.resolution;r.setSize(e/s,t/s)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(e/s,t/s)}}},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},n}(),kL=function(n){Vi(e,n);function e(t){t===void 0&&(t={});var i=this;if(typeof t=="number"){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];t={width:r,height:s,scaleMode:o,resolution:a}}return t.width=t.width||100,t.height=t.height||100,t.multisample=t.multisample!==void 0?t.multisample:Cr.NONE,i=n.call(this,null,t)||this,i.mipmap=sl.OFF,i.valid=!0,i.clearColor=[0,0,0,0],i.framebuffer=new EC(i.realWidth,i.realHeight).addColorTexture(0,i),i.framebuffer.multisample=t.multisample,i.maskStack=[],i.filterStack=[{}],i}return e.prototype.resize=function(t,i){this.framebuffer.resize(t*this.resolution,i*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(In),OL=function(){function n(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return n.prototype.set=function(e,t,i){var r=t.width,s=t.height;if(i){var o=e.width/2/r,a=e.height/2/s,l=e.x/r+o,c=e.y/s+a;i=Ki.add(i,Ki.NW),this.x0=l+o*Ki.uX(i),this.y0=c+a*Ki.uY(i),i=Ki.add(i,2),this.x1=l+o*Ki.uX(i),this.y1=c+a*Ki.uY(i),i=Ki.add(i,2),this.x2=l+o*Ki.uX(i),this.y2=c+a*Ki.uY(i),i=Ki.add(i,2),this.x3=l+o*Ki.uX(i),this.y3=c+a*Ki.uY(i)}else this.x0=e.x/r,this.y0=e.y/s,this.x1=(e.x+e.width)/r,this.y1=e.y/s,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/s,this.x3=e.x/r,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},n.prototype.toString=function(){return"[@pixi/core:TextureUvs "+("x0="+this.x0+" y0="+this.y0+" ")+("x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" ")+("y2="+this.y2+" x3="+this.x3+" y3="+this.y3)+"]"},n}(),UU=new OL;function Wb(n){n.destroy=function(){},n.on=function(){},n.once=function(){},n.emit=function(){}}var Wt=function(n){Vi(e,n);function e(t,i,r,s,o,a){var l=n.call(this)||this;if(l.noFrame=!1,i||(l.noFrame=!0,i=new Pt(0,0,1,1)),t instanceof e&&(t=t.baseTexture),l.baseTexture=t,l._frame=i,l.trim=s,l.valid=!1,l._uvs=UU,l.uvMatrix=null,l.orig=r||i,l._rotate=Number(o||0),o===!0)l._rotate=2;else if(l._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=a?new Ae(a.x,a.y):new Ae(0,0),l._updateID=0,l.textureCacheIds=[],t.valid?l.noFrame?t.valid&&l.onBaseTextureUpdated(t):l.frame=i:t.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&t.on("update",l.onBaseTextureUpdated,l),l}return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var i=this.baseTexture.resource;i&&i.url&&Do[i.url]&&e.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),i=this._frame===this.orig?t:this.orig.clone(),r=new e(this.baseTexture,!this.noFrame&&t,i,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(r._frame=t),r},e.prototype.updateUvs=function(){this._uvs===UU&&(this._uvs=new OL),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,i,r){i===void 0&&(i={}),r===void 0&&(r=xt.STRICT_TEXTURE_CACHE);var s=typeof t=="string",o=null;if(s)o=t;else if(t instanceof In){if(!t.cacheId){var a=i&&i.pixiIdPrefix||"pixiid";t.cacheId=a+"-"+Md(),In.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){var a=i&&i.pixiIdPrefix||"pixiid";t._pixiId=a+"_"+Md()}o=t._pixiId}var l=Do[o];if(s&&r&&!l)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return!l&&!(t instanceof In)?(i.resolution||(i.resolution=gA(t)),l=new e(new In(t,i)),l.baseTexture.cacheId=o,In.addToCache(l.baseTexture,o),e.addToCache(l,o)):!l&&t instanceof In&&(l=new e(t),e.addToCache(l,o)),l},e.fromURL=function(t,i){var r=Object.assign({autoLoad:!1},i==null?void 0:i.resourceOptions),s=e.from(t,Object.assign({resourceOptions:r},i),!1),o=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):o.load().then(function(){return Promise.resolve(s)})},e.fromBuffer=function(t,i,r,s){return new e(In.fromBuffer(t,i,r,s))},e.fromLoader=function(t,i,r,s){var o=new In(t,Object.assign({scaleMode:xt.SCALE_MODE,resolution:gA(i)},s)),a=o.resource;a instanceof iI&&(a.url=i);var l=new e(o);return r||(r=i),In.addToCache(l.baseTexture,r),e.addToCache(l,r),r!==i&&(In.addToCache(l.baseTexture,i),e.addToCache(l,i)),l.baseTexture.valid?Promise.resolve(l):new Promise(function(c){l.baseTexture.once("loaded",function(){return c(l)})})},e.addToCache=function(t,i){i&&(t.textureCacheIds.indexOf(i)===-1&&t.textureCacheIds.push(i),Do[i]&&console.warn("Texture added to the cache with an id ["+i+"] that already had an entry"),Do[i]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var i=Do[t];if(i){var r=i.textureCacheIds.indexOf(t);return r>-1&&i.textureCacheIds.splice(r,1),delete Do[t],i}}else if(t&&t.textureCacheIds){for(var s=0;s<t.textureCacheIds.length;++s)Do[t.textureCacheIds[s]]===t&&delete Do[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var i=t.x,r=t.y,s=t.width,o=t.height,a=i+s>this.baseTexture.width,l=r+o>this.baseTexture.height;if(a||l){var c=a&&l?"and":"or",u="X: "+i+" + "+s+" = "+(i+s)+" > "+this.baseTexture.width,h="Y: "+r+" + "+o+" = "+(r+o)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(u+" "+c+" "+h))}this.valid=s&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(e,"EMPTY",{get:function(){return e._EMPTY||(e._EMPTY=new e(new In),Wb(e._EMPTY),Wb(e._EMPTY.baseTexture)),e._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(e,"WHITE",{get:function(){if(!e._WHITE){var t=xt.ADAPTER.createCanvas(16,16),i=t.getContext("2d");t.width=16,t.height=16,i.fillStyle="white",i.fillRect(0,0,16,16),e._WHITE=new e(In.from(t)),Wb(e._WHITE),Wb(e._WHITE.baseTexture)}return e._WHITE},enumerable:!1,configurable:!0}),e}(Zr),va=function(n){Vi(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.valid=!0,r.filterFrame=null,r.filterPoolKey=null,r.updateUvs(),r}return Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,i,r){r===void 0&&(r=!0);var s=this.baseTexture.resolution,o=Math.round(t*s)/s,a=Math.round(i*s)/s;this.valid=o>0&&a>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=a,r&&this.baseTexture.resize(o,a),this.updateUvs()},e.prototype.setResolution=function(t){var i=this.baseTexture;i.resolution!==t&&(i.setResolution(t),this.resize(i.width,i.height,!1))},e.create=function(t){for(var i=arguments,r=[],s=1;s<arguments.length;s++)r[s-1]=i[s];return typeof t=="number"&&(Go("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:r[0],scaleMode:r[1],resolution:r[2]}),new e(new kL(t))},e}(Wt),uX=function(){function n(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return n.prototype.createTexture=function(e,t,i){i===void 0&&(i=Cr.NONE);var r=new kL(Object.assign({width:e,height:t,resolution:1,multisample:i},this.textureOptions));return new va(r)},n.prototype.getOptimalTexture=function(e,t,i,r){i===void 0&&(i=1),r===void 0&&(r=Cr.NONE);var s;e=Math.ceil(e*i-1e-6),t=Math.ceil(t*i-1e-6),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=pA(e),t=pA(t),s=((e&65535)<<16|t&65535)>>>0,r>1&&(s+=r*4294967296)):s=r>1?-r:-1,this.texturePool[s]||(this.texturePool[s]=[]);var o=this.texturePool[s].pop();return o||(o=this.createTexture(e,t,r)),o.filterPoolKey=s,o.setResolution(i),o},n.prototype.getFilterTexture=function(e,t,i){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution,i||Cr.NONE);return r.filterFrame=e.filterFrame,r},n.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},n.prototype.returnFilterTexture=function(e){this.returnTexture(e)},n.prototype.clear=function(e){if(e=e!==!1,e)for(var t in this.texturePool){var i=this.texturePool[t];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},n.prototype.setScreenSize=function(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(var t in this.texturePool)if(Number(t)<0){var i=this.texturePool[t];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}},n.SCREEN_KEY=-1,n}(),aR=function(){function n(e,t,i,r,s,o,a){t===void 0&&(t=0),i===void 0&&(i=!1),r===void 0&&(r=qt.FLOAT),this.buffer=e,this.size=t,this.normalized=i,this.type=r,this.stride=s,this.start=o,this.instance=a}return n.prototype.destroy=function(){this.buffer=null},n.from=function(e,t,i,r,s){return new n(e,t,i,r,s)},n}(),Uwe=0,Br=function(){function n(e,t,i){t===void 0&&(t=!0),i===void 0&&(i=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=t,this.id=Uwe++,this.disposeRunner=new us("disposeBuffer")}return n.prototype.update=function(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(n.prototype,"index",{get:function(){return this.type===ql.ELEMENT_ARRAY_BUFFER},set:function(e){this.type=e?ql.ELEMENT_ARRAY_BUFFER:ql.ARRAY_BUFFER},enumerable:!1,configurable:!0}),n.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new n(e)},n}(),Gwe={Float32Array,Uint32Array,Int32Array,Uint8Array};function Hwe(n,e){for(var t=0,i=0,r={},s=0;s<n.length;s++)i+=e[s],t+=n[s].length;for(var o=new ArrayBuffer(t*4),a=null,l=0,s=0;s<n.length;s++){var c=e[s],u=n[s],h=eI(u);r[h]||(r[h]=new Gwe[h](o)),a=r[h];for(var d=0;d<u.length;d++){var f=(d/c|0)*i+l,p=d%c;a[f+p]=u[d]}l+=c}return new Float32Array(o)}var GU={5126:4,5123:2,5121:1},Vwe=0,zwe={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},s_=function(){function n(e,t){e===void 0&&(e=[]),t===void 0&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=Vwe++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new us("disposeGeometry"),this.refCount=0}return n.prototype.addAttribute=function(e,t,i,r,s,o,a,l){if(i===void 0&&(i=0),r===void 0&&(r=!1),l===void 0&&(l=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Br||(t instanceof Array&&(t=new Float32Array(t)),t=new Br(t));var c=e.split("|");if(c.length>1){for(var u=0;u<c.length;u++)this.addAttribute(c[u],t,i,r,s);return this}var h=this.buffers.indexOf(t);return h===-1&&(this.buffers.push(t),h=this.buffers.length-1),this.attributes[e]=new aR(h,i,r,s,o,a,l),this.instanced=this.instanced||l,this},n.prototype.getAttribute=function(e){return this.attributes[e]},n.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},n.prototype.addIndex=function(e){return e instanceof Br||(e instanceof Array&&(e=new Uint16Array(e)),e=new Br(e)),e.type=ql.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.indexOf(e)===-1&&this.buffers.push(e),this},n.prototype.getIndex=function(){return this.indexBuffer},n.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var e=[],t=[],i=new Br,r;for(r in this.attributes){var s=this.attributes[r],o=this.buffers[s.buffer];e.push(o.data),t.push(s.size*GU[s.type]/4),s.buffer=0}for(i.data=Hwe(e,t),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},n.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e],i=this.buffers[t.buffer];return i.data.length/(t.stride/4||t.size)}return 0},n.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},n.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},n.prototype.clone=function(){for(var e=new n,t=0;t<this.buffers.length;t++)e.buffers[t]=new Br(this.buffers[t].data.slice(0));for(var t in this.attributes){var i=this.attributes[t];e.attributes[t]=new aR(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=ql.ELEMENT_ARRAY_BUFFER),e},n.merge=function(e){for(var t=new n,i=[],r=[],s=[],o,a=0;a<e.length;a++){o=e[a];for(var l=0;l<o.buffers.length;l++)r[l]=r[l]||0,r[l]+=o.buffers[l].data.length,s[l]=0}for(var a=0;a<o.buffers.length;a++)i[a]=new zwe[eI(o.buffers[a].data)](r[a]),t.buffers[a]=new Br(i[a]);for(var a=0;a<e.length;a++){o=e[a];for(var l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=ql.ELEMENT_ARRAY_BUFFER;for(var c=0,u=0,h=0,d=0,a=0;a<o.buffers.length;a++)if(o.buffers[a]!==o.indexBuffer){d=a;break}for(var a in o.attributes){var f=o.attributes[a];(f.buffer|0)===d&&(u+=f.size*GU[f.type]/4)}for(var a=0;a<e.length;a++){for(var p=e[a].indexBuffer.data,l=0;l<p.length;l++)t.indexBuffer.data[l+h]+=c;c+=e[a].buffers[d].data.length/u,h+=p.length}}return t},n}(),hX=function(n){Vi(e,n);function e(){var t=n.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return e}(s_),LL=function(n){Vi(e,n);function e(){var t=n.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new Br(t.vertices),t.uvBuffer=new Br(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return e.prototype.map=function(t,i){var r=0,s=0;return this.uvs[0]=r,this.uvs[1]=s,this.uvs[2]=r+i.width/t.width,this.uvs[3]=s,this.uvs[4]=r+i.width/t.width,this.uvs[5]=s+i.height/t.height,this.uvs[6]=r,this.uvs[7]=s+i.height/t.height,r=i.x,s=i.y,this.vertices[0]=r,this.vertices[1]=s,this.vertices[2]=r+i.width,this.vertices[3]=s,this.vertices[4]=r+i.width,this.vertices[5]=s+i.height,this.vertices[6]=r,this.vertices[7]=s+i.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(s_),$we=0,vd=function(){function n(e,t,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=$we++,this.static=!!t,this.ubo=!!i,e instanceof Br?(this.buffer=e,this.buffer.type=ql.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Br(new Float32Array(1)),this.buffer.type=ql.UNIFORM_BUFFER,this.autoManage=!0))}return n.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},n.prototype.add=function(e,t,i){if(!this.ubo)this.uniforms[e]=new n(t,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")},n.from=function(e,t,i){return new n(e,t,i)},n.uboFrom=function(e,t){return new n(e,t??!0,!0)},n}(),dX=function(){function n(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Cr.NONE,this.sourceFrame=new Pt,this.destinationFrame=new Pt,this.bindingSourceFrame=new Pt,this.bindingDestinationFrame=new Pt,this.filters=[],this.transform=null}return n.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},n}(),jb=[new Ae,new Ae,new Ae,new Ae],PS=new Dt,NL=function(){function n(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new uX,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new hX,this.quadUv=new LL,this.tempRect=new Pt,this.activeState={},this.globalUniforms=new vd({outputFrame:new Pt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return n.prototype.push=function(e,t){for(var i,r,s=this.renderer,o=this.defaultFilterStack,a=this.statePool.pop()||new dX,l=this.renderer.renderTexture,c=t[0].resolution,u=t[0].multisample,h=t[0].padding,d=t[0].autoFit,f=(i=t[0].legacy)!==null&&i!==void 0?i:!0,p=1;p<t.length;p++){var g=t[p];c=Math.min(c,g.resolution),u=Math.min(u,g.multisample),h=this.useMaxPadding?Math.max(h,g.padding):h+g.padding,d=d&&g.autoFit,f=f||((r=g.legacy)!==null&&r!==void 0?r:!0)}o.length===1&&(this.defaultFilterStack[0].renderTexture=l.current),o.push(a),a.resolution=c,a.multisample=u,a.legacy=f,a.target=e,a.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),a.sourceFrame.pad(h);var m=this.tempRect.copyFrom(l.sourceFrame);s.projection.transform&&this.transformAABB(PS.copyFrom(s.projection.transform).invert(),m),d?(a.sourceFrame.fit(m),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(m)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,l.current?l.current.resolution:s.resolution,l.sourceFrame,l.destinationFrame,s.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,c,u),a.filters=t,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height;var v=this.tempRect;v.x=0,v.y=0,v.width=a.sourceFrame.width,v.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(l.sourceFrame),a.bindingDestinationFrame.copyFrom(l.destinationFrame),a.transform=s.projection.transform,s.projection.transform=null,l.bind(a.renderTexture,a.sourceFrame,v),s.framebuffer.clear(0,0,0,0)},n.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),i=t.filters;this.activeState=t;var r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;var s=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*t.resolution),o[1]=Math.round(s[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*s[2]-.5*o[2],a[3]=t.sourceFrame.height*s[3]-.5*o[3],t.legacy){var l=r.filterArea;l[0]=t.destinationFrame.width,l[1]=t.destinationFrame.height,l[2]=t.sourceFrame.x,l[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var c=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,t.renderTexture,c.renderTexture,Au.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var u=t.renderTexture,h=this.getOptimalFilterTexture(u.width,u.height,t.resolution);h.filterFrame=u.filterFrame;var d=0;for(d=0;d<i.length-1;++d){d===1&&t.multisample>1&&(h=this.getOptimalFilterTexture(u.width,u.height,t.resolution),h.filterFrame=u.filterFrame),i[d].apply(this,u,h,Au.CLEAR,t);var f=u;u=h,h=f}i[d].apply(this,u,c.renderTexture,Au.BLEND,t),d>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(h)}t.clear(),this.statePool.push(t)},n.prototype.bindAndClear=function(e,t){t===void 0&&(t=Au.CLEAR);var i=this.renderer,r=i.renderTexture,s=i.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e&&e.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,r.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var a=s.stateId&1||this.forceClear;(t===Au.CLEAR||t===Au.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)},n.prototype.applyFilter=function(e,t,i,r){var s=this.renderer;s.state.set(e.state),this.bindAndClear(i,r),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(pa.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(pa.TRIANGLE_STRIP))},n.prototype.calculateSpriteMatrix=function(e,t){var i=this.activeState,r=i.sourceFrame,s=i.destinationFrame,o=t._texture.orig,a=e.set(s.width,0,0,s.height,r.x,r.y),l=t.worldTransform.copyTo(Dt.TEMP_MATRIX);return l.invert(),a.prepend(l),a.scale(1/o.width,1/o.height),a.translate(t.anchor.x,t.anchor.y),a},n.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},n.prototype.getOptimalFilterTexture=function(e,t,i,r){return i===void 0&&(i=1),r===void 0&&(r=Cr.NONE),this.texturePool.getOptimalTexture(e,t,i,r)},n.prototype.getFilterTexture=function(e,t,i){if(typeof e=="number"){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var s=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,i||Cr.NONE);return s.filterFrame=e.filterFrame,s},n.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},n.prototype.emptyPool=function(){this.texturePool.clear(!0)},n.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},n.prototype.transformAABB=function(e,t){var i=jb[0],r=jb[1],s=jb[2],o=jb[3];i.set(t.left,t.top),r.set(t.left,t.bottom),s.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(i,i),e.apply(r,r),e.apply(s,s),e.apply(o,o);var a=Math.min(i.x,r.x,s.x,o.x),l=Math.min(i.y,r.y,s.y,o.y),c=Math.max(i.x,r.x,s.x,o.x),u=Math.max(i.y,r.y,s.y,o.y);t.x=a,t.y=l,t.width=c-a,t.height=u-l},n.prototype.roundFrame=function(e,t,i,r,s){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(s){var o=s.a,a=s.b,l=s.c,c=s.d;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(c)>1e-4))return}s=s?PS.copyFrom(s):PS.identity(),s.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(s,e),e.ceil(t),this.transformAABB(s.invert(),e)}},n}(),rb=function(){function n(e){this.renderer=e}return n.prototype.flush=function(){},n.prototype.destroy=function(){this.renderer=null},n.prototype.start=function(){},n.prototype.stop=function(){this.flush()},n.prototype.render=function(e){},n}(),BL=function(){function n(e){this.renderer=e,this.emptyRenderer=new rb(e),this.currentRenderer=this.emptyRenderer}return n.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},n.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},n.prototype.copyBoundTextures=function(e,t){for(var i=this.renderer.texture.boundTextures,r=t-1;r>=0;--r)e[r]=i[r]||null,e[r]&&(e[r]._batchLocation=r)},n.prototype.boundArray=function(e,t,i,r){for(var s=e.elements,o=e.ids,a=e.count,l=0,c=0;c<a;c++){var u=s[c],h=u._batchLocation;if(h>=0&&h<r&&t[h]===u){o[c]=h;continue}for(;l<r;){var d=t[l];if(d&&d._batchEnabled===i&&d._batchLocation===l){l++;continue}o[c]=l,u._batchLocation=l,t[l]=u;break}}},n.prototype.destroy=function(){this.renderer=null},n}(),HU=0,FL=function(){function n(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(n.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),n.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=HU++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},n.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=HU++,this.renderer.runners.contextChange.emit(e)},n.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},n.prototype.createContext=function(e,t){var i;if(xt.PREFER_ENV>=Zl.WEBGL2&&(i=e.getContext("webgl2",t)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl},n.prototype.getExtensions=function(){var e=this.gl,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})},n.prototype.handleContextLost=function(e){e.preventDefault()},n.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},n.prototype.destroy=function(){var e=this.renderer.view;this.renderer=null,e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},n.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},n.prototype.validateContext=function(e){var t=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var r=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},n}(),fX=function(){function n(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Cr.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}return n}(),Wwe=new Pt,UL=function(){function n(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new EC(10,10),this.msaaSamples=null}return n.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Pt,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var t=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;xt.PREFER_ENV===Zl.WEBGL_LEGACY&&(t=null,i=null),t?e.drawBuffers=function(r){return t.drawBuffersWEBGL(r)}:(this.hasMRT=!1,e.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},n.prototype.bind=function(e,t,i){i===void 0&&(i=0);var r=this.gl;if(e){var s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=i),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var o=0;o<e.colorTextures.length;o++){var a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){var l=t.width>>i,c=t.height>>i,u=l/t.width;this.setViewport(t.x*u,t.y*u,l,c)}else{var l=e.width>>i,c=e.height>>i;this.setViewport(0,0,l,c)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},n.prototype.setViewport=function(e,t,i,r){var s=this.viewport;e=Math.round(e),t=Math.round(t),i=Math.round(i),r=Math.round(r),(s.width!==i||s.height!==r||s.x!==e||s.y!==t)&&(s.x=e,s.y=t,s.width=i,s.height=r,this.gl.viewport(e,t,i,r))},Object.defineProperty(n.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),n.prototype.clear=function(e,t,i,r,s){s===void 0&&(s=hA.COLOR|hA.DEPTH);var o=this.gl;o.clearColor(e,t,i,r),o.clear(s)},n.prototype.initFramebuffer=function(e){var t=this.gl,i=new fX(t.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i},n.prototype.resizeFramebuffer=function(e){var t=this.gl,i=e.glFramebuffers[this.CONTEXT_UID];i.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,i.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,t.RGBA8,e.width,e.height)),i.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,i.stencil),i.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));var r=e.colorTextures,s=r.length;t.drawBuffers||(s=Math.min(s,1));for(var o=0;o<s;o++){var a=r[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0)}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)},n.prototype.updateFramebuffer=function(e,t){var i=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures,o=s.length;i.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?(r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.RGBA8,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));for(var a=[],l=0;l<o;l++){var c=s[l],u=c.parentTextureArray||c;this.renderer.texture.bind(u,0),!(l===0&&r.msaaBuffer)&&(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,c.target,u._glTextures[this.CONTEXT_UID].texture,t),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),e.depthTexture){var h=this.writeDepthTexture;if(h){var d=e.depthTexture;this.renderer.texture.bind(d,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,d._glTextures[this.CONTEXT_UID].texture,t)}}(e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.DEPTH24_STENCIL8,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r.stencil)):r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null)},n.prototype.canMultisampleFramebuffer=function(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture},n.prototype.detectSamples=function(e){var t=this.msaaSamples,i=Cr.NONE;if(e<=1||t===null)return i;for(var r=0;r<t.length;r++)if(t[r]<=e){i=t[r];break}return i===1&&(i=Cr.NONE),i},n.prototype.blit=function(e,t,i){var r=this,s=r.current,o=r.renderer,a=r.gl,l=r.CONTEXT_UID;if(o.context.webGLVersion===2&&s){var c=s.glFramebuffers[l];if(c){if(!e){if(!c.msaaBuffer)return;var u=s.colorTextures[0];if(!u)return;c.blitFramebuffer||(c.blitFramebuffer=new EC(s.width,s.height),c.blitFramebuffer.addColorTexture(0,u)),e=c.blitFramebuffer,e.colorTextures[0]!==u&&(e.colorTextures[0]=u,e.dirtyId++,e.dirtyFormat++),(e.width!==s.width||e.height!==s.height)&&(e.width=s.width,e.height=s.height,e.dirtyId++,e.dirtySize++)}t||(t=Wwe,t.width=s.width,t.height=s.height),i||(i=t);var h=t.width===i.width&&t.height===i.height;this.bind(e),a.bindFramebuffer(a.READ_FRAMEBUFFER,c.framebuffer),a.blitFramebuffer(t.left,t.top,t.right,t.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,h?a.NEAREST:a.LINEAR)}}},n.prototype.disposeFramebuffer=function(e,t){var i=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete e.glFramebuffers[this.CONTEXT_UID];var s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&i.blitFramebuffer.dispose()}},n.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<t.length;i++)this.disposeFramebuffer(t[i],e)},n.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(!(!t||t.stencil)){e.stencil=!0;var i=e.width,r=e.height,s=this.gl,o=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o),t.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,t.multisample,s.DEPTH24_STENCIL8,i,r):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i,r),t.stencil=o,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,o)}}},n.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Pt},n.prototype.destroy=function(){this.renderer=null},n}(),MS={5126:4,5123:2,5121:1},GL=function(){function n(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return n.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){var i=this.renderer.context.extensions.vertexArrayObject;xt.PREFER_ENV===Zl.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=function(){return i.createVertexArrayOES()},e.bindVertexArray=function(s){return i.bindVertexArrayOES(s)},e.deleteVertexArray=function(s){return i.deleteVertexArrayOES(s)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(t.webGLVersion!==2){var r=e.getExtension("ANGLE_instanced_arrays");r?(e.vertexAttribDivisor=function(s,o){return r.vertexAttribDivisorANGLE(s,o)},e.drawElementsInstanced=function(s,o,a,l,c){return r.drawElementsInstancedANGLE(s,o,a,l,c)},e.drawArraysInstanced=function(s,o,a,l){return r.drawArraysInstancedANGLE(s,o,a,l)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex},n.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var i=this.gl,r=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},s=!0);var o=r[t.program.id]||this.initGeometryVao(e,t,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()},n.prototype.reset=function(){this.unbind()},n.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.renderer.buffer,i=0;i<e.buffers.length;i++){var r=e.buffers[i];t.update(r)}},n.prototype.checkCompatibility=function(e,t){var i=e.attributes,r=t.attributeData;for(var s in r)if(!i[s])throw new Error('shader and geometry incompatible, geometry missing the "'+s+'" attribute')},n.prototype.getSignature=function(e,t){var i=e.attributes,r=t.attributeData,s=["g",e.id];for(var o in i)r[o]&&s.push(o,r[o].location);return s.join("-")},n.prototype.initGeometryVao=function(e,t,i){i===void 0&&(i=!0);var r=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[s]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);var l=this.getSignature(e,a),c=e.glVertexArrayObjects[this.CONTEXT_UID],u=c[l];if(u)return c[a.id]=u,u;var h=e.buffers,d=e.attributes,f={},p={};for(var g in h)f[g]=0,p[g]=0;for(var g in d)!d[g].size&&a.attributeData[g]?d[g].size=a.attributeData[g].size:d[g].size||console.warn("PIXI Geometry attribute '"+g+"' size cannot be determined (likely the bound shader does not have the attribute)"),f[d[g].buffer]+=d[g].size*MS[d[g].type];for(var g in d){var m=d[g],v=m.size;m.stride===void 0&&(f[m.buffer]===v*MS[m.type]?m.stride=0:m.stride=f[m.buffer]),m.start===void 0&&(m.start=p[m.buffer],p[m.buffer]+=v*MS[m.type])}u=r.createVertexArray(),r.bindVertexArray(u);for(var _=0;_<h.length;_++){var y=h[_];o.bind(y),i&&y._glBuffers[s].refCount++}return this.activateVao(e,a),this._activeVao=u,c[a.id]=u,c[l]=u,u},n.prototype.disposeGeometry=function(e,t){var i;if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,o=e.buffers,a=(i=this.renderer)===null||i===void 0?void 0:i.buffer;if(e.disposeRunner.remove(this),!!r){if(a)for(var l=0;l<o.length;l++){var c=o[l]._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!t&&a.dispose(o[l],t))}if(!t){for(var u in r)if(u[0]==="g"){var h=r[u];this._activeVao===h&&this.unbind(),s.deleteVertexArray(h)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},n.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),i=0;i<t.length;i++)this.disposeGeometry(this.managedGeometries[t[i]],e)},n.prototype.activateVao=function(e,t){var i=this.gl,r=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);var l=null;for(var c in a){var u=a[c],h=o[u.buffer],d=h._glBuffers[r];if(t.attributeData[c]){l!==d&&(s.bind(h),l=d);var f=t.attributeData[c].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)i.vertexAttribDivisor(f,1);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}},n.prototype.draw=function(e,t,i,r){var s=this.gl,o=this._activeGeometry;if(o.indexBuffer){var a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,t||o.indexBuffer.data.length,l,(i||0)*a,r||1):s.drawElements(e,t||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,i,t||o.getSize(),r||1):s.drawArrays(e,i,t||o.getSize());return this},n.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},n.prototype.destroy=function(){this.renderer=null},n}(),pX=function(){function n(e){e===void 0&&(e=null),this.type=Lr.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=xt.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(n.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null},enumerable:!1,configurable:!0}),n.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Lr.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},n.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},n}();function VU(n,e,t){var i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}function zU(n,e){var t=n.getShaderSource(e).split(`
`).map(function(c,u){return u+": "+c}),i=n.getShaderInfoLog(e),r=i.split(`
`),s={},o=r.map(function(c){return parseFloat(c.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(c){return c&&!s[c]?(s[c]=!0,!0):!1}),a=[""];o.forEach(function(c){t[c-1]="%c"+t[c-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var l=t.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd()}function jwe(n,e,t,i){n.getProgramParameter(e,n.LINK_STATUS)||(n.getShaderParameter(t,n.COMPILE_STATUS)||zU(n,t),n.getShaderParameter(i,n.COMPILE_STATUS)||zU(n,i),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(e)))}function RS(n){for(var e=new Array(n),t=0;t<e.length;t++)e[t]=!1;return e}function gX(n,e){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return RS(2*e);case"bvec3":return RS(3*e);case"bvec4":return RS(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var mX={},D_=mX;function vX(){if(D_===mX||D_&&D_.isContextLost()){var n=xt.ADAPTER.createCanvas(),e=void 0;xt.PREFER_ENV>=Zl.WEBGL2&&(e=n.getContext("webgl2",{})),e||(e=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),D_=e}return D_}var Qb;function Qwe(){if(!Qb){Qb=$l.MEDIUM;var n=vX();if(n&&n.getShaderPrecisionFormat){var e=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);Qb=e.precision?$l.HIGH:$l.MEDIUM}}return Qb}function $U(n,e,t){if(n.substring(0,9)!=="precision"){var i=e;return e===$l.HIGH&&t!==$l.HIGH&&(i=$l.MEDIUM),"precision "+i+` float;
`+n}else if(t!==$l.HIGH&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}var Xwe={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function _X(n){return Xwe[n]}var Xb=null,WU={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function yX(n,e){if(!Xb){var t=Object.keys(WU);Xb={};for(var i=0;i<t.length;++i){var r=t[i];Xb[n[r]]=WU[r]}}return Xb[e]}var pp=[{test:function(n){return n.type==="float"&&n.size===1},code:function(n){return`
            if(uv["`+n+'"] !== ud["'+n+`"].value)
            {
                ud["`+n+'"].value = uv["'+n+`"]
                gl.uniform1f(ud["`+n+'"].location, uv["'+n+`"])
            }
            `}},{test:function(n){return(n.type==="sampler2D"||n.type==="samplerCube"||n.type==="sampler2DArray")&&n.size===1&&!n.isArray},code:function(n){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+n+`"], t);

            if(ud["`+n+`"].value !== t)
            {
                ud["`+n+`"].value = t;
                gl.uniform1i(ud["`+n+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(n,e){return n.type==="mat3"&&n.size===1&&e.a!==void 0},code:function(n){return`
            gl.uniformMatrix3fv(ud["`+n+'"].location, false, uv["'+n+`"].toArray(true));
            `},codeUbo:function(n){return`
                var `+n+"_matrix = uv."+n+`.toArray(true);

                data[offset] = `+n+`_matrix[0];
                data[offset+1] = `+n+`_matrix[1];
                data[offset+2] = `+n+`_matrix[2];
        
                data[offset + 4] = `+n+`_matrix[3];
                data[offset + 5] = `+n+`_matrix[4];
                data[offset + 6] = `+n+`_matrix[5];
        
                data[offset + 8] = `+n+`_matrix[6];
                data[offset + 9] = `+n+`_matrix[7];
                data[offset + 10] = `+n+`_matrix[8];
            `}},{test:function(n,e){return n.type==="vec2"&&n.size===1&&e.x!==void 0},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+n+`"].location, v.x, v.y);
                }`},codeUbo:function(n){return`
                v = uv.`+n+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(n){return n.type==="vec2"&&n.size===1},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+n+`"].location, v[0], v[1]);
                }
            `}},{test:function(n,e){return n.type==="vec4"&&n.size===1&&e.width!==void 0},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+n+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(n){return`
                    v = uv.`+n+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(n){return n.type==="vec4"&&n.size===1},code:function(n){return`
                cv = ud["`+n+`"].value;
                v = uv["`+n+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+n+`"].location, v[0], v[1], v[2], v[3])
                }`}}],Ywe={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},qwe={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Kwe(n,e){var t,i=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var r in n.uniforms){var s=e[r];if(!s){!((t=n.uniforms[r])===null||t===void 0)&&t.group&&(n.uniforms[r].ubo?i.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+r+", '"+r+`');
                    `):i.push(`
                        renderer.shader.syncUniformGroup(uv.`+r+`, syncData);
                    `));continue}for(var o=n.uniforms[r],a=!1,l=0;l<pp.length;l++)if(pp[l].test(s,o)){i.push(pp[l].code(r,o)),a=!0;break}if(!a){var c=s.size===1?Ywe:qwe,u=c[s.type].replace("location",'ud["'+r+'"].location');i.push(`
            cu = ud["`+r+`"];
            cv = cu.value;
            v = uv["`+r+`"];
            `+u+";")}}return new Function("ud","uv","renderer","syncData",i.join(`
`))}var Jwe=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Zwe(n){for(var e="",t=0;t<n;++t)t>0&&(e+=`
else `),t<n-1&&(e+="if(test == "+t+".0){}");return e}function AX(n,e){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var t=e.createShader(e.FRAGMENT_SHADER);;){var i=Jwe.replace(/%forloop%/gi,Zwe(n));if(e.shaderSource(t,i),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))n=n/2|0;else break}return n}var k_;function exe(){if(typeof k_=="boolean")return k_;try{var n=new Function("param1","param2","param3","return param1[param2] === param3;");k_=n({a:"b"},"a","b")===!0}catch{k_=!1}return k_}var txe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,nxe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,ixe=0,Yb={},o_=function(){function n(e,t,i){i===void 0&&(i="pixi-shader"),this.id=ixe++,this.vertexSrc=e||n.defaultVertexSrc,this.fragmentSrc=t||n.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),Yb[i]?(Yb[i]++,i+="-"+Yb[i]):Yb[i]=1,this.vertexSrc="#define SHADER_NAME "+i+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+`
`+this.fragmentSrc,this.vertexSrc=$U(this.vertexSrc,xt.PRECISION_VERTEX,$l.HIGH),this.fragmentSrc=$U(this.fragmentSrc,xt.PRECISION_FRAGMENT,Qwe())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(n,"defaultVertexSrc",{get:function(){return nxe},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultFragmentSrc",{get:function(){return txe},enumerable:!1,configurable:!0}),n.from=function(e,t,i){var r=e+t,s=tR[r];return s||(tR[r]=s=new n(e,t,i)),s},n}(),Ku=function(){function n(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof vd?this.uniformGroup=t:this.uniformGroup=new vd(t):this.uniformGroup=new vd({})}return n.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var i in t.uniforms){var r=t.uniforms[i];if(r.group&&this.checkUniformExists(e,r))return!0}return!1},n.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(n.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),n.from=function(e,t,i){var r=o_.from(e,t);return new n(r,i)},n}(),DS=0,kS=1,OS=2,LS=3,NS=4,BS=5,Bd=function(){function n(){this.data=0,this.blendMode=Xt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(n.prototype,"blend",{get:function(){return!!(this.data&1<<DS)},set:function(e){!!(this.data&1<<DS)!==e&&(this.data^=1<<DS)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"offsets",{get:function(){return!!(this.data&1<<kS)},set:function(e){!!(this.data&1<<kS)!==e&&(this.data^=1<<kS)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"culling",{get:function(){return!!(this.data&1<<OS)},set:function(e){!!(this.data&1<<OS)!==e&&(this.data^=1<<OS)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"depthTest",{get:function(){return!!(this.data&1<<LS)},set:function(e){!!(this.data&1<<LS)!==e&&(this.data^=1<<LS)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"depthMask",{get:function(){return!!(this.data&1<<BS)},set:function(e){!!(this.data&1<<BS)!==e&&(this.data^=1<<BS)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<NS)},set:function(e){!!(this.data&1<<NS)!==e&&(this.data^=1<<NS)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==Xt.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),n.prototype.toString=function(){return"[@pixi/core:State "+("blendMode="+this.blendMode+" ")+("clockwiseFrontFace="+this.clockwiseFrontFace+" ")+("culling="+this.culling+" ")+("depthMask="+this.depthMask+" ")+("polygonOffset="+this.polygonOffset)+"]"},n.for2d=function(){var e=new n;return e.depthTest=!1,e.blend=!0,e},n}(),rxe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,sxe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,yn=function(n){Vi(e,n);function e(t,i,r){var s=this,o=o_.from(t||e.defaultVertexSrc,i||e.defaultFragmentSrc);return s=n.call(this,o,r)||this,s.padding=0,s.resolution=xt.FILTER_RESOLUTION,s.multisample=xt.FILTER_MULTISAMPLE,s.enabled=!0,s.autoFit=!0,s.state=new Bd,s}return e.prototype.apply=function(t,i,r,s,o){t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return sxe},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return rxe},enumerable:!1,configurable:!0}),e}(Ku),oxe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,axe=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,jU=new Dt,rI=function(){function n(e,t){this._texture=e,this.mapCoord=new Dt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}return Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),n.prototype.multiplyUvs=function(e,t){t===void 0&&(t=e);for(var i=this.mapCoord,r=0;r<e.length;r+=2){var s=e[r],o=e[r+1];t[r]=s*i.a+o*i.c+i.tx,t[r+1]=s*i.b+o*i.d+i.ty}return t},n.prototype.update=function(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var i=t._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=t.orig,s=t.trim;s&&(jU.set(r.width/s.width,0,0,r.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(jU));var o=t.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,c=this.clampOffset;return a[0]=(t._frame.x+l+c)/o.width,a[1]=(t._frame.y+l+c)/o.height,a[2]=(t._frame.x+t._frame.width-l+c)/o.width,a[3]=(t._frame.y+t._frame.height-l+c)/o.height,this.uClampOffset[0]=c/o.realWidth,this.uClampOffset[1]=c/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&t.rotate===0,!0},n}(),bX=function(n){Vi(e,n);function e(t,i,r){var s=this,o=null;return typeof t!="string"&&i===void 0&&r===void 0&&(o=t,t=void 0,i=void 0,r=void 0),s=n.call(this,t||oxe,i||axe,r)||this,s.maskSprite=o,s.maskMatrix=new Dt,s}return Object.defineProperty(e.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,i,r,s){var o=this._maskSprite,a=o._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new rI(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,i,r,s))},e}(yn),HL=function(){function n(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return n.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},n.prototype.push=function(e,t){var i=t;if(!i.isMaskData){var r=this.maskDataPool.pop()||new pX;r.pooled=!0,r.maskObject=t,i=r}var s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(s),i._colorMask=s?s._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==Lr.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Lr.SCISSOR:this.renderer.scissor.push(i);break;case Lr.STENCIL:this.renderer.stencil.push(i);break;case Lr.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Lr.COLOR:this.pushColorMask(i);break}i.type===Lr.SPRITE&&this.maskStack.push(i)},n.prototype.pop=function(e){var t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case Lr.SCISSOR:this.renderer.scissor.pop(t);break;case Lr.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case Lr.SPRITE:this.popSpriteMask(t);break;case Lr.COLOR:this.popColorMask(t);break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){var i=this.maskStack[this.maskStack.length-1];i.type===Lr.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}},n.prototype.detect=function(e){var t=e.maskObject;t?t.isSprite?e.type=Lr.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Lr.SCISSOR:e.type=Lr.STENCIL:e.type=Lr.COLOR},n.prototype.pushSpriteMask=function(e){var t,i,r=e.maskObject,s=e._target,o=e._filters;o||(o=this.alphaMaskPool[this.alphaMaskIndex],o||(o=this.alphaMaskPool[this.alphaMaskIndex]=[new bX]));var a=this.renderer,l=a.renderTexture,c,u;if(l.current){var h=l.current;c=e.resolution||h.resolution,u=(t=e.multisample)!==null&&t!==void 0?t:h.multisample}else c=e.resolution||a.resolution,u=(i=e.multisample)!==null&&i!==void 0?i:a.multisample;o[0].resolution=c,o[0].multisample=u,o[0].maskSprite=r;var d=s.filterArea;s.filterArea=r.getBounds(!0),a.filter.push(s,o),s.filterArea=d,e._filters||this.alphaMaskIndex++},n.prototype.popSpriteMask=function(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},n.prototype.pushColorMask=function(e){var t=e._colorMask,i=e._colorMask=t&e.colorMask;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)},n.prototype.popColorMask=function(e){var t=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)},n.prototype.destroy=function(){this.renderer=null},n}(),wX=function(){function n(e){this.renderer=e,this.maskStack=[],this.glConst=0}return n.prototype.getStackLength=function(){return this.maskStack.length},n.prototype.setMaskStack=function(e){var t=this.renderer.gl,i=this.getStackLength();this.maskStack=e;var r=this.getStackLength();r!==i&&(r===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},n.prototype._useCurrent=function(){},n.prototype.destroy=function(){this.renderer=null,this.maskStack=null},n}(),QU=new Dt,XU=[],VL=function(n){Vi(e,n);function e(t){var i=n.call(this,t)||this;return i.glConst=xt.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,i}return e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.calcScissorRect=function(t){var i;if(!t._scissorRectLocal){var r=t._scissorRect,s=t.maskObject,o=this.renderer,a=o.renderTexture,l=s.getBounds(!0,(i=XU.pop())!==null&&i!==void 0?i:new Pt);this.roundFrameToPixels(l,a.current?a.current.resolution:o.resolution,a.sourceFrame,a.destinationFrame,o.projection.transform),r&&l.fit(r),t._scissorRectLocal=l}},e.isMatrixRotated=function(t){if(!t)return!1;var i=t.a,r=t.b,s=t.c,o=t.d;return(Math.abs(r)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(i)>1e-4||Math.abs(o)>1e-4)},e.prototype.testScissor=function(t){var i=t.maskObject;if(!i.isFastRect||!i.isFastRect()||e.isMatrixRotated(i.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var r=t._scissorRectLocal;return r.width>0&&r.height>0},e.prototype.roundFrameToPixels=function(t,i,r,s,o){e.isMatrixRotated(o)||(o=o?QU.copyFrom(o):QU.identity(),o.translate(-r.x,-r.y).scale(s.width/r.width,s.height/r.height).translate(s.x,s.y),this.renderer.filter.transformAABB(o,t),t.fit(s),t.x=Math.round(t.x*i),t.y=Math.round(t.y*i),t.width=Math.round(t.width*i),t.height=Math.round(t.height*i))},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var i=this.renderer.gl;t._scissorRect||i.enable(i.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()},e.prototype.pop=function(t){var i=this.renderer.gl;t&&XU.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():i.disable(i.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,i;this.renderer.renderTexture.current?i=t.y:i=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,i,t.width,t.height)},e}(wX),zL=function(n){Vi(e,n);function e(t){var i=n.call(this,t)||this;return i.glConst=xt.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,i}return e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var i=t.maskObject,r=this.renderer.gl,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),t._stencilCounter++;var o=t._colorMask;o!==0&&(t._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,s,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,o!==0&&(t._colorMask=o,r.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()},e.prototype.pop=function(t){var i=this.renderer.gl;if(this.getStackLength()===0)i.disable(i.STENCIL_TEST);else{var r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=r?r._colorMask:15;s!==0&&(r._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilOp(i.KEEP,i.KEEP,i.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(r._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(wX),$L=function(){function n(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Dt,this.transform=null}return n.prototype.update=function(e,t,i,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)},n.prototype.calculateProjection=function(e,t,i,r){var s=this.projectionMatrix,o=r?-1:1;s.identity(),s.a=1/t.width*2,s.d=o*(1/t.height*2),s.tx=-1-t.x*s.a,s.ty=-o-t.y*s.d},n.prototype.setTransform=function(e){},n.prototype.destroy=function(){this.renderer=null},n}(),$d=new Pt,O_=new Pt,WL=function(){function n(e){this.renderer=e,this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Pt,this.destinationFrame=new Pt,this.viewportFrame=new Pt}return n.prototype.bind=function(e,t,i){e===void 0&&(e=null);var r=this.renderer;this.current=e;var s,o,a;e?(s=e.baseTexture,a=s.resolution,t||($d.width=e.frame.width,$d.height=e.frame.height,t=$d),i||(O_.x=e.frame.x,O_.y=e.frame.y,O_.width=t.width,O_.height=t.height,i=O_),o=s.framebuffer):(a=r.resolution,t||($d.width=r.screen.width,$d.height=r.screen.height,t=$d),i||(i=$d,i.width=t.width,i.height=t.height));var l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,e||(l.y=r.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,t,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(i)},n.prototype.clear=function(e,t){this.current?e=e||this.current.baseTexture.clearColor:e=e||this.clearColor;var i=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer.screen,s=i.width!==r.width||i.height!==r.height;if(s){var o=this.viewportFrame,a=o.x,l=o.y,c=o.width,u=o.height;a=Math.round(a),l=Math.round(l),c=Math.round(c),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(a,l,c,u)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t),s&&this.renderer.scissor.pop()},n.prototype.resize=function(){this.bind(null)},n.prototype.reset=function(){this.bind(null)},n.prototype.destroy=function(){this.renderer=null},n}();function lxe(n,e,t,i,r){t.buffer.update(r)}var cxe={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},xX={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function CX(n){for(var e=n.map(function(l){return{data:l,offset:0,dataLen:0,dirty:0}}),t=0,i=0,r=0,s=0;s<e.length;s++){var o=e[s];if(t=xX[o.data.type],o.data.size>1&&(t=Math.max(t,16)*o.data.size),o.dataLen=t,i%t!==0&&i<16){var a=i%t%16;i+=a,r+=a}i+t>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=t,i=t):(o.offset=r,i+=t,r+=t)}return r=Math.ceil(r/16)*16,{uboElements:e,size:r}}function EX(n,e){var t=[];for(var i in n)e[i]&&t.push(e[i]);return t.sort(function(r,s){return r.index-s.index}),t}function TX(n,e){if(!n.autoManage)return{size:0,syncFunc:lxe};for(var t=EX(n.uniforms,e),i=CX(t),r=i.uboElements,s=i.size,o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],a=0;a<r.length;a++){for(var l=r[a],c=n.uniforms[l.data.name],u=l.data.name,h=!1,d=0;d<pp.length;d++){var f=pp[d];if(f.codeUbo&&f.test(l.data,c)){o.push("offset = "+l.offset/4+";",pp[d].codeUbo(l.data.name,c)),h=!0;break}}if(!h)if(l.data.size>1){var p=_X(l.data.type),g=Math.max(xX[l.data.type]/16,1),m=p/g,v=(4-m%4)%4;o.push(`
                cv = ud.`+u+`.value;
                v = uv.`+u+`;
                offset = `+l.offset/4+`;

                t = 0;

                for(var i=0; i < `+l.data.size*g+`; i++)
                {
                    for(var j = 0; j < `+m+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+v+`;
                }

                `)}else{var _=cxe[l.data.type];o.push(`
                cv = ud.`+u+`.value;
                v = uv.`+u+`;
                offset = `+l.offset/4+`;
                `+_+`;
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}var uxe=function(){function n(){}return n}(),IX=function(){function n(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return n.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},n}();function hxe(n,e){for(var t={},i=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES),r=0;r<i;r++){var s=e.getActiveAttrib(n,r);if(s.name.indexOf("gl_")!==0){var o=yX(e,s.type),a={type:o,name:s.name,size:_X(o),location:e.getAttribLocation(n,s.name)};t[s.name]=a}}return t}function dxe(n,e){for(var t={},i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),r=0;r<i;r++){var s=e.getActiveUniform(n,r),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=yX(e,s.type);t[o]={name:o,index:r,type:l,size:s.size,isArray:a,value:gX(l,s.size)}}return t}function SX(n,e){var t=VU(n,n.VERTEX_SHADER,e.vertexSrc),i=VU(n,n.FRAGMENT_SHADER,e.fragmentSrc),r=n.createProgram();if(n.attachShader(r,t),n.attachShader(r,i),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)||jwe(n,r,t,i),e.attributeData=hxe(r,n),e.uniformData=dxe(r,n),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var s=Object.keys(e.attributeData);s.sort(function(u,h){return u>h?1:-1});for(var o=0;o<s.length;o++)e.attributeData[s[o]].location=o,n.bindAttribLocation(r,o,s[o]);n.linkProgram(r)}n.deleteShader(t),n.deleteShader(i);var a={};for(var o in e.uniformData){var l=e.uniformData[o];a[o]={location:n.getUniformLocation(r,o),value:gX(l.type,l.size)}}var c=new IX(r,a);return c}var fxe=0,qb={textureCount:0,uboCount:0},jL=function(){function n(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=fxe++}return n.prototype.systemCheck=function(){if(!exe())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},n.prototype.contextChange=function(e){this.gl=e,this.reset()},n.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var i=e.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),t||(qb.textureCount=0,qb.uboCount=0,this.syncUniformGroup(e.uniformGroup,qb)),r},n.prototype.setUniforms=function(e){var t=this.shader.program,i=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(i.uniformData,e,this.renderer)},n.prototype.syncUniformGroup=function(e,t){var i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,t))},n.prototype.syncUniforms=function(e,t,i){var r=e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e);r(t.uniformData,e.uniforms,this.renderer,i)},n.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=Kwe(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},n.prototype.syncUniformBufferGroup=function(e,t){var i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;var r=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,t);e.buffer.update(),r(i.uniformData,e.uniforms,this.renderer,qb,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[t])},n.prototype.createSyncBufferGroup=function(e,t,i){var r=this.renderer.gl;this.renderer.buffer.bind(e.buffer);var s=this.gl.getUniformBlockIndex(t.program,i);t.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(t.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;var o=this.getSignature(e,this.shader.program.uniformData,"ubo"),a=this._uboCache[o];if(a||(a=this._uboCache[o]=TX(e,this.shader.program.uniformData)),e.autoManage){var l=new Float32Array(a.size/4);e.buffer.update(l)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]},n.prototype.getSignature=function(e,t,i){var r=e.uniforms,s=[i+"-"];for(var o in r)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")},n.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},n.prototype.generateProgram=function(e){var t=this.gl,i=e.program,r=SX(t,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r},n.prototype.reset=function(){this.program=null,this.shader=null},n.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},n}();function pxe(n,e){return e===void 0&&(e=[]),e[Xt.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.ADD]=[n.ONE,n.ONE],e[Xt.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.NONE]=[0,0],e[Xt.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],e[Xt.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[Xt.SRC_IN]=[n.DST_ALPHA,n.ZERO],e[Xt.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],e[Xt.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[Xt.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],e[Xt.DST_IN]=[n.ZERO,n.SRC_ALPHA],e[Xt.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],e[Xt.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],e[Xt.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[Xt.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],e}var gxe=0,mxe=1,vxe=2,_xe=3,yxe=4,Axe=5,QL=function(){function n(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Xt.NONE,this._blendEq=!1,this.map=[],this.map[gxe]=this.setBlend,this.map[mxe]=this.setOffset,this.map[vxe]=this.setCullFace,this.map[_xe]=this.setDepthTest,this.map[yxe]=this.setFrontFace,this.map[Axe]=this.setDepthMask,this.checks=[],this.defaultState=new Bd,this.defaultState.blend=!0}return n.prototype.contextChange=function(e){this.gl=e,this.blendModes=pxe(e),this.set(this.defaultState),this.reset()},n.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,i=0;t;)t&1&&this.map[i].call(this,!!(e.data&1<<i)),t=t>>1,i++;this.stateId=e.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,e)},n.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(var t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},n.prototype.setBlend=function(e){this.updateCheck(n.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},n.prototype.setOffset=function(e){this.updateCheck(n.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},n.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},n.prototype.setDepthMask=function(e){this.gl.depthMask(e)},n.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},n.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},n.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],i=this.gl;t.length===2?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},n.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},n.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},n.prototype.updateCheck=function(e,t){var i=this.checks.indexOf(e);t&&i===-1?this.checks.push(e):!t&&i!==-1&&this.checks.splice(i,1)},n.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},n.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},n.prototype.destroy=function(){this.gl=null},n}(),XL=function(){function n(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=xt.GC_MAX_IDLE,this.checkCountMax=xt.GC_MAX_CHECK_COUNT,this.mode=xt.GC_MODE}return n.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==CC.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},n.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,i=!1,r=0;r<t.length;r++){var s=t[r];!s.framebuffer&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),t[r]=null,i=!0)}if(i){for(var o=0,r=0;r<t.length;r++)t[r]!==null&&(t[o++]=t[r]);t.length=o}},n.prototype.unload=function(e){var t=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&t.destroyTexture(i);for(var r=e.children.length-1;r>=0;r--)this.unload(e.children[r])},n.prototype.destroy=function(){this.renderer=null},n}();function bxe(n){var e,t,i,r,s,o,a,l,c,u,h,d,f,p,g,m,v,_,y,A,w,b,C;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?C=(e={},e[qt.UNSIGNED_BYTE]=(t={},t[At.RGBA]=n.RGBA8,t[At.RGB]=n.RGB8,t[At.RG]=n.RG8,t[At.RED]=n.R8,t[At.RGBA_INTEGER]=n.RGBA8UI,t[At.RGB_INTEGER]=n.RGB8UI,t[At.RG_INTEGER]=n.RG8UI,t[At.RED_INTEGER]=n.R8UI,t[At.ALPHA]=n.ALPHA,t[At.LUMINANCE]=n.LUMINANCE,t[At.LUMINANCE_ALPHA]=n.LUMINANCE_ALPHA,t),e[qt.BYTE]=(i={},i[At.RGBA]=n.RGBA8_SNORM,i[At.RGB]=n.RGB8_SNORM,i[At.RG]=n.RG8_SNORM,i[At.RED]=n.R8_SNORM,i[At.RGBA_INTEGER]=n.RGBA8I,i[At.RGB_INTEGER]=n.RGB8I,i[At.RG_INTEGER]=n.RG8I,i[At.RED_INTEGER]=n.R8I,i),e[qt.UNSIGNED_SHORT]=(r={},r[At.RGBA_INTEGER]=n.RGBA16UI,r[At.RGB_INTEGER]=n.RGB16UI,r[At.RG_INTEGER]=n.RG16UI,r[At.RED_INTEGER]=n.R16UI,r[At.DEPTH_COMPONENT]=n.DEPTH_COMPONENT16,r),e[qt.SHORT]=(s={},s[At.RGBA_INTEGER]=n.RGBA16I,s[At.RGB_INTEGER]=n.RGB16I,s[At.RG_INTEGER]=n.RG16I,s[At.RED_INTEGER]=n.R16I,s),e[qt.UNSIGNED_INT]=(o={},o[At.RGBA_INTEGER]=n.RGBA32UI,o[At.RGB_INTEGER]=n.RGB32UI,o[At.RG_INTEGER]=n.RG32UI,o[At.RED_INTEGER]=n.R32UI,o[At.DEPTH_COMPONENT]=n.DEPTH_COMPONENT24,o),e[qt.INT]=(a={},a[At.RGBA_INTEGER]=n.RGBA32I,a[At.RGB_INTEGER]=n.RGB32I,a[At.RG_INTEGER]=n.RG32I,a[At.RED_INTEGER]=n.R32I,a),e[qt.FLOAT]=(l={},l[At.RGBA]=n.RGBA32F,l[At.RGB]=n.RGB32F,l[At.RG]=n.RG32F,l[At.RED]=n.R32F,l[At.DEPTH_COMPONENT]=n.DEPTH_COMPONENT32F,l),e[qt.HALF_FLOAT]=(c={},c[At.RGBA]=n.RGBA16F,c[At.RGB]=n.RGB16F,c[At.RG]=n.RG16F,c[At.RED]=n.R16F,c),e[qt.UNSIGNED_SHORT_5_6_5]=(u={},u[At.RGB]=n.RGB565,u),e[qt.UNSIGNED_SHORT_4_4_4_4]=(h={},h[At.RGBA]=n.RGBA4,h),e[qt.UNSIGNED_SHORT_5_5_5_1]=(d={},d[At.RGBA]=n.RGB5_A1,d),e[qt.UNSIGNED_INT_2_10_10_10_REV]=(f={},f[At.RGBA]=n.RGB10_A2,f[At.RGBA_INTEGER]=n.RGB10_A2UI,f),e[qt.UNSIGNED_INT_10F_11F_11F_REV]=(p={},p[At.RGB]=n.R11F_G11F_B10F,p),e[qt.UNSIGNED_INT_5_9_9_9_REV]=(g={},g[At.RGB]=n.RGB9_E5,g),e[qt.UNSIGNED_INT_24_8]=(m={},m[At.DEPTH_STENCIL]=n.DEPTH24_STENCIL8,m),e[qt.FLOAT_32_UNSIGNED_INT_24_8_REV]=(v={},v[At.DEPTH_STENCIL]=n.DEPTH32F_STENCIL8,v),e):C=(_={},_[qt.UNSIGNED_BYTE]=(y={},y[At.RGBA]=n.RGBA,y[At.RGB]=n.RGB,y[At.ALPHA]=n.ALPHA,y[At.LUMINANCE]=n.LUMINANCE,y[At.LUMINANCE_ALPHA]=n.LUMINANCE_ALPHA,y),_[qt.UNSIGNED_SHORT_5_6_5]=(A={},A[At.RGB]=n.RGB,A),_[qt.UNSIGNED_SHORT_4_4_4_4]=(w={},w[At.RGBA]=n.RGBA,w),_[qt.UNSIGNED_SHORT_5_5_5_1]=(b={},b[At.RGBA]=n.RGBA,b),_),C}var Lx=function(){function n(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=qt.UNSIGNED_BYTE,this.internalFormat=At.RGBA,this.samplerType=0}return n}(),YL=function(){function n(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new In,this.hasIntegerTextures=!1}return n.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=bxe(e);var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var i=0;i<t;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new Lx(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Lx(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(var i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(var i=0;i<this.boundTextures.length;i++)this.bind(null,i)},n.prototype.bind=function(e,t){t===void 0&&(t=0);var i=this.gl;if(e=e==null?void 0:e.castToBaseTexture(),e&&e.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;var r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[t]=null},n.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},n.prototype.unbind=function(e){var t=this,i=t.gl,r=t.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var s=0;s<r.length;s++)r[s]===this.unknownTexture&&this.bind(null,s)}for(var s=0;s<r.length;s++)r[s]===e&&(this.currentLocation!==s&&(i.activeTexture(i.TEXTURE0+s),this.currentLocation=s),i.bindTexture(e.target,this.emptyTextures[e.target].texture),r[s]=null)},n.prototype.ensureSamplerType=function(e){var t=this,i=t.boundTextures,r=t.hasIntegerTextures,s=t.CONTEXT_UID;if(r)for(var o=e-1;o>=0;--o){var a=i[o];if(a){var l=a._glTextures[s];l.samplerType!==dA.FLOAT&&this.renderer.texture.unbind(a)}}},n.prototype.initTexture=function(e){var t=new Lx(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},n.prototype.initTextureType=function(e,t){var i,r;t.internalFormat=(r=(i=this.internalFormats[e.type])===null||i===void 0?void 0:i[e.format])!==null&&r!==void 0?r:e.format,this.webGLVersion===2&&e.type===qt.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type},n.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var i=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(i,e,t))t.samplerType!==dA.FLOAT&&(this.hasIntegerTextures=!0);else{var r=e.realWidth,s=e.realHeight,o=i.gl;(t.width!==r||t.height!==s||t.dirtyId<0)&&(t.width=r,t.height=s,o.texImage2D(e.target,0,t.internalFormat,r,s,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},n.prototype.destroyTexture=function(e,t){var i=this.gl;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var r=this.managedTextures.indexOf(e);r!==-1&&fp(this.managedTextures,r,1)}},n.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===sl.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=Oc.CLAMP:t.wrapMode=e.wrapMode,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},n.prototype.setStyle=function(e,t){var i=this.gl;if(t.mipmap&&e.mipmap!==sl.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===ga.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===ga.LINEAR){var s=Math.min(e.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===ga.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===ga.LINEAR?i.LINEAR:i.NEAREST)},n.prototype.destroy=function(){this.renderer=null},n}(),PX={__proto__:null,FilterSystem:NL,BatchSystem:BL,ContextSystem:FL,FramebufferSystem:UL,GeometrySystem:GL,MaskSystem:HL,ScissorSystem:VL,StencilSystem:zL,ProjectionSystem:$L,RenderTextureSystem:WL,ShaderSystem:jL,StateSystem:QL,TextureGCSystem:XL,TextureSystem:YL},FS=new Dt,MX=function(n){Vi(e,n);function e(t,i){t===void 0&&(t=Tv.UNKNOWN);var r=n.call(this)||this;return i=Object.assign({},xt.RENDER_OPTIONS,i),r.options=i,r.type=t,r.screen=new Pt(0,0,i.width,i.height),r.view=i.view||xt.ADAPTER.createCanvas(),r.resolution=i.resolution||xt.RESOLUTION,r.useContextAlpha=i.useContextAlpha,r.autoDensity=!!i.autoDensity,r.preserveDrawingBuffer=i.preserveDrawingBuffer,r.clearBeforeRender=i.clearBeforeRender,r._backgroundColor=0,r._backgroundColorRgba=[0,0,0,1],r._backgroundColorString="#000000",r.backgroundColor=i.backgroundColor||r._backgroundColor,r.backgroundAlpha=i.backgroundAlpha,i.transparent!==void 0&&(Go("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),r.useContextAlpha=i.transparent,r.backgroundAlpha=i.transparent?0:1),r._lastObjectRendered=null,r.plugins={},r}return e.prototype.initPlugins=function(t){for(var i in t)this.plugins[i]=new t[i](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,i){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(i*this.resolution);var r=this.view.width/this.resolution,s=this.view.height/this.resolution;this.screen.width=r,this.screen.height=s,this.autoDensity&&(this.view.style.width=r+"px",this.view.style.height=s+"px"),this.emit("resize",r,s)},e.prototype.generateTexture=function(t,i,r,s){i===void 0&&(i={}),typeof i=="number"&&(Go("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),i={scaleMode:i,resolution:r,region:s});var o=i.region,a=Nwe(i,["region"]);s=o||t.getLocalBounds(null,!0),s.width===0&&(s.width=1),s.height===0&&(s.height=1);var l=va.create(oR({width:s.width,height:s.height},a));return FS.tx=-s.x,FS.ty=-s.y,this.render(t,{renderTexture:l,clear:!1,transform:FS,skipUpdateTransform:!!t.parent}),l},e.prototype.destroy=function(t){for(var i in this.plugins)this.plugins[i].destroy(),this.plugins[i]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var r=this;r.plugins=null,r.type=Tv.UNKNOWN,r.view=null,r.screen=null,r._tempDisplayObjectParent=null,r.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=bL(t),_s(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}(Zr),wxe=function(){function n(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}return n}(),xxe=function(){function n(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}return n.prototype.destroy=function(){this.renderer=null},n.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},n.prototype.bind=function(e){var t=this,i=t.gl,r=t.CONTEXT_UID,s=e._glBuffers[r]||this.createGLBuffer(e);i.bindBuffer(e.type,s.buffer)},n.prototype.bindBufferBase=function(e,t){var i=this,r=i.gl,s=i.CONTEXT_UID;if(this.boundBufferBases[t]!==e){var o=e._glBuffers[s]||this.createGLBuffer(e);this.boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,o.buffer)}},n.prototype.bindBufferRange=function(e,t,i){var r=this,s=r.gl,o=r.CONTEXT_UID;i=i||0;var a=e._glBuffers[o]||this.createGLBuffer(e);s.bindBufferRange(s.UNIFORM_BUFFER,t||0,a.buffer,i*256,256)},n.prototype.update=function(e){var t=this,i=t.gl,r=t.CONTEXT_UID,s=e._glBuffers[r];if(e._updateID!==s.updateID)if(s.updateID=e._updateID,i.bindBuffer(e.type,s.buffer),s.byteLength>=e.data.byteLength)i.bufferSubData(e.type,0,e.data);else{var o=e.static?i.STATIC_DRAW:i.DYNAMIC_DRAW;s.byteLength=e.data.byteLength,i.bufferData(e.type,e.data,o)}},n.prototype.dispose=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var i=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),i&&(t||r.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}},n.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedBuffers),i=0;i<t.length;i++)this.dispose(this.managedBuffers[t[i]],e)},n.prototype.createGLBuffer=function(e){var t=this,i=t.CONTEXT_UID,r=t.gl;return e._glBuffers[i]=new wxe(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[i]},n}(),sb=function(n){Vi(e,n);function e(t){var i=n.call(this,Tv.WEBGL,t)||this;return t=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new us("destroy"),contextChange:new us("contextChange"),reset:new us("reset"),update:new us("update"),postrender:new us("postrender"),prerender:new us("prerender"),resize:new us("resize")},i.runners.contextChange.add(i),i.globalUniforms=new vd({projectionMatrix:new Dt},!0),i.addSystem(HL,"mask").addSystem(FL,"context").addSystem(QL,"state").addSystem(jL,"shader").addSystem(YL,"texture").addSystem(xxe,"buffer").addSystem(GL,"geometry").addSystem(UL,"framebuffer").addSystem(VL,"scissor").addSystem(zL,"stencil").addSystem($L,"projection").addSystem(XL,"textureGC").addSystem(NL,"filter").addSystem(WL,"renderTexture").addSystem(BL,"batch"),i.initPlugins(e.__plugins),i.multisample=void 0,t.context?i.context.initFromContext(t.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:t.antialias,premultipliedAlpha:i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,nX(i.context.webGLVersion===2?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return e.create=function(t){if(iX())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t=this.gl,i;if(this.context.webGLVersion===1){var r=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),i=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,r)}else{var r=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),i=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,r)}i>=Cr.HIGH?this.multisample=Cr.HIGH:i>=Cr.MEDIUM?this.multisample=Cr.MEDIUM:i>=Cr.LOW?this.multisample=Cr.LOW:this.multisample=Cr.NONE},e.prototype.addSystem=function(t,i){var r=new t(this);if(this[i])throw new Error('Whoops! The name "'+i+'" is already in use');this[i]=r;for(var s in this.runners)this.runners[s].add(r);return this},e.prototype.render=function(t,i){var r,s,o,a;if(i&&(i instanceof va?(Go("6.0.0","Renderer#render arguments changed, use options instead."),r=i,s=arguments[2],o=arguments[3],a=arguments[4]):(r=i.renderTexture,s=i.clear,o=i.transform,a=i.skipUpdateTransform)),this.renderingToScreen=!r,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=o,!this.context.isLost){if(r||(this._lastObjectRendered=t),!a){var l=t.enableTempParent();t.updateTransform(),t.disableTempParent(l)}this.renderTexture.bind(r),this.batch.currentRenderer.start(),(s!==void 0?s:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),r&&r.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(t,i,r,s){i===void 0&&(i={});var o=n.prototype.generateTexture.call(this,t,i,r,s);return this.framebuffer.blit(),o},e.prototype.resize=function(t,i){n.prototype.resize.call(this,t,i),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(t){this.runners.destroy.emit();for(var i in this.runners)this.runners[i].destroy();n.prototype.destroy.call(this,t),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return Go("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,i){Go("6.5.0","Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),rc.add({name:t,type:ai.RendererPlugin,ref:i})},e.__plugins={},e}(MX);rc.handleByMap(ai.RendererPlugin,sb.__plugins);function RX(n){return sb.create(n)}var Cxe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Exe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,DX=Cxe,qL=Exe,Txe=function(){function n(e){Go("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=e}return n.prototype.destroy=function(){this.renderer=null},n}(),TC=function(){function n(){this.texArray=null,this.blend=0,this.type=pa.TRIANGLES,this.start=0,this.size=0,this.data=null}return n}(),IC=function(){function n(){this.elements=[],this.ids=[],this.count=0}return n.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},n}(),SC=function(){function n(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(n.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),n.prototype.view=function(e){return this[e+"View"]},n.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},n.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},n}(),kX=function(n){Vi(e,n);function e(t){var i=n.call(this,t)||this;return i.shaderGenerator=null,i.geometryClass=null,i.vertexSize=null,i.state=Bd.for2d(),i.size=xt.SPRITE_BATCH_SIZE*4,i._vertexCount=0,i._indexCount=0,i._bufferedElements=[],i._bufferedTextures=[],i._bufferSize=0,i._shader=null,i._packedGeometries=[],i._packedGeometryPoolSize=2,i._flushId=0,i._aBuffers={},i._iBuffers={},i.MAX_TEXTURES=1,i.renderer.on("prerender",i.onPrerender,i),t.runners.contextChange.add(i),i._dcIndex=0,i._aIndex=0,i._iIndex=0,i._attributeBuffer=null,i._indexBuffer=null,i._tempBoundTextures=[],i}return e.prototype.contextChange=function(){var t=this.renderer.gl;xt.PREFER_ENV===Zl.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),xt.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=AX(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,i=e._textureArrayPool,r=this.size/4,s=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new TC);for(;i.length<s;)i.push(new IC);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this,i=t._bufferedTextures,r=t.MAX_TEXTURES,s=e._textureArrayPool,o=this.renderer.batch,a=this._tempBoundTextures,l=this.renderer.textureGC.count,c=++In._globalBatch,u=0,h=s[0],d=0;o.copyBoundTextures(a,r);for(var f=0;f<this._bufferSize;++f){var p=i[f];i[f]=null,p._batchEnabled!==c&&(h.count>=r&&(o.boundArray(h,a,c,r),this.buildDrawCalls(h,d,f),d=f,h=s[++u],++c),p._batchEnabled=c,p.touched=l,h.elements[h.count++]=p)}h.count>0&&(o.boundArray(h,a,c,r),this.buildDrawCalls(h,d,this._bufferSize),++u,++c);for(var f=0;f<a.length;f++)a[f]=null;In._globalBatch=c},e.prototype.buildDrawCalls=function(t,i,r){var s=this,o=s._bufferedElements,a=s._attributeBuffer,l=s._indexBuffer,c=s.vertexSize,u=e._drawCallPool,h=this._dcIndex,d=this._aIndex,f=this._iIndex,p=u[h];p.start=this._iIndex,p.texArray=t;for(var g=i;g<r;++g){var m=o[g],v=m._texture.baseTexture,_=wL[v.alphaMode?1:0][m.blendMode];o[g]=null,i<g&&p.blend!==_&&(p.size=f-p.start,i=g,p=u[++h],p.texArray=t,p.start=f),this.packInterleavedGeometry(m,a,l,d,f),d+=m.vertexData.length/2*c,f+=m.indices.length,p.blend=_}i<r&&(p.size=f-p.start,++h),this._dcIndex=h,this._aIndex=d,this._iIndex=f},e.prototype.bindAndClearTexArray=function(t){for(var i=this.renderer.texture,r=0;r<t.count;r++)i.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,i=t._packedGeometries,r=t._attributeBuffer,s=t._indexBuffer;xt.CAN_UPLOAD_SAME_BUFFER?(i[this._flushId]._buffer.update(r.rawBinaryData),i[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(r.rawBinaryData),i[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,i=this.renderer,r=i.gl,s=i.state,o=e._drawCallPool,a=null,l=0;l<t;l++){var c=o[l],u=c.texArray,h=c.type,d=c.size,f=c.start,p=c.blend;a!==u&&(a=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,s.set(this.state),r.drawElements(h,d,r.UNSIGNED_SHORT,f*2)}},e.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),xt.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),n.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var i=pA(Math.ceil(t/8)),r=eR(i),s=i*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var o=this._aBuffers[s];return o||(this._aBuffers[s]=o=new SC(s*this.vertexSize*4)),o},e.prototype.getIndexBuffer=function(t){var i=pA(Math.ceil(t/12)),r=eR(i),s=i*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var o=this._iBuffers[r];return o||(this._iBuffers[r]=o=new Uint16Array(s)),o},e.prototype.packInterleavedGeometry=function(t,i,r,s,o){for(var a=i.uint32View,l=i.float32View,c=s/this.vertexSize,u=t.uvs,h=t.indices,d=t.vertexData,f=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),g=p<1&&t._texture.baseTexture.alphaMode?ZT(t._tintRGB,p):t._tintRGB+(p*255<<24),m=0;m<d.length;m+=2)l[s++]=d[m],l[s++]=d[m+1],l[s++]=u[m],l[s++]=u[m+1],a[s++]=g,l[s++]=f;for(var m=0;m<h.length;m++)r[o++]=c+h[m]},e._drawCallPool=[],e._textureArrayPool=[],e}(rb),OX=function(){function n(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return n.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),i=0;i<e;i++)t[i]=i;this.defaultGroupCache[e]=vd.from({uSamplers:t},!0);var r=this.fragTemplate;r=r.replace(/%count%/gi,""+e),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new o_(this.vertexSrc,r)}var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new Dt,default:this.defaultGroupCache[e]};return new Ku(this.programCache[e],s)},n.prototype.generateSampleSrc=function(e){var t="";t+=`
`,t+=`
`;for(var i=0;i<e;i++)i>0&&(t+=`
else `),i<e-1&&(t+="if(vTextureId < "+i+".5)"),t+=`
{`,t+=`
	color = texture2D(uSamplers[`+i+"], vTextureCoord);",t+=`
}`;return t+=`
`,t+=`
`,t},n}(),KL=function(n){Vi(e,n);function e(t){t===void 0&&(t=!1);var i=n.call(this)||this;return i._buffer=new Br(null,t,!1),i._indexBuffer=new Br(null,t,!0),i.addAttribute("aVertexPosition",i._buffer,2,!1,qt.FLOAT).addAttribute("aTextureCoord",i._buffer,2,!1,qt.FLOAT).addAttribute("aColor",i._buffer,4,!0,qt.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,qt.FLOAT).addIndex(i._indexBuffer),i}return e}(s_),YU=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,qU=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,LX=function(){function n(){}return n.create=function(e){var t=Object.assign({vertex:YU,fragment:qU,geometryClass:KL,vertexSize:6},e),i=t.vertex,r=t.fragment,s=t.vertexSize,o=t.geometryClass;return function(a){Vi(l,a);function l(c){var u=a.call(this,c)||this;return u.shaderGenerator=new OX(i,r),u.geometryClass=o,u.vertexSize=s,u}return l}(kX)},Object.defineProperty(n,"defaultVertexSrc",{get:function(){return YU},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultFragmentTemplate",{get:function(){return qU},enumerable:!1,configurable:!0}),n}(),JL=LX.create();Object.assign(JL,{extension:{name:"batch",type:ai.RendererPlugin}});var NX={},Ixe=function(n){Object.defineProperty(NX,n,{get:function(){return Go("6.0.0","PIXI.systems."+n+" has moved to PIXI."+n),cX[n]}})};for(var ZL in cX)Ixe(ZL);var BX={},Sxe=function(n){Object.defineProperty(BX,n,{get:function(){return Go("6.0.0","PIXI.resources."+n+" has moved to PIXI."+n),PX[n]}})};for(var ZL in PX)Sxe(ZL);var Pxe="6.5.2";/*!
 * @pixi/interaction - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var lR=function(){function n(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Ae,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(n.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),n.prototype.getLocalPosition=function(e,t,i){return e.worldTransform.applyInverse(i||this.global,t)},n.prototype.copyEvent=function(e){"isPrimary"in e&&e.isPrimary&&(this.isPrimary=!0),this.button="button"in e&&e.button;var t="buttons"in e&&e.buttons;this.buttons=Number.isInteger(t)?t:"which"in e&&e.which,this.width="width"in e&&e.width,this.height="height"in e&&e.height,this.tiltX="tiltX"in e&&e.tiltX,this.tiltY="tiltY"in e&&e.tiltY,this.pointerType="pointerType"in e&&e.pointerType,this.pressure="pressure"in e&&e.pressure,this.rotationAngle="rotationAngle"in e&&e.rotationAngle,this.twist="twist"in e&&e.twist||0,this.tangentialPressure="tangentialPressure"in e&&e.tangentialPressure||0},n.prototype.reset=function(){this.isPrimary=!1},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cR=function(n,e){return cR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},cR(n,e)};function Mxe(n,e){cR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var FX=function(){function n(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return n.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},n.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},n}(),Nx=function(){function n(e){this._pointerId=e,this._flags=n.FLAGS.NONE}return n.prototype._doSet=function(e,t){t?this._flags=this._flags|e:this._flags=this._flags&~e},Object.defineProperty(n.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"flags",{get:function(){return this._flags},set:function(e){this._flags=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"none",{get:function(){return this._flags===n.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"over",{get:function(){return(this._flags&n.FLAGS.OVER)!==0},set:function(e){this._doSet(n.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rightDown",{get:function(){return(this._flags&n.FLAGS.RIGHT_DOWN)!==0},set:function(e){this._doSet(n.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"leftDown",{get:function(){return(this._flags&n.FLAGS.LEFT_DOWN)!==0},set:function(e){this._doSet(n.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),n.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),n}(),Rxe=function(){function n(){this._tempPoint=new Ae}return n.prototype.recursiveFindHit=function(e,t,i,r,s){var o;if(!t||!t.visible)return!1;var a=e.data.global;s=t.interactive||s;var l=!1,c=s,u=!0;if(t.hitArea)r&&(t.worldTransform.applyInverse(a,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?l=!0:(r=!1,u=!1)),c=!1;else if(t._mask&&r){var h=t._mask.isMaskData?t._mask.maskObject:t._mask;h&&!(!((o=h.containsPoint)===null||o===void 0)&&o.call(h,a))&&(r=!1)}if(u&&t.interactiveChildren&&t.children)for(var d=t.children,f=d.length-1;f>=0;f--){var p=d[f],g=this.recursiveFindHit(e,p,i,r,c);if(g){if(!p.parent)continue;c=!1,g&&(e.target&&(r=!1),l=!0)}}return s&&(r&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(a)&&(l=!0),t.interactive&&(l&&!e.target&&(e.target=t),i&&i(e,t,!!l))),l},n.prototype.findHit=function(e,t,i,r){this.recursiveFindHit(e,t,i,r,!1)},n}(),UX={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(n){n?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};rn.mixin(UX);var Kb=1,Jb={target:null,data:{global:null}},e2=function(n){Mxe(e,n);function e(t,i){var r=n.call(this)||this;return i=i||{},r.renderer=t,r.autoPreventDefault=i.autoPreventDefault!==void 0?i.autoPreventDefault:!0,r.interactionFrequency=i.interactionFrequency||10,r.mouse=new lR,r.mouse.identifier=Kb,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[Kb]=r.mouse,r.interactionDataPool=[],r.eventData=new FX,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!("PointerEvent"in globalThis),r.supportsTouchEvents="ontouchstart"in globalThis,r.supportsPointerEvents=!!globalThis.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new Rxe,r._tempDisplayObject=new TL,r._eventListenerOptions={capture:!0,passive:!1},r._useSystemTicker=i.useSystemTicker!==void 0?i.useSystemTicker:!0,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,i){return Jb.target=null,Jb.data.global=t,i||(i=this.lastObjectRendered),this.processInteractive(Jb,i,null,!0),Jb.target},e.prototype.setTargetElement=function(t,i){i===void 0&&(i=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=i,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(Qi.system.add(this.tickerUpdate,this,rl.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(Qi.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!(this.eventsAdded||!this.interactionDOMElement)){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(!(!this.eventsAdded||!this.interactionDOMElement)){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove){this._didMove=!1;return}this.cursor=null;for(var t in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var i=this.activeInteractionData[t];if(i.originalEvent&&i.pointerType!=="touch"){var r=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var i=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(i=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var r=this.cursorStyles[t];if(r)switch(typeof r){case"string":i&&(this.interactionDOMElement.style.cursor=r);break;case"function":r(t);break;case"object":i&&Object.assign(this.interactionDOMElement.style,r);break}else i&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,i,r){(!r.stopPropagationHint||t===r.stopsPropagatingAt)&&(r.currentTarget=t,r.type=i,t.emit(i,r),t[i]&&t[i](r))},e.prototype.delayDispatchEvent=function(t,i,r){this.delayedEvents.push({displayObject:t,eventString:i,eventData:r})},e.prototype.mapPositionToPoint=function(t,i,r){var s;this.interactionDOMElement.parentElement?s=this.interactionDOMElement.getBoundingClientRect():s={x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var o=1/this.resolution;t.x=(i-s.left)*(this.interactionDOMElement.width/s.width)*o,t.y=(r-s.top)*(this.interactionDOMElement.height/s.height)*o},e.prototype.processInteractive=function(t,i,r,s){var o=this.search.findHit(t,i,r,s),a=this.delayedEvents;if(!a.length)return o;t.stopPropagationHint=!1;var l=a.length;this.delayedEvents=[];for(var c=0;c<l;c++){var u=a[c],h=u.displayObject,d=u.eventString,f=u.eventData;f.stopsPropagatingAt===h&&(f.stopPropagationHint=!0),this.dispatchEvent(h,d,f)}return o},e.prototype.onPointerDown=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var i=this.normalizeToPointerData(t);if(this.autoPreventDefault&&i[0].isNormalized){var r=t.cancelable||!("cancelable"in t);r&&t.preventDefault()}for(var s=i.length,o=0;o<s;o++){var a=i[o],l=this.getInteractionDataForPointerId(a),c=this.configureInteractionEventForDOMEvent(this.eventData,a,l);if(c.data.originalEvent=t,this.processInteractive(c,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",c),a.pointerType==="touch")this.emit("touchstart",c);else if(a.pointerType==="mouse"||a.pointerType==="pen"){var u=a.button===2;this.emit(u?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,i,r){var s=t.data,o=t.data.identifier;if(r){if(i.trackedPointers[o]||(i.trackedPointers[o]=new Nx(o)),this.dispatchEvent(i,"pointerdown",t),s.pointerType==="touch")this.dispatchEvent(i,"touchstart",t);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var a=s.button===2;a?i.trackedPointers[o].rightDown=!0:i.trackedPointers[o].leftDown=!0,this.dispatchEvent(i,a?"rightdown":"mousedown",t)}}},e.prototype.onPointerComplete=function(t,i,r){var s=this.normalizeToPointerData(t),o=s.length,a=t.target;t.composedPath&&t.composedPath().length>0&&(a=t.composedPath()[0]);for(var l=a!==this.interactionDOMElement?"outside":"",c=0;c<o;c++){var u=s[c],h=this.getInteractionDataForPointerId(u),d=this.configureInteractionEventForDOMEvent(this.eventData,u,h);if(d.data.originalEvent=t,this.processInteractive(d,this.lastObjectRendered,r,i||!l),this.emit(i?"pointercancel":"pointerup"+l,d),u.pointerType==="mouse"||u.pointerType==="pen"){var f=u.button===2;this.emit(f?"rightup"+l:"mouseup"+l,d)}else u.pointerType==="touch"&&(this.emit(i?"touchcancel":"touchend"+l,d),this.releaseInteractionDataForPointerId(u.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,i){var r=t.data,s=t.data.identifier;i.trackedPointers[s]!==void 0&&(delete i.trackedPointers[s],this.dispatchEvent(i,"pointercancel",t),r.pointerType==="touch"&&this.dispatchEvent(i,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,i,r){var s=t.data,o=t.data.identifier,a=i.trackedPointers[o],l=s.pointerType==="touch",c=s.pointerType==="mouse"||s.pointerType==="pen",u=!1;if(c){var h=s.button===2,d=Nx.FLAGS,f=h?d.RIGHT_DOWN:d.LEFT_DOWN,p=a!==void 0&&a.flags&f;r?(this.dispatchEvent(i,h?"rightup":"mouseup",t),p&&(this.dispatchEvent(i,h?"rightclick":"click",t),u=!0)):p&&this.dispatchEvent(i,h?"rightupoutside":"mouseupoutside",t),a&&(h?a.rightDown=!1:a.leftDown=!1)}r?(this.dispatchEvent(i,"pointerup",t),l&&this.dispatchEvent(i,"touchend",t),a&&((!c||u)&&this.dispatchEvent(i,"pointertap",t),l&&(this.dispatchEvent(i,"tap",t),a.over=!1))):a&&(this.dispatchEvent(i,"pointerupoutside",t),l&&this.dispatchEvent(i,"touchendoutside",t)),a&&a.none&&delete i.trackedPointers[o]},e.prototype.onPointerMove=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var i=this.normalizeToPointerData(t);(i[0].pointerType==="mouse"||i[0].pointerType==="pen")&&(this._didMove=!0,this.cursor=null);for(var r=i.length,s=0;s<r;s++){var o=i[s],a=this.getInteractionDataForPointerId(o),l=this.configureInteractionEventForDOMEvent(this.eventData,o,a);l.data.originalEvent=t,this.processInteractive(l,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",l),o.pointerType==="touch"&&this.emit("touchmove",l),(o.pointerType==="mouse"||o.pointerType==="pen")&&this.emit("mousemove",l)}i[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,i,r){var s=t.data,o=s.pointerType==="touch",a=s.pointerType==="mouse"||s.pointerType==="pen";a&&this.processPointerOverOut(t,i,r),(!this.moveWhenInside||r)&&(this.dispatchEvent(i,"pointermove",t),o&&this.dispatchEvent(i,"touchmove",t),a&&this.dispatchEvent(i,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var i=this.normalizeToPointerData(t),r=i[0];r.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);o.data.originalEvent=r,this.processInteractive(o,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),r.pointerType==="mouse"||r.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(s.identifier)}},e.prototype.processPointerOverOut=function(t,i,r){var s=t.data,o=t.data.identifier,a=s.pointerType==="mouse"||s.pointerType==="pen",l=i.trackedPointers[o];r&&!l&&(l=i.trackedPointers[o]=new Nx(o)),l!==void 0&&(r&&this.mouseOverRenderer?(l.over||(l.over=!0,this.delayDispatchEvent(i,"pointerover",t),a&&this.delayDispatchEvent(i,"mouseover",t)),a&&this.cursor===null&&(this.cursor=i.cursor)):l.over&&(l.over=!1,this.dispatchEvent(i,"pointerout",this.eventData),a&&this.dispatchEvent(i,"mouseout",t),l.none&&delete i.trackedPointers[o]))},e.prototype.onPointerOver=function(t){var i=this.normalizeToPointerData(t),r=i[0],s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);o.data.originalEvent=r,r.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),(r.pointerType==="mouse"||r.pointerType==="pen")&&this.emit("mouseover",o)},e.prototype.getInteractionDataForPointerId=function(t){var i=t.pointerId,r;return i===Kb||t.pointerType==="mouse"?r=this.mouse:this.activeInteractionData[i]?r=this.activeInteractionData[i]:(r=this.interactionDataPool.pop()||new lR,r.identifier=i,this.activeInteractionData[i]=r),r.copyEvent(t),r},e.prototype.releaseInteractionDataForPointerId=function(t){var i=this.activeInteractionData[t];i&&(delete this.activeInteractionData[t],i.reset(),this.interactionDataPool.push(i))},e.prototype.configureInteractionEventForDOMEvent=function(t,i,r){return t.data=r,this.mapPositionToPoint(r.global,i.clientX,i.clientY),i.pointerType==="touch"&&(i.globalX=r.global.x,i.globalY=r.global.y),r.originalEvent=i,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var i=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,s=t.changedTouches.length;r<s;r++){var o=t.changedTouches[r];typeof o.button>"u"&&(o.button=t.touches.length?1:0),typeof o.buttons>"u"&&(o.buttons=t.touches.length?1:0),typeof o.isPrimary>"u"&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,i.push(o)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){var a=t;typeof a.isPrimary>"u"&&(a.isPrimary=!0),typeof a.width>"u"&&(a.width=1),typeof a.height>"u"&&(a.height=1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="mouse"),typeof a.pointerId>"u"&&(a.pointerId=Kb),typeof a.pressure>"u"&&(a.pressure=.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),a.isNormalized=!0,i.push(a)}else i.push(t);return i},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e.extension={name:"interaction",type:[ai.RendererPlugin,ai.CanvasRendererPlugin]},e}(Zr);class PC{constructor(e=0,t=0,i=0,r=0){this._x=Number(e),this._y=Number(t),this._width=Number(i),this._height=Number(r),this._hull=[new Ae,new Ae,new Ae,new Ae],this.currentID=-1,this.dirtyID=0}get x(){return this._x}set x(e){this._x=e,this.dirtyID++}get y(){return this._y}set y(e){this._y=e,this.dirtyID++}get width(){return this._width}set width(e){this._width=e,this.dirtyID++}get height(){return this._height}set height(e){this._height=e,this.dirtyID++}get hull(){return this.isDirty()&&this.update(),this._hull}get topLeft(){return this.isDirty()&&this.update(),this._hull[0]}get topRight(){return this.isDirty()&&this.update(),this._hull[1]}get bottomRight(){return this.isDirty()&&this.update(),this._hull[2]}get bottomLeft(){return this.isDirty()&&this.update(),this._hull[3]}isDirty(){return this.currentID!==this.dirtyID}update(){const[e,t,i,r]=this._hull;e.set(this._x,this._y),t.set(this._x+this._width,this._y),i.set(this._x+this._width,this._y+this._height),r.set(this._x,this._y+this._height)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}clone(){return new PC(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}equals(e){return e?e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height:!1}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=r,this.height=Math.max(s-r,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=r-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=r,this.height=s-r,this}}const KU=new Ae;class xy{constructor(e=0,t=0,i=0,r=0,s=0){e instanceof PC&&(s=t||0,t=e.y,i=e.width,r=e.height,e=e.x),this.innerBounds=new PC(e,t,i,r),this._rotation=s,this._center=new Gu(this.updateCenter,this),this._hull=[new Ae,new Ae,new Ae,new Ae],this._matrix=new Dt,this.currentID=-1,this.dirtyID=0}get rotation(){return this._rotation}set rotation(e){this._rotation=e,this.dirtyID++}get center(){return this.isDirty()&&this.update(),this._center}set center(e){this.center.copyFrom(e)}get hull(){return this.isDirty()&&this.update(),this._hull}get topLeft(){return this.isDirty()&&this.update(),this._hull[0]}get topRight(){return this.isDirty()&&this.update(),this._hull[1]}get bottomRight(){return this.isDirty()&&this.update(),this._hull[2]}get bottomLeft(){return this.isDirty()&&this.update(),this._hull[3]}equals(e){return e?this.innerBounds.equals(e.innerBounds)&&this.rotation===e.rotation:!1}contains(e,t){typeof e=="number"&&(e=KU.set(e,t));const i=this._matrix.applyInverse(e,KU);return this.innerBounds.contains(i.x,i.y)}copyFrom(e){return this.innerBounds.copyFrom(e.innerBounds),this.rotation=e.rotation,this.dirtyID++,this}isDirty(){return this.currentID!==this.dirtyID+this.innerBounds.dirtyID}update(){const e=this.innerBounds,t=this._rotation,i=this._center,[r,s,o,a]=this._hull,l=this._matrix;i._x=e.x+e.width/2,i._y=e.y+e.height/2,l.identity().translate(-i.x,-i.y).rotate(t).translate(i.x,i.y),l.apply(e.topLeft,r),l.apply(e.topRight,s),l.apply(e.bottomRight,o),l.apply(e.bottomLeft,a),this.currentID=this.dirtyID+this.innerBounds.dirtyID}updateCenter(){const e=this.center,t=this.innerBounds;t.x=e.x-t.width/2,t.y=e.y-t.height/2}}class JU{constructor(e,t){this._history=new Array(e),this._decayRatio=t,this._currentIndex=0;for(let i=0;i<e;i++)this._history[i]=0}next(e){const{_history:t,_decayRatio:i}=this,r=t.length;this._currentIndex=this._currentIndex<r-1?this._currentIndex+1:0,t[this._currentIndex]=e;let s=0,o=0;for(let a=this._currentIndex+1;a<r;a++)s=(s+t[a])*i,o=(o+1)*i;for(let a=0;a<=this._currentIndex;a++)s=(s+t[a])*i,o=(o+1)*i;return this._average=s/o,this._average}absDev(){let e=0;for(let t=0,i=this._history.length;t<i;t++)e+=Math.abs(this._history[t]-this._average);return e/this._history.length}}class MC{constructor(e={}){MC.prototype.__init.call(this),this._freeList=[],this._freeCount=0,this._borrowRate=0,this._returnRate=0,this._flowRate=0,this._borrowRateAverage=0,this._reserveCount=e.reserve||0,this._capacityRatio=e.capacityRatio||1.2,this._decayRatio=e.decayRatio||.67,this._marginAverage=0,this._borrowRateAverageProvider=new JU(128,this._decayRatio),this._marginAverageProvider=new JU(128,this._decayRatio)}get capacity(){return this._freeList.length}set capacity(e){this._freeList.length=Math.ceil(e)}allocate(){return++this._borrowRate,++this._flowRate,this._freeCount>0?this._freeList[--this._freeCount]:this.create()}allocateArray(e){let t,i;Array.isArray(e)?(t=e,i=e.length):(i=e,t=new Array(i)),this._borrowRate+=i,this._flowRate+=i;let r=0;if(this._freeCount>0){const s=this._freeList,o=Math.min(this._freeCount,i);let a=this._freeCount;for(let l=0;l<o;l++)t[r]=s[a-1],++r,--a;this._freeCount=a}for(;r<i;)t[r]=this.create(),++r;return t}release(e){++this._returnRate,--this._flowRate,this._freeCount===this.capacity&&(this.capacity*=this._capacityRatio),this._freeList[this._freeCount]=e,++this._freeCount}releaseArray(e){this._returnRate+=e.length,this._flowRate-=e.length,this._freeCount+e.length>this.capacity&&(this.capacity=Math.max(this.capacity*this._capacityRatio,this._freeCount+e.length));for(let t=0,i=e.length;t<i;t++)this._freeList[this._freeCount]=e[t],++this._freeCount}reserve(e){if(this._reserveCount=e,this._freeCount<e){const t=this._freeCount-e;for(let i=0;i<t;i++)this._freeList[this._freeCount]=this.create(),++this._freeCount}}limit(e){if(this._freeCount>e){this.capacity>e*this._capacityRatio&&(this.capacity=e*this._capacityRatio);const i=Math.min(this._freeCount,this.capacity);for(let r=e;r<i;r++)this._freeList[r]=null}}startGC(e=Qi.shared){e.add(this._gcTick,null,rl.UTILITY)}stopGC(e=Qi.shared){e.remove(this._gcTick)}__init(){this._gcTick=()=>{this._borrowRateAverage=this._borrowRateAverageProvider.next(this._borrowRate),this._marginAverage=this._marginAverageProvider.next(this._freeCount-this._borrowRate);const e=this._borrowRateAverageProvider.absDev();this._flowRate=0,this._borrowRate=0,this._returnRate=0;const t=this._freeCount,i=this._freeList.length;if(t<128&&this._borrowRateAverage<128&&i<128)return;const r=Math.max(this._borrowRateAverage*(this._capacityRatio-1),this._reserveCount);if(this._freeCount>r+e){const s=r+e;this.capacity=Math.min(this._freeList.length,Math.ceil(s)),this._freeCount=this._freeList.length}}}}var US;const ZU=new Map;class GX{static build(e){let t=ZU.get(e);return t||(t=new class extends MC{create(){return new e}},ZU.set(e,t),t)}static buildFunctional(e){return new(US=class extends MC{constructor(...i){super(...i),US.prototype.__init.call(this)}__init(){this.create=e}},US)}}/*!
 * @pixi/graphics - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ma;(function(n){n.MITER="miter",n.BEVEL="bevel",n.ROUND="round"})(ma||(ma={}));var _o;(function(n){n.BUTT="butt",n.ROUND="round",n.SQUARE="square"})(_o||(_o={}));var ms={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(n,e){if(e===void 0&&(e=20),!this.adaptive||!n||isNaN(n))return e;var t=Math.ceil(n/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}},t2=function(){function n(){this.color=16777215,this.alpha=1,this.texture=Wt.WHITE,this.matrix=null,this.visible=!1,this.reset()}return n.prototype.clone=function(){var e=new n;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},n.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Wt.WHITE,this.matrix=null,this.visible=!1},n.prototype.destroy=function(){this.texture=null,this.matrix=null},n}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uR=function(n,e){return uR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},uR(n,e)};function n2(n,e){uR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function e3(n,e){var t,i;e===void 0&&(e=!1);var r=n.length;if(!(r<6)){for(var s=0,o=0,a=n[r-2],l=n[r-1];o<r;o+=2){var c=n[o],u=n[o+1];s+=(c-a)*(u+l),a=c,l=u}if(!e&&s>0||e&&s<=0)for(var h=r/2,o=h+h%2;o<r;o+=2){var d=r-o-2,f=r-o-1,p=o,g=o+1;t=[n[p],n[d]],n[d]=t[0],n[p]=t[1],i=[n[g],n[f]],n[f]=i[0],n[g]=i[1]}}}var i2={build:function(n){n.points=n.shape.points.slice()},triangulate:function(n,e){var t=n.points,i=n.holes,r=e.points,s=e.indices;if(t.length>=6){e3(t,!1);for(var o=[],a=0;a<i.length;a++){var l=i[a];e3(l.points,!0),o.push(t.length/2),t=t.concat(l.points)}var c=dL(t,o,2);if(!c)return;for(var u=r.length/2,a=0;a<c.length;a+=3)s.push(c[a]+u),s.push(c[a+1]+u),s.push(c[a+2]+u);for(var a=0;a<t.length;a++)r.push(t[a])}}},vA={build:function(n){var e=n.points,t,i,r,s,o,a;if(n.type===Yn.CIRC){var l=n.shape;t=l.x,i=l.y,o=a=l.radius,r=s=0}else if(n.type===Yn.ELIP){var c=n.shape;t=c.x,i=c.y,o=c.width,a=c.height,r=s=0}else{var u=n.shape,h=u.width/2,d=u.height/2;t=u.x+h,i=u.y+d,o=a=Math.max(0,Math.min(u.radius,Math.min(h,d))),r=h-o,s=d-a}if(!(o>=0&&a>=0&&r>=0&&s>=0)){e.length=0;return}var f=Math.ceil(2.3*Math.sqrt(o+a)),p=f*8+(r?4:0)+(s?4:0);if(e.length=p,p!==0){if(f===0){e.length=8,e[0]=e[6]=t+r,e[1]=e[3]=i+s,e[2]=e[4]=t-r,e[5]=e[7]=i-s;return}var g=0,m=f*4+(r?2:0)+2,v=m,_=p;{var y=r+o,A=s,w=t+y,b=t-y,C=i+A;if(e[g++]=w,e[g++]=C,e[--m]=C,e[--m]=b,s){var I=i-A;e[v++]=b,e[v++]=I,e[--_]=I,e[--_]=w}}for(var x=1;x<f;x++){var T=Math.PI/2*(x/f),y=r+Math.cos(T)*o,A=s+Math.sin(T)*a,w=t+y,b=t-y,C=i+A,I=i-A;e[g++]=w,e[g++]=C,e[--m]=C,e[--m]=b,e[v++]=b,e[v++]=I,e[--_]=I,e[--_]=w}{var y=r,A=s+a,w=t+y,b=t-y,C=i+A,I=i-A;e[g++]=w,e[g++]=C,e[--_]=I,e[--_]=w,r&&(e[g++]=b,e[g++]=C,e[--_]=I,e[--_]=b)}}},triangulate:function(n,e){var t=n.points,i=e.points,r=e.indices;if(t.length!==0){var s=i.length/2,o=s,a,l;if(n.type!==Yn.RREC){var c=n.shape;a=c.x,l=c.y}else{var u=n.shape;a=u.x+u.width/2,l=u.y+u.height/2}var h=n.matrix;i.push(n.matrix?h.a*a+h.c*l+h.tx:a,n.matrix?h.b*a+h.d*l+h.ty:l),s++,i.push(t[0],t[1]);for(var d=2;d<t.length;d+=2)i.push(t[d],t[d+1]),r.push(s++,o,s);r.push(o+1,o,s)}}},HX={build:function(n){var e=n.shape,t=e.x,i=e.y,r=e.width,s=e.height,o=n.points;o.length=0,o.push(t,i,t+r,i,t+r,i+s,t,i+s)},triangulate:function(n,e){var t=n.points,i=e.points,r=i.length/2;i.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}};function Pg(n,e,t){var i=e-n;return n+i*t}function Zb(n,e,t,i,r,s,o){o===void 0&&(o=[]);for(var a=20,l=o,c=0,u=0,h=0,d=0,f=0,p=0,g=0,m=0;g<=a;++g)m=g/a,c=Pg(n,t,m),u=Pg(e,i,m),h=Pg(t,r,m),d=Pg(i,s,m),f=Pg(c,h,m),p=Pg(u,d,m),!(g===0&&l[l.length-2]===f&&l[l.length-1]===p)&&l.push(f,p);return l}var VX={build:function(n){if(hn.nextRoundedRectBehavior){vA.build(n);return}var e=n.shape,t=n.points,i=e.x,r=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));t.length=0,a?(Zb(i,r+a,i,r,i+a,r,t),Zb(i+s-a,r,i+s,r,i+s,r+a,t),Zb(i+s,r+o-a,i+s,r+o,i+s-a,r+o,t),Zb(i+a,r+o,i,r+o,i,r+o-a,t)):t.push(i,r,i+s,r,i+s,r+o,i,r+o)},triangulate:function(n,e){if(hn.nextRoundedRectBehavior){vA.triangulate(n,e);return}for(var t=n.points,i=e.points,r=e.indices,s=i.length/2,o=dL(t,null,2),a=0,l=o.length;a<l;a+=3)r.push(o[a]+s),r.push(o[a+1]+s),r.push(o[a+2]+s);for(var a=0,l=t.length;a<l;a++)i.push(t[a],t[++a])}};function t3(n,e,t,i,r,s,o,a){var l=n-t*r,c=e-i*r,u=n+t*s,h=e+i*s,d,f;o?(d=i,f=-t):(d=-i,f=t);var p=l+d,g=c+f,m=u+d,v=h+f;return a.push(p,g),a.push(m,v),2}function Mg(n,e,t,i,r,s,o,a){var l=t-n,c=i-e,u=Math.atan2(l,c),h=Math.atan2(r-n,s-e);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);var d=u,f=h-u,p=Math.abs(f),g=Math.sqrt(l*l+c*c),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,v=f/m;if(d+=v,a){o.push(n,e),o.push(t,i);for(var _=1,y=d;_<m;_++,y+=v)o.push(n,e),o.push(n+Math.sin(y)*g,e+Math.cos(y)*g);o.push(n,e),o.push(r,s)}else{o.push(t,i),o.push(n,e);for(var _=1,y=d;_<m;_++,y+=v)o.push(n+Math.sin(y)*g,e+Math.cos(y)*g),o.push(n,e);o.push(r,s),o.push(n,e)}return m*2}function Dxe(n,e){var t=n.shape,i=n.points||t.points.slice(),r=e.closePointEps;if(i.length!==0){var s=n.lineStyle,o=new Ae(i[0],i[1]),a=new Ae(i[i.length-2],i[i.length-1]),l=t.type!==Yn.POLY||t.closeStroke,c=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(l){i=i.slice(),c&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var u=(o.x+a.x)*.5,h=(a.y+o.y)*.5;i.unshift(u,h),i.push(u,h)}var d=e.points,f=i.length/2,p=i.length,g=d.length/2,m=s.width/2,v=m*m,_=s.miterLimit*s.miterLimit,y=i[0],A=i[1],w=i[2],b=i[3],C=0,I=0,x=-(A-b),T=y-w,O=0,F=0,G=Math.sqrt(x*x+T*T);x/=G,T/=G,x*=m,T*=m;var B=s.alignment,R=(1-B)*2,P=B*2;l||(s.cap===_o.ROUND?p+=Mg(y-x*(R-P)*.5,A-T*(R-P)*.5,y-x*R,A-T*R,y+x*P,A+T*P,d,!0)+2:s.cap===_o.SQUARE&&(p+=t3(y,A,x,T,R,P,!0,d))),d.push(y-x*R,A-T*R),d.push(y+x*P,A+T*P);for(var k=1;k<f-1;++k){y=i[(k-1)*2],A=i[(k-1)*2+1],w=i[k*2],b=i[k*2+1],C=i[(k+1)*2],I=i[(k+1)*2+1],x=-(A-b),T=y-w,G=Math.sqrt(x*x+T*T),x/=G,T/=G,x*=m,T*=m,O=-(b-I),F=w-C,G=Math.sqrt(O*O+F*F),O/=G,F/=G,O*=m,F*=m;var L=w-y,H=A-b,U=w-C,$=I-b,j=H*U-$*L,Q=j<0;if(Math.abs(j)<.1){d.push(w-x*R,b-T*R),d.push(w+x*P,b+T*P);continue}var ne=(-x+y)*(-T+b)-(-x+w)*(-T+A),ve=(-O+C)*(-F+b)-(-O+w)*(-F+I),Pe=(L*ve-U*ne)/j,De=($*ne-H*ve)/j,Xe=(Pe-w)*(Pe-w)+(De-b)*(De-b),Ne=w+(Pe-w)*R,et=b+(De-b)*R,ze=w-(Pe-w)*P,de=b-(De-b)*P,lt=Math.min(L*L+H*H,U*U+$*$),he=Q?R:P,Ce=lt+he*he*v,se=Xe<=Ce;se?s.join===ma.BEVEL||Xe/v>_?(Q?(d.push(Ne,et),d.push(w+x*P,b+T*P),d.push(Ne,et),d.push(w+O*P,b+F*P)):(d.push(w-x*R,b-T*R),d.push(ze,de),d.push(w-O*R,b-F*R),d.push(ze,de)),p+=2):s.join===ma.ROUND?Q?(d.push(Ne,et),d.push(w+x*P,b+T*P),p+=Mg(w,b,w+x*P,b+T*P,w+O*P,b+F*P,d,!0)+4,d.push(Ne,et),d.push(w+O*P,b+F*P)):(d.push(w-x*R,b-T*R),d.push(ze,de),p+=Mg(w,b,w-x*R,b-T*R,w-O*R,b-F*R,d,!1)+4,d.push(w-O*R,b-F*R),d.push(ze,de)):(d.push(Ne,et),d.push(ze,de)):(d.push(w-x*R,b-T*R),d.push(w+x*P,b+T*P),s.join===ma.ROUND?Q?p+=Mg(w,b,w+x*P,b+T*P,w+O*P,b+F*P,d,!0)+2:p+=Mg(w,b,w-x*R,b-T*R,w-O*R,b-F*R,d,!1)+2:s.join===ma.MITER&&Xe/v<=_&&(Q?(d.push(ze,de),d.push(ze,de)):(d.push(Ne,et),d.push(Ne,et)),p+=2),d.push(w-O*R,b-F*R),d.push(w+O*P,b+F*P),p+=2)}y=i[(f-2)*2],A=i[(f-2)*2+1],w=i[(f-1)*2],b=i[(f-1)*2+1],x=-(A-b),T=y-w,G=Math.sqrt(x*x+T*T),x/=G,T/=G,x*=m,T*=m,d.push(w-x*R,b-T*R),d.push(w+x*P,b+T*P),l||(s.cap===_o.ROUND?p+=Mg(w-x*(R-P)*.5,b-T*(R-P)*.5,w-x*R,b-T*R,w+x*P,b+T*P,d,!1)+2:s.cap===_o.SQUARE&&(p+=t3(w,b,x,T,R,P,!1,d)));for(var Re=e.indices,He=ms.epsilon*ms.epsilon,k=g;k<p+g-2;++k)y=d[k*2],A=d[k*2+1],w=d[(k+1)*2],b=d[(k+1)*2+1],C=d[(k+2)*2],I=d[(k+2)*2+1],!(Math.abs(y*(b-I)+w*(I-A)+C*(A-b))<He)&&Re.push(k,k+1,k+2)}}function kxe(n,e){var t=0,i=n.shape,r=n.points||i.points,s=i.type!==Yn.POLY||i.closeStroke;if(r.length!==0){var o=e.points,a=e.indices,l=r.length/2,c=o.length/2,u=c;for(o.push(r[0],r[1]),t=1;t<l;t++)o.push(r[t*2],r[t*2+1]),a.push(u,u+1),u++;s&&a.push(u,c)}}function hR(n,e){n.lineStyle.native?kxe(n,e):Dxe(n,e)}var dR=function(){function n(){}return n.curveTo=function(e,t,i,r,s,o){var a=o[o.length-2],l=o[o.length-1],c=l-t,u=a-e,h=r-t,d=i-e,f=Math.abs(c*d-u*h);if(f<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;var p=c*c+u*u,g=h*h+d*d,m=c*h+u*d,v=s*Math.sqrt(p)/f,_=s*Math.sqrt(g)/f,y=v*m/p,A=_*m/g,w=v*d+_*u,b=v*h+_*c,C=u*(_+y),I=c*(_+y),x=d*(v+A),T=h*(v+A),O=Math.atan2(I-b,C-w),F=Math.atan2(T-b,x-w);return{cx:w+e,cy:b+t,radius:s,startAngle:O,endAngle:F,anticlockwise:u*h>d*c}},n.arc=function(e,t,i,r,s,o,a,l,c){for(var u=a-o,h=ms._segmentsCount(Math.abs(u)*s,Math.ceil(Math.abs(u)/aA)*40),d=u/(h*2),f=d*2,p=Math.cos(d),g=Math.sin(d),m=h-1,v=m%1/m,_=0;_<=m;++_){var y=_+v*_,A=d+o+f*y,w=Math.cos(A),b=-Math.sin(A);c.push((p*w+g*b)*s+i,(p*-b+g*w)*s+r)}},n}(),zX=function(){function n(){}return n.curveLength=function(e,t,i,r,s,o,a,l){for(var c=10,u=0,h=0,d=0,f=0,p=0,g=0,m=0,v=0,_=0,y=0,A=0,w=e,b=t,C=1;C<=c;++C)h=C/c,d=h*h,f=d*h,p=1-h,g=p*p,m=g*p,v=m*e+3*g*h*i+3*p*d*s+f*a,_=m*t+3*g*h*r+3*p*d*o+f*l,y=w-v,A=b-_,w=v,b=_,u+=Math.sqrt(y*y+A*A);return u},n.curveTo=function(e,t,i,r,s,o,a){var l=a[a.length-2],c=a[a.length-1];a.length-=2;var u=ms._segmentsCount(n.curveLength(l,c,e,t,i,r,s,o)),h=0,d=0,f=0,p=0,g=0;a.push(l,c);for(var m=1,v=0;m<=u;++m)v=m/u,h=1-v,d=h*h,f=d*h,p=v*v,g=p*v,a.push(f*l+3*d*v*e+3*h*p*i+g*s,f*c+3*d*v*t+3*h*p*r+g*o)},n}(),$X=function(){function n(){}return n.curveLength=function(e,t,i,r,s,o){var a=e-2*i+s,l=t-2*r+o,c=2*i-2*e,u=2*r-2*t,h=4*(a*a+l*l),d=4*(a*c+l*u),f=c*c+u*u,p=2*Math.sqrt(h+d+f),g=Math.sqrt(h),m=2*h*g,v=2*Math.sqrt(f),_=d/g;return(m*p+g*d*(p-v)+(4*f*h-d*d)*Math.log((2*g+_+p)/(_+v)))/(4*m)},n.curveTo=function(e,t,i,r,s){for(var o=s[s.length-2],a=s[s.length-1],l=ms._segmentsCount(n.curveLength(o,a,e,t,i,r)),c=0,u=0,h=1;h<=l;++h){var d=h/l;c=o+(e-o)*d,u=a+(t-a)*d,s.push(c+(e+(i-e)*d-c)*d,u+(t+(r-t)*d-u)*d)}},n}(),WX=function(){function n(){this.reset()}return n.prototype.begin=function(e,t,i){this.reset(),this.style=e,this.start=t,this.attribStart=i},n.prototype.end=function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start},n.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},n}(),Wd,Bx=(Wd={},Wd[Yn.POLY]=i2,Wd[Yn.CIRC]=vA,Wd[Yn.ELIP]=vA,Wd[Yn.RECT]=HX,Wd[Yn.RREC]=VX,Wd),fR=[],oy=[],pR=function(){function n(e,t,i,r){t===void 0&&(t=null),i===void 0&&(i=null),r===void 0&&(r=null),this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=t,this.matrix=r,this.type=e.type}return n.prototype.clone=function(){return new n(this.shape,this.fillStyle,this.lineStyle,this.matrix)},n.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},n}(),Rg=new Ae,sI=function(n){n2(e,n);function e(){var t=n.call(this)||this;return t.closePointEps=1e-4,t.boundsPadding=0,t.uvsFloat32=null,t.indicesUint16=null,t.batchable=!1,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.drawCalls=[],t.batchDirty=-1,t.batches=[],t.dirty=0,t.cacheDirty=-1,t.clearDirty=0,t.shapeIndex=0,t._bounds=new oi,t.boundsDirty=-1,t}return Object.defineProperty(e.prototype,"bounds",{get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),oy.push(this.drawCalls[t]);this.drawCalls.length=0;for(var t=0;t<this.batches.length;t++){var i=this.batches[t];i.reset(),fR.push(i)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,i,r,s){i===void 0&&(i=null),r===void 0&&(r=null),s===void 0&&(s=null);var o=new pR(t,i,r,s);return this.graphicsData.push(o),this.dirty++,this},e.prototype.drawHole=function(t,i){if(i===void 0&&(i=null),!this.graphicsData.length)return null;var r=new pR(t,null,null,i),s=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=s.lineStyle,s.holes.push(r),this.dirty++,this},e.prototype.destroy=function(){n.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var i=this.graphicsData,r=0;r<i.length;++r){var s=i[r];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,Rg):Rg.copyFrom(t),s.shape.contains(Rg.x,Rg.y))){var o=!1;if(s.holes)for(var a=0;a<s.holes.length;a++){var l=s.holes[a];if(l.shape.contains(Rg.x,Rg.y)){o=!0;break}}if(!o)return!0}}return!1},e.prototype.updateBatches=function(){if(!this.graphicsData.length){this.batchable=!0;return}if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,i=this.graphicsData,r=null,s=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],s=r.style);for(var o=this.shapeIndex;o<i.length;o++){this.shapeIndex++;var a=i[o],l=a.fillStyle,c=a.lineStyle,u=Bx[a.type];u.build(a),a.matrix&&this.transformPoints(a.points,a.matrix),(l.visible||c.visible)&&this.processHoles(a.holes);for(var h=0;h<2;h++){var d=h===0?l:c;if(d.visible){var f=d.texture.baseTexture,p=this.indices.length,g=this.points.length/2;f.wrapMode=Oc.REPEAT,h===0?this.processFill(a):this.processLine(a);var m=this.points.length/2-g;m!==0&&(r&&!this._compareStyles(s,d)&&(r.end(p,g),r=null),r||(r=fR.pop()||new WX,r.begin(d,p,g),this.batches.push(r),s=d),this.addUvs(this.points,t,d.texture,g,m,d.matrix))}}}var v=this.indices.length,_=this.points.length/2;if(r&&r.end(v,_),this.batches.length===0){this.batchable=!0;return}var y=_>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&y===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=y?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}},e.prototype._compareStyles=function(t,i){return!(!t||!i||t.texture.baseTexture!==i.texture.baseTexture||t.color+t.alpha!==i.color+i.alpha||!!t.native!=!!i.native)},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,i=this.graphicsData.length;t<i;t++){var r=this.graphicsData[t],s=r.fillStyle,o=r.lineStyle;if(s&&!s.texture.baseTexture.valid||o&&!o.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,i=0,r=t.length;i<r;i++)for(var s=t[i],o=0;o<s.size;o++){var a=s.start+o;this.indicesUint16[a]=this.indicesUint16[a]-s.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>65535*2)return!1;for(var t=this.batches,i=0;i<t.length;i++)if(t[i].style.native)return!1;return this.points.length<e.BATCHABLE_SIZE*2},e.prototype.buildDrawCalls=function(){for(var t=++In._globalBatch,i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),oy.push(this.drawCalls[i]);this.drawCalls.length=0;var r=this.colors,s=this.textureIds,o=oy.pop();o||(o=new TC,o.texArray=new IC),o.texArray.count=0,o.start=0,o.size=0,o.type=pa.TRIANGLES;var a=0,l=null,c=0,u=!1,h=pa.TRIANGLES,d=0;this.drawCalls.push(o);for(var i=0;i<this.batches.length;i++){var f=this.batches[i],p=8,g=f.style,m=g.texture.baseTexture;u!==!!g.native&&(u=!!g.native,h=u?pa.LINES:pa.TRIANGLES,l=null,a=p,t++),l!==m&&(l=m,m._batchEnabled!==t&&(a===p&&(t++,a=0,o.size>0&&(o=oy.pop(),o||(o=new TC,o.texArray=new IC),this.drawCalls.push(o)),o.start=d,o.size=0,o.texArray.count=0,o.type=h),m.touched=1,m._batchEnabled=t,m._batchLocation=a,m.wrapMode=Oc.REPEAT,o.texArray.elements[o.texArray.count++]=m,a++)),o.size+=f.size,d+=f.size,c=m._batchLocation,this.addColors(r,g.color,g.alpha,f.attribSize,f.attribStart),this.addTextureIds(s,c,f.attribSize,f.attribStart)}In._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,i=this.uvs,r=this.colors,s=this.textureIds,o=new ArrayBuffer(t.length*3*4),a=new Float32Array(o),l=new Uint32Array(o),c=0,u=0;u<t.length/2;u++)a[c++]=t[u*2],a[c++]=t[u*2+1],a[c++]=i[u*2],a[c++]=i[u*2+1],l[c++]=r[u],a[c++]=s[u];this._buffer.update(o),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){if(t.holes.length)i2.triangulate(t,this);else{var i=Bx[t.type];i.triangulate(t,this)}},e.prototype.processLine=function(t){hR(t,this);for(var i=0;i<t.holes.length;i++)hR(t.holes[i],this)},e.prototype.processHoles=function(t){for(var i=0;i<t.length;i++){var r=t[i],s=Bx[r.type];s.build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,i){for(var r=0;r<t.length/2;r++){var s=t[r*2],o=t[r*2+1];t[r*2]=i.a*s+i.c*o+i.tx,t[r*2+1]=i.b*s+i.d*o+i.ty}},e.prototype.addColors=function(t,i,r,s,o){o===void 0&&(o=0);var a=(i>>16)+(i&65280)+((i&255)<<16),l=ZT(a,r);t.length=Math.max(t.length,o+s);for(var c=0;c<s;c++)t[o+c]=l},e.prototype.addTextureIds=function(t,i,r,s){s===void 0&&(s=0),t.length=Math.max(t.length,s+r);for(var o=0;o<r;o++)t[s+o]=i},e.prototype.addUvs=function(t,i,r,s,o,a){a===void 0&&(a=null);for(var l=0,c=i.length,u=r.frame;l<o;){var h=t[(s+l)*2],d=t[(s+l)*2+1];if(a){var f=a.a*h+a.c*d+a.tx;d=a.b*h+a.d*d+a.ty,h=f}l++,i.push(h/u.width,d/u.height)}var p=r.baseTexture;(u.width<p.width||u.height<p.height)&&this.adjustUvs(i,r,c,o)},e.prototype.adjustUvs=function(t,i,r,s){for(var o=i.baseTexture,a=1e-6,l=r+s*2,c=i.frame,u=c.width/o.width,h=c.height/o.height,d=c.x/c.width,f=c.y/c.height,p=Math.floor(t[r]+a),g=Math.floor(t[r+1]+a),m=r+2;m<l;m+=2)p=Math.min(p,Math.floor(t[m]+a)),g=Math.min(g,Math.floor(t[m+1]+a));d-=p,f-=g;for(var m=r;m<l;m+=2)t[m]=(t[m]+d)*u,t[m+1]=(t[m+1]+f)*h},e.BATCHABLE_SIZE=100,e}(KL),r2=function(n){n2(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.width=0,t.alignment=.5,t.native=!1,t.cap=_o.BUTT,t.join=ma.MITER,t.miterLimit=10,t}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){n.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(t2),Oxe=new Float32Array(3),GS={},hn=function(n){n2(e,n);function e(t){t===void 0&&(t=null);var i=n.call(this)||this;return i.shader=null,i.pluginName="batch",i.currentPath=null,i.batches=[],i.batchTint=-1,i.batchDirty=-1,i.vertexData=null,i._fillStyle=new t2,i._lineStyle=new r2,i._matrix=null,i._holeMode=!1,i.state=Bd.for2d(),i._geometry=t||new sI,i._geometry.refCount++,i._transformID=-1,i.tint=16777215,i.blendMode=Xt.NORMAL,i}return Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,i,r,s,o){return t===void 0&&(t=null),i===void 0&&(i=0),r===void 0&&(r=1),s===void 0&&(s=.5),o===void 0&&(o=!1),typeof t=="number"&&(t={width:t,color:i,alpha:r,alignment:s,native:o}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:Wt.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:_o.BUTT,join:ma.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,i=this.currentPath.points.length;i>2&&(this.drawShape(this.currentPath),this.currentPath=new qu,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[i-2],t[i-1]))}else this.currentPath=new qu,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,i){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=i,this},e.prototype.lineTo=function(t,i){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,s=r[r.length-2],o=r[r.length-1];return(s!==t||o!==i)&&r.push(t,i),this},e.prototype._initCurve=function(t,i){t===void 0&&(t=0),i===void 0&&(i=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,i]):this.moveTo(t,i)},e.prototype.quadraticCurveTo=function(t,i,r,s){this._initCurve();var o=this.currentPath.points;return o.length===0&&this.moveTo(0,0),$X.curveTo(t,i,r,s,o),this},e.prototype.bezierCurveTo=function(t,i,r,s,o,a){return this._initCurve(),zX.curveTo(t,i,r,s,o,a,this.currentPath.points),this},e.prototype.arcTo=function(t,i,r,s,o){this._initCurve(t,i);var a=this.currentPath.points,l=dR.curveTo(t,i,r,s,o,a);if(l){var c=l.cx,u=l.cy,h=l.radius,d=l.startAngle,f=l.endAngle,p=l.anticlockwise;this.arc(c,u,h,d,f,p)}return this},e.prototype.arc=function(t,i,r,s,o,a){if(a===void 0&&(a=!1),s===o)return this;!a&&o<=s?o+=aA:a&&s<=o&&(s+=aA);var l=o-s;if(l===0)return this;var c=t+Math.cos(s)*r,u=i+Math.sin(s)*r,h=this._geometry.closePointEps,d=this.currentPath?this.currentPath.points:null;if(d){var f=Math.abs(d[d.length-2]-c),p=Math.abs(d[d.length-1]-u);f<h&&p<h||d.push(c,u)}else this.moveTo(c,u),d=this.currentPath.points;return dR.arc(c,u,t,i,r,s,o,a,d),this},e.prototype.beginFill=function(t,i){return t===void 0&&(t=0),i===void 0&&(i=1),this.beginTextureFill({texture:Wt.WHITE,color:t,alpha:i})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:Wt.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var i=t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:i},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,i,r,s){return this.drawShape(new Pt(t,i,r,s))},e.prototype.drawRoundedRect=function(t,i,r,s,o){return this.drawShape(new PQ(t,i,r,s,o))},e.prototype.drawCircle=function(t,i,r){return this.drawShape(new YT(t,i,r))},e.prototype.drawEllipse=function(t,i,r,s){return this.drawShape(new SQ(t,i,r,s))},e.prototype.drawPolygon=function(){for(var t=arguments,i=[],r=0;r<arguments.length;r++)i[r]=t[r];var s,o=!0,a=i[0];a.points?(o=a.closeStroke,s=a.points):Array.isArray(i[0])?s=i[0]:s=i;var l=new qu(s);return l.closeStroke=o,this.drawShape(l),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===Yn.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var i=this._geometry;i.updateBatches(),i.batchable?(this.batchDirty!==i.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,i=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(var s=0;s<r;s++){var o=t.batches[s],a=o.style.color,l=new Float32Array(this.vertexData.buffer,o.attribStart*4*2,o.attribSize*2),c=new Float32Array(t.uvsFloat32.buffer,o.attribStart*4*2,o.attribSize*2),u=new Uint16Array(t.indicesUint16.buffer,o.start*2,o.size),h={vertexData:l,blendMode:i,indices:u,uvs:c,_batchRGB:_s(a),_tintRGB:a,_texture:o.style.texture,alpha:o.style.alpha,worldAlpha:1};this.batches[s]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var i=0,r=this.batches.length;i<r;i++){var s=this.batches[i];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}},e.prototype._renderDirect=function(t){var i=this._resolveDirectShader(t),r=this._geometry,s=this.tint,o=this.worldAlpha,a=i.uniforms,l=r.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(s>>16&255)/255*o,a.tint[1]=(s>>8&255)/255*o,a.tint[2]=(s&255)/255*o,a.tint[3]=o,t.shader.bind(i),t.geometry.bind(r,i),t.state.set(this.state);for(var c=0,u=l.length;c<u;c++)this._renderDrawCallDirect(t,r.drawCalls[c])},e.prototype._renderDrawCallDirect=function(t,i){for(var r=i.texArray,s=i.type,o=i.size,a=i.start,l=r.count,c=0;c<l;c++)t.texture.bind(r.elements[c],c);t.geometry.draw(s,o,a)},e.prototype._resolveDirectShader=function(t){var i=this.shader,r=this.pluginName;if(!i){if(!GS[r]){for(var s=t.plugins[r].MAX_TEXTURES,o=new Int32Array(s),a=0;a<s;a++)o[a]=a;var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new Dt,default:vd.from({uSamplers:o},!0)},c=t.plugins[r]._shader.program;GS[r]=new Ku(c,l)}i=GS[r]}return i},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var i=t.bounds,r=i.minX,s=i.minY,o=i.maxX,a=i.maxY;this._bounds.addFrame(this.transform,r,s,o,a)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=_s(this.tint,Oxe),i=0;i<this.batches.length;i++){var r=this.batches[i],s=r._batchRGB,o=t[0]*s[0]*255,a=t[1]*s[1]*255,l=t[2]*s[2]*255,c=(o<<16)+(a<<8)+(l|0);r._tintRGB=(c>>16)+(c&65280)+((c&255)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var i=this.transform.worldTransform,r=i.a,s=i.b,o=i.c,a=i.d,l=i.tx,c=i.ty,u=this._geometry.points,h=this.vertexData,d=0,f=0;f<u.length;f+=2){var p=u[f],g=u[f+1];h[d++]=r*p+o*g+l,h[d++]=a*g+s*p+c}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,n.prototype.destroy.call(this,t)},e.nextRoundedRectBehavior=!1,e._TEMP_POINT=new Ae,e}(mn),oI={buildPoly:i2,buildCircle:vA,buildRectangle:HX,buildRoundedRectangle:VX,buildLine:hR,ArcUtils:dR,BezierUtils:zX,QuadraticUtils:$X,BatchPart:WX,FILL_COMMANDS:Bx,BATCH_POOL:fR,DRAW_CALL_POOL:oy};function n3(n){const{data:{originalEvent:e}}=n;let t=!0;if(e instanceof TouchEvent){const{touches:i,type:r}=e;r!=="touchend"?i.length!==1&&(t=!1):i.length!==0&&(t=!1)}return t}const i3={color:16777215,outlineColor:0,outlineThickness:1,radius:8,shape:"tooth"};class jX extends hn{constructor(t,i,r={},s,o,a){var u,h,d;super();E(this,"transformer");E(this,"onHandleDelta");E(this,"onHandleCommit");E(this,"_handle");E(this,"_style");E(this,"_dirty");E(this,"_pointerDown");E(this,"_pointerDragging");E(this,"_pointerPosition");E(this,"_pointerMoveTarget");this.transformer=t;const l=Object.assign({},i3,r);this._handle=i,this._style=l,this.onHandleDelta=s,this.onHandleCommit=o,this._dirty=!0,this.interactive=!0;const c=(d=(h=(u=this._style)==null?void 0:u.shapeAttrs)==null?void 0:h[i])==null?void 0:d.cursor;this.cursor=c||a||"move",this._pointerDown=!1,this._pointerDragging=!1,this._pointerPosition=new Ae,this._pointerMoveTarget=null,this.on("pointerdown",f=>this.onPointerDown(f,this._handle)),this.on("pointerup",this.onPointerUp,this),this.on("pointerupoutside",this.onPointerUp,this)}get handle(){return this._handle}set handle(t){this._handle=t,this._dirty=!0}get style(){return this._style}set style(t){this._style=Object.assign({},i3,t),this._dirty=!0}render(t){this._dirty&&(this.draw(),this._dirty=!1),super.render(t)}draw(){var o,a,l,c,u;const t=this._handle,i=this._style,r=i.radius;if(this.removeChildren(),this.clear().lineStyle(i.outlineThickness,i.outlineColor).beginFill(i.color),i.shape==="square")this.drawRect(-r/2,-r/2,r,r);else if(i.shape==="component")switch(t){case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":case"rotator":const h=(l=(a=(o=this._style)==null?void 0:o.shapeAttrs)==null?void 0:a[t])==null?void 0:l.component;h&&this.addChild(h);break}else if(i.shape==="tooth"){const h=r*1.8,d=r*1.8;switch(t){case"middleLeft":this.drawPolygon([-r/2,-h/2,-r/2,h/2,r/2,h/2,r/2,-h/2]);break;case"topCenter":this.drawPolygon([-d/2,-r/2,d/2,-r/2,d/2,r/2,-d/2,r/2]);break;case"middleRight":this.drawPolygon([-r/2,h/2,-r/2,-h/2,r/2,-h/2,r/2,h/2]);break;case"bottomCenter":this.drawPolygon([d/2,-r/2,d/2,r/2,-d/2,r/2,-d/2,-r/2]);break;case"rotator":const f=(u=(c=this._style)==null?void 0:c.shapeAttrs[t])==null?void 0:u.component;f?this.addChild(f):this.drawCircle(0,0,r/Math.sqrt(2));break;default:this.drawRect(-r/2,-r/2,r,r);break}}else this.drawCircle(0,0,r);const{style:{hitAreaPadding:s}}=this;if(s){const{x:h,y:d,width:f,height:p}=this.getLocalBounds();f>0&&p>0&&(this.hitArea=new Pt(h-s,d-s,f+s*2,p+s*2))}this.endFill()}onPointerDown(t,i){var r,s,o;n3(t)&&(this._pointerDown=!0,this._pointerDragging=!1,t.stopPropagation(),!((r=this._style)!=null&&r.shapeAttrs&&((o=(s=this._style)==null?void 0:s.shapeAttrs[i])!=null&&o.stopEvent))&&(this._pointerMoveTarget&&(this._pointerMoveTarget.off("pointermove",this.onPointerMove,this),this._pointerMoveTarget=null),this._pointerMoveTarget=this.transformer.stage||this,this._pointerMoveTarget.on("pointermove",this.onPointerMove,this)))}onPointerMove(t){n3(t)&&this._pointerDown&&(this._pointerDragging?this.onDrag(t):this.onDragStart(t),t.stopPropagation())}onPointerUp(){this.reset()}reset(){this._pointerDown=!1,this._pointerDragging&&this.onDragEnd(),this._pointerMoveTarget&&(this._pointerMoveTarget.off("pointermove",this.onPointerMove,this),this._pointerMoveTarget=null)}onDragStart(t){this._pointerPosition.copyFrom(t.data.global),this._pointerDragging=!0}onDrag(t){const i=t.data.global;this.onHandleDelta&&this.onHandleDelta(i),this._pointerPosition.copyFrom(i)}onDragEnd(){this._pointerDragging=!1,this.onHandleCommit&&this.onHandleCommit()}}function ew(n,e,t,i){const{x:r,y:s}=t,{x:o,y:a}=i;if(Math.abs(o-r)<.01)return Math.abs(n-r);if(Math.abs(a-s)<.01)return Math.abs(e-s);const l=(a-s)/(o-r);return Math.abs((l*n-e+(a-l*o))/Math.sqrt(l*l+1))}const r3=GX.build(Ae),s3=[new Ae,new Ae,new Ae,new Ae],Lxe=new Dt,Dg=new Ae,Nxe=[0,0,0,1,-1,1,-1,-1,1,-1,1,0],Bxe=[0,0,-1,0,-1,-1,1,-1,1,1,0,1],Fxe=[0,0,1,0,1,1,-1,1,-1,-1,0,-1],Uxe=[0,0,0,-1,1,-1,1,1,-1,1,-1,0],HS=new Array(12),Gxe=[Nxe,Bxe,Fxe,Uxe];class Hxe extends hn{constructor(t){super();E(this,"transformer");E(this,"boxScalingHandles");this.transformer=t,this.boxScalingHandles=[this.addChild(new hn),this.addChild(new hn),this.addChild(new hn),this.addChild(new hn)],this.boxScalingHandles.forEach(i=>{i.interactive=!0}),this.boxScalingHandles[0].cursor=ay.topCenter,this.boxScalingHandles[1].cursor=ay.middleRight,this.boxScalingHandles[2].cursor=ay.bottomCenter,this.boxScalingHandles[3].cursor=ay.middleLeft}hitHandleType(t,i,r){const{boxRotationEnabled:s,boxRotationTolerance:o,boxScalingEnabled:a,boxScalingTolerance:l}=this.transformer,[c,u,h,d]=t.hull,{x:f,y:p}=i.applyInverse(r,Dg);if(a){const g=ew(f,p,c,u)*i.d,m=ew(f,p,c,d)*i.a,v=ew(f,p,u,h)*i.a,_=ew(f,p,d,h)*i.d,y=Math.min(g,m,v,_);if(y<l)switch(y){case g:return"topCenter";case m:return"middleLeft";case v:return"middleRight";case _:return"bottomCenter"}}if(s&&!t.contains(f,p)){const g=Math.sqrt((c.x-f)**2+(c.y-p)**2),m=Math.sqrt((u.x-f)**2+(u.y-p)**2),v=Math.sqrt((d.x-f)**2+(d.y-p)**2),_=Math.sqrt((h.x-f)**2+(h.y-p)**2),y=Math.min(g,m,v,_);if(y<o*1.45)switch(y){case g:return"boxRotateTopLeft";case m:return"boxRotateTopRight";case v:return"boxRotateBottomLeft";case _:return"boxRotateBottomRight"}}return null}drawBounds(t){const i=s3;for(let r=0;r<4;r++)this.transformer.projectToLocal(t.hull[r],i[r]);this.drawPolygon(i)}drawDashedBounds(t){const i=s3;for(let r=0;r<4;r++)this.transformer.projectToLocal(t.hull[r],i[r]);this.drawDashedLine(i[0],i[1]),this.drawDashedLine(i[1],i[2]),this.drawDashedLine(i[2],i[3]),this.drawDashedLine(i[3],i[0])}drawDashedLine(t,i){this.lineStyle(.666,0,0),this.moveTo(t.x,t.y).lineTo(i.x,i.y);let r=5;const s=5,o=Math.hypot(i.x-t.x,i.y-t.y),a={x:(i.x-t.x)/o,y:(i.y-t.y)/o};this.lineStyle(.666,0),this.moveTo(t.x,t.y).lineTo(t.x+r*a.x,t.y+r*a.y);let l=r+s;for(;l<o;){this.moveTo(t.x+l*a.x,t.y+l*a.y);const c=o-l;r=c<r?c:r,l+=r,this.lineTo(t.x+l*a.x,t.y+l*a.y),l+=s}}drawBoxScalingTolerance(t,i=this.transformer.boxScalingTolerance){t.innerBounds.pad(-i);const r=r3.allocateArray(4);r.forEach((o,a)=>{this.projectToLocal(t.hull[a],o)}),t.innerBounds.pad(2.5*i);const s=r3.allocateArray(4);s.forEach((o,a)=>{this.projectToLocal(t.hull[a],o)}),t.innerBounds.pad(-1.5*this.transformer.boxScalingTolerance);for(let o=0;o<4;o++){const a=r[o],l=r[(o+1)%4],c=s[o],u=s[(o+1)%4];this.boxScalingHandles[o].clear().beginFill(16777215,1e-4).drawPolygon(a,c,u,l).endFill()}}drawBoxRotationTolerance(){const{boxRotateTopLeft:t,boxRotateTopRight:i,boxRotateBottomLeft:r,boxRotateBottomRight:s}=this.transformer.handleAnchors,o=this.transformer.boxRotationTolerance*2,a=Lxe.identity().scale(o,o).rotate(this.transformer.getGroupBounds().rotation);for(let l=0;l<4;l++){const c=Gxe[l];let u;switch(l){case 0:u=t;break;case 1:u=i;break;case 2:u=r;break;case 3:u=s;break}for(let h=0;h<c.length;h+=2){const d=c[h],f=c[h+1];Dg.set(d,f),a.apply(Dg,Dg),HS[h]=Dg.x+u.x,HS[h+1]=Dg.y+u.y}this.drawPolygon(HS.slice())}}projectToLocal(t,i){return this.transformer.projectToLocal(t,i)}}function QX(n,e,t,i=n.pivot){const r=e.a,s=e.b,o=e.c,a=e.d,l=-Math.atan2(-o,a),c=Math.atan2(s,r);return t=t??c,n.pivot.set(i.x,i.y),n.rotation=t,n.skew.x=t+l,n.skew.y=-t+c,n.scale.x=Math.sqrt(r*r+s*s),n.scale.y=Math.sqrt(o*o+a*a),n.position.x=e.tx+(i.x*e.a+i.y*e.c),n.position.y=e.ty+(i.x*e.b+i.y*e.d),n}const tw=new Dt,Vxe=new Dt;function zxe(n,e,t){if(!t){const s=n.parent?n.parent:n.enableTempParent();n.updateTransform(),n.disableTempParent(s)}const i=n.worldTransform,r=n.parent?Vxe.copyFrom(n.parent.worldTransform):Dt.IDENTITY;tw.copyFrom(i),tw.prepend(e),tw.prepend(r.invert()),QX(n.transform,tw)}const XX=new Dt;function o3(n){const e=XX.identity();return e.c=Math.tan(n),e}function a3(n){const e=XX.identity();return e.b=Math.tan(n),e}const nw=new nb,$xe=[new Ae,new Ae,new Ae,new Ae],kg=new Dt,jd=new Ae,l3=new xy,c3=new Pt,VS=[new Ae,new Ae,new Ae,new Ae],u3=new Ae,h3=new Dt,iw=GX.build(Ae),ay={topLeft:"nw-resize",topCenter:"n-resize",topRight:"ne-resize",middleLeft:"w-resize",middleRight:"e-resize",bottomLeft:"sw-resize",bottomCenter:"s-resize",bottomRight:"se-resize"},Fx=["topLeft","topCenter","topRight","middleLeft","middleCenter","middleRight","bottomLeft","bottomCenter","bottomRight"];var zp;(function(n){n.pixi="pixi",n.custom="custom",n.lock="lock"})(zp||(zp={}));const d3={topLeft:{x:-1,y:-1},topCenter:{x:0,y:-1},topRight:{x:1,y:-1},middleLeft:{x:-1,y:0},middleCenter:{x:0,y:0},middleRight:{x:1,y:0},bottomLeft:{x:-1,y:1},bottomCenter:{x:0,y:1},bottomRight:{x:1,y:1}},Wxe=[...Fx,"rotator","skewHorizontal","skewVertical"],jxe=4,Qxe=16,Xxe=[Math.PI/4,Math.PI/2,Math.PI*3/4,Math.PI,0,-Math.PI/4,-Math.PI/2,-Math.PI*3/4,-Math.PI],Yxe=Math.PI/90,qxe=[Math.PI/4,-Math.PI/4],Kxe=Math.PI/90,f3={color:0,thickness:2};class Xr extends mn{constructor(t={}){var l;super();E(this,"group");E(this,"boundingBoxes");E(this,"boxRotationEnabled");E(this,"boxRotationTolerance");E(this,"boxScalingEnabled");E(this,"boxScalingTolerance");E(this,"centeredScaling");E(this,"cursors");E(this,"lazyMode");E(this,"lazyDirty");E(this,"lockAspectRatio");E(this,"projectionTransform");E(this,"rotationSnaps");E(this,"rotationSnapTolerance");E(this,"skewRadius");E(this,"skewSnaps");E(this,"skewSnapTolerance");E(this,"stage");E(this,"translateEnabled");E(this,"transientGroupTilt");E(this,"groupBounds");E(this,"handles");E(this,"handleAnchors");E(this,"wireframe");E(this,"_enabledHandles");E(this,"_rotateEnabled");E(this,"_scaleEnabled");E(this,"_skewEnabled");E(this,"_skewX");E(this,"_skewY");E(this,"_transformHandle");E(this,"_transformType");E(this,"_handleStyle");E(this,"_wireframeStyle");E(this,"_pointerDown");E(this,"_pointerDragging");E(this,"_pointerPosition");E(this,"_pointerMoveTarget");E(this,"_isTranslateChange");E(this,"_handleMode");E(this,"defaultHandleMode");E(this,"_handleModes");E(this,"_onPointerDown");E(this,"_onPointerUp");E(this,"options");E(this,"selectedGroupTags",[]);E(this,"groupMap",{});E(this,"translateGroup",t=>{this._transformHandle=null,this._transformType="translate";const i=kg.identity().translate(t.x,t.y);this.prependTransform(i)});E(this,"rotateGroup",(t,i)=>{this._transformHandle=t,this._transformType="rotate";const r=this.groupBounds,s=this.worldTransform.apply(this.handleAnchors[t],jd);this.projectionTransform.applyInverse(s,s),i=this.projectionTransform.applyInverse(i,u3);const o=r.center,a=Math.atan2(s.y-o.y,s.x-o.x);let c=Math.atan2(i.y-o.y,i.x-o.x)-a,u=this.groupBounds.rotation+c;u=this.snapAngle(u,this.rotationSnapTolerance,this.rotationSnaps),c=u-this.groupBounds.rotation;const h=kg.identity().translate(-o.x,-o.y).rotate(c).translate(o.x,o.y);this.prependTransform(h,!0),this.updateGroupBounds(u),this._skewX+=c,this._skewY+=c});E(this,"skewGroup",(t,i)=>{this._transformHandle=t,this._transformType="skew";const r=this.groupBounds,s=jd.copyFrom(i);this.projectionTransform.applyInverse(s,s);const o=r.center,a=kg.identity().translate(-o.x,-o.y);let l=this.groupBounds.rotation;if(t==="skewHorizontal"){const c=this._skewX;this._skewX=Math.atan2(s.y-o.y,s.x-o.x),this._skewX=this.snapAngle(this._skewX,this.skewSnapTolerance,this.skewSnaps),a.prepend(a3(-c)),a.prepend(a3(this._skewX))}else{const c=this._skewY,u=Math.atan2(s.y-o.y,s.x-o.x)-Math.PI/2;this._skewY=u,this._skewY=this.snapAngle(this._skewY,this.skewSnapTolerance,this.skewSnaps),a.prepend(o3(c)),a.prepend(o3(-this._skewY)),l-=this._skewY-c}a.translate(o.x,o.y),this.prependTransform(a,!0),this.updateGroupBounds(l)});E(this,"commitGroup",()=>{const t=this._transformType;this._transformHandle=null,this._transformType="none",this.transientGroupTilt!==!1&&(this.updateGroupBounds(0),this.emit("transformchange","matrix")),this.emit("transformcommit",{type:t})});this.options=t,this.interactive=!0,this.cursors=Object.assign({default:"move"},t.cursors),this.cursor=this.cursors.default,this.boundingBoxes=t.boundingBoxes||"all",this.group=t.group||[],this.boxRotationTolerance=t.boxRotationTolerance||Qxe,this.boxScalingTolerance=t.boxScalingTolerance||jxe,this.centeredScaling=!!t.centeredScaling,this.projectionTransform=new Dt,this.lockAspectRatio=t.lockAspectRatio===!0,this.rotationSnaps=t.rotationSnaps||Xxe,this.rotationSnapTolerance=t.rotationSnapTolerance!==void 0?t.rotationSnapTolerance:Yxe,this.skewRadius=t.skewRadius||64,this.skewSnaps=t.skewSnaps||qxe,this.skewSnapTolerance=t.skewSnapTolerance!==void 0?t.skewSnapTolerance:Kxe,this.boxRotationEnabled=t.boxRotationEnabled===!0,this.boxScalingEnabled=t.boxScalingEnabled===!0,this._rotateEnabled=t.rotateEnabled!==!1,this._scaleEnabled=t.scaleEnabled!==!1,this._skewEnabled=t.skewEnabled===!0,this.translateEnabled=t.translateEnabled!==!1,this.transientGroupTilt=t.transientGroupTilt!==void 0?t.transientGroupTilt:!0,this.wireframe=this.addChild(new Hxe(this)),this.wireframe.cursor="none",this.stage=t.stage||null,this._skewX=0,this._skewY=0,this._transformType="none",this._wireframeStyle=Object.assign({},f3,t.wireframeStyle||{});const i=t.handleConstructor||jX;this._handleMode=t.defaultHandleMode||zp.custom,this.defaultHandleMode=this._handleMode,this._handleModes=t.handleModes||{};const r=((l=this._handleModes[this._handleMode])==null?void 0:l.handleStyle)||{};this._handleStyle=r,this._onPointerDown=t.onPointerDown,this._onPointerUp=t.onPointerUp;const s={rotator:this.addChild(new i(this,"rotator",r,c=>{this.rotateGroup("rotator",c)},this.commitGroup))},o=Fx.reduce((c,u)=>{const h=new i(this,u,r,null,this.commitGroup,ay[u]);return h.onHandleDelta=d=>{this.scaleGroup(h.handle,d)},h.visible=this._scaleEnabled,c[u]=h,this.addChild(c[u]),u==="middleCenter"&&(h.interactive=!1),c},{}),a={skewHorizontal:this.addChild(new i(this,"skewHorizontal",r,c=>{this.skewGroup("skewHorizontal",c)},this.commitGroup,"pointer")),skewVertical:this.addChild(new i(this,"skewVertical",r,c=>{this.skewGroup("skewVertical",c)},this.commitGroup,"pointer"))};this.handles=Object.assign({},o,s,a),this.handles.skewHorizontal.visible=this._skewEnabled,this.handles.skewVertical.visible=this._skewEnabled,this.handleAnchors={rotator:new Ae,boxRotateTopLeft:new Ae,boxRotateTopRight:new Ae,boxRotateBottomLeft:new Ae,boxRotateBottomRight:new Ae,topLeft:new Ae,topCenter:new Ae,topRight:new Ae,middleLeft:new Ae,middleCenter:new Ae,middleRight:new Ae,bottomLeft:new Ae,bottomCenter:new Ae,bottomRight:new Ae,skewHorizontal:new Ae,skewVertical:new Ae},this.groupBounds=new xy,this.updateGroupBounds(),this._pointerDown=!1,this._pointerDragging=!1,this._pointerPosition=new Ae,this._pointerMoveTarget=null,this.on("pointerdown",this.onPointerDown,this),this.on("pointerup",this.onPointerUp,this),this.on("pointerupoutside",this.onPointerUp,this)}get isTranslateChange(){return this._isTranslateChange}setSelection(t){this.group=t,this.updateGroupBounds(0)}setGroupSelection(t,i){this.selectedGroupTags=t,this.groupMap=i}get enabledHandles(){return this._enabledHandles}set enabledHandles(t){!this._enabledHandles&&!t||(this._enabledHandles=t,Wxe.forEach(i=>{this.handles[i].visible=!1}),t?t.forEach(i=>{this.handles[i].visible=!0}):(this.handles.rotator.visible=this._rotateEnabled,this.handles.skewHorizontal.visible=this._skewEnabled,this.handles.skewVertical.visible=this._skewEnabled,Fx.forEach(i=>{i!=="middleCenter"&&(this.handles[i].visible=this._scaleEnabled)})))}get handleStyle(){return this._handleStyle}set handleStyle(t){const i=this.handles;for(const r in i)i[r].style=t;this._handleStyle=t}get rotateEnabled(){return this._rotateEnabled}set rotateEnabled(t){if(this._rotateEnabled!==t){if(this._rotateEnabled=t,this._enabledHandles)return;this.handles.rotator.visible=t}}get scaleEnabled(){return this._scaleEnabled}set scaleEnabled(t){if(this._scaleEnabled!==t){if(this._scaleEnabled=t,this._enabledHandles)return;Fx.forEach(i=>{i!=="middleCenter"&&(this.handles[i].visible=t)})}}get skewEnabled(){return this._skewEnabled}set skewEnabled(t){if(this._skewEnabled!==t){if(this._skewEnabled=t,this._enabledHandles)return;this.handles.skewHorizontal.visible=t,this.handles.skewVertical.visible=t}}get transformType(){return this._transformType}get wireframeStyle(){return this._wireframeStyle}set wireframeStyle(t){this._wireframeStyle=Object.assign({},f3,t)}getGroupBounds(t=!1){return t&&this.updateGroupBounds(),this.groupBounds}updateGroupboundsRotation(t){this.groupBounds.rotation=t*Yo}static calculateScaleRatio(t,i,r){const{bounds:s,xDir:o=1,yDir:a=1,lockAspectRatio:l=!0}=r,c=s.innerBounds,u=t.x-i.x,h=t.y-i.y,d=(s.topRight.x-s.topLeft.x)/c.width,f=(s.topRight.y-s.topLeft.y)/c.width,p=(s.bottomLeft.x-s.topLeft.x)/c.height,g=(s.bottomLeft.y-s.topLeft.y)/c.height,m=u*d+h*f,v=u*p+h*g;let _=1+m*o/c.width,y=1+v*a/c.height;return l&&(_=y=Math.max(_,y)),{sx:_,sy:y}}scaleGroup(t,i,r=1,s=1){this._transformHandle=t,this._transformType="scale";const o=d3[t].x,a=d3[t].y,l=this.handles,c=this.groupBounds,u=c.rotation,h=c.innerBounds;if(h.width<=0||h.height<=0)return;const d=this.worldTransform.apply(this.handleAnchors[t],jd);this.projectionTransform.applyInverse(d,d),i=this.projectionTransform.applyInverse(i,u3);let{sx:f,sy:p}=Xr.calculateScaleRatio(i,d,{bounds:c,xDir:o,yDir:a,lockAspectRatio:!1});f<0&&(f=r/h.width*s),p<0&&(p=r/h.height*s);const g=this.lockAspectRatio,m=t==="bottomCenter"||t==="topCenter"||t==="middleLeft"||t==="middleRight";let v=o,_=a;g&&(m?o!==0?(p=f,v=_=o):a!==0&&(f=p,v=_=a):f>p?p=f:f=p);const y=kg.identity();if(v!==0&&f!==0){const A=this.centeredScaling||g&&m?c.center:o===1?c.topLeft:c.topRight;y.translate(-A.x,-A.y).rotate(-u).scale(f,1).rotate(u).translate(A.x,A.y)}if(_!==0&&p!==0){const A=this.centeredScaling||g&&m?c.center:_===1?c.topLeft:c.bottomLeft;y.translate(-A.x,-A.y).rotate(-u).scale(1,p).rotate(u).translate(A.x,A.y)}if((p<0||f<0)&&!(p<0&&f<0))switch(t){case"topLeft":case"bottomLeft":this.swapHandles(l.topLeft,l.bottomLeft);break;case"topCenter":case"bottomCenter":this.swapHandles(l.topCenter,l.bottomCenter);break;case"topRight":case"bottomRight":this.swapHandles(l.topRight,l.bottomRight);break}this.prependTransform(y)}render(t){this.renderable&&this.visible&&(!this.lazyMode||this.lazyDirty)&&this.draw(),super.render(t)}changeMode(t){const i=this._handleModes[t];i&&(this._handleMode=t,this.handleStyle=i.handleStyle)}draw(){const t=this.group,{color:i,thickness:r}=this._wireframeStyle;this.wireframe.clear(),this.boundingBoxes!=="none"&&this.wireframe.lineStyle(r,i),this.translateEnabled&&this.wireframe.beginFill(16777215,1e-4);for(let o=0,a=t.length;o<a&&this.boundingBoxes==="all";o++)this.wireframe.drawBounds(Xr.calculateOrientedBounds(t[o],l3));const s=Xr.calculateGroupOrientedBounds(t,this.groupBounds.rotation,l3,!0);this._handleMode===zp.lock?(this.wireframe.drawBounds(s),this.drawDashedHandles(s),this.cursor="default"):(this.wireframe.drawBounds(s),this.drawHandles(s),this.groupBounds.copyFrom(s),this.boxRotationEnabled&&(this.wireframe.closePath().beginFill(16777215,1e-4).lineStyle(),this.wireframe.drawBoxRotationTolerance()),this.boxScalingEnabled&&(this.wireframe.closePath().beginFill(16773375,1e-4).lineStyle(),this.wireframe.drawBoxScalingTolerance(s))),this.lazyDirty=!1}hideAllHandles(){for(const t in this.handles)this.handles[t]&&(this.handles[t].visible=!1)}showHandle(t){switch(t){case"skewHorizontal":case"skewVertical":this.handles[t].visible=this._skewEnabled;break;case"topLeft":case"topCenter":case"topRight":case"middleLeft":case"middleRight":case"bottomLeft":case"bottomCenter":case"bottomRight":{this.handles[t].visible=this._scaleEnabled;break}case"rotator":case"boxRotateTopLeft":case"boxRotateTopRight":case"boxRotateBottomLeft":case"boxRotateBottomRight":{this.handles[t].visible=this._rotateEnabled;break}case"middleCenter":this.handles[t].visible=this.translateEnabled;break;default:console.log("[ 缺少对应配置 ]");break}}drawHandles(t){var A;if(!this.group.length){this.hideAllHandles();return}const{rotatorDistance:i=32}=this.handleStyle,r=this.handles,s=this.handleAnchors,{topLeft:o,topRight:a,bottomLeft:l,bottomRight:c,center:u}=t,[h,d,f,p]=VS,g=jd;if(this.projectToLocal(o,h),this.projectToLocal(a,d),this.projectToLocal(l,f),this.projectToLocal(c,p),this.projectToLocal(u,g),s.topLeft.copyFrom(h),s.topCenter.set((h.x+d.x)/2,(h.y+d.y)/2),s.topRight.copyFrom(d),s.middleLeft.set((h.x+f.x)/2,(h.y+f.y)/2),s.middleCenter.set((h.x+p.x)/2,(h.y+p.y)/2),s.middleRight.set((d.x+p.x)/2,(d.y+p.y)/2),s.bottomLeft.copyFrom(f),s.bottomCenter.set((f.x+p.x)/2,(f.y+p.y)/2),s.bottomRight.copyFrom(p),this.boxRotationEnabled&&(s.boxRotateTopLeft.copyFrom(s.topLeft),s.boxRotateTopRight.copyFrom(s.topRight),s.boxRotateBottomLeft.copyFrom(s.bottomLeft),s.boxRotateBottomRight.copyFrom(s.bottomRight)),this._rotateEnabled){const w=(h.x+d.x)/2,b=(h.y+d.y)/2;let C=-(h.y-d.y),I=h.x-d.x;const x=Math.sqrt(C*C+I*I);C*=i/x,I*=i/x,r.rotator.position.x=w+C,r.rotator.position.y=b+I,this.options.showRotatorLine&&this.wireframe.moveTo(w,b).lineTo(r.rotator.position.x,r.rotator.position.y),this.handleAnchors.rotator.copyFrom(r.rotator.position)}if(this._skewEnabled){const w=g.x,b=g.y;this.worldTransform.apply(g,g),s.skewHorizontal.set(g.x+Math.cos(this._skewX)*this.skewRadius,g.y+Math.sin(this._skewX)*this.skewRadius),s.skewVertical.set(g.x+-Math.sin(this._skewY)*this.skewRadius,g.y+Math.cos(this._skewY)*this.skewRadius),this.worldTransform.applyInverse(s.skewHorizontal,s.skewHorizontal),this.worldTransform.applyInverse(s.skewVertical,s.skewVertical),g.set(w,b),this.wireframe.beginFill(this.wireframeStyle.color).drawCircle(g.x,g.y,this.wireframeStyle.thickness*2).endFill(),this.wireframe.moveTo(g.x,g.y).lineTo(r.skewHorizontal.x,r.skewHorizontal.y).moveTo(g.x,g.y).lineTo(r.skewVertical.x,r.skewVertical.y)}const{width:m,height:v}=this.groupBounds.innerBounds,{minSize:_=0,keepHandles:y=[]}=this.handleStyle;for(const w in r){const b=r[w];let C=this.groupBounds.rotation;_>0&&(m<_||v<_)?y.includes(w)?this.showHandle(w):(b.visible=!1,(A=b.reset)==null||A.call(b)):this.showHandle(w),w==="skewHorizontal"?C=this._skewX:w==="skewVertical"&&(C=this._skewY),b.rotation=C,b.position.copyFrom(s[w]),b.getBounds(!1,c3)}}drawDashedHandles(t){var y;const i=this.handles,r=this.handleAnchors,{topLeft:s,topRight:o,bottomLeft:a,bottomRight:l,center:c}=t,[u,h,d,f]=VS,p=jd;this.projectToLocal(s,u),this.projectToLocal(o,h),this.projectToLocal(a,d),this.projectToLocal(l,f),this.projectToLocal(c,p),r.topLeft.copyFrom(u),r.topCenter.set((u.x+h.x)/2,(u.y+h.y)/2),r.topRight.copyFrom(h),r.middleLeft.set((u.x+d.x)/2,(u.y+d.y)/2),r.middleCenter.set((u.x+f.x)/2,(u.y+f.y)/2),r.middleRight.set((h.x+f.x)/2,(h.y+f.y)/2),r.bottomLeft.copyFrom(d),r.bottomCenter.set((d.x+f.x)/2,(d.y+f.y)/2),r.bottomRight.copyFrom(f);const{width:g,height:m}=this.groupBounds.innerBounds,{minSize:v=0,keepHandles:_=[]}=this.handleStyle;for(const A in i){const w=i[A];v>0&&(g<v||m<v)?_.includes(A)?w.visible=!0:(w.visible=!1,(y=w.reset)==null||y.call(w)):w.visible=!0,w.position.copyFrom(r[A]),w.getBounds(!1,c3)}}onPointerDown(t){this._pointerDown=!0,this._pointerDragging=!1,this._isTranslateChange=!1,mt(this._onPointerDown)&&this._onPointerDown(t.data.originalEvent),t.stopPropagation(),this._pointerMoveTarget&&(this._pointerMoveTarget.off("pointermove",this.onPointerMove,this),this._pointerMoveTarget=null),this._pointerMoveTarget=this.stage||this,this._pointerMoveTarget.on("pointermove",this.onPointerMove,this)}onPointerMove(t){const i=this._pointerPosition,r=iw.allocate().copyFrom(t.data.global),s=this.wireframe.hitHandleType(this.groupBounds,this.projectionTransform,r);if(!this._pointerDown)this.setCursorFromHoveredHandle(s);else{const o=r.x,a=r.y;if(this._pointerDragging)switch(this._transformHandle){case"boxRotateTopLeft":case"boxRotateTopRight":case"boxRotateBottomLeft":case"boxRotateBottomRight":this.rotateGroup(this._transformHandle,r);break;case"topCenter":case"middleLeft":case"middleRight":case"bottomCenter":this.scaleGroup(this._transformHandle,r);break;default:if(this.translateEnabled){const[l,c,u]=VS;l.set(0,0),c.set(r.x-i.x,r.y-i.y),this.projectionTransform.applyInverse(l,l),this.projectionTransform.applyInverse(c,c),u.set(c.x-l.x,c.y-l.y),this._isTranslateChange=!0,this.translateGroup(u)}}else this._transformHandle=this.wireframe.hitHandleType(this.groupBounds,this.projectionTransform,r),this.setCursorFromHoveredHandle(s);this._pointerPosition.x=o,this._pointerPosition.y=a,this._pointerDragging=!0,t.stopPropagation()}iw.release(r)}onPointerUp(t){mt(this._onPointerUp)&&this._onPointerUp(t.data.originalEvent),this._pointerDown&&(this._pointerDragging=!1,this._pointerDown=!1,this._isTranslateChange&&this.commitGroup(),t.stopPropagation(),this._pointerMoveTarget&&(this._pointerMoveTarget.off("pointermove",this.onPointerMove,this),this._pointerMoveTarget=null))}prependTransform(t,i=!1){const s=this.group.filter(o=>{const{groupTag:a}=o;let{enableTransform:l}=o;return a.startsWith("g-")&&this.selectedGroupTags.includes(a)&&(l=this.groupMap[a].enableTransform),l});for(let o=0,a=s.length;o<a;o++)zxe(s[o],t,!1);h3.copyFrom(t),i||this.updateGroupBounds(),this.emit("transformchange","matrix",h3)}updateGroupBounds(t=this.groupBounds.rotation){Xr.calculateGroupOrientedBounds(this.group,t,this.groupBounds),this.drawHandles(this.groupBounds),this.lazyDirty=!0}snapAngle(t,i,r){if(t=t%(Math.PI*2),!r||r.length===1||!i)return t;for(let s=0,o=r.length;s<o;s++)if(Math.abs(t-r[s])<=i)return r[s];return t}swapHandles(t,i){const r=t.handle,s=i.handle,o=t.cursor,a=i.cursor,l=t.x,c=i.x,u=t.y,h=i.y;t.handle=s,i.handle=r,t.position.set(c,h),i.position.set(l,u),t.cursor=a,i.cursor=o,this.handles[r]=i,this.handles[s]=t,this._transformHandle===r?this._transformHandle=s:this._transformHandle===s&&(this._transformHandle=r)}setCursorFromHoveredHandle(t){if(t&&t.startsWith("boxRotate"))this.cursor=this.cursors.boxRotate||this.cursors.default;else if(t)switch(t){case"topCenter":this.cursor=this.cursors.boxScaleTop||this.cursors.default;break;case"middleLeft":this.cursor=this.cursors.boxScaleLeft||this.cursors.default;break;case"middleRight":this.cursor=this.cursors.boxScaleRight||this.cursors.default;break;case"bottomCenter":this.cursor=this.cursors.boxScaleBottom||this.cursors.default;break}else this.cursor=this.cursors.translate||this.cursors.default}projectToLocal(t,i){return i||(i=new Ae),this.projectionTransform.apply(t,i),this.worldTransform.applyInverse(i,i),i}static calculateTransformedCorners(t,i,r,s=0){var a;if(t!=null&&t.destroyed)return r;let o;return"getTransformerBounds"in t&&typeof t.getTransformerBounds=="function"?{transform:i,localBounds:o}=(a=t.getTransformerBounds)==null?void 0:a.call(t):(i=t.worldTransform,o=t.getLocalBounds()),t.getBounds(),r=r||[new Ae,new Ae,new Ae,new Ae],r[s].set(o.x,o.y),r[s+1].set(o.x+o.width,o.y),r[s+2].set(o.x+o.width,o.y+o.height),r[s+3].set(o.x,o.y+o.height),i.apply(r[s],r[s]),i.apply(r[s+1],r[s+1]),i.apply(r[s+2],r[s+2]),i.apply(r[s+3],r[s+3]),r}static calculateOrientedBounds(t,i){if(t!=null&&t.destroyed)return i;const r=t.parent?t.parent:t.enableTempParent();t.updateTransform(),t.disableTempParent(r),QX(nw,t.worldTransform),nw.updateLocalTransform();const s=nw.rotation,o=Xr.calculateTransformedCorners(t,t.worldTransform,$xe),a=(o[0].x+o[1].x+o[2].x+o[3].x)/4,l=(o[0].y+o[1].y+o[2].y+o[3].y)/4,c=kg.identity().translate(-a,-l).rotate(-nw.rotation).translate(a,l);return c.apply(o[0],o[0]),c.apply(o[1],o[1]),c.apply(o[2],o[2]),c.apply(o[3],o[3]),i=i||new xy,i.rotation=s,i.innerBounds.x=Math.min(o[0].x,o[1].x,o[2].x,o[3].x),i.innerBounds.y=Math.min(o[0].y,o[1].y,o[2].y,o[3].y),i.innerBounds.width=Math.max(o[0].x,o[1].x,o[2].x,o[3].x)-i.innerBounds.x,i.innerBounds.height=Math.max(o[0].y,o[1].y,o[2].y,o[3].y)-i.innerBounds.y,i}static calculateGroupOrientedBounds(t,i,r,s=!1){const o=[];t.forEach(p=>{if(p!=null&&p.destroyed)return;const g=p;!g.isSprite&&g.children.length>0?g.children.forEach(m=>{const{width:v,height:_}=m.getLocalBounds();(v>0||_>0)&&o.push(m)}):o.push(p)}),t=o;const a=t.length,l=iw.allocateArray(a*4);for(let p=0;p<a;p++){const g=t[p];if(!(g!=null&&g.destroyed)){if(!s){const m=g.parent?g.parent:g.enableTempParent();g.updateTransform(),g.disableTempParent(m)}Xr.calculateTransformedCorners(g,g.worldTransform,l,p*4)}}const c=kg.identity().rotate(-i);let u=Number.MAX_VALUE,h=Number.MAX_VALUE,d=-Number.MAX_VALUE,f=-Number.MAX_VALUE;for(let p=0,g=l.length;p<g;p++){const m=l[p];c.apply(m,m);const v=m.x,_=m.y;u=v<u?v:u,h=_<h?_:h,d=v>d?v:d,f=_>f?_:f}return iw.releaseArray(l),r=r||new xy,r.innerBounds.x=u,r.innerBounds.y=h,r.innerBounds.width=d-u,r.innerBounds.height=f-h,r.rotation=i,c.applyInverse(r.center,jd),r.center.copyFrom(jd),r}onUpdateState(t){var i;if((i=this._handleStyle)!=null&&i.shapeAttrs)for(const r in this._handleStyle.shapeAttrs){const s=this._handleStyle.shapeAttrs[r];(s==null?void 0:s.bindAttrKey)in t&&(s.component.isActive=t[s.bindAttrKey])}}}var it;(function(n){n.CIRCLE="CIRCLE",n.RECT="RECT",n.TEXT="TEXT",n.PATH="PATH",n.LINE="LINE",n.PEN="PEN",n.BITMAP="BITMAP",n.POLYGON="POLYGON",n.ANCHOR_POINT="ANCHOR_POINT",n.CONTROL_POINT="CONTROL_POINT"})(it||(it={}));var mo;(function(n){n.DRAW_BEGIN="DRAW_BEGIN",n.DRAW_DONE="DRAW_DONE",n.DRAW_UPDATE="DRAW_UPDATE"})(mo||(mo={}));var wi;(function(n){n.ADD="ADD",n.EDITOR="EDITOR"})(wi||(wi={}));var di;(function(n){n.STRAIGHT="STRAIGHT",n.NO_MIRRORING="NO_MIRRORING",n.MIRROR_ANGLE="MIRROR_ANGLE",n.MIRROR_ANGLE_AND_LENGTH="MIRROR_ANGLE_AND_LENGTH"})(di||(di={}));var Xn;(function(n){n.ADD="ADD",n.UPDATE="UPDATE",n.DELETE="DELETE",n.CLOSE="CLOSE",n.ENTER_VECTOR_EDIT="ENTER_VECTOR_EDIT",n.EXIT_VECTOR_EDIT="EXIT_VECTOR_EDIT",n.MODEL_EXCHANGE="MODEL_EXCHANGE"})(Xn||(Xn={}));const Jxe="VectorPlugin",jr="auxiliaryPoint",L_="AuxiliaryLine",gR="hoverTempPoint";var aa,Iu,a0,l0,Ym;class aI extends Zr{constructor(t=Number.MAX_VALUE){super();ke(this,aa,[]);ke(this,Iu,[]);ke(this,a0,!1);ke(this,l0,!1);ke(this,Ym,void 0);E(this,"initOperation");Qe(this,Ym,t)}get undoStack(){return S(this,aa)}get redoStack(){return S(this,Iu)}get canUndo(){return S(this,aa).length>0}get canRedo(){return S(this,Iu).length>0}get top(){const t=S(this,aa).length;return t<1?this.initOperation?this.initOperation:void 0:S(this,aa)[t-1]}push(t){S(this,aa).push(t),S(this,Ym)!==Number.MAX_VALUE&&S(this,aa).length>S(this,Ym)&&S(this,aa).shift(),Qe(this,Iu,[]),this.emitCanDoEvent()}undo(){if(!this.canUndo)return;const t=S(this,aa).pop();S(this,Iu).push(t),this.emitCanDoEvent()}redo(){if(!this.canRedo)return;const t=S(this,Iu).pop();S(this,aa).push(t),this.emitCanDoEvent()}clear(){Qe(this,aa,[]),Qe(this,Iu,[]),this.emitCanDoEvent()}emitCanDoEvent(){(S(this,l0)!==this.canRedo||S(this,a0)!==this.canUndo)&&this.emit(ko.CAN_DO_CHANGE,this.canUndo,this.canRedo),this.updateCanDo()}updateCanDo(){Qe(this,l0,this.canRedo),Qe(this,a0,this.canUndo)}}aa=new WeakMap,Iu=new WeakMap,a0=new WeakMap,l0=new WeakMap,Ym=new WeakMap;var Kl;(function(n){n.SELECT="SELECT",n.SELECT_ADD="SELECT_ADD",n.SELECT_REMOVE="SELECT_REMOVE",n.CLEAR_INVALID="SELECTION_CLEAR_INVALID",n.EXEC_SELECT="SELECTION_EXEC_SELECT"})(Kl||(Kl={}));var Ho;(function(n){n.RECORD="RECORD",n.REDO="REDO",n.UNDO="UNDO"})(Ho||(Ho={}));var Xa;(function(n){n.UPDATE_EDIT_MODE="UPDATE_EDIT_MODE",n.BACK_TO_NORMAL_SELECT="BACK_TO_NORMAL_SELECT",n.GET_MODE_MANAGER="GET_MODE_MANAGER",n.UPDATE_SUB_EDIT_MODE="UPDATE_SUB_EDIT_MODE"})(Xa||(Xa={}));var $p;(function(n){n.CHANGE_VISIBLE="TRANSFORMER_CHANGE_VISIBLE"})($p||($p={}));var _A;(function(n){n.CHANGE_VISIBLE="TEXT_CURVE_CHANGE_VISIBLE"})(_A||(_A={}));var Lc;(function(n){n.UPDATE_INTERNAL_DATA="UPDATE_INTERNAL_DATA",n.CLEAR_LINE="CLEAR_LINE"})(Lc||(Lc={}));var gp;(function(n){n.EVENT_TRACKING="EVENT_TRACKING"})(gp||(gp={}));var vo;(function(n){n.QUERY="QUERY",n.CREATE="CREATE",n.CLONE="CLONE",n.UPDATE="UPDATE",n.DESTROY="DESTROY"})(vo||(vo={}));var xi;(function(n){n.ADD_CHILD="ADD_CHILD",n.REMOVE_CHILD="REMOVE_CHILD",n.HIT_ELEMENT="HIT_ELEMENT",n.GET_INTERACT_ELEMENT="GET_INTERACT_ELEMENT",n.CHANGE_CURSOR="CHANGE_CURSOR",n.DISPLAY_LAYER_TRANSLUCENT="DISPLAY_LAYER_TRANSLUCENT",n.CUR_LAYER_CONFIG="CUR_LAYER_CONFIG"})(xi||(xi={}));var Rd;(function(n){n.REGISTER="REGISTER",n.UNREGISTER="UNREGISTER"})(Rd||(Rd={}));var Vh;(function(n){n.UNION="union",n.DIFFERENCE="difference",n.INTERSECTION="intersection",n.XOR="xor"})(Vh||(Vh={}));var Tl;(function(n){n.LEFT="alignToLeft",n.RIGHT="alignToRight",n.TOP="alignToTop",n.BOTTOM="alignToBottom",n.HORIZONTAL_CENTER="alignToHorizontalCenter",n.VERTICAL_CENTER="alignToVerticalCenter",n.HORIZONTAL_DISTRIBUTE="horizontalDistribute",n.VERTICAL_DISTRIBUTE="verticalDistribute",n.ALIGN_CENTER="alignCenter"})(Tl||(Tl={}));var RC;(function(n){n.LINER="createLinerArrays",n.RADIAL="createRadialArrays"})(RC||(RC={}));const Cy={ADD_TO_VIEWPORT:"ADD_TO_VIEWPORT",ADD_TO_TEMP_LAYER:"ADD_TO_TEMP_LAYER",SELECT_VIEWPORT_ELEMENTS:"SELECT_VIEWPORT_ELEMENTS",SELECTING_VIEWPORT_ELEMENTS:"SELECTING_VIEWPORT_ELEMENTS",SET_VIEWPORT_MODE:"SET_VIEWPORT_MODE"},sr={TRANSFORM_CHANGE:"transformchange",TRANSFORM_COMMIT:"transformcommit",SELECT:"SELECT"},ji={DOUBLE_CLICK:"DOUBLE_CLICK",PINCH:"PINCH",PAN:"PAN",PINCH_START:"PINCH_START",PINCH_CHANGE:"PINCH_CHANGE",PINCH_END:"PINCH_END",TWO_FINGER_TAP:"TWO_FINGER_TAP",LONG_PRESS:"LONG_PRESS"},gn={BEFORE_HISTORY_CHANG:"BEFORE_HISTORY_CHANG",HISTORY_CHANG:"HISTORY_CHANG",SELECT_OBJECT:"SELECT_OBJECT",SELECTED_TRANSFORM_COMMIT:"SELECTED_TRANSFORM_COMMIT",SELECT_OBJECT_TRANSFORMERED:"SELECT_OBJECT_TRANSFORMERED",ZOOMED:"ZOOMED",RESIZE:"resize",UPDATE_BACKDROP_RESULT:"UPDATE_BACKDROP_RESULT",UPDATE_CENTRAL_AXIS:"UPDATE_CENTRAL_AXIS",VIEWPORT_RESIZE:"VIEWPORT_RESIZE",DRAW_DISPLAY_DONE:"DRAW_DISPLAY_DONE",UPDATE_IMAGE_PROCESS_VISIBLE:"UPDATE_IMAGE_PROCESS_VISIBLE",UPDATE_IMAGE_TRACING_VISIBLE:"UPDATE_IMAGE_TRACING_VISIBLE",NEW_DISPLAYS_ADDED:"NEW_DISPLAYS_ADDED",DISPLAYS_REMOVED:"DISPLAYS_REMOVED",DISPLAYS_HOVER_CHANGED:"DISPLAYS_HOVER_CHANGED"},DC={ATTRS_CHANGED:"ATTRS_CHANGED",GRAPHICS_CHANDED:"GRAPHICS_CHANDED"};var Gc;(function(n){n.CHANGE="MODE_CHANGE",n.SELECTED_CHANGED="SELECTED_CHANGED",n.SUB_EDIT_MODE_CHANGED="SUB_EDIT_MODE_CHANGED",n.SELECT_ATTR_CHANGED="SELECT_ATTR_CHANGED"})(Gc||(Gc={}));var kC;(function(n){n.ZOOMED="zoomed",n.MOVED="moved"})(kC||(kC={}));var mR;(function(n){n.DISPLAY_CONFIG_CHANGE="DISPLAY_CONFIG_CHANGE"})(mR||(mR={}));var vR;(function(n){n.ENABLE_FILL="ENABLE_FILL"})(vR||(vR={}));var ko;(function(n){n.CAN_DO_CHANGE="UNDO_HISTORY_CAN_DO_CHANGE",n.IMAGE_TRACING_LOADING="IMAGE_TRACING_LOADING"})(ko||(ko={}));var Wp;(function(n){n.GET_POSITION="GET_POSITION",n.CANCEL="CANCEL",n.CURVE_GET_POSITION="CURVE_GET_POSITION",n.CURVE_GET_POSITION_ERROR="CURVE_GET_POSITION_ERROR"})(Wp||(Wp={}));var at;(function(n){n.MESSAGE_TO_MAIN="MESSAGE_TO_MAIN",n.MESSAGE_TO_PLUGIN="MESSAGE_TO_PLUGIN",n.MESSAGE_TO_MANAGER="MESSAGE_TO_MANAGER"})(at||(at={}));var Ns;(function(n){n.UPDATE_EDIT_MODE="UPDATE_EDIT_MODE",n.HISTORY_CHANG="HISTORY_CHANG",n.SELECTED_CHANGED="SELECTED_CHANGED",n.UPDATE_SUB_EDIT_MODE="UPDATE_SUB_EDIT_MODE"})(Ns||(Ns={}));var p3;(function(n){n.SELECT_OBJECT="SELECT_OBJECT",n.SELECT_ATTR_CHANGED="SELECT_ATTR_CHANGED"})(p3||(p3={}));const _R=zp;var OC;(function(n){n.Shift="shiftKey",n.Control="ctrlKey",n.Alt="altKey",n.Win="metaKey",n.Command="metaKey"})(OC||(OC={}));var Vt;(function(n){n.SELECT="SELECT",n.TEXT="TEXT",n.RECT="RECT",n.CIRCLE="CIRCLE",n.LINE="LINE",n.PEN="PEN",n.DRAG="DRAG",n.ZOOM="ZOOM",n.INSERT="INSERT",n.BITMAP_MASK="BITMAP_MASK"})(Vt||(Vt={}));var Xi;(function(n){n.VECTOR_EDITOR="VECTOR_EDITOR",n.TEXT_EDIT="TEXT_EDIT"})(Xi||(Xi={}));const g3={[Vt.CIRCLE]:it.CIRCLE,[Vt.RECT]:it.RECT,[Vt.LINE]:it.LINE};it.CIRCLE+"",Vt.CIRCLE,it.RECT+"",Vt.RECT,it.LINE+"",Vt.LINE,it.TEXT+"",Vt.TEXT,it.PEN+"",Vt.PEN;var fs;(function(n){n.TOP="TOP",n.BOTTOM="BOTTOM",n.LEFT="LEFT",n.RIGHT="RIGHT"})(fs||(fs={}));var Ua;(function(n){n[n.CENTER=0]="CENTER",n[n.TOP_LEFT=1]="TOP_LEFT",n.AUTO="auto",n.WIDTH="width",n.HEIGHT="height"})(Ua||(Ua={}));var bu;(function(n){n.LEFT="left",n.CENTER="center",n.RIGHT="right"})(bu||(bu={}));var wu;(function(n){n.TOP="top",n.CENTER="center",n.BOTTOM="bottom"})(wu||(wu={}));var kc;(function(n){n.UP="UP",n.DOWN="DOWN",n.TOP="TOP",n.END="END"})(kc||(kc={}));var m3;(function(n){n.INNER="inner",n.OUTER="outer"})(m3||(m3={}));var v3;(function(n){n.FLIP_X="flipX",n.FLIP_Y="flipY"})(v3||(v3={}));var rh;(function(n){n.CUTTER="cutter",n.MAGIC_WAND="magicWand",n.ERASER="eraser"})(rh||(rh={}));var zh;(function(n){n.TOP_LEFT="topLeft",n.TOP_RIGHT="topRight",n.BOTTOM_LEFT="bottomLeft",n.BOTTOM_RIGHT="bottomRight"})(zh||(zh={}));var fu;(function(n){n.ALL="all",n.SPECIFIED="specified",n.SELECTED="selected"})(fu||(fu={}));var Fo;(function(n){n.VIEWPORT="viewport",n.TEMP_LAYER="tempLayer"})(Fo||(Fo={}));var ll;(function(n){n.DISPLAY_LAYER="displayLayer",n.TEMP_LAYER="tempLayer"})(ll||(ll={}));var Ey;(function(n){n.LEFT="left",n.RIGHT="right",n.TOP="top",n.BOTTOM="bottom"})(Ey||(Ey={}));const _3=5,Zxe={vectorScaleNum:10,exportVectorPathWhenFill:!1,imageData:!0,path:!0,excludeOutSide:!0,clearSelected:!0},lI={hoverColor:327677,layerData:{}},Za={width:1,color:lI.fillColor,alignment:0,native:!0},ml={worldWidth:388,worldHeight:300,minScale:.25,maxScale:10,fitOffsetRatio:.1,backgroundColor:16777215,backgroundAlpha:1,outlineNative:!0,outlineWidth:1,outlineColor:3583338,outlineAlpha:.5,offsetX:0,offsetY:0},eCe={fillColor:3276,fillAlpha:.2},tCe={fillColor:3276,fillAlpha:.2,buttonWidth:30,buttonHeight:27},nCe=15724527,iCe={positions:[fs.TOP,fs.BOTTOM,fs.LEFT,fs.RIGHT],pixelPerUnit:1,backgroundColor:16777215,backgroundAlpha:1,borderColor:0,borderAlpha:1,scaleColor:0,scaleAlpha:1,fontSize:10,fontColor:0,fontOffset:2,markColor:8900346,markAlpha:1,size:20},rCe={cellSize:10,lineNative:!0,lineWidth:1,lineColor:0,lineAlpha:.3,cellSize2:100,lineNative2:!0,lineWidth2:1,lineColor2:0,lineAlpha2:.8},sCe={alignLineColor:6591981,distanceLineColor:14423100,unit:"mm",pixelPerUnit:1,fractionDigits:0,fontSize:12,fontColor:0,enableAdsorb:!0};var yA;(function(n){n[n.Point=3583338]="Point",n[n.Hollow=16777215]="Hollow",n[n.ControlPoint=8900346]="ControlPoint"})(yA||(yA={}));const Ty={SHARPNESS:50,GRAY_VALUE:[0,255],COLOR_INVERTED:!1},s2=3,oCe={rotateEnabled:!0,boxRotationEnabled:!1,group:[],wireframeStyle:{thickness:1,color:0},elementMinWidth:1},Og=1,rw=5,sw=100,y3=2,aCe=3,A3="HELLO",Ya={fontSize:72,fontFamily:"Lato",fontSubfamily:"Regular",fontSource:"build-in",letterSpacing:0,leading:0,align:"center",curveX:56,curveY:0},zS=10,lCe={objs:"all",getDataOptions:{fractionPrecision:6,fillStrokeExportMode:"as-stroke",textExportMode:"path"},sortByZOrder:!0};function cCe(n){var e=this.constructor;return this.then(function(t){return e.resolve(n()).then(function(){return t})},function(t){return e.resolve(n()).then(function(){return e.reject(t)})})}function uCe(n){var e=this;return new e(function(t,i){if(!(n&&typeof n.length<"u"))return i(new TypeError(typeof n+" "+n+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(n);if(r.length===0)return t([]);var s=r.length;function o(l,c){if(c&&(typeof c=="object"||typeof c=="function")){var u=c.then;if(typeof u=="function"){u.call(c,function(h){o(l,h)},function(h){r[l]={status:"rejected",reason:h},--s===0&&t(r)});return}}r[l]={status:"fulfilled",value:c},--s===0&&t(r)}for(var a=0;a<r.length;a++)o(a,r[a])})}function YX(n,e){this.name="AggregateError",this.errors=n,this.message=e||""}YX.prototype=Error.prototype;function hCe(n){var e=this;return new e(function(t,i){if(!(n&&typeof n.length<"u"))return i(new TypeError("Promise.any accepts an array"));var r=Array.prototype.slice.call(n);if(r.length===0)return i();for(var s=[],o=0;o<r.length;o++)try{e.resolve(r[o]).then(t).catch(function(a){s.push(a),s.length===r.length&&i(new YX(s,"All promises were rejected"))})}catch(a){i(a)}})}var dCe=setTimeout;function qX(n){return!!(n&&typeof n.length<"u")}function fCe(){}function pCe(n,e){return function(){n.apply(e,arguments)}}function hr(n){if(!(this instanceof hr))throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],JX(n,this)}function KX(n,e){for(;n._state===3;)n=n._value;if(n._state===0){n._deferreds.push(e);return}n._handled=!0,hr._immediateFn(function(){var t=n._state===1?e.onFulfilled:e.onRejected;if(t===null){(n._state===1?yR:AA)(e.promise,n._value);return}var i;try{i=t(n._value)}catch(r){AA(e.promise,r);return}yR(e.promise,i)})}function yR(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&(typeof e=="object"||typeof e=="function")){var t=e.then;if(e instanceof hr){n._state=3,n._value=e,AR(n);return}else if(typeof t=="function"){JX(pCe(t,e),n);return}}n._state=1,n._value=e,AR(n)}catch(i){AA(n,i)}}function AA(n,e){n._state=2,n._value=e,AR(n)}function AR(n){n._state===2&&n._deferreds.length===0&&hr._immediateFn(function(){n._handled||hr._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)KX(n,n._deferreds[e]);n._deferreds=null}function gCe(n,e,t){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof e=="function"?e:null,this.promise=t}function JX(n,e){var t=!1;try{n(function(i){t||(t=!0,yR(e,i))},function(i){t||(t=!0,AA(e,i))})}catch(i){if(t)return;t=!0,AA(e,i)}}hr.prototype.catch=function(n){return this.then(null,n)};hr.prototype.then=function(n,e){var t=new this.constructor(fCe);return KX(this,new gCe(n,e,t)),t};hr.prototype.finally=cCe;hr.all=function(n){return new hr(function(e,t){if(!qX(n))return t(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(n);if(i.length===0)return e([]);var r=i.length;function s(a,l){try{if(l&&(typeof l=="object"||typeof l=="function")){var c=l.then;if(typeof c=="function"){c.call(l,function(u){s(a,u)},t);return}}i[a]=l,--r===0&&e(i)}catch(u){t(u)}}for(var o=0;o<i.length;o++)s(o,i[o])})};hr.any=hCe;hr.allSettled=uCe;hr.resolve=function(n){return n&&typeof n=="object"&&n.constructor===hr?n:new hr(function(e){e(n)})};hr.reject=function(n){return new hr(function(e,t){t(n)})};hr.race=function(n){return new hr(function(e,t){if(!qX(n))return t(new TypeError("Promise.race accepts an array"));for(var i=0,r=n.length;i<r;i++)hr.resolve(n[i]).then(e,t)})};hr._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){dCe(n,0)};hr._unhandledRejectionFn=function(e){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var b3=Object.getOwnPropertySymbols,mCe=Object.prototype.hasOwnProperty,vCe=Object.prototype.propertyIsEnumerable;function _Ce(n){if(n==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}function yCe(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de",Object.getOwnPropertyNames(n)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var i=Object.getOwnPropertyNames(e).map(function(s){return e[s]});if(i.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var ACe=yCe()?Object.assign:function(n,e){for(var t,i=_Ce(n),r,s=1;s<arguments.length;s++){t=Object(arguments[s]);for(var o in t)mCe.call(t,o)&&(i[o]=t[o]);if(b3){r=b3(t);for(var a=0;a<r.length;a++)vCe.call(t,r[a])&&(i[r[a]]=t[r[a]])}}return i};const bCe=Ld(ACe);/*!
 * @pixi/polyfill - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */typeof globalThis>"u"&&(typeof self<"u"?self.globalThis=self:typeof global<"u"&&(global.globalThis=global));globalThis.Promise||(globalThis.Promise=hr);Object.assign||(Object.assign=bCe);var wCe=16;Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()});if(!(globalThis.performance&&globalThis.performance.now)){var xCe=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-xCe}}var $S=Date.now(),w3=["ms","moz","webkit","o"];for(var WS=0;WS<w3.length&&!globalThis.requestAnimationFrame;++WS){var jS=w3[WS];globalThis.requestAnimationFrame=globalThis[jS+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[jS+"CancelAnimationFrame"]||globalThis[jS+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(n){if(typeof n!="function")throw new TypeError(n+"is not a function");var e=Date.now(),t=wCe+$S-e;return t<0&&(t=0),$S=e,globalThis.self.setTimeout(function(){$S=Date.now(),n(performance.now())},t)});globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(n){return clearTimeout(n)});Math.sign||(Math.sign=function(e){return e=Number(e),e===0||isNaN(e)?e:e>0?1:-1});Number.isInteger||(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e});globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array);globalThis.Float32Array||(globalThis.Float32Array=Array);globalThis.Uint32Array||(globalThis.Uint32Array=Array);globalThis.Uint16Array||(globalThis.Uint16Array=Array);globalThis.Uint8Array||(globalThis.Uint8Array=Array);globalThis.Int32Array||(globalThis.Int32Array=Array);/*!
 * @pixi/accessibility - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ZX={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};rn.mixin(ZX);var CCe=9,ow=100,ECe=0,TCe=0,x3=2,C3=1,ICe=-1e3,SCe=-1e3,PCe=2,eY=function(){function n(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Qa.tablet||Qa.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width=ow+"px",t.style.height=ow+"px",t.style.position="absolute",t.style.top=ECe+"px",t.style.left=TCe+"px",t.style.zIndex=x3.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(n.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),n.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width=C3+"px",t.style.height=C3+"px",t.style.position="absolute",t.style.top=ICe+"px",t.style.left=SCe+"px",t.style.zIndex=PCe.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t},n.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},n.prototype.activate=function(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)===null||e===void 0||e.appendChild(this.div))},n.prototype.deactivate=function(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)===null||e===void 0||e.removeChild(this.div))},n.prototype.updateAccessibleObjects=function(e){if(!(!e.visible||!e.accessibleChildren)){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);var t=e.children;if(t)for(var i=0;i<t.length;i++)this.updateAccessibleObjects(t[i])}},n.prototype.update=function(){var e=performance.now();if(!(Qa.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,!!this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),i=t.left,r=t.top,s=t.width,o=t.height,a=this.renderer,l=a.width,c=a.height,u=a.resolution,h=s/l*u,d=o/c*u,f=this.div;f.style.left=i+"px",f.style.top=r+"px",f.style.width=l+"px",f.style.height=c+"px";for(var p=0;p<this.children.length;p++){var g=this.children[p];if(g.renderId!==this.renderId)g._accessibleActive=!1,fp(this.children,p,1),this.div.removeChild(g._accessibleDiv),this.pool.push(g._accessibleDiv),g._accessibleDiv=null,p--;else{f=g._accessibleDiv;var m=g.hitArea,v=g.worldTransform;g.hitArea?(f.style.left=(v.tx+m.x*v.a)*h+"px",f.style.top=(v.ty+m.y*v.d)*d+"px",f.style.width=m.width*v.a*h+"px",f.style.height=m.height*v.d*d+"px"):(m=g.getBounds(),this.capHitArea(m),f.style.left=m.x*h+"px",f.style.top=m.y*d+"px",f.style.width=m.width*h+"px",f.style.height=m.height*d+"px",f.title!==g.accessibleTitle&&g.accessibleTitle!==null&&(f.title=g.accessibleTitle),f.getAttribute("aria-label")!==g.accessibleHint&&g.accessibleHint!==null&&f.setAttribute("aria-label",g.accessibleHint)),(g.accessibleTitle!==f.title||g.tabIndex!==f.tabIndex)&&(f.title=g.accessibleTitle,f.tabIndex=g.tabIndex,this.debug&&this.updateDebugHTML(f))}}this.renderId++}},n.prototype.updateDebugHTML=function(e){e.innerHTML="type: "+e.type+"</br> title : "+e.title+"</br> tabIndex: "+e.tabIndex},n.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);var t=this.renderer,i=t.width,r=t.height;e.x+e.width>i&&(e.width=i-e.x),e.y+e.height>r&&(e.height=r-e.y)},n.prototype.addChild=function(e){var t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=ow+"px",t.style.height=ow+"px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=x3.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title="displayObject "+e.tabIndex),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},n.prototype._onClick=function(e){var t=this.renderer.plugins.interaction,i=e.target.displayObject,r=t.eventData;t.dispatchEvent(i,"click",r),t.dispatchEvent(i,"pointertap",r),t.dispatchEvent(i,"tap",r)},n.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var t=this.renderer.plugins.interaction,i=e.target.displayObject,r=t.eventData;t.dispatchEvent(i,"mouseover",r)},n.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var t=this.renderer.plugins.interaction,i=e.target.displayObject,r=t.eventData;t.dispatchEvent(i,"mouseout",r)},n.prototype._onKeyDown=function(e){e.keyCode===CCe&&this.activate()},n.prototype._onMouseMove=function(e){e.movementX===0&&e.movementY===0||this.deactivate()},n.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},n.extension={name:"accessibility",type:[ai.RendererPlugin,ai.CanvasRendererPlugin]},n}();/*!
 * @pixi/extract - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var E3=new Pt,T3=4,tY=function(){function n(e){this.renderer=e}return n.prototype.image=function(e,t,i){var r=new Image;return r.src=this.base64(e,t,i),r},n.prototype.base64=function(e,t,i){return this.canvas(e).toDataURL(t,i)},n.prototype.canvas=function(e,t){var i=this.renderer,r,s=!1,o,a=!1;e&&(e instanceof va?o=e:(o=this.renderer.generateTexture(e),a=!0)),o?(r=o.baseTexture.resolution,t=t??o.frame,s=!1,i.renderTexture.bind(o)):(r=i.resolution,t||(t=E3,t.width=i.width,t.height=i.height),s=!0,i.renderTexture.bind(null));var l=Math.round(t.width*r),c=Math.round(t.height*r),u=new nR(l,c,1),h=new Uint8Array(T3*l*c),d=i.gl;d.readPixels(Math.round(t.x*r),Math.round(t.y*r),l,c,d.RGBA,d.UNSIGNED_BYTE,h);var f=u.context.getImageData(0,0,l,c);if(n.arrayPostDivide(h,f.data),u.context.putImageData(f,0,0),s){var p=new nR(u.width,u.height,1);p.context.scale(1,-1),p.context.drawImage(u.canvas,0,-c),u.destroy(),u=p}return a&&o.destroy(!0),u.canvas},n.prototype.pixels=function(e,t){var i=this.renderer,r,s,o=!1;e&&(e instanceof va?s=e:(s=this.renderer.generateTexture(e),o=!0)),s?(r=s.baseTexture.resolution,t=t??s.frame,i.renderTexture.bind(s)):(r=i.resolution,t||(t=E3,t.width=i.width,t.height=i.height),i.renderTexture.bind(null));var a=Math.round(t.width*r),l=Math.round(t.height*r),c=new Uint8Array(T3*a*l),u=i.gl;return u.readPixels(Math.round(t.x*r),Math.round(t.y*r),a,l,u.RGBA,u.UNSIGNED_BYTE,c),o&&s.destroy(!0),n.arrayPostDivide(c,c),c},n.prototype.destroy=function(){this.renderer=null},n.arrayPostDivide=function(e,t){for(var i=0;i<e.length;i+=4){var r=t[i+3]=e[i+3];r!==0?(t[i]=Math.round(Math.min(e[i]*255/r,255)),t[i+1]=Math.round(Math.min(e[i+1]*255/r,255)),t[i+2]=Math.round(Math.min(e[i+2]*255/r,255))):(t[i]=e[i],t[i+1]=e[i+1],t[i+2]=e[i+2])}},n.extension={name:"extract",type:ai.RendererPlugin},n}();/*!
 * @pixi/loaders - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aw=function(){function n(e,t,i){t===void 0&&(t=!1),this._fn=e,this._once=t,this._thisArg=i,this._next=this._prev=this._owner=null}return n.prototype.detach=function(){return this._owner===null?!1:(this._owner.detach(this),!0)},n}();function I3(n,e){return n._head?(n._tail._next=e,e._prev=n._tail,n._tail=e):(n._head=e,n._tail=e),e._owner=n,e}var Nu=function(){function n(){this._head=this._tail=void 0}return n.prototype.handlers=function(e){e===void 0&&(e=!1);var t=this._head;if(e)return!!t;for(var i=[];t;)i.push(t),t=t._next;return i},n.prototype.has=function(e){if(!(e instanceof aw))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return e._owner===this},n.prototype.dispatch=function(){for(var e=arguments,t=[],i=0;i<arguments.length;i++)t[i]=e[i];var r=this._head;if(!r)return!1;for(;r;)r._once&&this.detach(r),r._fn.apply(r._thisArg,t),r=r._next;return!0},n.prototype.add=function(e,t){if(t===void 0&&(t=null),typeof e!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return I3(this,new aw(e,!1,t))},n.prototype.once=function(e,t){if(t===void 0&&(t=null),typeof e!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return I3(this,new aw(e,!0,t))},n.prototype.detach=function(e){if(!(e instanceof aw))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return e._owner!==this?this:(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,e._next===null&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null,this)},n.prototype.detachAll=function(){var e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this},n}();function nY(n,e){e=e||{};for(var t={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=t.parser[e.strictMode?"strict":"loose"].exec(n),r={},s=14;s--;)r[t.key[s]]=i[s]||"";return r[t.q.name]={},r[t.key[12]].replace(t.q.parser,function(o,a,l){a&&(r[t.q.name][a]=l)}),r}var QS,lw=null,MCe=0,S3=200,RCe=204,DCe=1223,kCe=2;function P3(){}function M3(n,e,t){e&&e.indexOf(".")===0&&(e=e.substring(1)),e&&(n[e]=t)}function XS(n){return n.toString().replace("object ","")}var lr=function(){function n(e,t,i){if(this._dequeue=P3,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof e!="string"||typeof t!="string")throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(n.STATUS_FLAGS.DATA_URL,t.indexOf("data:")===0),this.name=e,this.url=t,this.extension=this._getExtension(),this.data=null,this.crossOrigin=i.crossOrigin===!0?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=n.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=P3,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Nu,this.onProgress=new Nu,this.onComplete=new Nu,this.onAfterMiddleware=new Nu}return n.setExtensionLoadType=function(e,t){M3(n._loadTypeMap,e,t)},n.setExtensionXhrType=function(e,t){M3(n._xhrTypeMap,e,t)},Object.defineProperty(n.prototype,"isDataUrl",{get:function(){return this._hasFlag(n.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isComplete",{get:function(){return this._hasFlag(n.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLoading",{get:function(){return this._hasFlag(n.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),n.prototype.complete=function(){this._clearEvents(),this._finish()},n.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=n.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},n.prototype.load=function(e){var t=this;if(!this.isLoading){if(this.isComplete){e&&setTimeout(function(){return e(t)},1);return}else e&&this.onComplete.once(e);switch(this._setFlag(n.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!="string")&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case n.LOAD_TYPE.IMAGE:this.type=n.TYPE.IMAGE,this._loadElement("image");break;case n.LOAD_TYPE.AUDIO:this.type=n.TYPE.AUDIO,this._loadSourceElement("audio");break;case n.LOAD_TYPE.VIDEO:this.type=n.TYPE.VIDEO,this._loadSourceElement("video");break;case n.LOAD_TYPE.XHR:default:typeof QS>"u"&&(QS=!!(globalThis.XDomainRequest&&!("withCredentials"in new XMLHttpRequest))),QS&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},n.prototype._hasFlag=function(e){return(this._flags&e)!==0},n.prototype._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},n.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},n.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(n.STATUS_FLAGS.COMPLETE,!0),this._setFlag(n.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},n.prototype._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:e==="image"&&typeof globalThis.Image<"u"?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},n.prototype._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:e==="audio"&&typeof globalThis.Audio<"u"?this.data=new Audio:this.data=document.createElement(e),this.data===null){this.abort("Unsupported element: "+e);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(e,this.url[i],Array.isArray(t)?t[i]:t));else{var t=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(t)?t[0]:t))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},n.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;this.crossOrigin==="use-credentials"&&(e.withCredentials=!0),e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===n.XHR_RESPONSE_TYPE.JSON||this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=n.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},n.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new globalThis.XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout(function(){return e.send()},1)},n.prototype._createSource=function(e,t,i){i||(i=e+"/"+this._getExtension(t));var r=document.createElement("source");return r.src=t,r.type=i,r},n.prototype._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},n.prototype._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},n.prototype._onTimeout=function(){this.abort("Load timed out.")},n.prototype._xhrOnError=function(){var e=this.xhr;this.abort(XS(e)+" Request failed. Status: "+e.status+', text: "'+e.statusText+'"')},n.prototype._xhrOnTimeout=function(){var e=this.xhr;this.abort(XS(e)+" Request timed out.")},n.prototype._xhrOnAbort=function(){var e=this.xhr;this.abort(XS(e)+" Request was aborted by the user.")},n.prototype._xhrOnLoad=function(){var e=this.xhr,t="",i=typeof e.status>"u"?S3:e.status;(e.responseType===""||e.responseType==="text"||typeof e.responseType>"u")&&(t=e.responseText),i===MCe&&(t.length>0||e.responseType===n.XHR_RESPONSE_TYPE.BUFFER)?i=S3:i===DCe&&(i=RCe);var r=i/100|0;if(r===kCe)if(this.xhrType===n.XHR_RESPONSE_TYPE.TEXT)this.data=t,this.type=n.TYPE.TEXT;else if(this.xhrType===n.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(t),this.type=n.TYPE.JSON}catch(a){this.abort("Error trying to parse loaded json: "+a);return}else if(this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var s=new DOMParser;this.data=s.parseFromString(t,"text/xml")}else{var o=document.createElement("div");o.innerHTML=t,this.data=o}this.type=n.TYPE.XML}catch(a){this.abort("Error trying to parse loaded xml: "+a);return}else this.data=e.response||t;else{this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL);return}this.complete()},n.prototype._determineCrossOrigin=function(e,t){if(e.indexOf("data:")===0)return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";t=t||globalThis.location,lw||(lw=document.createElement("a")),lw.href=e;var i=nY(lw.href,{strictMode:!0}),r=!i.port&&t.port===""||i.port===t.port,s=i.protocol?i.protocol+":":"";return i.host!==t.hostname||!r||s!==t.protocol?"anonymous":""},n.prototype._determineXhrType=function(){return n._xhrTypeMap[this.extension]||n.XHR_RESPONSE_TYPE.TEXT},n.prototype._determineLoadType=function(){return n._loadTypeMap[this.extension]||n.LOAD_TYPE.XHR},n.prototype._getExtension=function(e){e===void 0&&(e=this.url);var t="";if(this.isDataUrl){var i=e.indexOf("/");t=e.substring(i+1,e.indexOf(";",i))}else{var r=e.indexOf("?"),s=e.indexOf("#"),o=Math.min(r>-1?r:e.length,s>-1?s:e.length);e=e.substring(0,o),t=e.substring(e.lastIndexOf(".")+1)}return t.toLowerCase()},n.prototype._getMimeFromXhrType=function(e){switch(e){case n.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case n.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case n.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case n.XHR_RESPONSE_TYPE.JSON:return"application/json";case n.XHR_RESPONSE_TYPE.DEFAULT:case n.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},n}();(function(n){(function(e){e[e.NONE=0]="NONE",e[e.DATA_URL=1]="DATA_URL",e[e.COMPLETE=2]="COMPLETE",e[e.LOADING=4]="LOADING"})(n.STATUS_FLAGS||(n.STATUS_FLAGS={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JSON=1]="JSON",e[e.XML=2]="XML",e[e.IMAGE=3]="IMAGE",e[e.AUDIO=4]="AUDIO",e[e.VIDEO=5]="VIDEO",e[e.TEXT=6]="TEXT"}(n.TYPE||(n.TYPE={})),function(e){e[e.XHR=1]="XHR",e[e.IMAGE=2]="IMAGE",e[e.AUDIO=3]="AUDIO",e[e.VIDEO=4]="VIDEO"}(n.LOAD_TYPE||(n.LOAD_TYPE={})),function(e){e.DEFAULT="text",e.BUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.TEXT="text"}(n.XHR_RESPONSE_TYPE||(n.XHR_RESPONSE_TYPE={})),n._loadTypeMap={gif:n.LOAD_TYPE.IMAGE,png:n.LOAD_TYPE.IMAGE,bmp:n.LOAD_TYPE.IMAGE,jpg:n.LOAD_TYPE.IMAGE,jpeg:n.LOAD_TYPE.IMAGE,tif:n.LOAD_TYPE.IMAGE,tiff:n.LOAD_TYPE.IMAGE,webp:n.LOAD_TYPE.IMAGE,tga:n.LOAD_TYPE.IMAGE,svg:n.LOAD_TYPE.IMAGE,"svg+xml":n.LOAD_TYPE.IMAGE,mp3:n.LOAD_TYPE.AUDIO,ogg:n.LOAD_TYPE.AUDIO,wav:n.LOAD_TYPE.AUDIO,mp4:n.LOAD_TYPE.VIDEO,webm:n.LOAD_TYPE.VIDEO},n._xhrTypeMap={xhtml:n.XHR_RESPONSE_TYPE.DOCUMENT,html:n.XHR_RESPONSE_TYPE.DOCUMENT,htm:n.XHR_RESPONSE_TYPE.DOCUMENT,xml:n.XHR_RESPONSE_TYPE.DOCUMENT,tmx:n.XHR_RESPONSE_TYPE.DOCUMENT,svg:n.XHR_RESPONSE_TYPE.DOCUMENT,tsx:n.XHR_RESPONSE_TYPE.DOCUMENT,gif:n.XHR_RESPONSE_TYPE.BLOB,png:n.XHR_RESPONSE_TYPE.BLOB,bmp:n.XHR_RESPONSE_TYPE.BLOB,jpg:n.XHR_RESPONSE_TYPE.BLOB,jpeg:n.XHR_RESPONSE_TYPE.BLOB,tif:n.XHR_RESPONSE_TYPE.BLOB,tiff:n.XHR_RESPONSE_TYPE.BLOB,webp:n.XHR_RESPONSE_TYPE.BLOB,tga:n.XHR_RESPONSE_TYPE.BLOB,json:n.XHR_RESPONSE_TYPE.JSON,text:n.XHR_RESPONSE_TYPE.TEXT,txt:n.XHR_RESPONSE_TYPE.TEXT,ttf:n.XHR_RESPONSE_TYPE.BUFFER,otf:n.XHR_RESPONSE_TYPE.BUFFER},n.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(lr||(lr={}));function Qd(){}function OCe(n){return function(){for(var t=arguments,i=[],r=0;r<arguments.length;r++)i[r]=t[r];if(n===null)throw new Error("Callback was already called.");var s=n;n=null,s.apply(this,i)}}var LCe=function(){function n(e,t){this.data=e,this.callback=t}return n}(),YS=function(){function n(e,t){var i=this;if(t===void 0&&(t=1),this.workers=0,this.saturated=Qd,this.unsaturated=Qd,this.empty=Qd,this.drain=Qd,this.error=Qd,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(r,s,o){if(o&&typeof o!="function")throw new Error("task callback must be a function");if(i.started=!0,r==null&&i.idle()){setTimeout(function(){return i.drain()},1);return}var a=new LCe(r,typeof o=="function"?o:Qd);s?i._tasks.unshift(a):i._tasks.push(a),setTimeout(i.process,1)},this.process=function(){for(;!i.paused&&i.workers<i.concurrency&&i._tasks.length;){var r=i._tasks.shift();i._tasks.length===0&&i.empty(),i.workers+=1,i.workers===i.concurrency&&i.saturated(),i._worker(r.data,OCe(i._next(r)))}},this._worker=e,t===0)throw new Error("Concurrency must not be zero");this.concurrency=t,this.buffer=t/4}return n.prototype._next=function(e){var t=this;return function(){for(var i=arguments,r=[],s=0;s<arguments.length;s++)r[s]=i[s];t.workers-=1,e.callback.apply(e,r),r[0]!=null&&t.error(r[0],e.data),t.workers<=t.concurrency-t.buffer&&t.unsaturated(),t.idle()&&t.drain(),t.process()}},n.prototype.push=function(e,t){this._insert(e,!1,t)},n.prototype.kill=function(){this.workers=0,this.drain=Qd,this.started=!1,this._tasks=[]},n.prototype.unshift=function(e,t){this._insert(e,!0,t)},n.prototype.length=function(){return this._tasks.length},n.prototype.running=function(){return this.workers},n.prototype.idle=function(){return this._tasks.length+this.workers===0},n.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},n.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var e=1;e<=this.concurrency;e++)this.process()}},n.eachSeries=function(e,t,i,r){var s=0,o=e.length;function a(l){if(l||s===o){i&&i(l);return}r?setTimeout(function(){t(e[s++],a)},1):t(e[s++],a)}a()},n.queue=function(e,t){return new n(e,t)},n}(),qS=100,NCe=/(#[\w-]+)?$/,bA=function(){function n(e,t){var i=this;e===void 0&&(e=""),t===void 0&&(t=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,c){return i._loadResource(l,c)},this.resources={},this.baseUrl=e,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,c){return i._loadResource(l,c)},this._queue=YS.queue(this._boundLoadResource,t),this._queue.pause(),this.resources={},this.onProgress=new Nu,this.onError=new Nu,this.onLoad=new Nu,this.onStart=new Nu,this.onComplete=new Nu;for(var r=0;r<n._plugins.length;++r){var s=n._plugins[r],o=s.pre,a=s.use;o&&this.pre(o),a&&this.use(a)}this._protected=!1}return n.prototype._add=function(e,t,i,r){if(this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(t=this._prepareUrl(t),this.resources[e]=new lr(e,t,i),typeof r=="function"&&this.resources[e].onAfterMiddleware.once(r),this.loading){for(var s=i.parentResource,o=[],a=0;a<s.children.length;++a)s.children[a].isComplete||o.push(s.children[a]);var l=s.progressChunk*(o.length+1),c=l/(o.length+2);s.children.push(this.resources[e]),s.progressChunk=c;for(var a=0;a<o.length;++a)o[a].progressChunk=c;this.resources[e].progressChunk=c}return this._queue.push(this.resources[e]),this},n.prototype.pre=function(e){return this._beforeMiddleware.push(e),this},n.prototype.use=function(e){return this._afterMiddleware.push(e),this},n.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var e in this.resources){var t=this.resources[e];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort("loader reset")}return this.resources={},this},n.prototype.load=function(e){if(Go("6.5.0","@pixi/loaders is being replaced with @pixi/assets in the next major release."),typeof e=="function"&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var t=this._queue._tasks.length,i=qS/t,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=i;this._onStart(),this._queue.resume()}return this},Object.defineProperty(n.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e},enumerable:!1,configurable:!0}),n.prototype._prepareUrl=function(e){var t=nY(e,{strictMode:!0}),i;if(t.protocol||!t.path||e.indexOf("//")===0?i=e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&e.charAt(0)!=="/"?i=this.baseUrl+"/"+e:i=this.baseUrl+e,this.defaultQueryString){var r=NCe.exec(i)[0];i=i.slice(0,i.length-r.length),i.indexOf("?")!==-1?i+="&"+this.defaultQueryString:i+="?"+this.defaultQueryString,i+=r}return i},n.prototype._loadResource=function(e,t){var i=this;e._dequeue=t,YS.eachSeries(this._beforeMiddleware,function(r,s){r.call(i,e,function(){s(e.isComplete?{}:null)})},function(){e.isComplete?i._onLoad(e):(e._onLoadBinding=e.onComplete.once(i._onLoad,i),e.load())},!0)},n.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},n.prototype._onComplete=function(){this.progress=qS,this.loading=!1,this.onComplete.dispatch(this,this.resources)},n.prototype._onLoad=function(e){var t=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),YS.eachSeries(this._afterMiddleware,function(i,r){i.call(t,e,r)},function(){e.onAfterMiddleware.dispatch(e),t.progress=Math.min(qS,t.progress+e.progressChunk),t.onProgress.dispatch(t,e),e.error?t.onError.dispatch(e.error,t,e):t.onLoad.dispatch(t,e),t._resourcesParsing.splice(t._resourcesParsing.indexOf(e),1),t._queue.idle()&&t._resourcesParsing.length===0&&t._onComplete()},!0)},n.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(n,"shared",{get:function(){var e=n._shared;return e||(e=new n,e._protected=!0,n._shared=e),e},enumerable:!1,configurable:!0}),n.registerPlugin=function(e){return Go("6.5.0","Loader.registerPlugin() is deprecated, use extensions.add() instead."),rc.add({type:ai.Loader,ref:e}),n},n._plugins=[],n}();rc.handleByList(ai.Loader,bA._plugins);bA.prototype.add=function(e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;++s)this.add(e[s]);return this}if(typeof e=="object"&&(i=e,r=t||i.callback||i.onComplete,t=i.url,e=i.name||i.key||i.url),typeof t!="string"&&(r=i,i=t,t=e),typeof t!="string")throw new Error("No url passed to add resource to loader.");return typeof i=="function"&&(r=i,i=null),this._add(e,t,i,r)};var iY=function(){function n(){}return n.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?bA.shared:new bA},n.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},n.extension=ai.Application,n}(),rY=function(){function n(){}return n.add=function(){lr.setExtensionLoadType("svg",lr.LOAD_TYPE.XHR),lr.setExtensionXhrType("svg",lr.XHR_RESPONSE_TYPE.TEXT)},n.use=function(e,t){if(e.data&&(e.type===lr.TYPE.IMAGE||e.extension==="svg")){var i=e.data,r=e.url,s=e.name,o=e.metadata;Wt.fromLoader(i,r,s,o).then(function(a){e.texture=a,t()}).catch(t)}else t()},n.extension=ai.Loader,n}(),BCe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function FCe(n){for(var e="",t=0;t<n.length;){for(var i=[0,0,0],r=[0,0,0,0],s=0;s<i.length;++s)t<n.length?i[s]=n.charCodeAt(t++)&255:i[s]=0;r[0]=i[0]>>2,r[1]=(i[0]&3)<<4|i[1]>>4,r[2]=(i[1]&15)<<2|i[2]>>6,r[3]=i[2]&63;var o=t-(n.length-1);switch(o){case 2:r[3]=64,r[2]=64;break;case 1:r[3]=64;break}for(var s=0;s<r.length;++s)e+=BCe.charAt(r[s])}return e}function UCe(n,e){if(!n.data){e();return}if(n.xhr&&n.xhrType===lr.XHR_RESPONSE_TYPE.BLOB){if(!self.Blob||typeof n.data=="string"){var t=n.xhr.getResponseHeader("content-type");if(t&&t.indexOf("image")===0){n.data=new Image,n.data.src="data:"+t+";base64,"+FCe(n.xhr.responseText),n.type=lr.TYPE.IMAGE,n.data.onload=function(){n.data.onload=null,e()};return}}else if(n.data.type.indexOf("image")===0){var i=globalThis.URL||globalThis.webkitURL,r=i.createObjectURL(n.data);n.blob=n.data,n.data=new Image,n.data.src=r,n.type=lr.TYPE.IMAGE,n.data.onload=function(){i.revokeObjectURL(r),n.data.onload=null,e()};return}}e()}var GCe=function(){function n(){}return n.extension=ai.Loader,n.use=UCe,n}();rc.add(rY,GCe);/*!
 * @pixi/compressed-textures - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/compressed-textures is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var vi,En;(function(n){n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"})(En||(En={}));var wA=(vi={},vi[En.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,vi[En.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,vi[En.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,vi[En.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,vi[En.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,vi[En.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,vi[En.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,vi[En.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,vi[En.COMPRESSED_R11_EAC]=.5,vi[En.COMPRESSED_SIGNED_R11_EAC]=.5,vi[En.COMPRESSED_RG11_EAC]=1,vi[En.COMPRESSED_SIGNED_RG11_EAC]=1,vi[En.COMPRESSED_RGB8_ETC2]=.5,vi[En.COMPRESSED_RGBA8_ETC2_EAC]=1,vi[En.COMPRESSED_SRGB8_ETC2]=.5,vi[En.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,vi[En.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,vi[En.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,vi[En.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,vi[En.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,vi[En.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,vi[En.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,vi[En.COMPRESSED_RGB_ETC1_WEBGL]=.5,vi[En.COMPRESSED_RGB_ATC_WEBGL]=.5,vi[En.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,vi[En.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,vi);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bR=function(n,e){return bR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},bR(n,e)};function sY(n,e){bR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function HCe(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function VCe(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(s=c[0]&2?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,r=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],r=0}finally{i=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var oY=function(n){sY(e,n);function e(t,i){i===void 0&&(i={width:1,height:1,autoLoad:!0});var r=this,s,o;return typeof t=="string"?(s=t,o=new Uint8Array):(s=null,o=t),r=n.call(this,o,i)||this,r.origin=s,r.buffer=o?new SC(o):null,r.origin&&i.autoLoad!==!1&&r.load(),o&&o.length&&(r.loaded=!0,r.onBlobLoaded(r.buffer.rawBinaryData)),r}return e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return HCe(this,void 0,Promise,function(){var t,i,r;return VCe(this,function(s){switch(s.label){case 0:return[4,fetch(this.origin)];case 1:return t=s.sent(),[4,t.blob()];case 2:return i=s.sent(),[4,i.arrayBuffer()];case 3:return r=s.sent(),this.data=new Uint32Array(r),this.buffer=new SC(r),this.loaded=!0,this.onBlobLoaded(r),this.update(),[2,this]}})})},e}(dg),LC=function(n){sY(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.format=i.format,r.levels=i.levels||1,r._width=i.width,r._height=i.height,r._extension=e._formatToExtension(r.format),(i.levelBuffers||r.buffer)&&(r._levelBuffers=i.levelBuffers||e._createLevelBuffers(t instanceof Uint8Array?t:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r}return e.prototype.upload=function(t,i,r){var s=t.gl,o=t.context.extensions[this._extension];if(!o)throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var a=0,l=this.levels;a<l;a++){var c=this._levelBuffers[a],u=c.levelID,h=c.levelWidth,d=c.levelHeight,f=c.levelBuffer;s.compressedTexImage2D(s.TEXTURE_2D,u,this.format,h,d,0,f)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,i,r,s,o,a,l){for(var c=new Array(r),u=t.byteOffset,h=a,d=l,f=h+s-1&~(s-1),p=d+o-1&~(o-1),g=f*p*wA[i],m=0;m<r;m++)c[m]={levelID:m,levelWidth:r>1?h:f,levelHeight:r>1?d:p,levelBuffer:new Uint8Array(t.buffer,u,g)},u+=g,h=h>>1||1,d=d>>1||1,f=h+s-1&~(s-1),p=d+o-1&~(o-1),g=f*p*wA[i];return c},e}(oY),aY=function(){function n(){}return n.use=function(e,t){var i=e.data,r=this;if(e.type===lr.TYPE.JSON&&i&&i.cacheID&&i.textures){for(var s=i.textures,o=void 0,a=void 0,l=0,c=s.length;l<c;l++){var u=s[l],h=u.src,d=u.format;if(d||(a=h),n.textureFormats[d]){o=h;break}}if(o=o||a,!o){t(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));return}if(o===e.url){t(new Error("URL of compressed texture cannot be the same as the manifest's URL"));return}var f={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},p=Rf.resolve(e.url.replace(r.baseUrl,""),o),g=i.cacheID;r.add(g,p,f,function(m){if(m.error){t(m.error);return}var v=m.texture,_=v===void 0?null:v,y=m.textures,A=y===void 0?{}:y;Object.assign(e,{texture:_,textures:A}),t()})}else t()},Object.defineProperty(n,"textureExtensions",{get:function(){if(!n._textureExtensions){var e=xt.ADAPTER.createCanvas(),t=e.getContext("webgl");if(!t)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var i={s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};n._textureExtensions=i}return n._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(n,"textureFormats",{get:function(){if(!n._textureFormats){var e=n.textureExtensions;n._textureFormats={};for(var t in e){var i=e[t];i&&Object.assign(n._textureFormats,Object.getPrototypeOf(i))}}return n._textureFormats},enumerable:!1,configurable:!0}),n.extension=ai.Loader,n}();function lY(n,e,t){var i={textures:{},texture:null};if(!e)return i;var r=e.map(function(s){return new Wt(new In(s,Object.assign({mipmap:sl.OFF,alphaMode:ol.NO_PREMULTIPLIED_ALPHA},t)))});return r.forEach(function(s,o){var a=s.baseTexture,l=n+"-"+(o+1);In.addToCache(a,l),Wt.addToCache(s,l),o===0&&(In.addToCache(a,n),Wt.addToCache(s,n),i.texture=s),i.textures[l]=s}),i}var N_,vl,KS=4,cw=124,zCe=32,R3=20,$Ce=542327876,uw={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},WCe={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},hw={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},Il;(function(n){n[n.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",n[n.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",n[n.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",n[n.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",n[n.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",n[n.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",n[n.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",n[n.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",n[n.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",n[n.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",n[n.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",n[n.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",n[n.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",n[n.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",n[n.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",n[n.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",n[n.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",n[n.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",n[n.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",n[n.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",n[n.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",n[n.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",n[n.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",n[n.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",n[n.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",n[n.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",n[n.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",n[n.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",n[n.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",n[n.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",n[n.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",n[n.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",n[n.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",n[n.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",n[n.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",n[n.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",n[n.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",n[n.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",n[n.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",n[n.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",n[n.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",n[n.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",n[n.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",n[n.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",n[n.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",n[n.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",n[n.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",n[n.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",n[n.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",n[n.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",n[n.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",n[n.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",n[n.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",n[n.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",n[n.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",n[n.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",n[n.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",n[n.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",n[n.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",n[n.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",n[n.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",n[n.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",n[n.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",n[n.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",n[n.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",n[n.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",n[n.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",n[n.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",n[n.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",n[n.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",n[n.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",n[n.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",n[n.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",n[n.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",n[n.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",n[n.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",n[n.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",n[n.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",n[n.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",n[n.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",n[n.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",n[n.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",n[n.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",n[n.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",n[n.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",n[n.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",n[n.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",n[n.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",n[n.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",n[n.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",n[n.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",n[n.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",n[n.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",n[n.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",n[n.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",n[n.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",n[n.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",n[n.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",n[n.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",n[n.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",n[n.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",n[n.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",n[n.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",n[n.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",n[n.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",n[n.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",n[n.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",n[n.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",n[n.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",n[n.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",n[n.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",n[n.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",n[n.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",n[n.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",n[n.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",n[n.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",n[n.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",n[n.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",n[n.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",n[n.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",n[n.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",n[n.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(Il||(Il={}));var wR;(function(n){n[n.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",n[n.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",n[n.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"})(wR||(wR={}));var jCe=1,QCe=2,XCe=4,YCe=64,qCe=512,KCe=131072,JCe=827611204,ZCe=861165636,eEe=894720068,tEe=808540228,nEe=4,iEe=(N_={},N_[JCe]=En.COMPRESSED_RGBA_S3TC_DXT1_EXT,N_[ZCe]=En.COMPRESSED_RGBA_S3TC_DXT3_EXT,N_[eEe]=En.COMPRESSED_RGBA_S3TC_DXT5_EXT,N_),rEe=(vl={},vl[Il.DXGI_FORMAT_BC1_TYPELESS]=En.COMPRESSED_RGBA_S3TC_DXT1_EXT,vl[Il.DXGI_FORMAT_BC1_UNORM]=En.COMPRESSED_RGBA_S3TC_DXT1_EXT,vl[Il.DXGI_FORMAT_BC2_TYPELESS]=En.COMPRESSED_RGBA_S3TC_DXT3_EXT,vl[Il.DXGI_FORMAT_BC2_UNORM]=En.COMPRESSED_RGBA_S3TC_DXT3_EXT,vl[Il.DXGI_FORMAT_BC3_TYPELESS]=En.COMPRESSED_RGBA_S3TC_DXT5_EXT,vl[Il.DXGI_FORMAT_BC3_UNORM]=En.COMPRESSED_RGBA_S3TC_DXT5_EXT,vl[Il.DXGI_FORMAT_BC1_UNORM_SRGB]=En.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,vl[Il.DXGI_FORMAT_BC2_UNORM_SRGB]=En.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,vl[Il.DXGI_FORMAT_BC3_UNORM_SRGB]=En.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,vl);function cY(n){var e=new Uint32Array(n),t=e[0];if(t!==$Ce)throw new Error("Invalid DDS file magic word");var i=new Uint32Array(n,0,cw/Uint32Array.BYTES_PER_ELEMENT),r=i[uw.HEIGHT],s=i[uw.WIDTH],o=i[uw.MIPMAP_COUNT],a=new Uint32Array(n,uw.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,zCe/Uint32Array.BYTES_PER_ELEMENT),l=a[jCe];if(l&XCe){var c=a[WCe.FOURCC];if(c!==tEe){var u=iEe[c],h=KS+cw,d=new Uint8Array(n,h),f=new LC(d,{format:u,width:s,height:r,levels:o});return[f]}var p=KS+cw,g=new Uint32Array(e.buffer,p,R3/Uint32Array.BYTES_PER_ELEMENT),m=g[hw.DXGI_FORMAT],v=g[hw.RESOURCE_DIMENSION],_=g[hw.MISC_FLAG],y=g[hw.ARRAY_SIZE],A=rEe[m];if(A===void 0)throw new Error("DDSParser cannot parse texture data with DXGI format "+m);if(_===nEe)throw new Error("DDSParser does not support cubemap textures");if(v===wR.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSParser does not supported 3D texture data");var w=new Array,b=KS+cw+R3;if(y===1)w.push(new Uint8Array(n,b));else{for(var C=wA[A],I=0,x=s,T=r,O=0;O<o;O++){var F=Math.max(1,x+3&-4),G=Math.max(1,T+3&-4),B=F*G*C;I+=B,x=x>>>1,T=T>>>1}for(var R=b,O=0;O<y;O++)w.push(new Uint8Array(n,R,I)),R+=I}return w.map(function(P){return new LC(P,{format:A,width:s,height:r,levels:o})})}throw l&YCe?new Error("DDSParser does not support uncompressed texture data."):l&qCe?new Error("DDSParser does not supported YUV uncompressed texture data."):l&KCe?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&QCe?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var wh,Zc,B_,D3=[171,75,84,88,32,49,49,187,13,10,26,10],sEe=67305985,_l={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},xR=64,CR=(wh={},wh[qt.UNSIGNED_BYTE]=1,wh[qt.UNSIGNED_SHORT]=2,wh[qt.INT]=4,wh[qt.UNSIGNED_INT]=4,wh[qt.FLOAT]=4,wh[qt.HALF_FLOAT]=8,wh),uY=(Zc={},Zc[At.RGBA]=4,Zc[At.RGB]=3,Zc[At.RG]=2,Zc[At.RED]=1,Zc[At.LUMINANCE]=1,Zc[At.LUMINANCE_ALPHA]=2,Zc[At.ALPHA]=1,Zc),hY=(B_={},B_[qt.UNSIGNED_SHORT_4_4_4_4]=2,B_[qt.UNSIGNED_SHORT_5_5_5_1]=2,B_[qt.UNSIGNED_SHORT_5_6_5]=2,B_);function dY(n,e,t){t===void 0&&(t=!1);var i=new DataView(e);if(!oEe(n,i))return null;var r=i.getUint32(_l.ENDIANNESS,!0)===sEe,s=i.getUint32(_l.GL_TYPE,r),o=i.getUint32(_l.GL_FORMAT,r),a=i.getUint32(_l.GL_INTERNAL_FORMAT,r),l=i.getUint32(_l.PIXEL_WIDTH,r),c=i.getUint32(_l.PIXEL_HEIGHT,r)||1,u=i.getUint32(_l.PIXEL_DEPTH,r)||1,h=i.getUint32(_l.NUMBER_OF_ARRAY_ELEMENTS,r)||1,d=i.getUint32(_l.NUMBER_OF_FACES,r),f=i.getUint32(_l.NUMBER_OF_MIPMAP_LEVELS,r),p=i.getUint32(_l.BYTES_OF_KEY_VALUE_DATA,r);if(c===0||u!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(h!==1)throw new Error("WebGL does not support array textures");var g=4,m=4,v=l+3&-4,_=c+3&-4,y=new Array(h),A=l*c;s===0&&(A=v*_);var w;if(s!==0?CR[s]?w=CR[s]*uY[o]:w=hY[s]:w=wA[a],w===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var b=t?lEe(i,p,r):null,C=A*w,I=C,x=l,T=c,O=v,F=_,G=xR+p,B=0;B<f;B++){for(var R=i.getUint32(G,r),P=G+4,k=0;k<h;k++){var L=y[k];L||(L=y[k]=new Array(f)),L[B]={levelID:B,levelWidth:f>1||s!==0?x:O,levelHeight:f>1||s!==0?T:F,levelBuffer:new Uint8Array(e,P,I)},P+=I}G+=R+4,G=G%4!==0?G+4-G%4:G,x=x>>1||1,T=T>>1||1,O=x+g-1&~(g-1),F=T+m-1&~(m-1),I=O*F*w}return s!==0?{uncompressed:y.map(function(H){var U=H[0].levelBuffer,$=!1;return s===qt.FLOAT?U=new Float32Array(H[0].levelBuffer.buffer,H[0].levelBuffer.byteOffset,H[0].levelBuffer.byteLength/4):s===qt.UNSIGNED_INT?($=!0,U=new Uint32Array(H[0].levelBuffer.buffer,H[0].levelBuffer.byteOffset,H[0].levelBuffer.byteLength/4)):s===qt.INT&&($=!0,U=new Int32Array(H[0].levelBuffer.buffer,H[0].levelBuffer.byteOffset,H[0].levelBuffer.byteLength/4)),{resource:new dg(U,{width:H[0].levelWidth,height:H[0].levelHeight}),type:s,format:$?aEe(o):o}}),kvData:b}:{compressed:y.map(function(H){return new LC(null,{format:a,width:l,height:c,levels:f,levelBuffers:H})}),kvData:b}}function oEe(n,e){for(var t=0;t<D3.length;t++)if(e.getUint8(t)!==D3[t])return console.error(n+" is not a valid *.ktx file!"),!1;return!0}function aEe(n){switch(n){case At.RGBA:return At.RGBA_INTEGER;case At.RGB:return At.RGB_INTEGER;case At.RG:return At.RG_INTEGER;case At.RED:return At.RED_INTEGER;default:return n}}function lEe(n,e,t){for(var i=new Map,r=0;r<e;){var s=n.getUint32(xR+r,t),o=xR+r+4,a=3-(s+3)%4;if(s===0||s>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var l=0;l<s&&n.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var c=new TextDecoder().decode(new Uint8Array(n.buffer,o,l)),u=new DataView(n.buffer,o+l+1,s-l-1);i.set(c,u),r+=4+s+a}return i}lr.setExtensionXhrType("dds",lr.XHR_RESPONSE_TYPE.BUFFER);var fY=function(){function n(){}return n.use=function(e,t){if(e.extension==="dds"&&e.data)try{Object.assign(e,lY(e.name||e.url,cY(e.data),e.metadata))}catch(i){t(i);return}t()},n.extension=ai.Loader,n}();lr.setExtensionXhrType("ktx",lr.XHR_RESPONSE_TYPE.BUFFER);var pY=function(){function n(){}return n.use=function(e,t){if(e.extension==="ktx"&&e.data)try{var i=e.name||e.url,r=dY(i,e.data,this.loadKeyValueData),s=r.compressed,o=r.uncompressed,a=r.kvData;if(s){var l=lY(i,s,e.metadata);if(a&&l.textures)for(var c in l.textures)l.textures[c].baseTexture.ktxKeyValueData=a;Object.assign(e,l)}else if(o){var u={};o.forEach(function(h,d){var f=new Wt(new In(h.resource,{mipmap:sl.OFF,alphaMode:ol.NO_PREMULTIPLIED_ALPHA,type:h.type,format:h.format})),p=i+"-"+(d+1);a&&(f.baseTexture.ktxKeyValueData=a),In.addToCache(f.baseTexture,p),Wt.addToCache(f,p),d===0&&(u[i]=f,In.addToCache(f.baseTexture,i),Wt.addToCache(f,i)),u[p]=f}),Object.assign(e,{textures:u})}}catch(h){t(h);return}t()},n.extension=ai.Loader,n.loadKeyValueData=!1,n}();/*!
 * @pixi/particle-container - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/particle-container is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ER=function(n,e){return ER=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},ER(n,e)};function gY(n,e){ER(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var cEe=function(n){gY(e,n);function e(t,i,r,s){t===void 0&&(t=1500),r===void 0&&(r=16384),s===void 0&&(s=!1);var o=n.call(this)||this,a=16384;return r>a&&(r=a),o._properties=[!1,!0,!1,!1,!1],o._maxSize=t,o._batchSize=r,o._buffers=null,o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=Xt.NORMAL,o.autoResize=s,o.roundPixels=!0,o.baseTexture=null,o.setProperties(i),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,_s(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var i=this;!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return i.onChildrenChange(0)})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var i=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<i;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[i]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},e}(mn),k3=function(){function n(e,t,i){this.geometry=new s_,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<e.length;++r){var s=e[r];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||qt.FLOAT,offset:s.offset},t[r]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return n.prototype.initBuffers=function(){var e=this.geometry,t=0;this.indexBuffer=new Br(sX(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var r=this.dynamicProperties[i];r.offset=t,t+=r.size,this.dynamicStride+=r.size}var s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new Br(this.dynamicData,!1,!1);var o=0;this.staticStride=0;for(var i=0;i<this.staticProperties.length;++i){var r=this.staticProperties[i];r.offset=o,o+=r.size,this.staticStride+=r.size}var a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Br(this.staticData,!0,!1);for(var i=0;i<this.dynamicProperties.length;++i){var r=this.dynamicProperties[i];e.addAttribute(r.attributeName,this.dynamicBuffer,0,r.type===qt.UNSIGNED_BYTE,r.type,this.dynamicStride*4,r.offset*4)}for(var i=0;i<this.staticProperties.length;++i){var r=this.staticProperties[i];e.addAttribute(r.attributeName,this.staticBuffer,0,r.type===qt.UNSIGNED_BYTE,r.type,this.staticStride*4,r.offset*4)}},n.prototype.uploadDynamic=function(e,t,i){for(var r=0;r<this.dynamicProperties.length;r++){var s=this.dynamicProperties[r];s.uploadFunction(e,t,i,s.type===qt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++},n.prototype.uploadStatic=function(e,t,i){for(var r=0;r<this.staticProperties.length;r++){var s=this.staticProperties[r];s.uploadFunction(e,t,i,s.type===qt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++},n.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},n}(),uEe=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,hEe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,mY=function(n){gY(e,n);function e(t){var i=n.call(this,t)||this;return i.shader=null,i.properties=null,i.tempMatrix=new Dt,i.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:i.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:i.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:i.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:i.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:qt.UNSIGNED_BYTE,uploadFunction:i.uploadTint,offset:0}],i.shader=Ku.from(hEe,uEe,{}),i.state=Bd.for2d(),i}return e.prototype.render=function(t){var i=t.children,r=t._maxSize,s=t._batchSize,o=this.renderer,a=i.length;if(a!==0){a>r&&!t.autoResize&&(a=r);var l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));var c=i[0]._texture.baseTexture,u=c.alphaMode>0;this.state.blendMode=xL(t.blendMode,u),o.state.set(this.state);var h=o.gl,d=t.worldTransform.copyTo(this.tempMatrix);d.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=rX(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);for(var f=!1,p=0,g=0;p<a;p+=s,g+=1){var m=a-p;m>s&&(m=s),g>=l.length&&l.push(this._generateOneMoreBuffer(t));var v=l[g];v.uploadDynamic(i,p,m);var _=t._bufferUpdateIDs[g]||0;f=f||v._updateID<_,f&&(v._updateID=t._updateID,v.uploadStatic(i,p,m)),o.geometry.bind(v.geometry),h.drawElements(h.TRIANGLES,m*6,h.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var i=[],r=t._maxSize,s=t._batchSize,o=t._properties,a=0;a<r;a+=s)i.push(new k3(this.properties,o,s));return i},e.prototype._generateOneMoreBuffer=function(t){var i=t._batchSize,r=t._properties;return new k3(this.properties,r,i)},e.prototype.uploadVertices=function(t,i,r,s,o,a){for(var l=0,c=0,u=0,h=0,d=0;d<r;++d){var f=t[i+d],p=f._texture,g=f.scale.x,m=f.scale.y,v=p.trim,_=p.orig;v?(c=v.x-f.anchor.x*_.width,l=c+v.width,h=v.y-f.anchor.y*_.height,u=h+v.height):(l=_.width*(1-f.anchor.x),c=_.width*-f.anchor.x,u=_.height*(1-f.anchor.y),h=_.height*-f.anchor.y),s[a]=c*g,s[a+1]=h*m,s[a+o]=l*g,s[a+o+1]=h*m,s[a+o*2]=l*g,s[a+o*2+1]=u*m,s[a+o*3]=c*g,s[a+o*3+1]=u*m,a+=o*4}},e.prototype.uploadPosition=function(t,i,r,s,o,a){for(var l=0;l<r;l++){var c=t[i+l].position;s[a]=c.x,s[a+1]=c.y,s[a+o]=c.x,s[a+o+1]=c.y,s[a+o*2]=c.x,s[a+o*2+1]=c.y,s[a+o*3]=c.x,s[a+o*3+1]=c.y,a+=o*4}},e.prototype.uploadRotation=function(t,i,r,s,o,a){for(var l=0;l<r;l++){var c=t[i+l].rotation;s[a]=c,s[a+o]=c,s[a+o*2]=c,s[a+o*3]=c,a+=o*4}},e.prototype.uploadUvs=function(t,i,r,s,o,a){for(var l=0;l<r;++l){var c=t[i+l]._texture._uvs;c?(s[a]=c.x0,s[a+1]=c.y0,s[a+o]=c.x1,s[a+o+1]=c.y1,s[a+o*2]=c.x2,s[a+o*2+1]=c.y2,s[a+o*3]=c.x3,s[a+o*3+1]=c.y3,a+=o*4):(s[a]=0,s[a+1]=0,s[a+o]=0,s[a+o+1]=0,s[a+o*2]=0,s[a+o*2+1]=0,s[a+o*3]=0,s[a+o*3+1]=0,a+=o*4)}},e.prototype.uploadTint=function(t,i,r,s,o,a){for(var l=0;l<r;++l){var c=t[i+l],u=c._texture.baseTexture.alphaMode>0,h=c.alpha,d=h<1&&u?ZT(c._tintRGB,h):c._tintRGB+(h*255<<24);s[a]=d,s[a+o]=d,s[a+o*2]=d,s[a+o*3]=d,a+=o*4}},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e.extension={name:"particle",type:ai.RendererPlugin},e}(rb);/*!
 * @pixi/sprite - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var TR=function(n,e){return TR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},TR(n,e)};function dEe(n,e){TR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var F_=new Ae,fEe=new Uint16Array([0,1,2,0,2,3]),Ur=function(n){dEe(e,n);function e(t){var i=n.call(this)||this;return i._anchor=new Gu(i._onAnchorUpdate,i,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),i._texture=null,i._width=0,i._height=0,i._tint=null,i._tintRGB=null,i.tint=16777215,i.blendMode=Xt.NORMAL,i._cachedTint=16777215,i.uvs=null,i.texture=t||Wt.EMPTY,i.vertexData=new Float32Array(8),i.vertexTrimmedData=null,i._transformID=-1,i._textureID=-1,i._transformTrimmedID=-1,i._textureTrimmedID=-1,i.indices=fEe,i.pluginName="batch",i.isSprite=!0,i._roundPixels=xt.ROUND_PIXELS,i}return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Df(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Df(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(!(this._transformID===this.transform._worldID&&this._textureID===t._updateID)){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var i=this.transform.worldTransform,r=i.a,s=i.b,o=i.c,a=i.d,l=i.tx,c=i.ty,u=this.vertexData,h=t.trim,d=t.orig,f=this._anchor,p=0,g=0,m=0,v=0;if(h?(g=h.x-f._x*d.width,p=g+h.width,v=h.y-f._y*d.height,m=v+h.height):(g=-f._x*d.width,p=g+d.width,v=-f._y*d.height,m=v+d.height),u[0]=r*g+o*v+l,u[1]=a*v+s*g+c,u[2]=r*p+o*v+l,u[3]=a*v+s*p+c,u[4]=r*p+o*m+l,u[5]=a*m+s*p+c,u[6]=r*g+o*m+l,u[7]=a*m+s*g+c,this._roundPixels)for(var _=xt.RESOLUTION,y=0;y<u.length;++y)u[y]=Math.round((u[y]*_|0)/_)}},e.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,i=this.vertexTrimmedData,r=t.orig,s=this._anchor,o=this.transform.worldTransform,a=o.a,l=o.b,c=o.c,u=o.d,h=o.tx,d=o.ty,f=-s._x*r.width,p=f+r.width,g=-s._y*r.height,m=g+r.height;i[0]=a*f+c*g+h,i[1]=u*g+l*f+d,i[2]=a*p+c*g+h,i[3]=u*g+l*p+d,i[4]=a*p+c*m+h,i[5]=u*m+l*p+d,i[6]=a*f+c*m+h,i[7]=u*m+l*f+d},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,i=this._texture.orig;!t||t.width===i.width&&t.height===i.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._localBounds||(this._localBounds=new oi),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Pt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):n.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,F_);var i=this._texture.orig.width,r=this._texture.orig.height,s=-i*this.anchor.x,o=0;return F_.x>=s&&F_.x<s+i&&(o=-r*this.anchor.y,F_.y>=o&&F_.y<o+r)},e.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;var i=typeof t=="boolean"?t:t&&t.texture;if(i){var r=typeof t=="boolean"?t:t&&t.baseTexture;this._texture.destroy(!!r)}this._texture=null},e.from=function(t,i){var r=t instanceof Wt?t:Wt.from(t,i);return new e(r)},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var i=Df(this.scale.x)||1;this.scale.x=i*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var i=Df(this.scale.y)||1;this.scale.y=i*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Wt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(mn);/*!
 * @pixi/text - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var IR=function(n,e){return IR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},IR(n,e)};function pEe(n,e){IR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Iv;(function(n){n[n.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",n[n.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(Iv||(Iv={}));var JS={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Iv.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},gEe=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],jp=function(){function n(e){this.styleID=0,this.reset(),e1(this,e,e)}return n.prototype.clone=function(){var e={};return e1(e,this,JS),new n(e)},n.prototype.reset=function(){e1(this,JS,JS)},Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"breakWords",{get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(e){var t=ZS(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this._fill},set:function(e){var t=ZS(e);this._fill!==t&&(this._fill=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(e){mEe(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"leading",{get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"stroke",{get:function(){return this._stroke},set:function(e){var t=ZS(e);this._stroke!==t&&(this._stroke=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"trim",{get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)},enumerable:!1,configurable:!0}),n.prototype.toFontString=function(){var e=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var i=t.length-1;i>=0;i--){var r=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&gEe.indexOf(r)<0&&(r='"'+r+'"'),t[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+e+" "+t.join(",")},n}();function O3(n){return typeof n=="number"?bL(n):(typeof n=="string"&&n.indexOf("0x")===0&&(n=n.replace("0x","#")),n)}function ZS(n){if(Array.isArray(n)){for(var e=0;e<n.length;++e)n[e]=O3(n[e]);return n}else return O3(n)}function mEe(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(var t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}function e1(n,e,t){for(var i in t)Array.isArray(e[i])?n[i]=e[i].slice():n[i]=e[i]}var sc=function(){function n(e,t,i,r,s,o,a,l,c){this.text=e,this.style=t,this.width=i,this.height=r,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}return n.measureText=function(e,t,i,r){r===void 0&&(r=n._canvas),i=i??t.wordWrap;var s=t.toFontString(),o=n.measureFont(s);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);var a=r.getContext("2d");a.font=s;for(var l=i?n.wordWrap(e,t,r):e,c=l.split(/(?:\r\n|\r|\n)/),u=new Array(c.length),h=0,d=0;d<c.length;d++){var f=a.measureText(c[d]).width+(c[d].length-1)*t.letterSpacing;u[d]=f,h=Math.max(h,f)}var p=h+t.strokeThickness;t.dropShadow&&(p+=t.dropShadowDistance);var g=t.lineHeight||o.fontSize+t.strokeThickness,m=Math.max(g,o.fontSize+t.strokeThickness)+(c.length-1)*(g+t.leading);return t.dropShadow&&(m+=t.dropShadowDistance),new n(e,t,p,m,c,u,g+t.leading,h,o)},n.wordWrap=function(e,t,i){i===void 0&&(i=n._canvas);for(var r=i.getContext("2d"),s=0,o="",a="",l=Object.create(null),c=t.letterSpacing,u=t.whiteSpace,h=n.collapseSpaces(u),d=n.collapseNewlines(u),f=!h,p=t.wordWrapWidth+c,g=n.tokenize(e),m=0;m<g.length;m++){var v=g[m];if(n.isNewline(v)){if(!d){a+=n.addLine(o),f=!h,o="",s=0;continue}v=" "}if(h){var _=n.isBreakingSpace(v),y=n.isBreakingSpace(o[o.length-1]);if(_&&y)continue}var A=n.getFromCache(v,c,l,r);if(A>p)if(o!==""&&(a+=n.addLine(o),o="",s=0),n.canBreakWords(v,t.breakWords))for(var w=n.wordWrapSplit(v),b=0;b<w.length;b++){for(var C=w[b],I=1;w[b+I];){var x=w[b+I],T=C[C.length-1];if(!n.canBreakChars(T,x,v,b,t.breakWords))C+=x;else break;I++}b+=C.length-1;var O=n.getFromCache(C,c,l,r);O+s>p&&(a+=n.addLine(o),f=!1,o="",s=0),o+=C,s+=O}else{o.length>0&&(a+=n.addLine(o),o="",s=0);var F=m===g.length-1;a+=n.addLine(v,!F),f=!1,o="",s=0}else A+s>p&&(f=!1,a+=n.addLine(o),o="",s=0),(o.length>0||!n.isBreakingSpace(v)||f)&&(o+=v,s+=A)}return a+=n.addLine(o,!1),a},n.addLine=function(e,t){return t===void 0&&(t=!0),e=n.trimRight(e),e=t?e+`
`:e,e},n.getFromCache=function(e,t,i,r){var s=i[e];if(typeof s!="number"){var o=e.length*t;s=r.measureText(e).width+o,i[e]=s}return s},n.collapseSpaces=function(e){return e==="normal"||e==="pre-line"},n.collapseNewlines=function(e){return e==="normal"},n.trimRight=function(e){if(typeof e!="string")return"";for(var t=e.length-1;t>=0;t--){var i=e[t];if(!n.isBreakingSpace(i))break;e=e.slice(0,-1)}return e},n.isNewline=function(e){return typeof e!="string"?!1:n._newlines.indexOf(e.charCodeAt(0))>=0},n.isBreakingSpace=function(e,t){return typeof e!="string"?!1:n._breakingSpaces.indexOf(e.charCodeAt(0))>=0},n.tokenize=function(e){var t=[],i="";if(typeof e!="string")return t;for(var r=0;r<e.length;r++){var s=e[r],o=e[r+1];if(n.isBreakingSpace(s,o)||n.isNewline(s)){i!==""&&(t.push(i),i=""),t.push(s);continue}i+=s}return i!==""&&t.push(i),t},n.canBreakWords=function(e,t){return t},n.canBreakChars=function(e,t,i,r,s){return!0},n.wordWrapSplit=function(e){return e.split("")},n.measureFont=function(e){if(n._fonts[e])return n._fonts[e];var t={ascent:0,descent:0,fontSize:0},i=n._canvas,r=n._context;r.font=e;var s=n.METRICS_STRING+n.BASELINE_SYMBOL,o=Math.ceil(r.measureText(s).width),a=Math.ceil(r.measureText(n.BASELINE_SYMBOL).width),l=Math.ceil(n.HEIGHT_MULTIPLIER*a);a=a*n.BASELINE_MULTIPLIER|0,i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(s,0,a);var c=r.getImageData(0,0,o,l).data,u=c.length,h=o*4,d=0,f=0,p=!1;for(d=0;d<a;++d){for(var g=0;g<h;g+=4)if(c[f+g]!==255){p=!0;break}if(!p)f+=h;else break}for(t.ascent=a-d,f=u-h,p=!1,d=l;d>a;--d){for(var g=0;g<h;g+=4)if(c[f+g]!==255){p=!0;break}if(!p)f-=h;else break}return t.descent=d-a,t.fontSize=t.ascent+t.descent,n._fonts[e]=t,t},n.clearMetrics=function(e){e===void 0&&(e=""),e?delete n._fonts[e]:n._fonts={}},Object.defineProperty(n,"_canvas",{get:function(){if(!n.__canvas){var e=void 0;try{var t=new OffscreenCanvas(0,0),i=t.getContext("2d");if(i&&i.measureText)return n.__canvas=t,t;e=xt.ADAPTER.createCanvas()}catch{e=xt.ADAPTER.createCanvas()}e.width=e.height=10,n.__canvas=e}return n.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(n,"_context",{get:function(){return n.__context||(n.__context=n._canvas.getContext("2d")),n.__context},enumerable:!1,configurable:!0}),n}();sc._fonts={};sc.METRICS_STRING="|ÉqÅ";sc.BASELINE_SYMBOL="M";sc.BASELINE_MULTIPLIER=1.4;sc.HEIGHT_MULTIPLIER=2;sc._newlines=[10,13];sc._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var vEe={texture:!0,children:!1,baseTexture:!0},Sv=function(n){pEe(e,n);function e(t,i,r){var s=this,o=!1;r||(r=xt.ADAPTER.createCanvas(),o=!0),r.width=3,r.height=3;var a=Wt.from(r);return a.orig=new Pt,a.trim=new Pt,s=n.call(this,a)||this,s._ownCanvas=o,s.canvas=r,s.context=r.getContext("2d"),s._resolution=xt.RESOLUTION,s._autoResolution=!0,s._text=null,s._style=null,s._styleListener=null,s._font="",s.text=t,s.style=i,s.localStyleID=-1,s}return e.prototype.updateText=function(t){var i=this._style;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),!(!this.dirty&&t)){this._font=this._style.toFontString();var r=this.context,s=sc.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,l=s.lines,c=s.lineHeight,u=s.lineWidths,h=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+i.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+i.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=i.strokeThickness,r.textBaseline=i.textBaseline,r.lineJoin=i.lineJoin,r.miterLimit=i.miterLimit;for(var f,p,g=i.dropShadow?2:1,m=0;m<g;++m){var v=i.dropShadow&&m===0,_=v?Math.ceil(Math.max(1,a)+i.padding*2):0,y=_*this._resolution;if(v){r.fillStyle="black",r.strokeStyle="black";var A=i.dropShadowColor,w=_s(typeof A=="number"?A:fA(A)),b=i.dropShadowBlur*this._resolution,C=i.dropShadowDistance*this._resolution;r.shadowColor="rgba("+w[0]*255+","+w[1]*255+","+w[2]*255+","+i.dropShadowAlpha+")",r.shadowBlur=b,r.shadowOffsetX=Math.cos(i.dropShadowAngle)*C,r.shadowOffsetY=Math.sin(i.dropShadowAngle)*C+y}else r.fillStyle=this._generateFillStyle(i,l,s),r.strokeStyle=i.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;var I=(c-d.fontSize)/2;(!e.nextLineHeightBehavior||c-d.fontSize<0)&&(I=0);for(var x=0;x<l.length;x++)f=i.strokeThickness/2,p=i.strokeThickness/2+x*c+d.ascent+I,i.align==="right"?f+=h-u[x]:i.align==="center"&&(f+=(h-u[x])/2),i.stroke&&i.strokeThickness&&this.drawLetterSpacing(l[x],f+i.padding,p+i.padding-_,!0),i.fill&&this.drawLetterSpacing(l[x],f+i.padding,p+i.padding-_)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,i,r,s){s===void 0&&(s=!1);var o=this._style,a=o.letterSpacing,l=e.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(a===0||l){l&&(this.context.letterSpacing=a,this.context.textLetterSpacing=a),s?this.context.strokeText(t,i,r):this.context.fillText(t,i,r);return}for(var c=i,u=Array.from?Array.from(t):t.split(""),h=this.context.measureText(t).width,d=0,f=0;f<u.length;++f){var p=u[f];s?this.context.strokeText(p,c,r):this.context.fillText(p,c,r);for(var g="",m=f+1;m<u.length;++m)g+=u[m];d=this.context.measureText(g).width,c+=h-d+a,h=d}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var i=oX(t);i.data&&(t.width=i.width,t.height=i.height,this.context.putImageData(i.data,0,0))}var r=this._texture,s=this._style,o=s.trim?0:s.padding,a=r.baseTexture;r.trim.width=r._frame.width=t.width/this._resolution,r.trim.height=r._frame.height=t.height/this._resolution,r.trim.x=-o,r.trim.y=-o,r.orig.width=r._frame.width-o*2,r.orig.height=r._frame.height-o*2,this._onTextureUpdate(),a.setRealSize(t.width,t.height,this._resolution),r.updateUvs(),this.dirty=!1},e.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),n.prototype._render.call(this,t)},e.prototype.updateTransform=function(){this.updateText(!0),n.prototype.updateTransform.call(this)},e.prototype.getBounds=function(t,i){return this.updateText(!0),this._textureID===-1&&(t=!1),n.prototype.getBounds.call(this,t,i)},e.prototype.getLocalBounds=function(t){return this.updateText(!0),n.prototype.getLocalBounds.call(this,t)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,i,r){var s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;var o,a=t.dropShadow?t.dropShadowDistance:0,l=t.padding||0,c=this.canvas.width/this._resolution-a-l*2,u=this.canvas.height/this._resolution-a-l*2,h=s.slice(),d=t.fillGradientStops.slice();if(!d.length)for(var f=h.length+1,p=1;p<f;++p)d.push(p/f);if(h.unshift(s[0]),d.unshift(0),h.push(s[s.length-1]),d.push(1),t.fillGradientType===Iv.LINEAR_VERTICAL){o=this.context.createLinearGradient(c/2,l,c/2,u+l);for(var g=r.fontProperties.fontSize+t.strokeThickness,p=0;p<i.length;p++){var m=r.lineHeight*(p-1)+g,v=r.lineHeight*p,_=v;p>0&&m>v&&(_=(v+m)/2);var y=v+g,A=r.lineHeight*(p+1),w=y;p+1<i.length&&A<y&&(w=(y+A)/2);for(var b=(w-_)/u,C=0;C<h.length;C++){var I=0;typeof d[C]=="number"?I=d[C]:I=C/h.length;var x=Math.min(1,Math.max(0,_/u+I*b));x=Number(x.toFixed(5)),o.addColorStop(x,h[C])}}}else{o=this.context.createLinearGradient(l,u/2,c+l,u/2);for(var T=h.length+1,O=1,p=0;p<h.length;p++){var F=void 0;typeof d[p]=="number"?F=d[p]:F=O/T,o.addColorStop(F,h[p]),O++}}return o},e.prototype.destroy=function(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},vEe,t),n.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var i=Df(this.scale.x)||1;this.scale.x=i*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var i=Df(this.scale.y)||1;this.scale.y=i*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},t instanceof jp?this._style=t:this._style=new jp(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e.experimentalLetterSpacing=!1,e}(Ur);/*!
 * @pixi/prepare - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */xt.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var SR=function(n,e){return SR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},SR(n,e)};function _Ee(n,e){SR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var vY=function(){function n(e){this.maxItemsPerFrame=e,this.itemsLeft=0}return n.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},n.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},n}();function yEe(n,e){var t=!1;if(n&&n._textures&&n._textures.length){for(var i=0;i<n._textures.length;i++)if(n._textures[i]instanceof Wt){var r=n._textures[i].baseTexture;e.indexOf(r)===-1&&(e.push(r),t=!0)}}return t}function AEe(n,e){if(n.baseTexture instanceof In){var t=n.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function bEe(n,e){if(n._texture&&n._texture instanceof Wt){var t=n._texture.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function wEe(n,e){return e instanceof Sv?(e.updateText(!0),!0):!1}function xEe(n,e){if(e instanceof jp){var t=e.toFontString();return sc.measureFont(t),!0}return!1}function CEe(n,e){if(n instanceof Sv){e.indexOf(n.style)===-1&&e.push(n.style),e.indexOf(n)===-1&&e.push(n);var t=n._texture.baseTexture;return e.indexOf(t)===-1&&e.push(t),!0}return!1}function EEe(n,e){return n instanceof jp?(e.indexOf(n)===-1&&e.push(n),!0):!1}var _Y=function(){function n(e){var t=this;this.limiter=new vY(xt.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){t.queue&&t.prepareItems()},this.registerFindHook(CEe),this.registerFindHook(EEe),this.registerFindHook(yEe),this.registerFindHook(AEe),this.registerFindHook(bEe),this.registerUploadHook(wEe),this.registerUploadHook(xEe)}return n.prototype.upload=function(e,t){var i=this;return typeof e=="function"&&(t=e,e=null),t&&Go("6.5.0","BasePrepare.upload callback is deprecated, use the return Promise instead."),new Promise(function(r){e&&i.add(e);var s=function(){t==null||t(),r()};i.queue.length?(i.completes.push(s),i.ticking||(i.ticking=!0,Qi.system.addOnce(i.tick,i,rl.UTILITY))):s()})},n.prototype.tick=function(){setTimeout(this.delayedTick,0)},n.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed){for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Qi.system.addOnce(this.tick,this,rl.UTILITY);else{this.ticking=!1;var s=this.completes.slice(0);this.completes.length=0;for(var i=0,r=s.length;i<r;i++)s[i]()}},n.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},n.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},n.prototype.add=function(e){for(var t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof mn)for(var t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this},n.prototype.destroy=function(){this.ticking&&Qi.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},n}();function yY(n,e){return e instanceof In?(e._glTextures[n.CONTEXT_UID]||n.texture.bind(e),!0):!1}function TEe(n,e){if(!(e instanceof hn))return!1;var t=e.geometry;e.finishPoly(),t.updateBatches();for(var i=t.batches,r=0;r<i.length;r++){var s=i[r].style.texture;s&&yY(n,s.baseTexture)}return t.batchable||n.geometry.bind(t,e._resolveDirectShader(n)),!0}function IEe(n,e){return n instanceof hn?(e.push(n),!0):!1}var AY=function(n){_Ee(e,n);function e(t){var i=n.call(this,t)||this;return i.uploadHookHelper=i.renderer,i.registerFindHook(IEe),i.registerUploadHook(yY),i.registerUploadHook(TEe),i}return e.extension={name:"prepare",type:ai.RendererPlugin},e}(_Y),SEe=function(){function n(e){this.maxMilliseconds=e,this.frameStart=0}return n.prototype.beginFrame=function(){this.frameStart=Date.now()},n.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},n}();/*!
 * @pixi/spritesheet - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var bY=function(){function n(e,t,i){i===void 0&&(i=null),this.linkedSheets=[],this._texture=e instanceof Wt?e:null,this.baseTexture=e instanceof In?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;var r=this.baseTexture.resource;this.resolution=this._updateResolution(i||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return n.prototype._updateResolution=function(e){e===void 0&&(e=null);var t=this.data.meta.scale,i=gA(e,null);return i===null&&(i=t!==void 0?parseFloat(t):1),i!==1&&this.baseTexture.setResolution(i),i},n.prototype.parse=function(e){var t=this;return e&&Go("6.5.0","Spritesheet.parse callback is deprecated, use the return Promise instead."),new Promise(function(i){t._callback=function(r){e==null||e(r),i(r)},t._batchIndex=0,t._frameKeys.length<=n.BATCH_SIZE?(t._processFrames(0),t._processAnimations(),t._parseComplete()):t._nextBatch()})},n.prototype._processFrames=function(e){for(var t=e,i=n.BATCH_SIZE;t-e<i&&t<this._frameKeys.length;){var r=this._frameKeys[t],s=this._frames[r],o=s.frame;if(o){var a=null,l=null,c=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,u=new Pt(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);s.rotated?a=new Pt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Pt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new Pt(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new Wt(this.baseTexture,a,u,l,s.rotated?2:0,s.anchor),Wt.addToCache(this.textures[r],r)}t++}},n.prototype._processAnimations=function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var i=0;i<e[t].length;i++){var r=e[t][i];this.animations[t].push(this.textures[r])}}},n.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},n.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*n.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*n.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},n.prototype.destroy=function(e){var t;e===void 0&&(e=!1);for(var i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)===null||t===void 0||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]},n.BATCH_SIZE=1e3,n}(),wY=function(){function n(){}return n.use=function(e,t){var i,r,s=this,o=e.name+"_image";if(!e.data||e.type!==lr.TYPE.JSON||!e.data.frames||s.resources[o]){t();return}var a=(r=(i=e.data)===null||i===void 0?void 0:i.meta)===null||r===void 0?void 0:r.related_multi_packs;if(Array.isArray(a))for(var l=function(p){if(typeof p!="string")return"continue";var g=p.replace(".json",""),m=Rf.resolve(e.url.replace(s.baseUrl,""),p);if(s.resources[g]||Object.values(s.resources).some(function(_){return Rf.format(Rf.parse(_.url))===m}))return"continue";var v={crossOrigin:e.crossOrigin,loadType:lr.LOAD_TYPE.XHR,xhrType:lr.XHR_RESPONSE_TYPE.JSON,parentResource:e,metadata:e.metadata};s.add(g,m,v)},c=0,u=a;c<u.length;c++){var h=u[c];l(h)}var d={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},f=n.getResourcePath(e,s.baseUrl);s.add(o,f,d,function(g){if(g.error){t(g.error);return}var m=new bY(g.texture,e.data,e.url);m.parse().then(function(){e.spritesheet=m,e.textures=m.textures,t()})})},n.getResourcePath=function(e,t){return e.isDataUrl?e.data.meta.image:Rf.resolve(e.url.replace(t,""),e.data.meta.image)},n.extension=ai.Loader,n}();/*!
 * @pixi/sprite-tiling - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var PR=function(n,e){return PR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},PR(n,e)};function xY(n,e){PR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var U_=new Ae,o2=function(n){xY(e,n);function e(t,i,r){i===void 0&&(i=100),r===void 0&&(r=100);var s=n.call(this,t)||this;return s.tileTransform=new nb,s._width=i,s._height=r,s.uvMatrix=s.texture.uvMatrix||new rI(t),s.pluginName="tilingSprite",s.uvRespectAnchor=!1,s}return Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var i=this._texture;!i||!i.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,i=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),s=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,i,r,s)},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Pt),t=this._localBoundsRect),this._bounds.getRectangle(t)):n.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,U_);var i=this._width,r=this._height,s=-i*this.anchor._x;if(U_.x>=s&&U_.x<s+i){var o=-r*this.anchor._y;if(U_.y>=o&&U_.y<o+r)return!0}return!1},e.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,i){var r=t instanceof Wt?t:Wt.from(t,i);return new e(r,i.width,i.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(Ur),PEe=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,L3=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,MEe=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,REe=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,DEe=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,dw=new Dt,CY=function(n){xY(e,n);function e(t){var i=n.call(this,t)||this;return t.runners.contextChange.add(i),i.quad=new LL,i.state=Bd.for2d(),i}return e.prototype.contextChange=function(){var t=this.renderer,i={globals:t.globalUniforms};this.simpleShader=Ku.from(L3,PEe,i),this.shader=t.context.webGLVersion>1?Ku.from(REe,DEe,i):Ku.from(L3,MEe,i)},e.prototype.render=function(t){var i=this.renderer,r=this.quad,s=r.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);var o=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;s=r.uvs,s[0]=s[6]=-o,s[1]=s[3]=-a,s[2]=s[4]=1-o,s[5]=s[7]=1-a,r.invalidate();var l=t._texture,c=l.baseTexture,u=c.alphaMode>0,h=t.tileTransform.localTransform,d=t.uvMatrix,f=c.isPowerOfTwo&&l.frame.width===c.width&&l.frame.height===c.height;f&&(c._glTextures[i.CONTEXT_UID]?f=c.wrapMode!==Oc.CLAMP:c.wrapMode===Oc.CLAMP&&(c.wrapMode=Oc.REPEAT));var p=f?this.simpleShader:this.shader,g=l.width,m=l.height,v=t._width,_=t._height;dw.set(h.a*g/v,h.b*g/_,h.c*m/v,h.d*m/_,h.tx/v,h.ty/_),dw.invert(),f?dw.prepend(d.mapCoord):(p.uniforms.uMapCoord=d.mapCoord.toArray(!0),p.uniforms.uClampFrame=d.uClampFrame,p.uniforms.uClampOffset=d.uClampOffset),p.uniforms.uTransform=dw.toArray(!0),p.uniforms.uColor=CL(t.tint,t.worldAlpha,p.uniforms.uColor,u),p.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),p.uniforms.uSampler=l,i.shader.bind(p),i.geometry.bind(r),this.state.blendMode=xL(t.blendMode,u),i.state.set(this.state),i.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e.extension={name:"tilingSprite",type:ai.RendererPlugin},e}(rb);/*!
 * @pixi/mesh - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var MR=function(n,e){return MR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},MR(n,e)};function a2(n,e){MR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var EY=function(){function n(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return n.prototype.update=function(e){if(!(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}},n}(),t1=new Ae,N3=new qu,Pv=function(n){a2(e,n);function e(t,i,r,s){s===void 0&&(s=pa.TRIANGLES);var o=n.call(this)||this;return o.geometry=t,o.shader=i,o.state=r||Bd.for2d(),o.drawMode=s,o.start=0,o.size=0,o.uvs=null,o.indices=null,o.vertexData=new Float32Array(1),o.vertexDirty=-1,o._transformID=-1,o._roundPixels=xt.ROUND_PIXELS,o.batchUvs=null,o}return Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var i=this.geometry.buffers[0].data,r=this.shader;r.batchable&&this.drawMode===pa.TRIANGLES&&i.length<e.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var i=this.shader;i.alpha=this.worldAlpha,i.update&&i.update(),t.batch.flush(),i.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(i),t.state.set(this.state),t.geometry.bind(this.geometry,i),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var i=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=i.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;var s=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[s]),t.plugins[s].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,i=t.buffers[0],r=i.data,s=i._updateID;if(!(s===this.vertexDirty&&this._transformID===this.transform._worldID)){this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));for(var o=this.transform.worldTransform,a=o.a,l=o.b,c=o.c,u=o.d,h=o.tx,d=o.ty,f=this.vertexData,p=0;p<f.length/2;p++){var g=r[p*2],m=r[p*2+1];f[p*2]=a*g+c*m+h,f[p*2+1]=l*g+u*m+d}if(this._roundPixels)for(var v=xt.RESOLUTION,p=0;p<f.length;++p)f[p]=Math.round((f[p]*v|0)/v);this.vertexDirty=s}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],i=this.shader;i.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new EY(t,i.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,t1);for(var i=this.geometry.getBuffer("aVertexPosition").data,r=N3.points,s=this.geometry.getIndex().data,o=s.length,a=this.drawMode===4?3:1,l=0;l+2<o;l+=a){var c=s[l]*2,u=s[l+1]*2,h=s[l+2]*2;if(r[0]=i[c],r[1]=i[c+1],r[2]=i[u],r[3]=i[u+1],r[4]=i[h],r[5]=i[h+1],N3.contains(t1.x,t1.y))return!0}return!1},e.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(mn),kEe=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,OEe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,Mv=function(n){a2(e,n);function e(t,i){var r=this,s={uSampler:t,alpha:1,uTextureMatrix:Dt.IDENTITY,uColor:new Float32Array([1,1,1,1])};return i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i),i.uniforms&&Object.assign(s,i.uniforms),r=n.call(this,i.program||o_.from(OEe,kEe),s)||this,r._colorDirty=!1,r.uvMatrix=new rI(t),r.batchable=i.program===void 0,r.pluginName=i.pluginName,r.tint=i.tint,r.alpha=i.alpha,r}return Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;CL(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(Ku),ob=function(n){a2(e,n);function e(t,i,r){var s=n.call(this)||this,o=new Br(t),a=new Br(i,!0),l=new Br(r,!0,!0);return s.addAttribute("aVertexPosition",o,2,!1,qt.FLOAT).addAttribute("aTextureCoord",a,2,!1,qt.FLOAT).addIndex(l),s._updateId=-1,s}return Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(s_);/*!
 * @pixi/text-bitmap - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/text-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var RR=function(n,e){return RR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},RR(n,e)};function LEe(n,e){RR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xA=function(){function n(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}return n}(),TY=function(){function n(){}return n.test=function(e){return typeof e=="string"&&e.indexOf("info face=")===0},n.parse=function(e){var t=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var r in t){var s=t[r].match(/^[a-z]+/gm)[0],o=t[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var l in o){var c=o[l].split("="),u=c[0],h=c[1].replace(/"/gm,""),d=parseFloat(h),f=isNaN(d)?h:d;a[u]=f}i[s].push(a)}var p=new xA;return i.info.forEach(function(g){return p.info.push({face:g.face,size:parseInt(g.size,10)})}),i.common.forEach(function(g){return p.common.push({lineHeight:parseInt(g.lineHeight,10)})}),i.page.forEach(function(g){return p.page.push({id:parseInt(g.id,10),file:g.file})}),i.char.forEach(function(g){return p.char.push({id:parseInt(g.id,10),page:parseInt(g.page,10),x:parseInt(g.x,10),y:parseInt(g.y,10),width:parseInt(g.width,10),height:parseInt(g.height,10),xoffset:parseInt(g.xoffset,10),yoffset:parseInt(g.yoffset,10),xadvance:parseInt(g.xadvance,10)})}),i.kerning.forEach(function(g){return p.kerning.push({first:parseInt(g.first,10),second:parseInt(g.second,10),amount:parseInt(g.amount,10)})}),i.distanceField.forEach(function(g){return p.distanceField.push({distanceRange:parseInt(g.distanceRange,10),fieldType:g.fieldType})}),p},n}(),NC=function(){function n(){}return n.test=function(e){return e instanceof XMLDocument&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},n.parse=function(e){for(var t=new xA,i=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField"),c=0;c<i.length;c++)t.info.push({face:i[c].getAttribute("face"),size:parseInt(i[c].getAttribute("size"),10)});for(var c=0;c<r.length;c++)t.common.push({lineHeight:parseInt(r[c].getAttribute("lineHeight"),10)});for(var c=0;c<s.length;c++)t.page.push({id:parseInt(s[c].getAttribute("id"),10)||0,file:s[c].getAttribute("file")});for(var c=0;c<o.length;c++){var u=o[c];t.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(var c=0;c<a.length;c++)t.kerning.push({first:parseInt(a[c].getAttribute("first"),10),second:parseInt(a[c].getAttribute("second"),10),amount:parseInt(a[c].getAttribute("amount"),10)});for(var c=0;c<l.length;c++)t.distanceField.push({fieldType:l[c].getAttribute("fieldType"),distanceRange:parseInt(l[c].getAttribute("distanceRange"),10)});return t},n}(),IY=function(){function n(){}return n.test=function(e){if(typeof e=="string"&&e.indexOf("<font>")>-1){var t=new globalThis.DOMParser().parseFromString(e,"text/xml");return NC.test(t)}return!1},n.parse=function(e){var t=new globalThis.DOMParser().parseFromString(e,"text/xml");return NC.parse(t)},n}(),n1=[TY,NC,IY];function l2(n){for(var e=0;e<n1.length;e++)if(n1[e].test(n))return n1[e];return null}function NEe(n,e,t,i,r,s){var o=t.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;var a,l=t.dropShadow?t.dropShadowDistance:0,c=t.padding||0,u=n.width/i-l-c*2,h=n.height/i-l-c*2,d=o.slice(),f=t.fillGradientStops.slice();if(!f.length)for(var p=d.length+1,g=1;g<p;++g)f.push(g/p);if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),t.fillGradientType===Iv.LINEAR_VERTICAL){a=e.createLinearGradient(u/2,c,u/2,h+c);for(var m=0,v=s.fontProperties.fontSize+t.strokeThickness,_=v/h,g=0;g<r.length;g++)for(var y=s.lineHeight*g,A=0;A<d.length;A++){var w=0;typeof f[A]=="number"?w=f[A]:w=A/d.length;var b=y/h+w*_,C=Math.max(m,b);C=Math.min(C,1),a.addColorStop(C,d[A]),m=C}}else{a=e.createLinearGradient(c,h/2,u+c,h/2);for(var I=d.length+1,x=1,g=0;g<d.length;g++){var T=void 0;typeof f[g]=="number"?T=f[g]:T=x/I,a.addColorStop(T,d[g]),x++}}return a}function BEe(n,e,t,i,r,s,o){var a=t.text,l=t.fontProperties;e.translate(i,r),e.scale(s,s);var c=o.strokeThickness/2,u=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=NEe(n,e,o,s,[a],t),e.strokeStyle=o.stroke,o.dropShadow){var h=o.dropShadowColor,d=_s(typeof h=="number"?h:fA(h)),f=o.dropShadowBlur*s,p=o.dropShadowDistance*s;e.shadowColor="rgba("+d[0]*255+","+d[1]*255+","+d[2]*255+","+o.dropShadowAlpha+")",e.shadowBlur=f,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,c,u+t.lineHeight-l.descent),o.fill&&e.fillText(a,c,u+t.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function SY(n){return Array.from?Array.from(n):n.split("")}function FEe(n){typeof n=="string"&&(n=[n]);for(var e=[],t=0,i=n.length;t<i;t++){var r=n[t];if(Array.isArray(r)){if(r.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+r.length+".");var s=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(var a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,SY(r))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}function Ux(n){return n.codePointAt?n.codePointAt(0):n.charCodeAt(0)}var yf=function(){function n(e,t,i){var r,s,o=e.info[0],a=e.common[0],l=e.page[0],c=e.distanceField[0],u=gA(l.file),h={};this._ownsTextures=i,this.font=o.face,this.size=o.size,this.lineHeight=a.lineHeight/u,this.chars={},this.pageTextures=h;for(var d=0;d<e.page.length;d++){var f=e.page[d],p=f.id,g=f.file;h[p]=t instanceof Array?t[d]:t[g],c!=null&&c.fieldType&&c.fieldType!=="none"&&(h[p].baseTexture.alphaMode=ol.NO_PREMULTIPLIED_ALPHA)}for(var d=0;d<e.char.length;d++){var m=e.char[d],p=m.id,v=m.page,_=e.char[d],y=_.x,A=_.y,w=_.width,b=_.height,C=_.xoffset,I=_.yoffset,x=_.xadvance;y/=u,A/=u,w/=u,b/=u,C/=u,I/=u,x/=u;var T=new Pt(y+h[v].frame.x/u,A+h[v].frame.y/u,w,b);this.chars[p]={xOffset:C,yOffset:I,xAdvance:x,kerning:{},texture:new Wt(h[v].baseTexture,T),page:v}}for(var d=0;d<e.kerning.length;d++){var O=e.kerning[d],F=O.first,G=O.second,B=O.amount;F/=u,G/=u,B/=u,this.chars[G]&&(this.chars[G].kerning[F]=B)}this.distanceFieldRange=c==null?void 0:c.distanceRange,this.distanceFieldType=(s=(r=c==null?void 0:c.fieldType)===null||r===void 0?void 0:r.toLowerCase())!==null&&s!==void 0?s:"none"}return n.prototype.destroy=function(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null},n.install=function(e,t,i){var r;if(e instanceof xA)r=e;else{var s=l2(e);if(!s)throw new Error("Unrecognized data format for font.");r=s.parse(e)}t instanceof Wt&&(t=[t]);var o=new n(r,t,i);return n.available[o.font]=o,o},n.uninstall=function(e){var t=n.available[e];if(!t)throw new Error("No font found named '"+e+"'");t.destroy(),delete n.available[e]},n.from=function(e,t,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},n.defaultOptions,i),s=r.chars,o=r.padding,a=r.resolution,l=r.textureWidth,c=r.textureHeight,u=FEe(s),h=t instanceof jp?t:new jp(t),d=l,f=new xA;f.info[0]={face:h.fontFamily,size:h.fontSize},f.common[0]={lineHeight:h.fontSize};for(var p=0,g=0,m,v,_,y=0,A=[],w=0;w<u.length;w++){m||(m=xt.ADAPTER.createCanvas(),m.width=l,m.height=c,v=m.getContext("2d"),_=new In(m,{resolution:a}),A.push(new Wt(_)),f.page.push({id:A.length-1,file:""}));var b=sc.measureText(u[w],h,!1,m),C=b.width,I=Math.ceil(b.height),x=Math.ceil((h.fontStyle==="italic"?2:1)*C);if(g>=c-I*a){if(g===0)throw new Error("[BitmapFont] textureHeight "+c+"px is "+("too small for "+h.fontSize+"px fonts"));--w,m=null,v=null,_=null,g=0,p=0,y=0;continue}if(y=Math.max(I+b.fontProperties.descent,y),x*a+p>=d){--w,g+=y*a,g=Math.ceil(g),p=0,y=0;continue}BEe(m,v,b,p,g,a,h);var T=Ux(b.text);f.char.push({id:T,page:A.length-1,x:p/a,y:g/a,width:x,height:I,xoffset:0,yoffset:0,xadvance:Math.ceil(C-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0))}),p+=(x+2*o)*a,p=Math.ceil(p)}for(var w=0,O=u.length;w<O;w++)for(var F=u[w],G=0;G<O;G++){var B=u[G],R=v.measureText(F).width,P=v.measureText(B).width,k=v.measureText(F+B).width,L=k-(R+P);L&&f.kerning.push({first:Ux(F),second:Ux(B),amount:L})}var H=new n(f,A,!0);return n.available[e]!==void 0&&n.uninstall(e),n.available[e]=H,H},n.ALPHA=[["a","z"],["A","Z"]," "],n.NUMERIC=[["0","9"]],n.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],n.ASCII=[[" ","~"]],n.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:n.ALPHANUMERIC},n.available={},n}(),UEe=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,GEe=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`,HEe=[],VEe=[],B3=[],zEe=function(n){LEe(e,n);function e(t,i){i===void 0&&(i={});var r=n.call(this)||this;r._tint=16777215;var s=Object.assign({},e.styleDefaults,i),o=s.align,a=s.tint,l=s.maxWidth,c=s.letterSpacing,u=s.fontName,h=s.fontSize;if(!yf.available[u])throw new Error('Missing BitmapFont "'+u+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=o,r._tint=a,r._fontName=u,r._fontSize=h||yf.available[u].size,r.text=t,r._maxWidth=l,r._maxLineHeight=0,r._letterSpacing=c,r._anchor=new Gu(function(){r.dirty=!0},r,0,0),r._roundPixels=xt.ROUND_PIXELS,r.dirty=!0,r._resolution=xt.RESOLUTION,r._autoResolution=!0,r._textureCache={},r}return e.prototype.updateText=function(){for(var t,i=yf.available[this._fontName],r=this._fontSize/i.size,s=new Ae,o=[],a=[],l=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=SY(c),h=this._maxWidth*i.size/this._fontSize,d=i.distanceFieldType==="none"?HEe:VEe,f=null,p=0,g=0,m=0,v=-1,_=0,y=0,A=0,w=0,b=0;b<u.length;b++){var C=u[b],I=Ux(C);if(/(?:\s)/.test(C)&&(v=b,_=p,w++),C==="\r"||C===`
`){a.push(p),l.push(-1),g=Math.max(g,p),++m,++y,s.x=0,s.y+=i.lineHeight,f=null,w=0;continue}var x=i.chars[I];if(x){f&&x.kerning[f]&&(s.x+=x.kerning[f]);var T=B3.pop()||{texture:Wt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ae};T.texture=x.texture,T.line=m,T.charCode=I,T.position.x=s.x+x.xOffset+this._letterSpacing/2,T.position.y=s.y+x.yOffset,T.prevSpaces=w,o.push(T),p=T.position.x+Math.max(x.xAdvance-x.xOffset,x.texture.orig.width),s.x+=x.xAdvance+this._letterSpacing,A=Math.max(A,x.yOffset+x.texture.height),f=I,v!==-1&&h>0&&s.x>h&&(++y,fp(o,1+v-y,1+b-v),b=v,v=-1,a.push(_),l.push(o.length>0?o[o.length-1].prevSpaces:0),g=Math.max(g,_),m++,s.x=0,s.y+=i.lineHeight,f=null,w=0)}}var O=u[u.length-1];O!=="\r"&&O!==`
`&&(/(?:\s)/.test(O)&&(p=_),a.push(p),g=Math.max(g,p),l.push(-1));for(var F=[],b=0;b<=m;b++){var G=0;this._align==="right"?G=g-a[b]:this._align==="center"?G=(g-a[b])/2:this._align==="justify"&&(G=l[b]<0?0:(g-a[b])/l[b]),F.push(G)}for(var B=o.length,R={},P=[],k=this._activePagesMeshData,b=0;b<k.length;b++)d.push(k[b]);for(var b=0;b<B;b++){var L=o[b].texture,H=L.baseTexture.uid;if(!R[H]){var U=d.pop();if(!U){var $=new ob,j=void 0,Q=void 0;i.distanceFieldType==="none"?(j=new Mv(Wt.EMPTY),Q=Xt.NORMAL):(j=new Mv(Wt.EMPTY,{program:o_.from(GEe,UEe),uniforms:{uFWidth:0}}),Q=Xt.NORMAL_NPM);var ne=new Pv($,j);ne.blendMode=Q,U={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:ne,vertices:null,uvs:null,indices:null}}U.index=0,U.indexCount=0,U.vertexCount=0,U.uvsCount=0,U.total=0;var ve=this._textureCache;ve[H]=ve[H]||new Wt(L.baseTexture),U.mesh.texture=ve[H],U.mesh.tint=this._tint,P.push(U),R[H]=U}R[H].total++}for(var b=0;b<k.length;b++)P.indexOf(k[b])===-1&&this.removeChild(k[b].mesh);for(var b=0;b<P.length;b++)P[b].mesh.parent!==this&&this.addChild(P[b].mesh);this._activePagesMeshData=P;for(var b in R){var U=R[b],Pe=U.total;if(!(((t=U.indices)===null||t===void 0?void 0:t.length)>6*Pe)||U.vertices.length<Pv.BATCHABLE_SIZE*2)U.vertices=new Float32Array(4*2*Pe),U.uvs=new Float32Array(4*2*Pe),U.indices=new Uint16Array(6*Pe);else for(var De=U.total,Xe=U.vertices,Ne=De*4*2;Ne<Xe.length;Ne++)Xe[Ne]=0;U.mesh.size=6*Pe}for(var b=0;b<B;b++){var C=o[b],et=C.position.x+F[C.line]*(this._align==="justify"?C.prevSpaces:1);this._roundPixels&&(et=Math.round(et));var ze=et*r,de=C.position.y*r,L=C.texture,lt=R[L.baseTexture.uid],he=L.frame,Ce=L._uvs,se=lt.index++;lt.indices[se*6+0]=0+se*4,lt.indices[se*6+1]=1+se*4,lt.indices[se*6+2]=2+se*4,lt.indices[se*6+3]=0+se*4,lt.indices[se*6+4]=2+se*4,lt.indices[se*6+5]=3+se*4,lt.vertices[se*8+0]=ze,lt.vertices[se*8+1]=de,lt.vertices[se*8+2]=ze+he.width*r,lt.vertices[se*8+3]=de,lt.vertices[se*8+4]=ze+he.width*r,lt.vertices[se*8+5]=de+he.height*r,lt.vertices[se*8+6]=ze,lt.vertices[se*8+7]=de+he.height*r,lt.uvs[se*8+0]=Ce.x0,lt.uvs[se*8+1]=Ce.y0,lt.uvs[se*8+2]=Ce.x1,lt.uvs[se*8+3]=Ce.y1,lt.uvs[se*8+4]=Ce.x2,lt.uvs[se*8+5]=Ce.y2,lt.uvs[se*8+6]=Ce.x3,lt.uvs[se*8+7]=Ce.y3}this._textWidth=g*r,this._textHeight=(s.y+i.lineHeight)*r;for(var b in R){var U=R[b];if(this.anchor.x!==0||this.anchor.y!==0)for(var Re=0,He=this._textWidth*this.anchor.x,Y=this._textHeight*this.anchor.y,W=0;W<U.total;W++)U.vertices[Re++]-=He,U.vertices[Re++]-=Y,U.vertices[Re++]-=He,U.vertices[Re++]-=Y,U.vertices[Re++]-=He,U.vertices[Re++]-=Y,U.vertices[Re++]-=He,U.vertices[Re++]-=Y;this._maxLineHeight=A*r;var ge=U.mesh.geometry.getBuffer("aVertexPosition"),Le=U.mesh.geometry.getBuffer("aTextureCoord"),Ve=U.mesh.geometry.getIndex();ge.data=U.vertices,Le.data=U.uvs,Ve.data=U.indices,ge.update(),Le.update(),Ve.update()}for(var b=0;b<o.length;b++)B3.push(o[b])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);var i=yf.available[this._fontName],r=i.distanceFieldRange,s=i.distanceFieldType,o=i.size;if(s!=="none")for(var a=this.worldTransform,l=a.a,c=a.b,u=a.c,h=a.d,d=Math.sqrt(l*l+c*c),f=Math.sqrt(u*u+h*h),p=(Math.abs(d)+Math.abs(f))/2,g=this._fontSize/o,m=0,v=this._activePagesMeshData;m<v.length;m++){var _=v[m];_.mesh.shader.uniforms.uFWidth=p*r*g*this._resolution}n.prototype._render.call(this,t)},e.prototype.getLocalBounds=function(){return this.validate(),n.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var i=0;i<this._activePagesMeshData.length;i++)this._activePagesMeshData[i].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!yf.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t){var i=this._textureCache;for(var r in i){var s=i[r];s.destroy(),delete i[r]}this._textureCache=null,n.prototype.destroy.call(this,t)},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e}(mn),PY=function(){function n(){}return n.add=function(){lr.setExtensionXhrType("fnt",lr.XHR_RESPONSE_TYPE.TEXT)},n.use=function(e,t){var i=l2(e.data);if(!i){t();return}for(var r=n.getBaseUrl(this,e),s=i.parse(e.data),o={},a=function(g){o[g.metadata.pageFile]=g.texture,Object.keys(o).length===s.page.length&&(e.bitmapFont=yf.install(s,o,!0),t())},l=0;l<s.page.length;++l){var c=s.page[l].file,u=r+c,h=!1;for(var d in this.resources){var f=this.resources[d];if(f.url===u){f.metadata.pageFile=c,f.texture?a(f):f.onAfterMiddleware.add(a),h=!0;break}}if(!h){var p={crossOrigin:e.crossOrigin,loadType:lr.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:c},e.metadata.imageMetadata),parentResource:e};this.add(u,p,a)}}},n.getBaseUrl=function(e,t){var i=t.isDataUrl?"":n.dirname(t.url);return t.isDataUrl&&(i==="."&&(i=""),e.baseUrl&&i&&e.baseUrl.charAt(e.baseUrl.length-1)==="/"&&(i+="/")),i=i.replace(e.baseUrl,""),i&&i.charAt(i.length-1)!=="/"&&(i+="/"),i},n.dirname=function(e){var t=e.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return t===e?".":t===""?"/":t},n.extension=ai.Loader,n}();/*!
 * @pixi/filter-alpha - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var DR=function(n,e){return DR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},DR(n,e)};function $Ee(n,e){DR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var WEe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,MY=function(n){$Ee(e,n);function e(t){t===void 0&&(t=1);var i=n.call(this,DX,WEe,{uAlpha:1})||this;return i.alpha=t,i}return Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(yn);/*!
 * @pixi/filter-blur - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/filter-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var kR=function(n,e){return kR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},kR(n,e)};function RY(n,e){kR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var jEe=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function QEe(n,e){var t=Math.ceil(n/2),i=jEe,r="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<n;o++){var a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",o-(t-1)+".0"),r+=a,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",n.toString()),i}var XEe={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},YEe=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function qEe(n){for(var e=XEe[n],t=e.length,i=YEe,r="",s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",o,a=0;a<n;a++){var l=s.replace("%index%",a.toString());o=a,a>=t&&(o=n-a-1),l=l.replace("%value%",e[o].toString()),r+=l,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",n.toString()),i}/*!
 * @pixi/constants - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var F3;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(F3||(F3={}));var U3;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})(U3||(U3={}));var G3;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(G3||(G3={}));var H3;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(H3||(H3={}));var V3;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(V3||(V3={}));var z3;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(z3||(z3={}));var $3;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})($3||($3={}));var W3;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(W3||(W3={}));var j3;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(j3||(j3={}));var Q3;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(Q3||(Q3={}));var X3;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(X3||(X3={}));var Y3;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(Y3||(Y3={}));var q3;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(q3||(q3={}));var CA;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(CA||(CA={}));var K3;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(K3||(K3={}));var J3;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})(J3||(J3={}));var Z3;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(Z3||(Z3={}));var eG;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(eG||(eG={}));var tG;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(tG||(tG={}));var nG;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(nG||(nG={}));var EA=function(n){RY(e,n);function e(t,i,r,s,o){i===void 0&&(i=8),r===void 0&&(r=4),s===void 0&&(s=xt.FILTER_RESOLUTION),o===void 0&&(o=5);var a=this,l=QEe(o,t),c=qEe(o);return a=n.call(this,l,c)||this,a.horizontal=t,a.resolution=s,a._quality=0,a.quality=r,a.blur=i,a}return e.prototype.apply=function(t,i,r,s){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/i.width):this.uniforms.strength=1/r.height*(r.height/i.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/i.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/i.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,i,r,s);else{var o=t.getFilterTexture(),a=t.renderer,l=i,c=o;this.state.blend=!1,t.applyFilter(this,l,c,CA.CLEAR);for(var u=1;u<this.passes-1;u++){t.bindAndClear(l,CA.BLIT),this.uniforms.uSampler=c;var h=c;c=l,l=h,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,c,r,s),t.returnFilterTexture(o)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+Math.abs(t)*2,this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(yn),KEe=function(n){RY(e,n);function e(t,i,r,s){t===void 0&&(t=8),i===void 0&&(i=4),r===void 0&&(r=xt.FILTER_RESOLUTION),s===void 0&&(s=5);var o=n.call(this)||this;return o.blurXFilter=new EA(!0,t,i,r,s),o.blurYFilter=new EA(!1,t,i,r,s),o.resolution=r,o.quality=i,o.blur=t,o.repeatEdgePixels=!1,o}return e.prototype.apply=function(t,i,r,s){var o=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(o&&a){var l=t.getFilterTexture();this.blurXFilter.apply(t,i,l,CA.CLEAR),this.blurYFilter.apply(t,l,r,s),t.returnFilterTexture(l)}else a?this.blurYFilter.apply(t,i,r,s):this.blurXFilter.apply(t,i,r,s)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),e}(yn);/*!
 * @pixi/filter-color-matrix - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/filter-color-matrix is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var OR=function(n,e){return OR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},OR(n,e)};function JEe(n,e){OR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ZEe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,BC=function(n){JEe(e,n);function e(){var t=this,i={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return t=n.call(this,qL,ZEe,i)||this,t.alpha=1,t}return e.prototype._loadMatrix=function(t,i){i===void 0&&(i=!1);var r=t;i&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r},e.prototype._multiply=function(t,i,r){return t[0]=i[0]*r[0]+i[1]*r[5]+i[2]*r[10]+i[3]*r[15],t[1]=i[0]*r[1]+i[1]*r[6]+i[2]*r[11]+i[3]*r[16],t[2]=i[0]*r[2]+i[1]*r[7]+i[2]*r[12]+i[3]*r[17],t[3]=i[0]*r[3]+i[1]*r[8]+i[2]*r[13]+i[3]*r[18],t[4]=i[0]*r[4]+i[1]*r[9]+i[2]*r[14]+i[3]*r[19]+i[4],t[5]=i[5]*r[0]+i[6]*r[5]+i[7]*r[10]+i[8]*r[15],t[6]=i[5]*r[1]+i[6]*r[6]+i[7]*r[11]+i[8]*r[16],t[7]=i[5]*r[2]+i[6]*r[7]+i[7]*r[12]+i[8]*r[17],t[8]=i[5]*r[3]+i[6]*r[8]+i[7]*r[13]+i[8]*r[18],t[9]=i[5]*r[4]+i[6]*r[9]+i[7]*r[14]+i[8]*r[19]+i[9],t[10]=i[10]*r[0]+i[11]*r[5]+i[12]*r[10]+i[13]*r[15],t[11]=i[10]*r[1]+i[11]*r[6]+i[12]*r[11]+i[13]*r[16],t[12]=i[10]*r[2]+i[11]*r[7]+i[12]*r[12]+i[13]*r[17],t[13]=i[10]*r[3]+i[11]*r[8]+i[12]*r[13]+i[13]*r[18],t[14]=i[10]*r[4]+i[11]*r[9]+i[12]*r[14]+i[13]*r[19]+i[14],t[15]=i[15]*r[0]+i[16]*r[5]+i[17]*r[10]+i[18]*r[15],t[16]=i[15]*r[1]+i[16]*r[6]+i[17]*r[11]+i[18]*r[16],t[17]=i[15]*r[2]+i[16]*r[7]+i[17]*r[12]+i[18]*r[17],t[18]=i[15]*r[3]+i[16]*r[8]+i[17]*r[13]+i[18]*r[18],t[19]=i[15]*r[4]+i[16]*r[9]+i[17]*r[14]+i[18]*r[19]+i[19],t},e.prototype._colorMatrix=function(t){var i=new Float32Array(t);return i[4]/=255,i[9]/=255,i[14]/=255,i[19]/=255,i},e.prototype.brightness=function(t,i){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,i)},e.prototype.tint=function(t,i){var r=t>>16&255,s=t>>8&255,o=t&255,a=[r/255,0,0,0,0,0,s/255,0,0,0,0,0,o/255,0,0,0,0,0,1,0];this._loadMatrix(a,i)},e.prototype.greyscale=function(t,i){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,i)},e.prototype.blackAndWhite=function(t){var i=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.hue=function(t,i){t=(t||0)/180*Math.PI;var r=Math.cos(t),s=Math.sin(t),o=Math.sqrt,a=1/3,l=o(a),c=r+(1-r)*a,u=a*(1-r)-l*s,h=a*(1-r)+l*s,d=a*(1-r)+l*s,f=r+a*(1-r),p=a*(1-r)-l*s,g=a*(1-r)-l*s,m=a*(1-r)+l*s,v=r+a*(1-r),_=[c,u,h,0,0,d,f,p,0,0,g,m,v,0,0,0,0,0,1,0];this._loadMatrix(_,i)},e.prototype.contrast=function(t,i){var r=(t||0)+1,s=-.5*(r-1),o=[r,0,0,0,s,0,r,0,0,s,0,0,r,0,s,0,0,0,1,0];this._loadMatrix(o,i)},e.prototype.saturate=function(t,i){t===void 0&&(t=0);var r=t*2/3+1,s=(r-1)*-.5,o=[r,s,s,0,0,s,r,s,0,0,s,s,r,0,0,0,0,0,1,0];this._loadMatrix(o,i)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){var i=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.sepia=function(t){var i=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.technicolor=function(t){var i=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.polaroid=function(t){var i=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.toBGR=function(t){var i=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.kodachrome=function(t){var i=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.browni=function(t){var i=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.vintage=function(t){var i=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.colorTone=function(t,i,r,s,o){t=t||.2,i=i||.15,r=r||16770432,s=s||3375104;var a=(r>>16&255)/255,l=(r>>8&255)/255,c=(r&255)/255,u=(s>>16&255)/255,h=(s>>8&255)/255,d=(s&255)/255,f=[.3,.59,.11,0,0,a,l,c,t,0,u,h,d,i,0,a-u,l-h,c-d,0,0];this._loadMatrix(f,o)},e.prototype.night=function(t,i){t=t||.1;var r=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(r,i)},e.prototype.predator=function(t,i){var r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,i)},e.prototype.lsd=function(t){var i=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(i,t)},e.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(yn);BC.prototype.grayscale=BC.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var LR=function(n,e){return LR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},LR(n,e)};function eTe(n,e){LR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var tTe=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,nTe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,iTe=function(n){eTe(e,n);function e(t,i){var r=this,s=new Dt;return t.renderable=!1,r=n.call(this,nTe,tTe,{mapSampler:t._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this,r.maskSprite=t,r.maskMatrix=s,i==null&&(i=20),r.scale=new Ae(i,i),r}return e.prototype.apply=function(t,i,r,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var o=this.maskSprite.worldTransform,a=Math.sqrt(o.a*o.a+o.b*o.b),l=Math.sqrt(o.c*o.c+o.d*o.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=o.a/a,this.uniforms.rotation[1]=o.b/a,this.uniforms.rotation[2]=o.c/l,this.uniforms.rotation[3]=o.d/l),t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e}(yn);/*!
 * @pixi/filter-fxaa - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/filter-fxaa is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var NR=function(n,e){return NR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},NR(n,e)};function rTe(n,e){NR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var sTe=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,oTe=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,aTe=function(n){rTe(e,n);function e(){return n.call(this,sTe,oTe)||this}return e}(yn);/*!
 * @pixi/filter-noise - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/filter-noise is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var BR=function(n,e){return BR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},BR(n,e)};function lTe(n,e){BR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var cTe=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,uTe=function(n){lTe(e,n);function e(t,i){t===void 0&&(t=.5),i===void 0&&(i=Math.random());var r=n.call(this,qL,cTe,{uNoise:0,uSeed:0})||this;return r.noise=t,r.seed=i,r}return Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),e}(yn);/*!
 * @pixi/mixin-cache-as-bitmap - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*!
 * @pixi/constants - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var iG;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(iG||(iG={}));var rG;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})(rG||(rG={}));var sG;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(sG||(sG={}));var oG;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(oG||(oG={}));var aG;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(aG||(aG={}));var lG;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(lG||(lG={}));var cG;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(cG||(cG={}));var uG;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(uG||(uG={}));var hG;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(hG||(hG={}));var dG;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(dG||(dG={}));var fG;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(fG||(fG={}));var pG;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(pG||(pG={}));var gG;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(gG||(gG={}));var mG;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(mG||(mG={}));var vG;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(vG||(vG={}));var _G;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})(_G||(_G={}));var yG;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(yG||(yG={}));var AG;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(AG||(AG={}));var FR;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(FR||(FR={}));var bG;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(bG||(bG={}));var DY=new Dt;rn.prototype._cacheAsBitmap=!1;rn.prototype._cacheData=null;rn.prototype._cacheAsBitmapResolution=null;rn.prototype._cacheAsBitmapMultisample=FR.NONE;var hTe=function(){function n(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}return n}();Object.defineProperties(rn.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(n){n!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(n){n!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(n){if(this._cacheAsBitmap!==n){this._cacheAsBitmap=n;var e;n?(this._cacheData||(this._cacheData=new hTe),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}});rn.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))};rn.prototype._initCachedDisplayObject=function(e){var t;if(!(this._cacheData&&this._cacheData.sprite)){var i=this.alpha;this.alpha=1,e.batch.flush();var r=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var s=this.filters[0].padding;r.pad(s)}r.ceil(xt.RESOLUTION);var o=e.renderTexture.current,a=e.renderTexture.sourceFrame.clone(),l=e.renderTexture.destinationFrame.clone(),c=e.projection.transform,u=va.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:(t=this.cacheAsBitmapMultisample)!==null&&t!==void 0?t:e.multisample}),h="cacheAsBitmap_"+Md();this._cacheData.textureCacheId=h,In.addToCache(u.baseTexture,h),Wt.addToCache(u,h);var d=this.transform.localTransform.copyTo(DY).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:u,clear:!0,transform:d,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=c,e.renderTexture.bind(o,a,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;var f=new Ur(u);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(r.x/r.width),f.anchor.y=-(r.y/r.height),f.alpha=i,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)}};rn.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))};rn.prototype._initCachedDisplayObjectCanvas=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;var r=e.context,s=e._projTransform;t.ceil(xt.RESOLUTION);var o=va.create({width:t.width,height:t.height}),a="cacheAsBitmap_"+Md();this._cacheData.textureCacheId=a,In.addToCache(o.baseTexture,a),Wt.addToCache(o,a);var l=DY;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=t.x,l.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),e.context=r,e._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;var c=new Ur(o);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(t.x/t.width),c.anchor.y=-(t.y/t.height),c.alpha=i,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=c.containsPoint.bind(c)}};rn.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};rn.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};rn.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,In.removeFromCache(this._cacheData.textureCacheId),Wt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};rn.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)};/*!
 * @pixi/mixin-get-child-by-name - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */rn.prototype.name=null;mn.prototype.getChildByName=function(e,t){for(var i=0,r=this.children.length;i<r;i++)if(this.children[i].name===e)return this.children[i];if(t)for(var i=0,r=this.children.length;i<r;i++){var s=this.children[i];if(s.getChildByName){var o=s.getChildByName(e,!0);if(o)return o}}return null};/*!
 * @pixi/mixin-get-global-position - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */rn.prototype.getGlobalPosition=function(e,t){return e===void 0&&(e=new Ae),t===void 0&&(t=!1),this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};/*!
 * @pixi/app - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var kY=function(){function n(){}return n.init=function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(i){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=i,i&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){t._resizeTo&&(t.cancelResize(),t._resizeId=requestAnimationFrame(function(){return t.resize()}))},this.cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){t.cancelResize();var i,r;if(t._resizeTo===globalThis.window)i=globalThis.innerWidth,r=globalThis.innerHeight;else{var s=t._resizeTo,o=s.clientWidth,a=s.clientHeight;i=o,r=a}t.renderer.resize(i,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},n.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},n.extension=ai.Application,n}();/*!
 * @pixi/settings - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*!
 * @pixi/constants - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var wG;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(wG||(wG={}));var xG;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})(xG||(xG={}));var CG;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(CG||(CG={}));var EG;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(EG||(EG={}));var TG;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(TG||(TG={}));var IG;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(IG||(IG={}));var SG;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(SG||(SG={}));var PG;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(PG||(PG={}));var MG;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(MG||(MG={}));var UR;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(UR||(UR={}));var GR;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(GR||(GR={}));var HR;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(HR||(HR={}));var RG;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(RG||(RG={}));var DG;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(DG||(DG={}));var VR;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(VR||(VR={}));var Iy;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})(Iy||(Iy={}));var kG;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(kG||(kG={}));var OG;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(OG||(OG={}));var zR;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(zR||(zR={}));var LG;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(LG||(LG={}));var dTe={createCanvas:function(n,e){var t=document.createElement("canvas");return t.width=n,t.height=e,t},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var n;return(n=document.baseURI)!==null&&n!==void 0?n:window.location.href},fetch:function(n,e){return fetch(n,e)}},i1=/iPhone/i,NG=/iPod/i,BG=/iPad/i,FG=/\biOS-universal(?:.+)Mac\b/i,r1=/\bAndroid(?:.+)Mobile\b/i,UG=/Android/i,Lg=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,fw=/Silk/i,eu=/Windows Phone/i,GG=/\bWindows(?:.+)ARM\b/i,HG=/BlackBerry/i,VG=/BB10/i,zG=/Opera Mini/i,$G=/\b(CriOS|Chrome)(?:.+)Mobile/i,WG=/Mobile(?:.+)Firefox\b/i,jG=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function fTe(n){return function(e){return e.test(n)}}function pTe(n){var e={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?e.userAgent=n:n&&n.userAgent&&(e={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var t=e.userAgent,i=t.split("[FBAN");typeof i[1]<"u"&&(t=i[0]),i=t.split("Twitter"),typeof i[1]<"u"&&(t=i[0]);var r=fTe(t),s={apple:{phone:r(i1)&&!r(eu),ipod:r(NG),tablet:!r(i1)&&(r(BG)||jG(e))&&!r(eu),universal:r(FG),device:(r(i1)||r(NG)||r(BG)||r(FG)||jG(e))&&!r(eu)},amazon:{phone:r(Lg),tablet:!r(Lg)&&r(fw),device:r(Lg)||r(fw)},android:{phone:!r(eu)&&r(Lg)||!r(eu)&&r(r1),tablet:!r(eu)&&!r(Lg)&&!r(r1)&&(r(fw)||r(UG)),device:!r(eu)&&(r(Lg)||r(fw)||r(r1)||r(UG))||r(/\bokhttp\b/i)},windows:{phone:r(eu),tablet:r(GG),device:r(eu)||r(GG)},other:{blackberry:r(HG),blackberry10:r(VG),opera:r(zG),firefox:r(WG),chrome:r($G),device:r(HG)||r(VG)||r(zG)||r(WG)||r($G)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}var pm=pTe(globalThis.navigator);function gTe(){return!pm.apple.device}function mTe(n){var e=!0;if(pm.tablet||pm.phone){if(pm.apple.device){var t=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(t){var i=parseInt(t[1],10);i<11&&(e=!1)}}if(pm.android.device){var t=navigator.userAgent.match(/Android\s([0-9.]*)/);if(t){var i=parseInt(t[1],10);i<7&&(e=!1)}}}return e?n:4}var FC={ADAPTER:dTe,MIPMAP_TEXTURES:HR.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:zR.NONE,SPRITE_MAX_TEXTURES:mTe(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:VR.AUTO,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:GR.CLAMP,SCALE_MODE:UR.LINEAR,PRECISION_VERTEX:Iy.HIGH,PRECISION_FRAGMENT:pm.apple.device?Iy.HIGH:Iy.MEDIUM,CAN_UPLOAD_SAME_BUFFER:gTe(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},s1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function c2(n,e,t){return t={path:e,exports:{},require:function(i,r){return vTe(i,r??t.path)}},n(t,t.exports),t.exports}function vTe(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}c2(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new r(u,h||l,d),p=t?t+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new i:delete l._events[c]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=t?t+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,p=new Array(f);d<f;d++)p[d]=h[d].fn;return p},a.prototype.listenerCount=function(c){var u=t?t+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,d,f,p){var g=arguments,m=t?t+c:c;if(!this._events[m])return!1;var v=this._events[m],_=arguments.length,y,A;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),_){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,h),!0;case 4:return v.fn.call(v.context,u,h,d),!0;case 5:return v.fn.call(v.context,u,h,d,f),!0;case 6:return v.fn.call(v.context,u,h,d,f,p),!0}for(A=1,y=new Array(_-1);A<_;A++)y[A-1]=g[A];v.fn.apply(v.context,y)}else{var w=v.length,b;for(A=0;A<w;A++)switch(v[A].once&&this.removeListener(c,v[A].fn,void 0,!0),_){case 1:v[A].fn.call(v[A].context);break;case 2:v[A].fn.call(v[A].context,u);break;case 3:v[A].fn.call(v[A].context,u,h);break;case 4:v[A].fn.call(v[A].context,u,h,d);break;default:if(!y)for(b=1,y=new Array(_-1);b<_;b++)y[b-1]=g[b];v[A].fn.apply(v[A].context,y)}}return!0},a.prototype.on=function(c,u,h){return s(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return s(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,d){var f=t?t+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!d||p.once)&&(!h||p.context===h)&&o(this,f);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==u||d&&!p[g].once||h&&p[g].context!==h)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&o(this,u)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a});c2(function(n,e){(function(t){var i=e&&!e.nodeType&&e,r=n&&!n.nodeType&&n,s=typeof s1=="object"&&s1;(s.global===s||s.window===s||s.self===s)&&(t=s);var o,a=2147483647,l=36,c=1,u=26,h=38,d=700,f=72,p=128,g="-",m=/^xn--/,v=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=l-c,w=Math.floor,b=String.fromCharCode,C;function I(U){throw RangeError(y[U])}function x(U,$){for(var j=U.length,Q=[];j--;)Q[j]=$(U[j]);return Q}function T(U,$){var j=U.split("@"),Q="";j.length>1&&(Q=j[0]+"@",U=j[1]),U=U.replace(_,".");var ne=U.split("."),ve=x(ne,$).join(".");return Q+ve}function O(U){for(var $=[],j=0,Q=U.length,ne,ve;j<Q;)ne=U.charCodeAt(j++),ne>=55296&&ne<=56319&&j<Q?(ve=U.charCodeAt(j++),(ve&64512)==56320?$.push(((ne&1023)<<10)+(ve&1023)+65536):($.push(ne),j--)):$.push(ne);return $}function F(U){return x(U,function($){var j="";return $>65535&&($-=65536,j+=b($>>>10&1023|55296),$=56320|$&1023),j+=b($),j}).join("")}function G(U){return U-48<10?U-22:U-65<26?U-65:U-97<26?U-97:l}function B(U,$){return U+22+75*(U<26)-(($!=0)<<5)}function R(U,$,j){var Q=0;for(U=j?w(U/d):U>>1,U+=w(U/$);U>A*u>>1;Q+=l)U=w(U/A);return w(Q+(A+1)*U/(U+h))}function P(U){var $=[],j=U.length,Q,ne=0,ve=p,Pe=f,De,Xe,Ne,et,ze,de,lt,he,Ce;for(De=U.lastIndexOf(g),De<0&&(De=0),Xe=0;Xe<De;++Xe)U.charCodeAt(Xe)>=128&&I("not-basic"),$.push(U.charCodeAt(Xe));for(Ne=De>0?De+1:0;Ne<j;){for(et=ne,ze=1,de=l;Ne>=j&&I("invalid-input"),lt=G(U.charCodeAt(Ne++)),(lt>=l||lt>w((a-ne)/ze))&&I("overflow"),ne+=lt*ze,he=de<=Pe?c:de>=Pe+u?u:de-Pe,!(lt<he);de+=l)Ce=l-he,ze>w(a/Ce)&&I("overflow"),ze*=Ce;Q=$.length+1,Pe=R(ne-et,Q,et==0),w(ne/Q)>a-ve&&I("overflow"),ve+=w(ne/Q),ne%=Q,$.splice(ne++,0,ve)}return F($)}function k(U){var $,j,Q,ne,ve,Pe,De,Xe,Ne,et,ze,de=[],lt,he,Ce,se;for(U=O(U),lt=U.length,$=p,j=0,ve=f,Pe=0;Pe<lt;++Pe)ze=U[Pe],ze<128&&de.push(b(ze));for(Q=ne=de.length,ne&&de.push(g);Q<lt;){for(De=a,Pe=0;Pe<lt;++Pe)ze=U[Pe],ze>=$&&ze<De&&(De=ze);for(he=Q+1,De-$>w((a-j)/he)&&I("overflow"),j+=(De-$)*he,$=De,Pe=0;Pe<lt;++Pe)if(ze=U[Pe],ze<$&&++j>a&&I("overflow"),ze==$){for(Xe=j,Ne=l;et=Ne<=ve?c:Ne>=ve+u?u:Ne-ve,!(Xe<et);Ne+=l)se=Xe-et,Ce=l-et,de.push(b(B(et+se%Ce,0))),Xe=w(se/Ce);de.push(b(B(Xe,0))),ve=R(j,he,Q==ne),j=0,++Q}++j,++$}return de.join("")}function L(U){return T(U,function($){return m.test($)?P($.slice(4).toLowerCase()):$})}function H(U){return T(U,function($){return v.test($)?"xn--"+k($):$})}if(o={version:"1.3.2",ucs2:{decode:O,encode:F},decode:P,encode:k,toASCII:H,toUnicode:L},i&&r)if(n.exports==i)r.exports=o;else for(C in o)o.hasOwnProperty(C)&&(i[C]=o[C]);else t.punycode=o})(s1)});function _Te(n,e){return Object.prototype.hasOwnProperty.call(n,e)}var yTe=function(n,e,t,i){e=e||"&",t=t||"=";var r={};if(typeof n!="string"||n.length===0)return r;var s=/\+/g;n=n.split(e);var o=1e3;i&&typeof i.maxKeys=="number"&&(o=i.maxKeys);var a=n.length;o>0&&a>o&&(a=o);for(var l=0;l<a;++l){var c=n[l].replace(s,"%20"),u=c.indexOf(t),h,d,f,p;u>=0?(h=c.substr(0,u),d=c.substr(u+1)):(h=c,d=""),f=decodeURIComponent(h),p=decodeURIComponent(d),_Te(r,f)?Array.isArray(r[f])?r[f].push(p):r[f]=[r[f],p]:r[f]=p}return r},G_=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}},ATe=function(n,e,t,i){return e=e||"&",t=t||"=",n===null&&(n=void 0),typeof n=="object"?Object.keys(n).map(function(r){var s=encodeURIComponent(G_(r))+t;return Array.isArray(n[r])?n[r].map(function(o){return s+encodeURIComponent(G_(o))}).join(e):s+encodeURIComponent(G_(n[r]))}).join(e):i?encodeURIComponent(G_(i))+t+encodeURIComponent(G_(n)):""};c2(function(n,e){e.decode=e.parse=yTe,e.encode=e.stringify=ATe});/*!
 * @pixi/constants - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var QG;(function(n){n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2"})(QG||(QG={}));var XG;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS"})(XG||(XG={}));var YG;(function(n){n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL"})(YG||(YG={}));var Co;(function(n){n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR"})(Co||(Co={}));var qG;(function(n){n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(qG||(qG={}));var KG;(function(n){n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(KG||(KG={}));var JG;(function(n){n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(JG||(JG={}));var ZG;(function(n){n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT"})(ZG||(ZG={}));var eH;(function(n){n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT"})(eH||(eH={}));var tH;(function(n){n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR"})(tH||(tH={}));var nH;(function(n){n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(nH||(nH={}));var iH;(function(n){n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL"})(iH||(iH={}));var rH;(function(n){n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(rH||(rH={}));var sH;(function(n){n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT"})(sH||(sH={}));var oH;(function(n){n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL"})(oH||(oH={}));var aH;(function(n){n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp"})(aH||(aH={}));var lH;(function(n){n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR"})(lH||(lH={}));var cH;(function(n){n[n.RED=1]="RED",n[n.GREEN=2]="GREEN",n[n.BLUE=4]="BLUE",n[n.ALPHA=8]="ALPHA"})(cH||(cH={}));var uH;(function(n){n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH"})(uH||(uH={}));var hH;(function(n){n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(hH||(hH={}));/*!
 * @pixi/utils - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */FC.RETINA_PREFIX=/@([0-9\.]+)x/;FC.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;function bTe(){for(var n=[],e=[],t=0;t<32;t++)n[t]=t,e[t]=t;n[Co.NORMAL_NPM]=Co.NORMAL,n[Co.ADD_NPM]=Co.ADD,n[Co.SCREEN_NPM]=Co.SCREEN,e[Co.NORMAL]=Co.NORMAL_NPM,e[Co.ADD]=Co.ADD_NPM,e[Co.SCREEN]=Co.SCREEN_NPM;var i=[];return i.push(e),i.push(n),i}bTe();var dH={};function wTe(n,e,t){if(t===void 0&&(t=3),!dH[e]){var i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+n):(i=i.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+`
Deprecated since v`+n),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+n),console.warn(i))),dH[e]=!0}}(function(){function n(e,t,i){this.canvas=FC.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=i||FC.RESOLUTION,this.resize(e,t)}return n.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.resize=function(e,t){this.canvas.width=Math.round(e*this.resolution),this.canvas.height=Math.round(t*this.resolution)},n.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(n.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=Math.round(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=Math.round(e)},enumerable:!1,configurable:!0}),n})();var u2=function(){function n(e){var t=this;this.stage=new mn,e=Object.assign({forceCanvas:!1},e),this.renderer=RX(e),n._plugins.forEach(function(i){i.init.call(t,e)})}return n.registerPlugin=function(e){wTe("6.5.0","Application.registerPlugin() is deprecated, use extensions.add()"),rc.add({type:ai.Application,ref:e})},n.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(n.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),n.prototype.destroy=function(e,t){var i=this,r=n._plugins.slice(0);r.reverse(),r.forEach(function(s){s.destroy.call(i)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null},n._plugins=[],n}();rc.handleByList(ai.Application,u2._plugins);rc.add(kY);/*!
 * @pixi/mesh-extras - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $R=function(n,e){return $R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},$R(n,e)};function a_(n,e){$R(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var OY=function(n){a_(e,n);function e(t,i,r,s){t===void 0&&(t=100),i===void 0&&(i=100),r===void 0&&(r=10),s===void 0&&(s=10);var o=n.call(this)||this;return o.segWidth=r,o.segHeight=s,o.width=t,o.height=i,o.build(),o}return e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,i=[],r=[],s=[],o=this.segWidth-1,a=this.segHeight-1,l=this.width/o,c=this.height/a,u=0;u<t;u++){var h=u%this.segWidth,d=u/this.segWidth|0;i.push(h*l,d*c),r.push(h/o,d/a)}for(var f=o*a,u=0;u<f;u++){var p=u%o,g=u/o|0,m=g*this.segWidth+p,v=g*this.segWidth+p+1,_=(g+1)*this.segWidth+p,y=(g+1)*this.segWidth+p+1;s.push(m,v,_,v,y,_)}this.buffers[0].data=new Float32Array(i),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(ob),LY=function(n){a_(e,n);function e(t,i,r){t===void 0&&(t=200),r===void 0&&(r=0);var s=n.call(this,new Float32Array(i.length*4),new Float32Array(i.length*4),new Uint16Array((i.length-1)*6))||this;return s.points=i,s._width=t,s.textureScale=r,s.build(),s}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var i=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),s=this.getIndex();if(!(t.length<1)){i.data.length/4!==t.length&&(i.data=new Float32Array(t.length*4),r.data=new Float32Array(t.length*4),s.data=new Uint16Array((t.length-1)*6));var o=r.data,a=s.data;o[0]=0,o[1]=0,o[2]=0,o[3]=1;for(var l=0,c=t[0],u=this._width*this.textureScale,h=t.length,d=0;d<h;d++){var f=d*4;if(this.textureScale>0){var p=c.x-t[d].x,g=c.y-t[d].y,m=Math.sqrt(p*p+g*g);c=t[d],l+=m/u}else l=d/(h-1);o[f]=l,o[f+1]=0,o[f+2]=l,o[f+3]=1}for(var v=0,d=0;d<h-1;d++){var f=d*2;a[v++]=f,a[v++]=f+1,a[v++]=f+2,a[v++]=f+2,a[v++]=f+1,a[v++]=f+3}r.update(),s.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var i=t[0],r,s=0,o=0,a=this.buffers[0].data,l=t.length,c=0;c<l;c++){var u=t[c],h=c*4;c<t.length-1?r=t[c+1]:r=u,o=-(r.x-i.x),s=r.y-i.y;var d=Math.sqrt(s*s+o*o),f=this.textureScale>0?this.textureScale*this._width/2:this._width/2;s/=d,o/=d,s*=f,o*=f,a[h]=u.x+s,a[h+1]=u.y+o,a[h+2]=u.x-s,a[h+3]=u.y-o,i=u}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(ob),xTe=function(n){a_(e,n);function e(t,i,r){r===void 0&&(r=0);var s=this,o=new LY(t.height,i,r),a=new Mv(t);return r>0&&(t.baseTexture.wrapMode=Oc.REPEAT),s=n.call(this,o,a)||this,s.autoUpdate=!0,s}return e.prototype._render=function(t){var i=this.geometry;(this.autoUpdate||i._width!==this.shader.texture.height)&&(i._width=this.shader.texture.height,i.update()),n.prototype._render.call(this,t)},e}(Pv),NY=function(n){a_(e,n);function e(t,i,r){var s=this,o=new OY(t.width,t.height,i,r),a=new Mv(Wt.WHITE);return s=n.call(this,o,a)||this,s.texture=t,s.autoResize=!0,s}return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,i=this.shader.texture,r=i.width,s=i.height;this.autoResize&&(t.width!==r||t.height!==s)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),n.prototype._render.call(this,t)},e.prototype.destroy=function(t){this.shader.texture.off("update",this.textureUpdated,this),n.prototype.destroy.call(this,t)},e}(Pv),CTe=function(n){a_(e,n);function e(t,i,r,s,o){t===void 0&&(t=Wt.EMPTY);var a=this,l=new ob(i,r,s);l.getBuffer("aVertexPosition").static=!1;var c=new Mv(t);return a=n.call(this,l,c,null,o)||this,a.autoUpdate=!0,a}return Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),n.prototype._render.call(this,t)},e}(Pv),pw=10,ETe=function(n){a_(e,n);function e(t,i,r,s,o){i===void 0&&(i=pw),r===void 0&&(r=pw),s===void 0&&(s=pw),o===void 0&&(o=pw);var a=n.call(this,Wt.WHITE,4,4)||this;return a._origWidth=t.orig.width,a._origHeight=t.orig.height,a._width=a._origWidth,a._height=a._origHeight,a._leftWidth=i,a._rightWidth=s,a._topHeight=r,a._bottomHeight=o,a.texture=t,a}return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,i=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*i,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*i,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,i=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*i,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*i,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,i=this._width>t?1:this._width/t,r=this._topHeight+this._bottomHeight,s=this._height>r?1:this._height/r,o=Math.min(i,s);return o},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,i=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var r=1/this._origWidth,s=1/this._origHeight;i[0]=i[8]=i[16]=i[24]=0,i[1]=i[3]=i[5]=i[7]=0,i[6]=i[14]=i[22]=i[30]=1,i[25]=i[27]=i[29]=i[31]=1,i[2]=i[10]=i[18]=i[26]=r*this._leftWidth,i[4]=i[12]=i[20]=i[28]=1-r*this._rightWidth,i[9]=i[11]=i[13]=i[15]=s*this._topHeight,i[17]=i[19]=i[21]=i[23]=1-s*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(NY);/*!
 * @pixi/sprite-animated - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * @pixi/sprite-animated is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var WR=function(n,e){return WR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},WR(n,e)};function TTe(n,e){WR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ITe=function(n){TTe(e,n);function e(t,i){i===void 0&&(i=!0);var r=n.call(this,t[0]instanceof Wt?t[0]:t[0].texture)||this;return r._textures=null,r._durations=null,r._autoUpdate=i,r._isConnectedToTicker=!1,r.animationSpeed=1,r.loop=!0,r.updateAnchor=!1,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r._playing=!1,r._previousFrame=null,r.textures=t,r}return e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Qi.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Qi.shared.add(this.update,this,rl.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var i=this.currentFrame;this._currentTime=t,i!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var i=this.currentFrame;this._currentTime=t,i!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){if(this._playing){var i=this.animationSpeed*t,r=this.currentFrame;if(this._durations!==null){var s=this._currentTime%1*this._durations[this.currentFrame];for(s+=i/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];var o=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=i;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(t){this.stop(),n.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var i=[],r=0;r<t.length;++r)i.push(Wt.from(t[r]));return new e(i)},e.fromImages=function(t){for(var i=[],r=0;r<t.length;++r)i.push(Wt.from(t[r]));return new e(i)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof Wt)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var i=0;i<t.length;i++)this._textures.push(t[i].texture),this._durations.push(t[i].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Qi.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Qi.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e}(Ur);/*!
 * pixi.js - v6.5.2
 * Compiled Wed, 24 Aug 2022 13:51:19 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */rc.add(eY,tY,e2,mY,AY,JL,CY,PY,aY,fY,pY,wY,DQ,iY);var BY={AlphaFilter:MY,BlurFilter:KEe,BlurFilterPass:EA,ColorMatrixFilter:BC,DisplacementFilter:iTe,FXAAFilter:aTe,NoiseFilter:uTe};const STe=Object.freeze(Object.defineProperty({__proto__:null,get ALPHA_MODES(){return ol},AbstractBatchRenderer:kX,AbstractMultiResource:nI,AbstractRenderer:MX,AccessibilityManager:eY,AnimatedSprite:ITe,AppLoaderPlugin:iY,Application:u2,ArrayResource:IL,Attribute:aR,get BLEND_MODES(){return Xt},get BUFFER_BITS(){return hA},get BUFFER_TYPE(){return ql},BaseImageResource:Uc,BasePrepare:_Y,BaseRenderTexture:kL,BaseTexture:In,BatchDrawCall:TC,BatchGeometry:KL,BatchPluginFactory:LX,BatchRenderer:JL,BatchShaderGenerator:OX,BatchSystem:BL,BatchTextureArray:IC,BitmapFont:yf,BitmapFontData:xA,BitmapFontLoader:PY,BitmapText:zEe,BlobResource:oY,Bounds:oi,BrowserAdapter:RQ,Buffer:Br,BufferResource:dg,get CLEAR_MODES(){return Au},get COLOR_MASK_BITS(){return KM},CanvasResource:SL,Circle:YT,CompressedTextureLoader:aY,CompressedTextureResource:LC,Container:mn,ContextSystem:FL,CountLimiter:vY,CubeResource:PL,DDSLoader:fY,DEG_TO_RAD:Yo,get DRAW_MODES(){return pa},DisplayObject:rn,get ENV(){return Zl},Ellipse:SQ,get ExtensionType(){return ai},Extract:tY,get FORMATS(){return At},FORMATS_TO_COMPONENTS:uY,FillStyle:t2,Filter:yn,FilterState:dX,FilterSystem:NL,Framebuffer:EC,FramebufferSystem:UL,get GC_MODES(){return CC},GLFramebuffer:fX,GLProgram:IX,GLTexture:Lx,GRAPHICS_CURVES:ms,Geometry:s_,GeometrySystem:GL,Graphics:hn,GraphicsData:pR,GraphicsGeometry:sI,IGLUniformData:uxe,INSTALLED:mA,get INTERNAL_FORMATS(){return En},INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:wA,ImageBitmapResource:DL,ImageResource:iI,InteractionData:lR,InteractionEvent:FX,InteractionManager:e2,InteractionTrackingData:Nx,KTXLoader:pY,get LINE_CAP(){return _o},get LINE_JOIN(){return ma},LineStyle:r2,Loader:bA,get LoaderResource(){return lr},get MASK_TYPES(){return Lr},get MIPMAP_MODES(){return sl},get MSAA_QUALITY(){return Cr},MaskData:pX,MaskSystem:HL,Matrix:Dt,Mesh:Pv,MeshBatchUvs:EY,MeshGeometry:ob,MeshMaterial:Mv,NineSlicePlane:ETe,ObjectRenderer:rb,ObservablePoint:Gu,PI_2:aA,get PRECISION(){return $l},ParticleContainer:cEe,ParticleRenderer:mY,PlaneGeometry:OY,Point:Ae,Polygon:qu,Prepare:AY,Program:o_,ProjectionSystem:$L,Quad:hX,QuadUv:LL,RAD_TO_DEG:XT,get RENDERER_TYPE(){return Tv},Rectangle:Pt,RenderTexture:va,RenderTexturePool:uX,RenderTextureSystem:WL,Renderer:sb,ResizePlugin:kY,Resource:Vp,RopeGeometry:LY,RoundedRectangle:PQ,Runner:us,get SAMPLER_TYPES(){return dA},get SCALE_MODES(){return ga},get SHAPES(){return Yn},SVGResource:ML,ScissorSystem:VL,Shader:Ku,ShaderSystem:jL,SimpleMesh:CTe,SimplePlane:NY,SimpleRope:xTe,Sprite:Ur,SpriteMaskFilter:bX,Spritesheet:bY,SpritesheetLoader:wY,State:Bd,StateSystem:QL,StencilSystem:zL,System:Txe,get TARGETS(){return md},get TEXT_GRADIENT(){return Iv},get TYPES(){return qt},TYPES_TO_BYTES_PER_COMPONENT:CR,TYPES_TO_BYTES_PER_PIXEL:hY,TemporaryDisplayObject:TL,Text:Sv,TextFormat:TY,TextMetrics:sc,TextStyle:jp,Texture:Wt,TextureGCSystem:XL,TextureLoader:rY,TextureMatrix:rI,TextureSystem:YL,TextureUvs:OL,Ticker:Qi,TickerPlugin:DQ,TilingSprite:o2,TilingSpriteRenderer:CY,TimeLimiter:SEe,Transform:nb,get UPDATE_PRIORITY(){return rl},UniformGroup:vd,VERSION:Pxe,VideoResource:RL,ViewableBuffer:SC,get WRAP_MODES(){return Oc},XMLFormat:NC,XMLStringFormat:IY,accessibleTarget:ZX,autoDetectFormat:l2,autoDetectRenderer:RX,autoDetectResource:tI,checkMaxIfStatementsInShader:AX,createUBOElements:CX,defaultFilterVertex:qL,defaultVertex:DX,extensions:rc,filters:BY,generateProgram:SX,generateUniformBufferSync:TX,getTestContext:vX,getUBOData:EX,graphicsUtils:oI,groupD8:Ki,interactiveTarget:UX,isMobile:Qa,parseDDS:cY,parseKTX:dY,resources:NX,settings:xt,systems:BX,uniformParsers:pp,utils:Owe},Symbol.toStringTag,{value:"Module"}));class h2{constructor(){E(this,"deltaX");E(this,"deltaY");E(this,"deltaTime");E(this,"distance");E(this,"angle");E(this,"velocityX");E(this,"velocityY");E(this,"velocity");E(this,"overallVelocityX");E(this,"overallVelocityY");E(this,"overallVelocity");E(this,"direction");E(this,"offsetDirection");E(this,"scale");E(this,"deltaScale");E(this,"rotation");E(this,"center");E(this,"srcEvent");E(this,"interactionEvent");E(this,"displayObject");E(this,"pointerType");E(this,"eventType");E(this,"pointers");E(this,"changedPointers");E(this,"maxPointers");E(this,"timeStamp")}get isFirst(){const e=this.pointers.length,t=this.changedPointers.length;return this.eventType&1&&e-t===0}get isFinal(){const e=this.pointers.length,t=this.changedPointers.length;return this.eventType&12&&e-t===0}}const PTe=25,MTe=new Map([["pointerdown",1],["pointermove",2],["pointerup",4],["pointercancel",8],["pointerout",8],["pointerleave",8],["pointerover",8]]);function RTe(n,e,t){if(n.indexOf&&!t)return n.indexOf(e);{let i=0;for(;i<n.length;){if(t&&n[i][t]===e||!t&&n[i]===e)return i;i++}return-1}}function fH(n){const e=[];let t=0;for(;t<n.pointers.length;)e[t]={clientX:Math.round(n.pointers[t].clientX),clientY:Math.round(n.pointers[t].clientY)},t++;const i=new h2;return i.pointers=e,i.timeStamp=Date.now(),i.center=FY(e),i.deltaX=n.deltaX,i.deltaY=n.deltaY,i}function FY(n){const e=n.length;if(e===1)return{x:Math.round(n[0].clientX),y:Math.round(n[0].clientY)};let t=0,i=0,r=0;for(;r<e;)t+=n[r].clientX,i+=n[r].clientY,r++;return{x:Math.round(t/e),y:Math.round(i/e)}}function DTe(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.atan2(i,t)*180/Math.PI}function pH(n,e){const t=e.clientX-n.clientX,i=e.clientY-n.clientY;return Math.atan2(i,t)*180/Math.PI}function UY(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.sqrt(t*t+i*i)}function gH(n,e){const t=e.clientX-n.clientX,i=e.clientY-n.clientY;return Math.sqrt(t*t+i*i)}function GY(n,e){return n===e?1:Math.abs(n)>=Math.abs(e)?n<0?2:4:e<0?8:16}function HY(n,e,t){return{x:e/n||0,y:t/n||0}}function kTe(n,e){return!n||!e||n.length<2||e.length<2?1:gH(e[0],e[1])/gH(n[0],n[1])}function OTe(n,e){return!n||!e||n.length<2||e.length<2?0:pH(e[1],e[0])+pH(n[1],n[0])}function LTe(n){const e=n.type.toLowerCase().replace("ms","");return MTe.get(e)}function Nc(n){const{data:{originalEvent:e}}=n;let t=!0;if(window.TouchEvent&&e instanceof TouchEvent){const{touches:i,type:r}=e;r!=="touchend"?i.length!==1&&(t=!1):i.length!==0&&(t=!1)}return t}function Sy(n){const{data:{originalEvent:e}}=n;let t=null;if(window.TouchEvent&&e instanceof TouchEvent){const{changedTouches:i}=e;i.length===1&&(t=i[0].identifier)}if(e instanceof PointerEvent){const{pointerId:i}=e;t=i}return t}function jR(n){const{data:{originalEvent:e}}=n,t=[];if(window.TouchEvent&&e instanceof TouchEvent){const{changedTouches:i}=e;for(let r=0;r<i.length;r++){const s=i[r];t.push(s.identifier)}}if(e instanceof PointerEvent){const{pointerId:i}=e;t.push(i)}return t}function NTe(n){return window.TouchEvent&&["touch","pen"].includes(n.data.pointerType)}function BTe(n){return!NTe(n)&&n.data.originalEvent instanceof MouseEvent}function FTe(n,e){const t=e.pointers.length,i=e.pointers;n.firstInput||(n.firstInput=fH(e)),t>1&&!n.firstMultiple?n.firstMultiple=fH(e):t===1&&(n.firstMultiple=null);const{firstInput:r,firstMultiple:s}=n;e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-r.timeStamp;const o=s!==null?s.center:r.center,a=e.center=FY(i);e.angle=DTe(o,a),e.distance=UY(o,a),UTe(n,e),e.offsetDirection=GY(e.deltaX,e.deltaY);const l=HY(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=Math.abs(l.x)>Math.abs(l.y)?l.x:l.y,e.scale=kTe(s?s.pointers:void 0,i);const c=n.prevScale??e.scale;e.deltaScale=e.scale-c,n.prevScale=e.scale,e.rotation=OTe(s?s.pointers:void 0,i),e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,GTe(n,e)}function UTe(n,e){const{center:t}=e;let i=n.offsetDelta||{x:0,y:0},r=n.prevDelta||{x:0,y:0};const s=n.prevInput||new h2;(e.eventType===1||s.eventType===4)&&(r=n.prevDelta={x:s.deltaX||0,y:s.deltaY||0},i=n.offsetDelta={x:t.x,y:t.y}),e.deltaX=r.x+(t.x-i.x),e.deltaY=r.y+(t.y-i.y)}function GTe(n,e){const t=n.lastInterval||e,i=e.timeStamp-t.timeStamp;let r,s,o,a;if(e.eventType!==8&&(i>PTe||t.velocity===void 0)){const l=e.deltaX-t.deltaX,c=e.deltaY-t.deltaY,u=HY(i,l,c);s=u.x,o=u.y,r=Math.abs(u.x)>Math.abs(u.y)?u.x:u.y,a=GY(l,c),n.lastInterval=e}else r=t.velocity,s=t.velocityX,o=t.velocityY,a=t.direction;e.velocity=r,e.velocityX=s,e.velocityY=o,e.direction=a}function HTe(n){return n&16?"cancel":n&8?"end":n&4?"move":n&2?"start":""}class ab{constructor(){E(this,"state",1);E(this,"options")}recognize(e){const t=Object.create(e);this.state&56&&(this.state=1),this.state=this.process(t),this.state&30&&this.emit(t)}emit(e){if(!e.displayObject)return;const{state:t}=this;e.displayObject.emit(this.options.event+"-"+HTe(t),e.interactionEvent,e),t&8&&e.displayObject.emit(this.options.event,e.interactionEvent,e)}}const VY={};class VTe extends ab{constructor(){super();E(this,"preTimeStamp",0);E(this,"preTapPoint");this.options={event:ji.DOUBLE_CLICK,pointers:2,lt:300,gte:50,maxDistance:8,...VY}}process(t){const{options:i}=this,r=t.timeStamp-this.preTimeStamp<i.lt&&t.timeStamp-this.preTimeStamp>i.gte,o=(this.preTapPoint?UY(this.preTapPoint,t.center):1/0)<i.maxDistance;return t.eventType&1&&(this.preTimeStamp=t.timeStamp,this.preTapPoint=t.center,r&&o)?8:32}reset(){}}const zY={};class zTe extends ab{constructor(){super(),this.options={event:ji.LONG_PRESS,pointers:1,time:1e3,threshold:9,...zY}}process(e){const{options:t}=this,i=e.pointers.length===t.pointers,r=e.distance<t.threshold,s=e.deltaTime>=t.time;return e.eventType&1&&r&&i?2:e.isFinal&&e.maxPointers===t.pointers&&s?8:32}reset(){}}const $Y={};class $Te extends ab{constructor(){super();E(this,"changing",!1);E(this,"count",0);this.options={event:ji.PAN,pointers:2,angle:5,distance:5,dithering:5,...$Y}}process(t){const{options:i}=this,r=t.pointers.length===i.pointers,s=Math.abs(t.angle)<i.angle||Math.abs(t.angle-90)<i.angle||Math.abs(t.angle+90)<i.angle||Math.abs(t.angle+180)<i.angle;if(r){if(t.eventType&2&&s&&t.distance>i.distance&&(this.count++,this.count>=i.dithering))return this.count===i.dithering?2:(this.changing=!0,4)}else if(t.eventType&4&&t.isFinal)return this.changing?(this.changing=!1,this.count=0,8):(this.changing=!1,this.count=0,32);return 32}reset(){}}const WY={};let WTe=class extends ab{constructor(){super();E(this,"changing",!1);E(this,"count",0);this.options={event:ji.PINCH,pointers:2,angle:20,distance:5,dithering:5,...WY}}process(t){const{options:i}=this,r=t.pointers.length===i.pointers,o=!(Math.abs(t.angle)<i.angle||Math.abs(t.angle-90)<i.angle||Math.abs(t.angle+90)<i.angle||Math.abs(t.angle+180)<i.angle);if(r){if(t.eventType&2&&o&&t.distance>i.distance&&(this.count++,this.count>=i.dithering))return this.count===i.dithering?2:(this.changing=!0,4)}else if(t.eventType&4&&t.isFinal)return this.changing?(this.changing=!1,this.count=0,8):(this.changing=!1,this.count=0,32);return 32}reset(){}};const jY={};class jTe extends ab{constructor(){super(),this.options={event:ji.TWO_FINGER_TAP,pointers:2,time:300,threshold:9,...jY}}process(e){const{options:t}=this,i=e.pointers.length===t.pointers,r=e.distance<t.threshold,s=e.deltaTime<t.time,o=Math.abs(e.deltaX)<t.threshold&&Math.abs(e.deltaY)<t.threshold;return e.eventType&1&&r&&s&&i?2:e.isFinal&&e.maxPointers===t.pointers&&o&&s?8:32}reset(){}}class QTe{constructor(){E(this,"firstInput");E(this,"firstMultiple");E(this,"prevInput");E(this,"prevScale");E(this,"offsetDelta");E(this,"prevDelta");E(this,"lastInterval")}}class XTe{constructor(){E(this,"pointers",[]);E(this,"session");E(this,"recognizers",[]);this.addRecognizers()}processPointer(e,t){const i=e.data.originalEvent,r=LTe(i),s=i.pointerType,o=s==="touch";let a=RTe(this.pointers,i.pointerId,"pointerId"),l=!1;if(r&1&&(i.button===0||o)?a<0&&(this.pointers.push(i),a=this.pointers.length-1):r&12&&(l=!0),a<0)return;this.pointers[a]=i;const c=new h2;c.pointers=this.pointers,c.changedPointers=[i],c.pointerType=s,c.eventType=r,c.srcEvent=i,c.interactionEvent=e,c.interactionEvent.currentTarget=t,c.interactionEvent.target=t,c.displayObject=t,this.processInput(c),l&&this.pointers.splice(a,1)}processInput(e){e.isFirst&&(this.session=new QTe),FTe(this.session,e),this.recognize(e),this.session.prevInput=e}recognize(e){const{recognizers:t}=this;let i=0,r;for(;i<t.length;)r=t[i],r.recognize(e),i++}addRecognizers(){const e=new jTe,t=new zTe,i=new VTe,r=new WTe,s=new $Te;this.recognizers.push(e),this.recognizers.push(t),this.recognizers.push(i),this.recognizers.push(r),this.recognizers.push(s)}}class YTe extends e2{constructor(t,i){super(t,i);E(this,"pointerManager");this.pointerManager=new XTe,this.passEvents()}onPointerUp(t){this.supportsTouchEvents&&["touch","pen"].includes(t.pointerType)||super.onPointerUp(t)}configureInteractionEventForDOMEvent(t,i,r){return i.target===this.renderer.view?t.isInView=!0:t.isInView=!1,super.configureInteractionEventForDOMEvent(t,i,r)}onPointerMove(t){this.supportsTouchEvents&&["touch","pen"].includes(t.pointerType)||super.onPointerMove(t)}onPointerDown(t){this.supportsTouchEvents&&["touch","pen"].includes(t.pointerType)||super.onPointerDown(t)}passEvents(){this.supportsPointerEvents?(this.interactionDOMElement.addEventListener("pointerdown",this.passPointerDownEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointermove",this.passPointerMoveEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerup",this.passPointerUpEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointercancel",this.passPointerUpEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.passPointerOutEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.passPointerOverEvent.bind(this),this._eventListenerOptions)):(window.MouseEvent&&(this.interactionDOMElement.addEventListener("mousedown",this.passPointerDownEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousemove",this.passPointerMoveEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseup",this.passPointerUpEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.passPointerOutEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.passPointerOverEvent.bind(this),this._eventListenerOptions)),window.TouchEvent&&(this.interactionDOMElement.addEventListener("touchstart",this.passPointerDownEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.passPointerMoveEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.passPointerUpEvent.bind(this),this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.passPointerUpEvent.bind(this),this._eventListenerOptions)))}passPointerDownEvent(t){const i=this.normalizeToPointerData(t);this.autoPreventDefault&&i[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault(),this.passPointerComplete(i,t,this.processPointer.bind(this))}passPointerMoveEvent(t){const i=this.normalizeToPointerData(t);(i[0].pointerType==="mouse"||i[0].pointerType==="pen")&&(this._didMove=!0,this.cursor=null),this.passPointerComplete(i,t,this.processPointer.bind(this))}passPointerUpEvent(t){const i=this.normalizeToPointerData(t);this.passPointerComplete(i,t,this.processPointer.bind(this))}passPointerComplete(t,i,r){const s=t.length;for(let o=0;o<s;o++){const a=t[o],l=this.getInteractionDataForPointerId(a),c=this.configureInteractionEventForDOMEvent(this.eventData,a,l);c.data.originalEvent=i,r(c)}}passPointerOutEvent(t){const r=this.normalizeToPointerData(t)[0];r.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));const s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);o.data.originalEvent=r,this.processPointer(o),r.pointerType==="mouse"||r.pointerType==="pen"||this.releaseInteractionDataForPointerId(s.identifier)}passPointerOverEvent(t){const r=this.normalizeToPointerData(t)[0],s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);o.data.originalEvent=r,r.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.processPointer(o)}processPointer(t){this.processInteractive(t,this.lastObjectRendered,this.hitPointer.bind(this),!0)}hitPointer(t,i,r){r&&this.pointerManager.processPointer(t,i)}}const qTe={DoubleTap:VY,LongPress:zY,Pan:$Y,Pinch:WY,TwoFingerTap:jY};function QY(n,e){Ln(qTe[n],e)}mn.prototype.getInteractiveElements=function(){const n=["GRID","BACKDROP","SELECTOR"],e=this.children.filter(r=>!n.includes(r.name)),t=[],i=r=>{const{children:s=[],interactive:o}=r;o?t.push(r):s&&s.length>0&&s.forEach(a=>{i(a)})};return e.forEach(r=>{i(r)}),t};mn.prototype.isVaild=function(){return this.width>0||this.height>0};var gw,KTe=new Uint8Array(16);function JTe(){if(!gw&&(gw=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!gw))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gw(KTe)}const ZTe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function eIe(n){return typeof n=="string"&&ZTe.test(n)}var Es=[];for(var o1=0;o1<256;++o1)Es.push((o1+256).toString(16).substr(1));function tIe(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(Es[n[e+0]]+Es[n[e+1]]+Es[n[e+2]]+Es[n[e+3]]+"-"+Es[n[e+4]]+Es[n[e+5]]+"-"+Es[n[e+6]]+Es[n[e+7]]+"-"+Es[n[e+8]]+Es[n[e+9]]+"-"+Es[n[e+10]]+Es[n[e+11]]+Es[n[e+12]]+Es[n[e+13]]+Es[n[e+14]]+Es[n[e+15]]).toLowerCase();if(!eIe(t))throw TypeError("Stringified UUID is invalid");return t}function Ui(n,e,t){n=n||{};var i=n.random||(n.rng||JTe)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=i[r];return e}return tIe(i)}function Hu(n,e){return e.some(t=>Ds(n,t))}function UC(n,e,t){let i=0;switch(n){case"left":i=0;break;case"right":i=e-t;break;case"center":i=(e-t)/2;break;default:i=0}return i}function QR(n,e){return isFinite(e)&&isFinite(n)?Number(nIe(n,e)):Number(n)}function nIe(n,e){return isFinite(e)?Math.abs(n)<1&&e>0?n.toPrecision(e):n.toFixed(e):String(n)}function iIe(n){return n/180*Math.PI}function XR(n,e,t=1e-6){return Math.abs(n-e)<t}function sd(n,e){return isFinite(e)&&e>0?hM(n,e):n}function XY(n,e,t,i=n.pivot){const r=e.a,s=e.b,o=e.c,a=e.d,l=-Math.atan2(-o,a),c=Math.atan2(s,r);return t=t??c,n.pivot.set(i.x,i.y),n.rotation=t,n.skew.x=t+l,n.skew.y=-t+c,n.scale.x=Math.sqrt(r*r+s*s),n.scale.y=Math.sqrt(o*o+a*a),n.position.x=e.tx+(i.x*e.a+i.y*e.c),n.position.y=e.ty+(i.x*e.b+i.y*e.d),n}function d2(n,e,t){const i=new Dt,r=new Dt;if(!t){const a=n.parent?n.parent:n.enableTempParent();n.updateTransform(),n.disableTempParent(a)}const s=n.worldTransform,o=n.parent?i.copyFrom(n.parent.worldTransform):Dt.IDENTITY;r.copyFrom(s),r.prepend(e),r.prepend(o.invert()),XY(n.transform,r)}function sh(n,e){const t=e.clone().invert();return n.clone().prepend(t)}function YY(n,e){const t=n.toLocal(new Ae(e.minX,e.minY)),i=n.toLocal(new Ae(e.maxX,e.maxY));return e.minX=t.x,e.minY=t.y,e.maxX=i.x,e.maxY=i.y,e}function f2(n,e={}){let t=n;e.relMat&&(t=n.clone().prepend(e.relMat.clone().invert()));let i=[t.a,t.b,t.c,t.d,t.tx,t.ty];const{fractionPrecision:r}=e;return isFinite(r)&&(i=i.map(s=>QR(s,r))),i}function p2(n,e){for(let t=0,i=n.length;t<i;t++)d2(n[t],e,!1)}function qY(n,e){const t=Xr.calculateGroupOrientedBounds(n,0),i=Dt.IDENTITY,r=t.center;return i.translate(-r.x,-r.y).rotate(e*Yo-t.rotation).translate(r.x,r.y),i}function rIe(n,e){return e?e===n.parent?n.localTransform.clone():e!==n?sh(n.worldTransform.clone(),e.worldTransform.clone()):void 0:n.worldTransform.clone()}function TA(n){if(Array.isArray(n)){let i="";return n.forEach(r=>{i&&(i+=`
`),i+=TA(r)}),i}else if(typeof n=="string")return n;if(!n||!n.tag)return"";const e=n.attrs?Object.entries(n.attrs).reduce((i,[r,s])=>(Fp(s)||!s&&pi(s)||i.push(`${r}="${s}"`),i),[""]).join(" "):"",t=n.children?TA(n.children):"";return`<${n.tag}${e}>${t}</${n.tag}>`}function KY(n,e){var i;return{transform:`matrix(${f2(n.worldTransform,{relMat:(i=e==null?void 0:e.relativeObj)==null?void 0:i.worldTransform,fractionPrecision:e==null?void 0:e.fractionPrecision})})`}}function g2(n,e){const t=n.layerColor??"#000000";return(e==null?void 0:e.fillStrokeExportMode)==="as-is"&&n.isFill===!0||(e==null?void 0:e.fillStrokeExportMode)==="as-fill"?{stroke:"none",fill:t}:{stroke:t,fill:"none"}}function sIe(n,e){const t=e==null?void 0:e.fractionPrecision;let i="";return n.graphicsData.forEach(r=>{if(Object.values(Yn).includes(r.shape.type)){const o=r.points;for(let a=0;a<o.length;a+=2){const l=QR(o[a],t),c=QR(o[a+1],t);i+=`${l},${c} `}}}),i?{points:i}:{}}function oIe(n){let e="";const t=/^[MLHVQCSTAZ]$/;for(const{type:i,values:r}of n)i.match(t)?e+=`${i}${r.join(" ")} `:console.error("Invalid command type");return e}function aIe(n){const r={doc:()=>{var s;return['<?xml version="1.0"?>',"<!-- Created with xTool Creative Space (https://www.xtool.com/pages/software) -->",((s=r.svg)==null?void 0:s.call(r))??""]},svg:s=>{var o;return{tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:xcs":"https://www.xtool.com/pages/software",version:"1.1",preserveAspectRatio:"xMinYMin meet",width:(n.contentWidth??0)+"mm",height:(n.contentHeight??0)+"mm",...n.viewBox?{viewBox:n.viewBox.join(" ")}:{},...s},children:[].concat(((o=r.style)==null?void 0:o.call(r))??"",n.content??"")}},style:()=>({tag:"style",children:["svg * { vector-effect: non-scaling-stroke; stroke-width: 1px; }"]})};return r}function mH(n,e){const t=aIe(n),i=(e==null?void 0:e(n,t))??t.doc();return typeof i=="string"?i:TA(i)}const NE=class NE extends Zr{constructor(){super();E(this,"config",{enableFill:!0})}static getInstance(){return this.instance}get enableFill(){return this.config.enableFill}set enableFill(t){this.config.enableFill=t,this.emit(vR.ENABLE_FILL,t)}};E(NE,"instance",new NE);let Qp=NE;console.trace("[GlobalConfigManager  ] >");function lIe(n){const e=Qp.getInstance();Object.assign(e.config,n)}function JY(n){document.getElementById("preview")||document.body.insertAdjacentHTML("afterbegin",'<div id="preview" style="position: absolute; top: 0; z-index: 2"></div>'),document.querySelector("#preview-style")||cIe(),document.getElementById("preview").appendChild(n)}function vH(n,e="preview"){const i=`<html>
        <head>
          <style>
            body { padding: 0; }
            a { position: fixed; right: 10px; }
          </style>
        </head>
        <body>
          <div><a href=${URL.createObjectURL(new Blob([n],{type:"image/svg+xml"}))} download="${e}">Download</a></div>
          ${n}
        </body>
      </html>
      `;console.log("Preview Link: %o",URL.createObjectURL(new Blob([i],{type:"text/html"})))}function cIe(){const n=document.createElement("style");n.id="preview-style",n.innerText=`
  body #preview {
    z-index: 99999 !important;
    pointer-events: none;
  }
  body #preview canvas {
    pointer-events: none;
    max-width: 160px;
    max-height: 160px;
    outline: 1px solid;
  }
`,document.head.append(n)}function GC(n,e){let t={width:n.width,height:n.height};return(isFinite(e.width)||isFinite(e.height))&&(t=YR(t,{width:e.width,height:e.height,fitMode:e.fitMode})),(isFinite(e.minWidth)||isFinite(e.minHeight)||isFinite(e.maxWidth)||isFinite(e.maxHeight))&&(t=uIe(t,e)),t}function YR(n,e){const{width:t,height:i}=n;let{width:r,height:s}=e;const{fitMode:o="contain"}=e;if(!isFinite(r)&&!isFinite(s))r=t,s=i;else if(!isFinite(r)&&isFinite(s))i===0?(s=0,r=t):r=t/i*s;else if(!isFinite(s)&&isFinite(r))t===0?(r=0,s=i):s=i/t*r;else{const a=o==="contain"?Math.min(r/t,s/i):Math.max(t!==0?r/t:0,i!==0?s/i:0);r=t*a,s=i*a}return{width:r,height:s}}function uIe(n,e){let{minWidth:t,minHeight:i,maxWidth:r,maxHeight:s}=e;isFinite(t)&&isFinite(r)&&t>r&&([t,r]=[r,t]),isFinite(i)&&isFinite(s)&&i>s&&([i,s]=[r,i]);let o={width:n.width,height:n.height};return(o.width<t||o.height<i)&&(o=YR(o,{width:t,height:i,fitMode:"cover"})),(o.width>r||o.height>s)&&(o=YR(o,{width:r,height:s,fitMode:"contain"})),o}var Gx={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},hIe=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function dIe(n){return n===10||n===13||n===8232||n===8233||n===32||n===9||n===11||n===12||n===160||n>=5760&&hIe.indexOf(n)>=0}function fIe(n){switch(n|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}function pIe(n){return(n|32)===97}function Ng(n){return n>=48&&n<=57}function gIe(n){return n>=48&&n<=57||n===43||n===45||n===46}function mIe(n){this.index=0,this.path=n,this.max=n.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function Hx(n){for(;n.index<n.max&&dIe(n.path.charCodeAt(n.index));)n.index++}function vIe(n){var e=n.path.charCodeAt(n.index);if(e===48){n.param=0,n.index++;return}if(e===49){n.param=1,n.index++;return}n.err="SvgPath: arc flag can be 0 or 1 only (at pos "+n.index+")"}function _Ie(n){var e=n.index,t=e,i=n.max,r=!1,s=!1,o=!1,a=!1,l;if(t>=i){n.err="SvgPath: missed param (at pos "+t+")";return}if(l=n.path.charCodeAt(t),(l===43||l===45)&&(t++,l=t<i?n.path.charCodeAt(t):0),!Ng(l)&&l!==46){n.err="SvgPath: param should start with 0..9 or `.` (at pos "+t+")";return}if(l!==46){if(r=l===48,t++,l=t<i?n.path.charCodeAt(t):0,r&&t<i&&l&&Ng(l)){n.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+e+")";return}for(;t<i&&Ng(n.path.charCodeAt(t));)t++,s=!0;l=t<i?n.path.charCodeAt(t):0}if(l===46){for(a=!0,t++;Ng(n.path.charCodeAt(t));)t++,o=!0;l=t<i?n.path.charCodeAt(t):0}if(l===101||l===69){if(a&&!s&&!o){n.err="SvgPath: invalid float exponent (at pos "+t+")";return}if(t++,l=t<i?n.path.charCodeAt(t):0,(l===43||l===45)&&t++,t<i&&Ng(n.path.charCodeAt(t)))for(;t<i&&Ng(n.path.charCodeAt(t));)t++;else{n.err="SvgPath: invalid float exponent (at pos "+t+")";return}}n.index=t,n.param=parseFloat(n.path.slice(e,t))+0}function a1(n){var e,t;e=n.path[n.segmentStart],t=e.toLowerCase();var i=n.data;if(t==="m"&&i.length>2&&(n.result.push([e,i[0],i[1]]),i=i.slice(2),t="l",e=e==="m"?"l":"L"),t==="r")n.result.push([e].concat(i));else for(;i.length>=Gx[t]&&(n.result.push([e].concat(i.splice(0,Gx[t]))),!!Gx[t]););}function yIe(n){var e=n.max,t,i,r,s,o;if(n.segmentStart=n.index,t=n.path.charCodeAt(n.index),i=pIe(t),!fIe(t)){n.err="SvgPath: bad command "+n.path[n.index]+" (at pos "+n.index+")";return}if(s=Gx[n.path[n.index].toLowerCase()],n.index++,Hx(n),n.data=[],!s){a1(n);return}for(r=!1;;){for(o=s;o>0;o--){if(i&&(o===3||o===4)?vIe(n):_Ie(n),n.err.length){a1(n);return}n.data.push(n.param),Hx(n),r=!1,n.index<e&&n.path.charCodeAt(n.index)===44&&(n.index++,Hx(n),r=!0)}if(!r&&(n.index>=n.max||!gIe(n.path.charCodeAt(n.index))))break}a1(n)}var AIe=function(e){var t=new mIe(e),i=t.max;for(Hx(t);t.index<i&&!t.err.length;)yIe(t);return t.result.length&&("mM".indexOf(t.result[0][0])<0?(t.err="SvgPath: string should start with `M` or `m`",t.result=[]):t.result[0][0]="M"),{err:t.err,segments:t.result}};function bIe(n,e){return[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],n[0]*e[4]+n[2]*e[5]+n[4],n[1]*e[4]+n[3]*e[5]+n[5]]}function ec(){if(!(this instanceof ec))return new ec;this.queue=[],this.cache=null}ec.prototype.matrix=function(n){return n[0]===1&&n[1]===0&&n[2]===0&&n[3]===1&&n[4]===0&&n[5]===0?this:(this.cache=null,this.queue.push(n),this)};ec.prototype.translate=function(n,e){return(n!==0||e!==0)&&(this.cache=null,this.queue.push([1,0,0,1,n,e])),this};ec.prototype.scale=function(n,e){return(n!==1||e!==1)&&(this.cache=null,this.queue.push([n,0,0,e,0,0])),this};ec.prototype.rotate=function(n,e,t){var i,r,s;return n!==0&&(this.translate(e,t),i=n*Math.PI/180,r=Math.cos(i),s=Math.sin(i),this.queue.push([r,s,-s,r,0,0]),this.cache=null,this.translate(-e,-t)),this};ec.prototype.skewX=function(n){return n!==0&&(this.cache=null,this.queue.push([1,0,Math.tan(n*Math.PI/180),1,0,0])),this};ec.prototype.skewY=function(n){return n!==0&&(this.cache=null,this.queue.push([1,Math.tan(n*Math.PI/180),0,1,0,0])),this};ec.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],this.queue.length===1)return this.cache;for(var n=1;n<this.queue.length;n++)this.cache=bIe(this.cache,this.queue[n]);return this.cache};ec.prototype.calc=function(n,e,t){var i;return this.queue.length?(this.cache||(this.cache=this.toArray()),i=this.cache,[n*i[0]+e*i[2]+(t?0:i[4]),n*i[1]+e*i[3]+(t?0:i[5])]):[n,e]};var ZY=ec,wIe=ZY,xIe={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},CIe=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,EIe=/[\s,]+/,TIe=function(e){var t=new wIe,i,r;return e.split(CIe).forEach(function(s){if(s.length){if(typeof xIe[s]<"u"){i=s;return}switch(r=s.split(EIe).map(function(o){return+o||0}),i){case"matrix":r.length===6&&t.matrix(r);return;case"scale":r.length===1?t.scale(r[0],r[0]):r.length===2&&t.scale(r[0],r[1]);return;case"rotate":r.length===1?t.rotate(r[0],0,0):r.length===3&&t.rotate(r[0],r[1],r[2]);return;case"translate":r.length===1?t.translate(r[0],0):r.length===2&&t.translate(r[0],r[1]);return;case"skewX":r.length===1&&t.skewX(r[0]);return;case"skewY":r.length===1&&t.skewY(r[0]);return}}}),t},Py=Math.PI*2;function _H(n,e,t,i){var r=n*i-e*t<0?-1:1,s=n*t+e*i;return s>1&&(s=1),s<-1&&(s=-1),r*Math.acos(s)}function IIe(n,e,t,i,r,s,o,a,l,c){var u=c*(n-t)/2+l*(e-i)/2,h=-l*(n-t)/2+c*(e-i)/2,d=o*o,f=a*a,p=u*u,g=h*h,m=d*f-d*g-f*p;m<0&&(m=0),m/=d*g+f*p,m=Math.sqrt(m)*(r===s?-1:1);var v=m*o/a*h,_=m*-a/o*u,y=c*v-l*_+(n+t)/2,A=l*v+c*_+(e+i)/2,w=(u-v)/o,b=(h-_)/a,C=(-u-v)/o,I=(-h-_)/a,x=_H(1,0,w,b),T=_H(w,b,C,I);return s===0&&T>0&&(T-=Py),s===1&&T<0&&(T+=Py),[y,A,x,T]}function SIe(n,e){var t=1.3333333333333333*Math.tan(e/4),i=Math.cos(n),r=Math.sin(n),s=Math.cos(n+e),o=Math.sin(n+e);return[i,r,i-r*t,r+i*t,s+o*t,o-s*t,s,o]}var PIe=function(e,t,i,r,s,o,a,l,c){var u=Math.sin(c*Py/360),h=Math.cos(c*Py/360),d=h*(e-i)/2+u*(t-r)/2,f=-u*(e-i)/2+h*(t-r)/2;if(d===0&&f===0)return[];if(a===0||l===0)return[];a=Math.abs(a),l=Math.abs(l);var p=d*d/(a*a)+f*f/(l*l);p>1&&(a*=Math.sqrt(p),l*=Math.sqrt(p));var g=IIe(e,t,i,r,s,o,a,l,u,h),m=[],v=g[2],_=g[3],y=Math.max(Math.ceil(Math.abs(_)/(Py/4)),1);_/=y;for(var A=0;A<y;A++)m.push(SIe(v,_)),v+=_;return m.map(function(w){for(var b=0;b<w.length;b+=2){var C=w[b+0],I=w[b+1];C*=a,I*=l;var x=h*C-u*I,T=u*C+h*I;w[b+0]=x+g[0],w[b+1]=T+g[1]}return w})},My=1e-10,yH=Math.PI/180;function IA(n,e,t){if(!(this instanceof IA))return new IA(n,e,t);this.rx=n,this.ry=e,this.ax=t}IA.prototype.transform=function(n){var e=Math.cos(this.ax*yH),t=Math.sin(this.ax*yH),i=[this.rx*(n[0]*e+n[2]*t),this.rx*(n[1]*e+n[3]*t),this.ry*(-n[0]*t+n[2]*e),this.ry*(-n[1]*t+n[3]*e)],r=i[0]*i[0]+i[2]*i[2],s=i[1]*i[1]+i[3]*i[3],o=((i[0]-i[3])*(i[0]-i[3])+(i[2]+i[1])*(i[2]+i[1]))*((i[0]+i[3])*(i[0]+i[3])+(i[2]-i[1])*(i[2]-i[1])),a=(r+s)/2;if(o<My*a)return this.rx=this.ry=Math.sqrt(a),this.ax=0,this;var l=i[0]*i[1]+i[2]*i[3];o=Math.sqrt(o);var c=a+o/2,u=a-o/2;return this.ax=Math.abs(l)<My&&Math.abs(c-s)<My?90:Math.atan(Math.abs(l)>Math.abs(c-s)?(c-r)/l:l/(c-s))*180/Math.PI,this.ax>=0?(this.rx=Math.sqrt(c),this.ry=Math.sqrt(u)):(this.ax+=90,this.rx=Math.sqrt(u),this.ry=Math.sqrt(c)),this};IA.prototype.isDegenerate=function(){return this.rx<My*this.ry||this.ry<My*this.rx};var MIe=IA,RIe=AIe,DIe=TIe,Fd=ZY,kIe=PIe,OIe=MIe;function ur(n){if(!(this instanceof ur))return new ur(n);var e=RIe(n);this.segments=e.segments,this.err=e.err,this.__stack=[]}ur.from=function(n){if(typeof n=="string")return new ur(n);if(n instanceof ur){var e=new ur("");return e.err=n.err,e.segments=n.segments.map(function(t){return t.slice()}),e.__stack=n.__stack.map(function(t){return Fd().matrix(t.toArray())}),e}throw new Error("SvgPath.from: invalid param type "+n)};ur.prototype.__matrix=function(n){var e=this,t;n.queue.length&&this.iterate(function(i,r,s,o){var a,l,c,u;switch(i[0]){case"v":a=n.calc(0,i[1],!0),l=a[0]===0?["v",a[1]]:["l",a[0],a[1]];break;case"V":a=n.calc(s,i[1],!1),l=a[0]===n.calc(s,o,!1)[0]?["V",a[1]]:["L",a[0],a[1]];break;case"h":a=n.calc(i[1],0,!0),l=a[1]===0?["h",a[0]]:["l",a[0],a[1]];break;case"H":a=n.calc(i[1],o,!1),l=a[1]===n.calc(s,o,!1)[1]?["H",a[0]]:["L",a[0],a[1]];break;case"a":case"A":var h=n.toArray(),d=OIe(i[1],i[2],i[3]).transform(h);if(h[0]*h[3]-h[1]*h[2]<0&&(i[5]=i[5]?"0":"1"),a=n.calc(i[6],i[7],i[0]==="a"),i[0]==="A"&&i[6]===s&&i[7]===o||i[0]==="a"&&i[6]===0&&i[7]===0){l=[i[0]==="a"?"l":"L",a[0],a[1]];break}d.isDegenerate()?l=[i[0]==="a"?"l":"L",a[0],a[1]]:l=[i[0],d.rx,d.ry,d.ax,i[4],i[5],a[0],a[1]];break;case"m":u=r>0,a=n.calc(i[1],i[2],u),l=["m",a[0],a[1]];break;default:for(c=i[0],l=[c],u=c.toLowerCase()===c,t=1;t<i.length;t+=2)a=n.calc(i[t],i[t+1],u),l.push(a[0],a[1])}e.segments[r]=l},!0)};ur.prototype.__evaluateStack=function(){var n,e;if(this.__stack.length){if(this.__stack.length===1){this.__matrix(this.__stack[0]),this.__stack=[];return}for(n=Fd(),e=this.__stack.length;--e>=0;)n.matrix(this.__stack[e].toArray());this.__matrix(n),this.__stack=[]}};ur.prototype.toString=function(){var n="",e="",t=!1;this.__evaluateStack();for(var i=0,r=this.segments.length;i<r;i++){var s=this.segments[i],o=s[0];o!==e||o==="m"||o==="M"?(o==="m"&&e==="z"&&(n+=" "),n+=o,t=!1):t=!0;for(var a=1;a<s.length;a++){var l=s[a];a===1?t&&l>=0&&(n+=" "):l>=0&&(n+=" "),n+=l}e=o}return n};ur.prototype.translate=function(n,e){return this.__stack.push(Fd().translate(n,e||0)),this};ur.prototype.scale=function(n,e){return this.__stack.push(Fd().scale(n,!e&&e!==0?n:e)),this};ur.prototype.rotate=function(n,e,t){return this.__stack.push(Fd().rotate(n,e||0,t||0)),this};ur.prototype.skewX=function(n){return this.__stack.push(Fd().skewX(n)),this};ur.prototype.skewY=function(n){return this.__stack.push(Fd().skewY(n)),this};ur.prototype.matrix=function(n){return this.__stack.push(Fd().matrix(n)),this};ur.prototype.transform=function(n){return n.trim()?(this.__stack.push(DIe(n)),this):this};ur.prototype.round=function(n){var e=0,t=0,i=0,r=0,s;return n=n||0,this.__evaluateStack(),this.segments.forEach(function(o){var a=o[0].toLowerCase()===o[0];switch(o[0]){case"H":case"h":a&&(o[1]+=i),i=o[1]-o[1].toFixed(n),o[1]=+o[1].toFixed(n);return;case"V":case"v":a&&(o[1]+=r),r=o[1]-o[1].toFixed(n),o[1]=+o[1].toFixed(n);return;case"Z":case"z":i=e,r=t;return;case"M":case"m":a&&(o[1]+=i,o[2]+=r),i=o[1]-o[1].toFixed(n),r=o[2]-o[2].toFixed(n),e=i,t=r,o[1]=+o[1].toFixed(n),o[2]=+o[2].toFixed(n);return;case"A":case"a":a&&(o[6]+=i,o[7]+=r),i=o[6]-o[6].toFixed(n),r=o[7]-o[7].toFixed(n),o[1]=+o[1].toFixed(n),o[2]=+o[2].toFixed(n),o[3]=+o[3].toFixed(n+2),o[6]=+o[6].toFixed(n),o[7]=+o[7].toFixed(n);return;default:s=o.length,a&&(o[s-2]+=i,o[s-1]+=r),i=o[s-2]-o[s-2].toFixed(n),r=o[s-1]-o[s-1].toFixed(n),o.forEach(function(l,c){c&&(o[c]=+o[c].toFixed(n))});return}}),this};ur.prototype.iterate=function(n,e){var t=this.segments,i={},r=!1,s=0,o=0,a=0,l=0,c,u,h;if(e||this.__evaluateStack(),t.forEach(function(d,f){var p=n(d,f,s,o);Array.isArray(p)&&(i[f]=p,r=!0);var g=d[0]===d[0].toLowerCase();switch(d[0]){case"m":case"M":s=d[1]+(g?s:0),o=d[2]+(g?o:0),a=s,l=o;return;case"h":case"H":s=d[1]+(g?s:0);return;case"v":case"V":o=d[1]+(g?o:0);return;case"z":case"Z":s=a,o=l;return;default:s=d[d.length-2]+(g?s:0),o=d[d.length-1]+(g?o:0)}}),!r)return this;for(h=[],c=0;c<t.length;c++)if(typeof i[c]<"u")for(u=0;u<i[c].length;u++)h.push(i[c][u]);else h.push(t[c]);return this.segments=h,this};ur.prototype.abs=function(){return this.iterate(function(n,e,t,i){var r=n[0],s=r.toUpperCase(),o;if(r!==s)switch(n[0]=s,r){case"v":n[1]+=i;return;case"a":n[6]+=t,n[7]+=i;return;default:for(o=1;o<n.length;o++)n[o]+=o%2?t:i}},!0),this};ur.prototype.rel=function(){return this.iterate(function(n,e,t,i){var r=n[0],s=r.toLowerCase(),o;if(r!==s&&!(e===0&&r==="M"))switch(n[0]=s,r){case"V":n[1]-=i;return;case"A":n[6]-=t,n[7]-=i;return;default:for(o=1;o<n.length;o++)n[o]-=o%2?t:i}},!0),this};ur.prototype.unarc=function(){return this.iterate(function(n,e,t,i){var r,s,o,a=[],l=n[0];return l!=="A"&&l!=="a"?null:(l==="a"?(s=t+n[6],o=i+n[7]):(s=n[6],o=n[7]),r=kIe(t,i,s,o,n[4],n[5],n[1],n[2],n[3]),r.length===0?[[n[0]==="a"?"l":"L",n[6],n[7]]]:(r.forEach(function(c){a.push(["C",c[2],c[3],c[4],c[5],c[6],c[7]])}),a))}),this};ur.prototype.unshort=function(){var n=this.segments,e,t,i,r,s;return this.iterate(function(o,a,l,c){var u=o[0],h=u.toUpperCase(),d;a&&(h==="T"?(d=u==="t",i=n[a-1],i[0]==="Q"?(e=i[1]-l,t=i[2]-c):i[0]==="q"?(e=i[1]-i[3],t=i[2]-i[4]):(e=0,t=0),r=-e,s=-t,d||(r+=l,s+=c),n[a]=[d?"q":"Q",r,s,o[1],o[2]]):h==="S"&&(d=u==="s",i=n[a-1],i[0]==="C"?(e=i[3]-l,t=i[4]-c):i[0]==="c"?(e=i[3]-i[5],t=i[4]-i[6]):(e=0,t=0),r=-e,s=-t,d||(r+=l,s+=c),n[a]=[d?"c":"C",r,s,o[1],o[2],o[3],o[4]]))}),this};var LIe=ur,NIe=LIe;const SA=Ld(NIe);function BIe(n){let e=0,t=0,i=0,r=0;const s=[];for(const{key:o,data:a}of n)switch(o){case"M":s.push({key:"M",data:[...a]}),[e,t]=a,[i,r]=a;break;case"m":e+=a[0],t+=a[1],s.push({key:"M",data:[e,t]}),i=e,r=t;break;case"L":s.push({key:"L",data:[...a]}),[e,t]=a;break;case"l":e+=a[0],t+=a[1],s.push({key:"L",data:[e,t]});break;case"C":s.push({key:"C",data:[...a]}),e=a[4],t=a[5];break;case"c":{const l=a.map((c,u)=>u%2?c+t:c+e);s.push({key:"C",data:l}),e=l[4],t=l[5];break}case"Q":s.push({key:"Q",data:[...a]}),e=a[2],t=a[3];break;case"q":{const l=a.map((c,u)=>u%2?c+t:c+e);s.push({key:"Q",data:l}),e=l[2],t=l[3];break}case"A":s.push({key:"A",data:[...a]}),e=a[5],t=a[6];break;case"a":e+=a[5],t+=a[6],s.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],e,t]});break;case"H":s.push({key:"H",data:[...a]}),e=a[0];break;case"h":e+=a[0],s.push({key:"H",data:[e]});break;case"V":s.push({key:"V",data:[...a]}),t=a[0];break;case"v":t+=a[0],s.push({key:"V",data:[t]});break;case"S":s.push({key:"S",data:[...a]}),e=a[2],t=a[3];break;case"s":{const l=a.map((c,u)=>u%2?c+t:c+e);s.push({key:"S",data:l}),e=l[2],t=l[3];break}case"T":s.push({key:"T",data:[...a]}),e=a[0],t=a[1];break;case"t":e+=a[0],t+=a[1],s.push({key:"T",data:[e,t]});break;case"Z":case"z":s.push({key:"Z",data:[]}),e=i,t=r;break}return s}function FIe(n){const e=[];let t="",i=0,r=0,s=0,o=0,a=0,l=0;for(const{key:c,data:u}of n){switch(c){case"M":e.push({key:"M",data:[...u]}),[i,r]=u,[s,o]=u;break;case"C":e.push({key:"C",data:[...u]}),i=u[4],r=u[5],a=u[2],l=u[3];break;case"L":e.push({key:"L",data:[...u]}),[i,r]=u;break;case"H":i=u[0],e.push({key:"L",data:[i,r]});break;case"V":r=u[0],e.push({key:"L",data:[i,r]});break;case"S":{let h=0,d=0;t==="C"||t==="S"?(h=i+(i-a),d=r+(r-l)):(h=i,d=r),e.push({key:"C",data:[h,d,...u]}),a=u[0],l=u[1],i=u[2],r=u[3];break}case"T":{const[h,d]=u;let f=0,p=0;t==="Q"||t==="T"?(f=i+(i-a),p=r+(r-l)):(f=i,p=r);const g=i+2*(f-i)/3,m=r+2*(p-r)/3,v=h+2*(f-h)/3,_=d+2*(p-d)/3;e.push({key:"C",data:[g,m,v,_,h,d]}),a=f,l=p,i=h,r=d;break}case"Q":{const[h,d,f,p]=u,g=i+2*(h-i)/3,m=r+2*(d-r)/3,v=f+2*(h-f)/3,_=p+2*(d-p)/3;e.push({key:"C",data:[g,m,v,_,f,p]}),a=h,l=d,i=f,r=p;break}case"A":{const h=Math.abs(u[0]),d=Math.abs(u[1]),f=u[2],p=u[3],g=u[4],m=u[5],v=u[6];h===0||d===0?(e.push({key:"C",data:[i,r,m,v,m,v]}),i=m,r=v):(i!==m||r!==v)&&(e9(i,r,m,v,h,d,f,p,g).forEach(function(y){e.push({key:"C",data:y})}),i=m,r=v);break}case"Z":e.push({key:"Z",data:[]}),i=s,r=o;break}t=c}return e}function UIe(n){return Math.PI*n/180}function H_(n,e,t){const i=n*Math.cos(t)-e*Math.sin(t),r=n*Math.sin(t)+e*Math.cos(t);return[i,r]}function e9(n,e,t,i,r,s,o,a,l,c){const u=UIe(o);let h=[],d=0,f=0,p=0,g=0;if(c)[d,f,p,g]=c;else{[n,e]=H_(n,e,-u),[t,i]=H_(t,i,-u);const F=(n-t)/2,G=(e-i)/2;let B=F*F/(r*r)+G*G/(s*s);B>1&&(B=Math.sqrt(B),r=B*r,s=B*s);const R=a===l?-1:1,P=r*r,k=s*s,L=P*k-P*G*G-k*F*F,H=P*G*G+k*F*F,U=R*Math.sqrt(Math.abs(L/H));p=U*r*G/s+(n+t)/2,g=U*-s*F/r+(e+i)/2,d=Math.asin(parseFloat(((e-g)/s).toFixed(9))),f=Math.asin(parseFloat(((i-g)/s).toFixed(9))),n<p&&(d=Math.PI-d),t<p&&(f=Math.PI-f),d<0&&(d=Math.PI*2+d),f<0&&(f=Math.PI*2+f),l&&d>f&&(d=d-Math.PI*2),!l&&f>d&&(f=f-Math.PI*2)}let m=f-d;if(Math.abs(m)>Math.PI*120/180){const F=f,G=t,B=i;l&&f>d?f=d+Math.PI*120/180*1:f=d+Math.PI*120/180*-1,t=p+r*Math.cos(f),i=g+s*Math.sin(f),h=e9(t,i,G,B,r,s,o,0,l,[f,F,p,g])}m=f-d;const v=Math.cos(d),_=Math.sin(d),y=Math.cos(f),A=Math.sin(f),w=Math.tan(m/4),b=4/3*r*w,C=4/3*s*w,I=[n,e],x=[n+b*_,e-C*v],T=[t+b*A,i-C*y],O=[t,i];if(x[0]=2*I[0]-x[0],x[1]=2*I[1]-x[1],c)return[x,T,O].concat(h);{h=[x,T,O].concat(h);const F=[];for(let G=0;G<h.length;G+=3){const B=H_(h[G][0],h[G][1],u),R=H_(h[G+1][0],h[G+1][1],u),P=H_(h[G+2][0],h[G+2][1],u);F.push([B[0],B[1],R[0],R[1],P[0],P[1]])}return F}}const GIe=0,qR=1,t9=2,mw={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function HIe(n){const e=[];for(;n!=="";)if(n.match(/^([ \t\r\n,]+)/))n=n.substr(RegExp.$1.length);else if(n.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:GIe,text:RegExp.$1},n=n.substr(RegExp.$1.length);else if(n.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))e[e.length]={type:qR,text:`${parseFloat(RegExp.$1)}`},n=n.substr(RegExp.$1.length);else return[];return e[e.length]={type:t9,text:""},e}function l1(n,e){return n.type===e}function n9(n){const e=[],t=HIe(n);let i="BOD",r=0,s=t[r];for(;!l1(s,t9);){let o=0;const a=[];if(i==="BOD")if(s.text==="M"||s.text==="m")r++,o=mw[s.text],i=s.text;else return n9("M0,0"+n);else l1(s,qR)?o=mw[i]:(r++,o=mw[s.text],i=s.text);if(r+o<t.length){for(let l=r;l<r+o;l++){const c=t[l];if(l1(c,qR))a[a.length]=+c.text;else throw new Error("Param not a number: "+i+","+c.text)}if(typeof mw[i]=="number"){const l={key:i,data:a};e.push(l),r+=o,s=t[r],i==="M"&&(i="L"),i==="m"&&(i="l")}else throw new Error("Bad segment: "+i)}else throw new Error("Path data ended short")}return e}function VIe(n,e){return Math.sqrt(Vx(n,e))}function Vx(n,e){return Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)}function zIe(n,e,t){const i=Vx(e,t);if(i===0)return Vx(n,e);let r=((n[0]-e[0])*(t[0]-e[0])+(n[1]-e[1])*(t[1]-e[1]))/i;return r=Math.max(0,Math.min(1,r)),Vx(n,hf(e,t,r))}function hf(n,e,t){return[n[0]+(e[0]-n[0])*t,n[1]+(e[1]-n[1])*t]}function $Ie(n,e){const t=n[e+0],i=n[e+1],r=n[e+2],s=n[e+3];let o=3*i[0]-2*t[0]-s[0];o*=o;let a=3*i[1]-2*t[1]-s[1];a*=a;let l=3*r[0]-2*s[0]-t[0];l*=l;let c=3*r[1]-2*s[1]-t[1];return c*=c,o<l&&(o=l),a<c&&(a=c),o+a}function KR(n,e,t,i){const r=i||[];if($Ie(n,e)<t){const s=n[e+0];r.length?VIe(r[r.length-1],s)>1&&r.push(s):r.push(s),r.push(n[e+3])}else{const o=n[e+0],a=n[e+1],l=n[e+2],c=n[e+3],u=hf(o,a,.5),h=hf(a,l,.5),d=hf(l,c,.5),f=hf(u,h,.5),p=hf(h,d,.5),g=hf(f,p,.5);KR([o,u,f,g],0,t,r),KR([g,p,d,c],0,t,r)}return r}function WIe(n,e){return HC(n,0,n.length,e)}function HC(n,e,t,i,r){const s=r||[],o=n[e],a=n[t-1];let l=0,c=1;for(let u=e+1;u<t-1;++u){const h=zIe(n[u],o,a);h>l&&(l=h,c=u)}return Math.sqrt(l)>i?(HC(n,e,c+1,i,s),HC(n,c,t,i,s)):(s.length||s.push(o),s.push(a)),s}function jIe(n,e=.15,t){const i=[],r=(n.length-1)/3;for(let s=0;s<r;s++){const o=s*3;KR(n,o,e,i)}return t&&t>0?HC(i,0,i.length,t):i}function QIe(n,e,t){const i=n9(n),r=FIe(BIe(i)),s=[];let o=[],a=[0,0],l=[];const c=()=>{l.length>=4&&o.push(...jIe(l,e)),l=[]},u=()=>{c(),o.length&&(s.push(o),o=[])};for(const{key:d,data:f}of r)switch(d){case"M":u(),a=[f[0],f[1]],o.push(a);break;case"L":c(),o.push([f[0],f[1]]);break;case"C":if(!l.length){const p=o.length?o[o.length-1]:a;l.push([p[0],p[1]])}l.push([f[0],f[1]]),l.push([f[2],f[3]]),l.push([f[4],f[5]]);break;case"Z":c(),o.push([a[0],a[1]]);break}if(u(),!t)return s;const h=[];for(const d of s){const f=WIe(d,t);f.length&&h.push(f)}return h}const XIe=(n,e)=>{var s;const t=n.getOriginalPoints(),i=r9(t);let r=i;return e&&(r=i9(i,n,e)),(s=n.exportOption)!=null&&s.removeSamePoint&&(r=ZIe(r)),[r]},YIe=n=>{const e=[],t=KIe(n);return t&&t.length>0&&t.forEach(i=>{const r=JIe(i);e.push(r)}),e},qIe=(n,e=1,t=!1,i=!0,r=0,s=0,o=3)=>{let a="";for(let l=0;l<n.length;l++){for(let c=0;c<n[l].length;c++){const u=t&&![0,n[l].length-1].includes(c);c?a+=u?"Q":"L":a+="M",a+=u?`${r+(n[l][c].x+n[l][c-1].x)/2/e} ${s+(n[l][c].y+n[l][c-1].y)/2/e} ${r+(n[l][c].x+n[l][c+1].x)/2/e} ${s+(n[l][c].y+n[l][c+1].y)/2/e}`:`${r+Number((n[l][c].x/e).toFixed(o))}, ${s+Number((n[l][c].y/e).toFixed(o))}`}i&&(a+="Z")}return a===""&&(a="M0,0"),a},KIe=n=>n.match(/([Mm][^mM]*)+?/g)||[],JIe=(n,e=!1)=>{let i=(QIe(n)[0]||[]).map(r=>new Ae(r[0],r[1]));return e&&(i=i.reverse()),i},ZIe=n=>{const e=new Map;for(const t of n){const i=`${t.x}-${t.y}`;(!e.has(i)||e.get(i).y!==t.y)&&e.set(i,t)}return[...e.values()]},i9=(n,e,t)=>{const i=e.toGlobal(new Ae(0,0)),{x:r,y:s}=t.toLocal({x:i.x,y:i.y}),o=new Dt,a=e.toJSON(t),{pivot:l,scale:c,angle:u,skew:h}=a;o.setTransform(r,s,l.x,l.y,c.x,c.y,u*Yo,h.x,h.y);for(let d=0;d<n.length;d++)n[d]&&o.apply(n[d],n[d]);return n},r9=n=>{const e=[];for(let t=0;t<n.length/2;t++){if(isNaN(n[t])||typeof n[t]!="number"){console.log("pathPointUtils combinePoints points is NaN!!");continue}const i={x:n[t*2],y:n[t*2+1]};e.push(i)}return e};function Xp(n,e,t){const i=s9(e);return t?i.forEach(r=>n.addPointMatrix(t,r)):i.forEach(r=>n.addPoint(r)),n}function s9(n,e){const t=[new Ae(n.x,n.y),new Ae(n.x+n.width,n.y),new Ae(n.x+n.width,n.y+n.height),new Ae(n.x,n.y+n.height)];return e&&t.forEach(i=>e.apply(i,i)),t}function AH(n,e){const t=new oi;return Xp(t,n,e),n.copyFrom(t.getRectangle()),n}function c1(n){return new Pt(n.minX,n.minY,n.maxX-n.minX,n.maxY-n.minY)}function eSe(n,e){const t=[new Ae(n.minX,n.minY),new Ae(n.maxX,n.minY),new Ae(n.maxX,n.maxY),new Ae(n.minX,n.maxY)];return e&&t.forEach(i=>e.apply(i,i)),t}function tSe(n,e){return Fp(e)?n:{minX:sd(n.minX,e),maxX:sd(n.maxX,e),minY:sd(n.minY,e),maxY:sd(n.maxY,e)}}function nSe(n,e,t=.001){const{minX:i,minY:r,maxX:s,maxY:o}=n;return i-t<=e.x&&s+t>=e.x&&r-t<=e.y&&o+t>=e.y}class iSe{constructor(e,t){E(this,"map",new Map);if(e){let i=0;for(const r of e){const s=(t==null?void 0:t(r,i,e))??r;this.add(s,r),i++}}}[Symbol.iterator](){return this.values()}add(e,t){let i=this.map.get(e);i?this._isList(i)?this._listAddValue(i,t):(i=this._toList(i),this._listAddValue(i,t),this.map.set(e,i)):(i=t,this.map.set(e,i))}has(e,t){if(this.map.has(e)){const i=this.map.get(e);return this._isList(i)?this._listHasValue(i,t):i===t}else return!1}delete(e,t){if(this.has(e,t)){const i=this.map.get(e);if(this._isList(i))if(this._listDeleteValue(i,t)){const r=this._listSize(i);if(r===1)return this.map.set(e,i[0]),!0;if(r===0)return this.map.delete(e)}else return!1;else return this.map.delete(e)}return!1}hasValue(e){for(const t of this.map.keys())if(this.has(t,e))return!0;return!1}deleteValue(e){for(const t of this.map.keys())if(this.delete(t,e))return!0;return!1}hasKey(e){return this.map.has(e)}getKey(e){return this._toList(this.map.get(e))}deleteKey(e){return this.map.delete(e)}*iterateKeyList(){for(const e of this.map.keys()){let t=this.map.get(e);t&&(t=this._toList(t),yield{key:e,list:t})}}*keys(){yield*this.map.keys()}*values(){for(const{list:e}of this.iterateKeyList())yield*e}*entries(){for(const{list:e,key:t}of this.iterateKeyList())for(const i of e)yield[t,i]}get size(){let e=0;for(const{list:t}of this.iterateKeyList())e+=this._listSize(t);return e}forEach(e,t){t&&(e=e.bind(t));for(const[i,r]of this.entries())e(r,i,this)}}class o9 extends iSe{_listHasValue(e,t){return e.has(t)}_listAddValue(e,t){e.add(t)}_listDeleteValue(e,t){return e.delete(t)}_listSize(e){return e.size}_isList(e){return e instanceof Set}_toList(e){return this._isList(e)?new Set(e):e!==void 0?new Set([e]):new Set}}class xh{constructor(e,t){E(this,"bbox",new oi);E(this,"_matrix");E(this,"dirtyID");E(this,"currentBBox");this.currentBBox=this.bbox,this.dirtyID=0,e&&this.setBBox(e,t)}get minX(){return this.bbox.minX}set minX(e){this.bbox.minX=e}get maxX(){return this.bbox.maxX}set maxX(e){this.bbox.maxX=e}get minY(){return this.bbox.minY}set minY(e){this.bbox.minY=e}get maxY(){return this.bbox.maxY}set maxY(e){this.bbox.maxY=e}get matrix(){return this._matrix}set matrix(e){this._matrix=e&&(this._matrix??new Dt).copyFrom(e),this.dirtyID++}getBounds(){return this.bbox}getMatrixBounds(){return this.dirtyID&&(this.dirtyID=0,this.matrix?(this.currentBBox=new oi,this.currentBBox.addBoundsMatrix(this.bbox,this.matrix)):this.currentBBox=this.bbox),this.currentBBox}setBBox(e,t){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this.matrix=t,this}setMinMax(e,t,i){return this.minX=e.x,this.minY=e.y,this.maxX=t.x,this.maxY=t.y,this.matrix=i,this}setBounds(e,t){return this.bbox.clear(),this.bbox.addBounds(e),this.matrix=t,this}contains(e){return this.matrix&&(e=this.matrix.applyInverse(e)),nSe(this.bbox,e)}toPoints(){return eSe(this.bbox,this.matrix)}}function a9(n=ms){return gr(n,["maxLength","minSegments","maxSegments"])}function PA(n,e=ms){const t=i=>isFinite(i)&&i>0;t(n.maxLength)&&(e.maxLength=n.maxLength),t(n.minSegments)&&(e.minSegments=n.minSegments),t(n.maxSegments)&&(e.maxSegments=n.maxSegments)}function rSe(n,e,t=ms){if(!e)return;const i=a9(t);PA(e,t);try{return n()}catch(r){console.error(r)}finally{PA(i,t)}}function l9(n,e){const t=new oi;if(n){const i=n.width*n.height;for(let r=0;r<i-1;r++)if(n.data[r*4+3]){const o=r%n.width,a=Math.floor(r/n.width),l=new Ae(o,a);e?t.addPointMatrix(e,l):t.addPoint(l)}}return t.isEmpty()?new Pt(0,0,0,0):t.getRectangle()}class kf{constructor(e=0,t=0,i=0){E(this,"x");E(this,"y");E(this,"z");this.x=e,this.y=t,this.z=i}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){const e=this.length();return e===0?new kf(0,0,0):new kf(this.x/e,this.y/e,this.z/e)}minus(e){return new kf(this.x-e.x,this.y-e.y,this.z-e.z)}multiply(e){return new kf(this.x*e,this.y*e,this.z*e)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}}function bH(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.sqrt(t*t+i*i)}function sSe(n,e,t){const i=new kf(t.x-e.x,t.y-e.y),r=i.normalize(),s=new kf(n.x-e.x,n.y-e.y),o=r.multiply(s.dot(r)),a=s.minus(o);return o.length()>i.length()||o.dot(i)<0?Math.min(bH(n,e),bH(n,t)):a.length()}function oSe(n,e,t){const{x:i,y:r}=n,{x:s,y:o}=e,{x:a,y:l}=t,c=i-s,u=r-o,h=a-s,d=l-o,f=c*h+u*d,p=h*h+d*d,g=f/p;let m,v;g<0?(m=s,v=o):g>1?(m=a,v=l):(m=s+g*h,v=o+g*d);const _=Math.sqrt(Math.pow(i-m,2)+Math.pow(r-v,2));return{x:m,y:v,distance:_}}function wH(n,e){let t=1/0;const i=e;for(let r=0;r<i.length;r++){const s=r+1>=i.length?(r+1)%i.length:r+1,o=sSe(n,i[r],i[s]);t=Math.min(t,o)}return t}function c9(n,e){const t=n.x-e.x,i=n.y-e.y,r=e.x-t,s=e.y-i;return new Ae(r,s)}function aSe(n,e,t){const i=n.x-t.x,r=n.y-t.y,s=e.x-t.x,o=e.y-t.y,a=Math.sqrt(Math.pow(i,2)+Math.pow(r,2)),l=Math.sqrt(Math.pow(s,2)+Math.pow(o,2)),c=t.x-l/a*i,u=t.y-l/a*r;return new Ae(c,u)}function JR(n,e,t){const i=new Ae,r=new Ae,s=20;if(!n&&!t||n.x===t.x)return i.x=e.x,i.y=e.y-s,r.x=e.x,r.y=e.y+s,{cp1:i,cp2:r};if(n.y===t.y)return i.x=e.x-s,i.y=e.y,r.x=e.x+s,r.y=e.y,{cp1:i,cp2:r};const o=(t.y-n.y)/(t.x-n.x),a=t.x-n.x,l=t.y-n.y,c=Math.sqrt(a*a+l*l),u=4;return t.x>=n.x?(i.x=e.x-c/(u*Math.sqrt(o*o+1)),i.y=e.y-c*o/(u*Math.sqrt(o*o+1)),r.x=e.x+c/(u*Math.sqrt(o*o+1)),r.y=e.y+c*o/(u*Math.sqrt(o*o+1))):(i.x=e.x+c/(u*Math.sqrt(o*o+1)),i.y=e.y+c*o/(u*Math.sqrt(o*o+1)),r.x=e.x-c/(u*Math.sqrt(o*o+1)),r.y=e.y-c*o/(u*Math.sqrt(o*o+1))),{cp1:i,cp2:r}}function vw(n,e,t){const i=new Ae,r=new Ae,s=20;if(!n&&!t||n.x===t.x)return i.x=e.x,i.y=e.y-s*2,r.x=e.x,r.y=e.y+s,{cp1:i,cp2:r};if(n.y===t.y)return i.x=e.x-s*2,i.y=e.y,r.x=e.x+s,r.y=e.y,{cp1:i,cp2:r};const o=(t.y-n.y)/(t.x-n.x),a=t.x-n.x,l=t.y-n.y,c=Math.sqrt(a*a+l*l),u=2,h=4;return t.x>=n.x?(i.x=e.x-c/(u*Math.sqrt(o*o+1)),i.y=e.y-c*o/(u*Math.sqrt(o*o+1)),r.x=e.x+c/(h*Math.sqrt(o*o+1)),r.y=e.y+c*o/(h*Math.sqrt(o*o+1))):(i.x=e.x+c/(u*Math.sqrt(o*o+1)),i.y=e.y+c*o/(u*Math.sqrt(o*o+1)),r.x=e.x-c/(h*Math.sqrt(o*o+1)),r.y=e.y-c*o/(h*Math.sqrt(o*o+1))),{cp1:i,cp2:r}}function Dd(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.sqrt(t*t+i*i)}function VC(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.atan2(i,t)}function lSe(n,e,t=iIe(.001)){return Math.abs(n-e)%Math.PI<t}function cSe(n,e,t=1e-6){return n&&e&&Math.abs(n.x-e.x)<t&&Math.abs(n.y-e.y)<t}function u9(n,e,t=1e-6){return n&&e&&Math.abs(n[0]-e[0])<t&&Math.abs(n[1]-e[1])<t}function ZR(n,e,t={x:0,y:0}){const i=n.x-t.x,r=n.y-t.y,s=i*Math.cos(e)-r*Math.sin(e),o=r*Math.cos(e)+i*Math.sin(e);return{x:s+t.x,y:o+t.y}}function uSe(n,e,t={x:0,y:0}){const{x:i,y:r,width:s,height:o}=n,a={x:i+s/2,y:r+o/2},l=ZR(a,e,t),c={x:-s/2,y:-o/2},u=ZR(c,e);return{x:l.x+u.x,y:l.y+u.y}}function hSe(n){return new Promise((e,t)=>{const i=new Image;i.onload=()=>{e(i)},i.onerror=()=>{t()},i.src=n})}function dSe(n,e,t,i){const r=[],s=t.toGlobal(n),o=a=>{var u;const l=a.worldTransform.applyInverse(s);let c=!1;if(typeof a.hitTest=="function"?c=a.hitTest(l,i):typeof((u=a.hitArea)==null?void 0:u.contains)=="function"?c=a.hitArea.contains(l.x,l.y):typeof a.containsPoint=="function"&&(c=a.containsPoint(s)),c){r.push(a);return}};for(const a of e)o(a);return r}function fSe(n,e,t,i){const{x:r,y:s}=n,{x:o,y:a}=e,l=new xy(Math.min(r,o),Math.min(s,a),Math.abs(r-o),Math.abs(s-a)),c=l.hull,u=[],h=d=>{let f;d.hitArea&&d.hitArea.type!==void 0?(f=bSe(d,d.hitArea),f=f.map(v=>i.toLocal(v))):d.type===it.PEN||d.type===it.LINE?f=d.getRealPoints(i)[0]:(f=Xr.calculateTransformedCorners(d),f=f.map(v=>i.toLocal(v)));let p=f.some(v=>l.contains(v));if(p){u.push(d);return}const g=[];for(let v=0;v<f.length;v++)v===f.length-1?g.push([f[v],f[0]]):g.push([f[v],f[v+1]]);const m=[[c[0],c[1]],[c[1],c[2]],[c[2],c[3]],[c[3],c[0]]];if(p=xSe(g,m),p){u.push(d);return}};for(const d of t)h(d);return u}function m2(n){const e=t=>{if(t.parent)if(t.parent.children.length<=1){const i=t.parent;t.destroy(!0),e(i)}else t.destroy(!0);else t.destroy(!0)};e(n)}function pSe(n,e,t){const{x:i,y:r}=n,{x:s,y:o}=e,a=s-i,l=o-r,c=5;let u=[];return Math.abs(a)<c||Math.abs(l)<c?u=[t.sort((d,f)=>f.displayOrder-d.displayOrder)[0]]:u=t,u}function _d(n,e,t){const i=Dt.IDENTITY,{x:r,y:s}=n.getPointToRelativeElement(t),o=t.toGlobal(e),a=t.toGlobal(new Ae(r,s));i.translate(o.x-a.x,o.y-a.y),d2(n,i)}function v2(n,e,t){const{matrixByViewport:i,...r}=e;if(n.parseJSON(r),i&&n.parent){const s=t.worldTransform.clone(),o=n.parent.worldTransform.clone(),a=sh(o,s),l=sh(i.clone(),a.clone());n.transform.setFromMatrix(l)}}function xH(n,e){const{canvasSize:t,offset:i}=e||{},{width:r,height:s}=t||{},{x:o,y:a}=i||{},l=document.createElement("canvas"),c=o??0,u=a??0;return l.width=r??n.width,l.height=s??n.height,l.getContext("2d").putImageData(n,c,u),l}function gSe(n,e){const t=n.isClosePath;let i="";return mt(n.getRealPath)?i=n.getRealPath(e):i=qIe(n.getRealPoints(e),1,!1,t),i}function eD(n){if(n.getContext)return n.toDataURL("image/png",1);{const e=document.createElement("canvas");return e.width=n.naturalWidth,e.height=n.naturalHeight,e.getContext("2d").drawImage(n,0,0),e.toDataURL("image/png",1)}}function mSe(n,e){var i,r;const t=document.createElement("canvas");return e?(t.width=e.width,t.height=e.height,(r=t.getContext("2d"))==null||r.putImageData(n,-e.x,-e.y)):(t.width=n.width,t.height=n.height,(i=t.getContext("2d"))==null||i.putImageData(n,0,0)),t.toDataURL("image/png",1)}function vSe(n,e,t=1,i,r,s){const o=e.parent,a=e.visible,l=new mn,c=new mn;c.scale.set(t,t),l.addChild(c),c.addChild(e),e.visible=!0;const u=l.getLocalBounds();let h=document.createElement("canvas"),d=1;if(u.width<.5||u.height<.5)h.width=1,h.height=1;else{i=i??0;const{x:g,y:m,width:v,height:_}=l.getLocalBounds(),y=new Pt(g-i,m-i,v+i*2,_+i*2);if(!r&&e.mask&&e instanceof Ur){const C=x2(e,l);r=new Pt(C.x-g,C.y-m,C.width+i*2,C.height+i*2)}const A=(C,I,x)=>{const T=n.renderer.generateTexture(C,{region:I}),O=n.canvas(T,x);return T.destroy(!0),O},w=1;s=s??uI(),(y.width*w>s||y.height*w>s)&&(d=GC(y,{width:s,height:s}).width/y.width);const b=r??y;if((b.width*w<1||b.height*w<1)&&(d=GC(b,{width:1,height:1,fitMode:"cover"}).width/b.width),d!==1){l.width*=d,l.height*=d;const C=new Dt().scale(d,d);AH(y,C),r&&AH(r,C)}h=A(l,y,r)}o&&o.addChild(e),e.visible=a,window.canvas_debug.previewImage&&JY(h);const f=h.getContext("2d");return{imageData:f==null?void 0:f.getImageData(0,0,h.width,h.height),imageDataScale:d}}function tD(n){const{texture:{baseTexture:{resource:e}}}=n,t=e;if(!t.source)return null;const i=t.source;if(i.getContext){const o=i.getContext("2d");return{canvas:i,ctx:o}}const r=document.createElement("canvas");r.width=i.naturalWidth||0,r.height=i.naturalHeight||0;const s=r.getContext("2d");return s?(s.drawImage(i,0,0),{canvas:r,ctx:s}):null}function _Se(n,e,t){const{texture:{baseTexture:{resource:i}}}=n,r=i;if(!r.source)return null;const s=r.source,o=document.createElement("canvas");o.width=e,o.height=t;const a=o.getContext("2d");return a?(a.drawImage(s,0,0,e,t),{canvas:o,ctx:a}):null}function Yp(n,e){const t=Xr.calculateGroupOrientedBounds(n,0),i=new oi,r=e.toLocal(t.topLeft),s=e.toLocal(t.bottomRight);return i.minX=r.x,i.minY=r.y,i.maxX=s.x,i.maxY=s.y,i}function h9(n,e,t,i,r){const s=new oi;if(!tn(t)&&!tn(i))return s;const{minX:o,maxX:a,minY:l,maxY:c}=Yp(e,n),u=a-o,h=c-l,d=h/u;let f=tn(t)?t:u,p=tn(i)?i:h;r&&(t&&(p=f*d),i&&(f=p/d));const g=f-u,m=p-h;let v=new Ae(a+g,c+m);return v=n.toGlobal(v),s.minX=o,s.minY=l,s.maxX=v.x,s.maxY=v.y,s}function d9(n,e,t){const i=Xr.calculateGroupOrientedBounds(e,0),{topLeft:{x:r,y:s}}=i,{x:o,y:a}=n.toLocal({x:r,y:s}),{x:l=o,y:c=a}=t,{x:u,y:h}=n.toGlobal({x:l,y:c});return new Ae(u-r,h-s)}function mp(n,e){return n instanceof Ur&&n.mask?Xp(new oi,x2(n,e)):e?Yp([n],e):Xp(new oi,n.getBounds())}function ySe(n){return _2(n,i=>i.interactive)}function _2(n,e){const t=[],i=r=>{const{children:s=[]}=r;if(e&&e(r)){t.push(r);return}![it.TEXT,it.BITMAP].includes(r.type)&&s&&s.length>0?s.forEach(a=>{i(a)}):e?e(r)&&t.push(r):t.push(r)};return i(n),t}function ASe(n){const e=Qp.getInstance().enableFill;n.parseJSON({enableFill:e})}function gm(n){if(n===null)return n;if(n instanceof Date)return new Date(n.getTime());if(n instanceof Array){const e=[];return n.forEach(t=>{e.push(t)}),e.map(t=>gm(t))}if(n instanceof Object){const e={...n};for(const t in n)n.hasOwnProperty(t)&&(e[t]=gm(n[t]));return e}return n}function cI(n,e,t,i){const r=Math.min(t/n,i/e);return{width:Math.min(n*r,n),height:Math.min(e*r,e)}}function _w(n){const{srcWidth:e,srcHeight:t,scaleNum:i,maxWidth:r,maxHeight:s}=n;if(!isFinite(r)||!isFinite(s))return i;const{width:o,height:a}=cI(e*i,t*i,r,s),l=Math.min(o/e,a/t);return isFinite(l)?l:i}function f9(n){const e=[],t=n.filter(i=>{const r=i.isVaild&&!i.isVaild();return r||e.push(i),r});return{validDisplays:e,invalidDisplays:t}}function zx(n){const{validDisplays:e,invalidDisplays:t}=f9(n),i=[];return t.forEach(r=>{i.push({id:r.id}),r.destroy(),r=null}),{validDisplays:e,invalidData:i}}function p9(){return"g-"+Ui()}function nD(n){const e=p9();return n.forEach(t=>{t.groupTag=e}),e}function zC(n){const e=[],t={};return n.forEach(i=>{i.groupTag?(t[i.groupTag]||(t[i.groupTag]=[]),t[i.groupTag].push(i)):e.push(i)}),Object.values(t).forEach(i=>{i.length>1?e.push(i):e.push(i[0])}),e}function g9(n,e,t){zC(n).forEach(r=>{r=Rt(r)?r:[r];const s=r[0].groupTag,o={groupName:"",visible:!0,enableTransform:!0,zOrder:void 0},a=e[s]??o;nD(r);const l=r[0].groupTag;t[l]={...a,groupTag:l}})}function bSe(n,e=n.hitArea,t=n.worldTransform,i){if(i=i||[],e instanceof Pt)i.push(new Ae(e.x,e.y)),i.push(new Ae(e.x+e.width,e.y)),i.push(new Ae(e.x+e.width,e.y+e.height)),i.push(new Ae(e.x,e.y+e.height));else if(e instanceof qu)for(let r=0;r<e.points.length;r+=2)i.push(new Ae(e.points[r],e.points[r+1]));else if(e instanceof YT){const{x:r,y:s,radius:o}=e;i.push(new Ae(r-o,s-o)),i.push(new Ae(r+o,s-o)),i.push(new Ae(r+o,s+o)),i.push(new Ae(r-o,s+o))}for(let r=0;r<i.length;r++)t.apply(i[r],i[r]);return i}function wSe(n,e,t,i){n.x>e.x&&([n,e]=[e,n]),t.x>i.x&&([t,i]=[i,t]);const r=(u,h=1e-12)=>{const d=Math.abs(u);return d>=0&&d<=h?0:u},s=r(e.y-n.y)/r(e.x-n.x),o=r(i.y-t.y)/r(i.x-t.x),a=n.y-s*n.x,l=t.y-o*t.x;if(Math.abs(s)===1/0){const u=o*n.x+l,h=Math.min(n.y,e.y),d=Math.max(n.y,e.y);if(u>=h&&u<=d&&t.x<=n.x&&i.x>=n.x)return!0}if(Math.abs(o)===1/0){const u=s*t.x+a,h=Math.min(t.y,i.y),d=Math.max(t.y,i.y);if(u>=h&&u<=d&&n.x<=t.x&&e.x>=t.x)return!0}const c=(l-a)/(s-o);return c>=n.x&&c<=e.x&&c>=t.x&&c<=i.x}function xSe(n,e){for(let t=0;t<n.length;t++)for(let i=0;i<e.length;i++)if(wSe(n[t][0],n[t][1],e[i][0],e[i][1]))return!0;return!1}function u1(n,e){const{include:t=[],exclude:i=[]}=e||{};let r=n;return t.length>0&&(r=r.filter(s=>t.includes(s.type)?s:!1)),i.length>0&&(r=r.filter(s=>i.includes(s.type)?!1:s)),r}function CSe(n){return n=n.trim(),n.startsWith("data:img/")||n.startsWith("data:image/")}let h1;function ESe(){if(!h1){const n=document.createElement("canvas"),e=n.getContext("webgl2")??n.getContext("webgl");if(!e)return;h1=e.getParameter(e.MAX_TEXTURE_SIZE),e.getExtension("WEBGL_lose_context").loseContext()}return h1}function uI(){const n=[k9.maxSize,ESe()].filter(t=>typeof t=="number"&&isFinite(t)&&t>0);return Math.min(...n)}function lb(n){let e,t;return n instanceof HTMLImageElement?(e=n.naturalWidth,t=n.naturalHeight):(e=n.width,t=n.height),{width:e,height:t}}function TSe(n){const{width:e,height:t}=lb(n),i=uI();if(e>i||t>i){const{width:r,height:s}=cI(e,t,i,i),o=document.createElement("canvas");return o.width=Math.floor(r),o.height=Math.floor(s),o.getContext("2d").drawImage(n,0,0,o.width,o.height),o}else return n}function ISe(n){const{width:e,height:t}=lb(n),i=uI();return!(e>i||t>i)}function SSe(n,e,t){return new Dt().translate(-t.x,-t.y).rotate(e).translate(t.x,t.y).apply(n)}function PSe(n){return n.some(e=>e.lockRatio)}function MSe(n,e){const{alignType:t,cusCalcGroupBounds:i}=e;let r=We(e,"targetBounds");const s=new Map;r=r||Pl(n);const{x:o,y:a,width:l,height:c}=r,u=h=>Array.isArray(h)?h[0].groupTag:h.id;switch(t){case Tl.LEFT:n.forEach(h=>{s.set(u(h),{worldTargetX:o})});break;case Tl.RIGHT:n.forEach(h=>{const d=(i==null?void 0:i(h))||Pl(h);s.set(u(h),{worldTargetX:o+l-d.width})});break;case Tl.TOP:n.forEach(h=>{s.set(u(h),{worldTargetY:a})});break;case Tl.BOTTOM:n.forEach(h=>{const d=(i==null?void 0:i(h))||Pl(h);s.set(u(h),{worldTargetY:a+c-d.height})});break;case Tl.VERTICAL_CENTER:n.forEach(h=>{const d=(i==null?void 0:i(h))||Pl(h),f=o+l/2;s.set(u(h),{worldTargetX:f-d.width/2})});break;case Tl.HORIZONTAL_CENTER:n.forEach(h=>{const d=(i==null?void 0:i(h))||Pl(h),f=a+c/2;s.set(u(h),{worldTargetY:f-d.height/2})});break;case Tl.ALIGN_CENTER:n.forEach(h=>{const d=(i==null?void 0:i(h))||Pl(h),f=o+l/2,p=a+c/2;s.set(u(h),{worldTargetX:f-d.width/2,worldTargetY:p-d.height/2})});break;case Tl.HORIZONTAL_DISTRIBUTE:if(n.length>2){let h=0;const d=new Map;n.forEach(_=>{const y=(i==null?void 0:i(_))||Pl(_);h+=y.width,d.set(u(_),y)});const f=r.width-h,p=n.length-1,g=f/p,m=n.sort((_,y)=>d.get(u(_)).x-d.get(u(y)).x);let v=r.x;m.forEach(_=>{s.set(u(_),{worldTargetX:v});const y=d.get(u(_));v+=y.width+g})}break;case Tl.VERTICAL_DISTRIBUTE:if(n.length>2){let h=0;const d=new Map;n.forEach(_=>{const y=(i==null?void 0:i(_))||Pl(_);h+=y.height,d.set(u(_),y)});const f=r.height-h,p=n.length-1,g=f/p,m=n.sort((_,y)=>d.get(u(_)).y-d.get(u(y)).y);let v=r.y;m.forEach(_=>{s.set(u(_),{worldTargetY:v});const y=d.get(u(_));v+=y.height+g})}break}return s}function Pl(n){const e=Xr.calculateGroupOrientedBounds(Array.isArray(n)?n:[n],0,null,!0),t=e.topLeft.x,i=e.topLeft.y,r=e.bottomRight.x-t,s=e.bottomRight.y-i;return new Pt(t,i,r,s)}function m9(n){return{x:n[0],y:n[1]}}function RSe(n){return(n==null?void 0:n.type.match(/[CQ]/i))??!1}function Bh(n,e,t){const{type:i,values:r}=n;return i==="Q"?{x:r[0],y:r[1]}:i==="C"?e===1?{x:r[0],y:r[1]}:{x:r[2],y:r[3]}:e===1?m9(t):iD(n)}function iD({type:n,values:e}){return n!=="Z"?m9(e.slice(-2)):null}class rD{constructor(e){E(this,"_string","");E(this,"options");this.options=e}append(e){if(this._string){const{cmdSeparator:t=""}=this.options??{};this._string+=t}return this._string+=this.stringifyCommand(e),this}appendBatch(e){for(const t of e)this.append(t);return this}toString(){return this._string}stringifyCommand(e,t){const{type:i,values:r=[]}=e,{ptSeparator:s=","}=t??{};let o="";switch(i){case"M":case"L":case"Q":case"C":case"Z":o+=`${i}${CH(r,2,s," ")}`;break;case"A":o+=`${i}${CH(r,[2,3,2],s," ")}`;break;default:console.error("Invalid Command");break}return o}}function CH(n,e,t,i=""){if(!n.length)return"";const r=[];if(Array.isArray(e)?e.length>0:isFinite(e)&&e>0){let s=0;if(Array.isArray(e))for(const o of e)r.push(n.slice(s,s+=o).join(t));else for(;s<n.length;)r.push(n.slice(s,s+=e).join(t));s<n.length&&r.push(n.slice(s).join(t))}else r.push(n.join(t));return r.join(i)}const DSe={unArc:!1};class Hs{constructor(e){E(this,"options");E(this,"commands",[]);E(this,"_startPt");E(this,"_currentPt");this.options=Ln(pn(DSe),e)}toPathEditData(){return new Ry().fromPathData(this)}toString(e){return new rD(e).appendBatch(this.commands).toString()}addCommand({type:e,values:t}){switch(e){case"M":this.moveTo(...t);break;case"L":this.lineTo(...t);break;case"H":this.lineTo(t[0],this._currentPt[1]);break;case"V":this.lineTo(this._currentPt[0],t[0]);break;case"Q":this.quadraticCurveTo(...t);break;case"T":{let[i,r]=this._currentPt;const s=this.commands[this.commands.length-1];if(s&&s.type==="Q"){const l=Bh(s,1);i=2*this._currentPt[0]-l.x,r=2*this._currentPt[1]-l.y}const[o,a]=t;this.quadraticCurveTo(i,r,o,a);break}case"C":this.bezierCurveTo(...t);break;case"S":{let[i,r]=this._currentPt;const s=this.commands[this.commands.length-1];if(s&&(s.type==="C"||s.type==="S")){const u=Bh(s,2);i=2*this._currentPt[0]-u.x,r=2*this._currentPt[1]-u.y}const[o,a,l,c]=t;this.bezierCurveTo(i,r,o,a,l,c);break}case"A":this.ellipticalArcTo(...t);break;case"Z":this.closePath();break;default:console.error("Invalid Command:",e,t);break}}*iterateCommands(e){var s;const t=this.commands,{unArc:i}=e??this.options;let r;for(const o of t){if(o.type==="A"&&i&&r){const a=(s=r.values)==null?void 0:s.slice(-2);yield*this.convertArcToBeziers(o,a)}else yield o;r=o}}moveTo(e,t){this.commands.push({type:"M",values:[e,t]}),this._currentPt=this._startPt=[e,t]}lineTo(e,t){this.commands.push({type:"L",values:[e,t]}),this._currentPt=[e,t]}closePath(){this.commands.push({type:"Z",values:[]}),this._currentPt=this._startPt}quadraticCurveTo(e,t,i,r){this.commands.push({type:"Q",values:[e,t,i,r]}),this._currentPt=[i,r]}bezierCurveTo(e,t,i,r,s,o){this.commands.push({type:"C",values:[e,t,i,r,s,o]}),this._currentPt=[s,o]}ellipticalArcTo(e,t,i,r,s,o,a){const l={type:"A",values:[e,t,i,r,s,o,a]};if(!this.options.unArc)this.commands.push(l);else{const c=this.convertArcToBeziers(l,this._currentPt);this.commands.push(...c)}this._currentPt=[o,a]}convertArcToBeziers(e,t=[0,0]){const i={type:"M",values:t},r=new rD().appendBatch([i,e]).toString();try{const s=SA(r).unarc(),o=[];return s.iterate((a,l)=>{l!==0&&o.push(_9(a))}),o}catch(s){return console.error(s),[]}}unArc(){return this.commands=[...this.iterateCommands({unArc:!0})],this}rect(e,t,i,r){this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+r),this.lineTo(e,t+r),this.closePath()}roundRect(e,t,i,r,s){const[o,a]=Array.isArray(s)?s:[s,s];kSe(this,e,t,i,r,o,a)}circle(e,t,i){this.ellipse(e,t,i,i)}ellipse(e,t,i,r){this.moveTo(e-i,t),this.ellipticalArcTo(i,r,0,1,1,e+i,t),this.ellipticalArcTo(i,r,0,1,1,e-i,t)}arcTo(){}arc(){}ellipseArc(){}clear(){this.commands.length=0}transform(e,t){const i=v9(this,e,t);this.clear(),y9(i,this)}}function kSe(n,e,t,i,r,s,o){const a=.4477152502;n.moveTo(e+s,t),n.lineTo(e+i-s,t),n.bezierCurveTo(e+i-a*s,t,e+i,t+a*o,e+i,t+o),n.lineTo(e+i,t+r-o),n.bezierCurveTo(e+i,t+r-a*o,e+i-a*s,t+r,e+i-s,t+r),n.lineTo(e+s,t+r),n.bezierCurveTo(e+a*s,t+r,e,t+r-a*o,e,t+r-o),n.lineTo(e,t+o),n.bezierCurveTo(e,t+a*o,e+a*s,t,e+s,t),n.closePath()}function hI(n,e){const{matrix:t,pathData:i=new Hs,getMatrixOptions:r}=e??{},s=v9(n,t,r);return y9(s,i),i}function v9(n,e,t){const i=n instanceof SA?n:new SA(typeof n!="string"?n.toString():n);return e&&i.matrix(f2(e,t)),i}function _9(n){const e=n[0],t=[];for(let i=1;i<n.length;i++){const r=n[i];t.push(r)}return{type:e,values:t}}function y9(n,e=new Hs){return n.abs().iterate(t=>{const i=_9(t);e.addCommand(i)}),e}class Ry{constructor(){E(this,"contours",[])}getPoints(){return this.contours}setPoints(e){Array.isArray(e)&&(this.contours=e)}fromPathData(e){const t=this.contours,i=[];let r,s,o,a;const l=u=>{const{type:h,values:d}=u;switch(h){case"M":case"L":case"Q":case"C":{h==="M"&&c();const f=d.slice(-2),[p,g]=f;i.push({position:{x:p,y:g}}),h==="M"&&(a=f),o=f;break}case"Z":{if(a){const f=a;if(!u9(o,f)){const[p,g]=f;i.push({position:{x:p,y:g}})}c(),o=a=f}break}default:console.error("Invalid Command");break}},c=()=>{i.length&&(OSe(i),i.length>=2&&t.push([...i]),i.length=0)};for(const u of e.iterateCommands({unArc:!0}))EH(r,s,u,i,o),l(u),s=r,r=u;return EH(r,s,null,i,o),c(),this}*generateCommands(){const e=this.contours;for(const t of e){const i=t[0].position;yield{type:"M",values:[i.x,i.y]};for(let s=1;s<t.length;s++){const o=t[s].position,a=t[s].controlPoints,l=t[s-1].controlPoints,c=l&&l.length>1,u=(l==null?void 0:l[1])??t[s-1].position,h=(a==null?void 0:a[0])??o;a?c?yield{type:"C",values:[u.x,u.y,h.x,h.y,o.x,o.y]}:yield{type:"Q",values:[h.x,h.y,o.x,o.y]}:c?yield{type:"Q",values:[u.x,u.y,o.x,o.y]}:yield{type:"L",values:[o.x,o.y]}}const r=t[t.length-1].position;cSe(r,i)&&(yield{type:"Z",values:void 0})}}toPathData(){const e=new Hs;for(const t of this.generateCommands())e.addCommand(t);return e}toString(e){return new rD(e).appendBatch(this.generateCommands()).toString()}}function EH(n,e,t,i,r){if(!n||!i.length)return;const s=i.length-2,o=i.length-1,a=i[o],l=i[s];n.type==="C"||(t==null?void 0:t.type)==="C"?a&&!a.controlPoints&&(a.controlPoints=[Bh(n,2),(t&&Bh(t,1,r))??iD(n)],a.cpType=$x(a)):n.type==="Q"&&(e.type==="M"&&!RSe(t)?l&&!l.controlPoints&&(l.controlPoints=[Bh(e,2),Bh(n,1)],l.cpType=$x(l)):a&&l&&!l.controlPoints&&(a.controlPoints=[Bh(n,2),(t&&Bh(t,1,r))??iD(n)],a.cpType=$x(a)))}function OSe(n){if(!(n.length>=2))return;const e=n[0],t=n[n.length-1];if(e&&t&&u9([e.position.x,e.position.y],[t.position.x,t.position.y])){t.controlPoints&&(e.controlPoints?e.controlPoints[0]=t.controlPoints[0]:e.controlPoints=[t.controlPoints[0],{x:e.position.x,y:e.position.y}]);const i=$x(e);i&&(e.cpType=i),n[n.length-1]=pn(e)}}function $x(n){if(!n.controlPoints)return;const[e,t]=n.controlPoints,i=n.position;return lSe(VC(i,e),VC(i,t))?XR(Dd(i,e),Dd(i,t))?di.MIRROR_ANGLE_AND_LENGTH:di.MIRROR_ANGLE:di.NO_MIRRORING}function A9(n){var t,i;let e;switch(n.type){case it.LINE:e=LSe(n);break;case it.RECT:e=NSe(n);break;case it.CIRCLE:e=BSe(n);break;case it.POLYGON:"paintServers"in n?e=TH((t=n.geometry.graphicsData[0])==null?void 0:t.shape):e=FSe(n);break;case it.PEN:e=USe(n);break;case it.TEXT:e=HSe(n);break;case it.PATH:e=GSe(n);break;default:if(n instanceof hn){const r=(i=n.geometry.graphicsData[0])==null?void 0:i.shape;r&&(e=TH(r))}break}return e||(e=new Hs),e}function b9(n){var t;let e;switch(n.type){case it.PEN:e=n.getSVGData().attrs.d;break;case it.PATH:e=n.dPath;break;default:e=A9(n);break}return typeof e!="string"?((t=e.toString)==null?void 0:t.call(e))??"":e}function TH(n){switch(n.type){case Yn.POLY:return VSe(n);case Yn.RECT:return zSe(n);case Yn.RREC:return $Se(n);case Yn.CIRC:return WSe(n);case Yn.ELIP:return jSe(n);default:return new Hs}}function LSe(n){const{x1:e,x2:t,y1:i,y2:r}=n.getSVGData().attrs,s=new Hs;return s.moveTo(e,i),s.lineTo(t,r),s}function NSe(n){const{x:e,y:t,width:i,height:r,rx:s,ry:o}=n.getSVGData().attrs,a=new Hs;return!s||!o?a.rect(e,t,i,r):a.roundRect(e,t,i,r,[s,o]),a}function BSe(n){const e=n.getSVGData().attrs,{r:t}=e;let{rx:i=t,ry:r=t}=e;const s=df;i*=s,r*=s;const o=i,a=r,l=new Hs;return l.ellipse(o,a,i,r),l}function FSe(n){const e=new Hs,t=n.points;for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];i?e.lineTo(r,s):e.moveTo(r,s)}return n.isClosePath&&e.closePath(),e}function USe(n){return hI(n.getSVGData().attrs.d)}function GSe(n){return hI(n.dPath)}function HSe(n){const e=new Hs;return n.children.forEach(t=>{hI(t.dPath,{matrix:t.localTransform,pathData:e})}),e}function VSe(n){const e=new Hs,t=n.points;for(let i=0;i<t.length;i+=2){const r={x:t[i],y:t[i+1]};i===0?e.moveTo(r.x,r.y):e.lineTo(r.x,r.y)}return n.closeStroke&&e.closePath(),e}function zSe(n){const{x:e,y:t,width:i,height:r}=n,s=new Hs;return s.rect(e,t,i,r),s}function $Se(n){const{x:e,y:t,width:i,height:r,radius:s}=n,o=new Hs;return o.roundRect(e,t,i,r,[s,s]),o}function WSe(n){const{x:e,y:t,radius:i}=n,r=new Hs;return r.circle(e,t,i),r}function jSe(n){const{x:e,y:t,width:i,height:r}=n,s=i/2,o=r/2,a=new Hs;return a.ellipse(e+s,t+o,s,o),a}rn.prototype.type="";rn.prototype._id="";rn.prototype.lockRatio=!0;rn.prototype.isValid=!0;rn.prototype.enableFill=!0;rn.prototype.originColor="#000000";rn.prototype.isClosePath=!1;rn.prototype.exportOption={removeSamePoint:!0};rn.prototype.enableTransform=!0;rn.prototype.visibleState=!0;rn.prototype.lockState=!1;rn.prototype.resourceOrigin="";Object.defineProperty(rn.prototype,"id",{set:function(n){this._id=n},get:function(){return this._id||(this._id=Ui()),this._id}});Object.defineProperty(rn.prototype,"groupTag",{set:function(n){this._groupTag=n},get:function(){return this._groupTag||(this._groupTag=Ui()),this._groupTag}});rn.prototype.toJSON=function(n){const{id:e,name:t,type:i,lockRatio:r,isClosePath:s,zOrder:o,sourceId:a,groupTag:l,layerTag:c,layerColor:u,visible:h,originColor:d,enableTransform:f,visibleState:p,lockState:g,resourceOrigin:m}=this,{x:v,y:_}=this.getLocalBounds(),y=this.toGlobal(new Ae(v,_)),{x:A,y:w}=n.toLocal({x:y.x,y:y.y}),b=sh(this.worldTransform.clone(),n.worldTransform.clone()),C=new nb;XY(C,b);const{scale:I,skew:x,pivot:T,rotation:O}=C,F=n.toLocal(this.position,this.parent);return{id:e,name:t,type:i,x:A,y:w,angle:O*XT,scale:{x:I.x,y:I.y},skew:{x:x.x,y:x.y},pivot:{x:T.x,y:T.y},localSkew:{x:this.skew.x,y:this.skew.y},offsetX:F.x,offsetY:F.y,lockRatio:r,isClosePath:s,zOrder:o,sourceId:a,groupTag:l,layerTag:c,layerColor:u,visible:h,originColor:d,enableTransform:f,visibleState:p,lockState:g,resourceOrigin:m}};rn.prototype.getPointToRelativeElement=function(n){const{x:e,y:t}=this.getLocalBounds(),i=this.toGlobal(new Ae(e,t)),{x:r,y:s}=n.toLocal({x:i.x,y:i.y});return{x:r,y:s}};rn.prototype.parseJSON=function(n){const{x:e=this.x,y:t=this.y,pivot:i=this.pivot,scale:r=this.scale,angle:s=this.angle,skew:o=this.skew,id:a=this.id,name:l=this.name,type:c=this.type,lockRatio:u=this.lockRatio,isClosePath:h=this.isClosePath,layerTag:d=this.layerTag,layerColor:f=this.layerColor,visible:p=this.visible,originColor:g=this.originColor,enableTransform:m=this.enableTransform,visibleState:v=this.visibleState,lockState:_=this.lockState,resourceOrigin:y=this.resourceOrigin}=n,A=new Dt;a&&(this.id=a),["groupTag","zOrder","sourceId"].forEach(C=>{this[C]=n.hasOwnProperty(C)?n[C]:this[C]}),this.type=c,this.lockRatio=u,this.isClosePath=h,this.layerTag=d,this.layerColor=f,this.visible=p,this.originColor=g,this.enableTransform=m,this.visibleState=v,this.lockState=_,this.name=l,this.resourceOrigin=y;const b=s*Yo;A.setTransform(e,t,i.x,i.y,r.x,r.y,b,o.x,o.y),this.transform.setFromMatrix(A),this.emit(DC.ATTRS_CHANGED,n)};rn.prototype.toSVG=function(n){return TA(this.getSVGData(n))};rn.prototype.getSVGData=function(n){return{attrs:KY(this,n)}};rn.prototype.toPathData=function(){return A9(this)};rn.prototype.toPathString=function(){return b9(this)};rn.prototype.toPathEditData=function(){return this.toPathData().toPathEditData()};class Ud extends hn{constructor(t){super();E(this,"config");E(this,"anchorPoints",[]);E(this,"originWidth",0);E(this,"originHeight",0);E(this,"isFill",!1);E(this,"enableFill",Qp.getInstance().enableFill);E(this,"type",it.LINE);E(this,"lineTint",16777215);E(this,"lineTintAlpha",1);E(this,"fillTint",16777215);E(this,"fillTintAlpha",1);E(this,"isRedrawed",!1);this.interactive=!0,this.config=t||{...lI}}draw(){this.toggleFill(this.isFill)}addHitArea(t,i){if(t)this.hitArea=t;else{const{x:r,y:s,width:o,height:a}=this.getLocalBounds();i=i||1;const l=Math.max(o,i),c=Math.max(a,i);this.hitArea=new Pt(r-(l-o)/2,s-(c-a)/2,l,c)}}addLineHitArea(t,i,r=1){const s=Math.atan2(i.y-t.y,i.x-t.x),o=g=>parseFloat(g.toFixed(1)),a=o(Math.cos(s-.5*Math.PI)*r),l=o(Math.sin(s-.5*Math.PI)*r),c=o(Math.cos(s+.5*Math.PI)*r),u=o(Math.sin(s+.5*Math.PI)*r),h=new Ae(t.x+a,t.y+l),d=new Ae(t.x+c,t.y+u),f=new Ae(i.x+c,i.y+u),p=new Ae(i.x+a,i.y+l);this.hitArea=new qu([h,d,f,p])}start(t,i){this.emit(mo.DRAW_BEGIN,this),this.position.set(t.x,t.y)}end(t,i){this.toggleFill(this.isFill),this.done()}destroy(t){super.destroy(t)}done(){this.emit(mo.DRAW_DONE,this)}reDraw(){const{geometry:t}=this,i=16777215,r=1,s=16777215,o=1,{geometry:{graphicsData:a}}=this;a.forEach(l=>{l.fillStyle.color=s,l.fillStyle.alpha=o;const c=l.fillStyle.visible;l.fillStyle.visible=this.enableFill,c!==this.enableFill&&(this.isRedrawed=!1),l.lineStyle.color=i,l.lineStyle.alpha=r,l.lineStyle.native=!0,l.lineStyle.width=1,l.lineStyle.visible=!0}),this.isRedrawed||(t.invalidate(),this.isRedrawed=!0)}undo(){this.clear()}toggleFill(t=this.isFill,i=!0){this.isFill=t,t?this.setFillMode():this.setLineMode(),i&&this.reDraw()}setUpHoverEvent(){this.on("pointerover",this.highlightBound.bind(this)),this.on("pointerout",this.reset.bind(this))}highlightBound(){const{hoverColor:t}=this.config,{fillColor:i}=this.getRenderColor();this.changeColor({lineColor:t,isFill:this.isFill,fillColor:i}),this.line.color=t}reset(){const{lineColor:t,fillColor:i}=this.getRenderColor();this.changeColor({lineColor:t,fillColor:i,isFill:this.isFill}),this.line.color=t}getRenderColor(){let t=this.config.lineColor||0,i=this.config.fillColor||0;return this.layerColor&&(t=fA(this.layerColor),i=fA(this.layerColor)),{lineColor:t,fillColor:i}}changeColor(t){const{lineColor:i,fillColor:r,isFill:s=this.isFill}=t;this.lineTint=i,this.lineTintAlpha=1,this.fillTint=r,this.fillTintAlpha=this.enableFill&&s?1:0}setFillMode(){const{fillColor:t,lineColor:i}=this.getRenderColor();this.fill.color=t,this.line.color=i,this.changeColor({lineColor:i,fillColor:t,isFill:this.isFill})}setLineMode(){const{lineColor:t,fillColor:i}=this.getRenderColor();this.line.color=t,this.changeColor({lineColor:t,fillColor:i,isFill:this.isFill})}getRealBounds(t){this.finishPoly();const i=this.getRealPoints(),r=this.worldTransform,s=t??new oi;return i.forEach(o=>{for(let a=0;a<o.length;a++){const l=o[a];s.addPointMatrix(r,new Ae(l.x,l.y))}}),s}getOriginalPoints(){const{geometry:{graphicsData:t}}=this;let i=[];return t.forEach(r=>{const{points:s=[]}=r;i=i.concat(s.slice(0))}),i}getRealPoints(t){return XIe(this,t)}toJSON(t){const{width:i,height:r,isFill:s}=this;return{...super.toJSON(t),width:i,height:r,isFill:s,lineColor:this.config.lineColor,fillColor:this.config.fillColor}}parseJSON(t){const{width:i=this.width,height:r=this.height,scale:s=this.scale,isFill:o=this.isFill,lineColor:a=this.config.lineColor,fillColor:l=this.config.fillColor,enableFill:c=this.enableFill}=t;super.parseJSON(t),this.enableFill=c,Hu(t,["isFill","lineColor","fillColor","layerColor","layerTag","enableFill"])&&(this.isFill=o,this.config.lineColor=a,this.config.fillColor=l,this.toggleFill(o)),this.originWidth=i/s.x,this.originHeight=r/s.y}setDefaultColor(){this.config.fillColor=this.fill.color,this.config.lineColor=this.line.color,this.isFill=!!this.fill.visible}isVaild(){return this.isValid&&this.geometry.graphicsData.length>0&&(this.width>0||this.height>0)}getSVGData(t){const i=g2(this,t);return Ln(super.getSVGData(t),{attrs:i})}_renderDirect(t){const i=this._resolveDirectShader(t),r=this.geometry,s=this.worldAlpha,o=i.uniforms,a=r.drawCalls;o.translationMatrix=this.transform.worldTransform;const l=(u,h)=>{o.tint[0]=(u>>16&255)/255*h,o.tint[1]=(u>>8&255)/255*h,o.tint[2]=(u&255)/255*h,o.tint[3]=h};t.geometry.bind(r,i),t.state.set(this.state);const c=(u,h,d)=>{l(h,d),t.shader.bind(i),this._renderDrawCallDirect(t,u)};for(let u=0,h=a.length;u<h;u++){const d=r.drawCalls[u];if(d.type>=pa.TRIANGLES){const f=this.fillTintAlpha*s;c(d,this.fillTint,f)}else{const f=this.lineTintAlpha*s;c(d,this.lineTint,f)}}}}const df=100;class y2 extends Ud{constructor(e){super(),e&&this.parseJSON(e),this.type=it.CIRCLE,this.isClosePath=!0}start(e,t){super.start(e,t),this.smooth()}update(e,t){const{x:i,y:r}=this.position,{x:s,y:o}=e;let a=s-i,l=!1;t&&t.data.originalEvent.shiftKey&&(l=!0);let c=l?a:o-r;a*=df,c*=df,this.originWidth=Math.abs(a),this.originHeight=Math.abs(c),this.draw(new Ae(a/2,c/2))}draw(e=new Ae(0,0)){this.clear().lineStyle(Za),this.drawEllipse(e.x,e.y,this.originWidth/2,this.originHeight/2),super.draw(),this.enableFill||this.addHitArea()}transformUpdate(){const{geometry:{points:e}}=this,{width:t,height:i}=this.getBounds();if(i||t){const r=e.length/((Math.abs(t)+Math.abs(i))*2);r>0&&r<1&&this.smooth()}}toJSON(e){const t=super.toJSON(e),{scale:i}=t,{width:r,height:s}=this.getLocalBounds();return{...t,width:i.x*r,height:i.y*s}}parseJSON(e){const{width:t,height:i,scale:r}=e;!gi(t)&&!gi(i)&&!wt(r)&&(this.originWidth=t/r.x,this.originHeight=i/r.y,this.draw(new Ae(this.originWidth/2,this.originHeight/2))),super.parseJSON(e),Hu(e,["height","width"])&&this.transformUpdate()}end(e,t){const{position:{x:i,y:r}}=this,{x:s,y:o}=e;s<i&&(this.position.x=s),o<r&&(this.position.y=o),this.draw(new Ae(this.originWidth/2,this.originHeight/2)),super.end(e,t)}smooth(e=df){let{width:t,height:i}=this;this.clear(),t*=e,i*=e,this.originWidth=Math.abs(t),this.originHeight=Math.abs(i),this.scale.set(1/e),this.draw(new Ae(t/2,i/2))}embedCircle(e){var s,o,a,l,c,u;(o=(s=e.cx)==null?void 0:s.baseVal)==null||o.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),(l=(a=e.cy)==null?void 0:a.baseVal)==null||l.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),(u=(c=e.r)==null?void 0:c.baseVal)==null||u.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const t=e.cx.baseVal.valueInSpecifiedUnits,i=e.cy.baseVal.valueInSpecifiedUnits,r=e.r.baseVal.valueInSpecifiedUnits;this.originWidth=r*2,this.originHeight=r*2,this.position.x=t-r,this.position.y=i-r,this.draw(new Ae(r,r)),this.transform.updateLocalTransform(),this.smooth()}getSVGData(e){const t=super.getSVGData(e),i=this.originWidth/df/2,r=this.originHeight/df/2;return Ln(t,{tag:this.originWidth===this.originHeight?"circle":"ellipse",attrs:{transform:`${t.attrs.transform} scale(${df})`,cx:i,cy:r,...this.originWidth===this.originHeight?{r:i}:{rx:i,ry:r}}})}}const yw=.001,Aw=3;class $C extends Ud{constructor(t){super();E(this,"endPoint",new Ae(0,0));t&&(this.parseJSON(t),this.draw(),this.addLineHitArea(new Ae(0,0),this.endPoint,Aw)),this.type=it.LINE,this.isClosePath=!1,this.lockRatio=!1}update(t,i){const{x:r,y:s}=this.position;let o=t.x-r,a=t.y-s;i&&i.data.originalEvent.shiftKey&&(Math.abs(o)>Math.abs(a)?a=0:o=0),this.endPoint=new Ae(o,a),this.draw()}draw(){const{x:t,y:i}=this.endPoint;this.clear().lineStyle(Za).moveTo(0,0).lineTo(t,i).endFill(),super.draw()}transformCommit(){const{width:t,height:i}=this.getLocalBounds(),{width:r,height:s,scale:{x:o,y:a}}=this;t===yw&&(this.width=r/o,this.scale.x=1),i===yw&&(this.height=s/a,this.scale.y=1),this.draw()}end(t,i){const{position:{x:r,y:s}}=this,{x:o,y:a}=t;let l=o-r,c=a-s;i&&i.data.originalEvent.shiftKey&&(Math.abs(l)>Math.abs(c)?c=0:l=0),this.endPoint=new Ae(l,c),this.draw(),this.toggleFill(this.isFill),this.addLineHitArea(new Ae(0,0),this.endPoint,Aw),this.done()}toJSON(t){const{endPoint:i}=this;return{...super.toJSON(t),endPoint:{x:i.x,y:i.y}}}parseJSON(t){const{endPoint:i=this.endPoint}=t;super.parseJSON(t),this.endPoint=new Ae(i.x,i.y)}embedLine(t){t.x1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.y1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.x2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.y2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const i=t.x1.baseVal.valueInSpecifiedUnits,r=t.y1.baseVal.valueInSpecifiedUnits,s=t.x2.baseVal.valueInSpecifiedUnits,o=t.y2.baseVal.valueInSpecifiedUnits;this.x=i,this.y=r,this.endPoint=new Ae(s-i,o-r),this.draw(),this.addLineHitArea(new Ae(0,0),this.endPoint,Aw)}embedPolyline(t){const i=t.getAttribute("points").replace(/,/g," ").trim().split(/\s+/).map(l=>parseFloat(l)),[r,s,o,a]=i;this.x=r,this.y=s,this.endPoint=new Ae(o-r,a-s),this.draw(),this.addLineHitArea(new Ae(0,0),this.endPoint,Aw)}getLocalBounds(){const t=super.getLocalBounds(),{width:i,height:r}=t;return t.width=i||yw,t.height=r||yw,t}getSVGData(t){return Ln(super.getSVGData(t),{tag:"line",attrs:{x1:0,y1:0,x2:this.endPoint.x,y2:this.endPoint.y}})}}let od;function QSe(){return od&&new od}function XSe(n){try{n.delete()}catch{}}function MA(n){return od?n instanceof od:!1}async function YSe(){var o,a;const n=(o=await Pi(()=>import("./canvaskit-74p6ItzK.js").then(l=>l.canvaskit),__vite__mapDeps([2,1]),import.meta.url))==null?void 0:o.default,e=(a=await Pi(()=>import("./canvaskit-J6SzXV_D.js"),__vite__mapDeps([]),import.meta.url))==null?void 0:a.default,t=await n({locateFile:()=>e}),i={width:1,miter_limit:4,cap:t.StrokeCap.Square,join:t.StrokeJoin.Miter,precision:1},r=t.Path;class s extends r{constructor(){try{super()}catch{const u=new r;return Object.setPrototypeOf(u,s.prototype),u}}style(c){if(c){if(c.fill&&(c.mode==="stroke"||c.mode==="none"))return this;const{sx:u=1,sy:h=1,viewportScale:d=1}=c,f=1+Math.max(Math.log10(d),-.3),g={width:c.width*f,cap:t.StrokeCap.Square};this.transform(u,0,0,0,h,0,0,0,1),c.fill&&(c.mode==="fill"||c.mode==="all")?this.unionStroke(g):!c.fill&&(c.mode==="stroke"||c.mode==="all")?this.stroke(g):this.stroke(i),this.transform(1/u,0,0,0,1/h,0,0,0,1)}return this}stroke(c){return c&&c.visible!==!1&&super.stroke(c),this}unionStroke(c){const u=this.copy().stroke(c);return this.op(u,t.PathOp.Union),u.delete(),this}addFromSVGPathD(c){const u=t.Path.MakeFromSVGString(c);return this.addPath(u),u.delete(),this}closePath(){return this.close()}bezierCurveTo(c,u,h,d,f,p){return this.cubicTo(c,u,h,d,f,p)}quadraticCurveTo(c,u,h,d){return this.quadTo(c,u,h,d)}rect(){}roundRect(){}ellipticalArcTo(){}circle(){}ellipse(){}ellipseArc(){}}return s}let d1;async function qSe(){return od||(d1||(d1=YSe().then(n=>(od=n,od)).catch(console.warn)),d1)}class dI extends Ud{constructor(t,i={...lI}){super(i);E(this,"points",[]);E(this,"type",it.POLYGON);t&&(this.type=it.POLYGON,this.parseJSON(t),this.points=t.points.map(r=>Number(r)),this.draw())}toJSON(t){const i=super.toJSON(t),r=this.getOriginalPoints();return{...i,points:r}}draw(){if(this.points.length>0){const t=new qu(this.points);t.closeStroke=this.isClosePath,this.clear().lineStyle(Za).drawPolygon(t)}super.draw()}update(t,i){throw new Error("Method not implemented.")}getSVGData(t){const i=sIe(this.geometry,t);return Ln(super.getSVGData(t),{tag:this.isClosePath?"polygon":"polyline",attrs:{...i}})}}class KSe extends mn{done(){throw new Error("Method not implemented.")}clear(){this.children.forEach(e=>{e.clear()})}}var w9={exports:{}};(function(n){var e;function t(M,N){return M.b===N.b&&M.a===N.a}function i(M,N){return M.b<N.b||M.b===N.b&&M.a<=N.a}function r(M,N,D){var z=N.b-M.b,K=D.b-N.b;return 0<z+K?z<K?N.a-M.a+z/(z+K)*(M.a-D.a):N.a-D.a+K/(z+K)*(D.a-M.a):0}function s(M,N,D){var z=N.b-M.b,K=D.b-N.b;return 0<z+K?(N.a-D.a)*z+(N.a-M.a)*K:0}function o(M,N){return M.a<N.a||M.a===N.a&&M.b<=N.b}function a(M,N,D){var z=N.a-M.a,K=D.a-N.a;return 0<z+K?z<K?N.b-M.b+z/(z+K)*(M.b-D.b):N.b-D.b+K/(z+K)*(D.b-M.b):0}function l(M,N,D){var z=N.a-M.a,K=D.a-N.a;return 0<z+K?(N.b-D.b)*z+(N.b-M.b)*K:0}function c(M){return i(M.b.a,M.a)}function u(M){return i(M.a,M.b.a)}function h(M,N,D,z){return M=0>M?0:M,D=0>D?0:D,M<=D?D===0?(N+z)/2:N+M/(M+D)*(z-N):z+D/(M+D)*(N-z)}function d(M){var N=v(M.b);return y(N,M.c),y(N.b,M.c),A(N,M.a),N}function f(M,N){var D=!1,z=!1;M!==N&&(N.a!==M.a&&(z=!0,b(N.a,M.a)),N.d!==M.d&&(D=!0,C(N.d,M.d)),_(N,M),z||(y(N,M.a),M.a.c=M),D||(A(N,M.d),M.d.a=M))}function p(M){var N=M.b,D=!1;M.d!==M.b.d&&(D=!0,C(M.d,M.b.d)),M.c===M?b(M.a,null):(M.b.d.a=Re(M),M.a.c=M.c,_(M,Re(M)),D||A(M,M.d)),N.c===N?(b(N.a,null),C(N.d,null)):(M.d.a=Re(N),N.a.c=N.c,_(N,Re(N))),w(M)}function g(M){var N=v(M),D=N.b;return _(N,M.e),N.a=M.b.a,y(D,N.a),N.d=D.d=M.d,N=N.b,_(M.b,Re(M.b)),_(M.b,N),M.b.a=N.a,N.b.a.c=N.b,N.b.d=M.b.d,N.f=M.f,N.b.f=M.b.f,N}function m(M,N){var D=!1,z=v(M),K=z.b;return N.d!==M.d&&(D=!0,C(N.d,M.d)),_(z,M.e),_(K,N),z.a=M.b.a,K.a=N.a,z.d=K.d=M.d,M.d.a=K,D||A(z,M.d),z}function v(M){var N=new se,D=new se,z=M.b.h;return D.h=z,z.b.h=N,N.h=M,M.b.h=D,N.b=D,N.c=N,N.e=D,D.b=N,D.c=D,D.e=N}function _(M,N){var D=M.c,z=N.c;D.b.e=N,z.b.e=M,M.c=z,N.c=D}function y(M,N){var D=N.f,z=new Y(N,D);D.e=z,N.f=z,D=z.c=M;do D.a=z,D=D.c;while(D!==M)}function A(M,N){var D=N.d,z=new Ce(N,D);D.b=z,N.d=z,z.a=M,z.c=N.c,D=M;do D.d=z,D=D.e;while(D!==M)}function w(M){var N=M.h;M=M.b.h,N.b.h=M,M.b.h=N}function b(M,N){var D=M.c,z=D;do z.a=N,z=z.c;while(z!==D);D=M.f,z=M.e,z.f=D,D.e=z}function C(M,N){var D=M.a,z=D;do z.d=N,z=z.e;while(z!==D);D=M.d,z=M.b,z.d=D,D.b=z}function I(M){var N=0;return Math.abs(M[1])>Math.abs(M[0])&&(N=1),Math.abs(M[2])>Math.abs(M[N])&&(N=2),N}var x=4*1e150;function T(M,N){M.f+=N.f,M.b.f+=N.b.f}function O(M,N,D){return M=M.a,N=N.a,D=D.a,N.b.a===M?D.b.a===M?i(N.a,D.a)?0>=s(D.b.a,N.a,D.a):0<=s(N.b.a,D.a,N.a):0>=s(D.b.a,M,D.a):D.b.a===M?0<=s(N.b.a,M,N.a):(N=r(N.b.a,M,N.a),M=r(D.b.a,M,D.a),N>=M)}function F(M){M.a.i=null;var N=M.e;N.a.c=N.c,N.c.a=N.a,M.e=null}function G(M,N){p(M.a),M.c=!1,M.a=N,N.i=M}function B(M){var N=M.a.a;do M=we(M);while(M.a.a===N);return M.c&&(N=m(q(M).a.b,M.a.e),G(M,N),M=we(M)),M}function R(M,N,D){var z=new Ye;return z.a=D,z.e=Ne(M.f,N.e,z),D.i=z}function P(M,N){switch(M.s){case 100130:return(N&1)!==0;case 100131:return N!==0;case 100132:return 0<N;case 100133:return 0>N;case 100134:return 2<=N||-2>=N}return!1}function k(M){var N=M.a,D=N.d;D.c=M.d,D.a=N,F(M)}function L(M,N,D){for(M=N,N=N.a;M!==D;){M.c=!1;var z=q(M),K=z.a;if(K.a!==N.a){if(!z.c){k(M);break}K=m(N.c.b,K.b),G(z,K)}N.c!==K&&(f(Re(K),K),f(N,K)),k(M),N=z.a,M=z}return N}function H(M,N,D,z,K,ce){var ae=!0;do R(M,N,D.b),D=D.c;while(D!==z);for(K===null&&(K=q(N).a.b.c);z=q(N),D=z.a.b,D.a===K.a;)D.c!==K&&(f(Re(D),D),f(Re(K),D)),z.f=N.f-D.f,z.d=P(M,z.f),N.b=!0,!ae&&Q(M,N)&&(T(D,K),F(N),p(K)),ae=!1,N=z,K=D;N.b=!0,ce&&ve(M,N)}function U(M,N,D,z,K){var ce=[N.g[0],N.g[1],N.g[2]];N.d=null,N.d=M.o&&M.o(ce,D,z,M.c)||null,N.d===null&&(K?M.n||(he(M,100156),M.n=!0):N.d=D[0])}function $(M,N,D){var z=[null,null,null,null];z[0]=N.a.d,z[1]=D.a.d,U(M,N.a,z,[.5,.5,0,0],!1),f(N,D)}function j(M,N,D,z,K){var ce=Math.abs(N.b-M.b)+Math.abs(N.a-M.a),ae=Math.abs(D.b-M.b)+Math.abs(D.a-M.a),J=K+1;z[K]=.5*ae/(ce+ae),z[J]=.5*ce/(ce+ae),M.g[0]+=z[K]*N.g[0]+z[J]*D.g[0],M.g[1]+=z[K]*N.g[1]+z[J]*D.g[1],M.g[2]+=z[K]*N.g[2]+z[J]*D.g[2]}function Q(M,N){var D=q(N),z=N.a,K=D.a;if(i(z.a,K.a)){if(0<s(K.b.a,z.a,K.a))return!1;if(!t(z.a,K.a))g(K.b),f(z,Re(K)),N.b=D.b=!0;else if(z.a!==K.a){var D=M.e,ce=z.a.h;if(0<=ce){var D=D.b,ae=D.d,J=D.e,xe=D.c,Se=xe[ce];ae[Se]=ae[D.a],xe[ae[Se]]=Se,Se<=--D.a&&(1>=Se||i(J[ae[Se>>1]],J[ae[Se]])?je(D,Se):_e(D,Se)),J[ce]=null,xe[ce]=D.b,D.b=ce}else for(D.c[-(ce+1)]=null;0<D.a&&D.c[D.d[D.a-1]]===null;)--D.a;$(M,Re(K),z)}}else{if(0>s(z.b.a,K.a,z.a))return!1;we(N).b=N.b=!0,g(z.b),f(Re(K),z)}return!0}function ne(M,N){var D=q(N),z=N.a,K=D.a,ce=z.a,ae=K.a,J=z.b.a,xe=K.b.a,Se=new Y;if(s(J,M.a,ce),s(xe,M.a,ae),ce===ae||Math.min(ce.a,J.a)>Math.max(ae.a,xe.a))return!1;if(i(ce,ae)){if(0<s(xe,ce,ae))return!1}else if(0>s(J,ae,ce))return!1;var rt=J,ot=ce,gt=xe,ut=ae,ct,Ct;if(i(rt,ot)||(ct=rt,rt=ot,ot=ct),i(gt,ut)||(ct=gt,gt=ut,ut=ct),i(rt,gt)||(ct=rt,rt=gt,gt=ct,ct=ot,ot=ut,ut=ct),i(gt,ot)?i(ot,ut)?(ct=r(rt,gt,ot),Ct=r(gt,ot,ut),0>ct+Ct&&(ct=-ct,Ct=-Ct),Se.b=h(ct,gt.b,Ct,ot.b)):(ct=s(rt,gt,ot),Ct=-s(rt,ut,ot),0>ct+Ct&&(ct=-ct,Ct=-Ct),Se.b=h(ct,gt.b,Ct,ut.b)):Se.b=(gt.b+ot.b)/2,o(rt,ot)||(ct=rt,rt=ot,ot=ct),o(gt,ut)||(ct=gt,gt=ut,ut=ct),o(rt,gt)||(ct=rt,rt=gt,gt=ct,ct=ot,ot=ut,ut=ct),o(gt,ot)?o(ot,ut)?(ct=a(rt,gt,ot),Ct=a(gt,ot,ut),0>ct+Ct&&(ct=-ct,Ct=-Ct),Se.a=h(ct,gt.a,Ct,ot.a)):(ct=l(rt,gt,ot),Ct=-l(rt,ut,ot),0>ct+Ct&&(ct=-ct,Ct=-Ct),Se.a=h(ct,gt.a,Ct,ut.a)):Se.a=(gt.a+ot.a)/2,i(Se,M.a)&&(Se.b=M.a.b,Se.a=M.a.a),rt=i(ce,ae)?ce:ae,i(rt,Se)&&(Se.b=rt.b,Se.a=rt.a),t(Se,ce)||t(Se,ae))return Q(M,N),!1;if(!t(J,M.a)&&0<=s(J,M.a,Se)||!t(xe,M.a)&&0>=s(xe,M.a,Se)){if(xe===M.a)return g(z.b),f(K.b,z),N=B(N),z=q(N).a,L(M,q(N),D),H(M,N,Re(z),z,z,!0),!0;if(J===M.a){g(K.b),f(z.e,Re(K)),ce=D=N,ae=ce.a.b.a;do ce=we(ce);while(ce.a.b.a===ae);return N=ce,ce=q(N).a.b.c,D.a=Re(K),K=L(M,D,null),H(M,N,K.c,z.b.c,ce,!0),!0}return 0<=s(J,M.a,Se)&&(we(N).b=N.b=!0,g(z.b),z.a.b=M.a.b,z.a.a=M.a.a),0>=s(xe,M.a,Se)&&(N.b=D.b=!0,g(K.b),K.a.b=M.a.b,K.a.a=M.a.a),!1}return g(z.b),g(K.b),f(Re(K),z),z.a.b=Se.b,z.a.a=Se.a,z.a.h=Le(M.e,z.a),z=z.a,K=[0,0,0,0],Se=[ce.d,J.d,ae.d,xe.d],z.g[0]=z.g[1]=z.g[2]=0,j(z,ce,J,K,0),j(z,ae,xe,K,2),U(M,z,Se,K,!0),we(N).b=N.b=D.b=!0,!1}function ve(M,N){for(var D=q(N);;){for(;D.b;)N=D,D=q(D);if(!N.b&&(D=N,N=we(N),N===null||!N.b))break;N.b=!1;var z=N.a,K=D.a,ce;if(ce=z.b.a!==K.b.a)e:{ce=N;var ae=q(ce),J=ce.a,xe=ae.a,Se=void 0;if(i(J.b.a,xe.b.a)){if(0>s(J.b.a,xe.b.a,J.a)){ce=!1;break e}we(ce).b=ce.b=!0,Se=g(J),f(xe.b,Se),Se.d.c=ce.d}else{if(0<s(xe.b.a,J.b.a,xe.a)){ce=!1;break e}ce.b=ae.b=!0,Se=g(xe),f(J.e,xe.b),Se.b.d.c=ce.d}ce=!0}if(ce&&(D.c?(F(D),p(K),D=q(N),K=D.a):N.c&&(F(N),p(z),N=we(D),z=N.a)),z.a!==K.a){if(z.b.a===K.b.a||N.c||D.c||z.b.a!==M.a&&K.b.a!==M.a)Q(M,N);else if(ne(M,N))break}z.a===K.a&&z.b.a===K.b.a&&(T(K,z),F(N),p(z),N=we(D))}}function Pe(M,N){M.a=N;for(var D=N.c;D.i===null;)if(D=D.c,D===N.c){var D=M,z=N,ae=new Ye;ae.a=z.c.b;var K=D.f,J=K.a;do J=J.a;while(J.b!==null&&!K.c(K.b,ae,J.b));var K=J.b,ce=q(K),ae=K.a,J=ce.a;if(s(ae.b.a,z,ae.a)===0)ae=K.a,t(ae.a,z)||t(ae.b.a,z)||(g(ae.b),K.c&&(p(ae.c),K.c=!1),f(z.c,ae),Pe(D,z));else{var xe=i(J.b.a,ae.b.a)?K:ce,ce=void 0;K.d||xe.c?(xe===K?ce=m(z.c.b,ae.e):ce=m(J.b.c.b,z.c).b,xe.c?G(xe,ce):(ae=D,K=R(D,K,ce),K.f=we(K).f+K.a.f,K.d=P(ae,K.f)),Pe(D,z)):H(D,K,z.c,z.c,null,!0)}return}if(D=B(D.i),ae=q(D),K=ae.a,ae=L(M,ae,null),ae.c===K){var K=ae,ae=K.c,J=q(D),ce=D.a,xe=J.a,Se=!1;ce.b.a!==xe.b.a&&ne(M,D),t(ce.a,M.a)&&(f(Re(ae),ce),D=B(D),ae=q(D).a,L(M,q(D),J),Se=!0),t(xe.a,M.a)&&(f(K,Re(xe)),K=L(M,J,null),Se=!0),Se?H(M,D,K.c,ae,ae,!0):(i(xe.a,ce.a)?z=Re(xe):z=ce,z=m(K.c.b,z),H(M,D,z,z.c,z.c,!1),z.b.i.c=!0,ve(M,D))}else H(M,D,ae.c,K,K,!0)}function De(M,N){var D=new Ye,z=d(M.b);z.a.b=x,z.a.a=N,z.b.a.b=-x,z.b.a.a=N,M.a=z.b.a,D.a=z,D.f=0,D.d=!1,D.c=!1,D.h=!0,D.b=!1,z=M.f,z=Ne(z,z.a,D),D.e=z}function Xe(M){this.a=new et,this.b=M,this.c=O}function Ne(M,N,D){do N=N.c;while(N.b!==null&&!M.c(M.b,N.b,D));return M=new et(D,N.a,N),N.a.c=M,N.a=M}function et(M,N,D){this.b=M||null,this.a=N||this,this.c=D||this}function ze(){this.d=de,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var de=0;e=ze.prototype,e.x=function(){lt(this,de)},e.B=function(M,N){switch(M){case 100142:return;case 100140:switch(N){case 100130:case 100131:case 100132:case 100133:case 100134:this.s=N;return}break;case 100141:this.m=!!N;return;default:he(this,100900);return}he(this,100901)},e.y=function(M){switch(M){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:he(this,100900)}return!1},e.A=function(M,N,D){this.j[0]=M,this.j[1]=N,this.j[2]=D},e.z=function(M,N){var D=N||null;switch(M){case 100100:case 100106:this.h=D;break;case 100104:case 100110:this.l=D;break;case 100101:case 100107:this.k=D;break;case 100102:case 100108:this.i=D;break;case 100103:case 100109:this.p=D;break;case 100105:case 100111:this.o=D;break;case 100112:this.r=D;break;default:he(this,100900)}},e.C=function(M,N){var D=!1,z=[0,0,0];lt(this,2);for(var K=0;3>K;++K){var ce=M[K];-1e150>ce&&(ce=-1e150,D=!0),1e150<ce&&(ce=1e150,D=!0),z[K]=ce}D&&he(this,100155),D=this.q,D===null?(D=d(this.b),f(D,D.b)):(g(D),D=D.e),D.a.d=N,D.a.g[0]=z[0],D.a.g[1]=z[1],D.a.g[2]=z[2],D.f=1,D.b.f=-1,this.q=D},e.u=function(M){lt(this,de),this.d=1,this.b=new He,this.c=M},e.t=function(){lt(this,1),this.d=2,this.q=null},e.v=function(){lt(this,2),this.d=1},e.w=function(){lt(this,1),this.d=de;var M=this.j[0],N=this.j[1],D=this.j[2],z=!1,K=[M,N,D];if(M===0&&N===0&&D===0){for(var N=[-2*1e150,-2*1e150,-2*1e150],ce=[2*1e150,2*1e150,2*1e150],D=[],ae=[],z=this.b.c,M=z.e;M!==z;M=M.e)for(var J=0;3>J;++J){var xe=M.g[J];xe<ce[J]&&(ce[J]=xe,ae[J]=M),xe>N[J]&&(N[J]=xe,D[J]=M)}if(M=0,N[1]-ce[1]>N[0]-ce[0]&&(M=1),N[2]-ce[2]>N[M]-ce[M]&&(M=2),ce[M]>=N[M])K[0]=0,K[1]=0,K[2]=1;else{for(N=0,ce=ae[M],D=D[M],ae=[0,0,0],ce=[ce.g[0]-D.g[0],ce.g[1]-D.g[1],ce.g[2]-D.g[2]],J=[0,0,0],M=z.e;M!==z;M=M.e)J[0]=M.g[0]-D.g[0],J[1]=M.g[1]-D.g[1],J[2]=M.g[2]-D.g[2],ae[0]=ce[1]*J[2]-ce[2]*J[1],ae[1]=ce[2]*J[0]-ce[0]*J[2],ae[2]=ce[0]*J[1]-ce[1]*J[0],xe=ae[0]*ae[0]+ae[1]*ae[1]+ae[2]*ae[2],xe>N&&(N=xe,K[0]=ae[0],K[1]=ae[1],K[2]=ae[2]);0>=N&&(K[0]=K[1]=K[2]=0,K[I(ce)]=1)}z=!0}for(ae=I(K),M=this.b.c,N=(ae+1)%3,D=(ae+2)%3,ae=0<K[ae]?1:-1,K=M.e;K!==M;K=K.e)K.b=K.g[N],K.a=ae*K.g[D];if(z){for(K=0,z=this.b.a,M=z.b;M!==z;M=M.b)if(N=M.a,!(0>=N.f))do K+=(N.a.b-N.b.a.b)*(N.a.a+N.b.a.a),N=N.e;while(N!==M.a);if(0>K)for(K=this.b.c,z=K.e;z!==K;z=z.e)z.a=-z.a}for(this.n=!1,K=this.b.b,M=K.h;M!==K;M=z)z=M.h,N=M.e,t(M.a,M.b.a)&&M.e.e!==M&&($(this,N,M),p(M),M=N,N=M.e),N.e===M&&(N!==M&&((N===z||N===z.b)&&(z=z.h),p(N)),(M===z||M===z.b)&&(z=z.h),p(M));for(this.e=K=new W,z=this.b.c,M=z.e;M!==z;M=M.e)M.h=Le(K,M);for(ge(K),this.f=new Xe(this),De(this,-x),De(this,x);(K=Ve(this.e))!==null;){for(;;){e:if(M=this.e,M.a===0)z=oe(M.b);else if(z=M.c[M.d[M.a-1]],M.b.a!==0&&(M=oe(M.b),i(M,z))){z=M;break e}if(z===null||!t(z,K))break;z=Ve(this.e),$(this,K.c,z.c)}Pe(this,K)}for(this.a=this.f.a.a.b.a.a,K=0;(z=this.f.a.a.b)!==null;)z.h||++K,F(z);for(this.f=null,K=this.e,K.b=null,K.d=null,this.e=K.c=null,K=this.b,M=K.a.b;M!==K.a;M=z)z=M.b,M=M.a,M.e.e===M&&(T(M.c,M),p(M));if(!this.n){if(K=this.b,this.m)for(M=K.b.h;M!==K.b;M=z)z=M.h,M.b.d.c!==M.d.c?M.f=M.d.c?1:-1:p(M);else for(M=K.a.b;M!==K.a;M=z)if(z=M.b,M.c){for(M=M.a;i(M.b.a,M.a);M=M.c.b);for(;i(M.a,M.b.a);M=M.e);for(N=M.c.b,D=void 0;M.e!==N;)if(i(M.b.a,N.a)){for(;N.e!==M&&(c(N.e)||0>=s(N.a,N.b.a,N.e.b.a));)D=m(N.e,N),N=D.b;N=N.c.b}else{for(;N.e!==M&&(u(M.c.b)||0<=s(M.b.a,M.a,M.c.b.a));)D=m(M,M.c.b),M=D.b;M=M.e}for(;N.e.e!==M;)D=m(N.e,N),N=D.b}if(this.h||this.i||this.k||this.l)if(this.m){for(K=this.b,z=K.a.b;z!==K.a;z=z.b)if(z.c){this.h&&this.h(2,this.c),M=z.a;do this.k&&this.k(M.a.d,this.c),M=M.e;while(M!==z.a);this.i&&this.i(this.c)}}else{for(K=this.b,z=!!this.l,M=!1,N=-1,D=K.a.d;D!==K.a;D=D.d)if(D.c){M||(this.h&&this.h(4,this.c),M=!0),ae=D.a;do z&&(ce=ae.b.d.c?0:1,N!==ce&&(N=ce,this.l&&this.l(!!N,this.c))),this.k&&this.k(ae.a.d,this.c),ae=ae.e;while(ae!==D.a)}M&&this.i&&this.i(this.c)}if(this.r){for(K=this.b,M=K.a.b;M!==K.a;M=z)if(z=M.b,!M.c){N=M.a,D=N.e,ae=void 0;do ae=D,D=ae.e,ae.d=null,ae.b.d===null&&(ae.c===ae?b(ae.a,null):(ae.a.c=ae.c,_(ae,Re(ae))),ce=ae.b,ce.c===ce?b(ce.a,null):(ce.a.c=ce.c,_(ce,Re(ce))),w(ae));while(ae!==N);N=M.d,M=M.b,M.d=N,N.b=M}this.r(this.b),this.c=this.b=null;return}}this.b=this.c=null};function lt(M,N){if(M.d!==N)for(;M.d!==N;)if(M.d<N)switch(M.d){case de:he(M,100151),M.u(null);break;case 1:he(M,100152),M.t()}else switch(M.d){case 2:he(M,100154),M.v();break;case 1:he(M,100153),M.w()}}function he(M,N){M.p&&M.p(N,M.c)}function Ce(M,N){this.b=M||this,this.d=N||this,this.a=null,this.c=!1}function se(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function Re(M){return M.b.e}function He(){this.c=new Y,this.a=new Ce,this.b=new se,this.d=new se,this.b.b=this.d,this.d.b=this.b}function Y(M,N){this.e=M||this,this.f=N||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function W(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new pe}function ge(M){M.d=[];for(var N=0;N<M.a;N++)M.d[N]=N;M.d.sort(function(D){return function(z,K){return i(D[z],D[K])?1:-1}}(M.c)),M.e=!0,Ee(M.b)}function Le(M,N){if(M.e){var D=M.b,z=++D.a;2*z>D.f&&(D.f*=2,D.c=fe(D.c,D.f+1));var K;return D.b===0?K=z:(K=D.b,D.b=D.c[D.b]),D.e[K]=N,D.c[K]=z,D.d[z]=K,D.h&&_e(D,z),K}return D=M.a++,M.c[D]=N,-(D+1)}function Ve(M){if(M.a===0)return Me(M.b);var N=M.c[M.d[M.a-1]];if(M.b.a!==0&&i(oe(M.b),N))return Me(M.b);do--M.a;while(0<M.a&&M.c[M.d[M.a-1]]===null);return N}function pe(){this.d=fe([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function fe(M,N){for(var D=Array(N),z=0;z<M.length;z++)D[z]=M[z];for(;z<N;z++)D[z]=0;return D}function Ee(M){for(var N=M.a;1<=N;--N)je(M,N);M.h=!0}function oe(M){return M.e[M.d[1]]}function Me(M){var N=M.d,D=M.e,z=M.c,K=N[1],ce=D[K];return 0<M.a&&(N[1]=N[M.a],z[N[1]]=1,D[K]=null,z[K]=M.b,M.b=K,0<--M.a&&je(M,1)),ce}function je(M,N){for(var D=M.d,z=M.e,K=M.c,ce=N,ae=D[ce];;){var J=ce<<1;J<M.a&&i(z[D[J+1]],z[D[J]])&&(J+=1);var xe=D[J];if(J>M.a||i(z[ae],z[xe])){D[ce]=ae,K[ae]=ce;break}D[ce]=xe,K[xe]=ce,ce=J}}function _e(M,N){for(var D=M.d,z=M.e,K=M.c,ce=N,ae=D[ce];;){var J=ce>>1,xe=D[J];if(J===0||i(z[xe],z[ae])){D[ce]=ae,K[ae]=ce;break}D[ce]=xe,K[xe]=ce,ce=J}}function Ye(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function q(M){return M.e.c.b}function we(M){return M.e.a.b}un.libtess={GluTesselator:ze,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},ze.prototype.gluDeleteTess=ze.prototype.x,ze.prototype.gluTessProperty=ze.prototype.B,ze.prototype.gluGetTessProperty=ze.prototype.y,ze.prototype.gluTessNormal=ze.prototype.A,ze.prototype.gluTessCallback=ze.prototype.z,ze.prototype.gluTessVertex=ze.prototype.C,ze.prototype.gluTessBeginPolygon=ze.prototype.u,ze.prototype.gluTessBeginContour=ze.prototype.t,ze.prototype.gluTessEndContour=ze.prototype.v,ze.prototype.gluTessEndPolygon=ze.prototype.w,n.exports=un.libtess})(w9);var tu=w9.exports;function IH(n,e){try{let s=function(f,p){p[p.length]=f[0],p[p.length]=f[1]},o=function(f){f!==tu.primitiveType.GL_TRIANGLES&&console.warn(`expected TRIANGLES but got type: ${f}`)},a=function(f){console.error("error callback"),console.error(`error number: ${f}`)},l=function(f,p,g){return[f[0],f[1],f[2]]},c=function(f){};const t=n.points.filter(f=>!isNaN(f)),i=new tu.GluTesselator,r=[];i.gluTessProperty(tu.gluEnum.GLU_TESS_WINDING_RULE,tu.windingRule.GLU_TESS_WINDING_NONZERO),i.gluTessCallback(tu.gluEnum.GLU_TESS_VERTEX_DATA,s),i.gluTessCallback(tu.gluEnum.GLU_TESS_BEGIN,o),i.gluTessCallback(tu.gluEnum.GLU_TESS_ERROR,a),i.gluTessCallback(tu.gluEnum.GLU_TESS_COMBINE,l),i.gluTessCallback(tu.gluEnum.GLU_TESS_EDGE_FLAG,c),i.gluTessNormal(0,0,1),i.gluTessBeginPolygon(r),i.gluTessBeginContour();for(let f=0;f<t.length;){const p=t[f++],g=t[f++],m=[p,g,0];i.gluTessVertex(m,m)}i.gluTessEndContour(),i.gluTessEndPolygon();const u=e.points,h=e.indices,d=u.length/2;for(let f=0;f<r.length;)u.push(r[f++],r[f++]);for(let f=0;f<r.length/2;f++)h.push(f+d)}catch(t){console.error(t)}}class JSe extends sI{processFill(e){if(e.holes.length)IH(e,this);else{const t=oI.FILL_COMMANDS[e.type];e.type===Yn.POLY?IH(e,this):t.triangulate(e,this)}}}const ZSe={color:yA.Point,radius:s2,hollow:!1,hollowColor:yA.Hollow};function SH(n,e){const t={...ZSe,...e};n.clear(),n.beginFill(t.color,1),n.drawCircle(0,0,t.radius),t.hollow&&(n.beginFill(t.hollowColor,1),n.drawCircle(0,0,t.radius-1)),t.position&&n.position.set(t.position.x,t.position.y),n.endFill()}function PH(n){n.off("pointerdown"),n.off("pointermove"),n.off("pointerup")}function e1e(n,e,t=s2){if(e.length<2)return!1;const i=e[0];let r=!0;for(let s=1;s<e.length;s++){const o=e[s];if(!MH(i,o,t)){r=!1;break}}return r?!1:MH(i,n,t)}function MH(n,e,t=s2){return Math.abs(n.x-e.x)<t&&Math.abs(n.y-e.y)<t}var mm;(function(n){n[n.Point=3]="Point",n[n.ControlPoint=2]="ControlPoint",n[n.ControlPointLine=1]="ControlPointLine",n[n.Line=0]="Line"})(mm||(mm={}));var Rl;class x9 extends KSe{constructor(t){super();E(this,"type",it.PEN);E(this,"points",[]);E(this,"controlPoints",{});E(this,"isClosePath",!1);E(this,"isDone",!1);E(this,"lineGraphics");E(this,"pointGraphics",[]);E(this,"controlPointGraphics",[]);E(this,"movingPointIndex",-1);E(this,"editingPointIndex",-1);E(this,"editingControlPointIndex",-1);ke(this,Rl,!1);E(this,"enterEditMode",()=>{this.editingPointIndex===-1&&(this.editingPointIndex=0),this.drawPoints(),this.drawControlPoints(),Qe(this,Rl,!0),this.setupPointsEvents()});if(this.lineGraphics=new dI,this.addChild(this.lineGraphics),this.lineGraphics._geometry=new JSe,t){const{points:i,isClosePath:r,controlPoints:s,...o}=t;this.points=i,this.isClosePath=r,this.controlPoints=s,this.draw(),this.parseJSON(o),this.x=t.offsetX,this.y=t.offsetY}this.type=it.PEN,this.lineGraphics.zIndex=mm.Line,this.sortableChildren=!0,this.points.length>0&&(this.interactive=!0,this.isDone=!0,this.setupHitArea()),this.setUpLineGraphics()}highlightBound(){!S(this,Rl)&&this.isDone&&this.lineGraphics.highlightBound()}reset(){!S(this,Rl)&&this.isDone&&this.lineGraphics.reset()}setUpLineGraphics(){this.lineGraphics.interactive=!1}start(t){S(this,Rl)||(e1e(t,this.points)?(this.isClosePath=!0,this.done()):(this.points.push(t),this.update(t),this.points.length===1?(this.emit(mo.DRAW_BEGIN,this),this.interactive=!0):this.emit(mo.DRAW_UPDATE,this)))}update(t){S(this,Rl)||this.points.length<1||(this.draw(),this.drawAuxiliaryLine(t),this.drawPoints())}getRealBounds(){return this.lineGraphics.getRealBounds()}end(){}draw(){this.points.length<1||(this.lineGraphics.clear().lineStyle(Za),this.drawLine(this.isClosePath))}done(){this.isDone=!0,Qe(this,Rl,!1),this.interactive=!0,this.removePointsEvents(),this.removePointGraphics(),this.removeControlPointsEvents(),this.removeControlPointGraphics(),this.draw(),this.lineGraphics.draw(),this.setupHitArea(),this.emit(mo.DRAW_DONE,this)}updateData(t,i){const{points:r,isClosePath:s,controlPoints:o}=t;this.points=r,this.isClosePath=s,this.controlPoints=o,i?this.done():(this.draw(),this.removePointGraphics(),this.removeControlPointGraphics(),S(this,Rl)?this.enterEditMode():this.isDone||this.drawPoints(),this.setupHitArea())}getRealPoints(t){return this.lineGraphics.getRealPoints(t)}undo(){this.clear()}toJSON(t){const{points:i,controlPoints:r,width:s,height:o}=this,a=super.toJSON(t),{isFill:l,config:{fillColor:c,lineColor:u}}=this.lineGraphics;return{...a,points:gm(i),controlPoints:gm(r),isFill:l,fillColor:c,lineColor:u,width:s,height:o}}parseJSON(t){const{points:i=this.points,controlPoints:r=this.controlPoints,isFill:s,fillColor:o,lineColor:a,layerTag:l,layerColor:c,width:u=this.width,height:h=this.height,enableFill:d=this.enableFill}=t;super.parseJSON(t),this.lineGraphics.parseJSON({isFill:s,fillColor:o,lineColor:a,layerTag:l,layerColor:c,x:this.lineGraphics.x,y:this.lineGraphics.y,enableFill:d}),this.points=gm(i),this.controlPoints=gm(r),this.width=u,this.height=h,this.enableFill=d}get editing(){return S(this,Rl)}get isFill(){return this.lineGraphics.isFill}drawLine(t=!1){const i=this.points[0];this.lineGraphics.moveTo(i.x,i.y);for(let r=1;r<this.points.length;r++){const s=this.points[r],o=this.controlPoints[r],a=this.controlPoints[r-1];this.drawLineWithControlPoints(o,a,s)}if(t){const r=this.controlPoints[0],s=this.controlPoints[this.points.length-1];this.drawLineWithControlPoints(r,s,i)}this.lineGraphics.finishPoly()}drawLineWithControlPoints(t,i,r){const s=i&&i.length>1;t?s?this.lineGraphics.bezierCurveTo(i[1].x,i[1].y,t[0].x,t[0].y,r.x,r.y):this.lineGraphics.quadraticCurveTo(t[0].x,t[0].y,r.x,r.y):s?this.lineGraphics.quadraticCurveTo(i[1].x,i[1].y,r.x,r.y):this.lineGraphics.lineTo(r.x,r.y)}drawAuxiliaryLine(t){const i=this.points[this.points.length-1];this.lineGraphics.moveTo(i.x,i.y).lineTo(t.x,t.y)}drawPoints(){for(let t=0;t<this.points.length;t++){const i=this.points[t];let r=this.pointGraphics[t];r||(r=new hn,r.zIndex=mm.Point,this.pointGraphics.push(r),this.addChild(r)),SH(r,{position:i,hollow:t!==this.editingPointIndex})}}setupPointsEvents(){this.pointGraphics.forEach(t=>{t.interactive=!0,t.on("pointerdown",this.onPointPointerDown.bind(this)),t.on("pointermove",this.onPointPointerMove.bind(this)),t.on("pointerup",this.onPointPointerUp.bind(this)),t.on(ji.DOUBLE_CLICK,this.onPointDoubleClick.bind(this))})}addHitArea(){this.setupHitArea()}drawControlPoints(){if(this.editingPointIndex<0)return;const t=this.controlPoints[this.editingPointIndex];if(!t)return;this.removeControlPointGraphics();const i=new hn;i.zIndex=mm.ControlPointLine,i.clear().lineStyle(Za),this.controlPointGraphics.push(i),this.addChild(i);for(let r=0;r<t.length;r++){const s=t[r],o=new hn;o.zIndex=mm.ControlPoint,this.controlPointGraphics.push(o),this.addChild(o),SH(o,{position:s,color:yA.ControlPoint}),o.interactive=!0,o.on("pointerdown",this.onControlPointPointerDown.bind(this)),o.on("pointermove",this.onControlPointPointerMove.bind(this)),o.on("pointerup",this.onControlPointPointerUp.bind(this)),r===0?i.moveTo(s.x,s.y):i.lineTo(s.x,s.y)}}onControlPointPointerDown(t){t.stopPropagation(),t.currentTarget instanceof hn&&(this.editingControlPointIndex=this.controlPointGraphics.indexOf(t.currentTarget)-1,this.on("pointerupoutside",this.onControlPointPointerUp))}onControlPointPointerMove(t){if(this.editingPointIndex<0||this.editingControlPointIndex<0)return;const i=t.data.getLocalPosition(this),r=this.controlPoints[this.editingPointIndex];if(r){r[this.editingControlPointIndex]=i;const s=this.points[this.editingPointIndex],o=c9(i,s),a=this.editingControlPointIndex===0?1:0;r[a]=o,this.controlPoints[this.editingPointIndex]=r}this.draw(),this.drawControlPoints(),this.drawPoints()}onControlPointPointerUp(t){t.stopPropagation(),this.editingControlPointIndex=-1,this.off("pointerupoutside",this.onControlPointPointerUp),this.emit(mo.DRAW_UPDATE,this)}onPointPointerDown(t){t.stopPropagation(),t.currentTarget instanceof hn&&(this.movingPointIndex=this.pointGraphics.indexOf(t.currentTarget),this.editingPointIndex=this.movingPointIndex,this.drawPoints(),this.removeControlPointGraphics(),this.drawControlPoints(),this.on("pointerupoutside",this.onPointPointerUp))}onPointDoubleClick(t){if(!(t.currentTarget instanceof hn))return;const i=this.pointGraphics.indexOf(t.currentTarget);if(i===-1)return;this.movingPointIndex=-1,this.editingPointIndex=i;const r=this.points[this.editingPointIndex];let s,o;if(this.editingPointIndex===0?s=this.points[this.points.length-1]:s=this.points[this.editingPointIndex-1],this.editingPointIndex===this.points.length-1?o=this.points[0]:o=this.points[this.editingPointIndex+1],this.removeControlPointsEvents(),this.removeControlPointGraphics(),this.controlPoints[this.editingPointIndex])delete this.controlPoints[this.editingPointIndex];else{const{cp1:a,cp2:l}=JR(s,r,o);this.controlPoints[this.editingPointIndex]=[a,l]}this.draw(),this.drawControlPoints(),this.drawPoints()}onPointPointerMove(t){if(this.movingPointIndex<0)return;const i=this.points[this.movingPointIndex],r=t.data.getLocalPosition(this);this.points[this.movingPointIndex]=r,this.draw(),this.removeControlPointGraphics(),this.updateControlPoints(r,i),this.drawPoints()}updateControlPoints(t,i){const r=t.x-i.x,s=t.y-i.y,o=this.controlPoints[this.movingPointIndex];if(o){for(let a=0;a<o.length;a++)o[a].x+=r,o[a].y+=s;this.controlPoints[this.movingPointIndex]=o,this.drawControlPoints()}}onPointPointerUp(t){t.stopPropagation(),this.movingPointIndex=-1,this.emit(mo.DRAW_UPDATE,this),this.off("pointerupoutside",this.onPointPointerUp)}removePointsEvents(){this.pointGraphics.forEach(t=>{PH(t)})}removeControlPointsEvents(){this.controlPointGraphics.forEach(t=>{PH(t)})}removePointGraphics(){this.pointGraphics.forEach(t=>{t.destroy()}),this.pointGraphics=[]}removeControlPointGraphics(){this.controlPointGraphics.forEach(t=>{t.destroy()}),this.controlPointGraphics=[]}containsPoint(t){return this.lineGraphics.containsPoint(t)}setupHitArea(){if(MA(this.hitArea))return;const t=Object.values(this.controlPoints).length;if(this.points.length===2&&!t){const[i,r]=this.points;this.lineGraphics.addLineHitArea(i,r),this.hitArea=this.lineGraphics.hitArea}else this.lineGraphics.enableFill||(this.lineGraphics.addHitArea(),this.hitArea=this.lineGraphics.hitArea)}*generateCommands(){const t=this.points[0];yield{type:"M",values:[t.x,t.y]};for(let i=1;i<this.points.length;i++){const r=this.points[i],s=this.controlPoints[i],o=this.controlPoints[i-1];yield this.controlPtsToCommand(s,o,r)}if(this.isClosePath){const i=this.controlPoints[0],r=this.controlPoints[this.points.length-1];yield this.controlPtsToCommand(i,r,t)}}controlPtsToCommand(t,i,r){const s=i&&i.length>1;return t?s?{type:"C",values:[i[1].x,i[1].y,t[0].x,t[0].y,r.x,r.y]}:{type:"Q",values:[t[0].x,t[0].y,r.x,r.y]}:s?{type:"Q",values:[i[1].x,i[1].y,r.x,r.y]}:{type:"L",values:[r.x,r.y]}}getSVGData(t){const i=g2(this,t);return Ln(super.getSVGData(t),{tag:"path",attrs:{...i,d:oIe(this.generateCommands())}})}getEditModePlugin(){}}Rl=new WeakMap;class A2 extends Ud{constructor(t){super();E(this,"radius",0);t&&(this.parseJSON(t),this.draw()),this.type=it.RECT,this.isClosePath=!0}update(t,i){const{position:{x:r,y:s}}=this;let o=!1;i&&i.data.originalEvent.shiftKey&&(o=!0);const{x:a,y:l}=t,c=a-r,u=o?c:l-s;this.originWidth=c,this.originHeight=u,this.draw()}draw(){const t=this.originWidth,i=this.originHeight;let r=this.radius;r=Math.min(r,Math.min(t/2,i/2));const s=r,o=r;this.clear().lineStyle(Za);const a=0,l=0;if(this.radius===0)this.drawRect(0,0,this.originWidth,this.originHeight);else{const c=.4477152502;this.moveTo(a+s,l),this.lineTo(a+t-s,l),this.bezierCurveTo(a+t-c*s,l,a+t,l+c*o,a+t,l+o),this.lineTo(a+t,l+i-o),this.bezierCurveTo(a+t,l+i-c*o,a+t-c*s,l+i,a+t-s,l+i),this.lineTo(a+s,l+i),this.bezierCurveTo(a+c*s,l+i,a,l+i-c*o,a,l+i-o),this.lineTo(a,l+o),this.bezierCurveTo(a,l+c*o,a+c*s,l,a+s,l),this.closePath(),this.radius=r}super.draw(),this.addHitArea()}parseJSON(t){super.parseJSON(t);const{radius:i}=t;tn(i)&&(this.radius=i,this.draw())}transformUpdate(){this.originWidth=this.width,this.originHeight=this.height,this.scale.set(1,1),this.draw()}toJSON(t){return{...super.toJSON(t),radius:this.radius,maxRadius:Math.min(this.originWidth/2,this.originHeight/2)}}end(t,i){const{position:{x:r,y:s}}=this,{x:o,y:a}=t;o<r&&(this.position.x=o),a<s&&(this.position.y=a);const l=Math.abs(o-r),c=i&&i.data.originalEvent.shiftKey?l:Math.abs(a-s);this.originWidth=l,this.originHeight=c,this.draw(),this.toggleFill(this.isFill),this.done()}getSVGData(t){const i=this.radius?{rx:this.radius,ry:this.radius}:{};return Ln(super.getSVGData(t),{tag:"rect",attrs:{x:0,y:0,width:this.width/this.scale.x,height:this.height/this.scale.y,...i}})}}function am(n){let e;if(typeof n=="string"&&n){const t=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]?|[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g;e=n.match(t)}return e??[]}var sa;(function(n){n[n.HORIZONTAL=0]="HORIZONTAL";const t=1;n[n.VERTICAL=t]="VERTICAL"})(sa||(sa={}));class Si{static makeArea(e,t,i){return e|t<<15|i<<30}static getOpenOffset(e){return e&32767}static getCloseOffset(e){return e>>15&32767}static getOrientation(e){return e>>30&1}static setOpenOffset(e,t){return Si.makeArea(t,Si.getCloseOffset(e),Si.getOrientation(e))}static setCloseOffset(e,t){return Si.makeArea(Si.getOpenOffset(t),t,Si.getOrientation(e))}}var pc;(function(n){n[n.HOR=0]="HOR";const t=1;n[n.VERT=t]="VERT";const i=2;n[n.NONE=i]="NONE"})(pc||(pc={}));const RH=new Pt;class C9{constructor(e,t){this._width=e,this._height=t,this._root=[null,Si.makeArea(0,this._height,sa.HORIZONTAL),!1]}allocate(e,t,i){const r=this.findArea(e,t);if(!r)return null;i||(i=new Pt),this.getFrame(r,i);const s=new Pt(i.x,i.y,e,t),o=this.split(r,i,s);return i.copyFrom(s),i.__mem_area=o,i}free(e){const t=e.__mem_area;t[2]=!1,this.merge(t)}get width(){return this._width}get height(){return this._height}getAreaField(e){return e[1]}getFrame(e,t){t||(t=new Pt);const i=this.getAreaField(e),r=this.getParent(e),s=Si.getOrientation(i),o=Si.getOpenOffset(i),a=Si.getCloseOffset(i),l=r?Si.getOpenOffset(r[1]):0,c=r?Si.getCloseOffset(r[1]):this._width;return s?(t.x=o,t.y=l,t.width=a-t.x,t.height=c-l):(t.x=l,t.y=o,t.width=c-t.x,t.height=a-t.y),t}getParent(e){return e[0]}hasChildren(e){return Array.isArray(e[2])&&e[2].length!==0}getChildren(e){if(!Array.isArray(e[2]))throw new Error("Children don't exist");return e[2]}addChild(e,...t){e[2]=Array.isArray(e[2])?e[2]:[],e[2].push(...t)}findArea(e,t){return this.findAreaRecursive(this._root,e,t)}findAreaRecursive(e,t,i){const r=this.getFrame(e,RH);if(r.width<t||r.height<i)return null;if(!this.hasChildren(e)){const l=r.width-t,c=r.height-i;return l<0||c<0||e[2]?null:e}const s=this.getChildren(e);let o=null,a=1/0;for(let l=0,c=s.length;l<c;l++){const u=this.findAreaRecursive(s[l],t,i);if(!u)continue;const h=this.getFrame(u,RH),d=h.width-t,f=h.height-i;if(d<0||f<0)continue;if(!d&&!f)return u;const p=Math.min(d,f);a>p&&(o=u,a=p)}return o}splitOrientation(e,t){if(t.width===e.width&&t.height===e.height)return pc.NONE;if(t.width===e.width)return pc.VERT;if(t.height===e.height)return pc.HOR;const i=Math.abs((e.width-t.width)*e.height-t.width*(e.height-t.height)),r=Math.abs(e.width*(e.height-t.height)-(e.width-t.width)*t.height);return i>r?pc.HOR:pc.VERT}split(e,t,i,r=this.getParent(e)?this.splitOrientation(t,i):pc.HOR){if(e[2]===!0)throw new Error("Cannot deallocate");return r===pc.NONE?(e[2]=!0,e):this[r===pc.HOR?"splitPrimaryHorizontal":"splitPrimaryVertical"](e,t,i)}splitPrimaryHorizontal(e,t,i){const r=this.getAreaField(e),s=Si.getOrientation(r),o=this.getParent(e);if(this.hasChildren(e))throw new Error("Can't split non-leaf node");const a=[e,Si.makeArea(t.left,t.x+i.width,sa.VERTICAL),[]],l=[e,Si.makeArea(t.x+i.width,t.right,sa.VERTICAL),!1];if(s===sa.HORIZONTAL)this.addChild(e,a,l);else{const c=this.getChildren(o).indexOf(e);a[0]=o,l[0]=o,this.getChildren(o).splice(c,1,a,l)}if(i.height!==t.height){const c=[a,Si.makeArea(t.top,t.y+i.height,sa.HORIZONTAL),!0],u=[a,Si.makeArea(t.y+i.height,t.bottom,sa.HORIZONTAL),!1];return this.addChild(a,c,u),c}else a[2]=!0;return a}splitPrimaryVertical(e,t,i){const r=this.getAreaField(e),s=Si.getOrientation(r),o=this.getParent(e);if(this.hasChildren(e))throw new Error("Can't split non-leaf node");const a=[e,Si.makeArea(t.top,t.y+i.height,sa.HORIZONTAL),[]],l=[e,Si.makeArea(t.y+i.height,t.bottom,sa.HORIZONTAL),!1];if(s===sa.VERTICAL)this.addChild(e,a,l);else{const c=this.getChildren(o).indexOf(e);a[0]=o,l[0]=o,this.getChildren(o).splice(c,1,a,l)}if(i.width!==t.height){const c=[a,Si.makeArea(t.left,t.x+i.width,sa.VERTICAL),!0],u=[a,Si.makeArea(t.x+i.width,t.right,sa.VERTICAL),!1];return this.addChild(a,c,u),c}else a[2]=!0;return a}merge(e){if(this.hasChildren(e))throw new Error("Cannot merge a non-leaf node");const t=this.getParent(e);if(!t)return;const i=this.getChildren(t),r=i.indexOf(e),s=i[r-1],o=i[r+1];o&&o[2]===!1&&(e[1]=Si.setCloseOffset(e[1],Si.getCloseOffset(o[1])),i.splice(r+1,1)),s&&s[2]===!1&&(e[1]=Si.setOpenOffset(e[1],Si.getOpenOffset(s[1])),i.splice(r-1,1)),i.length===1&&(t[2]=!1,this.merge(t))}printState(e){this.hasChildren(e)?this.getChildren(e).forEach(t=>this.printState(t)):console.log({...this.getFrame(e)},e[2])}}const f1=new Pt;class t1e{constructor(e=2048,t=2048){this.slabWidth=e,this.slabHeight=t,this.textureSlabs=[]}get maxWidth(){return this.slabWidth-2*this.calculatePadding(this.slabWidth,this.slabHeight)}get maxHeight(){return this.slabHeight-2*this.calculatePadding(this.slabWidth,this.slabHeight)}allocate(e,t,i=this.calculatePadding(e,t)){if(e+2*i>this.slabWidth||t+2*i>this.slabHeight)return null;const r=this.textureSlabs;for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this.issueTexture(l,e,t,i);if(c)return c}const s=this.createSlab();return this.textureSlabs.unshift(s),this.issueTexture(s,e,t,i)}free(e){const t=e.baseTexture,i=this.textureSlabs.find(s=>s.slab===t);if(!i)throw new Error("The texture cannot be freed because its base-texture is not pooled by this allocator. This is either a bug in TextureAllocator or you tried to free a texture that was never allocated by one.");const r=i.managedTextures.find(s=>s.texture===e);if(!r)throw new Error("The texture cannot be freed because it was not found in the managed list of issued textures on its slab. This may be because you duplicated this texture or a bug in TextureAllocator");i.managedArea.free(r.area),i.managedTextures.splice(i.managedTextures.indexOf(r),1)}calculatePadding(e,t){const i=Math.max(e,t);return i<64?2:i<128?4:i<1024?8:16}createSlab(){return{managedArea:new C9(this.slabWidth,this.slabHeight),managedTextures:[],slab:new In(null,{width:this.slabWidth,height:this.slabHeight})}}createTexture(e,t){return new Wt(e,t)}issueTexture(e,t,i,r=0){const s=e.managedArea.allocate(t+2*r,i+2*r);if(!s)return null;f1.copyFrom(s),f1.pad(-r);const o=e.slab,a=this.createTexture(o,f1.clone());return e.managedTextures.push({area:s,texture:a}),a}}class E9 extends t1e{createSlab(){const e=document.createElement("canvas");return e.width=this.slabWidth,e.height=this.slabHeight,{managedArea:new C9(this.slabWidth,this.slabHeight),managedTextures:[],slab:new In(e,{width:this.slabWidth,height:this.slabHeight})}}}function n1e(n,e){return Math.sqrt((n.x-e.x)**2+(n.y-e.y)**2)}function DH(n,e,t,i,r,s,o,a){const l=n-t*r,c=e-i*r,u=n+t*s,h=e+i*s;let d,f;o?(d=i,f=-t):(d=-i,f=t);const p=l+d,g=c+f,m=u+d,v=h+f;return a.push(p,g),a.push(m,v),2}function bw(n,e,t,i,r,s,o,a){const l=t-n,c=i-e;let u=Math.atan2(l,c),h=Math.atan2(r-n,s-e);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);let d=u;const f=h-u,p=Math.abs(f),g=Math.sqrt(l*l+c*c),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,v=f/m;if(d+=v,a){o.push(n,e),o.push(t,i);for(let _=1,y=d;_<m;_++,y+=v)o.push(n,e),o.push(n+Math.sin(y)*g,e+Math.cos(y)*g);o.push(n,e),o.push(r,s)}else{o.push(t,i),o.push(n,e);for(let _=1,y=d;_<m;_++,y+=v)o.push(n+Math.sin(y)*g,e+Math.cos(y)*g),o.push(n,e);o.push(r,s),o.push(n,e)}return m*2}function kH(n,e,t){const i=t.points,r=n.length/2;let s=n.length;const o=i.length/2,a=e.width/2,l=a*a,c=e.miterLimit*e.miterLimit;let u=n[0],h=n[1],d=n[2],f=n[3],p=0,g=0,m=-(h-f),v=u-d,_=0,y=0,A=Math.sqrt(m*m+v*v);m/=A,v/=A,m*=a,v*=a;const w=e.alignment,b=(1-w)*2,C=w*2;e.cap===_o.ROUND?s+=bw(u-m*(b-C)*.5,h-v*(b-C)*.5,u-m*b,h-v*b,u+m*C,h+v*C,i,!0)+2:e.cap===_o.SQUARE&&(s+=DH(u,h,m,v,b,C,!0,i)),i.push(u-m*b,h-v*b),i.push(u+m*C,h+v*C);for(let T=1;T<r-1;++T){u=n[(T-1)*2],h=n[(T-1)*2+1],d=n[T*2],f=n[T*2+1],p=n[(T+1)*2],g=n[(T+1)*2+1],m=-(h-f),v=u-d,A=Math.sqrt(m*m+v*v),m/=A,v/=A,m*=a,v*=a,_=-(f-g),y=d-p,A=Math.sqrt(_*_+y*y),_/=A,y/=A,_*=a,y*=a;const O=d-u,F=h-f,G=d-p,B=g-f,R=F*G-B*O,P=R<0;if(Math.abs(R)<.1){i.push(d-m*b,f-v*b),i.push(d+m*C,f+v*C);continue}const k=(-m+u)*(-v+f)-(-m+d)*(-v+h),L=(-_+p)*(-y+f)-(-_+d)*(-y+g),H=(O*L-G*k)/R,U=(B*k-F*L)/R,$=(H-d)*(H-d)+(U-f)*(U-f),j=d+(H-d)*b,Q=f+(U-f)*b,ne=d-(H-d)*C,ve=f-(U-f)*C;e.join===ma.BEVEL||$/l>c?(P?(i.push(j,Q),i.push(d+m*C,f+v*C),i.push(j,Q),i.push(d+_*C,f+y*C)):(i.push(d-m*b,f-v*b),i.push(ne,ve),i.push(d-_*b,f-y*b),i.push(ne,ve)),s+=2):e.join===ma.ROUND?P?(i.push(j,Q),i.push(d+m*C,f+v*C),s+=bw(d,f,d+m*C,f+v*C,d+_*C,f+y*C,i,!0)+4,i.push(j,Q),i.push(d+_*C,f+y*C)):(i.push(d-m*b,f-v*b),i.push(ne,ve),s+=bw(d,f,d-m*b,f-v*b,d-_*b,f-y*b,i,!1)+4,i.push(d-_*b,f-y*b),i.push(ne,ve)):(i.push(j,Q),i.push(ne,ve))}u=n[(r-2)*2],h=n[(r-2)*2+1],d=n[(r-1)*2],f=n[(r-1)*2+1],m=-(h-f),v=u-d,A=Math.sqrt(m*m+v*v),m/=A,v/=A,m*=a,v*=a,i.push(d-m*b,f-v*b),i.push(d+m*C,f+v*C),e.cap===_o.ROUND?s+=bw(d-m*(b-C)*.5,f-v*(b-C)*.5,d-m*b,f-v*b,d+m*C,f+v*C,i,!1)+2:e.cap===_o.SQUARE&&(s+=DH(d,f,m,v,b,C,!1,i));const I=t.indices,x=ms.epsilon*ms.epsilon;for(let T=o;T<s+o-2;++T)u=i[T*2],h=i[T*2+1],d=i[(T+1)*2],f=i[(T+1)*2+1],p=i[(T+2)*2],g=i[(T+2)*2+1],!(Math.abs(u*(f-g)+d*(g-h)+p*(h-f))<x)&&I.push(T,T+1,T+2)}function p1(n){return n%2===0}function i1e(n,e){return(n+1)%e.length}function OH(n,e){const t=n.shape;let i=n.points||t.points.slice();const r=e.closePointEps;if(i.length===0)return;const s=new Ae(i[0],i[1]),o=new Ae(i[i.length-2],i[i.length-1]),a=t.type!==Yn.POLY||t.closeStroke,l=Math.abs(s.x-o.x)<r&&Math.abs(s.y-o.y)<r;if(a){i=i.slice(),l&&(i.pop(),i.pop(),o.set(i[i.length-2],i[i.length-1]));const _=(s.x+o.x)*.5,y=(o.y+s.y)*.5;i.unshift(_,y),i.push(_,y)}const c=n.lineStyle;let u=c.dashOffset||0;const h=c.dashArray||[10,5],d=i.length/2-1,f=new Ae,p=new Ae,g=[],m=new Ae;let v=0;g.push(i[0],i[1]);for(let _=0;_<d;_++){f.set(i[_*2],i[_*2+1]),p.set(i[_*2+2],i[_*2+3]);const y=n1e(f,p),A=Math.atan2(p.y-f.y,p.x-f.x),w=Math.sin(A),b=Math.cos(A);let C=y;for(m.copyFrom(f);C>=h[v]-u;){const I=h[v]-u;m.x+=b*I,m.y+=w*I,g.push(m.x,m.y),p1(v)&&(kH(g,c,e),g.length=0),C-=I,v=i1e(v,h),u=0}C>0&&(p1(v)&&g.push(p.x,p.y),u+=C)}p1(v)&&kH(g,c,e)}const WC=100;var yd;(function(n){n.NONZERO="nonzero",n.EVENODD="evenodd"})(yd||(yd={}));class b2{constructor(){E(this,"contours");E(this,"fillRule");E(this,"type");E(this,"dirty");E(this,"bounds",new oi);this.contours=[],this.fillRule=yd.NONZERO,this.type=WC,this.dirty=!0}get points(){return this.contours.length||this.contours.push([]),this.contours[this.contours.length-1]}contains(e,t){this.dirty&&(this.calculateBounds(),this.dirty=!1);const i=this.bounds;return e<i.minX||t<i.minY||e>i.maxX||t>i.maxY?!1:this.fillRule===yd.EVENODD?this.hitEvenOdd(e,t):this.fillRule===yd.NONZERO?this.hitNonZero(e,t):!1}clone(){const e=this.contours.map(i=>[...i]),t=new b2;return t.contours=e,t.fillRule=this.fillRule,t}closeContour(){this.points.length!==0&&this.contours.push([])}invalidate(){this.dirty=!0}toString(){return"[@pixi-essentials/svg:Path Don't expect points to be printed :P]"}calculateBounds(){const e=this.bounds;let t=1/0,i=1/0,r=-1/0,s=-1/0;for(const o of this.contours)for(let a=0,l=o.length;a<l;){const c=o[a++],u=o[a++];t=c<t?c:t,i=u<i?u:i,r=c>r?c:r,s=u>s?u:s}e.minX=t,e.minY=i,e.maxX=r,e.maxY=s}hitEvenOdd(e,t){let i=0;for(const r of this.contours)for(let s=0,o=r.length;s<o;){const a=r[s++],l=r[s++],c=r[s%r.length],u=r[(s+1)%r.length];if(l<t&&u>t||l>t&&u<t){const h=(t-l)/(u-l),d=a+h*(c-a);e<d&&++i}}return!!(i%2)}hitNonZero(e,t){let i=0;for(const r of this.contours)for(let s=0,o=r.length;s<o;){const a=r[s++],l=r[s++],c=r[s%r.length],u=r[(s+1)%r.length];l<=t?u>t&&LH(e,t,a,l,c,u)>0&&++i:u<=t&&LH(e,t,a,l,c,u)<0&&--i}return i!==0}}function LH(n,e,t,i,r,s){return(r-t)*(e-i)-(n-t)*(s-i)}const r1e=new oi;var Fh;(function(n){n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC"})(Fh||(Fh={}));class s1e extends sI{processLine(e){if(e.shape.type===WC){this.processPathLine(e);return}e.lineStyle.dashArray?OH(e,this):super.processLine(e)}processPathLine(e){const t=e.shape,i=e.lineStyle;t.contours.forEach(r=>{if(r.find(s=>isNaN(s))!==void 0){console.error("Contour has NaN, oops!");return}i.dashArray?OH({points:r,holes:[],shape:{points:r,type:Fh.POLY},lineStyle:i},this):super.processLine({closeStroke:!0,points:r.slice(),holes:[],shape:{points:r,type:Fh.POLY},lineStyle:i})})}calculateBounds(){const e=this._bounds,t=r1e;let i=Dt.IDENTITY;this._bounds.clear(),t.clear();for(let r=0;r<this.graphicsData.length;r++){const s=this.graphicsData[r],o=s.shape,a=s.type,l=s.matrix||Dt.IDENTITY,c=0;if(i!==l&&(t.isEmpty()||(e.addBoundsMatrix(t,i),t.clear()),i=l),a===Fh.RECT||a===Fh.RREC){const u=o;t.addFramePad(u.x,u.y,u.x+u.width,u.y+u.height,c,c)}else if(a===Fh.CIRC){const u=o;t.addFramePad(u.x,u.y,u.x,u.y,u.radius+c,u.radius+c)}else if(a===Fh.ELIP){const u=o;t.addFramePad(u.x,u.y,u.x,u.y,u.width+c,u.height+c)}else if(a===WC)o.contours.forEach(h=>{e.addVerticesMatrix(Dt.IDENTITY,new Float32Array(h),0,h.length)});else{const u=o;e.addVerticesMatrix(i,u.points,0,u.points.length,c,c)}}t.isEmpty()||e.addBoundsMatrix(t,i),e.pad(this.boundsPadding,this.boundsPadding)}}class o1e extends r2{constructor(){super(...arguments);E(this,"dashArray",null);E(this,"dashOffset",0)}clone(){const t=super.clone();return t.dashArray=this.dashArray?[...this.dashArray]:null,t.dashOffset=this.dashOffset,t}reset(){super.reset(),this.dashArray=null,this.dashOffset=0}}const a1e={calculateArcLength(n,e,t,i,r=.05){const s=Math.sign(i),o=Math.abs(i),a=n*n,c=e*e-a;let u=0;for(let h=t+r*.5,d=0;d<o;h+=s*r,d+=r){const f=Math.cos(h),p=f*f,g=Math.sqrt(a+c*p);u+=r*g}return u}},g1=new Dt,l1e=ms._segmentsCount.bind(ms);class vm extends dI{constructor(t){super();E(this,"paintServers");E(this,"context");this.context=t,this._geometry=new s1e,this._geometry.refCount++,this._lineStyle=new o1e,this.interactive=!1,this.paintServers=[]}lineTextureStyle(t){t=Object.assign({width:0,texture:Wt.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:_o.BUTT,join:ma.MITER,miterLimit:10,dashArray:null,dashOffset:0},t),this.currentPath&&this.startPoly();const i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this}ellipticArc(t,i,r,s,o,a,l=0,c=!1){const u=a-o,h=ms.adaptive?l1e(a1e.calculateArcLength(r,s,o,a-o))*4:20,d=(c?-1:1)*Math.abs(u)/(h-1);g1.identity().translate(-t,-i).rotate(l).translate(t,i);for(let f=0;f<h;f++){const p=o+f*d,g=t+r*Math.cos(p),m=i+s*Math.sin(p),{x:v,y:_}=l!==0?g1.apply({x:g,y:m}):{x:g,y:m};if(f===0){this._initCurve(v,_);continue}isFinite(v)&&isFinite(_)&&this.currentPath.points.push(v,_)}return this}ellipticArcTo(t,i,r,s,o=0,a=!1,l=!1){if(r===0||s===0)return this.lineTo(t,i);const c=this.currentPath.points,u=c[c.length-2],h=c[c.length-1],d=(u+t)/2,f=(h+i)/2,p=g1.identity().translate(-d,-f).rotate(-o),{x:g,y:m}=p.apply({x:u,y:h}),v=Math.pow(g/r,2)+Math.pow(m/s,2);v>1&&(r=Math.sqrt(v)*r,s=Math.sqrt(v)*s);const _=r*r,y=s*s,w=(a===l?1:-1)*Math.sqrt(Math.abs(_*y-_*m*m-y*g*g)/(_*m*m+y*g*g)),b=w*(r*m/s),C=-w*(s*g/r),{x:I,y:x}=p.applyInverse({x:b,y:C}),T=(g-b)/r,O=(m-C)/s,F=Math.sqrt(T**2+O**2),G=(O>=0?1:-1)*Math.acos(T/F),B=(-g-b)/r,R=(-m-C)/s,P=Math.sqrt(B**2+R**2);let k=(R>=0?1:-1)*Math.acos(B/P);return k>G&&a?k-=Math.PI*2:G>k&&!a&&(k+=Math.PI*2),this.ellipticArc(I,x,r,s,G,k,o,a),this}embedCircle(t){t.cx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.cy.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.r.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const i=t.cx.baseVal.valueInSpecifiedUnits,r=t.cy.baseVal.valueInSpecifiedUnits,s=t.r.baseVal.valueInSpecifiedUnits;this.drawCircle(i,r,s),this.isClosePath=!0}embedEllipse(t){t.cx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.cy.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.rx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.ry.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const i=t.cx.baseVal.valueInSpecifiedUnits,r=t.cy.baseVal.valueInSpecifiedUnits,s=t.rx.baseVal.valueInSpecifiedUnits,o=t.ry.baseVal.valueInSpecifiedUnits;this.ellipticArc(i,r,s,o,0,2*Math.PI),this.isClosePath=!0}embedLine(t){t.x1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.y1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.x2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.y2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const i=t.x1.baseVal.valueInSpecifiedUnits,r=t.y1.baseVal.valueInSpecifiedUnits,s=t.x2.baseVal.valueInSpecifiedUnits,o=t.y2.baseVal.valueInSpecifiedUnits;this.moveTo(i,r),this.lineTo(s,o),this.isClosePath=!1}embedRect(t){const i=t.x.baseVal.valueInSpecifiedUnits,r=t.y.baseVal.valueInSpecifiedUnits,s=t.width.baseVal.valueInSpecifiedUnits,o=t.height.baseVal.valueInSpecifiedUnits;let a=t.rx.baseVal.valueInSpecifiedUnits,l=t.ry.baseVal.valueInSpecifiedUnits||a;if(a=a||l,a===0||l===0)this.drawRect(i,r,s,o);else{a=a?Math.min(a,s/2):0,l=l?Math.min(l,o/2):0;const c=1-.5522847498;this.moveTo(i+a,r),this.lineTo(i+s-a,r),this.bezierCurveTo(i+s-c*a,r,i+s,r+c*l,i+s,r+l),this.lineTo(i+s,r+o-l),this.bezierCurveTo(i+s,r+o-c*l,i+s-c*a,r+o,i+s-a,r+o),this.lineTo(i+a,r+o),this.bezierCurveTo(i+c*a,r+o,i,r+o-c*l,i,r+o-l),this.lineTo(i,r+l),this.bezierCurveTo(i,r+c*l,i+c*a,r,i+a,r),this.closePath()}this.isClosePath=!0}embedPolygon(t){if(!t.getAttribute("points"))return;const i=t.getAttribute("points").replace(/,/g," ").trim().split(/\s+/).map(r=>parseFloat(r,10));this.moveTo(i[0],i[1]);for(let r=2;r<i.length;r+=2)this.lineTo(i[r],i[r+1]);this.closePath(),this.isClosePath=!0,this.exportOption.removeSamePoint=!1}embedPolyline(t){if(!t.getAttribute("points"))return;const i=t.getAttribute("points").replace(/,/g," ").trim().split(/\s+/).map(s=>parseFloat(s,10));this.moveTo(i[0],i[1]);for(let s=2;s<i.length;s+=2)this.lineTo(i[s],i[s+1]);this.isClosePath=!1;const r=i.length;r>=4&&i[0]===i[r-2]&&i[1]===i[r-1]&&(this.isClosePath=!0),this.exportOption.removeSamePoint=!1}render(t){const i=this.paintServers;for(let r=0,s=i.length;r<s;r++)i[r].resolvePaint(t);super.render(t)}}var T9=function(){var n=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(e){e=e||{};var t;t||(t=typeof e<"u"?e:{});var i,r;t.ready=new Promise(function(oe,Me){i=oe,r=Me});var s=t,o,a,l,c,u,h,d,f,p;function g(oe,Me,je){if(!Me||0>Me)throw"Size should be a greater 0";if(!oe)throw"Invalid pointer!";return je=je||Uint8Array,Me=new je(s.HEAP8.buffer,oe,Me),Me.F=oe,Me.I=function(){s._free(oe)},Me}var m=s.Tess=function(){if(!o){var oe=s.cwrap;o=oe("tessNewTess","number",["number"]),a=oe("tessDeleteTess",null,["number"]),l=oe("tessAddContour","number",["number","number","number","number","number"]),c=oe("tessTesselate","number","number number number number number number".split(" ")),u=oe("tessGetVertexCount","number",["number"]),h=oe("tessGetVertices","number",["number"]),d=oe("tessGetElementCount","number",["number"]),f=oe("tessGetElements","number",["number"]),p=oe("tessGetVertexIndices","number",["number"])}if(this.F=o(0),this.G=[],!this.F)throw"Unknown error, tesselator wasn't init!"};Object.assign(m.prototype,{dispose:function(){this.F&&(a(this.F),this.G.forEach(function(oe){oe.I&&oe.I()}),this.G=[],this.F=0)},addContours:function(oe,Me){if(!this.F)throw"Tessealtor wasn't be inited!";Me=Me||2;var je=this.G=[];typeof oe[0]=="number"&&(oe=[oe]);for(var _e=0;_e<oe.length;_e++){var Ye=oe[_e],q=Ye.length,we=Float32Array,M=s._malloc(q*we.BYTES_PER_ELEMENT);if(!M)throw"Can't allocate a "+q;q=g(M,q,we),q.set(Ye,0),je.push(q),l(this.F,Me,q.F,Me*Float32Array.BYTES_PER_ELEMENT,Ye.length/Me)}},tesselate:function(oe){if(this.G.length===0)throw"Contours data is required!";if(oe=Object.assign({windingRule:0,elementType:0,polySize:3,vertexSize:2,fillVertexIndices:!1},oe||{}),!c(this.F,oe.windingRule|0||0,oe.elementType|0||0,oe.polySize|0||3,oe.vertexSize|0||2,0))return null;var Me=u(this.F),je=d(this.F),_e={elementCount:je,vertexCount:Me};return!Me||!je?null:(_e.vertices=g(h(this.F),Me*oe.vertexSize,Float32Array),_e.elements=g(f(this.F),je*oe.polySize,Uint32Array),oe.fillVertexIndices&&(_e.vertexIndices=g(p(this.F),Me,Uint32Array)),_e)}});var v={},_;for(_ in t)t.hasOwnProperty(_)&&(v[_]=t[_]);var y="";typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),n&&(y=n),y.indexOf("blob:")!==0?y=y.substr(0,y.lastIndexOf("/")+1):y="";var A=t.printErr||console.warn.bind(console);for(_ in v)v.hasOwnProperty(_)&&(t[_]=v[_]);v=null;var w=0,b;t.wasmBinary&&(b=t.wasmBinary),t.noExitRuntime&&t.noExitRuntime,typeof WebAssembly!="object"&&ve("no native wasm support detected");var C,I=!1;function x(oe){var Me=t["_"+oe];return Me||ve("Assertion failed: Cannot call unknown function "+(oe+", make sure it is exported")),Me}function T(oe,Me,je,_e){var Ye={string:function(D){var z=0;if(D!=null&&D!==0){var K=(D.length<<2)+1;z=Re(K);var ce=z,ae=R;if(0<K){K=ce+K-1;for(var J=0;J<D.length;++J){var xe=D.charCodeAt(J);if(55296<=xe&&57343>=xe){var Se=D.charCodeAt(++J);xe=65536+((xe&1023)<<10)|Se&1023}if(127>=xe){if(ce>=K)break;ae[ce++]=xe}else{if(2047>=xe){if(ce+1>=K)break;ae[ce++]=192|xe>>6}else{if(65535>=xe){if(ce+2>=K)break;ae[ce++]=224|xe>>12}else{if(ce+3>=K)break;ae[ce++]=240|xe>>18,ae[ce++]=128|xe>>12&63}ae[ce++]=128|xe>>6&63}ae[ce++]=128|xe&63}}ae[ce]=0}}return z},array:function(D){var z=Re(D.length);return B.set(D,z),z}},q=x(oe),we=[];if(oe=0,_e)for(var M=0;M<_e.length;M++){var N=Ye[je[M]];N?(oe===0&&(oe=Ce()),we[M]=N(_e[M])):we[M]=_e[M]}return je=q.apply(null,we),je=function(D){return Me==="string"?F(D):Me==="boolean"?!!D:D}(je),oe!==0&&se(oe),je}var O=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function F(oe){if(oe){for(var Me=R,je=oe+NaN,_e=oe;Me[_e]&&!(_e>=je);)++_e;if(16<_e-oe&&Me.subarray&&O)oe=O.decode(Me.subarray(oe,_e));else{for(je="";oe<_e;){var Ye=Me[oe++];if(Ye&128){var q=Me[oe++]&63;if((Ye&224)==192)je+=String.fromCharCode((Ye&31)<<6|q);else{var we=Me[oe++]&63;Ye=(Ye&240)==224?(Ye&15)<<12|q<<6|we:(Ye&7)<<18|q<<12|we<<6|Me[oe++]&63,65536>Ye?je+=String.fromCharCode(Ye):(Ye-=65536,je+=String.fromCharCode(55296|Ye>>10,56320|Ye&1023))}}else je+=String.fromCharCode(Ye)}oe=je}}else oe="";return oe}var G,B,R;function P(){var oe=C.buffer;G=oe,t.HEAP8=B=new Int8Array(oe),t.HEAP16=new Int16Array(oe),t.HEAP32=new Int32Array(oe),t.HEAPU8=R=new Uint8Array(oe),t.HEAPU16=new Uint16Array(oe),t.HEAPU32=new Uint32Array(oe),t.HEAPF32=new Float32Array(oe),t.HEAPF64=new Float64Array(oe)}var k,L=[],H=[],U=[],$=[];function j(){var oe=t.preRun.shift();L.unshift(oe)}var Q=0,ne=null;t.preloadedImages={},t.preloadedAudios={};function ve(oe){throw t.onAbort&&t.onAbort(oe),A(oe),I=!0,oe=new WebAssembly.RuntimeError("abort("+oe+"). Build with -s ASSERTIONS=1 for more info."),r(oe),oe}function Pe(oe){return String.prototype.startsWith?oe.startsWith("data:application/octet-stream;base64,"):oe.indexOf("data:application/octet-stream;base64,")===0}var De="data:application/octet-stream;base64,AGFzbQEAAAABYQ9gAn9/AX9gAn9/AGADf39/AX9gAX8Bf2ABfwBgA39/fwBgBX9/f39/AGAEf39/fwBgBn9/f39/fwBgAAF/YAR/f39/AX9gA39/fwF9YAAAYAR/fX19AGAGf39/f39/AX8CSQwBYQFhAAcBYQFiAAQBYQFjAAkBYQFkAAEBYQFlAAUBYQFmAAEBYQFnAAIBYQFoAAcBYQFpAAgBYQFqAAABYQFrAAIBYQFsAAMDSUgLAgADAgACAwgEAwIECgEBAAIAAwEDDAsBAAoEAQANAgQBAgMECQAFAAEAAwMDAwMOBgUGBAMBAgAAAAUCAwEDAAABAgADAAYEBQFwAQ8PBQcBAYACgIACBgkBfwFBwJrAAgsHSRIBbQIAAW4BAAFvACIBcAAWAXEAFQFyAEEBcwBAAXQAPQF1ADwBdgA7AXcAOgF4ADkBeQA4AXoANwFBADEBQgAwAUMALwFEADUJFAEAQQELDjJIJ0kDDkUsPz4tRENCCsqjAkihAQEEfQJAIAAqAhgiBCABKgIYIgNdRQRAIAMgBFwNASAAKgIcIAEqAhxfQQFzDQELIAMgAioCGCIFXUUEQCADIAVcDQEgASoCHCACKgIcX0UNAQsgAyAEkyIEIAUgA5MiA5JDAAAAAF5BAXMEfUMAAAAABSAEIAEqAhwiBCACKgIck5QgAyAEIAAqAhyTlJILDwtBhQhBqAhB0gBBvwgQAAAL6QMBBn8CQCABIAJGDQAgAigCECIEIAEoAhAiB0cEQCAEKAIIIgUhAwNAIAMgBzYCECADKAIIIgMgBUcNAAsgBCgCACIDIAQoAgQiBTYCBCAFIAM2AgAgBCAAKAKIASIDKAIANgIAIAMgBDYCAAsgAigCFCIFIAEoAhQiCEcEQCAFKAIIIgYhAwNAIAMgCDYCFCADKAIMIgMgBkcNAAsgBSgCACIDIAUoAgQiBjYCBCAGIAM2AgAgBSAAKAKMASIDKAIANgIAIAMgBTYCAAsgASgCCCEDIAIoAggiBigCBCABNgIMIAMoAgQgAjYCDCACIAM2AgggASAGNgIIIAQgB0YEQCAAKAKIARAPIgRFBEBBAA8LIAQgASgCECIDKAIEIgc2AgQgByAENgIAIAQgAzYCACADIAQ2AgQgBCACNgIIIAIhAwNAIAMgBDYCECADKAIIIgMgAkcNAAsgASgCECABNgIICyAFIAhHDQAgACgCjAEQDyIARQRAQQAPCyAAIAEoAhQiAygCBCIENgIEIAQgADYCACAAIAM2AgAgAyAANgIEIABBADoAFCAAQQA2AgwgACACNgIIIAAgAy0AFToAFSACIQMDQCADIAA2AhQgAygCDCIDIAJHDQALIAEoAhQgATYCCAtBAQvUBQEGfyABKAIUIgMgASgCBCIFKAIUIgZHBEAgAygCCCIEIQIDQCACIAY2AhQgAigCDCICIARHDQALIAMoAgAiAiADKAIEIgQ2AgQgBCACNgIAIAMgACgCjAEiAigCADYCACACIAM2AgALAkAgASABKAIIIgJGBEAgASgCECIDKAIIIgQhAgNAIAJBADYCECACKAIIIgIgBEcNAAsgAygCACICIAMoAgQiBDYCBCAEIAI2AgAgAyAAKAKIASICKAIANgIAIAIgAzYCAAwBCyABKAIEIgQoAhQgBCgCDCIENgIIIAEoAhAgAjYCCCAEKAIIIQcgAigCBCAENgIMIAcoAgQgATYCDCABIAc2AgggBCACNgIIIAMgBkcNACAAKAKMARAPIgNFBEBBAA8LIAMgASgCFCICKAIEIgQ2AgQgBCADNgIAIAMgAjYCACACIAM2AgQgA0EAOgAUIANBADYCDCADIAE2AgggAyACLQAVOgAVIAEhAgNAIAIgAzYCFCACKAIMIgIgAUcNAAsLAkAgBSAFKAIIIgJGBEAgBSgCECIDKAIIIgQhAgNAIAJBADYCECACKAIIIgIgBEcNAAsgAygCACICIAMoAgQiBDYCBCAEIAI2AgAgAyAAKAKIASICKAIANgIAIAIgAzYCACAFKAIUIgMoAggiBSECA0AgAkEANgIUIAIoAgwiAiAFRw0ACyADKAIAIgIgAygCBCIFNgIEIAUgAjYCACADIAAoAowBIgIoAgA2AgAgAiADNgIADAELIAEoAhQgBSgCBCgCDCIDNgIIIAUoAhAgAjYCCCADKAIIIQQgAigCBCADNgIMIAQoAgQgBTYCDCAFIAQ2AgggAyACNgIICyAAKAKEASECIAEoAgQiACABIAAgAUkbIgAoAgAiASgCBCAAKAIEKAIAIgM2AgAgAygCBCABNgIAIAAgAigCADYCACACIAA2AgBBAQujAQEFfwJAIAAoAgAiAQRAIAEoAgAiAg0BCyAAKAIUIgMoAgwgACgCDCAAKAIIbEEEaiADKAIAEQAAIgRFBEBBAA8LIAQgACgCBDYCACAAIAQ2AgQgACgCCCIFIAAoAgxsQQRqIQIgACgCACEDA0AgBCACIAVrIgJqIgEgAzYCACABIQMgAkEERw0ACyAAIAE2AgAgASgCACECCyAAIAI2AgAgAQtBAQJ/AkAgAkUNAANAIAEgA0EDdGooAgAiBEUNASAAIARGBEAgASADQQN0aigCBA8LIANBAWoiAyACRw0ACwtBAAu8AQEEfyAAIAEQUiIARQRAQQAPCyAAKAIEIQMgASgCBCIAKAIEKAIMIgIoAgghBCAAKAIIIgUoAgQgAjYCDCAEKAIEIAA2AgwgACAENgIIIAIgBTYCCCADKAIIIQIgACgCCCIEKAIEIAM2AgwgAigCBCAANgIMIAAgAjYCCCADIAQ2AgggACADKAIQNgIQIAMoAgQiAigCECACNgIIIAIgACgCFDYCFCADIAEoAhw2AhwgAiAAKAIcNgIcIAMLlwQBB38Cf0EAIAAoAoQBEA8iA0UNABogAyABKAIEIgQgASABIARLGyIJKAIEIgUoAgAiBDYCICAEKAIEIAM2AgAgAyAJNgIAIAUgA0EgaiIHNgIAIANCADcCECADIAc2AgwgAyAHNgIEIANCADcCGCADQgA3AjAgAyAHNgIoIANCADcCOCADIAM2AgggAyADNgIsIAMgAzYCJAJ/IAMgAigCFCIGIAEoAhQiCEciCUUNABogBigCCCIFIQQDQCAEIAg2AhQgBCgCDCIEIAVHDQALIAYoAgAiBSAGKAIEIgQ2AgQgBCAFNgIAIAYgACgCjAEiBCgCADYCACAEIAY2AgAgASgCFCEGIAMoAggLIQggASgCDCIFKAIIIQQgCCgCBCAFNgIMIAQoAgQgAzYCDCADIAQ2AgggBSAINgIIIAIoAgghBSADKAIoIgQoAgQgAjYCDCAFKAIEIAc2AgwgAyAFNgIoIAIgBDYCCCADIAEoAgQoAhA2AhAgAigCECECIAMgBjYCNCADIAI2AjAgAyAGNgIUIAEoAhQgBzYCCCADIAkNABpBACAAKAKMARAPIgJFDQAaIAIgASgCFCIBKAIEIgA2AgQgACACNgIAIAIgATYCACABIAI2AgQgAkEAOgAUIAJBADYCDCACIAM2AgggAiABLQAVOgAVIAMhBANAIAQgAjYCFCAEKAIMIgQgA0cNAAsgAwsLUgECf0GwFigCACIBIABBA2pBfHEiAmohAAJAIAJBAU5BACAAIAFNGw0APwBBEHQgAEkEQCAAEAtFDQELQbAWIAA2AgAgAQ8LQcAWQTA2AgBBfwvHBQIEfwJ9IAFBBGohCAJAAkACQAJAA0AgAigCECIGKgIYIgogAigCBCIHKAIQIgkqAhgiC11FBEAgCiALXA0CIAYqAhwgCSoCHF9FDQILIAAoAkwQDyIGRQ0EIAYgBzYCACAGIAAoAkAgASgCBCAGEB0iCTYCBCAJRQ0EIAZCADcCECAGQQA2AhggByAGNgIYIAIoAggiAiADRw0ACyABKAIEKAIIKAIAIgIoAgAoAgQiAygCEAJ/IARFBEAgAygCCCEECyAEKAIQC0YEQEEAIQcDQCABIQYgAiEBIAQiAiADIgQoAghHBEAgACgCACAEKAIEKAIMIAQQDUUNBiAAKAIAIAIoAgQoAgwgBBANRQ0GCyABIAYoAgggBCgCHGsiAzYCCCABAn8CQAJAAkACQAJAAkAgACgCPA4FBQABAgMECyADQQBHDAULIANBAEoMBAsgA0EfdgwDCyADQQFqQQJLDAILQd0PQZwPQfABQeMPEAAACyADQQFxCzYCDCAGQQE2AhQCQCAHRQ0AIAAgBhAeRQ0AIAQgBCgCHCACKAIcajYCHCAEKAIEIgMgAygCHCACKAIEKAIcajYCHCAGKAIAIQMgBigCGARAIAMoAhwNBQsgA0EANgIYIAAoAkAhByAIKAIAIgMoAgQiCCADKAIINgIIIAMoAgggCDYCBCADIAcoAhAiCCgCADYCACAIIAM2AgAgBiAAKAJMIgMoAgA2AgAgAyAGNgIAIAAoAgAgAhAORQ0GCyABQQRqIQhBASEHIAEoAgQoAggoAgAiAigCACgCBCIDKAIQIAQoAhBGDQALCyABQQE2AhQgAigCCCABKAIIIAMoAhxrRw0CIAUEQCAAIAEQKAsPC0G6E0GcD0HdAkHUExAAAAtB8w9BnA9BkgFBihAQAAALQeITQZwPQYcDQdQTEAAACyAAQZABakEBEAMAC/oMAQd/AkAgAEUNACAAQQhrIgMgAEEEaygCACIBQXhxIgBqIQUCQCABQQFxDQAgAUEDcUUNASADIAMoAgAiAmsiA0HUFigCACIESQ0BIAAgAmohACADQdgWKAIARwRAIAJB/wFNBEAgAygCCCIEIAJBA3YiAkEDdEHsFmpHGiAEIAMoAgwiAUYEQEHEFkHEFigCAEF+IAJ3cTYCAAwDCyAEIAE2AgwgASAENgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiAETwRAIAIoAgwaCyACIAE2AgwgASACNgIIDAELAkAgA0EUaiICKAIAIgQNACADQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQECQCADIAMoAhwiAkECdEH0GGoiBCgCAEYEQCAEIAE2AgAgAQ0BQcgWQcgWKAIAQX4gAndxNgIADAMLIAZBEEEUIAYoAhAgA0YbaiABNgIAIAFFDQILIAEgBjYCGCADKAIQIgIEQCABIAI2AhAgAiABNgIYCyADKAIUIgJFDQEgASACNgIUIAIgATYCGAwBCyAFKAIEIgFBA3FBA0cNAEHMFiAANgIAIAUgAUF+cTYCBCADIABBAXI2AgQgACADaiAANgIADwsgAyAFTw0AIAUoAgQiAUEBcUUNAAJAIAFBAnFFBEAgBUHcFigCAEYEQEHcFiADNgIAQdAWQdAWKAIAIABqIgA2AgAgAyAAQQFyNgIEIANB2BYoAgBHDQNBzBZBADYCAEHYFkEANgIADwsgBUHYFigCAEYEQEHYFiADNgIAQcwWQcwWKAIAIABqIgA2AgAgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAFBeHEgAGohAAJAIAFB/wFNBEAgBSgCDCECIAUoAggiBCABQQN2IgFBA3RB7BZqIgdHBEBB1BYoAgAaCyACIARGBEBBxBZBxBYoAgBBfiABd3E2AgAMAgsgAiAHRwRAQdQWKAIAGgsgBCACNgIMIAIgBDYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJB1BYoAgBPBEAgAigCDBoLIAIgATYCDCABIAI2AggMAQsCQCAFQRRqIgIoAgAiBA0AIAVBEGoiAigCACIEDQBBACEBDAELA0AgAiEHIAQiAUEUaiICKAIAIgQNACABQRBqIQIgASgCECIEDQALIAdBADYCAAsgBkUNAAJAIAUgBSgCHCICQQJ0QfQYaiIEKAIARgRAIAQgATYCACABDQFByBZByBYoAgBBfiACd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAE2AgAgAUUNAQsgASAGNgIYIAUoAhAiAgRAIAEgAjYCECACIAE2AhgLIAUoAhQiAkUNACABIAI2AhQgAiABNgIYCyADIABBAXI2AgQgACADaiAANgIAIANB2BYoAgBHDQFBzBYgADYCAA8LIAUgAUF+cTYCBCADIABBAXI2AgQgACADaiAANgIACyAAQf8BTQRAIABBA3YiAUEDdEHsFmohAAJ/QcQWKAIAIgJBASABdCIBcUUEQEHEFiABIAJyNgIAIAAMAQsgACgCCAshAiAAIAM2AgggAiADNgIMIAMgADYCDCADIAI2AggPC0EfIQIgA0IANwIQIABB////B00EQCAAQQh2IgEgAUGA/j9qQRB2QQhxIgF0IgIgAkGA4B9qQRB2QQRxIgJ0IgQgBEGAgA9qQRB2QQJxIgR0QQ92IAEgAnIgBHJrIgFBAXQgACABQRVqdkEBcXJBHGohAgsgAyACNgIcIAJBAnRB9BhqIQECQAJAAkBByBYoAgAiBEEBIAJ0IgdxRQRAQcgWIAQgB3I2AgAgASADNgIAIAMgATYCGAwBCyAAQQBBGSACQQF2ayACQR9GG3QhAiABKAIAIQEDQCABIgQoAgRBeHEgAEYNAiACQR12IQEgAkEBdCECIAQgAUEEcWoiB0EQaigCACIBDQALIAcgAzYCECADIAQ2AhgLIAMgAzYCDCADIAM2AggMAQsgBCgCCCIAIAM2AgwgBCADNgIIIANBADYCGCADIAQ2AgwgAyAANgIIC0HkFkHkFigCAEEBayIANgIAIAANAEGMGiEDA0AgAygCACIAQQhqIQMgAA0AC0HkFkF/NgIACwvCLQEMfyMAQRBrIgwkAAJAAkACQAJAAkACQAJAAkACQAJAAkACQCAAQfQBTQRAQcQWKAIAIgdBECAAQQtqQXhxIABBC0kbIgVBA3YiAHYiAUEDcQRAIAFBf3NBAXEgAGoiAkEDdCIFQfQWaigCACIBQQhqIQACQCABKAIIIgMgBUHsFmoiBUYEQEHEFiAHQX4gAndxNgIADAELQdQWKAIAGiADIAU2AgwgBSADNgIICyABIAJBA3QiAkEDcjYCBCABIAJqIgEgASgCBEEBcjYCBAwNCyAFQcwWKAIAIghNDQEgAQRAAkBBAiAAdCICQQAgAmtyIAEgAHRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2aiICQQN0IgNB9BZqKAIAIgEoAggiACADQewWaiIDRgRAQcQWIAdBfiACd3EiBzYCAAwBC0HUFigCABogACADNgIMIAMgADYCCAsgAUEIaiEAIAEgBUEDcjYCBCABIAVqIgQgAkEDdCICIAVrIgNBAXI2AgQgASACaiADNgIAIAgEQCAIQQN2IgVBA3RB7BZqIQFB2BYoAgAhAgJ/IAdBASAFdCIFcUUEQEHEFiAFIAdyNgIAIAEMAQsgASgCCAshBSABIAI2AgggBSACNgIMIAIgATYCDCACIAU2AggLQdgWIAQ2AgBBzBYgAzYCAAwNC0HIFigCACIKRQ0BIApBACAKa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2akECdEH0GGooAgAiASgCBEF4cSAFayEEIAEhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAFayICIAQgAiAESSICGyEEIAAgASACGyEBIAAhAgwBCwsgASAFaiILIAFNDQIgASgCGCEJIAEgASgCDCIDRwRAIAEoAggiAEHUFigCAE8EQCAAKAIMGgsgACADNgIMIAMgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhBiAAIgNBFGoiAigCACIADQAgA0EQaiECIAMoAhAiAA0ACyAGQQA2AgAMCwtBfyEFIABBv39LDQAgAEELaiIAQXhxIQVByBYoAgAiCEUNAEEfIQZBACAFayEEAkACQAJAAn8gBUH///8HTQRAIABBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAFIABBFWp2QQFxckEcaiEGCyAGQQJ0QfQYaigCACICRQsEQEEAIQAMAQtBACEAIAVBAEEZIAZBAXZrIAZBH0YbdCEBA0ACQCACKAIEQXhxIAVrIgcgBE8NACACIQMgByIEDQBBACEEIAIhAAwDCyAAIAIoAhQiByAHIAIgAUEddkEEcWooAhAiAkYbIAAgBxshACABQQF0IQEgAg0ACwsgACADckUEQEECIAZ0IgBBACAAa3IgCHEiAEUNAyAAQQAgAGtxQQFrIgAgAEEMdkEQcSIAdiIBQQV2QQhxIgIgAHIgASACdiIAQQJ2QQRxIgFyIAAgAXYiAEEBdkECcSIBciAAIAF2IgBBAXZBAXEiAXIgACABdmpBAnRB9BhqKAIAIQALIABFDQELA0AgACgCBEF4cSAFayICIARJIQEgAiAEIAEbIQQgACADIAEbIQMgACgCECIBBH8gAQUgACgCFAsiAA0ACwsgA0UNACAEQcwWKAIAIAVrTw0AIAMgBWoiBiADTQ0BIAMoAhghCSADIAMoAgwiAUcEQCADKAIIIgBB1BYoAgBPBEAgACgCDBoLIAAgATYCDCABIAA2AggMCgsgA0EUaiICKAIAIgBFBEAgAygCECIARQ0EIANBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAVBzBYoAgAiAU0EQEHYFigCACEAAkAgASAFayICQRBPBEBBzBYgAjYCAEHYFiAAIAVqIgM2AgAgAyACQQFyNgIEIAAgAWogAjYCACAAIAVBA3I2AgQMAQtB2BZBADYCAEHMFkEANgIAIAAgAUEDcjYCBCAAIAFqIgEgASgCBEEBcjYCBAsgAEEIaiEADAsLIAVB0BYoAgAiAUkEQEHQFiABIAVrIgE2AgBB3BZB3BYoAgAiACAFaiICNgIAIAIgAUEBcjYCBCAAIAVBA3I2AgQgAEEIaiEADAsLQQAhACAFQS9qIgQCf0GcGigCAARAQaQaKAIADAELQagaQn83AgBBoBpCgKCAgICABDcCAEGcGiAMQQxqQXBxQdiq1aoFczYCAEGwGkEANgIAQYAaQQA2AgBBgCALIgJqIgdBACACayIGcSICIAVNDQpB/BkoAgAiAwRAQfQZKAIAIgggAmoiCSAITQ0LIAMgCUkNCwtBgBotAABBBHENBQJAAkBB3BYoAgAiAwRAQYQaIQADQCADIAAoAgAiCE8EQCAIIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABATIgFBf0YNBiACIQdBoBooAgAiAEEBayIDIAFxBEAgAiABayABIANqQQAgAGtxaiEHCyAFIAdPDQYgB0H+////B0sNBkH8GSgCACIABEBB9BkoAgAiAyAHaiIGIANNDQcgACAGSQ0HCyAHEBMiACABRw0BDAgLIAcgAWsgBnEiB0H+////B0sNBSAHEBMiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAFQTBqIAdNDQAgAEF/Rg0AQaQaKAIAIgEgBCAHa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARATQX9HBEAgASAHaiEHIAAhAQwIC0EAIAdrEBMaDAULIAAiAUF/Rw0GDAQLAAtBACEDDAcLQQAhAQwFCyABQX9HDQILQYAaQYAaKAIAQQRyNgIACyACQf7///8HSw0BIAIQEyIBQQAQEyIATw0BIAFBf0YNASAAQX9GDQEgACABayIHIAVBKGpNDQELQfQZQfQZKAIAIAdqIgA2AgBB+BkoAgAgAEkEQEH4GSAANgIACwJAAkACQEHcFigCACIEBEBBhBohAANAIAEgACgCACICIAAoAgQiA2pGDQIgACgCCCIADQALDAILQdQWKAIAIgBBACAAIAFNG0UEQEHUFiABNgIAC0EAIQBBiBogBzYCAEGEGiABNgIAQeQWQX82AgBB6BZBnBooAgA2AgBBkBpBADYCAANAIABBA3QiAkH0FmogAkHsFmoiAzYCACACQfgWaiADNgIAIABBAWoiAEEgRw0AC0HQFiAHQShrIgBBeCABa0EHcUEAIAFBCGpBB3EbIgJrIgM2AgBB3BYgASACaiICNgIAIAIgA0EBcjYCBCAAIAFqQSg2AgRB4BZBrBooAgA2AgAMAgsgASAETQ0AIAIgBEsNACAAKAIMQQhxDQAgACADIAdqNgIEQdwWIARBeCAEa0EHcUEAIARBCGpBB3EbIgBqIgE2AgBB0BZB0BYoAgAgB2oiAiAAayIANgIAIAEgAEEBcjYCBCACIARqQSg2AgRB4BZBrBooAgA2AgAMAQtB1BYoAgAiAyABSwRAQdQWIAE2AgAgASEDCyABIAdqIQJBhBohAAJAAkACQAJAAkACQANAIAIgACgCAEcEQCAAKAIIIgANAQwCCwsgAC0ADEEIcUUNAQtBhBohAANAIAQgACgCACICTwRAIAIgACgCBGoiAyAESw0DCyAAKAIIIQAMAAsACyAAIAE2AgAgACAAKAIEIAdqNgIEIAFBeCABa0EHcUEAIAFBCGpBB3EbaiIJIAVBA3I2AgQgAkF4IAJrQQdxQQAgAkEIakEHcRtqIgEgCWsgBWshACAFIAlqIQYgASAERgRAQdwWIAY2AgBB0BZB0BYoAgAgAGoiADYCACAGIABBAXI2AgQMAwsgAUHYFigCAEYEQEHYFiAGNgIAQcwWQcwWKAIAIABqIgA2AgAgBiAAQQFyNgIEIAAgBmogADYCAAwDCyABKAIEIgJBA3FBAUYEQCACQXhxIQoCQCACQf8BTQRAIAEoAggiAyACQQN2IgVBA3RB7BZqRxogAyABKAIMIgJGBEBBxBZBxBYoAgBBfiAFd3E2AgAMAgsgAyACNgIMIAIgAzYCCAwBCyABKAIYIQgCQCABIAEoAgwiB0cEQCABKAIIIgIgA08EQCACKAIMGgsgAiAHNgIMIAcgAjYCCAwBCwJAIAFBFGoiBCgCACIFDQAgAUEQaiIEKAIAIgUNAEEAIQcMAQsDQCAEIQIgBSIHQRRqIgQoAgAiBQ0AIAdBEGohBCAHKAIQIgUNAAsgAkEANgIACyAIRQ0AAkAgASABKAIcIgJBAnRB9BhqIgMoAgBGBEAgAyAHNgIAIAcNAUHIFkHIFigCAEF+IAJ3cTYCAAwCCyAIQRBBFCAIKAIQIAFGG2ogBzYCACAHRQ0BCyAHIAg2AhggASgCECICBEAgByACNgIQIAIgBzYCGAsgASgCFCICRQ0AIAcgAjYCFCACIAc2AhgLIAEgCmohASAAIApqIQALIAEgASgCBEF+cTYCBCAGIABBAXI2AgQgACAGaiAANgIAIABB/wFNBEAgAEEDdiIBQQN0QewWaiEAAn9BxBYoAgAiAkEBIAF0IgFxRQRAQcQWIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBjYCCCABIAY2AgwgBiAANgIMIAYgATYCCAwDC0EfIQQgAEH///8HTQRAIABBCHYiASABQYD+P2pBEHZBCHEiAXQiAiACQYDgH2pBEHZBBHEiAnQiAyADQYCAD2pBEHZBAnEiA3RBD3YgASACciADcmsiAUEBdCAAIAFBFWp2QQFxckEcaiEECyAGIAQ2AhwgBkIANwIQIARBAnRB9BhqIQECQEHIFigCACICQQEgBHQiA3FFBEBByBYgAiADcjYCACABIAY2AgAgBiABNgIYDAELIABBAEEZIARBAXZrIARBH0YbdCEEIAEoAgAhAQNAIAEiAigCBEF4cSAARg0DIARBHXYhASAEQQF0IQQgAiABQQRxaiIDKAIQIgENAAsgAyAGNgIQIAYgAjYCGAsgBiAGNgIMIAYgBjYCCAwCC0HQFiAHQShrIgBBeCABa0EHcUEAIAFBCGpBB3EbIgJrIgY2AgBB3BYgASACaiICNgIAIAIgBkEBcjYCBCAAIAFqQSg2AgRB4BZBrBooAgA2AgAgBCADQScgA2tBB3FBACADQSdrQQdxG2pBL2siACAAIARBEGpJGyICQRs2AgQgAkGMGikCADcCECACQYQaKQIANwIIQYwaIAJBCGo2AgBBiBogBzYCAEGEGiABNgIAQZAaQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASADSQ0ACyACIARGDQMgAiACKAIEQX5xNgIEIAQgAiAEayIDQQFyNgIEIAIgAzYCACADQf8BTQRAIANBA3YiAUEDdEHsFmohAAJ/QcQWKAIAIgJBASABdCIBcUUEQEHEFiABIAJyNgIAIAAMAQsgACgCCAshASAAIAQ2AgggASAENgIMIAQgADYCDCAEIAE2AggMBAtBHyEAIARCADcCECADQf///wdNBEAgA0EIdiIAIABBgP4/akEQdkEIcSIAdCIBIAFBgOAfakEQdkEEcSIBdCICIAJBgIAPakEQdkECcSICdEEPdiAAIAFyIAJyayIAQQF0IAMgAEEVanZBAXFyQRxqIQALIAQgADYCHCAAQQJ0QfQYaiEBAkBByBYoAgAiAkEBIAB0IgdxRQRAQcgWIAIgB3I2AgAgASAENgIAIAQgATYCGAwBCyADQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQEDQCABIgIoAgRBeHEgA0YNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiBygCECIBDQALIAcgBDYCECAEIAI2AhgLIAQgBDYCDCAEIAQ2AggMAwsgAigCCCIAIAY2AgwgAiAGNgIIIAZBADYCGCAGIAI2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAQ2AgwgAiAENgIIIARBADYCGCAEIAI2AgwgBCAANgIIC0HQFigCACIAIAVNDQBB0BYgACAFayIBNgIAQdwWQdwWKAIAIgAgBWoiAjYCACACIAFBAXI2AgQgACAFQQNyNgIEIABBCGohAAwDC0HAFkEwNgIAQQAhAAwCCwJAIAlFDQACQCADKAIcIgBBAnRB9BhqIgIoAgAgA0YEQCACIAE2AgAgAQ0BQcgWIAhBfiAAd3EiCDYCAAwCCyAJQRBBFCAJKAIQIANGG2ogATYCACABRQ0BCyABIAk2AhggAygCECIABEAgASAANgIQIAAgATYCGAsgAygCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgBEEPTQRAIAMgBCAFaiIAQQNyNgIEIAAgA2oiACAAKAIEQQFyNgIEDAELIAMgBUEDcjYCBCAGIARBAXI2AgQgBCAGaiAENgIAIARB/wFNBEAgBEEDdiIBQQN0QewWaiEAAn9BxBYoAgAiAkEBIAF0IgFxRQRAQcQWIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBjYCCCABIAY2AgwgBiAANgIMIAYgATYCCAwBC0EfIQAgBEH///8HTQRAIARBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAEIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRB9BhqIQECQAJAIAhBASAAdCICcUUEQEHIFiACIAhyNgIAIAEgBjYCAAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQUDQCAFIgEoAgRBeHEgBEYNAiAAQR12IQIgAEEBdCEAIAEgAkEEcWoiAigCECIFDQALIAIgBjYCEAsgBiABNgIYIAYgBjYCDCAGIAY2AggMAQsgASgCCCIAIAY2AgwgASAGNgIIIAZBADYCGCAGIAE2AgwgBiAANgIICyADQQhqIQAMAQsCQCAJRQ0AAkAgASgCHCIAQQJ0QfQYaiICKAIAIAFGBEAgAiADNgIAIAMNAUHIFiAKQX4gAHdxNgIADAILIAlBEEEUIAkoAhAgAUYbaiADNgIAIANFDQELIAMgCTYCGCABKAIQIgAEQCADIAA2AhAgACADNgIYCyABKAIUIgBFDQAgAyAANgIUIAAgAzYCGAsCQCAEQQ9NBEAgASAEIAVqIgBBA3I2AgQgACABaiIAIAAoAgRBAXI2AgQMAQsgASAFQQNyNgIEIAsgBEEBcjYCBCAEIAtqIAQ2AgAgCARAIAhBA3YiA0EDdEHsFmohAEHYFigCACECAn9BASADdCIDIAdxRQRAQcQWIAMgB3I2AgAgAAwBCyAAKAIICyEDIAAgAjYCCCADIAI2AgwgAiAANgIMIAIgAzYCCAtB2BYgCzYCAEHMFiAENgIACyABQQhqIQALIAxBEGokACAAC/MDAQR/IAEoAgAhAwJAAkACQCABIAJHBEADQCABQQA2AhggASgCBCIEKAIIKAIAIgUoAgAiBigCECADKAIQRwRAIAUoAhhFBEAgASgCDCEFIAMoAhQiAiADNgIIIAIgBToAFSADQQA2AhggACgCQCEFIAQoAgQiAiAEKAIINgIIIAQoAgggAjYCBCAEIAUoAhAiAigCADYCACACIAQ2AgAgASAAKAJMIgAoAgA2AgAgACABNgIAIAMPCyAAKAIAIAMoAggoAgQgBigCBBASIgZFDQUgBSgCGEUNAyAAKAIAIAUoAgAQDkUNBSAFIAY2AgAgBUEANgIYIAYgBTYCGAsgBiADKAIIRwRAIAAoAgAgBigCBCgCDCAGEA1FDQUgACgCACADIAYQDUUNBQsgASgCDCEGIAEoAgAiAygCFCIEIAM2AgggBCAGOgAVIAEoAhgEQCADKAIcDQQLIANBADYCGCAAKAJAIQYgASgCBCIDKAIEIgQgAygCCDYCCCADKAIIIAQ2AgQgAyAGKAIQIgQoAgA2AgAgBCADNgIAIAEgACgCTCIEKAIANgIAIAQgATYCACAFKAIAIQMgBSIBIAJHDQALCyADDwtBvg9BnA9BnwFB0A8QAAALQfMPQZwPQZIBQYoQEAAACyAAQZABakEBEAMAC0oBA38gACgCFCEBIAAoAgQiAgRAA0AgAigCACEDIAEoAgwgAiABKAIIEQEAIAMiAg0ACwsgAEIANwIAIAEoAgwgACABKAIIEQEAC74BAQJ/IAAoAgxBGCAAKAIAEQAAIgQgATYCECAEIAA2AhQgBCADNgIMIAQgAkEEIAJBBEsbIgE2AgggBEIANwIAIAAoAgwgASADbEEEaiAAKAIAEQAAIgMEQCADIAQoAgQ2AgAgBCADNgIEIAQoAggiBSAEKAIMbEEEaiEAIAQoAgAhAgNAIAMgACAFayIAaiIBIAI2AgAgASECIABBBEcNAAsgBCACNgIAIAQPCyAAKAIMIAQgACgCCBEBAEEAC6gKAgl/An0jAEEgayIKJAAgACABNgJIIAEoAggiAyEEAkACQAJAAkACQANAIAQoAhgiAg0BIAQoAggiBCADRw0ACyAKIAMoAgQ2AgAgACgCQCAKEDYoAgAiAigCBCgCCCgCACIERQ0BIAQoAgAhBiACKAIAIgUoAgQoAhAgASAFKAIQEAxDAAAAAFsEQCAAIAIgARBHDAILAn8gAiAGKAIEIgYoAhAiByoCGCILIAUoAgQoAhAiCCoCGCIMXQ0AGiALIAxbBEAgAiAHKgIcIAgqAhxfDQEaCyAECyEDAkAgAigCDEUEQCADKAIYRQ0BCyAAKAIAIQQCQCACIANGBEAgBCABKAIIKAIEIAUoAgwQEiIFDQEMBgsgBCAGKAIIKAIEIAEoAggQEiIERQ0FIAQoAgQhBQsgAygCGARAIAAoAgAgAygCABAOBEAgAyAFNgIAIANBADYCGCAFIAM2AhggACABEBoMBAsMBQsgACgCTBAPIgNFDQQgAyAFNgIAIAMgACgCQCACKAIEIAMQHSICNgIEIAJFDQQgA0IANwIQIANBADYCGCAFIAM2AhggACgCPCEEIAMgAygCACgCHCACKAIEKAIAKAIIaiICNgIIIAMCfwJAAkACQAJAAkACQCAEDgUFAAECAwQLIAJBAEcMBQsgAkEASgwECyACQR92DAMLIAJBAWpBAksMAgtB3Q9BnA9B8AFB4w8QAAALIAJBAXELNgIMIAAgARAaDAILIAAgAiABKAIIIgAgAEEAQQEQFAwBCyACKAIAKAIQIQEDQCACKAIEKAIEKAIAIgIoAgAiAygCECABRg0ACyACKAIYBEAgACgCACACKAIEKAIIKAIAKAIAKAIEIAMoAgwQEiIBRQ0DIAIoAhhFDQQgACgCACACKAIAEA5FDQMgAiABNgIAIAJBADYCGCABIAI2AhggAigCBCgCBCgCACICRQ0DCyACKAIEKAIIKAIAIgEoAgAiBCAAIAFBABAXIgEoAggiA0YEQCACKAIAIgMoAgQoAhAgAigCBCgCCCgCACIHKAIAIgYoAgQoAhBHBEAgACACECkaC0EBIQgCQCAAKAJIIgUqAhgiCyADKAIQIgkqAhhcDQAgCSoCHCAFKgIcXA0AIAAoAgAgBCgCBCgCDCADEA1FDQQgAigCACgCECEEA0AgAigCBCgCBCgCACICKAIAIgUoAhAgBEYNAAsgAigCGARAIAAoAgAgAigCBCgCCCgCACgCACgCBCAFKAIMEBIiBEUNBSACKAIYRQ0GIAAoAgAgAigCABAORQ0FIAIgBDYCACACQQA2AhggBCACNgIYIAIoAgQoAgQoAgAiAkUNBQsgAigCBCgCCCgCACIFKAIAIQQgACAFIAcQFxogACgCSCIFKgIYIQtBACEICwJAAkACQCALIAYoAhAiCSoCGCILXA0AIAkqAhwgBSoCHFwNACAAKAIAIAEgBigCBCgCDBANRQ0GIAAgB0EAEBchAQwBCyAIDQELIAAgAiABKAIIIAQgBEEBEBQMAgsCQCALIAMoAhAiBCoCGCIMXUUEQCALIAxcDQEgCSoCHCAEKgIcX0EBcw0BCyAGKAIEKAIMIQMLIAAoAgAgASgCCCgCBCADEBIiAUUNAyAAIAIgASABKAIIIgMgA0EAEBQgASgCBCgCGEEBNgIYIAAgAhAoDAELIAAgAiADIAQgBEEBEBQLIApBIGokAA8LAAsgAEGQAWpBARADAAtBvg9BnA9BnwFB0A8QAAALvAICCn8CfSAAKAIEIgMgACgCACICIAFBAnRqKAIAIgdBA3RqIQkgACgCDCEKIAAoAgghCAJAA0ACQCABQQF0IgAgCE4NACADIAIgAEEBciIEQQJ0aigCAEEDdGooAgAiBSoCGCIMIAMgAiAAQQJ0aigCAEEDdGooAgAiBioCGCINXUUEQCAMIA1cDQEgBSoCHCAGKgIcX0EBcw0BCyAEIQALIAAgCkwEQCAAIAhKDQIgCSgCACIEKgIYIgwgAyACIABBAnRqKAIAIgVBA3RqIgYoAgAiCyoCGCINXQ0CIAwgDVsEQCAEKgIcIAsqAhxfQQFzRQ0DCyACIAFBAnRqIAU2AgAgBiABNgIEIAAhAQwBCwtB7w5BiA1BjQFBgA8QAAALIAIgAUECdGogBzYCACADIAdBA3RqIAE2AgQL4AIBAn8CQCABRQ0AIAAgAWoiAkEBa0H/AToAACAAQf8BOgAAIAFBA0kNACACQQJrQf8BOgAAIABB/wE6AAEgAkEDa0H/AToAACAAQf8BOgACIAFBB0kNACACQQRrQf8BOgAAIABB/wE6AAMgAUEJSQ0AIABBACAAa0EDcSIDaiICQX82AgAgAiABIANrQXxxIgNqIgFBBGtBfzYCACADQQlJDQAgAkF/NgIIIAJBfzYCBCABQQhrQX82AgAgAUEMa0F/NgIAIANBGUkNACACQX82AhggAkF/NgIUIAJBfzYCECACQX82AgwgAUEQa0F/NgIAIAFBFGtBfzYCACABQRhrQX82AgAgAUEca0F/NgIAIAMgAkEEcUEYciIDayIBQSBJDQAgAiADaiECA0AgAkJ/NwMYIAJCfzcDECACQn83AwggAkJ/NwMAIAJBIGohAiABQSBrIgFBH0sNAAsLIAALZQEBfwNAIAEoAggiASgCACIDBEAgACgCDCADIAIgACgCFBECAEUNAQsLIAAoAhAQDyIARQRAQQAPCyAAIAI2AgAgACABKAIENgIEIAEoAgQgADYCCCAAIAE2AgggASAANgIEIAAL2AICBn8CfQJAAkACQCABKAIAIgMoAhAiAioCGCIIIAEoAgQoAggoAgAiBygCACIEKAIQIgUqAhgiCV1FBEAgCCAJXA0BIAIqAhwgBSoCHF9BAXMNAQsgBCgCBCgCECACIAUQDEMAAAAAXg0BAkAgAygCECICKgIYIAQoAhAiBSoCGFsEQCACKgIcIAUqAhxbDQELIAAoAgAgBCgCBBARRQ0DIAAoAgAgAyAEKAIEKAIMEA1FDQMgB0EBNgIUIAFBATYCFEEBDwtBASEGIAIgBUYNASAAKAJEIAIoAiAQSiAAKAIAIAQoAgQoAgwgAxANDQEMAgsgAygCBCgCECAFIAIQDEMAAAAAXQ0AQQEhBiABQQE2AhQgASgCBCgCBCgCAEEBNgIUIAAoAgAgAygCBBARRQ0BIAAoAgAgBCgCBCgCDCADEA1FDQELIAYPCyAAQZABakEBEAMAC7MDAgp/An0CQCAAKAIMIgNFBEAgACgCACIBKAIEIgcgASgCACIAKAIEIgVBA3RqIgQoAgAhAiABKAIIIghBAUgNASAAIAAgCEECdGooAgAiADYCBCAHIABBA3RqQQE2AgQgBEEANgIAIAQgASgCEDYCBCABIAhBAWs2AgggASAFNgIQIAhBAUYNASABQQEQGyACDwsgACgCCCIIIANBAnRqQQRrKAIAKAIAIQcCQCAAKAIAIgYoAggiCUUNACAGKAIEIgogBigCACIBKAIEIgRBA3RqIgUoAgAiAioCGCILIAcqAhgiDF1FBEAgCyAMXA0BIAIqAhwgByoCHF9BAXMNAQsgCUEBSA0BIAEgASAJQQJ0aigCACIANgIEIAogAEEDdGpBATYCBCAFQQA2AgAgCiAEQQN0aiAGKAIQNgIEIAYgCUEBazYCCCAGIAQ2AhAgCUEBRg0BIAZBARAbIAIPCyADQQEgA0EBSBtBAWshAgNAAkAgA0ECSARAIAIhBQwBCyADQQJ0IQQgA0EBayIFIQMgBCAIakEIaygCACgCAEUNAQsLIAAgBTYCDCAHIQILIAILlwEBAX8gAQRAIAEoAgAiAgRAIAAoAgwgAigCBCAAKAIIEQEAIAAoAgwgAigCACAAKAIIEQEAIAAoAgwgAiAAKAIIEQEACyABKAIIIgIEQCAAKAIMIAIgACgCCBEBAAsgASgCBCICBEAgACgCDCACIAAoAggRAQALIAAoAgwgASAAKAIIEQEADwtB6Q1BiA1BxwJB9A0QAAALgQQBB38gACgCiAEQDyEEIAAoAogBEA8hBSAAKAKMARAPIQMCQAJAAkAgBEUNACAFRQ0AIAMNAQsgBARAIAQgACgCiAEiAigCADYCACACIAQ2AgALIAUEQCAFIAAoAogBIgIoAgA2AgAgAiAFNgIACyADRQ0BIAMgACgCjAEiACgCADYCACAAIAM2AgBBAA8LIAAoAoQBEA8iAUUEQEEADwsgASAAKAJIIgIgAEHEAGoiBiACIAZJGyICKAIEIgYoAgAiBzYCICAHKAIEIAE2AgAgASACNgIAIAYgAUEgaiIGNgIAIAFCADcCECABIAY2AgwgASAGNgIEIAFCADcCGCABQgA3AjAgASAGNgIoIAFCADcCOCABIAE2AgggASABNgIsIAEgATYCJCAEIAAoAgQiAjYCBCACIAQ2AgAgBCABNgIIIAQgADYCACABIQIDQCACIAQ2AhAgAigCCCICIAFHDQALIAUgBDYCBCAEIAU2AgAgBSAANgIAIAAgBTYCBCAFIAY2AgggBiECA0AgAiAFNgIQIAIoAggiAiAGRw0ACyADIAAoAjAiAjYCBCACIAM2AgAgAyAAQSxqNgIAIAAgAzYCMCADQQA6ABQgA0EANgIMIAMgATYCCCADIAAtAEE6ABUgASECA0AgAiADNgIUIAIoAgwiAiABRw0ACwsgAQsDAAELtgEBBH0CQCAAKgIYIgQgASoCGCIDXUUEQCADIARcDQEgACoCHCABKgIcX0EBcw0BCyADIAIqAhgiBV1FBEAgAyAFXA0BIAEqAhwgAioCHF9FDQELIAMgBJMiBCAFIAOTIgOSIgVDAAAAAF5BAXMEfUMAAAAABSABKgIcIAAgAiADIAReIgEbKgIcIgaTIAQgAyABGyAFlSAGIAIgACABGyoCHJOUkgsPC0GFCEGoCEE6QbMIEAAAC4AMAQZ/IAAgAWohBQJAAkAgACgCBCICQQFxDQAgAkEDcUUNASAAKAIAIgMgAWohASAAIANrIgBB2BYoAgBHBEBB1BYoAgAhBCADQf8BTQRAIAAoAggiBCADQQN2IgNBA3RB7BZqRxogBCAAKAIMIgJGBEBBxBZBxBYoAgBBfiADd3E2AgAMAwsgBCACNgIMIAIgBDYCCAwCCyAAKAIYIQYCQCAAIAAoAgwiAkcEQCAAKAIIIgMgBE8EQCADKAIMGgsgAyACNgIMIAIgAzYCCAwBCwJAIABBFGoiAygCACIEDQAgAEEQaiIDKAIAIgQNAEEAIQIMAQsDQCADIQcgBCICQRRqIgMoAgAiBA0AIAJBEGohAyACKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgACAAKAIcIgNBAnRB9BhqIgQoAgBGBEAgBCACNgIAIAINAUHIFkHIFigCAEF+IAN3cTYCAAwDCyAGQRBBFCAGKAIQIABGG2ogAjYCACACRQ0CCyACIAY2AhggACgCECIDBEAgAiADNgIQIAMgAjYCGAsgACgCFCIDRQ0BIAIgAzYCFCADIAI2AhgMAQsgBSgCBCICQQNxQQNHDQBBzBYgATYCACAFIAJBfnE2AgQgACABQQFyNgIEIAUgATYCAA8LAkAgBSgCBCICQQJxRQRAIAVB3BYoAgBGBEBB3BYgADYCAEHQFkHQFigCACABaiIBNgIAIAAgAUEBcjYCBCAAQdgWKAIARw0DQcwWQQA2AgBB2BZBADYCAA8LIAVB2BYoAgBGBEBB2BYgADYCAEHMFkHMFigCACABaiIBNgIAIAAgAUEBcjYCBCAAIAFqIAE2AgAPC0HUFigCACEDIAJBeHEgAWohAQJAIAJB/wFNBEAgBSgCCCIEIAJBA3YiAkEDdEHsFmpHGiAEIAUoAgwiA0YEQEHEFkHEFigCAEF+IAJ3cTYCAAwCCyAEIAM2AgwgAyAENgIIDAELIAUoAhghBgJAIAUgBSgCDCICRwRAIAMgBSgCCCIDTQRAIAMoAgwaCyADIAI2AgwgAiADNgIIDAELAkAgBUEUaiIDKAIAIgQNACAFQRBqIgMoAgAiBA0AQQAhAgwBCwNAIAMhByAEIgJBFGoiAygCACIEDQAgAkEQaiEDIAIoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiA0ECdEH0GGoiBCgCAEYEQCAEIAI2AgAgAg0BQcgWQcgWKAIAQX4gA3dxNgIADAILIAZBEEEUIAYoAhAgBUYbaiACNgIAIAJFDQELIAIgBjYCGCAFKAIQIgMEQCACIAM2AhAgAyACNgIYCyAFKAIUIgNFDQAgAiADNgIUIAMgAjYCGAsgACABQQFyNgIEIAAgAWogATYCACAAQdgWKAIARw0BQcwWIAE2AgAPCyAFIAJBfnE2AgQgACABQQFyNgIEIAAgAWogATYCAAsgAUH/AU0EQCABQQN2IgJBA3RB7BZqIQECf0HEFigCACIDQQEgAnQiAnFFBEBBxBYgAiADcjYCACABDAELIAEoAggLIQMgASAANgIIIAMgADYCDCAAIAE2AgwgACADNgIIDwtBHyEDIABCADcCECABQf///wdNBEAgAUEIdiICIAJBgP4/akEQdkEIcSICdCIDIANBgOAfakEQdkEEcSIDdCIEIARBgIAPakEQdkECcSIEdEEPdiACIANyIARyayICQQF0IAEgAkEVanZBAXFyQRxqIQMLIAAgAzYCHCADQQJ0QfQYaiECAkACQEHIFigCACIEQQEgA3QiB3FFBEBByBYgBCAHcjYCACACIAA2AgAgACACNgIYDAELIAFBAEEZIANBAXZrIANBH0YbdCEDIAIoAgAhAgNAIAIiBCgCBEF4cSABRg0CIANBHXYhAiADQQF0IQMgBCACQQRxaiIHQRBqKAIAIgINAAsgByAANgIQIAAgBDYCGAsgACAANgIMIAAgADYCCA8LIAQoAggiASAANgIMIAQgADYCCCAAQQA2AhggACAENgIMIAAgATYCCAsLfwECfyAARQRAIAEQFg8LIAFBQE8EQEHAFkEwNgIAQQAPCyAAQQhrQRAgAUELakF4cSABQQtJGxA0IgIEQCACQQhqDwsgARAWIgJFBEBBAA8LIAIgAEF8QXggAEEEaygCACIDQQNxGyADQXhxaiIDIAEgASADSxsQMyAAEBUgAguIAQEDf0G0FkG0FigCAEEBaiIFNgIAIAAgBTYCAAJAIAMEQANAIAIgBEEDdGoiBigCAEUNAiAEQQFqIgQgA0cNAAsLIAAgASACIANBBHRBCHIQJSADQQF0IgAQJiEBIAAQASABDwsgBiAFNgIAIAIgBEEDdGoiACABNgIEIABBADYCCCADEAEgAgv0DQIQfw59IAAoAgAhBSMAQdAAayICIAAqAggiETgCACACIAAqAgwiFzgCBCACIAAqAhAiGDgCCAJAIBFDAAAAAFsgF0MAAAAAW3EgGEMAAAAAW3EiDEUEQCAFKAIAIQMMAQsgAiAFKAIAIgMiAUEUaigCADYCOCACIANBDGopAgA3AzAgAiABKAIUNgJIIAIgAykCDDcDQCACIAM2AgwgAiADNgIYIAIgAzYCECACIAM2AhwgAiADNgIUIAIgAzYCIAJAIAMgBUYEQCACKgI4IRogAioCSCEUIAIqAjAhFSACKgJAIRYgAioCNCEZIAIqAkQhEwwBCyACKgJIIRQgAioCOCEaIAIqAkQhEyACKgI0IRkgAioCQCEWIAIqAjAiGyEVIAMiBiIEIgciCCIJIgohAQNAIAEqAhQiEiAUIBIgFF4iDRshFCASIBogEiAaXSIOGyEaIAEqAhAiEiATIBIgE14iDxshEyASIBkgEiAZXSIQGyEZIAEqAgwiEiAWIBIgFl4iCxshFiABIAkgCxshCSASIBUgEiAVXSILGyEVIBIgGyALGyEbIAEgCiALGyEKIAEgBiANGyEGIAEgBCAOGyEEIAEgByAPGyEHIAEgCCAQGyEIIAEoAgAiASAFRw0ACyACIAo2AgwgAiAbOAIwIAIgFjgCQCACIAk2AhggAiAZOAI0IAIgCDYCECACIBM4AkQgAiAHNgIcIAIgGjgCOCACIAQ2AhQgAiAUOAJIIAIgBjYCIAtBAiATIBmTIBYgFZNeIgEgFCAakyABQQJ0IgEgAkFAa3IqAgAgAkEwaiABcioCAJNeG0ECdCIBIAJBMGpqKgIAIAJBQGsgAWoqAgBgQQFzRQRAIAJBgICA/AM2AgggAkIANwIAQwAAAAAhEUMAAIA/IRhDAAAAACEXDAELIAIgAkEMaiABaigCACIEKgIMIAJBGGogAWooAgAiASoCDCIckyITOAIkIAIgBCoCECABKgIQIh2TIhU4AiggAiAEKgIUIAEqAhQiHpMiEjgCLCADIAVHBEBDAAAAACEbIAMhAQNAIBMgASoCECAdkyIUlCAVIAEqAgwgHJMiFpSTIhogGpQgFSABKgIUIB6TIhmUIBIgFJSTIhQgFJQgEiAWlCATIBmUkyIWIBaUkpIiGSAbXkEBc0UEQCAaIRggFiEXIBkhGyAUIRELIAEoAgAiASAFRw0ACyACIBg4AgggAiAXOAIEIAIgETgCACAbQwAAAABfQQFzDQELIAJBADYCCCACQgA3AgAgAkECIBWMIBUgFUMAAAAAXRsgE4wgEyATQwAAAABdG14iASASjCASIBJDAAAAAF0bIAJBJGogAUECdGoqAgAiEYwgESARQwAAAABdG14bQQJ0akGAgID8AzYCACACKgIIIRggAioCACERIAIqAgQhFwsgAEEUaiIBQQIgF4wgFyAXQwAAAABdGyARjCARIBFDAAAAAF0bXiIEIBiMIBggGEMAAAAAXRsgAiAEQQJ0aioCACIRjCARIBFDAAAAAF0bXhsiBEECdCIGakEANgIAIAEgBEEBakEDcEECdCIHakGAgID8AzYCACABIARBAmpBA3BBAnQiBGpBADYCACAAQSBqIgEgBmpBADYCACABIAdqQwAAAIBDAAAAACACIAZqKgIAQwAAAABeIgYbOAIAIAEgBGpDAACAP0MAAIC/IAYbOAIAIAMgBUYiBkUEQCADIQEDQCABIAEqAgwiESAAKgIUlCABKgIQIhcgACoCGJSSIAEqAhQiGCAAKgIclJI4AhggASARIAAqAiCUIBcgACoCJJSSIBggACoCKJSSOAIcIAEoAgAiASAFRw0ACwsCQCAMRQ0AIAUoAiwiBCAFQSxqIghGDQBDAAAAACERA0AgBCgCCCIHIQEgBygCHEEBTgRAA0AgESABKAIQIgkqAhggASgCBCgCECIKKgIYkyAJKgIcIAoqAhySlJIhESABKAIMIgEgB0cNAAsLIAQoAgAiBCAIRw0ACyARQwAAAABdQQFzDQAgBkUEQCADIQEDQCABIAEqAhyMOAIcIAEoAgAiASAFRw0ACwsgACAAKgIgjDgCICAAIAAqAiSMOAIkIAAgACoCKIw4AigLAkAgBg0AIAAgAyoCGCIROAIsIAAgETgCNCAAIAMqAhwiETgCMCAAIBE4AjggAygCACIBIAVGDQADQCABKgIYIhEgACoCLF1BAXNFBEAgACAROAIsIAEqAhghEQsgESAAKgI0XkEBc0UEQCAAIBE4AjQLIAEqAhwiESAAKgIwXUEBc0UEQCAAIBE4AjAgASoCHCERCyARIAAqAjheQQFzRQRAIAAgETgCOAsgASgCACIBIAVHDQALCwumCAIHfwR9IAEoAgQoAggoAgAhBAJAA0ACQCAEKAIUBEADQCAEIgEoAgQoAggoAgAiBCgCFA0ACwsCQAJAAkACQAJAIAEoAhQEQCABIQIMAQsgASgCBCgCBCgCACICRQ0BIAEhBCACKAIURQ0BCyACQQA2AhQCQCACKAIAIgYoAgQoAhAiASAEKAIAIgUoAgQoAhBGBEAgAiEBDAELAkACQAJAAkAgASoCGCIJIAIoAgQoAggoAgAiCCgCACIDKAIEKAIQIgcqAhgiClsEQCABKgIcIgsgByoCHCIMWw0CIAkgCl0NASALIAxfQQFzRQ0BDAMLIAkgCl1BAXMNAgsgASAHIAYoAhAQDEMAAAAAXQRAIAIhAQwECyACQQE2AhQgAigCBCgCBCgCAEEBNgIUIAAoAgAgBhARIgFFDQggACgCACADKAIEIAEQDQ0CDAgLQYgTQZwPQZIEQacTEAAACyAHIAEgAygCEBAMQwAAAABeBEAgAiEBDAILIAhBATYCFCACQQE2AhQgACgCACADEBEiAUUNBSAAKAIAIAYoAgwgAygCBBANRQ0GIAEoAgQhAQsgASgCFCACKAIMOgAVIAQoAhgEQCAEKAIAIgEoAhwNCCABQQA2AhggACgCQCEDIAQoAgQiASgCBCIHIAEoAgg2AgggASgCCCAHNgIEIAEgAygCECIDKAIANgIAIAMgATYCACAEIAAoAkwiASgCADYCACABIAQ2AgAgACgCACAFEA5FDQYgAigCBCgCCCgCACIEKAIAIQUgAiEBDAELIAIoAhhFBEAgAiEBDAELIAIoAgAiASgCHA0HIAFBADYCGCAAKAJAIQMgAigCBCIBKAIEIgcgASgCCDYCCCABKAIIIAc2AgQgASADKAIQIgMoAgA2AgAgAyABNgIAIAIgACgCTCIBKAIANgIAIAEgAjYCACAAKAIAIAYQDkUNBSAEKAIEKAIEKAIAIgEoAgAhBgsgBigCECAFKAIQRg0CIAYoAgQoAhAiAiAFKAIEKAIQIgNGDQEgASgCGA0BIAQoAhgNASACIAAoAkgiB0dBACADIAdHGw0BIAAgARApRQ0CCw8LIAAgARAeGgsgBigCECAFKAIQRw0CIAYoAgQiAygCECAFKAIEIgIoAhBHDQIgBSAFKAIcIAYoAhxqNgIcIAIgAigCHCADKAIcajYCHCABKAIAIQIgASgCGARAIAIoAhwNBAsgAkEANgIYIAAoAkAhBSABKAIEIgIoAgQiAyACKAIINgIIIAIoAgggAzYCBCACIAUoAhAiBSgCADYCACAFIAI2AgAgASAAKAJMIgIoAgA2AgAgAiABNgIAIAAoAgAgBhAORQ0BIAQoAgQoAgQoAgAhAQwCCwsLIABBkAFqQQEQAwALQfMPQZwPQZIBQYoQEAAAC5IRAgt/Bn0jAEEwayIHJAAgASgCACIJKAIQIQMgASgCBCgCCCgCACILKAIAIggoAhAhBAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgCCgCBCgCECIFKgIYIAkoAgQoAhAiBioCGFsEQCAFKgIcIAYqAhxbDQELIAYgACgCSCADEAxDAAAAAF9FDQEgBSAAKAJIIAQQDEMAAAAAYEUNAiADIAAoAkgiAkYNAyACIARGDQMgASgCGA0EIAsoAhgNBAJAIAMgBEYNACADKgIcIg8gBioCHCIOIA4gD2AbIAQqAhwiDiAFKgIcIg0gDSAOXxteDQACQAJAIAMqAhgiDSAEKgIYIhBdRQRAIA4gD2BBAXMNASANIBBcDQELIAUgAyAEEAxDAAAAAF5FDQEMAgsgBiAEIAMQDEMAAAAAXQ0BCyAGIAMgBSAEIAcQUyAHKgIcIhEgAyoCHCIPIAYqAhwiDiAOIA9gG2BFDQYgESAEKgIcIg8gBSoCHCIOIA4gD18bX0UNByAHKgIYIg4gBSoCGCIPIAYqAhgiDSANIA9gG2BFDQggDiAEKgIYIg0gAyoCGCIQIA0gEGAbX0UNCQJAAkAgDiAAKAJIIgoqAhgiD11BAXNFBEAgCioCHCESDAELIA4gD1wNASARIAoqAhwiEl9BAXMNAQsgByASOAIcIAcgDzgCGCAEKgIYIQ0gAyoCGCEQIBIhESAPIQ4LIAMhAgJAAkACfSAQIg8gDSAPXg0AGiANIBBbBEAgECADKgIcIAQqAhxfDQEaCyAEIQIgDQsiDyAOXUEBc0UEQCACKgIcIQ0MAQsgDiAPXA0BIAIqAhwiDSARX0EBcw0BCyAHIA04AhwgByAPOAIYIAMqAhghECANIREgDyEOCwJAAkAgDiAQWwRAIBEgAyoCHFsNAQsgDiAEKgIYXA0BIBEgBCoCHFwNAQsgACABEB4aDAELAkACQAJAIAoqAhgiDiAGKgIYWwRAIAYqAhwgCioCHFsNAQsgBiAKIAcQDEMAAAAAYA0BIAAoAkgiCioCGCEOCyAOIAUqAhhbBEAgBSoCHCAKKgIcWw0CCyAFIAogBxAMQwAAAABfQQFzDQELIAAoAkgiAiAFRgRAIAAoAgAgCSgCBBARRQ0QIAAoAgAgCCgCBCAJEA1FDRAgASgCACgCECECA0AgASgCBCgCBCgCACIBKAIAIgMoAhAgAkYNAAsgASgCGARAIAAoAgAgASgCBCgCCCgCACgCACgCBCADKAIMEBIiAkUNESABKAIYRQ0OIAAoAgAgASgCABAORQ0RIAEgAjYCACABQQA2AhggAiABNgIYIAEoAgQoAgQoAgAiAUUNEQsgASgCBCgCCCgCACIDKAIAIQIgACADIAsQFxpBASEMIAAgASACKAIEKAIMIAIgAkEBEBQMAgsgAiAGRgRAIAAoAgAgCCgCBBARRQ0QIAAoAgAgCSgCDCAIKAIEKAIMEA1FDRAgASgCACgCBCgCECEDIAEhAgNAIAIoAgQoAgQoAgAiAigCACgCBCgCECADRg0ACyACKAIEKAIIKAIAKAIAKAIEKAIIIQMgASAIKAIEKAIMNgIAQQEhDCAAIAIgACABQQAQFygCCCAJKAIEKAIIIANBARAUDAILAkAgBiACIAcQDEMAAAAAYEUEQCAAKAJIIQIMAQsgAUEBNgIUIAEoAgQoAgQoAgBBATYCFCAAKAIAIAkoAgQQEUUNECAJKAIQIgMgACgCSCICKgIYOAIYIAMgAioCHDgCHAsgBSACIAcQDEMAAAAAX0EBcw0BIAtBATYCFCABQQE2AhQgACgCACAIKAIEEBFFDQ8gCCgCECIBIAAoAkgiACoCGDgCGCABIAAqAhw4AhwMAQsgACgCACAJKAIEEBFFDQ4gACgCACAIKAIEEBFFDQ4gACgCACAIKAIEKAIMIAkQDUUNDiAJKAIQIgIgByoCGDgCGCACIAcqAhw4AhwgAEHoAGoiCiAAKAJEIAIQKyEIIAkoAhAiAiAINgIgIAhB/////wBGDQ0gAkF/NgIoIAJCADcCDCACQQA2AhQgAiADKgIMIAYqAhggAioCGCIPkyIOjCAOIA5DAAAAAF0bIAYqAhwgAioCHCIOkyINjCANIA1DAAAAAF0bkiIQQwAAAD+UIAMqAhggD5MiDYwgDSANQwAAAABdGyADKgIcIA6TIg2MIA0gDUMAAAAAXRuSIhEgEJIiEJUiDZQgBioCDCARQwAAAD+UIBCVIhCUkkMAAAAAkiIROAIMIAIgAyoCECANlCAGKgIQIBCUkkMAAAAAkiISOAIQIAIgDSADKgIUlCAQIAYqAhSUkkMAAAAAkiIQOAIUIAIgESAEKgIMIAUqAhggD5MiDYwgDSANQwAAAABdGyAFKgIcIA6TIg2MIA0gDUMAAAAAXRuSIg1DAAAAP5QgBCoCGCAPkyIPjCAPIA9DAAAAAF0bIAQqAhwgDpMiD4wgDyAPQwAAAABdG5IiDiANkiINlSIPlCAFKgIMIA5DAAAAP5QgDZUiDpSSkjgCDCACIBIgBCoCECAPlCAFKgIQIA6UkpI4AhAgAiAQIA8gBCoCFJQgDiAFKgIUlJKSOAIUIAtBATYCFCABQQE2AhQgASgCBCgCBCgCAEEBNgIUCyAHQTBqJAAgDA8LQZcQQZwPQcEEQbAQEAAAC0HCEEGcD0HCBEGwEBAAAAtB7RBBnA9BwwRBsBAQAAALQZgRQZwPQcQEQbAQEAAAC0HFEUGcD0HFBEGwEBAAAAtB9BFBnA9B2ARBsBAQAAALQZkSQZwPQdkEQbAQEAAAC0G+EkGcD0HaBEGwEBAAAAtB4xJBnA9B2wRBsBAQAAALAAtBvg9BnA9BnwFB0A8QAAALAAsgCiAAKAJEECAgAEEANgJECyAAQZABakEBEAMAC5ABAQN/IAAoAkwQDyIEBEACQCAAKAIAECEiBUUNACAFKAIQIgYgAzgCHCAGIAI4AhggBSgCBCgCECIGIAM4AhwgBiABOAIYIAAgBjYCSCAEQQA2AhggBEIANwIIIAQgBTYCACAEQgE3AhAgBCAAKAJAIgUgBSAEEB0iBDYCBCAERQ0ADwsLIABBkAFqQQEQAwALuAEBA38gASgCFARAIAAgASgCACACEE8PCyABIAEoAgwiBEEBaiIFNgIMAkACfwJAIAUgASgCECIDSA0AQf////8AIAAoAgQiBUUNARogASADQQF0NgIQIAEgACgCDCABKAIEIgAgA0EDdCAFEQIAIgM2AgQgAw0AIAEgADYCBEH/////AA8LIARB/////wBGDQEgASgCBCAEQQJ0aiACNgIAIARBf3MLDwtBoQ5BiA1BwANBtA4QAAALmAcBBX8CQCAAKAIsIgEgAEEsaiIERgRAIAQhAgwBCyAEIQMDQAJAAkACQAJAAkACQCADIAEiAigCBEYEQCACKAIIIgUhAQNAIAEoAgQiAyABRg0CIAMoAgQgAUcNAyABKAIMIgMoAggoAgQgAUcNBCABKAIIKAIEKAIMIAFHDQUgASgCFCACRw0GIAMiASAFRw0ACwwGC0GuCUG/CUGeBkHKCRAAAAtB3AlBvwlBoQZBygkQAAALQegJQb8JQaIGQcoJEAAAC0H5CUG/CUGjBkHKCRAAAAtBkwpBvwlBpAZBygkQAAALQa0KQb8JQaUGQcoJEAAACyACIQMgAigCACIBIARHDQALCwJAAkACQCAAKAIwIAJHDQAgACgCNA0AIAAgACgCACIBRgRAIAAhAgwDCyAAIQMMAQtBuwpBvwlBqQZBygkQAAALA0ACQAJAAkACQAJAAkAgAyABIgIoAgRGBEAgAigCCCIFKAIEIQMgBSEBA0AgASADRg0CIAMoAgQgAUcNAyABKAIMKAIIKAIEIAFHDQQgASgCCCIEKAIEIgMoAgwgAUcNBSABKAIQIAJHDQYgBCIBIAVHDQALDAYLQeEKQb8JQa0GQcoJEAAAC0HcCUG/CUGwBkHKCRAAAAtB6AlBvwlBsQZBygkQAAALQfkJQb8JQbIGQcoJEAAAC0GTCkG/CUGzBkHKCRAAAAtB8gpBvwlBtAZBygkQAAALIAIhAyACKAIAIgEgAEcNAAsLAkACQAJAAkACQAJAAkACQAJAIAAoAgQgAkcNACAAKAIIDQAgAEHEAGoiAyECA0AgAigCACIBIANGDQIgASgCBCIEKAIAIAIoAgRHDQMgASAERg0EIAQoAgQgAUcNBSABKAIQRQ0GIAQoAhBFDQcgASgCDCgCCCgCBCABRw0IIAEiAiABKAIIKAIEKAIMRg0AC0GTCkG/CUHCBkHKCRAAAAtB/gpBvwlBuAZBygkQAAALIAAoAkgiASAAQeQAakcNBiABKAIAIAIoAgRHDQYgASgCBCADRw0GIAAoAlQNBiABKAIQDQYgACgCWA0GIAEoAhQNBg8LQaQLQb8JQbwGQcoJEAAAC0HcCUG/CUG9BkHKCRAAAAtB6AlBvwlBvgZBygkQAAALQb8LQb8JQb8GQcoJEAAAC0HOC0G/CUHABkHKCRAAAAtB+QlBvwlBwQZBygkQAAALQd0LQb8JQcgGQcoJEAAACykAIAEoAoQBEBggASgCiAEQGCABKAKMARAYIAAoAgwgASAAKAIIEQEACzwBAn0gAioCGCAAKgIcIgQgASoCHCIDk5QgACoCGCADIAIqAhwiA5OUIAEqAhggAyAEk5SSkkMAAAAAYAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMACzUCAX8CfUEBIQIgACoCGCIDIAEqAhgiBF0Ef0EBBSADIARcBEBBAA8LIAAqAhwgASoCHF8LC/4DAQJ/IAJBgARPBEAgACABIAIQChoPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIAQcAASQ0AIAIgAEFAaiIESw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBE0NAAsLIAAgAk0NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIABJDQALDAELIANBBEkEQCAAIQIMAQsgACADQQRrIgRLBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsLqwcBCX8gACgCBCIHQQNxIQIgACAHQXhxIgZqIQQCQEHUFigCACIFIABLDQAgAkEBRg0ACwJAIAJFBEBBACECIAFBgAJJDQEgAUEEaiAGTQRAIAAhAiAGIAFrQaQaKAIAQQF0TQ0CC0EADwsCQCABIAZNBEAgBiABayICQRBJDQEgACAHQQFxIAFyQQJyNgIEIAAgAWoiASACQQNyNgIEIAQgBCgCBEEBcjYCBCABIAIQJAwBC0EAIQIgBEHcFigCAEYEQEHQFigCACAGaiIFIAFNDQIgACAHQQFxIAFyQQJyNgIEIAAgAWoiAiAFIAFrIgFBAXI2AgRB0BYgATYCAEHcFiACNgIADAELIARB2BYoAgBGBEBBzBYoAgAgBmoiBSABSQ0CAkAgBSABayICQRBPBEAgACAHQQFxIAFyQQJyNgIEIAAgAWoiASACQQFyNgIEIAAgBWoiBSACNgIAIAUgBSgCBEF+cTYCBAwBCyAAIAdBAXEgBXJBAnI2AgQgACAFaiIBIAEoAgRBAXI2AgRBACECQQAhAQtB2BYgATYCAEHMFiACNgIADAELIAQoAgQiA0ECcQ0BIANBeHEgBmoiCSABSQ0BIAkgAWshCgJAIANB/wFNBEAgBCgCCCIGIANBA3YiBUEDdEHsFmpHGiAGIAQoAgwiCEYEQEHEFkHEFigCAEF+IAV3cTYCAAwCCyAGIAg2AgwgCCAGNgIIDAELIAQoAhghCAJAIAQgBCgCDCIDRwRAIAQoAggiAiAFTwRAIAIoAgwaCyACIAM2AgwgAyACNgIIDAELAkAgBEEUaiICKAIAIgYNACAEQRBqIgIoAgAiBg0AQQAhAwwBCwNAIAIhBSAGIgNBFGoiAigCACIGDQAgA0EQaiECIAMoAhAiBg0ACyAFQQA2AgALIAhFDQACQCAEIAQoAhwiBUECdEH0GGoiAigCAEYEQCACIAM2AgAgAw0BQcgWQcgWKAIAQX4gBXdxNgIADAILIAhBEEEUIAgoAhAgBEYbaiADNgIAIANFDQELIAMgCDYCGCAEKAIQIgIEQCADIAI2AhAgAiADNgIYCyAEKAIUIgJFDQAgAyACNgIUIAIgAzYCGAsgCkEPTQRAIAAgB0EBcSAJckECcjYCBCAAIAlqIgEgASgCBEEBcjYCBAwBCyAAIAdBAXEgAXJBAnI2AgQgACABaiICIApBA3I2AgQgACAJaiIBIAEoAgRBAXI2AgQgAiAKECQLIAAhAgsgAgscAEG4FigCAEUEQEG8FiABNgIAQbgWIAA2AgALCzABAn8gACECA0AgAigCBCICKAIAIgMEQCAAKAIMIAEgAyAAKAIUEQIARQ0BCwsgAgsHACAAKAJgCwcAIAAoAmQLBwAgACgCWAsHACAAKAJUCwcAIAAoAlwLzQ0BCH9BKBAWIghBADYCAEEEIQoCQAJAAkACQCAAKAJUIgYEQCAAKAJ0IQcgACgCcCEJQbgWQQA2AgAgCSAHIAYQBEG4FigCACEGQbgWQQA2AgBBfyEHAkAgBkUNAEG8FigCACIJRQ0AIAYoAgAgCEEEEBAiB0UEQAwECyAJEAELEAIhBiAHQQFGDQEgAEEANgJUCyAAKAJgIgYEQCAAKAJ0IQcgACgCcCEJQbgWQQA2AgAgCSAHIAYQBEG4FigCACEGQbgWQQA2AgBBfyEHAkAgBkUNAEG8FigCACIJRQ0AIAYoAgAgCEEEEBAiB0UEQAwECyAJEAELEAIhBiAHQQFGDQEgAEEANgJgCyAAKAJYIgYEQCAAKAJ0IQcgACgCcCEJQbgWQQA2AgAgCSAHIAYQBEG4FigCACEGQbgWQQA2AgBBfyEHAkAgBkUNAEG8FigCACIJRQ0AIAYoAgAgCEEEEBAiB0UEQAwECyAJEAELEAIhBiAHQQFGBEAMAgsgAEEANgJYC0EAIQYgAEEANgJQIAUEQCAAIAUqAgA4AgggACAFKgIEOAIMIAAgBSoCCDgCEAsgACABNgI8IARBAiAEQQJKGyIBQQMgAUEDSBshDCAAQZABaiINQQEgCEEEECYhCBACIQoLA0ACQAJAAkAgBg0AIAAoAgBFDQBBuBZBADYCACAAECdBuBYoAgAhAUG4FkEANgIAQX8hBSABRQ0CQbwWKAIAIgRFDQIgASgCACAIIAoQECIFDQEMBQsgCBAVQQAPCyAEEAELEAIhBiAFQQFGDQBBuBZBADYCAEEEIAAQCSEHQbgWKAIAIQFBuBZBADYCAEF/IQUCQCABRQ0AQbwWKAIAIgRFDQAgASgCACAIIAoQECIFRQRADAQLIAQQAQsQAiEGIAVBAUYNAAJAAkACQAJAAkACQAJAAkACQAJAAkACQCAHRQRAQbgWQQA2AgBBBSANQQEQBEG4FigCACEBQbgWQQA2AgAgAUUNAkG8FigCACIERQ0CIAEoAgAgCCAKEBANAQwPCyAAKAIAIQQgAkECRw0CIAQoAkQiBiAEQcQAaiIJRg0JA0AgBigCACEBAkAgBigCFC0AFSIFIAYoAgQoAhQtABVHBEAgBkEBQX8gBRs2AhwMAQtBuBZBADYCAEEGIAQgBhAGIQtBuBYoAgAhBUG4FkEANgIAQX8hBwJAIAVFDQBBvBYoAgAiBkUNACAFKAIAIAggChAQIgdFBEAgBSAGEAMACyAGEAELEAIhBiAHQQFGDQ4gC0UNBgsgASIGIAlHDQALDAMLIAQQAQsQAiEGDAoLIAQoAiwiBiAEQSxqIglGDQQDQCAGKAIAIQEgBi0AFQRAQbgWQQA2AgBBByAEIAYQBiELQbgWKAIAIQVBuBZBADYCAEF/IQcCQCAFRQ0AQbwWKAIAIgZFDQAgBSgCACAIIAoQECIHRQRAIAUgBhADAAsgBhABCxACIQYgB0EBRg0LIAtFDQMLIAEiBiAJRw0ACwtBuBZBADYCAEEIIAQQBUG4FigCACEBQbgWQQA2AgBBfyEFIAFFDQJBvBYoAgAiBkUNAiABKAIAIAggChAQIgUNAQwLC0G4FkEANgIAQQUgDUEBEARBuBYoAgAhAUG4FkEANgIAAkAgAUUNAEG8FigCACIERQ0AIAEoAgAgCCAKEBBFBEAMCwsgBBABCxACIQYMBwsgBhABCxACIQYgBUEBRg0FIAJBAkcNAQwDC0G4FkEANgIAQQggBBAFQbgWKAIAIQFBuBZBADYCAEF/IQUCQCABRQ0AQbwWKAIAIgZFDQAgASgCACAIIAoQECIFRQRADAkLIAYQAQsQAiEGIAVBAUYNBAtBuBZBADYCAEEJIAAgBCACIAMgDBAIDAILQbgWQQA2AgBBCCAEEAVBuBYoAgAhAUG4FkEANgIAQX8hBQJAIAFFDQBBvBYoAgAiBkUNACABKAIAIAggChAQIgVFBEAMBwsgBhABCxACIQYgBUEBRg0CC0G4FkEANgIAQQogACAEIAwQBwtBuBYoAgAhAUG4FkEANgIAQX8hBQJAIAFFDQBBvBYoAgAiBkUNACABKAIAIAggChAQIgVFBEAMBQsgBhABCxACIQYgBUEBRg0AQbgWQQA2AgBBCyAAQegAaiAEEARBuBYoAgAhAUG4FkEANgIAQX8hBQJAIAFFDQBBvBYoAgAiBEUNACABKAIAIAggChAQIgVFBEAMBAsgBBABCxACIQYgBUEBRg0ACyAAQQA2AgAgACgCBCEAIAgQFSAARQ8LIAYgCRADAAsgASAEEAMACyABIAYQAwALlgMCA38BfQJAAkAgACgCAA0AIAAgAEHoAGoQUSIGNgIAIAYNAAwBCwJAAkACQCAEQQFIDQBBACEGIAFBA04EQEEAIQEDQCAAKAIAIQUCQCABBEAgBSABEBFFDQcgASgCDCEBDAELIAUQISIBRQ0FIAAoAgAgASABKAIEEA1FDQYLIAEoAhAiBSACKgIAOAIMIAUgAioCBDgCECAFIAIqAgg4AhQgACAAKAJQIgdBAWo2AlAgBSAHNgIoIAFBATYCHCABKAIEQX82AhwgAiADaiECIAZBAWoiBiAERw0ACwwBC0EAIQEDQCAAKAIAIQUCQCABRQRAIAUQISIBRQ0FIAAoAgAgASABKAIEEA0NAQwGCyAFIAEQEUUNBSABKAIMIQELIAEoAhAiBSACKgIAOAIMIAIqAgQhCCAFQQA2AhQgBSAIOAIQIAAgACgCUCIHQQFqNgJQIAUgBzYCKCABQQE2AhwgASgCBEF/NgIcIAIgA2ohAiAGQQFqIgYgBEcNAAsLDwsACyAAQQE2AgQPCyAAQQE2AgQLqAQBB38gAEEANgJkIABBADYCXCABKAIsIgUgAUEsaiIIRwRAQQAhAQNAIAUtABUEQCAFKAIIIgQhBgNAIAFBAWohASAGKAIMIgYgBEcNAAsgACABNgJcIAAgA0EBaiIDNgJkCyAFKAIAIgUgCEcNAAsLIAAgACgCdCADQQN0IAAoAmgRAAAiATYCYAJAIAFFBEAMAQsgACAAKAJ0IAIgACgCXGxBAnQgACgCaBEAACIBNgJUIAFFBEAMAQsgACAAKAJ0IAAoAlxBAnQgACgCaBEAACIGNgJYIAZFBEAMAQsCQCAIKAIAIgMgCEYNACAAKAJgIQQgACgCVCEBIAJBA04EQANAIAMtABUEQEEAIQAgAygCCCIJIQUDQCABIAUoAhAiAioCDDgCACABIAIqAhA4AgQgASACKgIUOAIIIAYgAigCKDYCACAAQQFqIQAgBkEEaiEGIAFBDGohASAFKAIMIgUgCUcNAAsgBCAANgIEIAQgBzYCACAAIAdqIQcgBEEIaiEECyADKAIAIgMgCEcNAAwCCwALA0AgAy0AFQRAQQAhACADKAIIIgkhAgNAIAEgAigCECIFKgIMOAIAIAEgBSoCEDgCBCAGIAUoAig2AgAgAEEBaiEAIAZBBGohBiABQQhqIQEgAigCDCICIAlHDQALIAQgADYCBCAEIAc2AgAgACAHaiEHIARBCGohBAsgAygCACIDIAhHDQALCw8LIABBATYCBAufBwEIfwJAAkAgA0EESA0AIAEgAxBQDQAMAQsgASABKAIAIgVHBEADQCAFQX82AiQgBSgCACIFIAFHDQALCwJAAkAgASgCLCIKIAFBLGoiC0YEQAwBCwNAIApBfzYCECAKLQAVBEBBACEGIAooAggiDCEFA0AgBiEIIAUoAhAiBigCJEF/RgRAIAYgBzYCJCAHQQFqIQcLIAhBAWohBiAFKAIMIgUgDEcNAAsgAyAITA0DIAogCTYCECAJQQFqIQkLIAooAgAiCiALRw0ACwsgACAJNgJkIAAgACgCdCADIAkgAkEBRnRsQQJ0IAAoAmgRAAAiBjYCYCAGRQRADAILIAAgBzYCXCAAIAAoAnQgBCAHbEECdCAAKAJoEQAAIgY2AlQgBkUEQAwCCyAAIAAoAnQgACgCXEECdCAAKAJoEQAAIgc2AlgCQAJAIAcEQCABKAIAIgUgAUYNAiAEQQNIDQEDQCAFKAIkIghBf0cEQCAAKAJUIAQgCGxBAnRqIgYgBSoCDDgCACAGIAUqAhA4AgQgBiAFKgIUOAIIIAcgCEECdGogBSgCKDYCAAsgBSgCACIFIAFHDQALDAILDAMLA0AgBSgCJCIIQX9HBEAgACgCVCAEIAhsQQJ0aiIGIAUqAgw4AgAgBiAFKgIQOAIEIAcgCEECdGogBSgCKDYCAAsgBSgCACIFIAFHDQALCwJAIAsoAgAiASALRg0AIAAoAmAhBSACQQFGBEADQAJAIAEtABVFDQBBACEHIAEoAggiAiEGA0AgBSAGKAIQKAIkNgIAIAciAEEBaiEHIAVBBGohBSAGKAIMIgYgAkcNAAsgAyAHSgRAIAUgAyAHa0ECdBAcIANBAnRqIABBf3NBAnRqIQULIAIhBgNAQX8hBAJAIAYoAgQoAhQiCEUNACAILQAVRQ0AIAgoAhAhBAsgBSAENgIAIAVBBGohBSAGKAIMIgYgAkcNAAsgAyAHTA0AIAUgAyAHa0ECdBAcIANBAnRqIABBf3NBAnRqIQULIAEoAgAiASALRw0ADAILAAsDQAJAIAEtABVFDQBBACEEIAEoAggiAiEGA0AgBSAGKAIQKAIkNgIAIAQiAEEBaiEEIAVBBGohBSAGKAIMIgYgAkcNAAsgAyAETA0AIAUgAyAEa0ECdBAcIANBAnRqIABBf3NBAnRqIQULIAEoAgAiASALRw0ACwsPC0HhFUGhFUHyBEH3FRAAAAsgAEEBNgIEC9gBAQJ/IwBBMGsiASQAIAEgACkCiAE3AyggASAAKQKAATcDICABIAApAng3AxggASAAKQJwNwMQIAEgACkCaDcDCCAAKAJMEBggACgCACICBEAgAUEIaiACEC0gAEEANgIACyAAKAJUIgIEQCABKAIUIAIgASgCEBEBACAAQQA2AlQLIAAoAlgiAgRAIAEoAhQgAiABKAIQEQEAIABBADYCWAsgACgCYCICBEAgASgCFCACIAEoAhARAQAgAEEANgJgCyABKAIUIAAgASgCEBEBACABQTBqJAAL/wICA38BfiAAQYgWIAAbIgIoAgAiAEUEQCACQYgWKAIAIgA2AgALIAIoAgRFBEAgAkGMFigCADYCBAsgAigCCEUEQCACQZAWKAIANgIICyACKAIMQawCIAARAAAiAUUEQEEADwsgASACKQIANwJoIAEgAikCIDcCiAEgASACKQIYNwKAASABIAIpAhAiBDcCeCABIAIpAgg3AnAgBKdFBEAgAUGABDYCeAsgASgCfEUEQCABQYAENgJ8CyABKAKAAUUEQCABQYACNgKAAQsgASgChAFFBEAgAUGABDYChAELIAEoAogBIgBFBEAgAUGAAjYCiAFBgAIhAAsgAUHoAGohAyABQgA3AiwgAUEANgIQIAFCADcCCCABQgA3AjQgAUEANgI8QRAhAgJAIABBEE4EQEGAICECIABBgSBIDQELIAEgAjYCiAEgAiEACyADQdkVQRwgABAZIQAgAUIANwJQIAFCADcCACABIAA2AkwgAUIANwJYIAFCADcCYCABCwYAIAEQFQsIACABIAIQJQsGACABEBYLvAUCBX8CfQJAAkAgASgCCCIBKAIMIgIgAUYNACACKAIMIAFGDQADQAJAIAEoAgQoAhAiAyoCGCIHIAEoAhAiAioCGCIIXUUEQCAHIAhcDQEgAyoCHCACKgIcX0UNAQsgASgCCCgCBCEBDAELCwNAAkAgByAIXkUEQCAHIAhcDQEgAioCHCADKgIcX0EBcw0BCyABKAIMIgEoAhAiAioCGCEIIAEoAgQoAhAiAyoCGCEHDAELCwJAIAEoAggoAgQiAiABKAIMRg0AA0ACQAJAIAcgAigCECIEKgIYIghdRQRAIAcgCFwNASADKgIcIAQqAhxfQQFzDQELAkAgAigCDCIDIAFGDQAgAkEMaiEEA0ACQCADKAIEKAIQIgUqAhgiByADKAIQIgYqAhgiCF0NACAHIAhbBEAgBSoCHCAGKgIcXw0BCyACKAIQIAIoAgQoAhAgBRAMQwAAAABfQQFzDQIgBCgCACEDCyAAIAMgAhASIgJFBEBBAA8LIAIoAgQiAkEMaiEEIAIoAgwiAyABRw0ACwsgAigCCCgCBCECDAELAkAgAigCDCABRg0AA0ACQCABKAIIKAIEIgMoAhAiBCoCGCIHIAMoAgQoAhAiBSoCGCIIXQ0AIAcgCFsEQCAEKgIcIAUqAhxfDQELIAEoAgQoAhAgASgCECAEEAxDAAAAAGBBAXMNAiABKAIIKAIEIQMLIAAgASADEBIiAUUEQEEADwsgASgCBCIBIAIoAgxHDQALCyABKAIMIQELIAEoAgwgAkYNASABKAIEKAIQIgMqAhghBwwACwALIAIoAgwiAyABRg0BIAEgAygCDEcEQANAIAAgAyACEBIiAkUEQEEADwsgAigCBCICKAIMIgMoAgwgAUcNAAsLQQEPC0H3FEGhFUHAAkGsFRAAAAtByRVBoRVB5AJBrBUQAAALfQECfyAAKAIMQRggACgCABEAACICRQRAQQAPCyACQQI2AhQgAiABNgIMIAJBADYCACACIAI2AgggAiACNgIEQRAhAwJAIAAoAhwiAUEQTgRAQYAgIQMgAUGBIEgNAQsgACADNgIcIAMhAQsgAiAAQYAIQQwgARAZNgIQIAILwwECA38BfQJAAkAgAioCGCIGIAEoAgAiAygCECIEKgIYWwRAIAQqAhwgAioCHFsNAQsCQCAGIAMoAgQiBCgCECIFKgIYWwRAIAUqAhwgAioCHFsNAQsgACgCACAEEBFFDQIgASgCGARAIAAoAgAgAygCCBAORQ0DIAFBADYCGAsgACgCACACKAIIIAMQDUUNAiAAIAIQGg8LQYoPQZwPQZ8HQagPEAAAC0GKD0GcD0GKB0GoDxAAAAsgAEGQAWpBARADAAvWAQICfwJ9IAIoAgAiAigCBCgCECEDIAEoAgAiASgCBCgCECIEIAAoAkgiAEYEQCAAIANGBEACQCABKAIQIgEqAhgiBSACKAIQIgIqAhgiBl1FBEAgBSAGXA0BIAEqAhwgAioCHF9BAXMNAQsgACABIAIQDEMAAAAAXw8LIAAgAiABEAxDAAAAAGAPCyADIAAgAigCEBAMQwAAAABfDwsgASgCECEBIAAgA0YEQCAEIAAgARAMQwAAAABgDwsgBCAAIAEQIyACKAIEKAIQIAAgAigCEBAjYAvcCAIGfwR9AkAgACgCACIDKAJEIgIgA0HEAGoiBUcEQANAIAIoAgwhASACKAIAIQMCQAJAIAIoAhAiBCoCGCACKAIEKAIQIgYqAhhcDQAgBCoCHCAGKgIcXA0AIAEoAgwgAkYNAAJAIAAoAgAgASACEA0EQCAAKAIAIAIQDkUNASABKAIMIQQMAwsMBQsMBAsgASEEIAIhAQsCQCABIAQoAgxHBEAgAyECDAELIAEgBEcEQAJAIAMgBEcEQCAEIAMoAgRHDQELIAMoAgAhAwsgACgCACAEEA5FDQQLAn8CQCABIANGDQAgASADKAIERg0AIAMMAQsgAygCAAshAiAAKAIAIAEQDkUNAwsgAiAFRw0ACyAAKAIAIQMLQQAhAiADIAMoAgAiAUcEQANAIAJBAWohAiABKAIAIgEgA0cNAAsLIAAgAEHoAGoiBSAAKAKMASIBQQggAUEIShsgAmoQTSIBNgJEAkACQAJAAkACQCABBH8CQAJAIAAoAgAiBCgCACICIARHBEADQCACIAUgASACECsiAzYCICADQf////8ARg0CIAIoAgAiAiAERw0ACwsgBSABEEwNAQsgBSAAKAJEECAgAEEANgJEQQAPCyAAIAUgABBGIgE2AkAgAUUNBiAAIAAqAiwiByAAKgI0IgggB5MiB5MiCSAIIAeSIgcgACoCMCIIIAAqAjgiCiAIkyIIkxAqIAAgCSAHIAogCJIQKiAAKAJEEB8iAgRAA0ACQCAAKAJEEEsiAUUNACABKgIYIAIqAhhcDQAgASoCHCACKgIcXA0AIAAoAkQQHyEBIAAoAgAgAigCCCABKAIIEA0NAQwJCyAAIAIQGiAAKAJEEB8iAg0ACwsgACAAKAJAIgMoAgQoAgAiAigCACgCEDYCSEEAIQEDQAJAIAIoAhAEQCABIQQMAQsgAigCGEUNA0EBIQQgAQ0ECyACKAIIDQQgAigCACEBIAIoAhgEQCABKAIcDQYLIAFBADYCGCACKAIEIgEoAgQiBiABKAIINgIIIAEoAgggBjYCBCABIAMoAhAiAygCADYCACADIAE2AgAgAiAAKAJMIgEoAgA2AgAgASACNgIAIAQhASAAKAJAIgMoAgQoAgAiAg0ACyADKAIQEBggBSgCDCADIAUoAggRAQAgBSAAKAJEECAgACgCACIEKAIsIgEgBEEsaiIDRwR/A0AgASgCCCIEKAIMIgIgBEYNByABKAIAIQECQCACKAIMIARHDQAgBCgCCCICIAIoAhwgBCgCHGo2AhwgAigCBCICIAIoAhwgBCgCBCgCHGo2AhwgACgCACAEEA4NAEEADwsgASADRw0ACyAAKAIABSAECxAsQQEFQQALDwtBvg9BnA9B+QhBnBQQAAALQakUQZwPQfoIQZwUEAAAC0G7FEGcD0H8CEGcFBAAAAtB8w9BnA9BkgFBihAQAAALQdMUQZwPQecJQeEUEAAACyAAQZABakEBEAMAC5YBAQN/IAFBAE4EQCAAKAIAIAEQTg8LAkAgAUF/cyIBIAAoAhBODQAgACgCBCABQQJ0aiIBKAIARQ0AIAFBADYCAAJAIAAoAgwiAUEBSA0AIAAoAgghAwNAIAMgAUEBayICQQJ0aigCACgCAA0BIAAgAjYCDCABQQFKIQQgAiEBIAQNAAsLDwtBvQ5BiA1B/ANB5g4QAAALkwECAX8CfSAAKAIMIgFFBEAgACgCACIAKAIEIAAoAgAoAgRBA3RqKAIADwsgACgCCCABQQJ0akEEaygCACgCACEBAkACQCAAKAIAIgAoAghFDQAgACgCBCAAKAIAKAIEQQN0aigCACIAKgIYIgIgASoCGCIDXQ0BIAIgA1wNACAAKgIcIAEqAhxfDQELIAEhAAsgAAvYBwIOfwJ9IwBBkANrIgskACABIAAoAgwgASgCDEECdEEEaiAAKAIAEQAAIgM2AggCQAJAIANFBEAMAQsgAyADIAEoAgwiD0ECdGpBBGsiBk0EQCABKAIEIQAgAyECA0AgAiAANgIAIABBBGohACACQQRqIgIgBk0NAAsLIAsgBjYCBCALIAM2AgBBw+HDwQchDEEBIQQDQCALIARBA3RqQQRrKAIAIgkgCyAIQQN0aigCACIFQShqSwRAA0AgBSAMQY2+ht4FbEEBaiIMIAkgBWtBAnVBAWpwQQJ0aiIAKAIAIQ0gACAFKAIANgIAIAUgDTYCACAJQQRqIQIgBUEEayEAA0AgAiEDIABBBGohAgJ/An8gACAAKAIEIgooAgAiByoCGCIQIA0oAgAiDioCGCIRXQ0AGgNAIAIhBAJAIBAgEVwNACAHKgIcIA4qAhxfRQ0AIAAhBiAEDAMLIARBBGohAiAEIgAoAgQiCigCACIHKgIYIhAgEV1BAXMNAAsgAAshBiACCyEAAkAgESADQQRrIgIoAgAiBCgCACIHKgIYIhBdDQADQAJAIBAgEVwNACAOKgIcIAcqAhxfRQ0ADAILIBEgAiIDQQRrIgIoAgAiBCgCACIHKgIYIhBdQQFzDQALCyAAIAQ2AgAgAiAKNgIAIAAgAkkNAAsgACgCACEEIAAgCjYCACACIAQ2AgACQCAAIAVrIAkgAmtIBEAgAyEAIAkhAiAGIQkMAQsgBSEAIAYhAiADIQULIAsgCEEDdGoiAyACNgIEIAMgADYCACAIQQFqIQggCSAFQShqSw0ACwsgCCEEIAkgBUEEaiIKTwRAA0AgCigCACEDAkAgCiICIgAgBU0NAANAIAMoAgAiBioCGCIQIAJBBGsiACgCACIHKAIAIggqAhgiEV0EQCACIQAMAgsCQCAQIBFcDQAgBioCHCAIKgIcX0UNACACIQAMAgsgAiAHNgIAIAUgACICSQ0ACwsgACADNgIAIApBBGoiCiAJTQ0ACwsgBEEBayEIIARBAU4NAAtBASECIAFBATYCFCABIA82AhAgASgCACIDKAIIIgBBAU4EQANAIAMgABAbIABBAUohBiAAQQFrIQAgBg0ACwsgA0EBNgIUIAEoAggiACAAIAEoAgxBAnRqQQRrIgNPDQAgACgCACgCACIHKgIYIRADQCAAKAIEKAIAIgEqAhgiESAQXUUEQCAQIBFcDQMgASoCHCAHKgIcX0UNAwsgESEQIAEhByAAQQRqIgAgA0kNAAsLIAtBkANqJAAgAg8LQYYOQYgNQZ0DQZoOEAAAC/ICAQR/IAAoAgxBHCAAKAIAEQAAIgNFBEBBAA8LAkACQAJAIAAoAgxBHCAAKAIAEQAAIgJFDQAgAiABNgIMIAJBADYCCCACIAAoAgwgAUEBaiIEQQJ0IAAoAgARAAAiBTYCACAFRQRAIAAoAgwgAiAAKAIIEQEADAELIAIgACgCDCAEQQN0IAAoAgARAAAiBDYCBCAEDQEgACgCDCACKAIAIAAoAggRAQAgACgCDCACIAAoAggRAQALIANBADYCAAwBCyACQQE2AhggAkIANwIQIAIoAgBBATYCBCAEQQA2AgggAyACNgIAIAMgACgCDCABQQJ0IAAoAgARAAAiAjYCBCACRQRAIAAoAgwgAygCACIBKAIEIAAoAggRAQAgACgCDCABKAIAIAAoAggRAQAgACgCDCABIAAoAggRAQAMAQsgA0EBNgIYIANBADYCFCADIAE2AhAgA0EANgIMIAMPCyAAKAIMIAMgACgCCBEBAEEAC6sDAgt/An0CQCABQQFIDQAgACgCDCABSA0AIAAoAgQiBCABQQN0aiIHKAIARQ0AIAAoAgAiBSAHKAIEIgNBAnRqIAUgACgCCCICQQJ0aigCACIINgIAIAQgCEEDdGoiDCADNgIEIAAgAkEBazYCCAJAIAIgA0wNAAJAAkAgA0ECSA0AIAQgBSADQQF2IglBAnRqKAIAIgZBA3RqKAIAIgIqAhgiDSAEIAhBA3RqKAIAIgoqAhgiDl0NACANIA5cDQEgAioCHCAKKgIcX0EBcw0BCyAAIAMQGwwBCwJAIA4gBCAGQQN0aigCACILKgIYIg1eBEAgAyECDAELA0AgCSECAkAgDSAOXA0AIAsqAhwgCioCHF9FDQAgAyECDAILIAUgA0ECdGogBjYCACAEIAZBA3RqIAM2AgQgAkEBdSIJRQ0BIAIhAyAEIAUgCUECdGooAgAiBkEDdGooAgAiCyoCGCINIA5dQQFzDQALCyAFIAJBAnRqIAg2AgAgDCACNgIECyAHQQA2AgAgByAAKAIQNgIEIAAgATYCEA8LQaUNQYgNQZICQdwNEAAAC8UDAgd/An0gASABKAIIQQFqIgM2AggCQAJAIAEoAgwiBCADQQF0Tg0AQf////8AIQUgACgCBCIGRQ0BIAEgBEEBdDYCDCABKAIEIQcgASAAKAIMIAEoAgAiCCAEQQN0QQRyIAYRAgAiBDYCACAERQRAIAEgCDYCAEH/////AA8LIAEgACgCDCABKAIEIAEoAgxBA3RBCGogACgCBBECACIANgIEIAANACABIAc2AgQMAQsgASgCBCEEIAMhBSABKAIQIgAEQCABIAQgAEEDdGooAgQ2AhAgACEFCyABKAIAIgYgA0ECdGogBTYCACAEIAVBA3RqIgcgAjYCACAHIAM2AgQgASgCFARAAkAgA0EBdSIARQRAIAMhAQwBCyACKgIYIQoDQCAKIAQgBiAAIgFBAnRqKAIAIgBBA3RqIggoAgAiCSoCGCILXgRAIAMhAQwCCwJAIAogC1wNACAJKgIcIAIqAhxfRQ0AIAMhAQwCCyAGIANBAnRqIAA2AgAgCCADNgIEIAEhAyABQQF1IgANAAsLIAYgAUECdGogBTYCACAHIAE2AgQLIAVB/////wBHDQBB9QxBiA1B8AFBmA0QAAALIAULogIBC38gACgCLCIEIABBLGoiCkcEQANAIAQtABUEQCAEQQhqKAIAIggoAhAhCwNAIAgiAigCDCEIAkAgAigCBCIDRQ0AIAMoAhQiB0UNACAHLQAVRQ0AQQAhBSAEKAIIIgkhBgNAIAUiDEEBaiEFIAYoAgwiBiAJRw0AC0EAIQUgBygCCCIHIQYDQCAFIglBAWohBSAGKAIMIgYgB0cNAAsgASAJIAxqTgRAIAIoAggoAgQoAhAgAigCECADKAIMKAIMKAIQEC5FDQEgAygCCCgCBCgCECADKAIQIAIoAgwoAgwoAhAQLkUNASADKAIMIQggACADEA4NAkEADwsgAkUNAQsgAigCDCgCECALRw0ACwsgBCgCACIEIApHDQALC0EBC90CAQR/IAAoAgxBkAEgACgCABEAACIBRQRAQQAPC0EQIQICQCAAKAIQIgNBEE4EQEGAICECIANBgSBIDQELIAAgAjYCECACIQMLQRAhAgJAIAAoAhQiBEEQTgRAQYAgIQIgBEGBIEgNAQsgACACNgIUC0EQIQICQCAAKAIYIgRBEE4EQEGAICECIARBgSBIDQELIAAgAjYCGAsgASAAQYoJQcAAIAMQGTYChAEgASAAQZUJQSwgACgCFBAZNgKIASABIABBowlBGCAAKAIYEBk2AowBIAEgAUEsaiIANgIwIAFBADYCCCABQgA3AkwgASABQeQAaiICNgJIIAEgAUHEAGoiAzYCRCABQQA7AUAgAUIANwI0IAEgADYCLCABQgA3AlQgAUIANwJcIAFCADcCbCABIAM2AmggASACNgJkIAFCADcCdCABQgA3AnwgASABNgIEIAEgATYCACABC7wCAQV/AkAgACgChAEQDyICRQ0AIAIgASgCBCIEIAEgASAESxsiBigCBCIDKAIAIgQ2AiAgBCgCBCACNgIAIAIgBjYCACADIAJBIGoiBDYCACACQgA3AhAgAiAENgIMIAIgBDYCBCACQgA3AhggAkIANwIwIAIgBDYCKCACQgA3AjggAiACNgIIIAIgAjYCLCACIAI2AiQgASgCDCIGKAIIIQMgAiAGNgIsIAMoAgQgAjYCDCACIAM2AgggBiACNgIIIAIgASgCBCgCEDYCECAAKAKIARAPIgNFDQAgAyACKAIQIgUoAgQiADYCBCAAIAM2AgAgAyAFNgIAIAUgAzYCBCADIAQ2AgggBCEAA0AgACADNgIQIAAoAggiACAERw0ACyACIAEoAhQiADYCFCACIAA2AjQgAiEFCyAFC6YRAgN/B30CQAJAIAAqAhgiCSABKgIYIghdDQAgCCAJWwRAIAAqAhwgASoCHF8NAQsgACEGDAELIAEhBiAAIQELAkACQCACKgIYIgkgAyoCGCIIXQ0AIAggCVsEQCACKgIcIAMqAhxfDQELIAIhAAwBCyAJIQggAyEAIAIhAwsCQAJAIAEqAhgiCSAIXQ0AIAggCVsEQCABKgIcIAMqAhxfDQELIAYhAiABIQUMAQsgCCEJIAAhAiADIQUgBiEAIAEhAwsCQAJAAkACQAJAAkACQAJAIAQCfQJAIAkgACoCGCIKXSIBDQAgCSAKWwRAIAUqAhwgACoCHF8NAQsgCSAKkkMAAAA/lAwBCwJAIAogAioCGCILXSIHRQRAIAogC1wiBg0BIAAqAhwgAioCHF9BAXMNAQsgAyoCGCIIIAldRQRAIAggCVwNBiADKgIcIAUqAhxfQQFzDQYLIAFFBEAgCSAKXA0GIAUqAhwgACoCHF9FDQYLIAogCZMiDSAJIAiTIgiSIg5DAAAAAF5BAXNFBEAgBSoCHCADIAAgCCANXSIGGyoCHCIMkyAIIA0gBhsgDpUgDCAAIAMgBhsqAhyTlJIhDAsgAUUEQCAJIApcDQYgBSoCHCAAKgIcX0EBcw0GCyAHRQRAIAogC1wNBiAAKgIcIAIqAhxfRQ0GC0MAAAAAIQggDIwgDAJ/IA0gCyAKkyILkiIOQwAAAABeQQFzRQRAIAAqAhwgBSACIAsgDV4iARsqAhwiCJMgDSALIAEbIA6VIAggAiAFIAEbKgIck5SSIQgLIAwgCJJDAAAAAF0iAQsbQwAAAACXIgsgCIwgCCABG0MAAAAAlyIIX0EBc0UEQCAJIAqSQwAAAD+UIAhDAAAAAFsNAhogCSANIAsgCyAIkpWUkgwCCyAKIAkgCpMgCCALIAiSlZSSDAELIAMqAhgiDSAJXUUEQCAJIA1cDQcgAyoCHCAFKgIcX0EBcw0HCyABRQRAIAkgClwNByAFKgIcIAAqAhxfRQ0HC0MAAAAAIQggCiAJkyIMIAkgDZMiDpJDAAAAAF5BAXNFBEAgDiAFKgIcIgggACoCHJOUIAwgCCADKgIck5SSIQgLIAsgDV5FBEAgCyANXA0HIAMqAhwgAioCHF9BAXMNBwsgCiALXkUEQCAGDQcgAioCHCAAKgIcX0UNBwtDAAAAACEMIAiMIAgCfyAKIAuTIgogCyANkyINkkMAAAAAXkEBc0UEQCANIAIqAhwiDCAAKgIck5QgCiAMIAMqAhyTlJIhDAsgCCAMk0MAAAAAXSIBCxtDAAAAAJciCiAMIAyMIAEbQwAAAACXIghfQQFzRQRAIAkgC5JDAAAAP5QgCEMAAAAAWw0BGiAJIAsgCZMgCiAKIAiSlZSSDAELIAsgCSALkyAIIAogCJKVlJILOAIYIAMqAhwiCSAAKgIcIghdDQEgCCAJWwRAIAMqAhggACoCGF8NAgsgAyEGDAILAAsgACEGIAMhAAsCQAJAIAUqAhwiCCACKgIcIgldDQAgCCAJWwRAIAUqAhggAioCGF8NAQsgBSEDDAELIAghCSACIQMgBSECCwJAAkAgACoCHCIIIAldDQAgCCAJWwRAIAAqAhggAioCGF8NAQsgBiEFIAAhAQwBCyADIQUgAiEBIAYhAyAAIQILAkAgASoCHCIJIAMqAhwiCl0iAA0AIAkgClsEQCABKgIYIAMqAhhfDQELDAILAkACQAJAIAogBSoCHCILXSIHRQRAIAogC1wiBg0BIAMqAhggBSoCGF9BAXMNAQsgAioCHCIIIAldRQRAIAggCVwNByACKgIYIAEqAhhfQQFzDQcLIABFBEAgCSAKXA0HIAEqAhggAyoCGF9FDQcLQwAAAAAhDCAKIAmTIg0gCSAIkyIIkiIOQwAAAABeQQFzRQRAIAEqAhggAiADIAggDV0iBhsqAhgiDJMgCCANIAYbIA6VIAwgAyACIAYbKgIYk5SSIQwLIABFBEAgCSAKXA0HIAEqAhggAyoCGF9BAXMNBwsgB0UEQCAKIAtcDQcgAyoCGCAFKgIYX0UNBwtDAAAAACEIIAyMIAwCfyANIAsgCpMiC5IiDkMAAAAAXkEBc0UEQCADKgIYIAEgBSALIA1eIgAbKgIYIgiTIA0gCyAAGyAOlSAIIAUgASAAGyoCGJOUkiEICyAMIAiSQwAAAABdIgALG0MAAAAAlyILIAiMIAggABtDAAAAAJciCF9BAXNFBEAgCEMAAAAAWwRADAYLIAQgCSANIAsgCyAIkpWUkjgCHA8LIAQgCiAJIAqTIAggCyAIkpWUkjgCHA8LIAIqAhwiDSAJXUUEQCAJIA1cDQcgAioCGCABKgIYX0EBcw0HCyAARQRAIAkgClwNByABKgIYIAMqAhhfRQ0HC0MAAAAAIQggCiAJkyIMIAkgDZMiDpJDAAAAAF5BAXNFBEAgDiABKgIYIgggAyoCGJOUIAwgCCACKgIYk5SSIQgLIAsgDV5FBEAgCyANXA0CIAIqAhggBSoCGF9BAXMNAgsgCiALXkUEQCAGDQIgBSoCGCADKgIYX0UNAgtDAAAAACEMIAiMIAgCfyAKIAuTIgogCyANkyINkkMAAAAAXkEBc0UEQCANIAUqAhgiDCADKgIYk5QgCiAMIAIqAhiTlJIhDAsgCCAMk0MAAAAAXSIACxtDAAAAAJciCiAMIAyMIAAbQwAAAACXIghfQQFzRQRAIAhDAAAAAFsEQCAEIAkgC5JDAAAAP5Q4AhwPCyAEIAkgCyAJkyAKIAogCJKVlJI4AhwPCyAEIAsgCSALkyAIIAogCJKVlJI4AhwPCwALDAQLQYUIQagIQTpBswgQAAALIAQgCSAKkkMAAAA/lDgCHA8LQYUIQagIQdIAQb8IEAAAC0HLCEGoCEHxAEHwCBAAAAtBywhBqAhBiQFB/QgQAAALC6UOAwBBgAgLhQ5EaWN0AFZlcnRMZXEoIHUsIHYgKSAmJiBWZXJ0TGVxKCB2LCB3ICkAc3JjL2dlb20uYwB0ZXNlZGdlRXZhbAB0ZXNlZGdlU2lnbgBUcmFuc0xlcSggdSwgdiApICYmIFRyYW5zTGVxKCB2LCB3ICkAdGVzdHJhbnNFdmFsAHRlc3RyYW5zU2lnbgBNZXNoIEVkZ2VzAE1lc2ggVmVydGljZXMATWVzaCBGYWNlcwBmLT5wcmV2ID09IGZQcmV2AHNyYy9tZXNoLmMAdGVzc01lc2hDaGVja01lc2gAZS0+U3ltICE9IGUAZS0+U3ltLT5TeW0gPT0gZQBlLT5MbmV4dC0+T25leHQtPlN5bSA9PSBlAGUtPk9uZXh0LT5TeW0tPkxuZXh0ID09IGUAZS0+TGZhY2UgPT0gZgBmLT5wcmV2ID09IGZQcmV2ICYmIGYtPmFuRWRnZSA9PSBOVUxMAHYtPnByZXYgPT0gdlByZXYAZS0+T3JnID09IHYAdi0+cHJldiA9PSB2UHJldiAmJiB2LT5hbkVkZ2UgPT0gTlVMTABlLT5TeW0tPm5leHQgPT0gZVByZXYtPlN5bQBlLT5PcmcgIT0gTlVMTABlLT5Ec3QgIT0gTlVMTABlLT5TeW0tPm5leHQgPT0gZVByZXYtPlN5bSAmJiBlLT5TeW0gPT0gJm1lc2gtPmVIZWFkU3ltICYmIGUtPlN5bS0+U3ltID09IGUgJiYgZS0+T3JnID09IE5VTEwgJiYgZS0+RHN0ID09IE5VTEwgJiYgZS0+TGZhY2UgPT0gTlVMTCAmJiBlLT5SZmFjZSA9PSBOVUxMAGZyZWUgIT0gSU5WX0hBTkRMRQBzcmMvcHJpb3JpdHlxLmMAcHFIZWFwSW5zZXJ0AGhDdXJyID49IDEgJiYgaEN1cnIgPD0gcHEtPm1heCAmJiBoW2hDdXJyXS5rZXkgIT0gTlVMTABwcUhlYXBEZWxldGUAcHEgIT0gTlVMTABwcURlbGV0ZVByaW9yaXR5UQBMRVEoICoqKGkrMSksICoqaSApAHBxSW5pdABjdXJyICE9IElOVl9IQU5ETEUAcHFJbnNlcnQAY3VyciA8IHBxLT5tYXggJiYgcHEtPmtleXNbY3Vycl0gIT0gTlVMTABwcURlbGV0ZQBjaGlsZCA8PSBwcS0+bWF4AEZsb2F0RG93bgBUT0xFUkFOQ0VfTk9OWkVSTwBzcmMvc3dlZXAuYwBDb25uZWN0TGVmdERlZ2VuZXJhdGUAcmVnLT5maXhVcHBlckVkZ2UARml4VXBwZXJFZGdlAEZBTFNFAElzV2luZGluZ0luc2lkZQByZWctPmVVcC0+d2luZGluZyA9PSAwAERlbGV0ZVJlZ2lvbgAhIFZlcnRFcSggZHN0TG8sIGRzdFVwICkAQ2hlY2tGb3JJbnRlcnNlY3QARWRnZVNpZ24oIGRzdFVwLCB0ZXNzLT5ldmVudCwgb3JnVXAgKSA8PSAwAEVkZ2VTaWduKCBkc3RMbywgdGVzcy0+ZXZlbnQsIG9yZ0xvICkgPj0gMABvcmdVcCAhPSB0ZXNzLT5ldmVudCAmJiBvcmdMbyAhPSB0ZXNzLT5ldmVudAAhIHJlZ1VwLT5maXhVcHBlckVkZ2UgJiYgISByZWdMby0+Zml4VXBwZXJFZGdlAE1JTiggb3JnVXAtPnQsIGRzdFVwLT50ICkgPD0gaXNlY3QudABpc2VjdC50IDw9IE1BWCggb3JnTG8tPnQsIGRzdExvLT50ICkATUlOKCBkc3RMby0+cywgZHN0VXAtPnMgKSA8PSBpc2VjdC5zAGlzZWN0LnMgPD0gTUFYKCBvcmdMby0+cywgb3JnVXAtPnMgKQAhIFZlcnRFcSggZVVwLT5Ec3QsIGVMby0+RHN0ICkAQ2hlY2tGb3JMZWZ0U3BsaWNlAFZlcnRMZXEoIGUtPk9yZywgZS0+RHN0ICkAQWRkUmlnaHRFZGdlcwByZWdQcmV2LT53aW5kaW5nTnVtYmVyIC0gZS0+d2luZGluZyA9PSByZWctPndpbmRpbmdOdW1iZXIARG9uZUVkZ2VEaWN0ACsrZml4ZWRFZGdlcyA9PSAxAHJlZy0+d2luZGluZ051bWJlciA9PSAwAGUtPkxuZXh0ICE9IGUAUmVtb3ZlRGVnZW5lcmF0ZUZhY2VzAHVwLT5MbmV4dCAhPSB1cCAmJiB1cC0+TG5leHQtPkxuZXh0ICE9IHVwAHNyYy90ZXNzLmMAdGVzc01lc2hUZXNzZWxsYXRlTW9ub1JlZ2lvbgBsby0+TG5leHQgIT0gdXAAUmVnaW9ucwBmYWNlVmVydHMgPD0gcG9seVNpemUAT3V0cHV0UG9seW1lc2gAQYgWCwkMAAAADQAAAA4AQbAWCwNADVA=";if(!Pe(De)){var Xe=De;De=t.locateFile?t.locateFile(Xe,y):y+Xe}function Ne(){try{if(b)return new Uint8Array(b);var oe=De;if(Pe(oe))try{var Me=de(oe.slice(37)),je=new Uint8Array(Me.length);for(oe=0;oe<Me.length;++oe)je[oe]=Me.charCodeAt(oe);var _e=je}catch{throw Error("Converting base64 string to bytes failed.")}else _e=void 0;var Ye=_e;if(Ye)return Ye;throw"both async and sync fetching of the wasm failed"}catch(q){ve(q)}}function et(){return b||typeof fetch!="function"?Promise.resolve().then(Ne):fetch(De,{credentials:"same-origin"}).then(function(oe){if(!oe.ok)throw"failed to load wasm binary file at '"+De+"'";return oe.arrayBuffer()}).catch(function(){return Ne()})}function ze(oe){for(;0<oe.length;){var Me=oe.shift();if(typeof Me=="function")Me(t);else{var je=Me.J;typeof je=="number"?Me.H===void 0?k.get(je)():k.get(je)(Me.H):je(Me.H===void 0?null:Me.H)}}}var de=typeof atob=="function"?atob:function(oe){var Me="",je=0;oe=oe.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var _e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(oe.charAt(je++)),Ye="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(oe.charAt(je++)),q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(oe.charAt(je++)),we="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(oe.charAt(je++));_e=_e<<2|Ye>>4,Ye=(Ye&15)<<4|q>>2;var M=(q&3)<<6|we;Me+=String.fromCharCode(_e),q!==64&&(Me+=String.fromCharCode(Ye)),we!==64&&(Me+=String.fromCharCode(M))}while(je<oe.length);return Me};H.push({J:function(){he()}});var lt={a:function(oe,Me,je,_e){ve("Assertion failed: "+F(oe)+", at: "+[Me?F(Me):"unknown filename",je,_e?F(_e):"unknown function"])},d:function(oe,Me){throw He(oe,Me||1),"longjmp"},k:function(oe,Me,je){R.copyWithin(oe,Me,Me+je)},l:function(oe){oe>>>=0;var Me=R.length;if(2147483648<oe)return!1;for(var je=1;4>=je;je*=2){var _e=Me*(1+.2/je);_e=Math.min(_e,oe+100663296),_e=Math.max(16777216,oe,_e),0<_e%65536&&(_e+=65536-_e%65536);e:{try{C.grow(Math.min(2147483648,_e)-G.byteLength+65535>>>16),P();var Ye=1;break e}catch{}Ye=void 0}if(Ye)return!0}return!1},c:function(){return w|0},j:ge,g:Le,f:W,e:Y,h:pe,i:Ve,b:function(oe){w=oe|0}};(function(){function oe(Ye){t.asm=Ye.exports,C=t.asm.m,P(),k=t.asm.n,Q--,t.monitorRunDependencies&&t.monitorRunDependencies(Q),Q==0&&ne&&(Ye=ne,ne=null,Ye())}function Me(Ye){oe(Ye.instance)}function je(Ye){return et().then(function(q){return WebAssembly.instantiate(q,_e)}).then(Ye,function(q){A("failed to asynchronously prepare wasm: "+q),ve(q)})}var _e={a:lt};if(Q++,t.monitorRunDependencies&&t.monitorRunDependencies(Q),t.instantiateWasm)try{return t.instantiateWasm(_e,oe)}catch(Ye){return A("Module.instantiateWasm callback failed with error: "+Ye),!1}return function(){return b||typeof WebAssembly.instantiateStreaming!="function"||Pe(De)||typeof fetch!="function"?je(Me):fetch(De,{credentials:"same-origin"}).then(function(Ye){return WebAssembly.instantiateStreaming(Ye,_e).then(Me,function(q){return A("wasm streaming compile failed: "+q),A("falling back to ArrayBuffer instantiation"),je(Me)})})}().catch(r),{}})();var he=t.___wasm_call_ctors=function(){return(he=t.___wasm_call_ctors=t.asm.o).apply(null,arguments)};t._malloc=function(){return(t._malloc=t.asm.p).apply(null,arguments)},t._free=function(){return(t._free=t.asm.q).apply(null,arguments)},t._tessNewTess=function(){return(t._tessNewTess=t.asm.r).apply(null,arguments)},t._tessDeleteTess=function(){return(t._tessDeleteTess=t.asm.s).apply(null,arguments)},t._tessAddContour=function(){return(t._tessAddContour=t.asm.t).apply(null,arguments)},t._tessTesselate=function(){return(t._tessTesselate=t.asm.u).apply(null,arguments)},t._tessGetVertexCount=function(){return(t._tessGetVertexCount=t.asm.v).apply(null,arguments)},t._tessGetVertices=function(){return(t._tessGetVertices=t.asm.w).apply(null,arguments)},t._tessGetVertexIndices=function(){return(t._tessGetVertexIndices=t.asm.x).apply(null,arguments)},t._tessGetElementCount=function(){return(t._tessGetElementCount=t.asm.y).apply(null,arguments)},t._tessGetElements=function(){return(t._tessGetElements=t.asm.z).apply(null,arguments)};var Ce=t.stackSave=function(){return(Ce=t.stackSave=t.asm.A).apply(null,arguments)},se=t.stackRestore=function(){return(se=t.stackRestore=t.asm.B).apply(null,arguments)},Re=t.stackAlloc=function(){return(Re=t.stackAlloc=t.asm.C).apply(null,arguments)},He=t._setThrew=function(){return(He=t._setThrew=t.asm.D).apply(null,arguments)};function Y(oe,Me,je){var _e=Ce();try{k.get(oe)(Me,je)}catch(Ye){if(se(_e),Ye!==Ye+0&&Ye!=="longjmp")throw Ye;He(1,0)}}function W(oe,Me){var je=Ce();try{k.get(oe)(Me)}catch(_e){if(se(je),_e!==_e+0&&_e!=="longjmp")throw _e;He(1,0)}}function ge(oe,Me){var je=Ce();try{return k.get(oe)(Me)}catch(_e){if(se(je),_e!==_e+0&&_e!=="longjmp")throw _e;He(1,0)}}function Le(oe,Me,je){var _e=Ce();try{return k.get(oe)(Me,je)}catch(Ye){if(se(_e),Ye!==Ye+0&&Ye!=="longjmp")throw Ye;He(1,0)}}function Ve(oe,Me,je,_e,Ye,q){var we=Ce();try{k.get(oe)(Me,je,_e,Ye,q)}catch(M){if(se(we),M!==M+0&&M!=="longjmp")throw M;He(1,0)}}function pe(oe,Me,je,_e){var Ye=Ce();try{k.get(oe)(Me,je,_e)}catch(q){if(se(Ye),q!==q+0&&q!=="longjmp")throw q;He(1,0)}}t.cwrap=function(oe,Me,je,_e){je=je||[];var Ye=je.every(function(q){return q==="number"});return Me!=="string"&&Ye&&!_e?x(oe):function(){return T(oe,Me,je,arguments)}};var fe;ne=function oe(){fe||Ee(),fe||(ne=oe)};function Ee(){function oe(){if(!fe&&(fe=!0,t.calledRun=!0,!I)){if(ze(H),ze(U),i(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;){var Me=t.postRun.shift();$.unshift(Me)}ze($)}}if(!(0<Q)){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)j();ze(L),0<Q||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),oe()},1)):oe())}}if(t.run=Ee,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return Ee(),e.ready}}();let jC=null;const c1e=async()=>{jC=(await T9()).Tess};c1e();const u1e=n=>{const e=new jC;try{const{contours:t,fillRule:i=yd.EVENODD}=n;if(t.length<=0)return;e.addContours(t);const s={windingRule:i===yd.EVENODD?0:1,elementType:0,polySize:3,vertexSize:2},o=e.tesselate(s);if(!o)return e.dispose(),{elements:[],vertices:[]};const a=new Uint32Array(o.elements),l=new Float32Array(o.vertices);return e.dispose(),{elements:a,vertices:l}}catch(t){e.dispose(),console.error(t.message)}},h1e={build(){},triangulate(n,e){const t=()=>{const i=n.shape,r=i.contours.filter(o=>o.length>0).filter(o=>o.find(a=>isNaN(a))===void 0);if(r.length<=0)return;const s=u1e({contours:r,fillRule:i.fillRule});s&&s.elements.length>0&&(s.elements.forEach(o=>{e.indices.push(o)}),s.vertices.forEach(o=>{e.points.push(o)}))};jC?t():T9().then(async({Tess:i})=>{jC=i,t()})}};var I9=function(e){for(var t={command:/\s*([achlmqstvz])/gi,number:/\s*([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/gi,comma:/\s*(?:(,)|\s)/g,flag:/\s*([01])/g},i={number:function(f){var p=h("number",f);return p===null?null:+p},"coordinate pair":function(f){var p=h("number",f);if(p===null&&!f)return null;h("comma");var g=h("number",!0);return{x:+p,y:+g}},"arc definition":function(f){var p=i["coordinate pair"](f);if(!p&&!f)return null;h("comma");var g=+h("number",!0);h("comma",!0);var m=!!+h("flag",!0);h("comma");var v=!!+h("flag",!0);h("comma");var _=i["coordinate pair"](!0);return{radii:p,rotation:g,large:m,clockwise:v,end:_}}},r=0,s=[];r<e.length;){var o=h("command"),a=o.toUpperCase(),l=o!==a,c;switch(a){case"M":c=d("coordinate pair").map(function(f,p){return p===1&&(o=l?"l":"L"),u({end:f})});break;case"L":case"T":c=d("coordinate pair").map(function(f){return u({end:f})});break;case"C":if(c=d("coordinate pair"),c.length%3)throw Error("Expected coordinate pair triplet at position "+r);c=c.reduce(function(f,p,g){var m=g%3;if(!m)f.push(u({cp1:p}));else{var v=f[f.length-1];v[m===1?"cp2":"end"]=p}return f},[]);break;case"Q":case"S":if(c=d("coordinate pair"),c.length&1)throw Error("Expected coordinate pair couple at position "+r);c=c.reduce(function(f,p,g){var m=g&1;if(!m)f.push(u({cp:p}));else{var v=f[f.length-1];v.end=p}return f},[]);break;case"H":case"V":c=d("number").map(function(f){return u({value:f})});break;case"A":c=d("arc definition").map(u);break;case"Z":c=[{code:"Z"}];break;default:console.warn("unparse cmd",a)}s.push.apply(s,c)}return s;function u(f){return f.code=o,f.relative=l,f}function h(f,p){t[f].lastIndex=r;var g=t[f].exec(e);if(!g||g.index!==r){if(!p)return null;throw Error("Expected "+f+" at position "+r)}return r=t[f].lastIndex,g[1]}function d(f){for(var p=[],g,m=!0;(g=i[f](m))!==null;)p.push(g),m=!!h("comma");return p}};oI.FILL_COMMANDS[WC]=h1e;const NH=.001;class QC extends vm{constructor(t,i){super(t);E(this,"currentPath2");E(this,"dPath");E(this,"fillRule",yd.NONZERO);E(this,"type",it.PATH);E(this,"startPoly",this.startPath);E(this,"finishPoly",this.finishPath);if(i){const r=typeof i.dPath=="string"?`d="${i.dPath}"`:"",s=new DOMParser().parseFromString(`<path ${r} />`,"image/svg+xml").documentElement;this.embedPath(s,i.fillRule),this.addHitArea(),this.parseJSON(i),this.draw()}this.interactive=!0}startPath(){this.currentPath2?this.currentPath2.points.length>0&&this.currentPath2.closeContour():this.currentPath2=new b2}finishPath(){this.currentPath2&&this.currentPath2.closeContour()}getRealPoints(t){return this.graphicsPoints.map(i=>(t&&(i=i9(i,this,t)),i))}get currentPath(){return this.currentPath2}set currentPath(t){if(t)throw new Error("currentPath cannot be set")}get graphicsPoints(){const t=[];return this.geometry.graphicsData.forEach(r=>{const{shape:s}=r;s.contours.forEach(a=>{if(a.length>0){const l=r9(a);t.push(l)}})}),t}decideClosePath(){let i=!0;return this.graphicsPoints.some(s=>s.length===0?!1:s.length<=2?!0:Math.abs(s[0].x-s[s.length-1].x)>.05||Math.abs(s[0].y-s[s.length-1].y)>.05)&&(i=!1),i}closePath(){return this.currentPath2.points.push(this.currentPath2.points[0],this.currentPath2.points[1]),this.finishPath(),this}checkPath(){if(this.currentPath2.points.find(t=>isNaN(t))!==void 0)throw new Error("NaN is bad")}isCommandsValid(t){const i=o=>o.code.toUpperCase()==="M";return!t.every(i)}parseElement(t){var a,l;const i=t.getAttribute("d");if(this.dPath=i,!i)return;const r=I9(i.trim());if(!this.isCommandsValid(r))return;let s=0,o=0;for(let c=0,u=r.length;c<u;c++){const h=r[c-1],d=r[c];if(isNaN(s)||isNaN(o))throw new Error("Data corruption");switch(d.code){case"m":{this.moveTo(s+=d.end.x,o+=d.end.y);break}case"M":{this.moveTo(s=d.end.x,o=d.end.y);break}case"H":{this.lineTo(s=d.value,o);break}case"h":{this.lineTo(s+=d.value,o);break}case"V":{this.lineTo(s,o=d.value);break}case"v":{this.lineTo(s,o+=d.value);break}case"z":case"Z":{s=((a=this.currentPath2)==null?void 0:a.points[0])||0,o=((l=this.currentPath2)==null?void 0:l.points[1])||0,this.closePath();break}case"L":{this.lineTo(s=d.end.x,o=d.end.y);break}case"l":{this.lineTo(s+=d.end.x,o+=d.end.y);break}case"C":{this.bezierCurveTo(d.cp1.x,d.cp1.y,d.cp2.x,d.cp2.y,s=d.end.x,o=d.end.y);break}case"c":{const f=s,p=o;this.bezierCurveTo(f+d.cp1.x,p+d.cp1.y,f+d.cp2.x,p+d.cp2.y,s+=d.end.x,o+=d.end.y);break}case"s":case"S":{const f={x:s,y:o},p=r[c-1]?r[c-1].code:null;if(c>0&&(p==="s"||p==="S"||p==="c"||p==="C")){const m=r[c-1],v={...m.cp2||m.cp};r[c-1].relative&&(v.x+=s-m.end.x,v.y+=o-m.end.y),f.x=2*s-v.x,f.y=2*o-v.y}const g={x:d.cp.x,y:d.cp.y};d.relative?(g.x+=s,g.y+=o,s+=d.end.x,o+=d.end.y):(s=d.end.x,o=d.end.y),this.bezierCurveTo(f.x,f.y,g.x,g.y,s,o);break}case"q":{const f=s,p=o;this.quadraticCurveTo(f+d.cp.x,p+d.cp.y,s+=d.end.x,o+=d.end.y);break}case"Q":{this.quadraticCurveTo(d.cp.x,d.cp.y,s=d.end.x,o=d.end.y);break}case"A":this.ellipticArcTo(s=d.end.x,o=d.end.y,d.radii.x,d.radii.y,(d.rotation||0)*Math.PI/180,!d.clockwise,d.large);break;case"a":this.ellipticArcTo(s+=d.end.x,o+=d.end.y,d.radii.x,d.radii.y,(d.rotation||0)*Math.PI/180,!d.clockwise,d.large);break;case"t":case"T":{let f,p;if(h&&h.cp){let g=h.cp.x,m=h.cp.y;if(h.relative){const v=s-h.end.x,_=o-h.end.y;g+=v,m+=_}f=2*s-g,p=2*o-m}else f=s,p=o;d.code==="t"?this.quadraticCurveTo(f,p,s+=d.end.x,o+=d.end.y):this.quadraticCurveTo(f,p,s=d.end.x,o=d.end.y);break}default:{console.warn("[PIXI.SVG] Draw command not supported:",d.code,d);break}}this.anchorPoints.push(new Ae(s,o))}}embedPath(t,i){return this.parseElement(t),this.currentPath2&&(this.currentPath2.fillRule=i||t.getAttribute("fill-rule")||this.currentPath2.fillRule,this.fillRule=this.currentPath2.fillRule,this.drawShape(this.currentPath2),this.isClosePath=this.decideClosePath(),this.currentPath2=null),this}toJSON(t){const{dPath:i,x:r,y:s}=this,o=super.toJSON(t),a=this.parent.toGlobal(new Ae(r,s)),{x:l,y:c}=t.toLocal({x:a.x,y:a.y});return{...o,dPath:i,fillRule:this.fillRule,graphicX:l,graphicY:c}}enterEditMode(){}getSVGData(t){return Ln(super.getSVGData(t),{tag:"path",attrs:{d:this.dPath,fillRule:this.fillRule}})}getLocalBounds(){const t=super.getLocalBounds(),{width:i,height:r}=t;return(i||r)&&(t.width=i||NH,t.height=r||NH),t}}/*!
 * @pixi/filter-adjustment - v4.1.3
 * Compiled Thu, 17 Jun 2021 19:33:56 UTC
 *
 * @pixi/filter-adjustment is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var sD=function(n,e){return sD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},sD(n,e)};function d1e(n,e){sD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var f1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,p1e=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform float gamma;
uniform float contrast;
uniform float saturation;
uniform float brightness;
uniform float red;
uniform float green;
uniform float blue;
uniform float alpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (c.a > 0.0) {
        c.rgb /= c.a;

        vec3 rgb = pow(c.rgb, vec3(1. / gamma));
        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
        rgb.r *= red;
        rgb.g *= green;
        rgb.b *= blue;
        c.rgb = rgb * brightness;

        c.rgb *= c.a;
    }

    gl_FragColor = c * alpha;
}
`;(function(n){d1e(e,n);function e(t){var i=n.call(this,f1e,p1e)||this;return i.gamma=1,i.saturation=1,i.contrast=1,i.brightness=1,i.red=1,i.green=1,i.blue=1,i.alpha=1,Object.assign(i,t),i}return e.prototype.apply=function(t,i,r,s){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,i,r,s)},e})(yn);/*!
 * @pixi/filter-kawase-blur - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-kawase-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var oD=function(n,e){return oD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},oD(n,e)};function g1e(n,e){oD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var m1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,v1e=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,_1e=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`,XC=function(n){g1e(e,n);function e(t,i,r){t===void 0&&(t=4),i===void 0&&(i=3),r===void 0&&(r=!1);var s=n.call(this,m1e,r?_1e:v1e)||this;return s._kernels=[],s._blur=4,s._quality=3,s.uniforms.uOffset=new Float32Array(2),s._pixelSize=new Ae,s.pixelSize=1,s._clamp=r,Array.isArray(t)?s.kernels=t:(s._blur=t,s.quality=i),s}return e.prototype.apply=function(t,i,r,s){var o=this._pixelSize.x/i._frame.width,a=this._pixelSize.y/i._frame.height,l;if(this._quality===1||this._blur===0)l=this._kernels[0]+.5,this.uniforms.uOffset[0]=l*o,this.uniforms.uOffset[1]=l*a,t.applyFilter(this,i,r,s);else{for(var c=t.getFilterTexture(),u=i,h=c,d=void 0,f=this._quality-1,p=0;p<f;p++)l=this._kernels[p]+.5,this.uniforms.uOffset[0]=l*o,this.uniforms.uOffset[1]=l*a,t.applyFilter(this,u,h,1),d=u,u=h,h=d;l=this._kernels[f]+.5,this.uniforms.uOffset[0]=l*o,this.uniforms.uOffset[1]=l*a,t.applyFilter(this,u,r,s),t.returnFilterTexture(c)}},e.prototype._updatePadding=function(){this.padding=Math.ceil(this._kernels.reduce(function(t,i){return t+i+.5},0))},e.prototype._generateKernels=function(){var t=this._blur,i=this._quality,r=[t];if(t>0)for(var s=t,o=t/i,a=1;a<i;a++)s-=o,r.push(s);this._kernels=r,this._updatePadding()},Object.defineProperty(e.prototype,"kernels",{get:function(){return this._kernels},set:function(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max.apply(Math,t)):(this._kernels=[0],this._quality=1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clamp",{get:function(){return this._clamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pixelSize",{get:function(){return this._pixelSize},set:function(t){typeof t=="number"?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof Ae?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blur",{get:function(){return this._blur},set:function(t){this._blur=t,this._generateKernels()},enumerable:!1,configurable:!0}),e}(yn);/*!
 * @pixi/filter-advanced-bloom - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-advanced-bloom is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var aD=function(n,e){return aD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},aD(n,e)};function S9(n,e){aD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var P9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,y1e=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`,A1e=function(n){S9(e,n);function e(t){t===void 0&&(t=.5);var i=n.call(this,P9,y1e)||this;return i.threshold=t,i}return Object.defineProperty(e.prototype,"threshold",{get:function(){return this.uniforms.threshold},set:function(t){this.uniforms.threshold=t},enumerable:!1,configurable:!0}),e}(yn),b1e=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`;(function(n){S9(e,n);function e(t){var i=n.call(this,P9,b1e)||this;i.bloomScale=1,i.brightness=1,i._resolution=xt.FILTER_RESOLUTION,typeof t=="number"&&(t={threshold:t});var r=Object.assign(e.defaults,t);i.bloomScale=r.bloomScale,i.brightness=r.brightness;var s=r.kernels,o=r.blur,a=r.quality,l=r.pixelSize,c=r.resolution;return i._extractFilter=new A1e(r.threshold),i._extractFilter.resolution=c,i._blurFilter=s?new XC(s):new XC(o,a),i.pixelSize=l,i.resolution=c,i}return e.prototype.apply=function(t,i,r,s,o){var a=t.getFilterTexture();this._extractFilter.apply(t,i,a,1,o);var l=t.getFilterTexture();this._blurFilter.apply(t,a,l,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=l,t.applyFilter(this,i,r,s),t.returnFilterTexture(l),t.returnFilterTexture(a)},Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"threshold",{get:function(){return this._extractFilter.threshold},set:function(t){this._extractFilter.threshold=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"kernels",{get:function(){return this._blurFilter.kernels},set:function(t){this._blurFilter.kernels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blur",{get:function(){return this._blurFilter.blur},set:function(t){this._blurFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._blurFilter.quality},set:function(t){this._blurFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pixelSize",{get:function(){return this._blurFilter.pixelSize},set:function(t){this._blurFilter.pixelSize=t},enumerable:!1,configurable:!0}),e.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:xt.FILTER_RESOLUTION},e})(yn);/*!
 * @pixi/filter-ascii - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-ascii is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lD=function(n,e){return lD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},lD(n,e)};function w1e(n,e){lD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var x1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,C1e=`varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform float pixelSize;
uniform sampler2D uSampler;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 pixelate(vec2 coord, vec2 size)
{
    return floor( coord / size ) * size;
}

vec2 getMod(vec2 coord, vec2 size)
{
    return mod( coord , size) / size;
}

float character(float n, vec2 p)
{
    p = floor(p*vec2(4.0, -4.0) + 2.5);

    if (clamp(p.x, 0.0, 4.0) == p.x)
    {
        if (clamp(p.y, 0.0, 4.0) == p.y)
        {
            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;
        }
    }
    return 0.0;
}

void main()
{
    vec2 coord = mapCoord(vTextureCoord);

    // get the rounded color..
    vec2 pixCoord = pixelate(coord, vec2(pixelSize));
    pixCoord = unmapCoord(pixCoord);

    vec4 color = texture2D(uSampler, pixCoord);

    // determine the character to use
    float gray = (color.r + color.g + color.b) / 3.0;

    float n =  65536.0;             // .
    if (gray > 0.2) n = 65600.0;    // :
    if (gray > 0.3) n = 332772.0;   // *
    if (gray > 0.4) n = 15255086.0; // o
    if (gray > 0.5) n = 23385164.0; // &
    if (gray > 0.6) n = 15252014.0; // 8
    if (gray > 0.7) n = 13199452.0; // @
    if (gray > 0.8) n = 11512810.0; // #

    // get the mod..
    vec2 modd = getMod(coord, vec2(pixelSize));

    gl_FragColor = color * character( n, vec2(-1.0) + modd * 2.0);

}
`;(function(n){w1e(e,n);function e(t){t===void 0&&(t=8);var i=n.call(this,x1e,C1e)||this;return i.size=t,i}return Object.defineProperty(e.prototype,"size",{get:function(){return this.uniforms.pixelSize},set:function(t){this.uniforms.pixelSize=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-bevel - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-bevel is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cD=function(n,e){return cD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},cD(n,e)};function E1e(n,e){cD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var T1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,I1e=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform float transformX;
uniform float transformY;
uniform vec3 lightColor;
uniform float lightAlpha;
uniform vec3 shadowColor;
uniform float shadowAlpha;

void main(void) {
    vec2 transform = vec2(1.0 / filterArea) * vec2(transformX, transformY);
    vec4 color = texture2D(uSampler, vTextureCoord);
    float light = texture2D(uSampler, vTextureCoord - transform).a;
    float shadow = texture2D(uSampler, vTextureCoord + transform).a;

    color.rgb = mix(color.rgb, lightColor, clamp((color.a - light) * lightAlpha, 0.0, 1.0));
    color.rgb = mix(color.rgb, shadowColor, clamp((color.a - shadow) * shadowAlpha, 0.0, 1.0));
    gl_FragColor = vec4(color.rgb * color.a, color.a);
}
`;(function(n){E1e(e,n);function e(t){var i=n.call(this,T1e,I1e)||this;return i._thickness=2,i._angle=0,i.uniforms.lightColor=new Float32Array(3),i.uniforms.shadowColor=new Float32Array(3),Object.assign(i,{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7},t),i.padding=1,i}return e.prototype._updateTransform=function(){this.uniforms.transformX=this._thickness*Math.cos(this._angle),this.uniforms.transformY=this._thickness*Math.sin(this._angle)},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._angle/Yo},set:function(t){this._angle=t*Yo,this._updateTransform()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t,this._updateTransform()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightColor",{get:function(){return al(this.uniforms.lightColor)},set:function(t){_s(t,this.uniforms.lightColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightAlpha",{get:function(){return this.uniforms.lightAlpha},set:function(t){this.uniforms.lightAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return al(this.uniforms.shadowColor)},set:function(t){_s(t,this.uniforms.shadowColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowAlpha",{get:function(){return this.uniforms.shadowAlpha},set:function(t){this.uniforms.shadowAlpha=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-bloom - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-bloom is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uD=function(n,e){return uD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},uD(n,e)};function S1e(n,e){uD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}(function(n){S1e(e,n);function e(t,i,r,s){t===void 0&&(t=2),i===void 0&&(i=4),r===void 0&&(r=xt.FILTER_RESOLUTION),s===void 0&&(s=5);var o=n.call(this)||this,a,l;return typeof t=="number"?(a=t,l=t):t instanceof Ae?(a=t.x,l=t.y):Array.isArray(t)&&(a=t[0],l=t[1]),o.blurXFilter=new EA(!0,a,i,r,s),o.blurYFilter=new EA(!1,l,i,r,s),o.blurYFilter.blendMode=Xt.SCREEN,o.defaultFilter=new MY,o}return e.prototype.apply=function(t,i,r,s){var o=t.getFilterTexture();this.defaultFilter.apply(t,i,r,s),this.blurXFilter.apply(t,i,o,1),this.blurYFilter.apply(t,o,r,0),t.returnFilterTexture(o)},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-bulge-pinch - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-bulge-pinch is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hD=function(n,e){return hD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},hD(n,e)};function P1e(n,e){hD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var M1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,R1e=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`;(function(n){P1e(e,n);function e(t){var i=n.call(this,M1e,R1e)||this;return i.uniforms.dimensions=new Float32Array(2),Object.assign(i,e.defaults,t),i}return e.prototype.apply=function(t,i,r,s){var o=i.filterFrame,a=o.width,l=o.height;this.uniforms.dimensions[0]=a,this.uniforms.dimensions[1]=l,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.uniforms.strength},set:function(t){this.uniforms.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this.uniforms.center},set:function(t){this.uniforms.center=t},enumerable:!1,configurable:!0}),e.defaults={center:[.5,.5],radius:100,strength:1},e})(yn);/*!
 * @pixi/filter-color-map - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-color-map is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var dD=function(n,e){return dD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},dD(n,e)};function D1e(n,e){dD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var k1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,O1e=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D colorMap;
uniform float _mix;
uniform float _size;
uniform float _sliceSize;
uniform float _slicePixelSize;
uniform float _sliceInnerSize;
void main() {
    vec4 color = texture2D(uSampler, vTextureCoord.xy);

    vec4 adjusted;
    if (color.a > 0.0) {
        color.rgb /= color.a;
        float innerWidth = _size - 1.0;
        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);
        float zSlice1 = min(zSlice0 + 1.0, innerWidth);
        float xOffset = _slicePixelSize * 0.5 + color.r * _sliceInnerSize;
        float s0 = xOffset + (zSlice0 * _sliceSize);
        float s1 = xOffset + (zSlice1 * _sliceSize);
        float yOffset = _sliceSize * 0.5 + color.g * (1.0 - _sliceSize);
        vec4 slice0Color = texture2D(colorMap, vec2(s0,yOffset));
        vec4 slice1Color = texture2D(colorMap, vec2(s1,yOffset));
        float zOffset = fract(color.b * innerWidth);
        adjusted = mix(slice0Color, slice1Color, zOffset);

        color.rgb *= color.a;
    }
    gl_FragColor = vec4(mix(color, adjusted, _mix).rgb, color.a);

}`;(function(n){D1e(e,n);function e(t,i,r){i===void 0&&(i=!1),r===void 0&&(r=1);var s=n.call(this,k1e,O1e)||this;return s.mix=1,s._size=0,s._sliceSize=0,s._slicePixelSize=0,s._sliceInnerSize=0,s._nearest=!1,s._scaleMode=null,s._colorMap=null,s._scaleMode=null,s.nearest=i,s.mix=r,s.colorMap=t,s}return e.prototype.apply=function(t,i,r,s){this.uniforms._mix=this.mix,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"colorSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"colorMap",{get:function(){return this._colorMap},set:function(t){var i;t&&(t instanceof Wt||(t=Wt.from(t)),!((i=t)===null||i===void 0)&&i.baseTexture&&(t.baseTexture.scaleMode=this._scaleMode,t.baseTexture.mipmap=sl.OFF,this._size=t.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms._size=this._size,this.uniforms._sliceSize=this._sliceSize,this.uniforms._slicePixelSize=this._slicePixelSize,this.uniforms._sliceInnerSize=this._sliceInnerSize,this.uniforms.colorMap=t),this._colorMap=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nearest",{get:function(){return this._nearest},set:function(t){this._nearest=t,this._scaleMode=t?ga.NEAREST:ga.LINEAR;var i=this._colorMap;i&&i.baseTexture&&(i.baseTexture._glTextures={},i.baseTexture.scaleMode=this._scaleMode,i.baseTexture.mipmap=sl.OFF,i._updateID++,i.baseTexture.emit("update",i.baseTexture))},enumerable:!1,configurable:!0}),e.prototype.updateColorMap=function(){var t=this._colorMap;t&&t.baseTexture&&(t._updateID++,t.baseTexture.emit("update",t.baseTexture),this.colorMap=t)},e.prototype.destroy=function(t){t===void 0&&(t=!1),this._colorMap&&this._colorMap.destroy(t),n.prototype.destroy.call(this)},e})(yn);/*!
 * @pixi/filter-color-overlay - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-color-overlay is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fD=function(n,e){return fD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},fD(n,e)};function L1e(n,e){fD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var N1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,B1e=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 color;
uniform float alpha;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = vec4(mix(currentColor.rgb, color.rgb, currentColor.a * alpha), currentColor.a);
}
`,F1e=function(n){L1e(e,n);function e(t,i){t===void 0&&(t=0),i===void 0&&(i=1);var r=n.call(this,N1e,B1e)||this;return r._color=0,r._alpha=1,r.uniforms.color=new Float32Array(3),r.color=t,r.alpha=i,r}return Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){var i=this.uniforms.color;typeof t=="number"?(_s(t,i),this._color=t):(i[0]=t[0],i[1]=t[1],i[2]=t[2],this._color=al(i))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this.uniforms.alpha=t,this._alpha=t},enumerable:!1,configurable:!0}),e}(yn);/*!
 * @pixi/filter-color-replace - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-color-replace is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var pD=function(n,e){return pD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},pD(n,e)};function U1e(n,e){pD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var G1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,H1e=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 originalColor;
uniform vec3 newColor;
uniform float epsilon;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec3 colorDiff = originalColor - (currentColor.rgb / max(currentColor.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    float doReplace = step(colorDistance, epsilon);
    gl_FragColor = vec4(mix(currentColor.rgb, (newColor + colorDiff) * currentColor.a, doReplace), currentColor.a);
}
`;(function(n){U1e(e,n);function e(t,i,r){t===void 0&&(t=16711680),i===void 0&&(i=0),r===void 0&&(r=.4);var s=n.call(this,G1e,H1e)||this;return s._originalColor=16711680,s._newColor=0,s.uniforms.originalColor=new Float32Array(3),s.uniforms.newColor=new Float32Array(3),s.originalColor=t,s.newColor=i,s.epsilon=r,s}return Object.defineProperty(e.prototype,"originalColor",{get:function(){return this._originalColor},set:function(t){var i=this.uniforms.originalColor;typeof t=="number"?(_s(t,i),this._originalColor=t):(i[0]=t[0],i[1]=t[1],i[2]=t[2],this._originalColor=al(i))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newColor",{get:function(){return this._newColor},set:function(t){var i=this.uniforms.newColor;typeof t=="number"?(_s(t,i),this._newColor=t):(i[0]=t[0],i[1]=t[1],i[2]=t[2],this._newColor=al(i))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"epsilon",{get:function(){return this.uniforms.epsilon},set:function(t){this.uniforms.epsilon=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-convolution - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-convolution is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gD=function(n,e){return gD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},gD(n,e)};function V1e(n,e){gD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var z1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$1e=`precision mediump float;

varying mediump vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec2 texelSize;
uniform float matrix[9];

void main(void)
{
   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left
   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center
   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right

   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left
   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center
   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right

   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left
   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center
   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right

   gl_FragColor =
       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +
       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +
       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];

   gl_FragColor.a = c22.a;
}
`;(function(n){V1e(e,n);function e(t,i,r){i===void 0&&(i=200),r===void 0&&(r=200);var s=n.call(this,z1e,$1e)||this;return s.uniforms.texelSize=new Float32Array(2),s.uniforms.matrix=new Float32Array(9),t!==void 0&&(s.matrix=t),s.width=i,s.height=r,s}return Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.matrix},set:function(t){var i=this;t.forEach(function(r,s){i.uniforms.matrix[s]=r})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 1/this.uniforms.texelSize[0]},set:function(t){this.uniforms.texelSize[0]=1/t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 1/this.uniforms.texelSize[1]},set:function(t){this.uniforms.texelSize[1]=1/t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-cross-hatch - v4.1.3
 * Compiled Thu, 17 Jun 2021 19:33:56 UTC
 *
 * @pixi/filter-cross-hatch is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var mD=function(n,e){return mD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},mD(n,e)};function W1e(n,e){mD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var j1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Q1e=`precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void)
{
    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);

    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);

    if (lum < 1.00)
    {
        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)
        {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
        }
    }

    if (lum < 0.75)
    {
        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)
        {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
        }
    }

    if (lum < 0.50)
    {
        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)
        {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
        }
    }

    if (lum < 0.3)
    {
        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)
        {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
        }
    }
}
`;(function(n){W1e(e,n);function e(){return n.call(this,j1e,Q1e)||this}return e})(yn);/*!
 * @pixi/filter-crt - v4.1.6
 * Compiled Thu, 03 Feb 2022 14:30:04 UTC
 *
 * @pixi/filter-crt is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var vD=function(n,e){return vD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},vD(n,e)};function X1e(n,e){vD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Y1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,q1e=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`;(function(n){X1e(e,n);function e(t){var i=n.call(this,Y1e,q1e)||this;return i.time=0,i.seed=0,i.uniforms.dimensions=new Float32Array(2),Object.assign(i,e.defaults,t),i}return e.prototype.apply=function(t,i,r,s){var o=i.filterFrame,a=o.width,l=o.height;this.uniforms.dimensions[0]=a,this.uniforms.dimensions[1]=l,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"curvature",{get:function(){return this.uniforms.curvature},set:function(t){this.uniforms.curvature=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.uniforms.lineWidth},set:function(t){this.uniforms.lineWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineContrast",{get:function(){return this.uniforms.lineContrast},set:function(t){this.uniforms.lineContrast=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalLine",{get:function(){return this.uniforms.verticalLine},set:function(t){this.uniforms.verticalLine=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.noise},set:function(t){this.uniforms.noise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noiseSize",{get:function(){return this.uniforms.noiseSize},set:function(t){this.uniforms.noiseSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignetting",{get:function(){return this.uniforms.vignetting},set:function(t){this.uniforms.vignetting=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignettingAlpha",{get:function(){return this.uniforms.vignettingAlpha},set:function(t){this.uniforms.vignettingAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignettingBlur",{get:function(){return this.uniforms.vignettingBlur},set:function(t){this.uniforms.vignettingBlur=t},enumerable:!1,configurable:!0}),e.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0},e})(yn);/*!
 * @pixi/filter-dot - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-dot is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _D=function(n,e){return _D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},_D(n,e)};function K1e(n,e){_D(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var J1e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Z1e=`precision mediump float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform vec4 filterArea;
uniform sampler2D uSampler;

uniform float angle;
uniform float scale;

float pattern()
{
   float s = sin(angle), c = cos(angle);
   vec2 tex = vTextureCoord * filterArea.xy;
   vec2 point = vec2(
       c * tex.x - s * tex.y,
       s * tex.x + c * tex.y
   ) * scale;
   return (sin(point.x) * sin(point.y)) * 4.0;
}

void main()
{
   vec4 color = texture2D(uSampler, vTextureCoord);
   float average = (color.r + color.g + color.b) / 3.0;
   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);
}
`,ePe=function(n){K1e(e,n);function e(t,i){t===void 0&&(t=1),i===void 0&&(i=5);var r=n.call(this,J1e,Z1e)||this;return r.scale=t,r.angle=i,r}return Object.defineProperty(e.prototype,"scale",{get:function(){return this.uniforms.scale},set:function(t){this.uniforms.scale=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.uniforms.angle},set:function(t){this.uniforms.angle=t},enumerable:!1,configurable:!0}),e}(yn);/*!
 * @pixi/filter-drop-shadow - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-drop-shadow is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yD=function(n,e){return yD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},yD(n,e)};function tPe(n,e){yD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var YC=function(){return YC=Object.assign||function(e){for(var t=arguments,i,r=1,s=arguments.length;r<s;r++){i=t[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},YC.apply(this,arguments)},nPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,iPe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`;(function(n){tPe(e,n);function e(t){var i=n.call(this)||this;i.angle=45,i._distance=5,i._resolution=xt.FILTER_RESOLUTION;var r=t?YC(YC({},e.defaults),t):e.defaults,s=r.kernels,o=r.blur,a=r.quality,l=r.pixelSize,c=r.resolution;i._tintFilter=new yn(nPe,iPe),i._tintFilter.uniforms.color=new Float32Array(4),i._tintFilter.uniforms.shift=new Ae,i._tintFilter.resolution=c,i._blurFilter=s?new XC(s):new XC(o,a),i.pixelSize=l,i.resolution=c;var u=r.shadowOnly,h=r.rotation,d=r.distance,f=r.alpha,p=r.color;return i.shadowOnly=u,i.rotation=h,i.distance=d,i.alpha=f,i.color=p,i._updatePadding(),i}return e.prototype.apply=function(t,i,r,s){var o=t.getFilterTexture();this._tintFilter.apply(t,i,o,1),this._blurFilter.apply(t,o,r,s),this.shadowOnly!==!0&&t.applyFilter(this,i,r,0),t.returnFilterTexture(o)},e.prototype._updatePadding=function(){this.padding=this.distance+this.blur*2},e.prototype._updateShift=function(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))},Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=t,this._updatePadding(),this._updateShift()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.angle/Yo},set:function(t){this.angle=t*Yo,this._updateShift()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._tintFilter.uniforms.alpha},set:function(t){this._tintFilter.uniforms.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return al(this._tintFilter.uniforms.color)},set:function(t){_s(t,this._tintFilter.uniforms.color)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"kernels",{get:function(){return this._blurFilter.kernels},set:function(t){this._blurFilter.kernels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blur",{get:function(){return this._blurFilter.blur},set:function(t){this._blurFilter.blur=t,this._updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._blurFilter.quality},set:function(t){this._blurFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pixelSize",{get:function(){return this._blurFilter.pixelSize},set:function(t){this._blurFilter.pixelSize=t},enumerable:!1,configurable:!0}),e.defaults={rotation:45,distance:5,color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:xt.FILTER_RESOLUTION},e})(yn);/*!
 * @pixi/filter-emboss - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-emboss is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var AD=function(n,e){return AD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},AD(n,e)};function rPe(n,e){AD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var sPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,oPe=`precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float strength;
uniform vec4 filterArea;


void main(void)
{
	vec2 onePixel = vec2(1.0 / filterArea);

	vec4 color;

	color.rgb = vec3(0.5);

	color -= texture2D(uSampler, vTextureCoord - onePixel) * strength;
	color += texture2D(uSampler, vTextureCoord + onePixel) * strength;

	color.rgb = vec3((color.r + color.g + color.b) / 3.0);

	float alpha = texture2D(uSampler, vTextureCoord).a;

	gl_FragColor = vec4(color.rgb * alpha, alpha);
}
`,aPe=function(n){rPe(e,n);function e(t){t===void 0&&(t=5);var i=n.call(this,sPe,oPe)||this;return i.strength=t,i}return Object.defineProperty(e.prototype,"strength",{get:function(){return this.uniforms.strength},set:function(t){this.uniforms.strength=t},enumerable:!1,configurable:!0}),e}(yn);/*!
 * @pixi/filter-glitch - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-glitch is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bD=function(n,e){return bD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},bD(n,e)};function lPe(n,e){bD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var cPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,uPe=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`;(function(n){lPe(e,n);function e(t){var i=n.call(this,cPe,uPe)||this;return i.offset=100,i.fillMode=e.TRANSPARENT,i.average=!1,i.seed=0,i.minSize=8,i.sampleSize=512,i._slices=0,i._offsets=new Float32Array(1),i._sizes=new Float32Array(1),i._direction=-1,i.uniforms.dimensions=new Float32Array(2),i._canvas=document.createElement("canvas"),i._canvas.width=4,i._canvas.height=i.sampleSize,i.texture=Wt.from(i._canvas,{scaleMode:ga.NEAREST}),Object.assign(i,e.defaults,t),i}return e.prototype.apply=function(t,i,r,s){var o=i.filterFrame,a=o.width,l=o.height;this.uniforms.dimensions[0]=a,this.uniforms.dimensions[1]=l,this.uniforms.aspect=l/a,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,i,r,s)},e.prototype._randomizeSizes=function(){var t=this._sizes,i=this._slices-1,r=this.sampleSize,s=Math.min(this.minSize/r,.9/this._slices);if(this.average){for(var o=this._slices,a=1,l=0;l<i;l++){var c=a/(o-l),u=Math.max(c*(1-Math.random()*.6),s);t[l]=u,a-=u}t[i]=a}else{for(var a=1,h=Math.sqrt(1/this._slices),l=0;l<i;l++){var u=Math.max(h*a*Math.random(),s);t[l]=u,a-=u}t[i]=a}this.shuffle()},e.prototype.shuffle=function(){for(var t=this._sizes,i=this._slices-1,r=i;r>0;r--){var s=Math.random()*r>>0,o=t[r];t[r]=t[s],t[s]=o}},e.prototype._randomizeOffsets=function(){for(var t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)},e.prototype.refresh=function(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()},e.prototype.redraw=function(){var t=this.sampleSize,i=this.texture,r=this._canvas.getContext("2d");r.clearRect(0,0,8,t);for(var s,o=0,a=0;a<this._slices;a++){s=Math.floor(this._offsets[a]*256);var l=this._sizes[a]*t,c=s>0?s:0,u=s<0?-s:0;r.fillStyle="rgba("+c+", "+u+", 0, 1)",r.fillRect(0,o>>0,t,l+1>>0),o+=l}i.baseTexture.update(),this.uniforms.displacementMap=i},Object.defineProperty(e.prototype,"sizes",{get:function(){return this._sizes},set:function(t){for(var i=Math.min(this._slices,t.length),r=0;r<i;r++)this._sizes[r]=t[r]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return this._offsets},set:function(t){for(var i=Math.min(this._slices,t.length),r=0;r<i;r++)this._offsets[r]=t[r]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"slices",{get:function(){return this._slices},set:function(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){if(this._direction!==t){this._direction=t;var i=t*Yo;this.uniforms.sinDir=Math.sin(i),this.uniforms.cosDir=Math.cos(i)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"red",{get:function(){return this.uniforms.red},set:function(t){this.uniforms.red=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"green",{get:function(){return this.uniforms.green},set:function(t){this.uniforms.green=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blue",{get:function(){return this.uniforms.blue},set:function(t){this.uniforms.blue=t},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){var t;(t=this.texture)===null||t===void 0||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null},e.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},e.TRANSPARENT=0,e.ORIGINAL=1,e.LOOP=2,e.CLAMP=3,e.MIRROR=4,e})(yn);/*!
 * @pixi/filter-glow - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-glow is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wD=function(n,e){return wD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},wD(n,e)};function hPe(n,e){wD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var dPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,fPe=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;
    
    if (knockout) {
      float resultAlpha = outerGlowAlpha + innerGlowAlpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`;(function(n){hPe(e,n);function e(t){var i=this,r=Object.assign({},e.defaults,t),s=r.outerStrength,o=r.innerStrength,a=r.color,l=r.knockout,c=r.quality,u=Math.round(r.distance);return i=n.call(this,dPe,fPe.replace(/__ANGLE_STEP_SIZE__/gi,""+(1/c/u).toFixed(7)).replace(/__DIST__/gi,u.toFixed(0)+".0"))||this,i.uniforms.glowColor=new Float32Array([0,0,0,1]),Object.assign(i,{color:a,outerStrength:s,innerStrength:o,padding:u,knockout:l}),i}return Object.defineProperty(e.prototype,"color",{get:function(){return al(this.uniforms.glowColor)},set:function(t){_s(t,this.uniforms.glowColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outerStrength",{get:function(){return this.uniforms.outerStrength},set:function(t){this.uniforms.outerStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerStrength",{get:function(){return this.uniforms.innerStrength},set:function(t){this.uniforms.innerStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.uniforms.knockout},set:function(t){this.uniforms.knockout=t},enumerable:!1,configurable:!0}),e.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1},e})(yn);/*!
 * @pixi/filter-godray - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-godray is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var xD=function(n,e){return xD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},xD(n,e)};function pPe(n,e){xD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var gPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,mPe=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,vPe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`;(function(n){pPe(e,n);function e(t){var i=n.call(this,gPe,vPe.replace("${perlin}",mPe))||this;i.parallel=!0,i.time=0,i._angle=0,i.uniforms.dimensions=new Float32Array(2);var r=Object.assign(e.defaults,t);return i._angleLight=new Ae,i.angle=r.angle,i.gain=r.gain,i.lacunarity=r.lacunarity,i.alpha=r.alpha,i.parallel=r.parallel,i.center=r.center,i.time=r.time,i}return e.prototype.apply=function(t,i,r,s){var o=i.filterFrame,a=o.width,l=o.height;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=a,this.uniforms.dimensions[1]=l,this.uniforms.aspect=l/a,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t;var i=t*Yo;this._angleLight.x=Math.cos(i),this._angleLight.y=Math.sin(i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gain",{get:function(){return this.uniforms.gain},set:function(t){this.uniforms.gain=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lacunarity",{get:function(){return this.uniforms.lacunarity},set:function(t){this.uniforms.lacunarity=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.alpha},set:function(t){this.uniforms.alpha=t},enumerable:!1,configurable:!0}),e.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1},e})(yn);/*!
 * @pixi/filter-motion-blur - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-motion-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var CD=function(n,e){return CD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},CD(n,e)};function _Pe(n,e){CD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var yPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,APe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uVelocity;
uniform int uKernelSize;
uniform float uOffset;

const int MAX_KERNEL_SIZE = 2048;

// Notice:
// the perfect way:
//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);
// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.
// So use uKernelSize directly.

void main(void)
{
    vec4 color = texture2D(uSampler, vTextureCoord);

    if (uKernelSize == 0)
    {
        gl_FragColor = color;
        return;
    }

    vec2 velocity = uVelocity / filterArea.xy;
    float offset = -uOffset / length(uVelocity) - 0.5;
    int k = uKernelSize - 1;

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }
        vec2 bias = velocity * (float(i) / float(k) + offset);
        color += texture2D(uSampler, vTextureCoord + bias);
    }
    gl_FragColor = color / float(uKernelSize);
}
`;(function(n){_Pe(e,n);function e(t,i,r){t===void 0&&(t=[0,0]),i===void 0&&(i=5),r===void 0&&(r=0);var s=n.call(this,yPe,APe)||this;return s.kernelSize=5,s.uniforms.uVelocity=new Float32Array(2),s._velocity=new Gu(s.velocityChanged,s),s.setVelocity(t),s.kernelSize=i,s.offset=r,s}return e.prototype.apply=function(t,i,r,s){var o=this.velocity,a=o.x,l=o.y;this.uniforms.uKernelSize=a!==0||l!==0?this.kernelSize:0,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this.setVelocity(t)},enumerable:!1,configurable:!0}),e.prototype.setVelocity=function(t){if(Array.isArray(t)){var i=t[0],r=t[1];this._velocity.set(i,r)}else this._velocity.copyFrom(t)},e.prototype.velocityChanged=function(){this.uniforms.uVelocity[0]=this._velocity.x,this.uniforms.uVelocity[1]=this._velocity.y,this.padding=(Math.max(Math.abs(this._velocity.x),Math.abs(this._velocity.y))>>0)+1},Object.defineProperty(e.prototype,"offset",{get:function(){return this.uniforms.uOffset},set:function(t){this.uniforms.uOffset=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-multi-color-replace - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-multi-color-replace is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ED=function(n,e){return ED=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},ED(n,e)};function bPe(n,e){ED(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var wPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,xPe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform float epsilon;

const int MAX_COLORS = %maxColors%;

uniform vec3 originalColors[MAX_COLORS];
uniform vec3 targetColors[MAX_COLORS];

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);

    float alpha = gl_FragColor.a;
    if (alpha < 0.0001)
    {
      return;
    }

    vec3 color = gl_FragColor.rgb / alpha;

    for(int i = 0; i < MAX_COLORS; i++)
    {
      vec3 origColor = originalColors[i];
      if (origColor.r < 0.0)
      {
        break;
      }
      vec3 colorDiff = origColor - color;
      if (length(colorDiff) < epsilon)
      {
        vec3 targetColor = targetColors[i];
        gl_FragColor = vec4((targetColor + colorDiff) * alpha, alpha);
        return;
      }
    }
}
`;(function(n){bPe(e,n);function e(t,i,r){i===void 0&&(i=.05),r===void 0&&(r=t.length);var s=n.call(this,wPe,xPe.replace(/%maxColors%/g,r.toFixed(0)))||this;return s._replacements=[],s._maxColors=0,s.epsilon=i,s._maxColors=r,s.uniforms.originalColors=new Float32Array(r*3),s.uniforms.targetColors=new Float32Array(r*3),s.replacements=t,s}return Object.defineProperty(e.prototype,"replacements",{get:function(){return this._replacements},set:function(t){var i=this.uniforms.originalColors,r=this.uniforms.targetColors,s=t.length;if(s>this._maxColors)throw new Error("Length of replacements ("+s+") exceeds the maximum colors length ("+this._maxColors+")");i[s*3]=-1;for(var o=0;o<s;o++){var a=t[o],l=a[0];typeof l=="number"?l=_s(l):a[0]=al(l),i[o*3]=l[0],i[o*3+1]=l[1],i[o*3+2]=l[2];var c=a[1];typeof c=="number"?c=_s(c):a[1]=al(c),r[o*3]=c[0],r[o*3+1]=c[1],r[o*3+2]=c[2]}this._replacements=t},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){this.replacements=this._replacements},Object.defineProperty(e.prototype,"maxColors",{get:function(){return this._maxColors},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"epsilon",{get:function(){return this.uniforms.epsilon},set:function(t){this.uniforms.epsilon=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-old-film - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-old-film is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var TD=function(n,e){return TD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},TD(n,e)};function CPe(n,e){TD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var EPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,TPe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`;(function(n){CPe(e,n);function e(t,i){i===void 0&&(i=0);var r=n.call(this,EPe,TPe)||this;return r.seed=0,r.uniforms.dimensions=new Float32Array(2),typeof t=="number"?(r.seed=t,t=void 0):r.seed=i,Object.assign(r,e.defaults,t),r}return e.prototype.apply=function(t,i,r,s){var o,a;this.uniforms.dimensions[0]=(o=i.filterFrame)===null||o===void 0?void 0:o.width,this.uniforms.dimensions[1]=(a=i.filterFrame)===null||a===void 0?void 0:a.height,this.uniforms.seed=this.seed,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"sepia",{get:function(){return this.uniforms.sepia},set:function(t){this.uniforms.sepia=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.noise},set:function(t){this.uniforms.noise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noiseSize",{get:function(){return this.uniforms.noiseSize},set:function(t){this.uniforms.noiseSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scratch",{get:function(){return this.uniforms.scratch},set:function(t){this.uniforms.scratch=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scratchDensity",{get:function(){return this.uniforms.scratchDensity},set:function(t){this.uniforms.scratchDensity=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scratchWidth",{get:function(){return this.uniforms.scratchWidth},set:function(t){this.uniforms.scratchWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignetting",{get:function(){return this.uniforms.vignetting},set:function(t){this.uniforms.vignetting=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignettingAlpha",{get:function(){return this.uniforms.vignettingAlpha},set:function(t){this.uniforms.vignettingAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vignettingBlur",{get:function(){return this.uniforms.vignettingBlur},set:function(t){this.uniforms.vignettingBlur=t},enumerable:!1,configurable:!0}),e.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3},e})(yn);/*!
 * @pixi/filter-outline - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-outline is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ID=function(n,e){return ID=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},ID(n,e)};function IPe(n,e){ID(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var SPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,PPe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 thickness;
uniform vec4 outlineColor;
uniform vec4 filterClamp;

const float DOUBLE_PI = 3.14159265358979323846264 * 2.;

void main(void) {
    vec4 ownColor = texture2D(uSampler, vTextureCoord);
    vec4 curColor;
    float maxAlpha = 0.;
    vec2 displaced;
    for (float angle = 0.; angle <= DOUBLE_PI; angle += \${angleStep}) {
        displaced.x = vTextureCoord.x + thickness.x * cos(angle);
        displaced.y = vTextureCoord.y + thickness.y * sin(angle);
        curColor = texture2D(uSampler, clamp(displaced, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, curColor.a);
    }
    float resultAlpha = max(maxAlpha, ownColor.a);
    gl_FragColor = vec4((ownColor.rgb + outlineColor.rgb * (1. - ownColor.a)) * resultAlpha, resultAlpha);
}
`;(function(n){IPe(e,n);function e(t,i,r){t===void 0&&(t=1),i===void 0&&(i=0),r===void 0&&(r=.1);var s=n.call(this,SPe,PPe.replace(/\$\{angleStep\}/,e.getAngleStep(r)))||this;return s._thickness=1,s.uniforms.thickness=new Float32Array([0,0]),s.uniforms.outlineColor=new Float32Array([0,0,0,1]),Object.assign(s,{thickness:t,color:i,quality:r}),s}return e.getAngleStep=function(t){var i=Math.max(t*e.MAX_SAMPLES,e.MIN_SAMPLES);return(Math.PI*2/i).toFixed(7)},e.prototype.apply=function(t,i,r,s){this.uniforms.thickness[0]=this._thickness/i._frame.width,this.uniforms.thickness[1]=this._thickness/i._frame.height,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"color",{get:function(){return al(this.uniforms.outlineColor)},set:function(t){_s(t,this.uniforms.outlineColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t,this.padding=t},enumerable:!1,configurable:!0}),e.MIN_SAMPLES=1,e.MAX_SAMPLES=100,e})(yn);/*!
 * @pixi/filter-pixelate - v4.1.3
 * Compiled Thu, 17 Jun 2021 19:33:56 UTC
 *
 * @pixi/filter-pixelate is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var SD=function(n,e){return SD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},SD(n,e)};function MPe(n,e){SD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var RPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,DPe=`precision mediump float;

varying vec2 vTextureCoord;

uniform vec2 size;
uniform sampler2D uSampler;

uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 pixelate(vec2 coord, vec2 size)
{
	return floor( coord / size ) * size;
}

void main(void)
{
    vec2 coord = mapCoord(vTextureCoord);

    coord = pixelate(coord, size);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord);
}
`;(function(n){MPe(e,n);function e(t){t===void 0&&(t=10);var i=n.call(this,RPe,DPe)||this;return i.size=t,i}return Object.defineProperty(e.prototype,"size",{get:function(){return this.uniforms.size},set:function(t){typeof t=="number"&&(t=[t,t]),this.uniforms.size=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-radial-blur - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-radial-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var PD=function(n,e){return PD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},PD(n,e)};function kPe(n,e){PD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var OPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,LPe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform float uRadian;
uniform vec2 uCenter;
uniform float uRadius;
uniform int uKernelSize;

const int MAX_KERNEL_SIZE = 2048;

void main(void)
{
    vec4 color = texture2D(uSampler, vTextureCoord);

    if (uKernelSize == 0)
    {
        gl_FragColor = color;
        return;
    }

    float aspect = filterArea.y / filterArea.x;
    vec2 center = uCenter.xy / filterArea.xy;
    float gradient = uRadius / filterArea.x * 0.3;
    float radius = uRadius / filterArea.x - gradient * 0.5;
    int k = uKernelSize - 1;

    vec2 coord = vTextureCoord;
    vec2 dir = vec2(center - coord);
    float dist = length(vec2(dir.x, dir.y * aspect));

    float radianStep = uRadian;
    if (radius >= 0.0 && dist > radius) {
        float delta = dist - radius;
        float gap = gradient;
        float scale = 1.0 - abs(delta / gap);
        if (scale <= 0.0) {
            gl_FragColor = color;
            return;
        }
        radianStep *= scale;
    }
    radianStep /= float(k);

    float s = sin(radianStep);
    float c = cos(radianStep);
    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }

        coord -= center;
        coord.y *= aspect;
        coord = rotationMatrix * coord;
        coord.y /= aspect;
        coord += center;

        vec4 sample = texture2D(uSampler, coord);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample;
    }

    gl_FragColor = color / float(uKernelSize);
}
`;(function(n){kPe(e,n);function e(t,i,r,s){t===void 0&&(t=0),i===void 0&&(i=[0,0]),r===void 0&&(r=5),s===void 0&&(s=-1);var o=n.call(this,OPe,LPe)||this;return o._angle=0,o.angle=t,o.center=i,o.kernelSize=r,o.radius=s,o}return e.prototype.apply=function(t,i,r,s){this.uniforms.uKernelSize=this._angle!==0?this.kernelSize:0,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this.uniforms.uRadian=t*Math.PI/180},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this.uniforms.uCenter},set:function(t){this.uniforms.uCenter=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.uRadius},set:function(t){(t<0||t===1/0)&&(t=-1),this.uniforms.uRadius=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-reflection - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-reflection is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var MD=function(n,e){return MD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},MD(n,e)};function NPe(n,e){MD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var BPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,FPe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`;(function(n){NPe(e,n);function e(t){var i=n.call(this,BPe,FPe)||this;return i.time=0,i.uniforms.amplitude=new Float32Array(2),i.uniforms.waveLength=new Float32Array(2),i.uniforms.alpha=new Float32Array(2),i.uniforms.dimensions=new Float32Array(2),Object.assign(i,e.defaults,t),i}return e.prototype.apply=function(t,i,r,s){var o,a;this.uniforms.dimensions[0]=(o=i.filterFrame)===null||o===void 0?void 0:o.width,this.uniforms.dimensions[1]=(a=i.filterFrame)===null||a===void 0?void 0:a.height,this.uniforms.time=this.time,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"mirror",{get:function(){return this.uniforms.mirror},set:function(t){this.uniforms.mirror=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boundary",{get:function(){return this.uniforms.boundary},set:function(t){this.uniforms.boundary=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"amplitude",{get:function(){return this.uniforms.amplitude},set:function(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"waveLength",{get:function(){return this.uniforms.waveLength},set:function(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.alpha},set:function(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]},enumerable:!1,configurable:!0}),e.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0},e})(yn);/*!
 * @pixi/filter-rgb-split - v4.1.3
 * Compiled Thu, 17 Jun 2021 19:33:56 UTC
 *
 * @pixi/filter-rgb-split is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var RD=function(n,e){return RD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},RD(n,e)};function UPe(n,e){RD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var GPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,HPe=`precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

void main(void)
{
   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/filterArea.xy).r;
   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/filterArea.xy).g;
   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/filterArea.xy).b;
   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;
}
`;(function(n){UPe(e,n);function e(t,i,r){t===void 0&&(t=[-10,0]),i===void 0&&(i=[0,10]),r===void 0&&(r=[0,0]);var s=n.call(this,GPe,HPe)||this;return s.red=t,s.green=i,s.blue=r,s}return Object.defineProperty(e.prototype,"red",{get:function(){return this.uniforms.red},set:function(t){this.uniforms.red=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"green",{get:function(){return this.uniforms.green},set:function(t){this.uniforms.green=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blue",{get:function(){return this.uniforms.blue},set:function(t){this.uniforms.blue=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-shockwave - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-shockwave is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var DD=function(n,e){return DD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},DD(n,e)};function VPe(n,e){DD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var zPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$Pe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`;(function(n){VPe(e,n);function e(t,i,r){t===void 0&&(t=[0,0]),r===void 0&&(r=0);var s=n.call(this,zPe,$Pe)||this;return s.center=t,Object.assign(s,e.defaults,i),s.time=r,s}return e.prototype.apply=function(t,i,r,s){this.uniforms.time=this.time,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"center",{get:function(){return this.uniforms.center},set:function(t){this.uniforms.center=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"amplitude",{get:function(){return this.uniforms.amplitude},set:function(t){this.uniforms.amplitude=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wavelength",{get:function(){return this.uniforms.wavelength},set:function(t){this.uniforms.wavelength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"brightness",{get:function(){return this.uniforms.brightness},set:function(t){this.uniforms.brightness=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"speed",{get:function(){return this.uniforms.speed},set:function(t){this.uniforms.speed=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),e.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1},e})(yn);/*!
 * @pixi/filter-simple-lightmap - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-simple-lightmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var kD=function(n,e){return kD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},kD(n,e)};function WPe(n,e){kD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var jPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,QPe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D uLightmap;
uniform vec4 filterArea;
uniform vec2 dimensions;
uniform vec4 ambientColor;
void main() {
    vec4 diffuseColor = texture2D(uSampler, vTextureCoord);
    vec2 lightCoord = (vTextureCoord * filterArea.xy) / dimensions;
    vec4 light = texture2D(uLightmap, lightCoord);
    vec3 ambient = ambientColor.rgb * ambientColor.a;
    vec3 intensity = ambient + light.rgb;
    vec3 finalColor = diffuseColor.rgb * intensity;
    gl_FragColor = vec4(finalColor, diffuseColor.a);
}
`;(function(n){WPe(e,n);function e(t,i,r){i===void 0&&(i=0),r===void 0&&(r=1);var s=n.call(this,jPe,QPe)||this;return s._color=0,s.uniforms.dimensions=new Float32Array(2),s.uniforms.ambientColor=new Float32Array([0,0,0,r]),s.texture=t,s.color=i,s}return e.prototype.apply=function(t,i,r,s){var o,a;this.uniforms.dimensions[0]=(o=i.filterFrame)===null||o===void 0?void 0:o.width,this.uniforms.dimensions[1]=(a=i.filterFrame)===null||a===void 0?void 0:a.height,t.applyFilter(this,i,r,s)},Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uLightmap},set:function(t){this.uniforms.uLightmap=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){var i=this.uniforms.ambientColor;typeof t=="number"?(_s(t,i),this._color=t):(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],this._color=al(i))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.ambientColor[3]},set:function(t){this.uniforms.ambientColor[3]=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-tilt-shift - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-tilt-shift is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var OD=function(n,e){return OD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},OD(n,e)};function fI(n,e){OD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var XPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,YPe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float blur;
uniform float gradientBlur;
uniform vec2 start;
uniform vec2 end;
uniform vec2 delta;
uniform vec2 texSize;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,M9=function(n){fI(e,n);function e(t,i,r,s){t===void 0&&(t=100),i===void 0&&(i=600);var o=n.call(this,XPe,YPe)||this;return o.uniforms.blur=t,o.uniforms.gradientBlur=i,o.uniforms.start=r||new Ae(0,window.innerHeight/2),o.uniforms.end=s||new Ae(600,window.innerHeight/2),o.uniforms.delta=new Ae(30,30),o.uniforms.texSize=new Ae(window.innerWidth,window.innerHeight),o.updateDelta(),o}return e.prototype.updateDelta=function(){this.uniforms.delta.x=0,this.uniforms.delta.y=0},Object.defineProperty(e.prototype,"blur",{get:function(){return this.uniforms.blur},set:function(t){this.uniforms.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gradientBlur",{get:function(){return this.uniforms.gradientBlur},set:function(t){this.uniforms.gradientBlur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.uniforms.start},set:function(t){this.uniforms.start=t,this.updateDelta()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.uniforms.end},set:function(t){this.uniforms.end=t,this.updateDelta()},enumerable:!1,configurable:!0}),e}(yn),qPe=function(n){fI(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.updateDelta=function(){var t=this.uniforms.end.x-this.uniforms.start.x,i=this.uniforms.end.y-this.uniforms.start.y,r=Math.sqrt(t*t+i*i);this.uniforms.delta.x=t/r,this.uniforms.delta.y=i/r},e}(M9),KPe=function(n){fI(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.updateDelta=function(){var t=this.uniforms.end.x-this.uniforms.start.x,i=this.uniforms.end.y-this.uniforms.start.y,r=Math.sqrt(t*t+i*i);this.uniforms.delta.x=-i/r,this.uniforms.delta.y=t/r},e}(M9);(function(n){fI(e,n);function e(t,i,r,s){t===void 0&&(t=100),i===void 0&&(i=600);var o=n.call(this)||this;return o.tiltShiftXFilter=new qPe(t,i,r,s),o.tiltShiftYFilter=new KPe(t,i,r,s),o}return e.prototype.apply=function(t,i,r,s){var o=t.getFilterTexture();this.tiltShiftXFilter.apply(t,i,o,1),this.tiltShiftYFilter.apply(t,o,r,s),t.returnFilterTexture(o)},Object.defineProperty(e.prototype,"blur",{get:function(){return this.tiltShiftXFilter.blur},set:function(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gradientBlur",{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.tiltShiftXFilter.start},set:function(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.tiltShiftXFilter.end},set:function(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t},enumerable:!1,configurable:!0}),e})(yn);/*!
 * @pixi/filter-twist - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-twist is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var LD=function(n,e){return LD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},LD(n,e)};function JPe(n,e){LD(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ZPe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,eMe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`;(function(n){JPe(e,n);function e(t){var i=n.call(this,ZPe,eMe)||this;return Object.assign(i,e.defaults,t),i}return Object.defineProperty(e.prototype,"offset",{get:function(){return this.uniforms.offset},set:function(t){this.uniforms.offset=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.uniforms.angle},set:function(t){this.uniforms.angle=t},enumerable:!1,configurable:!0}),e.defaults={radius:200,angle:4,padding:20,offset:new Ae},e})(yn);/*!
 * @pixi/filter-zoom-blur - v4.1.5
 * Compiled Wed, 29 Sep 2021 14:05:57 UTC
 *
 * @pixi/filter-zoom-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ND=function(n,e){return ND=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},ND(n,e)};function tMe(n,e){ND(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function nMe(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}var iMe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,rMe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`;(function(n){tMe(e,n);function e(t){var i=this,r=Object.assign(e.defaults,t),s=r.maxKernelSize,o=nMe(r,["maxKernelSize"]);return i=n.call(this,iMe,rMe.replace("${maxKernelSize}",s.toFixed(1)))||this,Object.assign(i,o),i}return Object.defineProperty(e.prototype,"center",{get:function(){return this.uniforms.uCenter},set:function(t){this.uniforms.uCenter=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.uniforms.uStrength},set:function(t){this.uniforms.uStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerRadius",{get:function(){return this.uniforms.uInnerRadius},set:function(t){this.uniforms.uInnerRadius=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.uniforms.uRadius},set:function(t){(t<0||t===1/0)&&(t=-1),this.uniforms.uRadius=t},enumerable:!1,configurable:!0}),e.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32},e})(yn);function sMe(n,e,t,i){const r=new ImageData(n.slice(),e,t),s=R9(r);i[0]>i[1]&&(i=i.sort((a,l)=>a-l));const o=i[1]-i[0];for(let a=0;a<s.length;a++)s[a]=o===0?i[0]:(s[a]-i[0])/o*255>>0;for(let a=0;a<s.length;a++){const l=a*4;r.data[l]=s[a],r.data[l+1]=s[a],r.data[l+2]=s[a]}return r}function oMe(n,e,t,i){const r=new ImageData(n.slice(),e,t),s=R9(r);i<50?(i=Math.abs((50-i)/2),w2(s,e,t,i,Math.sqrt(i))):i>50&&(i=Math.abs(i-50),D9(s,e,t,i,0,60));for(let o=0;o<s.length;o++){const a=o*4;r.data[a]=s[o],r.data[a+1]=r.data[a],r.data[a+2]=r.data[a]}return r}function aMe(n,e,t){const i=new ImageData(n.slice(),e,t);for(let r=0;r<i.data.length;r+=4)i.data[r]=255-i.data[r],i.data[r+1]=255-i.data[r+1],i.data[r+2]=255-i.data[r+2];return i}function R9(n){const e=[];for(let t=0;t<n.data.length;t+=4){const i=t,r=n.data[i]*.299+n.data[i+1]*.587+n.data[i+2]*.114>>0;e.push(r)}return e}function w2(n,e,t,i,r){const s=[];let o=0;i=Math.floor(i)||3,r=r||i/3;const a=1/(Math.sqrt(2*Math.PI)*r),l=-1/(2*r*r);for(let c=0,u=-i;u<=i;u++,c++){const h=a*Math.exp(l*u*u);s[c]=h,o+=h}for(let c=0;c<s.length;c++)s[c]/=o;for(let c=0;c<t;c++)for(let u=0;u<e;u++){let h=0;o=0;for(let d=-i;d<=i;d++){const f=u+d;f>=0&&f<e&&(h+=n[c*e+f]*s[d+i],o+=s[d+i])}n[c*e+u]=Math.floor(h/o)}for(let c=0;c<e;c++)for(let u=0;u<t;u++){let h=0;o=0;for(let d=-i;d<=i;d++){const f=u+d;f>=0&&f<t&&(h+=n[f*e+c]*s[d+i],o+=s[d+i])}n[u*e+c]=Math.floor(h/o)}}function D9(n,e,t,i,r,s){const o=n.slice();w2(o,e,t,i,Math.sqrt(i));for(let a=0;a<n.length;a++){let l=n[a]-o[a];(l>r||l<-r)&&(l=n[a]+s*l/100,n[a]=l)}}function BH(n,e){return e*=4,{r:n[e],g:n[e+1],b:n[e+2],a:n[e+3]}}function lMe(n,e){e*=4,n[e+3]=0}function cMe(n,e,t){if(e.a===0)return!1;const i=n.r-e.r,r=n.g-e.g,s=n.b-e.b;return-t<i&&i<t&&-t<r&&r<t&&-t<s&&s<t}function uMe(n,e,t,i,r,s){const o=[[-1,0],[1,0],[0,-1],[0,1]],a=e*r+i,l=BH(n,a),c=[{x:i,y:r}];for(;c.length>0;){const u=c.pop();lMe(n,e*u.y+u.x);for(let h=0;h<o.length;h++){const d=u.x+o[h][0],f=u.y+o[h][1],p=e*f+d,g=BH(n,p);d>=0&&d<e&&f>=0&&f<t&&cMe(l,g,s)&&c.push({x:d,y:f})}}}function FH(n,e,t,i){let r=0;const s=(i*2+1)*(i*2+1);for(let o=0;o<e;o++)for(let a=0;a<t;a++){const l=o+a*e;for(let u=-i;u<=i;u++){let h=u+o;(h<0||h>=e)&&(h=0);for(let d=-i;d<=i;d++){let f=d+a;(f<0||f>=t)&&(f=0);const p=h+f*e,g=n[p];r+=g}}const c=r/s;r=0,n[l]=c}}function hMe(n,e,t,i){const r=n,s=r.length;let o=[],a=[];if(i=i??"comic1",i==="comic3"){const l=[];for(let d=0;d<256;d++)l[d]=0;for(let d=0,f=r.length;d<f;d+=4){const p=.299*r[d]+.578*r[d+1]+.114*r[d+2]>>0;if(r[d]=r[d+1]=r[d+2]=p,r[d+3]===0){l[255]++;continue}l[r[d]]++}const c=[];let u=0;const h=s/4;for(let d=0;d<256;d++)u+=l[d],c[d]=u/h*255>>0;for(let d=0,f=r.length;d<f;d+=4)r[d]=c[r[d]]>80?255:0,r[d+1]=r[d],r[d+2]=r[d]}else if(i==="comic1"){let l,c;const u=t,h=e;for(let d=0,f=r.length;d<f;d+=4){const p=.299*r[d]+.578*r[d+1]+.114*r[d+2]>>0;a.push(p),o.push(p)}FH(a,e,t,2),D9(o,h,u,10,0,20);for(let d=0;d<u;d++)for(let f=0;f<h;f++){l=d*h+f,c=l*4;let g=127+(o[l]-a[l]);g=g<0?0:g>255?255:g,g=g>120?255:0,r[c]=g,r[c+1]=r[c],r[c+2]=r[c],r[c+3]=r[c+3]}}else if(i==="comic2"){for(let g=0,m=r.length;g<m;g+=4){const v=.299*r[g]+.578*r[g+1]+.114*r[g+2]>>0;a.push(v),o.push(v)}FH(a,e,t,1);const l=4,c=4,u=(g,m)=>g<127?2*(g*m)/255:255-2*(255-g)*(255-m)/255;let h,d;const f=t,p=e;for(let g=0;g<f;g++)for(let m=0;m<p;m++){h=g*p+m,d=h*4;const v=o[h]-a[h];let _=127+Math.abs(v)*v/(2*c);_=_<0?0:_>255?255:_,_=_>124?255:0;const y=u(r[d],_)>>0;Math.abs(r[d]-90)<60?r[d]=Math.min(255,g%l===m%l?y/(3*(Math.random()/2+.75)):y)>>0:r[d]=Math.min(255,r[d]<=30?y/4:y)>>0,r[d+1]=r[d],r[d+2]=r[d],r[d+3]=r[d+3]}o=[],a=[]}return new ImageData(n,e,t)}function dMe(n,e,t,i){i=i??127;for(let r=0;r<n.length;r+=4){const s=n[r]*.299+n[r+1]*.587+n[r+2]*.114>>0;let o=255;s<i&&(o=0),n[r]=o,n[r+1]=o,n[r+2]=o}return new ImageData(n,e,t)}function fMe(n,e,t,i){const{sigma:r=10}=i||{},s=n,o=e,a=t;let l=[],c=[];for(let u=0,h=s.length;u<h;u+=4){const d=u,f=s[d]*.3+s[d+1]*.6+s[d+2]*.1>>0;l.push(f),c.push(255-f)}w2(c,o,a,8,r);for(let u=0,h=l.length;u<h;u++){const d=u*4;s[d]=Math.min(255,Math.max(0,l[u]+l[u]*c[u]/(256-c[u])>>0)),s[d+1]=s[d],s[d+2]=s[d]}return l=[],c=[],new ImageData(n,e,t)}const k9={maxSize:void 0};class Fi extends Ur{constructor(t,i){super();E(this,"isFill");E(this,"svgPath");E(this,"originBase64");E(this,"grayValue");E(this,"sharpness");E(this,"colorInverted");E(this,"filterList");E(this,"updateProcessTypes");E(this,"filterAttrsMap");E(this,"hoverRect");E(this,"maskedImageData");E(this,"maskedLocalBounds");this.isFill=!0,this.type=it.BITMAP,this.interactive=!0,this.filters=[],this.filterList=[],this.filterAttrsMap={emboss:{strength:5}},this.updateProcessTypes=[],this.grayValue=Ty.GRAY_VALUE,this.sharpness=Ty.SHARPNESS,this.colorInverted=Ty.COLOR_INVERTED,this.lockRatio=!0;let r=t;typeof r=="string"&&(r=new Image,r.src=t),this.setupTexture(r);const s=this.getOriginSizeFromJSON(i);r instanceof HTMLImageElement&&!r.complete?(s&&(this.texture.orig.width=s.width,this.texture.orig.height=s.height),r.addEventListener("load",()=>{const a=r;ISe(a)||(this.setupTexture(a),this.updateOriginTexture(),this.setImageAttrs(this,!0),this.updateProcessEffect()),this.updateTextureOriginSize(s),this.updateMaskedCache(),this._bindHoverRect()})):(this.updateTextureOriginSize(s),this._bindHoverRect()),i&&(super.parseJSON(i),this.setImageAttrs(i),i!=null&&i.mask&&this.importMaskJSON(i==null?void 0:i.mask),this.texture.baseTexture.once("update",()=>{this.updateProcessEffect(),this.updateMaskedCache()}),this.texture.update()),typeof t=="string"?this.originBase64=t:this.originBase64=eD(t)}get resourceScale(){return pI(this)}get isResourceScaled(){return C2(this)}get originTextureData(){const t=Symbol.for("originTextureData");return!this[t]&&this.updateOriginTexture(),this[t]}set originTextureData(t){const i=Symbol.for("originTextureData");this[i]=t,this._bindHoverRect()}getOriginSizeFromJSON(t){if(t){if(isFinite(t.originWidth)&&isFinite(t.originHeight))return{width:t.originWidth,height:t.originHeight};if(isFinite(t.width)&&isFinite(t.height)&&isFinite(t.scale.x)&&isFinite(t.scale.y))return{width:t.width/t.scale.x,height:t.height/t.scale.y}}}updateTextureOriginSize(t){if(t){const{width:i,height:r}=t;isFinite(i)&&isFinite(r)&&this.texture.baseTexture.setRealSize(i,r)}}updateOriginDatasource(t,i){t=this.updateOriginTexture(t,i),this.updateOriginBase64(t)}updateOriginTexture(t,i){t||({canvas:t,ctx:i}=tD(this));const r=i.getImageData(0,0,t.width,t.height);return this.originTextureData=r,t}updateOriginBase64(t){this.originBase64=eD(t)}toJSON(t,i){const{texture:r=!1}=i||{},{filterList:s,grayValue:o,sharpness:a,colorInverted:l}=this;let c="";r&&(c=this.originBase64);const u=super.toJSON(t),{width:h,height:d}=this.texture;return{base64:c,...u,width:h*u.scale.x,height:d*u.scale.y,isFill:this.isFill,filterList:s.slice(),grayValue:o.slice(),sharpness:a,colorInverted:l,filterAttrsMap:pn(this.filterAttrsMap),mask:this.exportMaskJSON(t,i),originWidth:h,originHeight:d}}parseJSON(t){const{base64:i}=t;if(i){const{width:r,height:s}=t;this.width=r||this.width,this.height=s||this.height}if(super.parseJSON(t),t.base64&&t.base64!==this.originBase64){const r=new Image;r.src=t.base64,this.setupTexture(r);const s=!!this.originTextureData;this.setImageAttrs(t,s),this.texture.baseTexture.once("update",()=>{this.updateTextureOriginSize(this.getOriginSizeFromJSON(t)),this.updateOriginDatasource(),this.originBase64=t.base64,this.updateProcessEffect(),"mask"in t&&this.importMaskJSON(t.mask)}),this.texture.update()}else this.texture.baseTexture.resource.valid&&(this.setImageAttrs(t),this.updateProcessEffect(),"mask"in t&&this.importMaskJSON(t.mask))}setImageAttrs(t,i=!1){const{attrs:r}=this.pickValidChangedProcessAttrs(t);i?this.updateProcessTypes.push("imageData","filter"):this.updateProcessTypes.push(...this.resolveUpdateProcessTypes(r)),Object.entries(r).forEach(([s,o])=>{s in this&&(this[s]=Id(o)?Ln(this[s],o):o)})}pickValidChangedProcessAttrs(t,i=this){var u,h;const{filterList:r,grayValue:s,sharpness:o,colorInverted:a,filterAttrsMap:l}=t,c={};return Array.isArray(s)&&s.length===2&&tn(s[0])&&tn(s[1])&&!Fl(i.grayValue,s)&&(c.grayValue=s),tn(o)&&i.sharpness!==o&&(c.sharpness=o),tA(a)&&i.colorInverted!==a&&(c.colorInverted=a),Array.isArray(r)&&r.every(d=>pi(d))&&!Fl(i.filterList,r)&&(c.filterList=r),tn((u=l==null?void 0:l.emboss)==null?void 0:u.strength)&&!Fl((h=i.filterAttrsMap)==null?void 0:h.emboss,l==null?void 0:l.emboss)&&(c.filterAttrsMap=l),{attrs:c}}resolveUpdateProcessTypes(t,i=this){const r=new Set(Object.keys(t)),s=new Set;["grayValue","sharpness","colorInverted"].some(a=>r.has(a))&&s.add("imageData");const o=["dot","emboss"];if(r.has("filterList")&&[...t.filterList,...i.filterList].forEach(a=>{o.includes(a)?s.add("filter"):s.add("imageData")}),r.has("filterAttrsMap")){const a=i.filterList[0];a in t.filterAttrsMap&&!Fl(t.filterAttrsMap[a],i.filterAttrsMap[a])&&(o.includes(a)?s.add("filter"):s.add("imageData"))}return s}updateProcessEffect(t=this.updateProcessTypes){const{grayValue:i,sharpness:r,colorInverted:s,filterList:o,filterAttrsMap:a}=this,l=o.map(d=>d.startsWith("comic")?{type:"comic",params:d}:{type:d,params:a[d]}),c=["dot","emboss"],{shaderFilter:u=[],jsFilter:h=[]}=Fr(l,d=>c.includes(d.type)?"shaderFilter":"jsFilter");if(t.includes("imageData")){const d=this.getUpdateImageDataSetting(i,s,r,h);this.updateImageTexture(d)}t.includes("filter")&&this.updateFilterList(u),this.updateProcessTypes=[]}getUpdateImageDataSetting(t,i,r,s){const o=[];if(Fl(t,[0,255])||o.push({name:"grayValue",value:t}),i!==!1&&o.push({name:"colorInverted",value:i}),r!==50&&o.push({name:"sharpness",value:r}),s.length>0){const a=s.map(l=>({name:l.type,value:l.params}));o.push(...a)}return o.length>0&&o[0].name!=="grayValue"&&o.unshift({name:"grayValue",value:t}),o}cloneWithoutCompress(t){const i=Fi.from(this.texture.clone()),r=this.toJSON(t||this.parent);i.parseJSON(r),UD(i,this.exportMaskJSON(t||this.parent)),i.filters=this.filters;const s=this.texture.width/this.texture.height,o=this.width/this.height;return o>s?(i.height=this.texture.height,i.width=this.texture.height*o):(i.width=this.texture.width,i.height=this.texture.width/o),i}updateFilterList(t){if(t.length===0){this.filters=[];return}this.filters=[],t.forEach(i=>{const{type:r,params:s}=i;this[r]&&mt(this[r])&&this[r](s)})}getTextureImageSource(){var t;return(t=this.texture.baseTexture.resource)==null?void 0:t.source}updateImageTexture(t){const i={grayValue:sMe,colorInverted:aMe,sharpness:oMe,comic:hMe,sketch:fMe,binary:dMe},{canvas:r,ctx:s}=tD(this);if(!this.originTextureData){const a=s.getImageData(0,0,r.width,r.height);this.originTextureData=a}let o=this.originTextureData;t.length>0&&t.forEach(({name:a,value:l})=>{o=i[a](o.data,r.width,r.height,l)}),s.putImageData(o,0,0),this.setupTexture(r),this.texture.update()}dot(){this.filters.push(new ePe(1,0))}emboss(t){const{strength:i=5}=t||{};this.filters.push(new aPe(i))}transformUpdate(){this.width=this.width,this.height=this.height}embedImage(t){this.x=t.x.baseVal.value,this.y=t.y.baseVal.value,t.getAttribute("width")!==null&&(this.width=t.width.baseVal.value),t.getAttribute("height")!==null&&(this.height=t.height.baseVal.value)}setupTexture(t){t=TSe(t),this.texture=Wt.from(t)}hitTest(t){if(!(this.mask?this.getMaskedLocalBounds():this.getLocalBounds()).contains(t.x,t.y))return!1;const r=this.mask?this.getMaskedImageData():this.originTextureData;this.isResourceScaled&&new Dt().scale(this.resourceScale.x,this.resourceScale.y).apply(t,t),t.x=Math.round(t.x),t.y=Math.round(t.y);const s=r.width,o=r.height,a=(t.x+t.y*s)/(s*o),l=Math.round(r.data.length/4*a);return r.data[l*4+3]!==0}getSVGData(t){const i=g2(this,t);let r;const s=this.mask?(r=this.getMaskedLocalBounds(),{x:r.x,y:r.y,width:r.width,height:r.height,"xlink:href":this.getMaskedBase64()}):{x:0,y:0,width:this.texture.width,height:this.texture.height,"xlink:href":this.originBase64};return Ln(super.getSVGData(t),{tag:"image",attrs:{...i,...s}})}getMaskedBase64(){const t=this.isResourceScaled?new Dt().scale(this.resourceScale.x,this.resourceScale.y):void 0,i=Xp(new oi,this.getMaskedLocalBounds(),t).getRectangle();return mSe(this.getMaskedImageData(),i)}get isMaskOverlap(){const t=this.getMaskedLocalBounds();return t&&t.width>0&&t.height>0}get isMaskEmbed(){return RA(this,Ul(this))}exportMaskJSON(t,i){let r;return this.mask instanceof rn&&(r=this.mask.toJSON(this,i),this.mask.updateTransform()),r??null}importMaskJSON(t){UD(this,t),this.updateMaskedCache()}updateMaskedCache(){const t=Ul(this);if(t){const{width:i,height:r}=lb(this.getTextureImageSource());if(!i||!r)return;t.updateTransform();const{imageData:s,rect:o}=this.calculateMaskedCache();this.maskedImageData=s,this.maskedLocalBounds=o}else this.maskedImageData=void 0,this.maskedLocalBounds=void 0;this._bindHoverRect()}calculateMaskedCache(){const t=O9(this);let i;this.isResourceScaled&&(i=new Dt().scale(1/this.resourceScale.x,1/this.resourceScale.y));const r=l9(t,i);return{imageData:t,rect:r}}getTransformerBounds(){if(this.mask&&this.isMaskEmbed){const t=this.getMaskedLocalBounds();if(t&&t.width&&t.height)return{localBounds:t,transform:this.worldTransform};{const i=Ul(this);return{localBounds:i.getLocalBounds(),transform:i.worldTransform}}}else return{localBounds:this.getLocalBounds(),transform:this.worldTransform}}getMaskedImageData(){return this.maskedImageData||this.updateMaskedCache(),this.maskedImageData}getMaskedLocalBounds(){return this.maskedLocalBounds||this.updateMaskedCache(),this.maskedLocalBounds}getRealBounds(){return Xp(new oi,this.mask?x2(this):this.getBounds())}_bindHoverRect(){this.hoverRect&&this.removeChild(this.hoverRect);const t=this.mask?this.getMaskedLocalBounds():this.getLocalBounds(),{x:i,y:r,width:s,height:o}=t,a=new A2({x:i,y:r,width:s,height:o,visible:!1});a.highlightBound(),this.addChild(a),this.hoverRect=a}reset(){this.hoverRect.visible=!1}highlightBound(){this.hoverRect.visible=!0}}function BD(n,e){n.mask&&n.mask!==e&&_m(n),e.enableFill||e.parseJSON({enableFill:!0}),n.mask=e}function _m(n){if(n.mask){const e=n.mask;return e instanceof mn&&!Qp.getInstance().enableFill&&e.enableFill&&e.parseJSON({enableFill:!1}),n.mask=null,!0}return!1}function Ul(n){const e=(n==null?void 0:n.mask)??null;return e&&(e.isMaskData?e.maskObject:e)}function pMe(n,e){let t=n;for(;t&&!(typeof e=="function"?e(t):t===e);)t=t.parent;return t}function RA(n,e){return!!e&&e!==n&&pMe(e,n)===n}function gMe(n,e){if(!n.parent)return;const t=n.parent,i=t.getChildIndex(n);if(i>=0){t.removeChildAt(i),e=Array.isArray(e)?e:[e];for(let r=0;r<e.length;r++)t.addChildAt(e[r],i+r)}}function FD(n,e,t){var a;const{keepTransform:i=!0,insertNear:r=!0,clearEmpty:s=!0}=t??{};if(n.parent===e)return;if(!n.parent){e.addChild(n);return}if(i){const l=sh(n.worldTransform.clone(),e.worldTransform.clone());n.transform.setFromMatrix(n.localTransform.copyFrom(l)),(a=n.transformCommit)==null||a.call(n)}n.parent.removeChild(n);let o;if(r){o=n.parent;let l;for(;o;){if(o.parent===e){const c=e.getChildIndex(o);e.addChildAt(n,c+1),l=null}else l=o.parent;s&&!o.children.length&&(o.parent&&o.parent.removeChild(o),o.destroy(!0)),o=l}}o||e.addChild(n)}function mMe(n,e){const t=I9(e.trim());let i=0,r=0;const s={x:0,y:0};for(let o=0,a=t.length;o<a;o++){const l=t[o-1],c=t[o];if(isNaN(i)||isNaN(r))throw new Error("Data corruption");switch(c.code){case"M":case"m":{c.code==="M"?(i=c.end.x,r=c.end.y):(i+=c.end.x,r+=c.end.y),s.x=i,s.y=r,n.moveTo(i,r);break}case"H":{n.lineTo(i=c.value,r);break}case"h":{n.lineTo(i+=c.value,r);break}case"V":{n.lineTo(i,r=c.value);break}case"v":{n.lineTo(i,r+=c.value);break}case"z":case"Z":{i=s.x||0,r=s.y||0,n.closePath();break}case"L":{n.lineTo(i=c.end.x,r=c.end.y);break}case"l":{n.lineTo(i+=c.end.x,r+=c.end.y);break}case"C":{n.bezierCurveTo(c.cp1.x,c.cp1.y,c.cp2.x,c.cp2.y,i=c.end.x,r=c.end.y);break}case"c":{const d=i,f=r;n.bezierCurveTo(d+c.cp1.x,f+c.cp1.y,d+c.cp2.x,f+c.cp2.y,i+=c.end.x,r+=c.end.y);break}case"s":case"S":{const d={x:i,y:r},f=t[o-1]?t[o-1].code:null;if(o>0&&(f==="s"||f==="S"||f==="c"||f==="C")){const g=t[o-1],m={...g.cp2||g.cp};t[o-1].relative&&(m.x+=i-g.end.x,m.y+=r-g.end.y),d.x=2*i-m.x,d.y=2*r-m.y}const p={x:c.cp.x,y:c.cp.y};c.relative?(p.x+=i,p.y+=r,i+=c.end.x,r+=c.end.y):(i=c.end.x,r=c.end.y),n.bezierCurveTo(d.x,d.y,p.x,p.y,i,r);break}case"q":{const d=i,f=r;n.quadraticCurveTo(d+c.cp.x,f+c.cp.y,i+=c.end.x,r+=c.end.y);break}case"Q":{n.quadraticCurveTo(c.cp.x,c.cp.y,i=c.end.x,r=c.end.y);break}case"A":case"a":const u=i,h=r;c.code==="A"?(i=c.end.x,r=c.end.y):(i+=c.end.x,r+=c.end.y),vMe(n,u,h,i,r,c.radii.x,c.radii.y,(c.rotation||0)*Math.PI/180,!c.clockwise,c.large);break;case"t":case"T":{let d,f;if(l&&l.cp){let p=l.cp.x,g=l.cp.y;if(l.relative){const m=i-l.end.x,v=r-l.end.y;p+=m,g+=v}d=2*i-p,f=2*r-g}else d=i,f=r;c.code==="t"?n.quadraticCurveTo(d,f,i+=c.end.x,r+=c.end.y):n.quadraticCurveTo(d,f,i=c.end.x,r=c.end.y);break}default:{console.warn("Draw command not supported:",c.code,c);break}}}}function vMe(n,e,t,i,r,s,o,a=0,l=!1,c=!1){const{cx:u,cy:h,startAngle:d,endAngle:f}=_Me(e,t,i,r,s,o,a,l,c);n.ellipse(u,h,s,o,a,d,f,l)}function _Me(n,e,t,i,r,s,o=0,a=!1,l=!1){const c=(n+t)/2,u=(e+i)/2,h=new Dt().identity().translate(-c,-u).rotate(-o),{x:d,y:f}=h.apply({x:n,y:e}),p=Math.pow(d/r,2)+Math.pow(f/s,2);p>1&&(r=Math.sqrt(p)*r,s=Math.sqrt(p)*s);const g=r*r,m=s*s,_=(a===l?1:-1)*Math.sqrt(Math.abs(g*m-g*f*f-m*d*d)/(g*f*f+m*d*d)),y=_*(r*f/s),A=-_*(s*d/r),{x:w,y:b}=h.applyInverse({x:y,y:A}),C=(d-y)/r,I=(f-A)/s,x=Math.sqrt(C**2+I**2),T=(I>=0?1:-1)*Math.acos(C/x),O=(-d-y)/r,F=(-f-A)/s,G=Math.sqrt(O**2+F**2);let B=(F>=0?1:-1)*Math.acos(O/G);return B>T&&a?B-=Math.PI*2:T>B&&!a&&(B+=Math.PI*2),{cx:w,cy:b,rx:r,ry:s,startAngle:T,endAngle:B,xAxisRotation:o,anticlockwise:a}}function yMe(n,e,t){t=t??{};const{imgRotation:i=0,mode:r="composition"}=t;let{imgLocalBounds:s}=t;const{width:o,height:a}=lb(n);s=s??new Pt(0,0,o,a);const l=new oi,c=i,u=new Dt().rotate(c);l.addFrameMatrix(u,s.x,s.y,s.x+s.width,s.y+s.height);const h={x:-l.minX,y:-l.minY},d=l.maxX-l.minX,f=l.maxY-l.minY,p=document.createElement("canvas");p.width=d,p.height=f;const g=p.getContext("2d");return g.translate(h.x,h.y),g.rotate(c),g.beginPath(),mMe(g,e.toString()),r==="clip"?g.clip():(g.strokeStyle="rgba(0, 0, 0, 1)",g.stroke(),g.fillStyle="rgba(0, 0, 0, 1)",g.fill(),g.globalCompositeOperation="source-in"),g.drawImage(n,0,0),p}function O9(n,e=0){var h,d,f,p;const t=Ul(n),i=((h=n==null?void 0:n.getTextureImageSource)==null?void 0:h.call(n))??((d=n.texture.baseTexture.resource)==null?void 0:d.source),{width:r,height:s}=lb(i);if(!t||!i||!r||!s)return new ImageData(1,1);let o=b9(t);const a=sh(t.worldTransform.clone(),n.worldTransform.clone()),l=pI(n);C2(l)&&a.scale(l.x,l.y),o=SA(o).matrix(f2(a)).toString();const c=yMe(i,o,{imgRotation:e,mode:"composition"});return window.canvas_debug.previewCanvasClip&&bMe(c),((p=(f=c.getContext("2d"))==null?void 0:f.getImageData)==null?void 0:p.call(f,0,0,c.width,c.height))??new ImageData(1,1)}function x2(n,e){let t=rIe(n,e),i;n instanceof Fi?i=n.getMaskedImageData():i=O9(n);const r=pI(n);return C2(r)&&(t=t??new Dt,t.append(new Dt().scale(1/r.x,1/r.y))),l9(i,t)}function pI(n){const e=n.texture.baseTexture.resource.width/n.texture.width,t=n.texture.baseTexture.resource.height/n.texture.height;return isFinite(e)&&isFinite(t)?{x:e,y:t}:{x:1,y:1}}function C2(n){const e=n instanceof Ur?pI(n):n;return e.x!==1||e.y!==1}function AMe(n,e,t="preview"){const r=`<html>
        <head>
          <style>
            body { padding: 0; }
            a { position: fixed; right: 10px; }
            img { max-width: 100%; max-height: 100%; outline: 1px solid; }
          </style>
        </head>
        <body>
          <div><a href=${URL.createObjectURL(e)} download="${t}">Download</a></div>
          ${n}
        </body>
      </html>
      `;console.log("Preview Link: %o",URL.createObjectURL(new Blob([r],{type:"text/html"})))}function bMe(n){n.toBlob(e=>{const i=`<img src=${URL.createObjectURL(e)}></img>`;AMe(i,e)})}const wMe=["isFill","lockRatio","zOrder","groupTag","layerTag","layerColor","visible","enableFill","enableTransform","lockState","visibleState","name","originColor","sourceId"];function Us(n,e){try{switch(n){case it.CIRCLE:return new y2(e);case it.LINE:return new $C(e);case it.PEN:return new x9(e);case it.RECT:return new A2(e);case it.TEXT:return new E2(e);case it.PATH:const t={atlas:new E9(2048,2048),disableHrefSVGLoading:!1};return new QC(t,e);case it.POLYGON:return new dI(e);case it.BITMAP:const i=e;return new Fi(i.base64,i);default:return}}catch{return}}function xMe(n){if(n instanceof Fi)return;ASe(n),(t=>{!t.enableFill&&!t.hitArea&&t.addHitArea()})(n)}function CMe(n,e,t=0){const i=new Ae(0,0);n.worldTransform.applyInverse(e,i);const r=n._texture.orig.width,s=n._texture.orig.height,o=-r*n.anchor.x;let a=0;return i.x>=o-t&&i.x<o+r+t&&(a=-s*n.anchor.y,i.y>=a-t&&i.y<a+s+t)}function L9(n){let e=n.width,t=n.height;const i=n.getContext("2d"),s=i.getImageData(0,0,e,t).data,o=s.length,a={top:null,left:null,right:null,bottom:null};let l=null,c,u,h;for(c=0;c<o;c+=4)s[c+3]!==0&&(u=c/4%e,h=~~(c/4/e),a.top===null&&(a.top=h),(a.left===null||u<a.left)&&(a.left=u),(a.right===null||a.right<u+1)&&(a.right=u+1),(a.bottom===null||a.bottom<h)&&(a.bottom=h));return a.top!==null&&(e=a.right-a.left,t=a.bottom-a.top+1,l=i.getImageData(a.left,a.top,e,t)),{height:t,width:e,data:l}}function UD(n,e){if(e)if(n.mask){const t=Ul(n);t&&(RA(n,t)&&(t.parseJSON(e),t.x=e.offsetX,t.y=e.offsetY,t.transform.updateLocalTransform()),t.updateTransform())}else{const t=Us(e.type,e);if(!t)return;t.parentGroup=void 0,t.interactive=!1,t.x=e.offsetX,t.y=e.offsetY,t.transform.updateLocalTransform(),t.transform.updateTransform(n.transform),n.addChild(t),BD(n,t)}else if(e===null){const t=Ul(n);t&&RA(n,t)&&n.removeChild(t),_m(n)}}function EMe(n,e){Array.isArray(e)&&(e=new Pt(...e));const t=Math.min(e.width/n.width,e.height/n.height),i=new Ae(n.x,n.y),r=new Ae(n.x+n.width,n.y+n.height),s=new Dt().scale(t,t),o=s.apply(i),a=s.apply(r),l=new Pt(o.x,o.y,a.x-o.x,a.y-o.y),c={x:e.x+e.width/2-(l.x+l.width/2),y:e.y+e.height/2-(l.y+l.height/2)};return new Dt().scale(t,t).translate(c.x,c.y)}function N9(n){return gr(n,...wMe)}var jf;class E2 extends Ud{constructor(t){t=Ln(pn({text:A3,style:Ya}),t);super();E(this,"text",A3);E(this,"lines",[]);E(this,"style");E(this,"noReuseKeys",["style.fontFamily","style.fontSubfamily","style.fontSource"]);E(this,"triggerGlyphsChange",["text","style.fontSize","style.fontFamily","style.fontSubfamily","style.fontSource"]);E(this,"triggerStyleChange",["leading","letterSpacing","align","curveX","curveY"]);E(this,"fontData");E(this,"curveInfo");E(this,"metrics");E(this,"inited",!1);E(this,"anchorLocalX");E(this,"isEditing",!1);ke(this,jf,new Map);this.type=it.TEXT,this.interactive=!0,this.isClosePath=!0,this.parseJSON(t),this.inited=!0}destroy(t){super.destroy(t),S(this,jf).clear()}highlightBound(){this.children.forEach(i=>{i.highlightBound()})}reset(){this.children.forEach(i=>{i.reset()})}createSVGPathNode(t){const i=Us(it.PATH,t);return i.interactive=!1,i}end(){this.done()}done(){this.emit(mo.DRAW_DONE,this)}toJSON(t){const{width:i,height:r,text:s,isFill:o}=this,a=super.toJSON(t),l=pn(this.fontData)??null,c=this.children.map(u=>u.toJSON(t));return{...a,text:s,isFill:o,width:i,height:r,resolution:1,fillColor:this.config.fillColor,lineColor:this.config.lineColor,style:{...this.style},fontData:l,charJSONs:c}}containsPoint(t){const i=this.getLocalBounds(),r=this.toLocal(t);return i.contains(r.x,r.y)}parseJSON(t){this.anchorLocalX=this.inited?this._getTextAnchorLocalX():void 0;const{width:i,height:r}=t;i&&(this.width=i),r&&(this.height=r),super.parseJSON(t);const{text:s=this.text,style:o={},fillColor:a,lineColor:l,isFill:c,layerTag:u,layerColor:h,enableFill:d}=t;this.style={...this.style,...o};let f=!1;if(this.text=s,Hu(t,this.triggerGlyphsChange)){f=!0;const p=!Hu(t,this.noReuseKeys);this.updateText(p)}Hu(o,this.triggerStyleChange)&&!f&&this.updateTextStyle(),Hu(t,["isFill","lineColor","fillColor","layerTag","layerColor","enableFill"])&&this.parseNodeJSON({fillColor:a,lineColor:l,isFill:c,layerTag:u,layerColor:h,enableFill:d}),this.updateMetrics()}parseNodeJSON(t){this.children.forEach(r=>{r.parseJSON(t)})}reDraw(){this.children.forEach(t=>{t.reDraw()})}toggleFill(t=this.isFill){this.children.forEach(r=>{r.toggleFill(t)})}destroyChildren(){const t=this.removeChildren(0,this.children.length);for(let i=0;i<t.length;++i)t[i].destroy()}transformCommit(){this.converHeightToFontSize()}converHeightToFontSize(){this.style.fontSize=ad*this.scale.y}updateText(t=!1){const{text:i,style:{fontFamily:r,fontSubfamily:s,fontSource:o,fontSize:a}}=this,l=an.measureText({fontFamily:r,fontSubfamily:s,fontSource:o,text:i,fontSize:an.ptToMM(Number(ad))});if(!l||wt(l)){console.warn("无法获取到对应文字信息",i,r,s);return}this.updateTextScaleByFontSize(a),this.fontData=l;const{glyphData:c={}}=l,u=an.splitTextToLines(i);if(this.removeChildren(),this.lines=u,!c){console.warn("loss glyphData");return}const h=new Map;u.forEach(d=>{var p;const f=am(d);for(let g=0;g<f.length;g++){const m=f[g],v=c[m];if(!v)console.warn("There is no valid glyph to create display object for",m,c);else{let _;t&&(_=(p=S(this,jf).get(m))==null?void 0:p.pop()),_||(_=this.createSVGPathNode({dPath:v.dPath,isFill:this.isFill,layerColor:this.layerColor,layerTag:this.layerTag,...this.config,enableFill:this.enableFill}));let y=h.get(m);y||(y=[],h.set(m,y)),y.push(_),this.addChild(_)}}}),S(this,jf).forEach(d=>{d.forEach(f=>{f.destroy()})}),Qe(this,jf,h),this.updateTextStyle()}updateTextScaleByFontSize(t){const i=this.scale.x,r=this.scale.y,s=Number(t)/ad;this.scale.y=s,this.scale.x=i/r*s}updateTextStyle(){an.updateGlyphPositions(this.children,this.lines,this.fontData,{...this.style,fontSize:ad}),this.curveInfo=an.updateTextCurveEffect(this,this.style,this.lines,this.fontData),this.enableFill||this.addHitArea()}applyTextAnchorFixup(){if(!Fp(this.anchorLocalX)){const t=this._getTextAnchorLocalX(),i=this.anchorLocalX-t,r=this.localTransform.clone().translate(-this.x,-this.y).apply({x:i/this.metrics.fontScale,y:0});this.parseJSON({x:this.x+r.x,y:this.y+r.y}),this.anchorLocalX=t}}update(t,i){}getRealPoints(t){let i=[];for(let r=0;r<this.children.length;r++){const o=this.children[r].getRealPoints(t);i=i.concat(o)}return i}getRealBounds(){const t=new oi;for(let i=0;i<this.children.length;i++)this.children[i].getRealBounds(t);return t}isVaild(){return this.isEditing||(this.width>0||this.height>0)&&this.text.trim().length!==0}getSVGData(t){const i={...t,relativeObj:this};return Ln(super.getSVGData(t),{tag:"g",children:this.children.map(r=>r.getSVGData(i))})}updateMetrics(){this.metrics=an.measureTextDisplay(this)}_getTextAnchorLocalX(){var o;const t=(o=this.style)==null?void 0:o.align,i=this.metrics;if(!t||t==="left"||!i)return 0;const r=i.advWidth*i.fontScale;return t==="center"?r/2:t==="right"?r:0}}jf=new WeakMap;const Xd=new Pt;class TMe{constructor(e={}){this._recursive=typeof e.recursive=="boolean"?e.recursive:!0,this._toggle=e.toggle||"visible",this._targetList=new Set}add(e){return this._targetList.add(e),this}addAll(e){for(let t=0,i=e.length;t<i;t++)this._targetList.add(e[t]);return this}remove(e){return this._targetList.delete(e),this}removeAll(e){for(let t=0,i=e.length;t<i;t++)this._targetList.delete(e[t]);return this}clear(){return this._targetList.clear(),this}cull(e,t=!1){return t||this.uncull(),this._targetList.forEach(i=>{t||i.getBounds(!1,Xd),this._recursive?this.cullRecursive(e,i,t):(t&&i._bounds.getRectangle(e),i[this._toggle]=Xd.right>e.left&&Xd.left<e.right&&Xd.bottom>e.top&&Xd.top<e.bottom)}),this}uncull(){return this._targetList.forEach(e=>{this._recursive?this.uncullRecursive(e):e[this._toggle]=!1}),this}cullRecursive(e,t,i){const r=i?t._bounds.getRectangle(Xd):t.getBounds(!0,Xd);if(t[this._toggle]=r.right>e.left&&r.left<e.right&&r.bottom>e.top&&r.top<e.bottom,!(r.left>=e.left&&r.top>=e.top&&r.right<=e.right&&r.bottom<=e.bottom)&&t[this._toggle]&&t.children&&t.children.length){const o=t.children;for(let a=0,l=o.length;a<l;a++)this.cullRecursive(e,o[a])}}uncullRecursive(e){if(e[this._toggle]=!0,e.children&&e.children.length){const t=e.children;for(let i=0,r=t.length;i<r;i++)this.uncullRecursive(t[i])}}}var IMe={grad:.9,turn:360,rad:360/(2*Math.PI)},nu=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},cs=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},qa=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},B9=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},UH=function(n){return{r:qa(n.r,0,255),g:qa(n.g,0,255),b:qa(n.b,0,255),a:qa(n.a)}},m1=function(n){return{r:cs(n.r),g:cs(n.g),b:cs(n.b),a:cs(n.a,3)}},SMe=/^#([0-9a-f]{3,8})$/i,ww=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},F9=function(n){var e=n.r,t=n.g,i=n.b,r=n.a,s=Math.max(e,t,i),o=s-Math.min(e,t,i),a=o?s===e?(t-i)/o:s===t?2+(i-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:r}},U9=function(n){var e=n.h,t=n.s,i=n.v,r=n.a;e=e/360*6,t/=100,i/=100;var s=Math.floor(e),o=i*(1-t),a=i*(1-(e-s)*t),l=i*(1-(1-e+s)*t),c=s%6;return{r:255*[i,a,o,o,l,i][c],g:255*[l,i,i,a,o,o][c],b:255*[o,o,l,i,i,a][c],a:r}},GH=function(n){return{h:B9(n.h),s:qa(n.s,0,100),l:qa(n.l,0,100),a:qa(n.a)}},HH=function(n){return{h:cs(n.h),s:cs(n.s),l:cs(n.l),a:cs(n.a,3)}},VH=function(n){return U9((t=(e=n).s,{h:e.h,s:(t*=((i=e.l)<50?i:100-i)/100)>0?2*t/(i+t)*100:0,v:i+t,a:e.a}));var e,t,i},Dy=function(n){return{h:(e=F9(n)).h,s:(r=(200-(t=e.s))*(i=e.v)/100)>0&&r<200?t*i/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,t,i,r},PMe=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,MMe=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,RMe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,DMe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,zH={string:[[function(n){var e=SMe.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?cs(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?cs(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=RMe.exec(n)||DMe.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:UH({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=PMe.exec(n)||MMe.exec(n);if(!e)return null;var t,i,r=GH({h:(t=e[1],i=e[2],i===void 0&&(i="deg"),Number(t)*(IMe[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return VH(r)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,i=n.b,r=n.a,s=r===void 0?1:r;return nu(e)&&nu(t)&&nu(i)?UH({r:Number(e),g:Number(t),b:Number(i),a:Number(s)}):null},"rgb"],[function(n){var e=n.h,t=n.s,i=n.l,r=n.a,s=r===void 0?1:r;if(!nu(e)||!nu(t)||!nu(i))return null;var o=GH({h:Number(e),s:Number(t),l:Number(i),a:Number(s)});return VH(o)},"hsl"],[function(n){var e=n.h,t=n.s,i=n.v,r=n.a,s=r===void 0?1:r;if(!nu(e)||!nu(t)||!nu(i))return null;var o=function(a){return{h:B9(a.h),s:qa(a.s,0,100),v:qa(a.v,0,100),a:qa(a.a)}}({h:Number(e),s:Number(t),v:Number(i),a:Number(s)});return U9(o)},"hsv"]]},$H=function(n,e){for(var t=0;t<e.length;t++){var i=e[t][0](n);if(i)return[i,e[t][1]]}return[null,void 0]},kMe=function(n){return typeof n=="string"?$H(n.trim(),zH.string):typeof n=="object"&&n!==null?$H(n,zH.object):[null,void 0]},v1=function(n,e){var t=Dy(n);return{h:t.h,s:qa(t.s+100*e,0,100),l:t.l,a:t.a}},_1=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},WH=function(n,e){var t=Dy(n);return{h:t.h,s:t.s,l:qa(t.l+100*e,0,100),a:t.a}},jH=function(){function n(e){this.parsed=kMe(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return cs(_1(this.rgba),2)},n.prototype.isDark=function(){return _1(this.rgba)<.5},n.prototype.isLight=function(){return _1(this.rgba)>=.5},n.prototype.toHex=function(){return e=m1(this.rgba),t=e.r,i=e.g,r=e.b,o=(s=e.a)<1?ww(cs(255*s)):"","#"+ww(t)+ww(i)+ww(r)+o;var e,t,i,r,s,o},n.prototype.toRgb=function(){return m1(this.rgba)},n.prototype.toRgbString=function(){return e=m1(this.rgba),t=e.r,i=e.g,r=e.b,(s=e.a)<1?"rgba("+t+", "+i+", "+r+", "+s+")":"rgb("+t+", "+i+", "+r+")";var e,t,i,r,s},n.prototype.toHsl=function(){return HH(Dy(this.rgba))},n.prototype.toHslString=function(){return e=HH(Dy(this.rgba)),t=e.h,i=e.s,r=e.l,(s=e.a)<1?"hsla("+t+", "+i+"%, "+r+"%, "+s+")":"hsl("+t+", "+i+"%, "+r+"%)";var e,t,i,r,s},n.prototype.toHsv=function(){return e=F9(this.rgba),{h:cs(e.h),s:cs(e.s),v:cs(e.v),a:cs(e.a,3)};var e},n.prototype.invert=function(){return ho({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),ho(v1(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),ho(v1(this.rgba,-e))},n.prototype.grayscale=function(){return ho(v1(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),ho(WH(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),ho(WH(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?ho({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):cs(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=Dy(this.rgba);return typeof e=="number"?ho({h:e,s:t.s,l:t.l,a:t.a}):cs(t.h)},n.prototype.isEqual=function(e){return this.toHex()===ho(e).toHex()},n}(),ho=function(n){return n instanceof jH?n:new jH(n)};class kd{static converToLayerColor(e){return e}static convertFillColor(e){return!1}static convertToLayerColorHex(e){return e=ho(e).toHex(),e=kd.converToLayerColor(e),e=ho(e).toHex(),e}}function G9(n,e,t=!0){if(t){const s=e.stroke==="none"?e.fill:e.stroke;e.stroke==="none"&&e.fill==="none"&&(n.isValid=!1);const o=ho(s).toHex();let a=kd.converToLayerColor(o);a=ho(a).toHex(),n.layerColor=a,n.layerTag=a,n.originColor=o}const i=kd.convertFillColor(e.fill),r=i?i!=="none":!1;n.isFill=r}const OMe={fontInfo:{unitsPerEm:2e3,lineHeight:30.48,ascent:25.0698,descent:-5.4102,capHeight:18.199099999999998,xHeight:12.8651,lineGap:0},glyphData:{H:{dPath:"M16.97 0L14.49 0L14.49 -8.28L4.69 -8.28L4.69 0L2.21 0L2.21 -18.2L4.69 -18.2L4.69 -10.08L14.49 -10.08L14.49 -18.2L16.97 -18.2Z",advanceWidth:19.2024,advanceHeight:25.4,leftBearing:2.2098,topBearing:2.2479,bbox:{minX:2.2098,minY:0,maxX:16.9672,maxY:18.199099999999998}},E:{dPath:"M13.42 -18.2L13.42 -16.19L4.69 -16.19L4.69 -10.15L11.76 -10.15L11.76 -8.22L4.69 -8.22L4.69 -2.01L13.42 -2.01L13.42 0L2.21 0L2.21 -18.2Z",advanceWidth:14.757399999999999,advanceHeight:25.4,leftBearing:2.2098,topBearing:2.2479,bbox:{minX:2.2098,minY:0,maxX:13.4239,maxY:18.199099999999998}},L:{dPath:"M4.67 -2.07L12.55 -2.07L12.55 0L2.21 0L2.21 -18.2L4.67 -18.2Z",advanceWidth:13.0556,advanceHeight:25.4,leftBearing:2.2098,topBearing:2.2479,bbox:{minX:2.2098,minY:0,maxX:12.5476,maxY:18.199099999999998}},O:{dPath:"M19.11 -9.09Q19.11 -7.05 18.47 -5.34Q17.82 -3.63 16.64 -2.4Q15.46 -1.17 13.8 -0.49Q12.14 0.19 10.13 0.19Q8.13 0.19 6.48 -0.49Q4.83 -1.17 3.64 -2.4Q2.46 -3.63 1.82 -5.34Q1.17 -7.05 1.17 -9.09Q1.17 -11.14 1.82 -12.85Q2.46 -14.55 3.64 -15.79Q4.83 -17.03 6.48 -17.72Q8.13 -18.4 10.13 -18.4Q12.14 -18.4 13.8 -17.72Q15.46 -17.03 16.64 -15.79Q17.82 -14.55 18.47 -12.85Q19.11 -11.14 19.11 -9.09ZM16.59 -9.09Q16.59 -10.77 16.13 -12.1Q15.67 -13.44 14.83 -14.36Q14 -15.28 12.8 -15.77Q11.61 -16.27 10.13 -16.27Q8.67 -16.27 7.48 -15.77Q6.29 -15.28 5.44 -14.36Q4.6 -13.44 4.14 -12.1Q3.68 -10.77 3.68 -9.09Q3.68 -7.42 4.14 -6.09Q4.6 -4.76 5.44 -3.84Q6.29 -2.92 7.48 -2.43Q8.67 -1.94 10.13 -1.94Q11.61 -1.94 12.8 -2.43Q14 -2.92 14.83 -3.84Q15.67 -4.76 16.13 -6.09Q16.59 -7.42 16.59 -9.09Z",advanceWidth:20.269199999999998,advanceHeight:25.4,leftBearing:1.1683999999999999,topBearing:2.0446999999999997,bbox:{minX:1.1683999999999999,minY:-.1905,maxX:19.1135,maxY:18.4023}}}},QH=25.4,XH=72,ad=72,ff=.1;class an{static measureText(e){return OMe}static ptToMM(e){return e/XH*QH}static mmToPT(e){return e/QH*XH}static converStyleToSubFamily(e,t){const i={700:"Bold",200:"Thin"},r={italic:"Italic"};return`${i[e]||""} ${r[t]||""}`.trim()||"Regular"}static calSpaceByFontSize(e,t){return an.ptToMM(Number(e))*t}static splitFontFamily(e){Array.isArray(e)&&(e=e[0]);const t=["Regular","Regular Italic","Italic","Oblique","Thin","Thin Italic","ExtraLight","Extra Light","ExtraLight Italic","Ultra Light","UltraLight","UltraLight Italic","Light","Light Italic","Light Oblique","Medium","Medium Italic","Medium Oblique","Semibold","SemiBold Italic","Demi","DemiBold","DemiBold Italic","Bold","Bold Italic","Bold Oblique","ExtraBold","ExtraBold Italic","UltraBold","UltraBold Italic","Black","Black Italic","Black Oblique","Heavy","Heavy Italic","Heavy Oblique","ExtraBlack","UltraBlack","Condensed","Condensed Thin","Condensed Light","Condensed Medium","Condensed Bold","Condensed ExtraBold","Condensed Black"];let i="",r=0;t.forEach(o=>{e.includes(o)&&o.length>r&&(r=o.length,i=o)});const s=e.endsWith(i);return e=s?e.replace(i,"").trim():e,{fontFamily:e,fontSubfamily:s?i:""}}static isTextNeededAdapt(e){return e.type===it.TEXT&&Ds(e,"style.lineSize")}static adaptMText(e){const{x:t,y:i,height:r,style:s={},scale:o,text:a="",angle:l}=e,{lineSize:c,...u}=s,h=.8,d=r*h,f=a.split(/(?:\r\n|\r|\n)/),p=an.mmToPT(d/f.length),g=r*(1-h+.2)/2,m=t-g*Math.sin(l/180*Math.PI),v=i+g*Math.cos(l/180*Math.PI),{fontFamily:_,fontSubfamily:y}=an.splitFontFamily(s.fontFamily);return{...e,scale:{...o},style:{...u,fontSize:p,fontFamily:_,fontSubfamily:y||an.converStyleToSubFamily(s.fontWeight,s.fontStyle)||s.fontSubfamily,letterSpacing:0,leading:0},x:m,y:v,height:d}}static converHeightToFontSize(e,t){const i=Number(e)*t.y,r=t.x;return{scale:{x:1/(t.y/r),y:1},fontSize:i}}static splitTextToLines(e){return e.split(/(?:\r\n|\r|\n)/)}static updateGlyphPositions(e,t,i,r,s={x:0,y:0}){const{glyphData:o={},fontInfo:{lineHeight:a=0}}=i,{fontSize:l,leading:c,letterSpacing:u,align:h}=r,{maxWidth:d,linesWidth:f}=p();g();function p(){const m={};let v=0;return t.forEach((_,y)=>{const A=am(_);let w=0;for(let b=0;b<A.length;b++){const C=A[b],I=o[C];I?w+=I.advanceWidth:console.warn("There is no valid glyph to create display object for",C,o)}w+=(A.length-1)*an.calSpaceByFontSize(l,u*ff),m[y]=w,v=w>v?w:v}),{maxWidth:v,linesWidth:m}}function g(){let m=0,v=0;t.forEach((_,y)=>{const A=am(_);let w=UC(h,d,f[y]);for(let b=0;b<A.length;b++){const C=A[b],I=o[C];if(!I)console.warn("There is no valid glyph to create display object for",C,o);else{const x=e[m];x&&(x.x=s.x+w,x.y=s.y+v,x.rotation=0,w+=I.advanceWidth+an.calSpaceByFontSize(l,u*ff)),m+=1}}v+=a+an.calSpaceByFontSize(l,c*ff)})}return{maxWidth:d,linesWidth:f}}static detectSupportTextToPath(e){return"fontData"in e&&"charJSONs"in e}static convertTextJSONToPathJSONs(e){if(!e.text||!e.fontData||!e.charJSONs)return console.warn("can not covert textJSON with an empty text, fontData or charJSONs"),[];const t=gr(e,["isFill","lockRatio","isClosePath","zOrder","lineColor","fillColor","groupTag","layerTag","layerColor","visible"]);t.groupTag||(t.groupTag=p9());const i=[];for(const r of e.charJSONs)Object.assign(r,t),r.sourceId=e.id,i.push(r);return i}static measureTextDisplay(e){var t;return(t=e.transform)==null||t.updateLocalTransform(),an.measureTextJSON(e.text,e.style,e.fontData,e.curveInfo)}static measureTextJSON(e,t,i,r){t=Ln(pn(Ya),t);const{fontFamily:s,fontSubfamily:o,fontSource:a,letterSpacing:l,leading:c,align:u}=t,h=ad,f=(isFinite(Number(t.fontSize))?Number(t.fontSize):ad)/ad;i||(i=an.measureText({fontFamily:s,fontSubfamily:o,fontSource:a,text:e,fontSize:an.ptToMM(h)}));const{fontInfo:{lineHeight:p}}=i,g=an.splitTextToLines(e),m=an.calSpaceByFontSize(h,l*ff),v=an.calSpaceByFontSize(h,c*ff);return{...an.measureLines(g,i,p,{lineSpace:v,glyphSpace:m,align:u,curveInfo:r}),fontData:i,fontScale:f,glyphSpace:m,lineSpace:v}}static measureLines(e,t,i,r){const{lineSpace:s=0,glyphSpace:o=0,align:a="left",curveInfo:l}=r??{},{glyphData:c}=t,{maxAdvWidth:u,linesAdvWidth:h}=an.calcLineAdvWidth(e,c,o),d=u;let f=0,p=0;const g=new oi,m=new oi;let v=0;const _=e.map((y,A)=>{var I;p&&(p+=s);const w=UC(a,u,h[A]),b=A*(i+s),C=an.measureLine(y,t,{glyphSpace:o,lineOriginX:w,lineOriginY:b,flipY:!0,charStartIndex:v,curveInfo:l,linePath:(I=l==null?void 0:l.linePaths)==null?void 0:I[A]});return Object.assign(C,{lineOffsetX:w,lineOffsetY:b,lineHeight:i,charStartIndex:v}),g.addBounds(C.bbox.getBounds()),m.addBounds(C.emBox.getBounds()),f=Math.max(f,C.width),p+=C.advHeight,v+=y.length+1,C});return{maxWidth:f,maxAdvWidth:u,...an.createMetric(g.minX,g.minY,g.maxX,g.maxY,d,p),lineMetrics:_,emBox:new xh().setBounds(m)}}static calcLineAdvWidth(e,t,i){let r=0;const s={};return e.forEach((o,a)=>{const l=am(o);let c=0;for(let u=0;u<l.length;u++){const h=l[u],d=t[h];d&&(c+=d.advanceWidth,c&&(c+=i))}s[a]=c,r=c>r?c:r}),{maxAdvWidth:r,linesAdvWidth:s}}static measureLine(e,t,i){const{glyphSpace:r=0,lineOriginX:s=0,lineOriginY:o=0,flipY:a=!0,charStartIndex:l=0,linePath:c,curveInfo:u}=i??{},{glyphData:h}=t,{ascent:d,descent:f,capHeight:p}=t.fontInfo,{glyphOffsetX:g,glyphOffsetY:m}=u??{},v=new oi,_=new oi,y=new oi;let A=0,w=0;const b=am(e),C={};b.push("");let I=l;return b.forEach((T,O)=>{const F=O===b.length-1,G=h[T]??{advanceWidth:0,advanceHeight:0,bbox:{minX:0,maxX:0,minY:0,maxY:p}};A&&(A+=r);const B=s+A,R=o,P=new xh({minX:G.bbox.minX,minY:a?-G.bbox.maxY:G.bbox.minY,maxX:G.bbox.maxX,maxY:a?-G.bbox.minY:G.bbox.maxY}),k=new xh({minX:0,minY:-d,maxX:G.advanceWidth+(F?0:r),maxY:-f});let L;const H=new Dt().translate(B,R);if(u&&c){const $=(G.bbox.maxX+G.bbox.minX)/2,j=B+$-g,Q=c.getTransformAt(j,new Ae($,m));L=new Dt().rotate(Q.rotation).translate(Q.position.x,Q.position.y)}else L=H;const U=an.createMetric(P.minX,P.minY,P.maxX,P.maxY,G.advanceWidth,G.advanceHeight);U.bbox.matrix=L,U.emBox=new xh(k,L),U.straightEmBox=new xh(k,H),U.char=T,U.index=I,C[I]=U,I+=(T==null?void 0:T.length)??1,v.addBounds(U.bbox.getMatrixBounds()),_.addBounds(U.emBox.getMatrixBounds()),y.addBounds(U.straightEmBox.getMatrixBounds()),A+=G.advanceWidth,w=Math.max(G.advanceHeight,w)}),{...an.createMetric(v.minX,v.minY,v.maxX,v.maxY,A,w),charMetrics:C,emBox:new xh().setBounds(_),straightEmBox:new xh().setBounds(y)}}static createMetric(e,t,i,r,s,o,a){const l=new xh(tSe({minX:e,minY:t,maxX:i,maxY:r},a));return{bbox:l,x:l.minX,y:l.minY,width:sd(i-e,a),height:sd(r-t,a),advWidth:sd(s,a),advHeight:sd(o,a)}}static updateTextCurveEffect(e,t,i,r){let s;const{lineHeight:o=0,capHeight:a=0}=r.fontInfo,{curveX:l,curveY:c,align:u,leading:h}=t,d={x:l,y:c},f=Math.sign(d.y)||0,p=f*an.calcCurveRadiusByHandle(d),g=e.getLocalBounds(),m=an.calcCurveAnchorX(u,g),v=an.calcCurveAnchorY(g);if(f){const _=o+an.calSpaceByFontSize(ad,h*ff),y=f>0?i.length-1:0,A=0,w=(f>0?0:-1)*a,b=an.calcTextCurvePath(p,0,m,v),C=i.map((I,x)=>{const T=x*_,O=T+w-v,F=-f*O,G=T+w;return an.calcTextCurvePath(p,F,m,G)});s={curveDir:f,curveRadius:p,linePaths:C,glyphOffsetX:A,glyphOffsetY:w,curveAnchor:{x:m,y:v},curveBaselineIndex:y,handlePath:b},an.applyTextCurve(e,s)}else s={curveDir:0,curveAnchor:{x:m,y:v}};return s}static calcCurveRadiusByHandle(e){const t=e.x,i=e.y;return(t**2+i**2)/(2*Math.abs(i))}static calcCurveAnchorX(e,t){let i;return e==="center"?i=t.x+t.width/2:e==="right"?i=t.x+t.width:i=t.x,i}static calcCurveAnchorY(e){return e.y+e.height/2}static applyTextCurve(e,{linePaths:t,glyphOffsetX:i,glyphOffsetY:r}){let s=0;e.lines.forEach((o,a)=>{const l=am(o),c=t[a];for(let u=0;u<l.length;u++){const h=l[u],d=e.children[s],f=e.fontData.glyphData[h],p=(f.bbox.maxX+f.bbox.minX)/2,g=d.position.x+p-i,m=c.getTransformAt(g,new Ae(p,r)),v=new Dt().rotate(m.rotation).translate(m.position.x,m.position.y);d.transform.setFromMatrix(v),d.transform.updateLocalTransform(),s+=1}})}static calcTextCurvePath(e,t=0,i=0,r=0){if(!e)return null;const s=e<0,o=s?-1:1,a=Math.abs(e)+t,l=new Ae(i,r),c=new Dt().translate(0,o*a).apply(l),u=-o*i/a,h=SSe(l,u,c);return{c,o:h,a:l,radius:a,oNormalsRotation:u,ccw:s,getTransformAt(f,p){const g=this.ccw?-1:1,m=f/this.radius*g,v=this.oNormalsRotation+m,_=new Dt().translate(-this.c.x,-this.c.y).rotate(m).translate(this.c.x,this.c.y);if(p){const A=new Dt().translate(-p.x,-p.y).rotate(v).apply(new Ae(0,0));_.translate(A.x,A.y)}return{position:_.apply(this.o),rotation:v,matrix:_}}}}static async preloadFontAndGlyphs(e,t){console.log("abstract method should be implement",{texts:e,style:t})}static async preloadMultiTextFontGlyphs(e){for(const t of e)await this.preloadFontAndGlyphs([t.text],gr(t.style,["fontFamily","fontSubfamily","fontSource"])),console.log("[ Preload Font ]")}static isTextHasTSpan(e){for(const t of Array.from(e.childNodes))if(t instanceof SVGTSpanElement)return!0;return!1}static parseSVGTextElement(e,t,i){const{computedStyle:r,withColor:s}=i??{},o={x:0,y:0};let a="";const l=(u,h)=>{let d=0;if(!u.childNodes.length)return{textCount:d};const{charIndex:f=0,parents:p=[],parentTextJSON:g,isLastEl:m=!1,computedStyle:v=getComputedStyle(u)}=h,_={el:u,charIndex:f};return p.push(_),u.childNodes.forEach((y,A)=>{const w=u instanceof SVGTextElement&&A===u.childNodes.length-1;if(y instanceof SVGTSpanElement){const b=getComputedStyle(y),C=YH(y,{...i,withContent:!1,withPosition:!1,withTransform:!1,computedStyle:b}),I=l(y,{charIndex:d,parents:p,parentTextJSON:C,isLastEl:w,computedStyle:b});I.textCount>0&&(d+=I.textCount)}else if(y instanceof Text){let b=NMe(y.textContent);if((f+d===0||a.endsWith(" "))&&(b=b.trimStart()),(w||m&&A===u.childNodes.length-1)&&(b=b.trimEnd()),!b)return;a=b;const{x:C,y:I}=an.resolveTextNodeLayoutAttrs(o,d,p);d+=b.length;const x=new E2({text:b,style:g.style,x:C,y:I});if(G9(x,v,s),x){const T=an.measureTextDisplay(x),O=T.advWidth*T.fontScale,F=x.style.align,G=-(F==="center"?O/2:F==="right"?O:0);x.x+=G,o.x=x.x+(T?O:x.width),o.y=x.y,t.addChild(x)}}}),p.pop(),{textCount:d}},c=YH(e,{...i,withContent:!1,withPosition:!1,withTransform:!1,computedStyle:r});return l(e,{parentTextJSON:c,computedStyle:r}),t}static resolveTextNodeLayoutAttrs(e,t,i){var u,h,d,f,p;const r=new Map,s=["x","y","dx","dy","rotate"];for(let g=i.length-1;g>=0;g--){const m=i[g];for(const v of s)if(!r.has(v)&&((d=(h=(u=m.el)==null?void 0:u[v])==null?void 0:h.baseVal)==null?void 0:d.length)>0){const _=(p=(f=m.el)==null?void 0:f[v])==null?void 0:p.baseVal;try{if((_==null?void 0:_.length)>t){const y=_.getItem(t);r.set(v,y.value)}}catch(y){console.error(y)}}if(r.size>=s.length)break;m.charIndex>0&&(t+=m.charIndex)}const o={x:0,y:0},a={x:e.x,y:e.y};r.has("x")&&(a.x=r.get("x")),r.has("y")&&(a.y=r.get("y")),r.has("dx")&&(o.x=r.get("dx")),r.has("dy")&&(o.y=r.get("dy"));const l=a.x+o.x,c=a.y+o.y;return{x:l,y:c}}static fuzzyMatchFontByCssStyle(e){return console.log("abstract method should be implement",{computedStyle:e}),null}}function YH(n,e){const{withContent:t=!0,withStyle:i=!0,withPosition:r=!0,withTransform:s=!0,computedStyle:o=getComputedStyle(n)}=e??{};return{...t?{text:LMe(n)}:null,...i?{style:GMe(n,o,e)}:null,...r?{...BMe(n),...FMe(n)}:null,...s?{transform:UMe(n)}:null}}function LMe(n){return Array.from(n.childNodes).map(e=>e.textContent.replace(/([\n\t ][\t ]*)/g,(t,i,r,s)=>i.includes(`
`)?`
`:!r||r+t.length===s.length?"":" ")).join("").trim()}function NMe(n){return n.replace(/[\n\t ]+/g," ")}function BMe(n){const e=n.x.baseVal.length>0?n.x.baseVal.getItem(0).value:void 0,t=n.y.baseVal.length>0?n.y.baseVal.getItem(0).value:void 0;return{x:e,y:t}}function FMe(n){const e=n.dx.baseVal.length>0?n.dx.baseVal.getItem(0).value:void 0,t=n.dy.baseVal.length>0?n.dy.baseVal.getItem(0).value:void 0;return{dx:e,dy:t}}function UMe(n){const e=new Dt,t=n instanceof SVGGraphicsElement?n.transform.baseVal.consolidate():null;if(t&&t.matrix){const{matrix:{a:i,b:r,c:s,d:o,e:a,f:l}}=t;e.set(i,r,s,o,a,l)}return e}function GMe(n,e,t){return{align:VMe(n,e)??Ya.align,letterSpacing:zMe(e)??Ya.letterSpacing,fontSize:HMe(n,e)??Ya.fontSize,...H9(n,e,t)??gr(Ya,["fontFamily","fontSubfamily","fontSource"])}}function H9(n,e,t){var r;const i=an.fuzzyMatchFontByCssStyle(e);if(!i&&(t!=null&&t.lossFonts)){const s=(r=e["font-family"])==null?void 0:r.replace(/['"]/g,"");t.lossFonts.add(s)}return i}function HMe(n,e){const t=(e==null?void 0:e["font-size"])??n.getAttribute("font-size");return GD(t)}function GD(n){if(!n)return;let e,t;if(globalThis.CSSUnitValue)({value:e,unit:t}=window.CSSUnitValue.parse(n));else{const i=n==null?void 0:n.trim().match(/^([^A-Za-z\s]+)([A-Za-z]*)$/);if(!i)return;e=parseFloat(i[0]),t=i[1]??"number"}return t==="px"?an.mmToPT(e):e}function VMe(n,e){const t=(e==null?void 0:e["text-anchor"])??n.getAttribute("text-anchor");return t==="start"?"left":t==="middle"?"center":t==="end"?"right":null}function zMe(n){const e=n["font-size"];let t=n["letter-spacing"];return t==="normal"&&(t="0"),GD(t)/GD(e)/ff}function*$Me(n,e){try{const i=document.evaluate(".//text()",n,null,XPathResult.ANY_TYPE,null);if(i.invalidIteratorState){console.error("XPathResult invalidIteratorState");return}let r;for(;r=i.iterateNext();)((e==null?void 0:e(r))??!0)&&(yield r)}catch(t){console.error("XPath iterate error",t)}}function*WMe(n,e){const t=n.querySelectorAll("text");for(const i of Array.from(t))for(const r of $Me(i))if(r&&(r.parentElement instanceof SVGTextElement||r.parentElement instanceof SVGTSpanElement)){const o={parent:r.parentElement,text:r};((e==null?void 0:e(o))??!0)&&(yield o)}}function jMe(n){const e=({text:r})=>r.textContent.trim().length>0,t=[],i=new Set;for(const{text:r,parent:s}of WMe(n,e)){const o=r.textContent,a=getComputedStyle(s),l=H9(s,a,{lossFonts:i});l&&t.push({text:o,style:{...l}})}return{textProps:t,lossFonts:i}}async function QMe(n){await new Promise(i=>setTimeout(i,0));const{textProps:e,lossFonts:t}=jMe(n);for(const{text:i,style:r}of e)await an.preloadFontAndGlyphs([i],r);return{lossFonts:t}}class XMe extends mn{constructor(){super(...arguments);E(this,"isRefExternal",!1);E(this,"_ref")}embedUse(t){t.x.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.y.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.width.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX),t.height.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);const i=t.x.baseVal.valueInSpecifiedUnits,r=t.y.baseVal.valueInSpecifiedUnits;this.position.set(i,r)}get ref(){return this._ref}set ref(t){if(this._ref){if(this._ref===t)return;this.removeChild(this._ref)}this._ref=t,this.addChild(this._ref)}}const qH=new Map;async function KH(n){const e=new URL(n,document.baseURI),t=e.host+e.pathname;let i=qH.get(t);return i||(i=await fetch(e.toString()).then(r=>r.text()).then(r=>new DOMParser().parseFromString(r,"image/svg+xml").documentElement),qH.set(t,i)),i}const V9=new BC;V9.matrix=[.33,.33,.33,0,0,0,0,0,0,0,0,0,0,0,0,.33,.33,.33,0,0];const YMe=new Pt,qMe=new Pt;class KMe extends Ur{render(e){}}class JMe extends Ur{constructor(t){super(t);E(this,"dirtyId");E(this,"updateId");this.dirtyId=0,this.updateId=-1}render(t){if(this.dirtyId!==this.updateId){this.texture.baseTexture.setSize(this.texture.width,this.texture.height,t.resolution),t.batch.flush();const i=t.renderTexture.current,r=YMe.copyFrom(t.renderTexture.sourceFrame),s=qMe.copyFrom(t.renderTexture.destinationFrame),o=this.getLocalBounds(null),a=this.children;t.renderTexture.bind(this.texture,o),t.renderTexture.clear(),t.filter.push({filterArea:o,getBounds:()=>o},[V9]);for(let l=0,c=a.length;l<c;l++){const u=a[l];u.enableTempParent(),u.updateTransform(),a[l].render(t),u.disableTempParent(this)}t.batch.flush(),t.filter.pop(),t.renderTexture.bind(i,r,s),this.updateId=this.dirtyId,this.getBounds()}}createMask(t){return new KMe(this.texture)}}class JH{constructor(e,t){E(this,"parent");E(this,"provider");this.parent=e,this.provider=t}get dirtyId(){return this.parent.dirtyId+this.provider.dirtyId}get fill(){return this.provider.fill!==null?this.provider.fill:this.parent.fill}get opacity(){return typeof this.provider.opacity=="number"?this.provider.opacity:this.parent.opacity}get stroke(){return this.provider.stroke!==null?this.provider.stroke:this.parent.stroke}get strokeDashArray(){return Array.isArray(this.provider.strokeDashArray)?this.provider.strokeDashArray:this.parent.strokeDashArray}get strokeDashOffset(){return typeof this.provider.strokeDashOffset=="number"?this.provider.strokeDashOffset:this.parent.strokeDashOffset}get strokeLineCap(){return typeof this.provider.strokeLineCap=="string"?this.provider.strokeLineCap:this.parent.strokeLineCap}get strokeLineJoin(){return typeof this.provider.strokeLineJoin=="string"?this.provider.strokeLineJoin:this.parent.strokeLineJoin}get strokeMiterLimit(){return typeof this.provider.strokeMiterLimit=="number"?this.provider.strokeMiterLimit:this.parent.strokeMiterLimit}get strokeWidth(){return typeof this.provider.strokeWidth=="number"?this.provider.strokeWidth:this.parent.strokeWidth}}function qC(n){"@babel/helpers - typeof";return qC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qC(n)}var ZMe=/^\s+/,eRe=/\s+$/;function $t(n,e){if(n=n||"",e=e||{},n instanceof $t)return n;if(!(this instanceof $t))return new $t(n,e);var t=tRe(n);this._originalInput=n,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}$t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,i,r,s,o,a;return t=e.r/255,i=e.g/255,r=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=z9(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=e4(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=e4(this._r,this._g,this._b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+i+"%, "+r+"%)":"hsva("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=ZH(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=ZH(this._r,this._g,this._b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+i+"%, "+r+"%)":"hsla("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return t4(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return sRe(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Ji(this._r,255)*100)+"%",g:Math.round(Ji(this._g,255)*100)+"%",b:Math.round(Ji(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Ji(this._r,255)*100)+"%, "+Math.round(Ji(this._g,255)*100)+"%, "+Math.round(Ji(this._b,255)*100)+"%)":"rgba("+Math.round(Ji(this._r,255)*100)+"%, "+Math.round(Ji(this._g,255)*100)+"%, "+Math.round(Ji(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:vRe[t4(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+n4(this._r,this._g,this._b,this._a),i=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var s=$t(e);i="#"+n4(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=!1,r=this._a<1&&this._a>=0,s=!t&&r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return $t(this.toString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(cRe,arguments)},brighten:function(){return this._applyModification(uRe,arguments)},darken:function(){return this._applyModification(hRe,arguments)},desaturate:function(){return this._applyModification(oRe,arguments)},saturate:function(){return this._applyModification(aRe,arguments)},greyscale:function(){return this._applyModification(lRe,arguments)},spin:function(){return this._applyModification(dRe,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(gRe,arguments)},complement:function(){return this._applyCombination(fRe,arguments)},monochromatic:function(){return this._applyCombination(mRe,arguments)},splitcomplement:function(){return this._applyCombination(pRe,arguments)},triad:function(){return this._applyCombination(i4,[3])},tetrad:function(){return this._applyCombination(i4,[4])}};$t.fromRatio=function(n,e){if(qC(n)=="object"){var t={};for(var i in n)n.hasOwnProperty(i)&&(i==="a"?t[i]=n[i]:t[i]=ly(n[i]));n=t}return $t(n,e)};function tRe(n){var e={r:0,g:0,b:0},t=1,i=null,r=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=bRe(n)),qC(n)=="object"&&(iu(n.r)&&iu(n.g)&&iu(n.b)?(e=nRe(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):iu(n.h)&&iu(n.s)&&iu(n.v)?(i=ly(n.s),r=ly(n.v),e=rRe(n.h,i,r),o=!0,a="hsv"):iu(n.h)&&iu(n.s)&&iu(n.l)&&(i=ly(n.s),s=ly(n.l),e=iRe(n.h,i,s),o=!0,a="hsl"),n.hasOwnProperty("a")&&(t=n.a)),t=z9(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function nRe(n,e,t){return{r:Ji(n,255)*255,g:Ji(e,255)*255,b:Ji(t,255)*255}}function ZH(n,e,t){n=Ji(n,255),e=Ji(e,255),t=Ji(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s,o,a=(i+r)/2;if(i==r)s=o=0;else{var l=i-r;switch(o=a>.5?l/(2-i-r):l/(i+r),i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,l:a}}function iRe(n,e,t){var i,r,s;n=Ji(n,360),e=Ji(e,100),t=Ji(t,100);function o(c,u,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?c+(u-c)*6*h:h<1/2?u:h<2/3?c+(u-c)*(2/3-h)*6:c}if(e===0)i=r=s=t;else{var a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;i=o(l,a,n+1/3),r=o(l,a,n),s=o(l,a,n-1/3)}return{r:i*255,g:r*255,b:s*255}}function e4(n,e,t){n=Ji(n,255),e=Ji(e,255),t=Ji(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s,o,a=i,l=i-r;if(o=i===0?0:l/i,i==r)s=0;else{switch(i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,v:a}}function rRe(n,e,t){n=Ji(n,360)*6,e=Ji(e,100),t=Ji(t,100);var i=Math.floor(n),r=n-i,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),l=i%6,c=[t,o,s,s,a,t][l],u=[a,t,t,o,s,s][l],h=[s,s,a,t,t,o][l];return{r:c*255,g:u*255,b:h*255}}function t4(n,e,t,i){var r=[Wl(Math.round(n).toString(16)),Wl(Math.round(e).toString(16)),Wl(Math.round(t).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function sRe(n,e,t,i,r){var s=[Wl(Math.round(n).toString(16)),Wl(Math.round(e).toString(16)),Wl(Math.round(t).toString(16)),Wl($9(i))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function n4(n,e,t,i){var r=[Wl($9(i)),Wl(Math.round(n).toString(16)),Wl(Math.round(e).toString(16)),Wl(Math.round(t).toString(16))];return r.join("")}$t.equals=function(n,e){return!n||!e?!1:$t(n).toRgbString()==$t(e).toRgbString()};$t.random=function(){return $t.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function oRe(n,e){e=e===0?0:e||10;var t=$t(n).toHsl();return t.s-=e/100,t.s=gI(t.s),$t(t)}function aRe(n,e){e=e===0?0:e||10;var t=$t(n).toHsl();return t.s+=e/100,t.s=gI(t.s),$t(t)}function lRe(n){return $t(n).desaturate(100)}function cRe(n,e){e=e===0?0:e||10;var t=$t(n).toHsl();return t.l+=e/100,t.l=gI(t.l),$t(t)}function uRe(n,e){e=e===0?0:e||10;var t=$t(n).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),$t(t)}function hRe(n,e){e=e===0?0:e||10;var t=$t(n).toHsl();return t.l-=e/100,t.l=gI(t.l),$t(t)}function dRe(n,e){var t=$t(n).toHsl(),i=(t.h+e)%360;return t.h=i<0?360+i:i,$t(t)}function fRe(n){var e=$t(n).toHsl();return e.h=(e.h+180)%360,$t(e)}function i4(n,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=$t(n).toHsl(),i=[$t(n)],r=360/e,s=1;s<e;s++)i.push($t({h:(t.h+s*r)%360,s:t.s,l:t.l}));return i}function pRe(n){var e=$t(n).toHsl(),t=e.h;return[$t(n),$t({h:(t+72)%360,s:e.s,l:e.l}),$t({h:(t+216)%360,s:e.s,l:e.l})]}function gRe(n,e,t){e=e||6,t=t||30;var i=$t(n).toHsl(),r=360/t,s=[$t(n)];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,s.push($t(i));return s}function mRe(n,e){e=e||6;for(var t=$t(n).toHsv(),i=t.h,r=t.s,s=t.v,o=[],a=1/e;e--;)o.push($t({h:i,s:r,v:s})),s=(s+a)%1;return o}$t.mix=function(n,e,t){t=t===0?0:t||50;var i=$t(n).toRgb(),r=$t(e).toRgb(),s=t/100,o={r:(r.r-i.r)*s+i.r,g:(r.g-i.g)*s+i.g,b:(r.b-i.b)*s+i.b,a:(r.a-i.a)*s+i.a};return $t(o)};$t.readability=function(n,e){var t=$t(n),i=$t(e);return(Math.max(t.getLuminance(),i.getLuminance())+.05)/(Math.min(t.getLuminance(),i.getLuminance())+.05)};$t.isReadable=function(n,e,t){var i=$t.readability(n,e),r,s;switch(s=!1,r=wRe(t),r.level+r.size){case"AAsmall":case"AAAlarge":s=i>=4.5;break;case"AAlarge":s=i>=3;break;case"AAAsmall":s=i>=7;break}return s};$t.mostReadable=function(n,e,t){var i=null,r=0,s,o,a,l;t=t||{},o=t.includeFallbackColors,a=t.level,l=t.size;for(var c=0;c<e.length;c++)s=$t.readability(n,e[c]),s>r&&(r=s,i=$t(e[c]));return $t.isReadable(n,i,{level:a,size:l})||!o?i:(t.includeFallbackColors=!1,$t.mostReadable(n,["#fff","#000"],t))};var HD=$t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},vRe=$t.hexNames=_Re(HD);function _Re(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function z9(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function Ji(n,e){yRe(n)&&(n="100%");var t=ARe(n);return n=Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(n*e,10)/100),Math.abs(n-e)<1e-6?1:n%e/parseFloat(e)}function gI(n){return Math.min(1,Math.max(0,n))}function ra(n){return parseInt(n,16)}function yRe(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function ARe(n){return typeof n=="string"&&n.indexOf("%")!=-1}function Wl(n){return n.length==1?"0"+n:""+n}function ly(n){return n<=1&&(n=n*100+"%"),n}function $9(n){return Math.round(parseFloat(n)*255).toString(16)}function r4(n){return ra(n)/255}var Cl=function(){var n="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+n+")",i="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function iu(n){return!!Cl.CSS_UNIT.exec(n)}function bRe(n){n=n.replace(ZMe,"").replace(eRe,"").toLowerCase();var e=!1;if(HD[n])n=HD[n],e=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=Cl.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=Cl.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=Cl.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=Cl.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=Cl.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=Cl.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=Cl.hex8.exec(n))?{r:ra(t[1]),g:ra(t[2]),b:ra(t[3]),a:r4(t[4]),format:e?"name":"hex8"}:(t=Cl.hex6.exec(n))?{r:ra(t[1]),g:ra(t[2]),b:ra(t[3]),format:e?"name":"hex"}:(t=Cl.hex4.exec(n))?{r:ra(t[1]+""+t[1]),g:ra(t[2]+""+t[2]),b:ra(t[3]+""+t[3]),a:r4(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=Cl.hex3.exec(n))?{r:ra(t[1]+""+t[1]),g:ra(t[2]+""+t[2]),b:ra(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function wRe(n){var e,t;return n=n||{level:"AA",size:"small"},e=(n.level||"AA").toUpperCase(),t=(n.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}class DA{constructor(e){E(this,"element");E(this,"fill");E(this,"opacity");E(this,"stroke");E(this,"strokeDashArray");E(this,"strokeDashOffset");E(this,"strokeLineCap");E(this,"strokeLineJoin");E(this,"strokeMiterLimit");E(this,"strokeWidth");E(this,"dirtyId",0);this.element=e;const t=e.getAttribute("fill"),i=e.getAttribute("opacity"),r=e.getAttribute("stroke"),s=e.getAttribute("stroke-dasharray"),o=e.getAttribute("stroke-dashoffset"),a=e.getAttribute("stroke-linecap"),l=e.getAttribute("stroke-linejoin"),c=e.getAttribute("stroke-miterlimit"),u=e.getAttribute("stroke-width");this.fill=t!==null?t==="none"?"none":DA.parseColor(t):null,this.opacity=i&&parseFloat(i),this.stroke=r&&DA.parseColor(e.getAttribute("stroke")),this.strokeDashArray=s&&(s==null?void 0:s.split(/[, ]+/g).map(h=>parseFloat(h.trim()))),this.strokeDashOffset=o&&parseFloat(o),this.strokeLineCap=a,this.strokeLineJoin=l,this.strokeMiterLimit=c&&parseFloat(c),this.strokeWidth=u&&parseFloat(u)}static parseColor(e){if(!e)return 0;if(e==="none"||e.startsWith("url"))return e;if(e[0]==="#")return e=e.substr(1),e.length===3&&(e=e.replace(/([a-f0-9])/gi,"$1$1")),parseInt(e,16);const{r:t,g:i,b:r}=$t(e).toRgb();return(t<<16)+(i<<8)+r}}function s4(n){let e=n.toString(16);for(;e.length<6;)e=`0${e}`;return`#${e}`}const o4=new Pt,a4=new Pt;class l4{static createLinearGradient(e,t,i){const{x0:r,y0:s,x1:o,y1:a,colorStops:l}=i,c=document.createElement("canvas");c.width=t.width,c.height=t.height;const u=c.getContext("2d"),h=u.createLinearGradient(r,s,o,a);l.forEach(m=>{h.addColorStop(m.offset,s4(m.color))}),u.fillStyle=h,u.fillRect(0,0,t.width,t.height);const d=e.renderTexture.current,f=o4.copyFrom(e.renderTexture.sourceFrame),p=a4.copyFrom(e.renderTexture.destinationFrame),g=new Ur(Wt.from(c));return e.batch.flush(),e.renderTexture.bind(t),g.render(e),e.batch.flush(),e.renderTexture.bind(d,f,p),t}static createRadialGradient(e,t,i){const{x0:r,y0:s,r0:o,x1:a,y1:l,r1:c,colorStops:u}=i,h=document.createElement("canvas");h.width=t.width,h.height=t.height;const d=h.getContext("2d"),f=d.createRadialGradient(r,s,o,a,l,c);u.forEach(_=>{f.addColorStop(_.offset,s4(_.color))}),d.fillStyle=f,d.fillRect(0,0,t.width,t.height);const p=e.renderTexture.current,g=o4.copyFrom(e.renderTexture.sourceFrame),m=a4.copyFrom(e.renderTexture.destinationFrame),v=new Ur(Wt.from(h));return e.batch.flush(),e.renderTexture.bind(t),v.render(e),e.batch.flush(),e.renderTexture.bind(p,g,m),t}}function c4(n){n.x1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE),n.y1.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE),n.x2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE),n.y2.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE)}class xRe{constructor(e,t){E(this,"paintServer");E(this,"paintTexture");E(this,"paintContexts");E(this,"dirtyId");this.paintServer=e,this.paintTexture=t,this.paintContexts={},this.dirtyId=0}resolvePaint(e){const t=this.paintContexts[e.CONTEXT_UID],i=this.dirtyId;(t===void 0||t<i)&&(this.updatePaint(e),this.paintContexts[e.CONTEXT_UID]=i)}resolvePaintDimensions(e){const t=Math.ceil(e.width),i=Math.ceil(e.height),r=t/i,s=this.paintServer,o=this.paintTexture;if(s instanceof SVGLinearGradientElement){c4(s);const a=s.children,l=s.x1.baseVal.valueInSpecifiedUnits,c=s.y1.baseVal.valueInSpecifiedUnits,u=s.x2.baseVal.valueInSpecifiedUnits,h=s.y2.baseVal.valueInSpecifiedUnits,d=Math.atan2(h-c,u-l),f=a.length===1?2:64;let p=Math.max(1,f*Math.cos(d)),g=Math.max(1,f*Math.sin(d));if(p<t&&g<i){Math.abs(d)>.01&&Math.abs(d)%(Math.PI/2)>.01&&(p/g>r?g=p/r:p=r*g),o.resize(p,g,!0);return}}o.resize(t,i,!0)}updatePaint(e){this.paintServer instanceof SVGLinearGradientElement?this.linearGradient(e):this.paintServer instanceof SVGRadialGradientElement&&this.radialGradient(e)}linearGradient(e){const t=this.paintServer,i=this.paintTexture;return c4(t),l4.createLinearGradient(e,i,{x0:t.x1.baseVal.valueInSpecifiedUnits*i.width/100,y0:t.y1.baseVal.valueInSpecifiedUnits*i.height/100,x1:t.x2.baseVal.valueInSpecifiedUnits*i.width/100,y1:t.y2.baseVal.valueInSpecifiedUnits*i.height/100,colorStops:this.createColorStops(t.children)})}radialGradient(e){const t=this.paintServer,i=this.paintTexture;return t.fx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER),t.fy.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER),t.cx.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER),t.cy.baseVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER),l4.createRadialGradient(e,i,{x0:t.fx.baseVal.valueInSpecifiedUnits*i.width/100,y0:t.fy.baseVal.valueInSpecifiedUnits*i.height/100,r0:t.fr.baseVal.valueInSpecifiedUnits*i.width/100,x1:t.cx.baseVal.valueInSpecifiedUnits*i.height/100,y1:t.cy.baseVal.valueInSpecifiedUnits*i.width/100,r1:t.r.baseVal.valueInSpecifiedUnits*i.width/100,colorStops:this.createColorStops(t.children)})}createColorStops(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e.item(i);t.push({offset:s.offset.baseVal,color:DA.parseColor(s.getAttribute("stop-color"))})}return t}}const CRe=new Dt,ERe=new Pt;class KC extends rn{constructor(t,i,r=!0){super();E(this,"content");E(this,"root");E(this,"renderServers");E(this,"_context");E(this,"_width");E(this,"_height");E(this,"_cull");E(this,"_elementToPaint");E(this,"_elementToMask");E(this,"_transformDirty");E(this,"sortDirty",!1);E(this,"parseColor");E(this,"onNodeTransformDirty",()=>{this._transformDirty=!0,this.emit("transformdirty",this)});this.content=t,this.parseColor=r,this.initContext(i),this._width=t.viewBox.baseVal.width,this._height=t.viewBox.baseVal.height,this._cull=new TMe({recursive:!0,toggle:"renderable"}),this._elementToPaint=new Map,this._elementToMask=new Map,this._transformDirty=!0,this.renderServers=new mn,console.log("[ this.content ] >",this.content.sheet),(!i||!i.disableRootPopulation)&&this.populateScene()}initContext(t){t=t||{},t.atlas=t.atlas||new E9(2048,2048),t.disableHrefSVGLoading=typeof t.disableHrefSVGLoading>"u"?!1:t.disableHrefSVGLoading,this._context=t}calculateBounds(){this._bounds.clear(),this._bounds.addFrameMatrix(this.worldTransform,0,0,this.content.viewBox.baseVal.width,this.content.viewBox.baseVal.height)}removeChild(){}render(t){!this.visible||!this.renderable||(this.renderServers.render(t),this._cull.cull(t.renderTexture.sourceFrame,!0),this.root.render(t),this._cull.uncull())}updateTransform(){super.updateTransform(),this.root.alpha=this.worldAlpha;const t=this.worldTransform,i=this.root.transform.worldTransform;i.a===t.a&&i.b===t.b&&i.c===t.c&&i.d===t.d&&i.tx===t.tx&&i.ty===t.ty&&i._worldID!==0&&!this._transformDirty||(this.root.enableTempParent(),this.root.transform.setFromMatrix(this.worldTransform),this.root.updateTransform(),this.root.disableTempParent(null),this.root.calculateBounds(),this._transformDirty=!1)}createNode(t){if(!t)return null;let i=null;switch(t.nodeName.toLowerCase()){case"circle":i=new y2;break;case"line":i=new $C;break;case"polyline":t.points.length===2?i=new $C:i=new vm;break;case"ellipse":case"g":case"polygon":case"switch":case"rect":i=new vm(this._context);break;case"image":const r=t.getAttribute("href")||t.getAttribute("xlink:href");i=CSe(r)?new Fi(r):null;break;case"mask":case"svg":i=new mn;break;case"path":i=new QC(this._context);break;case"text":i=new mn;break;case"use":i=new XMe;break;default:i=null;break}return i}createPaint(t){return t instanceof SVGElement?new DA(t):null}createPaintServer(t){const i=va.create({width:128,height:128});return new xRe(t,i)}createMask(t){t instanceof SVGElement&&(t=this.populateSceneRecursive(t,{basePaint:this.queryInheritedPaint(t)}));const i=t.getLocalBounds();t.getBounds();const r=va.create({width:i.width,height:i.height}),s=new JMe(r);return s.addChild(t),s}queryMask(t){let i=this._elementToMask.get(t);return i||(i=this.createMask(t),this._elementToMask.set(t,i)),i}queryPaint(t){let i=this._elementToPaint.get(t);return i||(i=this.createPaint(t),this._elementToPaint.set(t,i)),i}queryInheritedPaint(t){const i=this.queryPaint(t),r=t.parentElement&&this.queryPaint(t.parentElement);return r?new JH(r,i):i}parseReference(t){if(t.startsWith("url")){let i=t.slice(4,-1);return i.startsWith("'")&&i.endsWith("'")&&(i=i.slice(1,-1)),i}return t}embedIntoNode(t,i,r={}){const{basePaint:s}=r,o=s?new JH(s,this.queryPaint(i)):this.queryPaint(i),{stroke:a,strokeDashArray:l,strokeDashOffset:c,strokeLineCap:u,strokeLineJoin:h,strokeMiterLimit:d,strokeWidth:f}=o,p=i instanceof SVGGraphicsElement?i.transform.baseVal.consolidate():null,g=CRe.clone().identity();if(p&&p.matrix){const{matrix:{a:v,b:_,c:y,d:A,e:w,f:b}}=p;g.set(v,_,y,A,w,b)}if(t instanceof vm){t.beginFill(0,0);let v;if(typeof a=="string"&&a.startsWith("url")){const y=this.parseReference(a),A=this.content.querySelector(y);if(A&&A instanceof SVGGradientElement){const w=this.createPaintServer(A),b=w.paintTexture;t.paintServers.push(w),v=b}}const _=a===null?0:typeof a=="number"?a:16777215;t.lineTextureStyle({color:_,cap:u===null?_o.SQUARE:u,dashArray:l,dashOffset:c===null?c:0,join:h===null?ma.MITER:h,matrix:new Dt,miterLimit:d===null?150:d,texture:v||Wt.WHITE,width:f===null?typeof a=="number"?1:0:f})}const m=getComputedStyle(i);switch((t instanceof Ud||t instanceof Fi)&&G9(t,m,this.parseColor),i.nodeName.toLowerCase()){case"circle":t.embedCircle(i);break;case"ellipse":t.embedEllipse(i);break;case"image":t.embedImage(i);break;case"line":t.embedLine(i);break;case"path":t.embedPath(i,m["fill-rule"]);break;case"polyline":i.points.length,t.embedPolyline(i);break;case"polygon":t.embedPolygon(i);break;case"rect":t.embedRect(i);break;case"text":{an.parseSVGTextElement(i,t,{withTransform:!1,computedStyle:m,withColor:this.parseColor});break}case"use":{const v=i,_=v.getAttribute("href")||v.getAttribute("xlink:href"),y=this.queryPaint(v);if(t.embedUse(v),_.startsWith("#")){const A=this.content.querySelector(_),w=this.populateSceneRecursive(A,{basePaint:y});w&&(t.ref=w)}else this._context.disableHrefSVGLoading||(t.isRefExternal=!0,KH(_).then(A=>[new KC(A,{...this._context,disableRootPopulation:!0}),A.querySelector("#"+_.split("#")[1])]).then(([A,w])=>{w||console.error(`SVGScene failed to resolve ${_} and SVGUseNode is empty!`);const b=A.populateSceneRecursive(w,{basePaint:y});t.ref=b,this._transformDirty=!0,A.on("transformdirty",()=>{this._transformDirty=!0})}))}}return t.transform.updateLocalTransform(),g.append(t.transform.localTransform),t.transform.setFromMatrix(g),i instanceof SVGMaskElement&&this._elementToMask.set(i,this.createMask(t)),{paint:o}}populateSceneRecursive(t,i){const r=this.createNode(t);if(!r)return null;r.on("nodetransformdirty",this.onNodeTransformDirty);let s;(t instanceof SVGGraphicsElement||t instanceof SVGMaskElement)&&(s=this.embedIntoNode(r,t,i).paint,r instanceof QC&&r.addHitArea());for(let o=0,a=t.children.length;o<a;o++){const l=this.populateSceneRecursive(t.children[o],{basePaint:s});l&&r.addChild(l)}if(r instanceof vm){const o=r.getLocalBounds(ERe),a=r.paintServers,{x:l,y:c,width:u,height:h}=o;r.paintServers.forEach(p=>{p.resolvePaintDimensions(o)});const d=r.geometry,f=d.graphicsData;f&&(f.forEach(p=>{const g=p.fillStyle,m=p.lineStyle;if(g.texture&&a.find(v=>v.paintTexture===g.texture)){const v=g.texture.width,_=g.texture.height;p.fillStyle.matrix.invert().scale(u/v,h/_).invert()}if(g.matrix&&g.matrix.invert().translate(l,c).invert(),m.texture&&a.find(v=>v.paintTexture===m.texture)){const v=m.texture.width,_=m.texture.height;p.lineStyle.matrix.invert().scale(u/v,h/_).invert()}m.matrix&&m.matrix.invert().translate(l,c).invert()}),d.updateBatches())}return t instanceof SVGMaskElement?null:r}populateScene(){this.root&&this._cull.remove(this.root);const t=this.populateSceneRecursive(this.content);this.root=t,this._cull.add(this.root)}get width(){return this._width}set width(t){this._width=t,this.scale.x=this._width/this.content.viewBox.baseVal.width}get height(){return this._height}set height(t){this._height=t,this.scale.y=this._height/this.content.viewBox.baseVal.height}static async from(t,i){return new KC(await KH(t),i)}}class TRe extends KC{constructor(e,t,i){super(e,t,i)}fitToParent(){if(!this.root)return;const{left:e,top:t}=this.root.getLocalBounds();this.root.x=-e,this.root.y=-t}}var y1=function(){function n(I,x){this.x=I,this.y=x}n.prototype.copy=function(){return new n(this.x,this.y)};function e(I,x){this.w=I,this.h=x,this.size=I*x,this.arraybuffer=new ArrayBuffer(this.size),this.data=new Int8Array(this.arraybuffer)}e.prototype.at=function(I,x){return I>=0&&I<this.w&&x>=0&&x<this.h&&this.data[this.w*x+I]===1},e.prototype.index=function(I){var x=new n;return x.y=Math.floor(I/this.w),x.x=I-x.y*this.w,x},e.prototype.flip=function(I,x){this.at(I,x)?this.data[this.w*x+I]=0:this.data[this.w*x+I]=1},e.prototype.copy=function(){var I=new e(this.w,this.h),x;for(x=0;x<this.size;x++)I.data[x]=this.data[x];return I};function t(){this.area=0,this.len=0,this.curve={},this.pt=[],this.minX=1e5,this.minY=1e5,this.maxX=-1,this.maxY=-1}function i(I){this.n=I,this.tag=new Array(I),this.c=new Array(I*3),this.alphaCurve=0,this.vertex=new Array(I),this.alpha=new Array(I),this.alpha0=new Array(I),this.beta=new Array(I)}var r=document.createElement("img"),s=document.createElement("canvas"),o=null,a=[],l,c={isReady:!1,turnpolicy:"minority",turdsize:2,optcurve:!0,alphamax:1,opttolerance:.2,color:"#FD9328"};r.onload=function(){g(),m()};function u(I,x,T){c.isReady&&A(),o=new e(x,T);var O=I.length,F,G;for(F=0,G=0;F<O;F++,G++)o.data[G]=I[F]<128?1:0;c.isReady=!0}function h(I,x,T){c.isReady&&A(),o=new e(x,T);var O=I.length,F,G,B;for(F=0,G=0;F<O;F+=4,G++)B=I[F+3],o.data[G]=B<128?1:0;c.isReady=!0}function d(I){c.isReady&&A(),r.file=I;var x=new FileReader;x.onload=function(T){return function(O){T.src=O.target.result}}(r),x.readAsDataURL(I)}function f(I){c.isReady&&A(),r.src=I}function p(I){var x;for(x in I)I.hasOwnProperty(x)&&(c[x]=I[x])}function g(){s.width=r.width,s.height=r.height;var I=s.getContext("2d");I.drawImage(r,0,0)}function m(){var I=s.getContext("2d");o=new e(s.width,s.height);var x=I.getImageData(0,0,o.w,o.h),T=x.data.length,O,F,G;for(O=0,F=0;O<T;O+=4,F++)G=.2126*x.data[O]+.7153*x.data[O+1]+.0721*x.data[O+2],o.data[F]=G<128?1:0;c.isReady=!0}function v(){var I=o.copy(),x=new n(0,0),T;function O(R){for(var P=I.w*R.y+R.x;P<I.size&&I.data[P]!==1;)P++;return P<I.size&&I.index(P)}function F(R,P){var k,L,H;for(k=2;k<5;k++){for(H=0,L=-k+1;L<=k-1;L++)H+=I.at(R+L,P+k-1)?1:-1,H+=I.at(R+k-1,P+L-1)?1:-1,H+=I.at(R+L-1,P-k)?1:-1,H+=I.at(R-k,P+L)?1:-1;if(H>0)return 1;if(H<0)return 0}return 0}function G(R){var P=new t,k=R.x,L=R.y,H=0,U=1,$;for(P.sign=o.at(R.x,R.y)?"+":"-";P.pt.push(new n(k,L)),k>P.maxX&&(P.maxX=k),k<P.minX&&(P.minX=k),L>P.maxY&&(P.maxY=L),L<P.minY&&(P.minY=L),P.len++,k+=H,L+=U,P.area-=k*U,!(k===R.x&&L===R.y);){var j=I.at(k+(H+U-1)/2,L+(U-H-1)/2),Q=I.at(k+(H-U-1)/2,L+(U+H-1)/2);Q&&!j?c.turnpolicy==="right"||c.turnpolicy==="black"&&P.sign==="+"||c.turnpolicy==="white"&&P.sign==="-"||c.turnpolicy==="majority"&&F(k,L)||c.turnpolicy==="minority"&&!F(k,L)?($=H,H=-U,U=$):($=H,H=U,U=-$):Q?($=H,H=-U,U=$):j||($=H,H=U,U=-$)}return P}function B(R){var P=R.pt[0].y,k=R.len,L,H,U,$,j,Q;for(j=1;j<k;j++)if(L=R.pt[j].x,H=R.pt[j].y,H!==P){for($=P<H?P:H,U=R.maxX,Q=L;Q<U;Q++)I.flip(Q,$);P=H}}for(;x=O(x);)T=G(x),B(T),(x.x!==0||x.y!==0)&&T.area>c.turdsize&&a.push(T)}function _(){function I(){this.data=[0,0,0,0,0,0,0,0,0]}I.prototype.at=function(he,Ce){return this.data[he*3+Ce]};function x(he,Ce,se,Re,He){this.x=he,this.y=Ce,this.xy=se,this.x2=Re,this.y2=He}function T(he,Ce){return he>=Ce?he%Ce:he>=0?he:Ce-1-(-1-he)%Ce}function O(he,Ce){return he.x*Ce.y-he.y*Ce.x}function F(he,Ce,se){return he<=se?he<=Ce&&Ce<se:he<=Ce||Ce<se}function G(he){return he>0?1:he<0?-1:0}function B(he,Ce){var se=new Array(3),Re,He,Y;for(se[0]=Ce.x,se[1]=Ce.y,se[2]=1,Y=0,Re=0;Re<3;Re++)for(He=0;He<3;He++)Y+=se[Re]*he.at(Re,He)*se[He];return Y}function R(he,Ce,se){var Re=new n;return Re.x=Ce.x+he*(se.x-Ce.x),Re.y=Ce.y+he*(se.y-Ce.y),Re}function P(he,Ce){var se=new n;return se.y=G(Ce.x-he.x),se.x=-G(Ce.y-he.y),se}function k(he,Ce){var se=P(he,Ce);return se.y*(Ce.x-he.x)-se.x*(Ce.y-he.y)}function L(he,Ce,se){var Re,He,Y,W;return Re=Ce.x-he.x,He=Ce.y-he.y,Y=se.x-he.x,W=se.y-he.y,Re*W-Y*He}function H(he,Ce,se,Re){var He,Y,W,ge;return He=Ce.x-he.x,Y=Ce.y-he.y,W=Re.x-se.x,ge=Re.y-se.y,He*ge-W*Y}function U(he,Ce,se){var Re,He,Y,W;return Re=Ce.x-he.x,He=Ce.y-he.y,Y=se.x-he.x,W=se.y-he.y,Re*Y+He*W}function $(he,Ce,se,Re){var He,Y,W,ge;return He=Ce.x-he.x,Y=Ce.y-he.y,W=Re.x-se.x,ge=Re.y-se.y,He*W+Y*ge}function j(he,Ce){return Math.sqrt((he.x-Ce.x)*(he.x-Ce.x)+(he.y-Ce.y)*(he.y-Ce.y))}function Q(he,Ce,se,Re,He){var Y=1-he,W=new n;return W.x=Y*Y*Y*Ce.x+3*(Y*Y*he)*se.x+3*(he*he*Y)*Re.x+he*he*he*He.x,W.y=Y*Y*Y*Ce.y+3*(Y*Y*he)*se.y+3*(he*he*Y)*Re.y+he*he*he*He.y,W}function ne(he,Ce,se,Re,He,Y){var W,ge,Le,Ve,pe,fe,Ee,oe,Me,je;return W=H(he,Ce,He,Y),ge=H(Ce,se,He,Y),Le=H(se,Re,He,Y),Ve=W-2*ge+Le,pe=-2*W+2*ge,fe=W,Ee=pe*pe-4*Ve*fe,Ve===0||Ee<0?-1:(oe=Math.sqrt(Ee),Me=(-pe+oe)/(2*Ve),je=(-pe-oe)/(2*Ve),Me>=0&&Me<=1?Me:je>=0&&je<=1?je:-1)}function ve(he){var Ce,se,Re;he.x0=he.pt[0].x,he.y0=he.pt[0].y,he.sums=[];var He=he.sums;for(He.push(new x(0,0,0,0,0)),Ce=0;Ce<he.len;Ce++)se=he.pt[Ce].x-he.x0,Re=he.pt[Ce].y-he.y0,He.push(new x(He[Ce].x+se,He[Ce].y+Re,He[Ce].xy+se*Re,He[Ce].x2+se*se,He[Ce].y2+Re*Re))}function Pe(he){var Ce=he.len,se=he.pt,Re,He=new Array(Ce),Y=new Array(Ce),W=new Array(4);he.lon=new Array(Ce);var ge=[new n,new n],Le=new n,Ve=new n,pe=new n,fe,Ee,oe,Me,je,_e,Ye,q,we=0;for(Ee=Ce-1;Ee>=0;Ee--)se[Ee].x!==se[we].x&&se[Ee].y!==se[we].y&&(we=Ee+1),Y[Ee]=we;for(Ee=Ce-1;Ee>=0;Ee--){for(W[0]=W[1]=W[2]=W[3]=0,Re=(3+3*(se[T(Ee+1,Ce)].x-se[Ee].x)+(se[T(Ee+1,Ce)].y-se[Ee].y))/2,W[Re]++,ge[0].x=0,ge[0].y=0,ge[1].x=0,ge[1].y=0,we=Y[Ee],Me=Ee;;){if(fe=0,Re=(3+3*G(se[we].x-se[Me].x)+G(se[we].y-se[Me].y))/2,W[Re]++,W[0]&&W[1]&&W[2]&&W[3]){He[Ee]=Me,fe=1;break}if(Le.x=se[we].x-se[Ee].x,Le.y=se[we].y-se[Ee].y,O(ge[0],Le)<0||O(ge[1],Le)>0||(Math.abs(Le.x)<=1&&Math.abs(Le.y)<=1||(Ve.x=Le.x+(Le.y>=0&&(Le.y>0||Le.x<0)?1:-1),Ve.y=Le.y+(Le.x<=0&&(Le.x<0||Le.y<0)?1:-1),O(ge[0],Ve)>=0&&(ge[0].x=Ve.x,ge[0].y=Ve.y),Ve.x=Le.x+(Le.y<=0&&(Le.y<0||Le.x<0)?1:-1),Ve.y=Le.y+(Le.x>=0&&(Le.x>0||Le.y<0)?1:-1),O(ge[1],Ve)<=0&&(ge[1].x=Ve.x,ge[1].y=Ve.y)),Me=we,we=Y[Me],!F(we,Ee,Me)))break}fe===0&&(pe.x=G(se[we].x-se[Me].x),pe.y=G(se[we].y-se[Me].y),Le.x=se[Me].x-se[Ee].x,Le.y=se[Me].y-se[Ee].y,je=O(ge[0],Le),_e=O(ge[0],pe),Ye=O(ge[1],Le),q=O(ge[1],pe),oe=1e7,_e<0&&(oe=Math.floor(je/-_e)),q>0&&(oe=Math.min(oe,Math.floor(-Ye/q))),He[Ee]=T(Me+oe,Ce))}for(oe=He[Ce-1],he.lon[Ce-1]=oe,Ee=Ce-2;Ee>=0;Ee--)F(Ee+1,He[Ee],oe)&&(oe=He[Ee]),he.lon[Ee]=oe;for(Ee=Ce-1;F(T(Ee+1,Ce),oe,he.lon[Ee]);Ee--)he.lon[Ee]=oe}function De(he){function Ce(_e,Ye,q){var we=_e.len,M=_e.pt,N=_e.sums,D,z,K,ce,ae,J,xe,Se,rt,ot,gt,ut,ct,Ct,vn=0;return q>=we&&(q-=we,vn=1),vn===0?(D=N[q+1].x-N[Ye].x,z=N[q+1].y-N[Ye].y,ce=N[q+1].x2-N[Ye].x2,K=N[q+1].xy-N[Ye].xy,ae=N[q+1].y2-N[Ye].y2,J=q+1-Ye):(D=N[q+1].x-N[Ye].x+N[we].x,z=N[q+1].y-N[Ye].y+N[we].y,ce=N[q+1].x2-N[Ye].x2+N[we].x2,K=N[q+1].xy-N[Ye].xy+N[we].xy,ae=N[q+1].y2-N[Ye].y2+N[we].y2,J=q+1-Ye+we),gt=(M[Ye].x+M[q].x)/2-M[0].x,ut=(M[Ye].y+M[q].y)/2-M[0].y,Ct=M[q].x-M[Ye].x,ct=-(M[q].y-M[Ye].y),xe=(ce-2*D*gt)/J+gt*gt,Se=(K-D*ut-z*gt)/J+gt*ut,rt=(ae-2*z*ut)/J+ut*ut,ot=ct*ct*xe+2*ct*Ct*Se+Ct*Ct*rt,Math.sqrt(ot)}var se,Re,He,Y,W=he.len,ge=new Array(W+1),Le=new Array(W+1),Ve=new Array(W),pe=new Array(W+1),fe=new Array(W+1),Ee=new Array(W+1),oe,Me,je;for(se=0;se<W;se++)je=T(he.lon[T(se-1,W)]-1,W),je===se&&(je=T(se+1,W)),je<se?Ve[se]=W:Ve[se]=je;for(Re=1,se=0;se<W;se++)for(;Re<=Ve[se];)pe[Re]=se,Re++;for(se=0,Re=0;se<W;Re++)fe[Re]=se,se=Ve[se];for(fe[Re]=W,He=Re,se=W,Re=He;Re>0;Re--)Ee[Re]=se,se=pe[se];for(Ee[0]=0,ge[0]=0,Re=1;Re<=He;Re++)for(se=Ee[Re];se<=fe[Re];se++){for(Me=-1,Y=fe[Re-1];Y>=pe[se];Y--)oe=Ce(he,Y,se)+ge[Y],(Me<0||oe<Me)&&(Le[se]=Y,Me=oe);ge[se]=Me}for(he.m=He,he.po=new Array(He),se=W,Re=He-1;se>0;Re--)se=Le[se],he.po[Re]=se}function Xe(he){function Ce(xe,Se,rt,ot,gt){for(var ut=xe.len,ct=xe.sums,Ct,vn,ti,fr,Ao,_r,ni,mi,li,Mr,Ei,Ti=0;rt>=ut;)rt-=ut,Ti+=1;for(;Se>=ut;)Se-=ut,Ti-=1;for(;rt<0;)rt+=ut,Ti-=1;for(;Se<0;)Se+=ut,Ti+=1;Ct=ct[rt+1].x-ct[Se].x+Ti*ct[ut].x,vn=ct[rt+1].y-ct[Se].y+Ti*ct[ut].y,ti=ct[rt+1].x2-ct[Se].x2+Ti*ct[ut].x2,fr=ct[rt+1].xy-ct[Se].xy+Ti*ct[ut].xy,Ao=ct[rt+1].y2-ct[Se].y2+Ti*ct[ut].y2,_r=rt+1-Se+Ti*ut,ot.x=Ct/_r,ot.y=vn/_r,ni=(ti-Ct*Ct/_r)/_r,mi=(fr-Ct*vn/_r)/_r,li=(Ao-vn*vn/_r)/_r,Mr=(ni+li+Math.sqrt((ni-li)*(ni-li)+4*mi*mi))/2,ni-=Mr,li-=Mr,Math.abs(ni)>=Math.abs(li)?(Ei=Math.sqrt(ni*ni+mi*mi),Ei!==0&&(gt.x=-mi/Ei,gt.y=ni/Ei)):(Ei=Math.sqrt(li*li+mi*mi),Ei!==0&&(gt.x=-li/Ei,gt.y=mi/Ei)),Ei===0&&(gt.x=gt.y=0)}var se=he.m,Re=he.po,He=he.len,Y=he.pt,W=he.x0,ge=he.y0,Le=new Array(se),Ve=new Array(se),pe=new Array(se),fe=new Array(3),Ee,oe,Me,je,_e,Ye=new n;for(he.curve=new i(se),oe=0;oe<se;oe++)Me=Re[T(oe+1,se)],Me=T(Me-Re[oe],He)+Re[oe],Le[oe]=new n,Ve[oe]=new n,Ce(he,Re[oe],Me,Le[oe],Ve[oe]);for(oe=0;oe<se;oe++)if(pe[oe]=new I,Ee=Ve[oe].x*Ve[oe].x+Ve[oe].y*Ve[oe].y,Ee===0)for(Me=0;Me<3;Me++)for(je=0;je<3;je++)pe[oe].data[Me*3+je]=0;else for(fe[0]=Ve[oe].y,fe[1]=-Ve[oe].x,fe[2]=-fe[1]*Le[oe].y-fe[0]*Le[oe].x,_e=0;_e<3;_e++)for(je=0;je<3;je++)pe[oe].data[_e*3+je]=fe[_e]*fe[je]/Ee;var q,we,M,N,D,z,K,ce,ae,J;for(oe=0;oe<se;oe++){for(q=new I,we=new n,Ye.x=Y[Re[oe]].x-W,Ye.y=Y[Re[oe]].y-ge,Me=T(oe-1,se),_e=0;_e<3;_e++)for(je=0;je<3;je++)q.data[_e*3+je]=pe[Me].at(_e,je)+pe[oe].at(_e,je);for(;;){if(D=q.at(0,0)*q.at(1,1)-q.at(0,1)*q.at(1,0),D!==0){we.x=(-q.at(0,2)*q.at(1,1)+q.at(1,2)*q.at(0,1))/D,we.y=(q.at(0,2)*q.at(1,0)-q.at(1,2)*q.at(0,0))/D;break}for(q.at(0,0)>q.at(1,1)?(fe[0]=-q.at(0,1),fe[1]=q.at(0,0)):q.at(1,1)?(fe[0]=-q.at(1,1),fe[1]=q.at(1,0)):(fe[0]=1,fe[1]=0),Ee=fe[0]*fe[0]+fe[1]*fe[1],fe[2]=-fe[1]*Ye.y-fe[0]*Ye.x,_e=0;_e<3;_e++)for(je=0;je<3;je++)q.data[_e*3+je]+=fe[_e]*fe[je]/Ee}if(M=Math.abs(we.x-Ye.x),N=Math.abs(we.y-Ye.y),M<=.5&&N<=.5){he.curve.vertex[oe]=new n(we.x+W,we.y+ge);continue}if(z=B(q,Ye),ce=Ye.x,ae=Ye.y,q.at(0,0)!==0)for(J=0;J<2;J++)we.y=Ye.y-.5+J,we.x=-(q.at(0,1)*we.y+q.at(0,2))/q.at(0,0),M=Math.abs(we.x-Ye.x),K=B(q,we),M<=.5&&K<z&&(z=K,ce=we.x,ae=we.y);if(q.at(1,1)!==0)for(J=0;J<2;J++)we.x=Ye.x-.5+J,we.y=-(q.at(1,0)*we.x+q.at(1,2))/q.at(1,1),N=Math.abs(we.y-Ye.y),K=B(q,we),N<=.5&&K<z&&(z=K,ce=we.x,ae=we.y);for(_e=0;_e<2;_e++)for(je=0;je<2;je++)we.x=Ye.x-.5+_e,we.y=Ye.y-.5+je,K=B(q,we),K<z&&(z=K,ce=we.x,ae=we.y);he.curve.vertex[oe]=new n(ce+W,ae+ge)}}function Ne(he){var Ce=he.curve,se=Ce.n,Re=Ce.vertex,He,Y,W;for(He=0,Y=se-1;He<Y;He++,Y--)W=Re[He],Re[He]=Re[Y],Re[Y]=W}function et(he){var Ce=he.curve.n,se=he.curve,Re,He,Y,W,ge,Le,Ve,pe,fe;for(Re=0;Re<Ce;Re++)He=T(Re+1,Ce),Y=T(Re+2,Ce),fe=R(1/2,se.vertex[Y],se.vertex[He]),ge=k(se.vertex[Re],se.vertex[Y]),ge!==0?(W=L(se.vertex[Re],se.vertex[He],se.vertex[Y])/ge,W=Math.abs(W),Le=W>1?1-1/W:0,Le=Le/.75):Le=4/3,se.alpha0[He]=Le,Le>=c.alphamax?(se.tag[He]="CORNER",se.c[3*He+1]=se.vertex[He],se.c[3*He+2]=fe):(Le<.55?Le=.55:Le>1&&(Le=1),Ve=R(.5+.5*Le,se.vertex[Re],se.vertex[He]),pe=R(.5+.5*Le,se.vertex[Y],se.vertex[He]),se.tag[He]="CURVE",se.c[3*He+0]=Ve,se.c[3*He+1]=pe,se.c[3*He+2]=fe),se.alpha[He]=Le,se.beta[He]=.5;se.alphacurve=1}function ze(he){function Ce(){this.pen=0,this.c=[new n,new n],this.t=0,this.s=0,this.alpha=0}function se(K,ce,ae,J,xe,Se,rt){var ot=K.curve.n,gt=K.curve,ut=gt.vertex,ct,Ct,vn,ti,fr,Ao,_r,ni,mi,li,Mr,Ei,Ti,so,Zo,re,Ge,Ke,Je,qe,Et,Bt,Nt;if(ce===ae||(ct=ce,fr=T(ce+1,ot),Ct=T(ct+1,ot),ti=Se[Ct],ti===0))return 1;for(ni=j(ut[ce],ut[fr]),ct=Ct;ct!==ae;ct=Ct)if(Ct=T(ct+1,ot),vn=T(ct+2,ot),Se[Ct]!==ti||G(H(ut[ce],ut[fr],ut[Ct],ut[vn]))!==ti||$(ut[ce],ut[fr],ut[Ct],ut[vn])<ni*j(ut[Ct],ut[vn])*-.999847695156)return 1;if(Mr=gt.c[T(ce,ot)*3+2].copy(),Ei=ut[T(ce+1,ot)].copy(),Ti=ut[T(ae,ot)].copy(),so=gt.c[T(ae,ot)*3+2].copy(),Ao=rt[ae]-rt[ce],Ao-=L(ut[0],gt.c[ce*3+2],gt.c[ae*3+2])/2,ce>=ae&&(Ao+=rt[ot]),Ke=L(Mr,Ei,Ti),Je=L(Mr,Ei,so),qe=L(Mr,Ti,so),Et=Ke+qe-Je,Je===Ke||(Nt=qe/(qe-Et),Bt=Je/(Je-Ke),re=Je*Nt/2,re===0))return 1;for(Ge=Ao/re,_r=2-Math.sqrt(4-Ge/.3),J.c[0]=R(Nt*_r,Mr,Ei),J.c[1]=R(Bt*_r,so,Ti),J.alpha=_r,J.t=Nt,J.s=Bt,Ei=J.c[0].copy(),Ti=J.c[1].copy(),J.pen=0,ct=T(ce+1,ot);ct!==ae;ct=Ct){if(Ct=T(ct+1,ot),Nt=ne(Mr,Ei,Ti,so,ut[ct],ut[Ct]),Nt<-.5||(Zo=Q(Nt,Mr,Ei,Ti,so),ni=j(ut[ct],ut[Ct]),ni===0)||(mi=L(ut[ct],ut[Ct],Zo)/ni,Math.abs(mi)>xe)||U(ut[ct],ut[Ct],Zo)<0||U(ut[Ct],ut[ct],Zo)<0)return 1;J.pen+=mi*mi}for(ct=ce;ct!==ae;ct=Ct){if(Ct=T(ct+1,ot),Nt=ne(Mr,Ei,Ti,so,gt.c[ct*3+2],gt.c[Ct*3+2]),Nt<-.5||(Zo=Q(Nt,Mr,Ei,Ti,so),ni=j(gt.c[ct*3+2],gt.c[Ct*3+2]),ni===0)||(mi=L(gt.c[ct*3+2],gt.c[Ct*3+2],Zo)/ni,li=L(gt.c[ct*3+2],gt.c[Ct*3+2],ut[Ct])/ni,li*=.75*gt.alpha[Ct],li<0&&(mi=-mi,li=-li),mi<li-xe))return 1;mi<li&&(J.pen+=(mi-li)*(mi-li))}return 0}var Re=he.curve,He=Re.n,Y=Re.vertex,W=new Array(He+1),ge=new Array(He+1),Le=new Array(He+1),Ve=new Array(He+1),pe,fe,Ee,oe,Me=new Ce,je,_e,Ye,q,we,M,N,D=new Array(He),z=new Array(He+1);for(fe=0;fe<He;fe++)Re.tag[fe]==="CURVE"?D[fe]=G(L(Y[T(fe-1,He)],Y[fe],Y[T(fe+1,He)])):D[fe]=0;for(Ye=0,z[0]=0,je=Re.vertex[0],fe=0;fe<He;fe++)_e=T(fe+1,He),Re.tag[_e]==="CURVE"&&(q=Re.alpha[_e],Ye+=.3*q*(4-q)*L(Re.c[fe*3+2],Y[_e],Re.c[_e*3+2])/2,Ye+=L(je,Re.c[fe*3+2],Re.c[_e*3+2])/2),z[fe+1]=Ye;for(W[0]=-1,ge[0]=0,Le[0]=0,Ee=1;Ee<=He;Ee++)for(W[Ee]=Ee-1,ge[Ee]=ge[Ee-1],Le[Ee]=Le[Ee-1]+1,fe=Ee-2;fe>=0&&(oe=se(he,fe,T(Ee,He),Me,c.opttolerance,D,z),!oe);fe--)(Le[Ee]>Le[fe]+1||Le[Ee]===Le[fe]+1&&ge[Ee]>ge[fe]+Me.pen)&&(W[Ee]=fe,ge[Ee]=ge[fe]+Me.pen,Le[Ee]=Le[fe]+1,Ve[Ee]=Me,Me=new Ce);for(pe=Le[He],we=new i(pe),M=new Array(pe),N=new Array(pe),Ee=He,fe=pe-1;fe>=0;fe--)W[Ee]===Ee-1?(we.tag[fe]=Re.tag[T(Ee,He)],we.c[fe*3+0]=Re.c[T(Ee,He)*3+0],we.c[fe*3+1]=Re.c[T(Ee,He)*3+1],we.c[fe*3+2]=Re.c[T(Ee,He)*3+2],we.vertex[fe]=Re.vertex[T(Ee,He)],we.alpha[fe]=Re.alpha[T(Ee,He)],we.alpha0[fe]=Re.alpha0[T(Ee,He)],we.beta[fe]=Re.beta[T(Ee,He)],M[fe]=N[fe]=1):(we.tag[fe]="CURVE",we.c[fe*3+0]=Ve[Ee].c[0],we.c[fe*3+1]=Ve[Ee].c[1],we.c[fe*3+2]=Re.c[T(Ee,He)*3+2],we.vertex[fe]=R(Ve[Ee].s,Re.c[T(Ee,He)*3+2],Y[T(Ee,He)]),we.alpha[fe]=Ve[Ee].alpha,we.alpha0[fe]=Ve[Ee].alpha,M[fe]=Ve[Ee].s,N[fe]=Ve[Ee].t),Ee=W[Ee];for(fe=0;fe<pe;fe++)_e=T(fe+1,pe),we.beta[fe]=M[fe]/(M[fe]+N[_e]);we.alphacurve=1,he.curve=we}for(var de=0;de<a.length;de++){var lt=a[de];ve(lt),Pe(lt),De(lt),Xe(lt),lt.sign==="-"&&Ne(lt),et(lt),c.optcurve&&ze(lt)}}function y(I){if(I&&(l=I),!c.isReady){setTimeout(y,100);return}return v(),_(),typeof l=="function"&&l(),l=null,a}function A(){o=null,a=[],l=null,c.isReady=!1}function w(I,x=0,T=0,O=1,F=1,G){G&&(a=G);function B(H){function U(ve){var Pe="C "+(H.c[ve*3+0].x*I*O+x).toFixed(3)+" "+(H.c[ve*3+0].y*I*F+T).toFixed(3)+",";return Pe+=(H.c[ve*3+1].x*I*O+x).toFixed(3)+" "+(H.c[ve*3+1].y*I*F+T).toFixed(3)+",",Pe+=(H.c[ve*3+2].x*I*O+x).toFixed(3)+" "+(H.c[ve*3+2].y*I*F+T).toFixed(3)+" ",Pe}function $(ve){var Pe="L "+(H.c[ve*3+1].x*I*O+x).toFixed(3)+" "+(H.c[ve*3+1].y*I*F+T).toFixed(3)+" ";return Pe+=(H.c[ve*3+2].x*I*O+x).toFixed(3)+" "+(H.c[ve*3+2].y*I*F+T).toFixed(3)+" ",Pe}var j=H.n,Q,ne="M"+(H.c[(j-1)*3+2].x*I*O+x).toFixed(3)+" "+(H.c[(j-1)*3+2].y*I*F+T).toFixed(3)+" ";for(Q=0;Q<j;Q++)H.tag[Q]==="CURVE"?ne+=U(Q):H.tag[Q]==="CORNER"&&(ne+=$(Q));return ne}var R=a.length,P,k;let L="";for(k=0;k<R;k++)P=a[k].curve,L+=B(P);return L}function b(I){c.isReady&&A(),s=I,m()}function C(I,x){function T(U){function $(Pe){var De="C "+(U.c[Pe*3+0].x*I).toFixed(3)+" "+(U.c[Pe*3+0].y*I).toFixed(3)+",";return De+=(U.c[Pe*3+1].x*I).toFixed(3)+" "+(U.c[Pe*3+1].y*I).toFixed(3)+",",De+=(U.c[Pe*3+2].x*I).toFixed(3)+" "+(U.c[Pe*3+2].y*I).toFixed(3)+" ",De}function j(Pe){var De="L "+(U.c[Pe*3+1].x*I).toFixed(3)+" "+(U.c[Pe*3+1].y*I).toFixed(3)+" ";return De+=(U.c[Pe*3+2].x*I).toFixed(3)+" "+(U.c[Pe*3+2].y*I).toFixed(3)+" ",De}var Q=U.n,ne,ve="M"+(U.c[(Q-1)*3+2].x*I).toFixed(3)+" "+(U.c[(Q-1)*3+2].y*I).toFixed(3)+" ";for(ne=0;ne<Q;ne++)U.tag[ne]==="CURVE"?ve+=$(ne):U.tag[ne]==="CORNER"&&(ve+=j(ne));return ve}var O=o.w*I,F=o.h*I,G=a.length,B,R,P,k,L,H='<svg id="svg" version="1.1" width="'+O+'" height="'+F+'" xmlns="http://www.w3.org/2000/svg">';for(H+='<path d="',R=0;R<G;R++)B=a[R].curve,H+=T(B);return x==="curve"?(P="black",k="none",L=""):(P="none",k="black",L=' fill-rule="evenodd"'),H+='" stroke="'+P+'" fill="'+k+'"'+L+"/></svg>",H}return{loadImageFromFile:d,loadImageFromUrl:f,loadImageFromGray:u,setParameter:p,process:y,getTransformPath:w,loadImageFromCanvas:b,loadImageFromGrayAlpha:h,getSVG:C,img:r,pathlist:a}}();const IRe=async n=>{const{source:e,parseColor:t}=n,i=MRe(e);document.body.appendChild(i);try{console.time("parse and preload fonts for <svg>");const{lossFonts:r}=await QMe(e);console.timeEnd("parse and preload fonts for <svg>"),console.time("parse svg");const s=new TRe(e,null,t);return console.timeEnd("parse svg"),s.fitToParent(),{result:s.root,lossFonts:r}}catch(r){console.log(r)}finally{document.body.removeChild(i)}return{result:null}},SRe=n=>{const{source:e,width:t,height:i}=n,r=new Fi(e);return t&&(r.width=t),i&&(r.height=i),{result:r}},u4={svg:IRe,bitmap:SRe},PRe=async(n,e)=>{if(n in u4)return u4[n](e)};function MRe(n){const e=`load-svg-container-${String(Date.now())}`,t=document.createElement("div");t.id=e;const i=document.createElement("style");i.innerText=`#${e} { all: unset; visibility: hidden;    font-family: ${Ya.fontFamily}; font-size: 16px; }`,t.appendChild(i),t.appendChild(n);const r=document.createElement("div");return r.id="load-svg-host",r.attachShadow({mode:"open"}).appendChild(t),r}const W9=(n,e,t=[])=>{const i=Object.getOwnPropertyDescriptors(e);for(let r of t)delete i[r];Object.defineProperties(n,i)},kA=(n,e=[n])=>{const t=Object.getPrototypeOf(n);return t===null?e:kA(t,[...e,t])},RRe=(...n)=>{if(n.length===0)return;let e;const t=n.map(i=>kA(i));for(;t.every(i=>i.length>0);){const i=t.map(s=>s.pop()),r=i[0];if(i.every(s=>s===r))e=r;else break}return e},h4=(n,e,t=[])=>{var i;const r=(i=RRe(...n))!==null&&i!==void 0?i:Object.prototype,s=Object.create(r),o=kA(r);for(let a of n){let l=kA(a);for(let c=l.length-1;c>=0;c--){let u=l[c];o.indexOf(u)===-1&&(W9(s,u,["constructor",...t]),o.push(u))}}return s.constructor=e,s},VD=n=>n.filter((e,t)=>n.indexOf(e)==t),j9=new Map,DRe=n=>j9.get(n),kRe=(n,e)=>j9.set(n,e),d4=(n,e)=>{var t,i;const r=VD([...Object.getOwnPropertyNames(n),...Object.getOwnPropertyNames(e)]),s={};for(let o of r)s[o]=VD([...(t=n==null?void 0:n[o])!==null&&t!==void 0?t:[],...(i=e==null?void 0:e[o])!==null&&i!==void 0?i:[]]);return s},f4=(n,e)=>{var t,i,r,s;return{property:d4((t=n==null?void 0:n.property)!==null&&t!==void 0?t:{},(i=e==null?void 0:e.property)!==null&&i!==void 0?i:{}),method:d4((r=n==null?void 0:n.method)!==null&&r!==void 0?r:{},(s=e==null?void 0:e.method)!==null&&s!==void 0?s:{})}},ORe=(n,e)=>{var t,i,r,s,o,a;return{class:VD([...(t=n==null?void 0:n.class)!==null&&t!==void 0?t:[],...(i=e==null?void 0:e.class)!==null&&i!==void 0?i:[]]),static:f4((r=n==null?void 0:n.static)!==null&&r!==void 0?r:{},(s=e==null?void 0:e.static)!==null&&s!==void 0?s:{}),instance:f4((o=n==null?void 0:n.instance)!==null&&o!==void 0?o:{},(a=e==null?void 0:e.instance)!==null&&a!==void 0?a:{})}},LRe=new Map,NRe=(...n)=>{var e;const t=new Set,i=new Set([...n]);for(;i.size>0;)for(let r of i){const s=kA(r.prototype).map(c=>c.constructor),o=(e=DRe(r))!==null&&e!==void 0?e:[],l=[...s,...o].filter(c=>!t.has(c));for(let c of l)i.add(c);t.add(r),i.delete(r)}return[...t]},BRe=(...n)=>{const e=NRe(...n).map(t=>LRe.get(t)).filter(t=>!!t);return e.length==0?{}:e.length==1?e[0]:e.reduce((t,i)=>ORe(t,i))};function zD(...n){var e,t,i;const r=n.map(a=>a.prototype);function s(...a){for(const l of n)W9(this,new l(...a))}s.prototype=h4(r,s),Object.setPrototypeOf(s,h4(n,null,["prototype"]));let o=s;{const a=BRe(...n);for(let l of(e=a==null?void 0:a.class)!==null&&e!==void 0?e:[]){const c=l(o);c&&(o=c)}p4((t=a==null?void 0:a.static)!==null&&t!==void 0?t:{},o),p4((i=a==null?void 0:a.instance)!==null&&i!==void 0?i:{},o.prototype)}return kRe(o,n),o}const p4=(n,e)=>{const t=n.property,i=n.method;if(t)for(let r in t)for(let s of t[r])s(e,r);if(i)for(let r in i)for(let s of i[r])s(e,r,Object.getOwnPropertyDescriptor(e,r))};let Q9=class{constructor(){}execute(e,t,i,r,s){const o=c=>Array.isArray(c)?c[0].groupTag:c.id;t.length===1&&(i={x:r.x,y:r.y,width:r.worldWidth*r.scale.x,height:r.worldHeight*r.scale.y});const a=MSe(t,{alignType:e,cusCalcGroupBounds:s,targetBounds:i});let l=!1;return t=Array.isArray(t)?t:[t],t.forEach(c=>{const{worldTargetX:u,worldTargetY:h}=a.get(o(c))||{},d=(s==null?void 0:s(c))||Pl(c),f=isNaN(u)?0:(d.x-u)/r.scale.x,p=isNaN(h)?0:(d.y-h)/r.scale.y;(Array.isArray(c)?c:[c]).forEach(m=>{const v=m.getPointToRelativeElement(r),_=new Ae(v.x-f,v.y-p);_d(m,_,r)}),(f||p)&&(l=!0)}),l}};var Su;class FRe{constructor(){E(this,"matrixResult");E(this,"descriptionResult");ke(this,Su,void 0);Qe(this,Su,[]),this.matrixResult=[],this.descriptionResult=[]}create(e,t,i,r){let s=new Array;switch(e){case RC.LINER:s=this.createLinerArrays(t,i,r);break;case RC.RADIAL:s=this.createRadialArrays(t,i,r);break;default:s=[];break}return s}createLinerArrays(e,t,i){this.clearTemp(!0);const{colNum:r,colSpace:s,rowNum:o,rowSpace:a}=i,l=[],c=r*o;for(let g=0;g<c;g++){const m=g%r,v=Math.floor(g/r),_=[];e.forEach(y=>{const A={...y};A.x+=m*(t.width+s),A.y+=v*(t.height+a),A.sourceId=y.id,A.id=Ui(),_.push(A)}),l.push(_)}this.matrixResult=yae([...l.map(g=>g[0])].map(g=>g==null?void 0:g.id),r);let u=[];const{title:h,xCoordinate:d,yCoordinate:f,label:p}=i;return h&&d&&f&&p&&e.length===1&&(u=this.createDescriptionArrays(e,t,i)),[...l,...u]}createDescriptionArrays(e,t,i){const r=[],{colNum:s,colSpace:o,rowNum:a,rowSpace:l,title:c,xCoordinate:u,yCoordinate:h,label:d}=i,f=gr(e[0],["layerColor","layerTag","lineColor","fillColor","originColor","visible"]),{fontSizeScale:p,subTitleScale:g,coordinateSpace:m,coordinateLabelSpace:v,minFontSize:_,minSubTitleSize:y}=d,A=Math.max(Math.min(t.width,t.height)*p,_),w=Math.max(Math.min(t.width,t.height)*g,y),b=($,j)=>{const{width:Q,fontScale:ne}=an.measureTextJSON($,{fontSize:an.mmToPT(j),fontFamily:"Lato"});return Q*ne},C=t.width*s+o*(s-1),I=t.height*a+l*(a-1),{direction:x,title:T,label:O}=u,F=($,j)=>t.x+1/2*t.width-1/2*b($,j),G=x===0?t.y-A-m:t.y+I+m,B=($,j,Q,ne,ve)=>{r.push([{...f,id:Ui(),text:$,type:it.TEXT,style:{fontSize:an.mmToPT(j)},angle:ve||0,x:Q,y:ne}])};O.forEach(($,j)=>{B(`${$}`,A,F(`${$}`,A)+j*(t.width+o),G)}),B(`${T}`,w,t.x+1/2*C-1/2*b(`${T}`,w),x===0?G-m-w:G+A+m);const{direction:R,title:P,label:k}=h;let L=0;const H=($,j)=>(b($,j)>L&&(L=b($,j)),R===0?t.x-b($,j)-m:t.x+C+m),U=t.y+1/2*t.height-1/2*A;return k.forEach(($,j)=>{B(`${$}`,A,H(`${$}`,A),U+j*(t.height+l))}),B(`${P}`,w,R===0?t.x-m-w-L-v:t.x+C+m+L+v,t.y+1/2*I+1/2*b(`${P}`,w),270),B(`${c}`,w,t.x+1/2*C-1/2*b(`${c}`,w),x===0?G-w-m:t.y-m-w),[...r.map($=>$[0])].map(({id:$})=>this.descriptionResult.push($)),r}createRadialArrays(e,t,i){this.clearTemp(!0);const{x:r,y:s,copies:o,start:a,step:l,rotateSelf:c}=i,u=new Array;for(let h=0;h<o;h++){const d=a+l*h,f=d*Math.PI/180,p=[];if(c)e.forEach(g=>{const m={...g},v=new Pt(m.x,m.y,m.width,m.height),_=uSe(v,f,{x:r,y:s});m.x=_.x,m.y=_.y,m.angle+=d,m.sourceId=g.id,m.id=Ui(),p.push(m)});else{const g={x:t.x+t.width/2,y:t.y+t.height/2},m=ZR(g,f,{x:r,y:s}),v={x:m.x-g.x,y:m.y-g.y};e.forEach(_=>{const y={..._};y.x+=v.x,y.y+=v.y,y.sourceId=_.id,y.id=Ui(),p.push(y)})}u.push(p)}return u}appendToTemp(e){return e.forEach(t=>{S(this,Su).push(t)}),e}clearTemp(e){if(e){let t=S(this,Su).pop();for(;t;)t.destroy(!0),t=S(this,Su).pop()}else Qe(this,Su,[])}get temp(){return S(this,Su)}}Su=new WeakMap;let URe=class{constructor(e){E(this,"prev");E(this,"next");E(this,"value");this.prev=null,this.next=null,this.value=e}},Ba=class Wx{constructor(){E(this,"head");E(this,"end");E(this,"length",0);this.head=null,this.end=null}get isClosed(){var e,t;return((e=this.end)==null?void 0:e.prev)===this.head&&((t=this.head)==null?void 0:t.next)===this.end}static createNode(e){return new URe(e)}static create(e,t){const i=new Wx;if(e)for(let r=0;r<=e.length-1;r++){if(r!==0&&r===e.length-1){const s=e[0],o=e[r];if(t&&t(s,o))return i.end.prev=i.head,i.head.next=i.end,i}i.insert(Wx.createNode(e[r]))}return i}insert(e){return e.next=null,e.prev=this.head,this.head&&(this.head.next=e),this.end||(this.end=e),this.head=e,this.length+=1,e}insertPrev(e,t){const i=this.isClosed,r=e.prev;return t.prev=r,t.next=e,e.prev=t,r!=null&&r.next&&(r.next=t),this.length+=1,this.length===1?(this.end=t,this.head=t,i&&(this.head.next=this.end,this.end.prev=this.head)):i?(r.next=t,this.end=this.head.next):r?r.next=t:this.end=t,t}moveToNext(e,t){t===this.head||e===t||(this.delete(t),this.insertNext(e,t))}moveToPrev(e,t){t===this.end||e===t||(this.delete(t),this.insertPrev(e,t))}insertNext(e,t){const i=this.isClosed,r=e.next;return e.next=t,t.next=r,t.prev=e,r!=null&&r.prev&&(r.prev=t),this.length+=1,this.length===1?(this.head=t,this.end=t,this.end.prev&&(this.end.prev=this.head,this.head.next=this.end)):i?(r.prev=t,this.head=this.end.prev):r?r.prev=t:this.head=t,t}search(e){let t=this.head;for(;t!==null&&!e(t.value);)t=t.prev;return t}delete(e,t=!0){const{prev:i,next:r}=e;delete e.prev,delete e.next,e===this.head&&(this.head=i),e===this.end&&(this.end=r),i&&(t?i.next=r:i.next=null),r&&(t?r.prev=i:r.prev=null),(this.head===e||this.end===e)&&this.length===1&&(this.head=null,this.end=null),this.length-=1}forEach(e){let t=this.end,i=0;for(e(t,i);t!=null&&t.next&&(t=t.next,i++,e(t,i),t!==this.end););}toJSON(){const e=[];return this.forEach(t=>{t&&e.push(t.value)}),e}close(){this.end.prev=this.head,this.head.next=this.end}disconnect(){this.isClosed&&(this.end.prev=null,this.head.next=null)}clone(e){const t=this.toJSON();return Wx.create(t,e)}},pr=class{constructor(e=0,t=0){E(this,"x");E(this,"y");this.x=e||0,this.y=t||0}plus(e){return X9(this,e)}minus(e){return OA(this,e)}_minus(e){return this.x-=e.x,this.y-=e.y,this}multiply(e){return Y9(this,e)}divide(e){return GRe(this,e)}dot(e){return q9(this,e)}length(){return mI(this)}angle(){return K9(this)}normalize(){return J9(this)}};function X9(n,e){return{x:n.x+e.x,y:n.y+e.y}}function OA(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Y9(n,e){return{x:n.x*e,y:n.y*e}}function GRe(n,e){return{x:n.x/e,y:n.y/e}}function q9(n,e){return n.x*e.x+n.y*e.y}function mI(n){return Math.sqrt(n.x*n.x+n.y*n.y)}function K9(n){return Math.atan2(n.y,n.x)}function J9(n){const e=mI(n);return e===0?{x:0,y:0}:{x:n.x/e,y:n.y/e}}function HRe(n,e,t,i=!0){let r=i?e:t,s=i?t:e;return!(Math.abs(r-s)<Number.EPSILON||(s<r&&(r>n&&(n+=2*Math.PI),s+=2*Math.PI),n>s+Number.EPSILON||n<r-Number.EPSILON))}function Z9(n){return n/180*Math.PI}function g4(n){return n*n}function vp(n,e,t){const i=OA(e,n);if(t){const{scale:r}=t;i.x*=r.x,i.y*=r.y}return mI(i)}function m4(n,e,t,i){var r=n*t+e*i,s=Math.sqrt((n*n+e*e)*(t*t+i*i)),o=Math.acos(r/s);return n*i-e*t<0&&(o=-o),o}function v4(n){return(n<0||n>Math.PI*2)&&(n=(Math.PI*2+n)%(Math.PI*2)),n/Math.PI*180}function VRe(n,e,t,i,r,s,o,a,l){var c,u,h,d,f,p=Math.PI*2;if(t<0&&(t=-t),i<0&&(i=-i),t===0||i===0)throw Error("rx and ry can not be 0");var g=Math.sin(r),m=Math.cos(r),v=(n-a)/2,_=(e-l)/2,y=(n+a)/2,A=(e+l)/2,w=m*v+g*_,b=m*_-g*v,C=w*w/(t*t)+b*b/(i*i);C>1&&(t=t*Math.sqrt(C),i=i*Math.sqrt(C));var I=t*i,x=t*b,T=i*w,O=x*x+T*T;if(!O)throw Error("start point can not be same as end point");var F=Math.sqrt(Math.abs((I*I-O)/O));!!s==!!o&&(F=-F);var G=F*x/i,B=-F*T/t;c=m*G-g*B+y,u=g*G+m*B+A;var R=(w-G)/t,P=(w+G)/t,k=(b-B)/i,L=(b+B)/i;for(h=m4(1,0,R,k)+r,d=m4(R,k,-P,-L);d>p;)d-=p;for(;d<0;)d+=p;for((o===!1||o===0)&&(d-=p),f=h+d;f>p;)f-=p;for(;f<0;)f+=p;const H=Math.atan2(e-u,n-c),U=Math.atan2(l-u,a-c);var $={cx:c,cy:u,startAngle:h,deltaAngle:d,endAngle:f,startDeg:v4(h),endDeg:v4(f),radiusX:t,radiusY:i,clockwise:o===!0||o===1,sAng:H,eAng:U};return $}class vI{constructor(){E(this,"type","Curve")}}class $D extends vI{constructor(t=new pr,i=new pr){super();E(this,"type","LineCurve");E(this,"isLineCurve",!0);E(this,"a");E(this,"b");this.a=t,this.b=i}distanceTo(t,i){var r;return((r=WD(this,t,i))==null?void 0:r.distance)??1/0}nearestTo(t,i){return WD(this,t,i)}}function WD(n,e,t){const i=OA(n.b,n.a),r=J9(i),s=OA(e,n.a),o=q9(r,s);if(o<0)return{distance:vp(n.a,e,t),point:n.a};if(o>mI(i))return{distance:vp(n.b,e,t),point:n.b};const a=Y9(r,o),l=X9(n.a,a);return{distance:vp(l,e,t),point:l}}function zRe(n,e,t,i,r){const s=1-n,o=e,a=i,l=r,c=t;if(!r||Fl(i,r)){const u=s**2,h=2*s*n,d=n**2;return new pr(u*o.x+h*a.x+d*c.x,u*o.y+h*a.y+d*c.y)}else{const u=s**3,h=3*s**2*n,d=3*s*n**2,f=n**3;return new pr(u*o.x+h*a.x+d*l.x+f*c.x,u*o.y+h*a.y+d*l.y+f*c.y)}}function $Re(n,e,t,i,r=1){r=1/r;const s=[];for(let o=0;o<1;o+=.1*r){const a=zRe(o,n,e,t,i);s.push(a)}return s[0]=n,s[s.length-1]=e,s}function WRe(n,e,t){let i=1/0,r;for(let s=0,o=1;o<e.length;s=o++){const a=WD(new $D(e[s],e[o]),n,t),l=a.distance;l>=0&&l<i&&(i=l,r=a)}return r}function JC(n,e,t){const i=$Re(n.a,n.b,n.cp1,n.cp2,t.scale?Math.max(t.scale.x,t.scale.y):1);return WRe(e,i,t)}function e7(n,e=.001){return _4(n.a,n.cp1,n.b,e)&&_4(n.a,n.cp2,n.b,e)}function _4(n,e,t,i=.001){const r=VC(n,e),s=VC(n,t);return Math.abs(r-s)%(Math.PI*2)<i}class jRe extends vI{constructor(t=new pr,i=new pr,r=new pr,s=new pr){super();E(this,"type","CubicBezierCurve");E(this,"isCubicBezierCurve",!0);E(this,"a");E(this,"b");E(this,"cp1");E(this,"cp2");this.a=t,this.b=i,this.cp1=r,this.cp2=s}isLineCurve(t=Z9(.001)){return e7(this,t)}distanceTo(t,i){var r;return((r=JC(this,t,i))==null?void 0:r.distance)??1/0}nearestTo(t,i){return JC(this,t,i)}}class QRe extends vI{constructor(t,i,r,s=0,o=0,a=0,l=0,c=0,u=!0){super();E(this,"type","EllipseCurve");E(this,"isEllipseCurve",!0);E(this,"s");E(this,"e");E(this,"c");E(this,"radiusX");E(this,"radiusY");E(this,"startAngle");E(this,"endAngle");E(this,"rotation");E(this,"clockwise");this.s=t,this.e=i,this.c=r,this.radiusX=s,this.radiusY=o,this.startAngle=a,this.endAngle=l,this.rotation=c,this.clockwise=u}distanceTo(t,i){return this.radiusX===this.radiusY?YRe(this,t):qRe(this,t)}nearestTo(t,i){console.warn("not implement")}}function XRe(n,e){const t=OA(e,n.c),i=K9(t);return HRe(i,n.startAngle,n.endAngle,n.clockwise)}function YRe(n,e){let t;return XRe(n,e)?t=Math.abs(vp(n.c,e)-n.radiusX):t=Math.max(vp(n.s,e),vp(n.e,e)),t}function qRe(n,e){const t=KRe(n,e),i=JRe(n,t.angle);return Math.abs(t.radius-i)}function KRe(n,e){let t=e.x-n.c.x,i=e.y-n.c.y;const r=Math.atan2(i,t)-n.rotation,s=vp(new pr(0,0),new pr(t,i));return t=s*Math.cos(r),i=s*Math.sin(r),{x:t,y:i,angle:r,radius:s}}function JRe(n,e){return Math.sqrt(1/(g4(Math.cos(e)/n.radiusX)+g4(Math.sin(e)/n.radiusY)))}class ZRe extends vI{constructor(t=new pr,i=new pr,r=new pr){super();E(this,"type","QuadraticBezierCurve");E(this,"isQuadraticBezierCurve",!0);E(this,"a");E(this,"b");E(this,"cp");this.a=t,this.b=i,this.cp=r}get cp1(){return this.cp}get cp2(){return this.cp}isLineCurve(t=.001){return e7(this,t)}distanceTo(t,i){var r;return((r=JC(this,t,i))==null?void 0:r.distance)??1/0}nearestTo(t,i){return JC(this,t,i)}}function eDe(n){const e=[],t=n instanceof Hs?n:typeof n=="string"?hI(n):void 0;if(!t)return e;let i,r;for(const s of t.iterateCommands()){const o=s.type,a=s.values;if(o==="M")i=r=new pr(a[0],a[1]);else if(o==="L"){const l=new pr(a[0],a[1]),c=new $D(i,l);e.push(c),i=l}else if(o==="A"){const{x:l,y:c}=i,[u,h,d,f,p,g,m]=a,v=Z9(d),{cx:_,cy:y,radiusX:A,radiusY:w,sAng:b,eAng:C,clockwise:I}=VRe(l,c,u,h,v,f,p,g,m),x=new pr(g,m),T=new QRe(i,x,new pr(_,y),A,w,b,C,v,I);e.push(T),i=x}else if(o==="C"){const l=new pr(a[0],a[1]),c=new pr(a[2],a[3]),u=new pr(a[4],a[5]),h=new jRe(i,u,l,c);e.push(h),i=u}else if(o==="Q"){const l=new pr(a[0],a[1]),c=new pr(a[2],a[3]),u=new ZRe(i,c,l);e.push(u),i=c}else if(o==="Z"){const l=new $D(i,r);e.push(l),i=r}}return e}function tDe(n){return n.isLineCurve}function nDe(n){return n.isQuadraticBezierCurve}function iDe(n){return n.isCubicBezierCurve}const{BezierUtils:rDe,QuadraticUtils:sDe}=oI;var jD;(function(n){n[n.Line=1]="Line"})(jD||(jD={}));const QD={color:16777215,lineColor:2653430,hoverColor:327677};class ky extends Ud{constructor(t){t=Object.assign({},Za,QD,t);super(t);E(this,"options");E(this,"effectData",{});E(this,"pointData");E(this,"curves",[]);const{name:i="",position:r}=t;this.name=i,this.zIndex=jD.Line,this.options=t,r&&this.drawBezierLine(r)}drawBezierLine(t){this.pointData=t;const{position:i,controlPoints:r}=t.start,{position:s,controlPoints:o}=t.end,a=r&&r[1];this.clear().lineStyle(this.options),this.moveTo(i.x,i.y),o&&o[0]?a?this.bezierCurveTo(r[1].x,r[1].y,o[0].x,o[0].y,s.x,s.y):this.quadraticCurveTo(o[0].x,o[0].y,s.x,s.y):a?this.quadraticCurveTo(r[1].x,r[1].y,s.x,s.y):this.lineTo(s.x,s.y),this.addHitArea(null,6),this.updateHitArea(),this.toggleFill(this.isFill,!1)}update(t){}toPathData(){const t=new Hs;return this.setPath(t,this.pointData),t}toPathString(){return this.toPathData().toString()}updateHitArea(){if(MA(this.hitArea))this.emit(DC.GRAPHICS_CHANDED);else{const t=this.toPathData();this.curves=eDe(t)}}setPath(t,i){if(!i)return;const{position:r,controlPoints:s}=i.start,{position:o,controlPoints:a}=i.end,l=s&&s[1];t.moveTo(r.x,r.y),a&&a[0]?l?t.bezierCurveTo(s[1].x,s[1].y,a[0].x,a[0].y,o.x,o.y):t.quadraticCurveTo(a[0].x,a[0].y,o.x,o.y):l?t.quadraticCurveTo(s[1].x,s[1].y,o.x,o.y):t.lineTo(o.x,o.y)}hitTest(t,i){if(MA(this.hitArea))return this.hitArea.contains(t.x,t.y);const{touchTor:r=4,scale:s}=i,o=this.curves,a={scale:{x:this.transform.localTransform.a*((s==null?void 0:s.x)??1),y:this.transform.localTransform.d*((s==null?void 0:s.y)??1)}};let l=!1;for(const c of o)if(c.distanceTo(t,a)<=r){l=!0;break}return l}updateSkPath(t){this.setPath(t,this.pointData)}getPoints(t=1){const i=[];for(const r of this.curves)i.length||i.push(r.a.x,r.a.y),iDe(r)?r.isLineCurve()?i.push(r.b.x,r.b.y):aDe(r.cp1.x,r.cp1.y,r.cp2.x,r.cp2.y,r.b.x,r.b.y,t,i):nDe(r)?r.isLineCurve()?i.push(r.b.x,r.b.y):oDe(r.cp.x,r.cp.y,r.b.x,r.b.y,t,i):tDe(r)&&i.push(r.b.x,r.b.y);return i}}const t7=20,n7={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(n,e=20,t){if(!this.adaptive||!n||isNaN(n))return e;let i=Math.ceil(n/(this.maxLength/t));return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}};function oDe(n,e,t,i,r,s){s=s??[];const o=s[s.length-2],a=s[s.length-1],l=n7._segmentsCount(sDe.curveLength(o,a,n,e,t,i),t7,r);let c=0,u=0;for(let h=1;h<=l;++h){const d=h/l;c=o+(n-o)*d,u=a+(e-a)*d,s.push(c+(n+(t-n)*d-c)*d,u+(e+(i-e)*d-u)*d)}return s}function aDe(n,e,t,i,r,s,o,a){a=a??[];const l=a[a.length-2],c=a[a.length-1];a.length-=2;const u=n7._segmentsCount(rDe.curveLength(l,c,n,e,t,i,r,s),t7,o);let h=0,d=0,f=0,p=0,g=0;a.push(l,c);for(let m=1,v=0;m<=u;++m)v=m/u,h=1-v,d=h*h,f=d*h,p=v*v,g=p*v,a.push(f*l+3*d*v*n+3*h*p*t+g*r,f*c+3*d*v*e+3*h*p*i+g*s);return a}var ZC;(function(n){n[n.Point=3]="Point",n[n.ControlPoint=2]="ControlPoint",n[n.ControlPointLine=1]="ControlPointLine",n[n.Line=0]="Line"})(ZC||(ZC={}));const ym={Point:37768,Hollow:16777215,ControlPoint:37768},lDe={color:ym.Point,radius:5,hollow:!0,hollowColor:ym.Hollow};class _p extends Ud{constructor(t){super();E(this,"options",{});E(this,"graphics",new hn);E(this,"effectData",{node:null});this.options=Object.assign({},lDe,t||{});const{type:i,name:r="",position:s}=t;this.type=i||it.ANCHOR_POINT,this.name=r,this.zIndex=this.type===it.ANCHOR_POINT?ZC.Point:ZC.ControlPoint,s&&this.update(s)}update(t){this.clear(),this.type===it.ANCHOR_POINT?this.drawAnchor(t):this.drawControlPoint(t)}drawAnchor(t){const i=We(this.options,"circleAnchorConf.radius",this.options.radius??5),{hollow:r,hollowColor:s}=this.options,o=this.type===it.ANCHOR_POINT?ym.Point:ym.ControlPoint;this.beginFill(o,1),this.drawCircle(0,0,i),r&&(this.beginFill(s,1),this.drawCircle(0,0,i-2)),this.updatePosition(t),this.endFill(),this.addHitArea()}drawControlPoint(t){const i=We(this.options,"rectAnchorConf.w",8),r=We(this.options,"rectAnchorConf.h",8),{hollow:s,hollowColor:o}=this.options,a=this.type===it.ANCHOR_POINT?ym.Point:ym.ControlPoint;this.beginFill(a),this.drawRect(-(i/2),-(r/2),i,r),s&&(this.beginFill(o),this.drawRect(-((i-2)/2),-((r-2)/2),i-2,r-2)),this.updatePosition(t),this.endFill(),this.addHitArea()}updatePosition(t){t&&this.position.set(t.x,t.y)}refresh(t=!1){this.options.hollow=!t,this.update(this.position)}toJSON(t){const i=super.toJSON(t),r=We(this,"effectData.node.value.cpType")??di.STRAIGHT;return{...i,cpType:r,x:this.x,y:this.y}}addHitArea(){this.type===it.ANCHOR_POINT?this.addCircleHitArea():this.addRectHitArea()}addCircleHitArea(){let t=We(this.options,"circleAnchorConf.hitArea",{});if(t.hasOwnProperty("contains")&&!tn(t))this.hitArea=t;else{const{x:i,y:r,width:s,height:o}=this.getLocalBounds();t=tn(t)?t:this.options.radius??5,this.hitArea=new YT(i+s/2,r+o/2,t)}}addRectHitArea(){const{rectAnchorConf:{hitAreaW:t,hitAreaH:i}}=this.options,{x:r,y:s,width:o,height:a}=this.getLocalBounds(),l=t??o,c=i??a;this.hitArea=new Pt(r-(l-o)/2,s-(c-a)/2,l,c)}highlightBound(){}reset(){}}const cDe={startDelay:1,stepInterval:16,stepDuration:16,timerMode:"timeout"};var To,Dl,Pu,BE,i7,c0,XD,u0,YD,FE,r7;class uDe{constructor(e){ke(this,BE);ke(this,c0);ke(this,u0);ke(this,FE);ke(this,To,new Map);ke(this,Dl,null);ke(this,Pu,"idle");E(this,"options");this.options=Object.assign(cDe,e)}has(e){return S(this,To).has(e)}add(e,t){if(typeof t!="function"){console.warn("action is not a function, will be ignored");return}S(this,To).has(e)&&S(this,To).delete(e),S(this,To).set(e,t),Ht(this,BE,i7).call(this)}delete(e){S(this,To).delete(e),S(this,Dl)&&!S(this,To).size&&(Ht(this,u0,YD).call(this),Qe(this,Pu,"idle"))}clear(){return S(this,To).clear()}size(){return S(this,To).size}}To=new WeakMap,Dl=new WeakMap,Pu=new WeakMap,BE=new WeakSet,i7=function(){if(S(this,Pu)==="pending")return;S(this,Pu)==="running"&&Ht(this,u0,YD).call(this),Qe(this,Pu,"pending");const e=()=>{Qe(this,Dl,null),Ht(this,FE,r7).call(this,this.options.stepDuration),S(this,To).size?Ht(this,c0,XD).call(this,e,this.options.stepInterval):Qe(this,Pu,"idle")};Ht(this,c0,XD).call(this,()=>{Qe(this,Pu,"running"),e()},Math.max(this.options.startDelay,1))},c0=new WeakSet,XD=function(e,t){this.options.timerMode==="idle-callback"?Qe(this,Dl,requestIdleCallback(e,{timeout:t})):Qe(this,Dl,setTimeout(e,t))},u0=new WeakSet,YD=function(){S(this,Dl)&&(this.options.timerMode==="idle-callback"?cancelIdleCallback(S(this,Dl)):clearTimeout(S(this,Dl)),Qe(this,Dl,null))},FE=new WeakSet,r7=function(e=16){const t=Date.now();let i;for(const[r,s]of S(this,To).entries())if(i=Date.now(),i-t<=e)S(this,To).delete(r),s(r);else break};hDe();function hDe(){globalThis.requestIdleCallback||(globalThis.requestIdleCallback=function(n,e){e=e||{};const t=1,i=e.timeout||t,r=performance.now();return setTimeout(function(){n({get didTimeout(){return e.timeout?!1:performance.now()-r-t>i},timeRemaining:function(){return Math.max(0,t+(performance.now()-r))}})},t)}),globalThis.cancelIdleCallback||(globalThis.cancelIdleCallback=function(n){clearTimeout(n)})}new Dt;function s7(n,e,t){if(typeof n.updateSkPath=="function"){n.updateSkPath(e,t);return}switch(n.constructor){case $C:fDe(n,e,t);break;case A2:pDe(n,e);break;case y2:gDe(n,e);break;case dI:mDe(n,e);break;case x9:vDe(n,e);break;case QC:_De(n,e);break;case vm:yDe(n,e);break;default:dDe(n,e);break}}function dDe(n,e){var i;const t=(i=n.getBounds)==null?void 0:i.call(n);t&&T2(e,t)}function fDe(n,e,t){e.moveTo(0,0).lineTo(n.endPoint.x,n.endPoint.y),t.fill=!1}function pDe(n,e){e.addRect([0,0,n.originWidth,n.originHeight])}function gDe(n,e){e.addOval([0,0,n.originWidth,n.originHeight])}function mDe(n,e){n.geometry.graphicsData.forEach(t=>{T2(e,t.shape)})}function vDe(n,e){return s7(n.lineGraphics,e)}function _De(n,e){e.addFromSVGPathD(n.dPath)}function yDe(n,e){n.geometry.graphicsData.forEach(t=>{T2(e,t.shape)})}function T2(n,e){switch(e.type){case Yn.POLY:return ADe(n,e);case Yn.RECT:return bDe(n,e);case Yn.RREC:return wDe(n,e);case Yn.CIRC:return xDe(n,e);case Yn.ELIP:return CDe(n,e);default:return}}function ADe(n,e){const t=e.points;for(let i=0;i<t.length;i+=2){const r={x:t[i],y:t[i+1]};i===0?n.moveTo(r.x,r.y):n.lineTo(r.x,r.y)}e.closeStroke&&n.close()}function bDe(n,e){n.addRect([e.x,e.y,e.x+e.width,e.y+e.height])}function wDe(n,e){n.addRRect([e.x,e.y,e.x+e.width,e.y+e.height,e.radius,e.radius,e.radius,e.radius,e.radius,e.radius,e.radius,e.radius])}function xDe(n,e){n.addOval([e.x,e.y,e.radius,e.radius])}function CDe(n,e){n.addOval([e.x,e.x,e.x+e.width,e.x+e.height])}var Af;(function(n){n.ADD_HIT_AREA="addHitArea",n.REMOVE_HIT_AREA="removeHitArea",n.UPDATE_HIT_AREA="updateHitArea"})(Af||(Af={}));const EDe={enabled:!1,expansion:{mode:"stroke",padding:6,fillPadding:0,defaultFill:!1},zoomDebounceDelay:500,painter:{enabled:!1,mode:"listener"},excludeFn:n=>n.type===it.TEXT||n.type===it.BITMAP||n instanceof _p||n instanceof ky};var Qf;class o7 extends Zr{constructor(t){super();E(this,"options");E(this,"viewport");E(this,"transformer");E(this,"painter");ke(this,Qf,new WeakMap);E(this,"updateHitAreaTasks");E(this,"debouncedHandle");this.options=Ln(EDe,t),this.updateHitAreaTasks=new uDe(this.options.updateTask)}get events(){return Af}get hitAreaManager(){return this}init(t,i){console.log("[ HitAreaManager ] enabled:",this.options.enabled),this.options.enabled!==!1&&(this.viewport=t,this.transformer=i,this.debouncedHandle=Fc((r,s)=>{s.call(r)},this.options.zoomDebounceDelay,{trailing:!0}),qSe().then(()=>{this.initEvents(),this.viewport.getInteractiveElements().forEach(s=>{this.addHitAreaFor(s)}),this.hitAreaManager.initPainter()}))}initEvents(){this.viewport.displayLayer.on("childAdded",t=>{t.updateTransform(),this.addHitAreaFor(t)}),this.viewport.tempLayer.on("childAdded",t=>{t.updateTransform(),this.addHitAreaFor(t)}),this.viewport.on("zoomed",Fc(()=>{this.viewport.localTransform.a!==this.viewport.scale.x&&this.viewport.updateTransform(),this.viewport.displayLayer.children.forEach(t=>{this.hitAreaManager.updateHitAreaFor(t)})},this.options.zoomDebounceDelay)),this.transformer.on(sr.TRANSFORM_COMMIT,({type:t=""}={})=>{(!t||t==="scale")&&this.requestUpdateHitAreaForDisplays(this.transformer.selected)}),this.transformer.on(sr.TRANSFORM_CHANGE,t=>{this.handleDisplaysAttrsChanged(this.transformer.selected,t)})}handleDisplaysAttrsChanged(t,i){Hu(i,["width","height","isFill"])&&this.requestUpdateHitAreaForDisplays(t)}async initPainter(){try{if(this.options.painter.enabled||TDe()){const{HitAreaDebugPainter:t}=await Pi(()=>import("./hitareadebugpainter-bRWMRks3.js"),__vite__mapDeps([3,1,4,5,6,7]),import.meta.url);console.log("%c[ DebugPainter ] init success","font-weight: bold"),this.painter=new t(this,this.options.painter),this.viewport.addChild(this.painter.container)}}catch{console.warn("[ DebugPainter ] init failed")}}updateConfig(t){this.options=Ln(this.options,t)}_addHitArea(t){let i;S(this,Qf).has(t)?i=S(this,Qf).get(t):(i=QSe(),i.update=()=>{this.requestUpdateHitAreaForDisplays([t])},S(this,Qf).set(t,i),t.on(DC.ATTRS_CHANGED,s=>{this.handleDisplaysAttrsChanged([t],s)}),t.on(DC.GRAPHICS_CHANDED,()=>{this.requestUpdateHitAreaForDisplays([t])}),t.on("destroyed",()=>{this.updateHitAreaTasks.delete(t),XSe(i),S(this,Qf).delete(t),t.hitArea=null}),t.on("removed",()=>{this.updateHitAreaTasks.delete(t),this.emit(Af.REMOVE_HIT_AREA,t)}));let r=i;Object.defineProperty(t,"hitArea",{get(){return r},set(s){const{override:o,value:a}=s??{};o&&(r=a)}}),this._updateHitArea(t),this.emit(Af.ADD_HIT_AREA,t)}_updateHitArea(t){if(MA(t.hitArea)){const{a:i,b:r,c:s,d:o}=t.worldTransform,a=Math.sqrt(i*i+r*r),l=Math.sqrt(s*s+o*o),c=this.options.expansion,u=t.isFill&&!Fp(c.fillPadding)?c.fillPadding:c.padding,h={mode:c.mode,width:1+u*2,fill:t.isFill??c.defaultFill,sx:a,sy:l,viewportScale:this.viewport.scale.x},d=t.hitArea;d.rewind(),s7(t,d,h),d.style(h)}}_addUpdateHitAreaTask(t){this.updateHitAreaTasks.add(t,i=>{i.destroyed||(this._updateHitArea(i),i.hitArea&&this.emit(Af.UPDATE_HIT_AREA,i))})}traverseDisplay(t,i){const r=new Set,s=o=>{if(!o||r.has(o))return;r.add(o),i(o)!==!1&&Array.isArray(o.children)&&o.children.forEach(s)};s(t)}addHitAreaFor(t){this.traverseDisplay(t,i=>{var r,s;return(s=(r=this.options).excludeFn)!=null&&s.call(r,i)?!1:(i.interactive&&(MA(i.hitArea)?this._addUpdateHitAreaTask(i):this._addHitArea(i)),!0)})}updateHitAreaFor(t){this.traverseDisplay(t,i=>{var r,s;return(s=(r=this.options).excludeFn)!=null&&s.call(r,i)?!1:(this._addUpdateHitAreaTask(i),!0)})}requestUpdateHitAreaForDisplays(t){t.forEach(i=>{this.updateHitAreaFor(i)})}}Qf=new WeakMap,E(o7,"events",Af);function TDe(){try{return globalThis.sessionStorage.getItem("HIT_AREA_DEBUG_PAINT")==="true"||new URLSearchParams(window.location.hash.split("?").slice(-1)[0]).get("HIT_AREA_DEBUG_PAINT")==="true"}catch{}return!1}var Xf,JW;let a7=(JW=class{constructor(){ke(this,Xf,void 0)}setOptions(e){Qe(this,Xf,e)}clip(e){const{canvas:t,ctx:i}=S(this,Xf),{minLocalPoint:r,rtLocalPoint:s,maxLocalPoint:o,lbLocalPoint:a}=e,l=document.createElement("canvas");l.width=t.width,l.height=t.height;const c=l.getContext("2d");c.beginPath(),c.moveTo(r.x,r.y),c.lineTo(a.x,a.y),c.lineTo(o.x,o.y),c.lineTo(s.x,s.y),c.clip(),c.drawImage(t,0,0),i.clearRect(0,0,t.width,t.height),t.width=o.x-r.x,t.height=o.y-r.y,i.drawImage(l,Math.round(r.x),Math.round(r.y),Math.floor(o.x-r.x),Math.floor(o.y-r.y),0,0,t.width,t.height)}erasing(e){const{ctx:t}=S(this,Xf),{radius:i,isCurveTo:r,beginPoint:s,controlPoint:o,endPoint:a}=e;t.globalCompositeOperation="destination-out",t.lineJoin=t.lineCap="round",t.lineWidth=i,t.beginPath(),t.moveTo(s.x,s.y),r?t.quadraticCurveTo(o.x,o.y,a.x,a.y):t.lineTo(s.x+.01,s.y+.01),t.closePath(),t.stroke(),t.globalCompositeOperation="source-over"}magicSelect(e,t){const{canvas:i,ctx:r}=S(this,Xf),s=r.getImageData(0,0,i.width,i.height);uMe(s.data,s.width,s.height,Number(e.x.toFixed(0)),Number(e.y.toFixed(0)),t),r.putImageData(s,0,0)}},Xf=new WeakMap,JW);class IDe{constructor(e){E(this,"prev");E(this,"next");E(this,"value");this.prev=null,this.next=null,this.value=e}}class eE{constructor(){E(this,"head");E(this,"end");E(this,"length",0);this.head=null,this.end=null}static createNode(e){return new IDe(e)}static create(e){const t=new eE;if(e)for(let i=0;i<=e.length-1;i++)t.insert(eE.createNode(e[i]));return t}insert(e){e.next=null,e.prev=this.head,this.head&&(this.head.next=e),this.end||(this.end=e),this.head=e,this.length+=1}insertPrev(e,t){const i=e.prev;t.prev=i,t.next=e,e.prev=t,i?i.next=t:this.end=t,this.length+=1}moveToNext(e,t){t===this.head||e===t||(this.delete(t),this.insertNext(e,t))}moveToPrev(e,t){t===this.end||e===t||(this.delete(t),this.insertPrev(e,t))}insertNext(e,t){const i=e.next;e.next=t,t.next=i,t.prev=e,i?i.prev=t:this.head=t,this.length+=1}search(e){let t=this.head;for(;t!==null&&t.value!==e;)t=t.prev;return t}delete(e){const{prev:t,next:i}=e;delete e.prev,delete e.next,e===this.head&&(this.head=t),e===this.end&&(this.end=i),t&&(t.next=i),i&&(i.prev=t),this.length-=1}forEach(e){let t=this.end,i=0;for(e(t,i);t.next;)t=t.next,i++,e(t,i)}}var bf;(function(n){n[n.DESC=0]="DESC",n[n.ESC=1]="ESC"})(bf||(bf={}));let SDe=class{changeLayer(e,t,i){const r=eE.create(e),s=[...t];return s.sort((a,l)=>l.displayOrder-a.displayOrder),{[kc.UP]:this.moveUp,[kc.DOWN]:this.moveDown,[kc.TOP]:this.moveToTop,[kc.END]:this.moveToEnd}[i].bind(this)(r,s),r}moveDown(e,t){const i=t[t.length-1],r=e.search(i.id);let s=r.prev||r;s=this.findFirstDiffEleInListByOrderedArr(e,t,s,bf.ESC),s&&this.moveToPrev(e,t,s)}moveToTop(e,t){const i=this.findFirstDiffEleInListByOrderedArr(e,t,e.head);i&&this.moveToNext(e,t,i)}moveUp(e,t){const i=t[0],r=e.search(i.id);let s=r.next||r;s=this.findFirstDiffEleInListByOrderedArr(e,t,s),s&&this.moveToNext(e,t,s)}moveToEnd(e,t){const i=this.findFirstDiffEleInListByOrderedArr(e,t,e.end,bf.ESC);i&&this.moveToPrev(e,t,i)}moveToPrev(e,t,i){if(i){const r=[...t];r.sort((s,o)=>s.displayOrder-o.displayOrder),r.forEach(s=>{const o=e.search(s.id);o&&e.moveToPrev(i,o)})}}moveToNext(e,t,i){i&&t.forEach(r=>{const s=e.search(r.id);s&&e.moveToNext(i,s)})}updateOrder(e,t){e.forEach((i,r)=>{const s=t.find(o=>i.value===o.id);s&&(s.zOrder=r+1)})}findFirstDiffEleInListByOrderedArr(e,t,i,r=bf.DESC){let s=i;t=r===bf.DESC?t:t.reverse();for(const o in t){const a=e.search(t[o].id);if(s=s||e.head,a!==s)break;if(Number(o)===t.length-1){s=null;break}s=s[r===bf.DESC?"prev":"next"]}return s}};const l7=()=>({enableAlign:!0,enableBool:!0,enableSelect:!0,enableDisplayLayerInteractive:!0});class c7 extends Zr{constructor(t){super();E(this,"modeConfig");E(this,"selectScope",ll.DISPLAY_LAYER);E(this,"curPlugin");E(this,"name");E(this,"selected",[]);this.name=t.name,this.curPlugin=t.plugin,this.modeConfig=Ln(l7(),t.modeConfig)}setSelected(t){this.selected=t}getSelected(){return this.selected||[]}removeSelected(){this.selected=[]}enter(){this.selectScope=ll.TEMP_LAYER,this.setupPluginToManagerEvents()}finishCurMode(){}setupPluginToManagerEvents(){var t,i;(i=(t=this.curPlugin)==null?void 0:t.on)==null||i.call(t,at.MESSAGE_TO_MANAGER,r=>{this.emit(at.MESSAGE_TO_MANAGER,r)})}onUpdateNormalMode(t){this.emit(at.MESSAGE_TO_MANAGER,{eventName:Xa.UPDATE_EDIT_MODE,data:{mode:t}}),console.log("[ mode ] >",t)}onDelete(){}onEsc(t){var i,r;(r=(i=this.curPlugin)==null?void 0:i.onEsc)==null||r.call(i,t)}onDirection(t){console.log("[ onDirection ] >",t)}onEnter(){console.log("[ onEnter ] >")}onCopy(){return console.log("[ onCopy ] >"),""}onCut(){return console.log("[ onCut ] >"),""}onPaste(t){console.log("[ onPaste ] >")}}const cb="build-in";var Uh;(function(n){n.HORIZONTAL="horizontal",n.VERTICAL="vertical"})(Uh||(Uh={}));var Ec;(function(n){n.NORMAL="normal",n.VECTOR_EDITOR="vectorEdit"})(Ec||(Ec={}));var Gl;(function(n){n.ADD_EXTRA_COMPARE_TARGET="ADD_EXTRA_COMPARE_TARGET",n.REMOVE_EXTRA_COMPARE_TARGET="REMOVE_EXTRA_COMPARE_TARGET",n.TOGGLE_MODEL="TOGGLE_MODEL",n.UPDATE_ELEMENTS="UPDATE_ELEMENTS",n.CLEAR_LINE="CLEAR_LINE"})(Gl||(Gl={}));var yp;(function(n){n.NORMAL="NORMAL",n.VECTOR_EDITOR="VECTOR_EDITOR"})(yp||(yp={}));var Ad;(function(n){n.HOVER="hover",n.DOWN="down"})(Ad||(Ad={}));function*I2(n){for(const e of n)yield*e.getInteractiveElements()}function PDe(...n){const e=new o9;for(const t of I2(n))e.add(t.id,t);return e}function u7(...n){const e=[];for(const t of I2(n))e.push(t);return e}function qD(n,e){n=Array.isArray(n)?n:[n];const t=u7(...n),r=(Array.isArray(e)?e:[e]).map(s=>Bo(t,o=>o[s.key]===s.value));return Array.isArray(e)?r:r[0]}var KD;(function(n){n[n.ControlPointLine=0]="ControlPointLine",n[n.Line=1]="Line"})(KD||(KD={}));const y4={width:1,color:11580085,alignment:0,native:!0};class h7 extends Zr{constructor(t,i){super();E(this,"viewport");E(this,"container");E(this,"options");E(this,"mode");E(this,"isSelecting",!1);E(this,"curClickGraphicTag",null);E(this,"pointLinkList");E(this,"pointGraphicMap",new Map);E(this,"lineGraphics",new Map);E(this,"cpGraphicsMap",new Map);E(this,"plugin");E(this,"delta",{x:0,y:0});E(this,"adsorptionPosition");E(this,"alignController",new Q9);this.options=i,this.plugin=t}get selectedDisplays(){const t=Symbol.for("selectedDisplays");return this[t]=this[t]||[],this[t].filter(Boolean).map(i=>{if(i.type===it.CONTROL_POINT){const r=i.effectData.node.value.id;return this.cpGraphicsMap.get(r)[i.name]}return i})}set selectedDisplays(t){var c,u,h;let i,r=!1,s=!1,o=!1;t instanceof _p||Array.isArray(t)?i=Array.isArray(t)?t:[t]:(i=Array.isArray(t.data)?t.data:[t.data],r=(c=t.options)==null?void 0:c.ignorePreUpdateSelection,s=(u=t.options)==null?void 0:u.ignoreCurUpdateSelection,o=(h=t.options)==null?void 0:h.ignoreEmitSelected);const a=Symbol.for("selectedDisplays"),l=this[a];!r&&this.updatePointStatus(l,!1),this[a]=i,!s&&this.updatePointStatus(this[a],!0),o||this.emitSelectedChangedEvent(),this.emitDataToGuideLine({selected:this.mode===wi.EDITOR?this.selectedDisplays:[this.pointGraphicMap.get(jr)].filter(Boolean)})}get auxiliaryPointGraphic(){return this.pointGraphicMap.get(jr)}get auxiliaryPointPosition(){var s;const t=this.pointGraphicMap.get(jr),i=(s=t==null?void 0:t.position)==null?void 0:s.clone();return Vu.showAuxiliaryGraphic?(t==null?void 0:t.visible)?i:null:i}init(t){var s;return t?((s=this.options)!=null&&s.needTransform?this.transformPoints(t):t).map(o=>this.composeLinkedList(o)):[Ba.create(null)]}transformPoints(t){const{display:i}=this.options,{viewport:r}=this,s=o=>{const a=i==null?void 0:i.toGlobal(o);return o=r.toLocal({x:(a==null?void 0:a.x)||0,y:(a==null?void 0:a.y)||0}),o};for(let o=0;o<t.length;o++){const a=t[o];t[o]=a.map(l=>{const{position:c,controlPoints:u,cpIds:h=[],cpType:d}=l;return l.position=s(c),u&&(l.controlPoints=u.map(f=>s(f))),l.id||(l.id=Ui()),u&&u.length!==h.length&&(l.cpIds=h.concat(Array.from({length:u.length-h.length},()=>`${Ui()}`))),d||(l.cpType=di.STRAIGHT),l})}return t}initView(){this.clearContainer();for(let t=0;t<this.pointLinkList.length;t++){const i=this.pointLinkList[t];let r=null;i.length>0&&i.forEach((s,o)=>{o!==0&&this.drawLineGraphic({curPoints:s.value,prePoint:r}),r=s.value;const{position:a,id:l}=s.value;Ft(s.value,"otherData.linkListIdx",i),this.drawPointGraphic({id:l,position:a,effectData:{node:s}})})}}composeLinkedList(t){return Ba.create(this.cloneNode(t),(r,s)=>{const{x:o,y:a}=r.position,{x:l,y:c}=s.position;return o===l&&a===c})}drawLineGraphic(t){var h;const{curPoints:{id:i,controlPoints:r,position:s},prePoint:{id:o,controlPoints:a,position:l}}=t,c=t.lineTags??`${i}_${o}`;let u=this.lineGraphics.get(c);u||(u=new ky({name:c,lineColor:t.lineColor??((h=this.options)==null?void 0:h.layerColor)??""}),this.lineGraphics.set(c,u),this.container.addChild(u)),u.drawBezierLine({start:{position:l,controlPoints:(a==null?void 0:a.length)>0?a:null},end:{position:s,controlPoints:(r==null?void 0:r.length)>0?r:null}})}drawPointGraphic(t){const{id:i,position:r,effectData:s}=t;let o=this.pointGraphicMap.get(i);return o||(o=new _p({...Vu,name:i}),this.container.addChild(o),this.pointGraphicMap.set(i,o),o.on(ji.DOUBLE_CLICK,this.onPointDoubleClick.bind(this))),o.effectData=s,o.update(r),o.scale.x=1/this.viewport.scaled,o.scale.y=1/this.viewport.scaled,o}drawCPointGraphic(t){const{id:i,cpIds:r,controlPoints:s=[],effectData:o,position:a}=t;s.forEach((l,c)=>{if(l){const u=this.cpGraphicsMap.get(i)||{},h=r[c];let d=u[h];d||(d=new _p({...Vu,type:it.CONTROL_POINT,name:h}),u[h]=d,this.cpGraphicsMap.set(i,u),this.container.addChild(d)),d.update(l),d.effectData=o,d.scale.x=1/this.viewport.scaled,d.scale.y=1/this.viewport.scaled;const f=`${i}_${h}`;let p=u[f];p||(p=new hn,p.zIndex=KD.ControlPointLine,p.name=f,u[f]=p,this.cpGraphicsMap.set(i,u),this.container.addChild(p)),c===0?(p.clear().lineStyle(y4),p.moveTo(l.x,l.y),p.lineTo(a.x,a.y)):(p.clear().lineStyle(y4),p.moveTo(a.x,a.y),p==null||p.lineTo(l.x,l.y))}})}updateControlPointStatus(t,i,r=!0){t&&t.filter(Boolean).forEach(s=>{const{id:o}=s.effectData.node.value,a=this.pointGraphicMap.get(o);if(r)this.updateAnchorPointStatus([a],i),i&&(a.refresh(!1),this.cpGraphicsMap.get(o)[s.name].refresh(!0));else{const l=this.cpGraphicsMap.get(o)[s.name];l==null||l.refresh(i)}})}updateControlNodeData(t){const{position:i,effectData:{node:r}}=t,s=i.clone(),o=r.value,a=o.cpIds.indexOf(t.name);o.controlPoints[a]=s;const l=a===0?1:0;if(o.controlPoints[l]){const c=this.calOtherControlPoints(r.value.cpType,{np:s,oldOtherCP:o.controlPoints[l],centerP:o.position});o.controlPoints[l]=c}this.drawCPointGraphic({id:o.id,cpIds:o.cpIds,position:o.position,controlPoints:o.controlPoints,effectData:{node:r}}),r.prev&&this.drawLineGraphic({curPoints:r.value,prePoint:r.prev.value}),r.next&&this.drawLineGraphic({curPoints:r.next.value,prePoint:r.value})}isHitEndpointOnUnclosedPath(){var r;if(((r=this.selectedDisplays)==null?void 0:r.length)!==1||this.selectedDisplays.some(s=>s.type===it.CONTROL_POINT))return!1;const t=this.selectedDisplays[0].effectData.node.value.otherData.linkListIdx;if(t.isClosed)return!1;const i=[t.end,t.head].includes(this.selectedDisplays[0].effectData.node);if(i){const s=this.selectedDisplays.map(({name:o})=>o);this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:{mode:wi.ADD,selectedIds:s}}}),this.recordOperationLog({action:Xn.MODEL_EXCHANGE,data:{activeNodeTags:s}})}return i}updateAnchorNodeData(t){const{position:i,effectData:{node:r}}=t,s=new Ae(r.value.position.x,r.value.position.y);if(r.value.position=i.clone(),!r.value.controlPoints||r.value.controlPoints.length===0)return;const o=i.x-s.x,a=i.y-s.y;r.value.controlPoints=r.value.controlPoints.map((l,c)=>{if(!l)return l;const u=l.x+=o,h=l.y+=a,d=r.value.cpIds[c],p=(this.cpGraphicsMap.get(r.value.id)||{})[d];return p==null||p.position.set(u,h),{x:u,y:h}})}calOtherControlPoints(t,i){const{np:r,oldOtherCP:s,centerP:o}=i;return t===di.MIRROR_ANGLE_AND_LENGTH?c9(r,o):t===di.MIRROR_ANGLE?aSe(r,s,o):s}updateAnchorPointStatus(t,i){t=t.filter(Boolean).filter(({name:r})=>!!this.pointGraphicMap.get(r)),t.length!==0&&t.forEach(r=>{r.refresh(i);const s=r.effectData.node,{id:o,cpIds:a,controlPoints:l,position:c}=s.value;if(i){this.drawCPointGraphic({id:o,cpIds:a,controlPoints:l,position:c,effectData:{node:s}});const u=s.prev,h=u&&t.some(p=>{p.name,u.value.id});if(u&&!h){const{id:p,cpIds:g,controlPoints:m,position:v}=u.value;m&&m.length>0&&this.drawCPointGraphic({id:p,cpIds:g,controlPoints:[null,m[1]],position:v,effectData:{node:u}})}const d=s.next,f=d&&t.some(p=>{p.name,d.value.id});if(d&&!f){const{id:p,cpIds:g,controlPoints:m,position:v}=d.value;m&&m.length>0&&this.drawCPointGraphic({id:p,cpIds:g,controlPoints:[m[0],null],position:v,effectData:{node:d}})}}else{const u=this.cpGraphicsMap.get(o)||{};let h=[];const d=s.prev&&t.some(g=>g.name===s.prev.value.id);if(s.prev&&!d){const{id:g,cpIds:m=[]}=s.prev.value,v=this.cpGraphicsMap.get(g)||{},_=m[1];if(_){const y=v[_],A=v[`${g}_${_}`]||v[`${_}_${g}`];h=[y,A],h.forEach(w=>{delete v[w==null?void 0:w.name]})}Object.keys(v).length===0&&this.cpGraphicsMap.delete(g)}let f=[];const p=s.next&&t.some(g=>g.name===s.next.value.id);if(s.next&&!p){const{id:g,cpIds:m=[]}=s.next.value,v=this.cpGraphicsMap.get(g)||{},_=m[0];if(_){const y=v[_],A=v[`${g}_${_}`]||v[`${_}_${g}`];f=[y,A],f.forEach(w=>{delete v[w==null?void 0:w.name]})}Object.keys(v).length===0&&this.cpGraphicsMap.delete(g)}[...Object.values(u),...h,...f].forEach(g=>{try{g==null||g.destroy()}catch{}}),this.cpGraphicsMap.delete(o)}})}insertNodesToLinkLists(t,i){if(t.length===0||t.every(r=>r.length===0))return i.forEach(r=>{const s=Ba.create(null);this.insertNodeToList(s,r),this.pointLinkList.indexOf(s)===-1&&this.pointLinkList.push(s)}),[];t=t.filter(r=>r.length!==0);for(let r=0;r<t.length&&i.length>0;r++){const s=t[r];s.forEach(o=>{const a=o.value.id;let l=null,c;for(let u=0,h=!1;u<i.length&&!h;u++)h=i[u].some(f=>[f.prevNodeTag,f.nextNodeTag].includes(a)),h&&(l=i[u],c=u);l&&(this.insertNodeToList(s,l),i.splice(c,1))})}return i&&i.length>0&&i.forEach((r,s)=>{const o=Ba.create(null);this.insertNodeToList(o,r),this.pointLinkList.push(o),i[s]=null}),i.filter(Boolean)}isInsertCloseList(t,i){let r=!1;return(t==null?void 0:t.length)===0&&(r=i.every(s=>s.prevNodeTag&&s.nextNodeTag)),r}findPrevNode(t,i){const r=pd(i,s=>{var o;return(t==null?void 0:t.prevNodeTag)===((o=s==null?void 0:s.data)==null?void 0:o.id)});r!==-1&&([i[0],i[r]]=[i[r],i[0]])}insertNodeToList(t,i){let r=t.end;const s=this.isInsertCloseList(t,i);for(;i.length>0;){const o=this.insertNode(t,r,i),{insertedNode:a}=o;r=o.indicator,i=o.nodes,this.findPrevNode(a,i),t.length===1&&s&&t.close()}}align(t){const i=zC(this.selectedDisplays),r=this.selectedDisplays.map(({name:l})=>l),s=this.alignController.execute(t,i,Pl(this.selectedDisplays),this.viewport,l=>{const c=this.viewport.toGlobal(l.position.clone());return this.selectedDisplays.length>1?null:new Pt(c.x,c.y,0,0)});this.selectedDisplays.forEach(l=>{this.updateAnchorNodeData(l)});const o={};this.selectedDisplays.forEach(l=>{const{node:c}=l.effectData,u=We(c,"prev.value.id"),h=We(c,"next.value.id"),d=We(c,"value.otherData.linkListIdx.head.value.id");o[c.value.id]={prevNodeTag:u,nextNodeTag:h,headTag:d,data:l.effectData.node.value}});const{curSelected:a}=this.mergeOverlappingPoint();if(this.selectedDisplays={data:a,options:{ignorePreUpdateSelection:!0}},s){const l={};Object.keys(o).forEach(c=>{if(!Bo(a,h=>h.name===c))l[c]=o[c],delete o[c];else{const h=this.pointGraphicMap.get(c),{node:d}=h.effectData,f=We(d,"prev.value.id"),p=We(d,"next.value.id"),g=We(d,"value.otherData.linkListIdx.head.value.id");o[d.value.id]={prevNodeTag:f,nextNodeTag:p,headTag:g,data:this.cloneNode(d.value)}}}),this.recordOperationLog({action:Xn.UPDATE,data:{activeNodeTags:r,updateNodes:o,mergedNodes:l}})}this.selectedDisplays.forEach(l=>{this.reDrawAnchorPoint(l.effectData.node,!0)})}mergeOverlappingPoint(){if(!this.selectedDisplays||this.selectedDisplays.every(({type:a})=>a===it.CONTROL_POINT))return{curSelected:this.selectedDisplays};const t=(a,l)=>{const c=this.viewport.scaled;return Math.sqrt(Math.pow(a.x-l.x,2)+Math.pow(a.y-l.y,2))*c},i=this.selectedDisplays.map(({name:a})=>a),r=[],s=[];i.forEach(a=>{var c,u,h,d;const l=this.pointGraphicMap.get(a);if(l&&l.type===it.ANCHOR_POINT){const f=l.effectData.node,p=f.value.position,g=f.value.id,{prev:m,next:v}=f,_=f.value.otherData.linkListIdx,{head:y,end:A}=_,w=y===f,b=A===f;if(!_.isClosed&&(w||b)&&_.length>1&&XR(y.value.position.x,A.value.position.x,3)&&XR(y.value.position.y,A.value.position.y,3)){const x=w?_.end.value.id:_.head.value.id,T=this.pointGraphicMap.get(x),O=T.effectData.node,G={data:this.cloneNode(O.value),headTag:O.value.otherData.linkListIdx.head.value.id,prevNodeTag:(u=(c=O.prev)==null?void 0:c.value)==null?void 0:u.id,nextNodeTag:(d=(h=O.next)==null?void 0:h.value)==null?void 0:d.id};Bo(r,({data:{id:R}})=>R===G.data.id)||r.push(G),this.removePointGraphics(T,!1,!1,!1),_.close(),this.reDrawAnchorPoint(f,!0)}Array.from(new Set([m,v])).filter(Boolean).forEach(I=>{var O,F,G,B;if(!(I.value.id===g)&&t(I.value.position,p)<5){s.push(I.value.id);const P={data:this.cloneNode(I.value),headTag:I.value.otherData.linkListIdx.head.value.id,prevNodeTag:(F=(O=I.prev)==null?void 0:O.value)==null?void 0:F.id,nextNodeTag:(B=(G=I.next)==null?void 0:G.value)==null?void 0:B.id};Bo(r,({data:{id:H}})=>H===P.data.id)||r.push(P);const L=this.pointGraphicMap.get(I.value.id);this.removePointGraphics(L,!1,!0,!1)}}),this.reDrawAnchorPoint(f,!0)}});const o=Ja([...i,...s]).map(a=>this.pointGraphicMap.get(a)).filter(Boolean);return this.selectedDisplays=o,{preSelectedTags:i.filter(Boolean),overlappingPointNode:r.filter(Boolean),curSelected:o}}insertNode(t,i,r){var c,u,h,d;const s=(c=i==null?void 0:i.value)==null?void 0:c.id;let o="",a=!1,l=null;for(let f=0;f<r.length&&!a;f++){const{prevNodeTag:p,nextNodeTag:g,data:m}=r[f];if(m.otherData.linkListIdx=t,s){if(p===s){const v=i.next;let _;if(((u=v==null?void 0:v.value)==null?void 0:u.id)===m.id?(Object.assign(v.value,m),_=v):(_=Ba.createNode(m),_=t.insertNext(i,_)),g&&!_.next&&(t.head.value.id===g&&(_.next=t.head),t.end.value.id===g&&(_.next=t.end)),!g&&_.next){const y=_.next;_.next=null,y.prev=null,t.head=_,t.end=y}(h=this==null?void 0:this.resetHoverStatus)==null||h.call(this),this.removeConnect(v,i),[_,i,v].filter(Boolean).forEach(y=>this.reDrawAnchorPoint(y,!1)),l=r[f],r[f]=null,a=!0,i=i.next}else if(g===s){const v=i.prev;let _;if(m.id===((d=v==null?void 0:v.value)==null?void 0:d.id)?(Object.assign(v.value,m),_=v):(_=Ba.createNode(m),_=t.insertPrev(i,_)),p&&!_.prev&&(t.head.value.id===p&&(_.prev=t.head),t.end.value.id===p&&(_.prev=t.end)),!p&&_.prev){const y=_.prev;_.prev=null,y.next=null,t.end=_,t.head=y}this!=null&&this.resetHoverStatus&&this.resetHoverStatus(),this.removeConnect(i,v),[_,i,v].filter(Boolean).forEach(y=>this.reDrawAnchorPoint(y,!1)),l=r[f],r[f]=null,i=i.prev,a=!0,o=i.value.id}}else{const v=Ba.createNode(m),_=i==null?void 0:i.next,y=t.insert(v);p===y.value.id&&(y.prev=y),g===y.value.id&&(y.next=y),this!=null&&this.resetHoverStatus&&this.resetHoverStatus(),[v,i,_].filter(Boolean).forEach(A=>this.reDrawAnchorPoint(A,!1)),l=r[f],r[f]=null,a=!0,i=t.end}}return r=r.filter(Boolean),{nodes:r,indicator:a?i:i.next,endTag:o,insertedNode:l}}removePointGraphics(t,i=!0,r=!0,s=!0){if(!t)return;if(t=Array.isArray(t)?t:[t],i){const a={};t.forEach(l=>{const{node:c}=l.effectData,u=We(c,"prev.value.id"),h=We(c,"next.value.id"),d=We(c,"value.otherData.linkListIdx.head.value.id");a[c.value.id]={prevNodeTag:u,nextNodeTag:h,headTag:d,data:l.effectData.node.value}}),this.recordOperationLog({action:Xn.DELETE,data:{activeNodeTags:t.map(l=>{if(l.type===it.ANCHOR_POINT)return l.name;{const c=l.name;return`${l.effectData.node.value.id}_${c}`}}),updateNodes:a}})}let o="";t.forEach(a=>{const l=a.type,c=a.effectData.node;if(l===it.ANCHOR_POINT)o=o||We(c,"prev.value.id")||We(c,"next.value.id"),this.removeAnchorPointGraphics(c,r);else{o=o||We(c,"value.id");const u=a.name;this.removeCPointGraphics(c,[u])}}),s&&(this.selectedDisplays={data:this.pointGraphicMap.get(o),options:{ignorePreUpdateSelection:!0}}),this.pointLinkList=this.pointLinkList.filter(a=>a.length!==0)}findDisplayRecentRecord(t,i=[]){const r=[];i=[...i];for(let s=t.length-1;s>=0&&i.length>0;s--){const o=t[s];i.forEach((a,l)=>{var g,m,v;const c=a.indexOf("_")!==-1;let u=!1,h=!1,d,f,p;if(c?([f,p]=a.split("_"),d=o.updateNodes[f],u=d&&((m=(g=d.data)==null?void 0:g.cpIds)==null?void 0:m.includes(p))):(h=!!o.updateNodes[a],d=o.updateNodes[a]),u||h){const _={...d,data:this.cloneNode(d.data)},y=this.pointGraphicMap.get((v=d.data)==null?void 0:v.id);if(o.action===Xn.DELETE&&y){const{cpIds:A=[],controlPoints:w=[]}=y.effectData.node.value,b=pn(Object.assign([null,null],A)),C=pn(Object.assign([null,null],w)),I=_.data.cpIds.indexOf(p);b[I]=p,C[I]=_.data.controlPoints[I],_.data.cpIds=b,_.data.controlPoints=C,_.data.cpType=b.filter(Boolean).length===1?di.NO_MIRRORING:_.data.cpType}r.push(_),i[l]=null}}),i=i.filter(Boolean)}return r}removeAnchorPointGraphics(t,i=!0){t&&(t=Array.isArray(t)?t:[t],t.forEach(r=>{const{id:s}=r.value;this.pointGraphicMap.get(s).destroy(),this.pointGraphicMap.delete(s);const a=this.cpGraphicsMap.get(s)||{};Object.values(a).forEach(h=>h.destroy()),this.cpGraphicsMap.delete(s);const l=We(r,"prev.value.id"),c=We(r,"next.value.id");We(r,"value.otherData.linkListIdx").delete(r,i),[l,c].forEach((h,d)=>{if(r){const f=d===0?`${s}_${h}`:`${h}_${s}`,p=this.lineGraphics.get(f);p==null||p.destroy(),this.lineGraphics.delete(f);const g=this.pointGraphicMap.get(h),m=We(g,"effectData.node");m&&this.reDrawAnchorPoint(m,!1)}})}))}removeCPointGraphics(t,i="all"){var a,l;if(!t)return;const r=We(t,"value.id");if(i==="all"){const c=this.cpGraphicsMap.get(r)||{};Object.values(c).forEach(u=>{u.destroy()}),this.cpGraphicsMap.delete(r),Object.assign(t.value,{cpIds:[],controlPoints:[],cpType:di.STRAIGHT})}else i.forEach(c=>{const u=this.cpGraphicsMap.get(r);[`${r}_${c}`,c].forEach(p=>{u[p].destroy(),delete u[p]});const d=t.value,f=d.cpIds.indexOf(c);d.cpIds.splice(f,1),d.controlPoints.splice(f,1),d.cpType=di.NO_MIRRORING}),Object.assign(t.value,{cpType:t.value.controlPoints.length===0?di.STRAIGHT:di.NO_MIRRORING});const s=(a=t.prev)==null?void 0:a.value,o=(l=t.next)==null?void 0:l.value;s&&this.drawLineGraphic({curPoints:t.value,prePoint:s}),o&&this.drawLineGraphic({curPoints:o,prePoint:t.value})}selectingElements(t){this.isSelecting=t}updatePointStatus(t,i){if(t=(Array.isArray(t)?t:[t]).filter(Boolean),wt(t))return;t.length===1&&t[0].type===it.CONTROL_POINT?this.updateControlPointStatus(t,i):(t=t.filter(s=>s.type===it.ANCHOR_POINT),this.updateAnchorPointStatus(t,i))}calDeltaToSelected(t,i){if(!t)return{x:0,y:0};const r=Yp(i,this.viewport),s=(r.minX-r.maxX)/2,o=(r.minY-r.maxY)/2;return{x:s,y:o}}reDrawAnchorPoint(t,i=!0){const{id:r,position:s,cpIds:o,controlPoints:a}=t.value;t.prev&&this.drawLineGraphic({curPoints:t.value,prePoint:t.prev.value}),t.next&&this.drawLineGraphic({curPoints:t.next.value,prePoint:t.value}),i&&o&&o.length>0&&this.drawCPointGraphic({id:r,cpIds:o,controlPoints:a,position:s,effectData:{node:t}}),this.drawPointGraphic({id:r,position:s,effectData:{node:t}})}translateDisplays(t,i){const{displays:r}=i;r.length!==0&&(r.forEach(s=>{s.position.x+=Number((t==null?void 0:t.deltaX)??0),s.position.y+=Number((t==null?void 0:t.deltaY)??0)}),r.forEach(s=>{s.type===it.CONTROL_POINT?this.updateControlNodeData(s):(this.updateAnchorNodeData(s),this.reDrawAnchorPoint(s.effectData.node,!0),this.drawAuxiliaryGraphics(this.auxiliaryPointPosition))}))}updateDisplayObjectsAttributes(t,i,r){const{displays:s}=i;if(s.length===0)return;s.forEach(c=>{c.position.x=Number((t==null?void 0:t.x)??c.position.x),c.position.y=Number((t==null?void 0:t.y)??c.position.y)}),s.forEach(c=>{c.type===it.CONTROL_POINT?this.updateControlNodeData(c):(this.updateAnchorNodeData(c),this.reDrawAnchorPoint(c.effectData.node,!0),this.drawAuxiliaryGraphics(this.auxiliaryPointPosition))});const o={};this.selectedDisplays.forEach(c=>{var f,p,g,m;const{node:u}=c.effectData,h=(p=(f=u.prev)==null?void 0:f.value)==null?void 0:p.id,d=(m=(g=u.next)==null?void 0:g.value)==null?void 0:m.id;o[u.value.id]={prevNodeTag:h,nextNodeTag:d,headTag:u.value.otherData.linkListIdx.head.value.id,data:c.effectData.node.value}});const{curSelected:a}=this.mergeOverlappingPoint()||{};if(We(r,"willRecord",!1)){const c={};Object.keys(o).forEach(u=>{if(!Bo(a,d=>d.name===u))c[u]=o[u],delete o[u];else{const d=this.pointGraphicMap.get(u),{node:f}=d.effectData,p=We(f,"prev.value.id"),g=We(f,"next.value.id"),m=We(f,"value.otherData.linkListIdx.head.value.id");o[f.value.id]={prevNodeTag:p,nextNodeTag:g,headTag:m,data:this.cloneNode(f.value)}}}),this.recordOperationLog({action:Xn.UPDATE,data:{activeNodeTags:this.selectedDisplays.map(u=>{if(u.type===it.ANCHOR_POINT)return u.name;{const h=u.name;return`${u.effectData.node.value.id}_${h}`}}),updateNodes:o,mergedNodes:c}})}this.selectedDisplays={data:a,options:{ignorePreUpdateSelection:!0,ignoreCurUpdateSelection:!0}}}updateNodeByLog(t,i){const r=We(i||{},"updateIndicator",!1);t.forEach(s=>{const{data:{id:o},nextNodeTag:a,prevNodeTag:l}=s,c=this.pointGraphicMap.get(o);if(c){const u=c.effectData.node;if(r){const h=this.getListNodeByAnchorTag(l);u.prev=h,h&&(h.next=u);const d=this.getListNodeByAnchorTag(a);u.next=d,d&&(d.prev=u)}Object.assign(c.effectData.node.value,this.cloneNode(s.data)),this.reDrawAnchorPoint(c.effectData.node,!1)}})}setAdsorptionPosition(t){this.adsorptionPosition=t.clone()}get curContours(){const t=[];return this.pointLinkList.forEach(i=>t.push(i.toJSON())),t}saveEditObject(t,i){const r=t;let s;const o=r.getEditorOriginDisplay(),a=We(o,"id",""),l=gr(o,"isFill","lockRatio","zOrder","groupTag","layerTag","layerColor","visible","enableFill","enableTransform","lockState","visibleState","name","originColor","sourceId");if(o){const c=qD(this.viewport.displayLayer,{key:"id",value:o.id||""});this.emit(at.MESSAGE_TO_MANAGER,{eventName:vo.DESTROY,data:{objs:[c]}})}if(i!=null&&i.saveChanged){const c=r.generatePath();c&&(r.once(at.MESSAGE_TO_PLUGIN,({eventName:u,result:h})=>{u===vo.CREATE&&(s=h)}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:vo.CREATE,data:{withLayerTag:!o,params:{type:it.PATH,options:{dPath:c,...l}}}})),s&&(s.id=a??s.id,this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.ADD_CHILD,data:{type:Fo.VIEWPORT,objs:[s],options:{autoSelected:!0,ignoreUpdateZOrder:!!o}}}))}return s}recordExitVectorOperator(){var s,o;const{options:t={}}=this,i={};Array.from(this.pointGraphicMap.values()||[]).forEach(a=>{var l,c,u,h,d,f,p,g;if(![gR,jr].includes(a.name)){const{node:m}=a.effectData;i[m.value.id]={data:this.cloneNode(m.value),prevNodeTag:(c=(l=m.prev)==null?void 0:l.value)==null?void 0:c.id,nextNodeTag:(h=(u=m.next)==null?void 0:u.value)==null?void 0:h.id,headTag:(g=(p=(f=(d=m.value.otherData)==null?void 0:d.linkListIdx)==null?void 0:f.head)==null?void 0:p.value)==null?void 0:g.id}}});const r=(o=(s=this.options)==null?void 0:s.display)==null?void 0:o.id;return{action:Xn.EXIT_VECTOR_EDIT,activeNodeTags:this.selectedDisplays.map(a=>a.effectData.node.value.id),updateNodes:i,contours:this.curContours,subEditModeName:this.mode,onUndo:a=>{const{redoStack:l}=a,{activeNodeTags:c,curIDs:u=new Set,contours:h,subEditModeName:d}=l[l.length-1],[f]=u,p=qD(this.viewport.displayLayer,{key:"id",value:r||f}),g=new Ry;g.contours=pn(h);const m=Object.assign({},t,{activeNodeTags:c,display:p,willRecord:!1,needTransform:!1,pathPoints:g,mode:d});return this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:m}}),{skipRedraw:!0}},onRedo:()=>{this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:null,options:{saveChanged:!1}}})}}}recordSelectedPointsTypeChanged(){const t={};this.selectedDisplays.forEach(i=>{var a,l,c,u;const{node:r}=i.effectData,s=(l=(a=r.prev)==null?void 0:a.value)==null?void 0:l.id,o=(u=(c=r.next)==null?void 0:c.value)==null?void 0:u.id;t[r.value.id]={prevNodeTag:s,nextNodeTag:o,headTag:r.value.otherData.linkListIdx.head.value.id,data:i.effectData.node.value}}),this.recordOperationLog({action:Xn.UPDATE,data:{activeNodeTags:this.selectedDisplays.map(i=>{if(i.type===it.ANCHOR_POINT)return i.name;{const r=i.name;return`${i.effectData.node.value.id}_${r}`}}),updateNodes:t}})}generatePath(){var o,a,l,c;const t=[],i=(u,h)=>{const d=Dd(u,h);return Math.abs(d)<=5};(l=(a=(o=this.pointLinkList)==null?void 0:o.filter(u=>u.length>1))==null?void 0:a.filter(u=>!(u.length===2&&i(this.viewport.toGlobal(u.head.value.position),this.viewport.toGlobal(u.end.value.position)))))==null||l.forEach(u=>t.push(u.toJSON()));const r=((c=this.options)==null?void 0:c.pathPoints)??new Ry;return r.contours=t,r.toString()}getLinkListByAnchor(t){return We(t,"effectData.node.value.otherData.linkListIdx")}exchangeModel(t,i){const r=t.vectorOperator,s=gr(r,["viewport","container","pointLinkList","pointGraphicMap","lineGraphics","cpGraphicsMap"]),o=r.options,a=[];s.pointLinkList.filter(c=>c.length>0).forEach(c=>a.push(c.toJSON()));const l=new Ry;l.contours=a,Object.assign(i,{...s,pointLinkList:s.pointLinkList.filter(c=>c.length!==0),options:{display:o.display,layerColor:o==null?void 0:o.layerColor,...i.options,pathPoints:l}}),this.clearTempStatus()}changeAnchorType(t,i){var s,o,a,l;if(!t)return;const r=t.effectData.node;if(i===di.STRAIGHT)this.removeCPointGraphics(r);else{const c=t.effectData.node,{position:u}=c.value;let h=(o=(s=c==null?void 0:c.prev)==null?void 0:s.value)==null?void 0:o.position,d=(l=(a=c==null?void 0:c.next)==null?void 0:a.value)==null?void 0:l.position;d?h||(h=d):d=h;const f=[Ui(),Ui()],p=this.generatorPointByType(i,{prePoint:h,curPoint:u,nextPoint:d});Object.assign(c.value,{cpType:i,controlPoints:p,cpIds:f}),this.reDrawAnchorPoint(c)}}generatorPointByType(t,i){const{prePoint:r,curPoint:s,nextPoint:o}=i,a={MIRROR_ANGLE_AND_LENGTH:()=>{const{cp1:l,cp2:c}=JR(r,s,o);return[l,c]},NO_MIRRORING:()=>{const{cp1:l,cp2:c}=vw(r,s,o);return[l,c]},MIRROR_ANGLE:()=>{const{cp1:l,cp2:c}=vw(r,s,o);return[l,c]}}[t];return a()}typeToMirrorAngleAndLength(t,i,r){const{cp1:s,cp2:o}=JR(t,i,r);return[s,o]}typeToNoMirroring(t){var c,u,h,d;const i=t.effectData.node,{position:r}=i.value;let s=(u=(c=i==null?void 0:i.prev)==null?void 0:c.value)==null?void 0:u.position,o=(d=(h=i==null?void 0:i.next)==null?void 0:h.value)==null?void 0:d.position;o?s||(s=o):o=s;const{cp1:a,cp2:l}=vw(s,r,o);i.value.cpType=di.NO_MIRRORING,i.value.controlPoints=[a,l],i.value.cpIds=[Ui(),Ui()],this.reDrawAnchorPoint(i)}emitSelectedChangedEvent(){this.emit(at.MESSAGE_TO_MANAGER,{eventName:Kl.SELECT,data:this.selectedDisplays})}emitDataToGuideLine(t){const i=this.elementsToGuidelinePlugin(t);this.plugin.emit(at.MESSAGE_TO_PLUGIN,{eventName:Gl.UPDATE_ELEMENTS,data:i})}updateSelectedDisplay(){this.selectedDisplays.forEach(t=>{this.updateAnchorNodeData(t),this.reDrawAnchorPoint(t.effectData.node,!0)})}typeToMirrorAngle(t){var c,u,h,d;const i=t.effectData.node,{position:r}=i.value;let s=(u=(c=i==null?void 0:i.prev)==null?void 0:c.value)==null?void 0:u.position,o=(d=(h=i==null?void 0:i.next)==null?void 0:h.value)==null?void 0:d.position;o?s||(s=o):o=s;const{cp1:a,cp2:l}=vw(s,r,o);i.value.cpType=di.MIRROR_ANGLE,i.value.controlPoints=[a,l],i.value.cpIds=[Ui(),Ui()],this.reDrawAnchorPoint(i)}getInteractElement(t,i){let r;return this.plugin.once(at.MESSAGE_TO_PLUGIN,({eventName:s,result:o})=>{s===xi.GET_INTERACT_ELEMENT&&(r=o)}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.GET_INTERACT_ELEMENT,data:{scope:t,options:i}}),r}getListNodeByAnchorTag(t){var r;const i=this.pointGraphicMap.get(t);return(r=i==null?void 0:i.effectData)==null?void 0:r.node}removeConnect(t,i){var o,a;const r=`${(o=t==null?void 0:t.value)==null?void 0:o.id}_${(a=i==null?void 0:i.value)==null?void 0:a.id}`,s=this.lineGraphics.get(r);s==null||s.destroy(),this.lineGraphics.delete(r)}cloneNode(t){const i=Array.isArray(t),s=(i?t:[t]).map(o=>{var a;return{id:o.id,cpIds:pn(o==null?void 0:o.cpIds),cpType:o.cpType,position:{x:o.position.x,y:o.position.y},controlPoints:(a=o==null?void 0:o.controlPoints)==null?void 0:a.map(l=>l&&{x:l.x,y:l.y}),otherData:o.otherData}});return i?s:s[0]}clearContainer(){this.container.removeChildren(0,this.container.children.length),this.pointGraphicMap=new Map,this.cpGraphicsMap=new Map,this.lineGraphics=new Map}destroy(){this.clearContainer(),this.container.destroy(),this.container=null}}var pu;(function(n){n[n.NORMAL=0]="NORMAL",n[n.BEZIER_CURVE_WITH_CONTROL=1]="BEZIER_CURVE_WITH_CONTROL"})(pu||(pu={}));class A4 extends h7{constructor(t,i){super(t,i);E(this,"drawModel",pu.BEZIER_CURVE_WITH_CONTROL);E(this,"curLinkListLen",0);E(this,"mouseDownPosition",null);this.mode=wi.ADD}get curLinkList(){var t;if(!this.selectedDisplays||((t=this.selectedDisplays)==null?void 0:t.length)===0){const i=pd(this.pointLinkList,s=>s.length===0);let r;return i===-1?(r=Ba.create(null),this.pointLinkList.push(r)):r=this.pointLinkList[i],r}else return this.getLinkListByAnchor(this.selectedDisplays[0])}initView(t){var i,r;if(super.initView(),this.createAuxiliaryPoint(),t)this.selectedDisplays=(t||[]).map(s=>this.pointGraphicMap.get(s));else if(this.curLinkList.length>0){const{id:s}=((i=this.curLinkList.head)==null?void 0:i.value)||{};if(s){const o=this.pointGraphicMap.get(s);this.selectedDisplays=o}}if(this.drawModel=pu.NORMAL,(r=this.options)!=null&&r.willRecord){const s=this.recordEnterVectorOperator();this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ho.RECORD,data:{props:s,ignoreSelected:!0}})}this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.CHANGE_CURSOR,data:{type:"vectorDraw"}})}isClosed(){var i,r,s,o,a,l,c,u,h;let t=!1;if(((i=this.curLinkList)==null?void 0:i.length)>=2){const d=this.selectedDisplays[0].name===((s=(r=this.curLinkList.head)==null?void 0:r.value)==null?void 0:s.id)?(l=(a=(o=this.curLinkList)==null?void 0:o.end)==null?void 0:a.value)==null?void 0:l.position:(h=(u=(c=this.curLinkList)==null?void 0:c.head)==null?void 0:u.value)==null?void 0:h.position;if(this.auxiliaryPointPosition){const f=this.viewport.toGlobal(this.auxiliaryPointPosition),p=this.viewport.toGlobal(d),g=Dd(f,p);t=Math.abs(g)<=5}}return t}closure(t){const i=this.selectedDisplays[0];if(this.updatePointStatus([i],!1),this.finishCurDraw(),t){const r=this.getLinkListByAnchor(i),s=i.name,o=r.head.value.id===s?r.end.value.id:r.head.value.id;this.recordOperationLog({action:Xn.CLOSE,data:{activeNodeTags:[s,o]}})}this.onEsc({willRecord:!1})}async onViewportPointerDown(t){var i,r;if(t.data.originalEvent.button!==2){if(window.TouchEvent&&t.data.originalEvent instanceof TouchEvent){const s=((i=this.adsorptionPosition)==null?void 0:i.clone())||t.data.getLocalPosition(this.viewport);this.drawAuxiliaryGraphics(s)}if(this.drawModel=pu.BEZIER_CURVE_WITH_CONTROL,this.isClosed()){this.closure(!0);return}this.curLinkListLen=this.curLinkList.length,this.addPointGraphicsOnEventPoint((r=this.auxiliaryPointPosition)==null?void 0:r.clone()),this.mouseDownPosition=t.data.getLocalPosition(this.viewport)}}onViewportPointerMove(t){var o,a,l,c;const{viewport:i}=this,r=((o=this.adsorptionPosition)==null?void 0:o.clone())||t.data.getLocalPosition(i);if(this.adsorptionPosition=null,this.drawModel===pu.BEZIER_CURVE_WITH_CONTROL)if(((a=this.selectedDisplays)==null?void 0:a.length)===1){if(Dd(this.viewport.toGlobal(r),this.viewport.toGlobal(this.mouseDownPosition))<10)return;(l=this.lineGraphics.get(L_))==null||l.clear(),(c=this.pointGraphicMap.get(jr))==null||c.clear();const u=this.selectedDisplays[0].effectData.node.value,h=f=>{const p=u.position,{x:g,y:m}=p,{x:v,y:_}=f;return[new Ae(g-(v-g),m-(_-m)),f]};(!u.cpIds||u.cpIds.length===0)&&(u.cpIds=[Ui(),Ui()],u.cpType=di.MIRROR_ANGLE_AND_LENGTH,u.controlPoints=h(r),this.reDrawAnchorPoint(this.selectedDisplays[0].effectData.node,!0));const d=this.cpGraphicsMap.get(u.id)[u.cpIds[1]];d.position=r.clone(),this.updateControlNodeData(d),this.emitSelectedChangedEvent(),this.emitDataToGuideLine({selected:[this.cpGraphicsMap.get(u.id)[u.cpIds[1]]]})}else this.updateAuxiliaryPoint(r);else this.drawAuxiliaryGraphics(r);const s=this.isClosed()?"drawClose":"vectorDraw";i.isDragMode||this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.CHANGE_CURSOR,data:{type:s}})}onViewportPointerUp(t){if(this.drawModel=pu.NORMAL,this.curLinkList.length-this.curLinkListLen===1){const i=this.selectedDisplays[0].effectData.node,r={[i.value.id]:{prevNodeTag:We(i,"prev.value.id"),nextNodeTag:We(i,"next.value.id"),headTag:i.value.id,data:this.cloneNode(i.value)}};this.recordOperationLog({action:Xn.ADD,data:{activeNodeTags:this.selectedDisplays.map(({name:s})=>s),updateNodes:r}}),this.pointGraphicMap.get(jr).update(),this.emitSelectedChangedEvent(),this.emitDataToGuideLine()}this.mouseDownPosition=null}onViewportDoubleClick(){}onEsc(t){const{willRecord:i=!0}=t||{},r=this.selectedDisplays.map(({name:o})=>o);if(this.pointLinkList.every(o=>o.length===0)){this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:null,options:{saveChanged:!1,willRecord:!0}}});return}this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:{mode:wi.EDITOR,willRecord:i}}}),i&&this.recordOperationLog({action:Xn.MODEL_EXCHANGE,data:{activeNodeTags:r}})}handleUndoCloseAction(t){const[i,r]=t,s=this.pointGraphicMap.get(i),o=this.getLinkListByAnchor(s);(()=>{const l=this.lineGraphics.get(`${r}_${i}`)||this.lineGraphics.get(`${i}_${r}`),c=l.name,u=this.getListNodeByAnchorTag(i),h=this.getListNodeByAnchorTag(r);l.destroy(),this.lineGraphics.delete(c);let d,f;u.next.value.id===h.value.id?[d,f]=[u,h]:[d,f]=[h,u],o.head=d,o.end=f,o.disconnect()})(),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:{mode:wi.ADD,willRecord:!1,selectedIds:[i]}}})}handleUndoDeleteAction(t){const i=Fr(t,"headTag");(this.insertNodesToLinkLists(this.pointLinkList,Object.keys(i).map(s=>i[s]))||[]).forEach(s=>{const o=Ba.create(s.filter(Boolean).map(a=>a.data));this.pointLinkList.push(o)})}handleUndoAddAction(t,i){const r=t.map(s=>{if(s.indexOf("_")!==-1){const[o,a]=s.split("_"),l=this.cpGraphicsMap.get(o)[a];return i=i||[We(l,"value.id")],l}else{const o=this.pointGraphicMap.get(s);return i=i||[We(o,"prev.value.id")||We(o,"next.value.id")],o}});this.removePointGraphics(r,!1,!1),this.reDrawAuxiliaryLine(),this.emitSelectedChangedEvent(),this.emitDataToGuideLine()}handleUndoUpdateAction(t,i){this.selectedDisplays=[],this.updateNodeByLog(i,{updateIndicator:!1}),this.selectedDisplays=t.map(r=>{if(r.indexOf("_")!==-1){const[s]=r.split("_");return this.pointGraphicMap.get(s)}return this.pointGraphicMap.get(r)})}handleRedoDeleteAction(t){let i;const r=t.map(s=>{if(s.indexOf("_")!==-1){const[o,a]=s.split("_"),l=this.cpGraphicsMap.get(o)[a];return i=i||[We(l,"value.id")],l}else{const o=this.pointGraphicMap.get(s);return i=i||[We(o,"prev.value.id")||We(o,"next.value.id")],o}});return this.removePointGraphics(r,!1,!0,!1),i.filter(Boolean)}handleRedoAddAction(t,i){this.drawModel=pu.NORMAL;const r=Fr(Object.values(t),"headTag");this.insertNodesToLinkLists(this.pointLinkList,Object.keys(r).map(s=>r[s])),this.selectedDisplays=i.map(s=>this.pointGraphicMap.get(s)),this.reDrawAuxiliaryLine(),this.emitSelectedChangedEvent(),this.emitDataToGuideLine()}handleRedoCloseAction(){this.closure(!1),this.emitSelectedChangedEvent(),this.emitDataToGuideLine()}handleRedoUpdateAction(t,i){this.selectedDisplays=[],this.updateNodeByLog(Object.values(t),{updateIndicator:!0}),this.pointLinkList.forEach(r=>{r.length===1&&(r.head.next=r.end,r.end.prev=r.head)}),this.selectedDisplays=i.map(r=>{if(r.indexOf("_")!==-1){const[s]=r.split("_");return this.pointGraphicMap.get(s)}return this.pointGraphicMap.get(r)})}recordOperationLog(t){const i=We(t,"action"),r=We(t,"data.updateNodes")||{},s=We(t,"data.activeNodeTags"),o={};Object.keys(r).forEach(l=>{o[l]={...r[l],data:this.cloneNode(r[l].data)}});const a=l=>({action:i,updateNodes:o,activeNodeTags:s,onUndo:c=>{var m,v,_;const u=l.curSubEditMode.curPlugin.vectorOperator,h=null,{redoStack:d}=c,f=d[d.length-1],{activeNodeTags:p,action:g}=f;if(g===Xn.DELETE){const y=u.findDisplayRecentRecord(d,s);u.handleUndoDeleteAction(y);const A=(s==null?void 0:s[0])??((_=(v=(m=u.curLinkList)==null?void 0:m.head)==null?void 0:v.value)==null?void 0:_.id);u.selectedDisplays=this.pointGraphicMap.get(A)??[],u.reDrawAuxiliaryLine()}else if(g===Xn.ADD)u.handleUndoAddAction(p,h);else if(g===Xn.CLOSE)this.handleUndoCloseAction.call(u,p);else if(g===Xn.MODEL_EXCHANGE)u.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:{mode:wi.ADD,willRecord:!1,selectedIds:p}}});else{const y=u.findDisplayRecentRecord(c.undoStack,s);u.handleUndoUpdateAction(p,y)}},onRedo:c=>{var m,v,_;const u=l.curSubEditMode.curPlugin.vectorOperator,{undoStack:h}=c,d=h[h.length-1],{activeNodeTags:f,updateNodes:p}=d,{action:g}=d;if(g===Xn.DELETE){u.handleRedoDeleteAction(f);const y=(_=(v=(m=u.curLinkList)==null?void 0:m.head)==null?void 0:v.value)==null?void 0:_.id;u.selectedDisplays=u.pointGraphicMap.get(y)??[],u.reDrawAuxiliaryLine()}else g===Xn.ADD?u.handleRedoAddAction(p,f):g===Xn.CLOSE?u.handleRedoCloseAction():g===Xn.MODEL_EXCHANGE?u.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:{mode:wi.EDITOR,willRecord:!1,selectedIds:f}}}):u.handleRedoUpdateAction(p,f)}});this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ho.RECORD,data:{props:a,ignoreSelected:!0}})}createAuxiliaryPoint(){const t=new _p({name:jr,position:null});this.container.addChild(t),this.pointGraphicMap.set(jr,t),t.scale.x=1/this.viewport.scaled,t.scale.y=1/this.viewport.scaled,t.visible=!1,this.delta=this.calDeltaToSelected(t.position,[t])}beforeExit(t,i={willRecord:!0,saveChanged:!0}){this.emit(at.MESSAGE_TO_MANAGER,{eventName:Kl.SELECT,data:[]});const r=this.saveEditObject(t,i);if(!(i!=null&&i.willRecord))return;const s=this.recordExitVectorOperator();this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ho.RECORD,data:{props:s,objs:r?[r]:null,ignoreSelected:!r}}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:gp.EVENT_TRACKING,data:{eventName:"exitVectorDraw"}})}updateAuxiliaryPoint(t,i=Vu.showAuxiliaryGraphic){const r=this.pointGraphicMap.get(jr);r&&(r.visible?this.pointGraphicMap.get(jr).position=t.clone():r.update(t.clone()),r.visible=i)}removeSelectedGraphics(){!this.selectedDisplays||this.selectedDisplays.length===0||(this.removePointGraphics(this.selectedDisplays),this.reDrawAuxiliaryLine(),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Lc.CLEAR_LINE}))}drawAuxiliaryGraphics(t,i=Vu.showAuxiliaryGraphic){var r,s;if(!((r=this.curLinkList)!=null&&r.isClosed||!t)&&(this.updateAuxiliaryPoint(t),this.pointGraphicMap.get(jr).interactive=!1,i&&((s=this.selectedDisplays)==null?void 0:s.length)>0)){const o=this.pointGraphicMap.get(jr),a=Xr.calculateGroupOrientedBounds([o],0),l=this.viewport.toLocal(a.center);this.selectedDisplays[0].effectData.node.next?this.drawLineGraphic({curPoints:this.selectedDisplays[0].effectData.node.value,prePoint:{position:l},lineTags:L_,lineColor:QD.hoverColor}):this.drawLineGraphic({curPoints:{position:l},prePoint:this.selectedDisplays[0].effectData.node.value,lineTags:L_,lineColor:QD.hoverColor})}}recordEnterVectorOperator(){return{onUndo:()=>{this.emit(at.MESSAGE_TO_MANAGER,{eventName:Xa.BACK_TO_NORMAL_SELECT,data:{saveChanged:!1,willRecord:!1,autoSelected:!0}})},onRedo:()=>{this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:{mode:wi.ADD,willRecord:!1}}})}}}onPointDoubleClick(t){}addPointGraphicsOnEventPoint(t){if(!t)return;const i=Ui(),r=this.curLinkList,s={id:i,position:t,otherData:{linkListIdx:r}},o=Ba.createNode(s);if(r.length===0)r.insert(o);else{const{node:a}=this.selectedDisplays[0].effectData,{next:l}=a;l?(r.insertPrev(a,o),this.drawLineGraphic({curPoints:a.value,prePoint:a.prev.value})):(r.insertNext(a,o),this.drawLineGraphic({curPoints:a.next.value,prePoint:a.value}))}this.drawPointGraphic({id:i,position:t,effectData:{node:o}}),this.selectedDisplays=this.pointGraphicMap.get(i)}reDrawAuxiliaryLine(){const t=this.pointGraphicMap.get(jr);if(this.selectedDisplays.length>0&&t.visible){const i=this.pointGraphicMap.get(jr).position;this.drawAuxiliaryGraphics(i)}else this.removeAuxiliaryLine()}removeAuxiliaryLine(){var t;(t=this.lineGraphics.get(L_))==null||t.destroy(),this.lineGraphics.delete(L_)}removeAuxiliaryPoint(){var t;(t=this.pointGraphicMap.get(jr))==null||t.destroy(),this.pointGraphicMap.delete(jr)}clearTempStatus(){var t,i,r,s,o;if(this.curLinkList.length>0){const a=(o=(s=(r=(i=(t=this.selectedDisplays)==null?void 0:t[0])==null?void 0:i.effectData)==null?void 0:r.node)==null?void 0:s.value)==null?void 0:o.id;if(a){const l=this.pointGraphicMap.get(a);this.updatePointStatus([l],!1)}this.removeAuxiliaryLine()}this.selectedDisplays=[],this.removeAuxiliaryPoint()}exchangeModel(t,i){super.exchangeModel(t,i)}prepare(t){this.drawModel=pu.NORMAL,Array.from(this.pointGraphicMap.values()||[]).forEach(r=>{r.off(ji.DOUBLE_CLICK)}),this.initView(t)}elementsToGuidelinePlugin(t){var l;const i=We(t||{},"selected",null)??[this.pointGraphicMap.get(jr)].filter(Boolean);let r=We(t||{},"unSelected",null);const s=this.getInteractElement(ll.TEMP_LAYER)??[];r=r||s.filter(c=>c.type===it.ANCHOR_POINT&&!i.map(u=>u.id).includes(c.id));const o=(l=this.options)==null?void 0:l.display,a=this.getInteractElement(ll.DISPLAY_LAYER)??[];return{selected:i,unSelected:r,extraElements:a.filter(({id:c})=>c!==(o==null?void 0:o.id))}}finishCurDraw(){this.curLinkList.close(),this.drawLineGraphic({curPoints:this.curLinkList.end.value,prePoint:this.curLinkList.head.value}),this.removeAuxiliaryLine();const t=Ba.create(null);this.pointLinkList.push(t)}resetHoverStatus(){}changeSelectedPointType(t,i=!0){var s;const r=[];(s=this.selectedDisplays)==null||s.forEach(o=>{this.changeAnchorType(o,t),r.push(this.pointGraphicMap.get(o.effectData.node.value.id))}),this.selectedDisplays=r,i&&this.recordSelectedPointsTypeChanged(),this.emitDataToGuideLine({selected:this.options.mode===wi.EDITOR?this.selectedDisplays:[this.pointGraphicMap.get(jr)]})}}class MDe{calControlPOfNodeAdd(e,t){const i=this.computeT(e,t,0,1);return this.calculateControlPoints(i,e)}computeT(e,t,i=0,r=1){let s=i,o=1/0,a=0;const l=(r-i)/100;for(let c=0;c<100;c++){const u=this.calculateBezierPoint(s,e),h=this.calculateDistance(u,t);if(h<o&&(o=h,a=s),h<1e-4||l===0)return s;s+=l}return this.computeT(e,t,a-l,a+l)}calculateControlPoints(e,t){const i=[];for(;t.length>1;){const r=[];for(let s=0;s<t.length-1;s++){const o=(1-e)*t[s].x+e*t[s+1].x,a=(1-e)*t[s].y+e*t[s+1].y;r.push({x:o,y:a})}i.push(r),t=r}return i}calculateBezierPoint(e,t){const i=t.length-1;let r=0,s=0;for(let o=0;o<=i;o++){const a=this.binomialCoefficient(i,o),l=Math.pow(1-e,i-o)*Math.pow(e,o);r+=a*l*t[o].x,s+=a*l*t[o].y}return{x:r,y:s}}binomialCoefficient(e,t){let i=1;for(let r=e-t+1;r<=e;r++)i*=r;for(let r=1;r<=t;r++)i/=r;return i}calculateDistance(e,t){const i=e.x-t.x,r=e.y-t.y;return Math.sqrt(i*i+r*r)}}class b4 extends h7{constructor(t,i){super(t,i);E(this,"hover");E(this,"recordHistoryLog",!1);E(this,"mouseDownPosition");E(this,"tempSelectedDisplays",[]);E(this,"displayMoveActive",!1);E(this,"selectedOffsetMap",new Map);this.mode=wi.EDITOR}onViewportPointerDown(t){var o;const i=window.TouchEvent&&t.data.originalEvent instanceof TouchEvent;if(i){const a=((o=this.adsorptionPosition)==null?void 0:o.clone())||t.data.getLocalPosition(this.viewport);this.resetHoverStatus(),this.hitCheck(a,t.data.button===2,!i)}const{viewport:r}=this,{shiftKey:s}=t.data.originalEvent;if(this.mouseDownPosition=t.data.global.clone(),!r.isDragMode)if(t.target!==r){let a=null;t.target instanceof ky&&(a=this.addPointOnBezierLine()),a=a??t.target,this.selectedDisplays.length===0||this.selectedDisplays.indexOf(a)===-1?s&&this.selectedDisplays.every(({type:c})=>c!==it.CONTROL_POINT)&&a.type!==it.CONTROL_POINT?this.selectedDisplays=[...this.selectedDisplays,a]:this.selectedDisplays=a:a.type===it.CONTROL_POINT?(this.tempSelectedDisplays=this.selectedDisplays,this.selectedDisplays=a):s&&this.selectedDisplays.indexOf(a)!==-1?this.tempSelectedDisplays=this.selectedDisplays.filter(({id:c})=>a.id!==c):this.tempSelectedDisplays=[a],this.displayMoveActive=!0,this.curClickGraphicTag=a.name,this.calSelectedOffsetToClickGraphic();const l=this.pointGraphicMap.get(a==null?void 0:a.name);l&&(this.emitSelectedChangedEvent(),this.emitDataToGuideLine({selected:[l],excludeDisplay:this.selectedDisplays.filter(({name:c})=>c!==l.name)})),this.delta=this.calDeltaToSelected(t.data.getLocalPosition(r),this.selectedDisplays)}else this.selectedDisplays=[],this.displayMoveActive=!1,this.delta={x:0,y:0},this.curClickGraphicTag=null}onViewportPointerMove(t){var u;const{viewport:i}=this,{data:{originalEvent:r}}=t;if(i.isDragMode){this.resetHoverStatus();return}const s=((u=this.adsorptionPosition)==null?void 0:u.clone())||t.data.getLocalPosition(i);let o=0;this.mouseDownPosition&&(o=Dd(this.mouseDownPosition,this.viewport.toGlobal(s)));let a=!1;if((!(r instanceof TouchEvent)||Math.abs(o)>15)&&(a=this.moveSelectedDisplays(s)),this.adsorptionPosition=null,a){this.resetHoverStatus(),this.recordHistoryLog=!0,this.tempSelectedDisplays=[...this.selectedDisplays],this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.CHANGE_CURSOR,data:{type:"vectorMove"}});return}const l=t.target;if(this.isSelecting||!(l instanceof ky)){let h="default";l instanceof _p&&(h="vectorMove"),this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.CHANGE_CURSOR,data:{type:h}}),this.resetHoverStatus();return}this.resetHoverStatus();const c=window.TouchEvent&&t.data.originalEvent instanceof TouchEvent;this.hitCheck(s,t.data.button===2,!c)}hitCheck(t,i,r=!0){const s=this.getHitElementInLayer(t,i),{display:o,points:a}=s,l=o&&(a==null?void 0:a.length)>0;let c="default";if(l){c="vectorPointAdd";const u=o;this.hover.lineGraphic=u;const h=a[0],d=this.drawPointGraphic({id:gR,position:h,effectData:null});d.visible=!1,d.interactive=!1,this.hover.pointGraphic=d,r&&(u.highlightBound(),d.visible=!0)}this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.CHANGE_CURSOR,data:{type:c}})}onViewportPointerUp(t){const i=this.triggerOverlap(t.data.global);this.recordHistoryLog&&this.recordOnViewportUp(i),this.resizeTag(),this.tempSelectedDisplays.length!==0&&(this.selectedDisplays=this.tempSelectedDisplays,this.tempSelectedDisplays=[]),setTimeout(()=>{this.isHitEndpointOnUnclosedPath()},100)}onViewportDoubleClick(){this.onEsc()}triggerOverlap(t){let i=[];if(this.selectedDisplays.length===1&&this.mouseDownPosition){const r=Dd(this.mouseDownPosition,t);if(Math.abs(r)>5){const s=this.mergeOverlappingPoint();i=We(s,"overlappingPointNode",[]),i.length>0&&this.emit(at.MESSAGE_TO_MANAGER,{eventName:gp.EVENT_TRACKING,data:{eventName:"fusionNode"}})}}return i}resizeTag(){this.displayMoveActive=!1,this.curClickGraphicTag=null,this.mouseDownPosition=null,this.recordHistoryLog=!1,this.delta={x:0,y:0}}recordOnViewportUp(t){const i={};this.selectedDisplays.forEach(s=>{var c,u,h,d;const{node:o}=s.effectData,a=(u=(c=o.prev)==null?void 0:c.value)==null?void 0:u.id,l=(d=(h=o.next)==null?void 0:h.value)==null?void 0:d.id;i[o.value.id]={prevNodeTag:a,nextNodeTag:l,headTag:o.value.otherData.linkListIdx.head.value.id,data:s.effectData.node.value}});const r={};t.forEach(s=>{const o=s.data.id;r[o]=s,delete i[o]}),this.recordOperationLog({action:Xn.UPDATE,data:{activeNodeTags:this.selectedDisplays.map(s=>{if(s.type===it.ANCHOR_POINT)return s.name;{const o=s.name;return`${s.effectData.node.value.id}_${o}`}}),updateNodes:i,mergedNodes:r}})}calSelectedOffsetToClickGraphic(){this.selectedOffsetMap=new Map;const t=this.pointGraphicMap.get(this.curClickGraphicTag);this.selectedDisplays.forEach(i=>{if(i.name!==this.curClickGraphicTag){const r={x:i.x-t.x,y:i.y-t.y};this.selectedOffsetMap.set(i.name,r)}})}getHitElement(t,i){let r;return this.plugin.once(at.MESSAGE_TO_PLUGIN,({eventName:s,element:o})=>{s===xi.HIT_ELEMENT&&(r=o)}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.HIT_ELEMENT,data:{point:t,rightClick:i}}),r}getOriginalPoints(t){const{geometry:{graphicsData:i}}=t;let r=[];return i.forEach(s=>{const{points:o=[]}=s;r=r.concat(o.slice(0))}),r}getHitElementInLayer(t,i){const r=this.getHitElement(t,i),s={};if(r){s.display=r;const o=r instanceof ky?r.getPoints(this.viewport.scale.x):this.getOriginalPoints(r);s.points=o.map((a,l)=>l%2?null:new Ae(o[l],o[l+1])).filter(Boolean),s.points=this.calNearlyPoint(t,s.points)}return s}calNearlyPoint(t,i,r=10){if(i.length===2){const{x:s,y:o,distance:a}=oSe(t,i[0],i[1]);if(a<r)return[new Ae(s,o)]}else{let s=null,o=1/0;for(let a=0;a<i.length;a++){const l=i[a],c=Math.abs(Math.sqrt(Math.pow(l.x-t.x,2)+Math.pow(l.y-t.y,2)));c<r&&c<o&&(s=l,o=c)}return[s].filter(Boolean)}return[]}beforeExit(t,i={willRecord:!0,saveChanged:!0}){this.emit(at.MESSAGE_TO_MANAGER,{eventName:Kl.SELECT,data:[]});const r=this.saveEditObject(t,i);if(!(i!=null&&i.willRecord))return;const s=this.recordExitVectorOperator();this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ho.RECORD,data:{props:s,objs:r?[r]:null,ignoreSelected:!r}})}onEsc(t){if(t!=null&&t.isHotKey&&this.selectedDisplays.length>0){this.selectedDisplays=[];return}this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:null,options:{saveChanged:!0,willRecord:!0}}})}changeSelectedPointType(t,i=!0){var s;const r=[];(s=this.selectedDisplays)==null||s.forEach(o=>{this.changeAnchorType(o,t),r.push(this.pointGraphicMap.get(o.effectData.node.value.id))}),this.selectedDisplays=r,i&&this.recordSelectedPointsTypeChanged(),this.emitSelectedChangedEvent(),this.emitDataToGuideLine({selected:this.options.mode===wi.EDITOR?this.selectedDisplays:[this.pointGraphicMap.get(jr)]})}handleUndoDeleteAction(t){const i=Fr(t,"headTag");this.insertNodesToLinkLists(this.pointLinkList,Object.keys(i).map(r=>i[r]))}handleUndoAddAction(t,i){let r=null;const s=t.map(c=>{if(c.indexOf("_")!==-1){const[u,h]=c.split("_"),d=this.cpGraphicsMap.get(u)[h];return r=r||[We(d,"value.id")],d}else{const u=this.pointGraphicMap.get(c);return r=r||[We(u,"prev.value.id")||We(u,"next.value.id")],u}}),{prev:o,next:a}=s[0].effectData.node;Object.assign(o.value,Bo(i,c=>c.data.id===o.value.id).data),Object.assign(a.value,Bo(i,c=>c.data.id===a.value.id).data),this.selectedDisplays=[];const l=[s[0].effectData.node.prev.value.id];return this.removePointGraphics(s,!1,!0),l}handleUndoUpdateAction(t,i,r){if(this.selectedDisplays=[],t&&Object.keys(t).length>0){const s=Object.values(t).map(o=>{const a=Bo(i,c=>c.data.id===o.data.id),l=gr(a.data,["position","controlPoints"]);return Object.assign(o.data,{...l}),o});this.handleUndoDeleteAction(s)}this.updateNodeByLog(r,{updateIndicator:!1})}handleRedoDeleteAction(t){let i;const r=t.map(s=>{if(s.indexOf("_")!==-1){const[o,a]=s.split("_"),l=this.cpGraphicsMap.get(o)[a];return i=i||[We(l,"value.id")],l}else{const o=this.pointGraphicMap.get(s);return i=i||[We(o,"prev.value.id")||We(o,"next.value.id")],o}});return this.removePointGraphics(r,!1,!0,!1),i.filter(Boolean)}handleRedoAddAction(t,i){i=pn(i);const r=Fr(Object.values(t),"headTag");this.insertNodesToLinkLists(this.pointLinkList,Object.keys(r).map(a=>r[a]));const s=this.pointGraphicMap.get(i[0]),o=We(s,"effectData.node.prev.value.id");this.updatePointStatus(s,!0),o&&this.updatePointStatus(this.pointGraphicMap.get(o),!1)}handleRedoUpdateAction(t,i){t&&Object.keys(t).length>0&&this.handleRedoDeleteAction(Object.keys(t)),this.selectedDisplays=[],this.updateNodeByLog(Object.values(i),{updateIndicator:!0}),this.pointLinkList.forEach(r=>{r.length===1&&(r.head.next=r.end,r.end.prev=r.head)})}recordOperationLog(t){const i=We(t,"action"),r=We(t,"data.updateNodes",{}),s=We(t,"data.activeNodeTags"),o=We(t,"data.mergedNodes",{}),a={};Object.keys(r).forEach(u=>{a[u]={...r[u],data:this.cloneNode(r[u].data)}});const l={};Object.keys(o).forEach(u=>{l[u]={...o[u],data:this.cloneNode(o[u].data)}});const c=function(u){return{action:i,updateNodes:a,mergedNodes:l,activeNodeTags:s,onUndo:h=>{const d=u.curSubEditMode.curPlugin.vectorOperator,{redoStack:f,undoStack:p}=h,g=f[f.length-1];let{activeNodeTags:m}=g;const{action:v,updateNodes:_,activeNodeTags:y,mergedNodes:A}=g;let w;v===Xn.ADD?w=Object.keys(_).filter(C=>!y.includes(C)):w=pn(g.activeNodeTags);const b=d.findDisplayRecentRecord(v===Xn.DELETE?f:p,w);if(v===Xn.DELETE)d.handleUndoDeleteAction(b);else if(v===Xn.ADD)m=d.handleUndoAddAction(m,b);else if(v===Xn.MODEL_EXCHANGE)d.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:{mode:wi.EDITOR,willRecord:!1}}});else{const C=d.findDisplayRecentRecord(p,Object.keys(A));d.handleUndoUpdateAction(A,C,b)}u.curSubEditMode.curPlugin.vectorOperator.selectedDisplays=m.map(C=>{if(C.indexOf("_")!==-1){const[I]=C.split("_");return d.pointGraphicMap.get(I)}return d.pointGraphicMap.get(C)})},onRedo:h=>{const{undoStack:d}=h,f=d[d.length-1],{activeNodeTags:p,mergedNodes:g,updateNodes:m}=f;let v=null;const _=u.curSubEditMode.curPlugin.vectorOperator,{action:y}=f;y===Xn.DELETE?v=_.handleRedoDeleteAction(p):y===Xn.ADD?_.handleRedoAddAction(m,p):y===Xn.MODEL_EXCHANGE?_.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:{mode:wi.ADD,willRecord:!1,selectedIds:p}}}):_.handleRedoUpdateAction(g,m),y!==Xn.MODEL_EXCHANGE?_.selectedDisplays=(v||p).map(A=>{if(A.indexOf("_")!==-1){const[w]=A.split("_");return _.pointGraphicMap.get(w)}return _.pointGraphicMap.get(A)}):u.curSubEditMode.curPlugin.vectorOperator.selectedDisplays=p.map(A=>{if(A.indexOf("_")!==-1){const[w]=A.split("_");return _.pointGraphicMap.get(w)}return _.pointGraphicMap.get(A)})}}};this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ho.RECORD,data:{props:c,ignoreSelected:!0}})}onPointDoubleClick(t){const r=t.target.effectData.node,{cpType:s}=r.value;let o;s!==di.MIRROR_ANGLE_AND_LENGTH?(this.changeSelectedPointType(di.MIRROR_ANGLE_AND_LENGTH),o=di.MIRROR_ANGLE_AND_LENGTH):(this.removeCPointGraphics(r),this.recordSelectedPointsTypeChanged(),o=di.STRAIGHT),this.emit(at.MESSAGE_TO_MANAGER,{eventName:gp.EVENT_TRACKING,data:{eventName:"anchorTypeChanged",type:o}})}initView(){super.initView();const{willRecord:t,activeNodeTags:i=[]}=this.options||{};let r=[];if(i.length===0&&this.pointLinkList.length>0&&(!this.selectedDisplays||this.selectedDisplays.length===0)||(r=i.map(o=>this.pointGraphicMap.get(o))),this.selectedDisplays=r,t){const s=this.recordEnterVectorOperator();this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ho.RECORD,data:{props:s,objs:[this.options.display]}})}}activePointGraphic(t){this.selectedDisplays=[...t]}clearTempStatus(){this.selectedDisplays=[]}updateSelectedDisplays(t){t=Array.isArray(t)?t:[t];const i=t.filter(r=>r.type===it.ANCHOR_POINT);this.selectedDisplays=i}recordEnterVectorOperator(){const t={};return Array.from(this.pointGraphicMap.values()||[]).forEach(i=>{var s,o,a,l,c,u,h,d;const{node:r}=i.effectData;t[r.value.id]={data:this.cloneNode(r.value),prevNodeTag:(o=(s=r.prev)==null?void 0:s.value)==null?void 0:o.id,nextNodeTag:(l=(a=r.next)==null?void 0:a.value)==null?void 0:l.id,headTag:(d=(h=(u=(c=r.value.otherData)==null?void 0:c.linkListIdx)==null?void 0:u.head)==null?void 0:h.value)==null?void 0:d.id}}),{action:Xn.ENTER_VECTOR_EDIT,activeNodeTags:this.selectedDisplays.map(i=>i.effectData.node.value.id),contours:pn(this.options.pathPoints.contours),updateNodes:t,onUndo:()=>{this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:null,options:{saveChanged:!1}}})},onRedo:i=>{const{undoStack:r}=i,{activeNodeTags:s,curIDs:o,contours:a}=r[r.length-1],l=qD(this.viewport.displayLayer,{key:"id",value:Array.from(o||[])[0]}),c=new Ry;c.contours=pn(a);const u={mode:wi.EDITOR,display:l,activeNodeTags:s,willRecord:!1,needTransform:!1,pathPoints:c};return this.emit(at.MESSAGE_TO_MANAGER,{eventName:Ns.UPDATE_SUB_EDIT_MODE,data:{mode:Xi.VECTOR_EDITOR,options:u}}),{skipRedraw:!0}}}}combinePairs(t,i=2){const r=[];for(;t.length;)r.push(t.splice(0,i));return r}exchangeModel(t,i){super.exchangeModel(t,i),this.saveEditObject(t,{saveChanged:!1})}addPointOnBezierLine(){var t,i,r,s;if((t=this.hover)!=null&&t.pointGraphic){const o=(i=this.hover)==null?void 0:i.lineGraphic.name,a=new Ae((r=this.hover)==null?void 0:r.pointGraphic.x,(s=this.hover)==null?void 0:s.pointGraphic.y),l=o.split("_"),c=this.pointGraphicMap.get(l[0]),h=this.pointGraphicMap.get(l[1]).effectData.node,d=c.effectData.node,f=this.combinePairs(this.hover.lineGraphic.geometry.points,2),p=We(h,"value.controlPoints[1]"),g=We(d,"value.controlPoints[0]"),m={id:Ui(),position:a,otherData:{linkListIdx:d.value.otherData.linkListIdx}},v={};if(!(!p&&!g)){const b={x:f[0][0],y:f[0][1]},C={x:f[f.length-1][0],y:f[f.length-1][1]},I=[b,p,g,C].filter(Boolean),x=new MDe().calControlPOfNodeAdd(I,a);p&&g?(h.value.controlPoints[1]=x[0][0],d.value.controlPoints[0]=x[0][2]):p?(h.value.controlPoints[1]=null,h.value.cpType=di.NO_MIRRORING):(d.value.controlPoints[0]=null,d.value.cpType=di.NO_MIRRORING),Object.assign(m,{controlPoints:pn(x[x.length-2]),cpIds:[Ui(),Ui()],cpType:di.MIRROR_ANGLE_AND_LENGTH})}const y=Ba.createNode(m),A=d.value.otherData.linkListIdx;return A.insertPrev(d,y),this.resetHoverStatus(),this.lineGraphics.get(o).destroy(),this.lineGraphics.delete(o),this.reDrawAnchorPoint(y,!1),Object.assign(v,{[m.id]:{prevNodeTag:We(y,"prev.value.id"),nextNodeTag:We(y,"next.value.id"),headTag:A.head.value.id,data:this.cloneNode(y.value)}},{[h.value.id]:{prevNodeTag:We(h,"prev.value.id"),nextNodeTag:We(h,"next.value.id"),headTag:h.value.otherData.linkListIdx.head.value.id,data:this.cloneNode(h.value)},[d.value.id]:{prevNodeTag:We(d,"prev.value.id"),nextNodeTag:We(d,"next.value.id"),headTag:d.value.otherData.linkListIdx.head.value.id,data:this.cloneNode(d.value)}}),this.recordOperationLog({action:Xn.ADD,data:{activeNodeTags:[m.id],updateNodes:v}}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:gp.EVENT_TRACKING,data:{eventName:"addNode"}}),this.pointGraphicMap.get(y.value.id)}return null}prepare(t){Array.from(this.pointGraphicMap.values()||[]).forEach(r=>{r.on(ji.DOUBLE_CLICK,this.onPointDoubleClick.bind(this))}),this.selectedDisplays=(t||[]).map(r=>this.pointGraphicMap.get(r))}removeSelectedGraphics(){!this.selectedDisplays||this.selectedDisplays.length===0||this.removePointGraphics(this.selectedDisplays)}moveSelectedDisplays(t){if(this.selectedDisplays.length!==0&&this.displayMoveActive){const i=this.selectedDisplays.length===1&&this.selectedDisplays[0].type===it.CONTROL_POINT;return this.translatePointGraphics(this.selectedDisplays,t),i?this.selectedDisplays.forEach(r=>{this.updateControlNodeData(r)}):this.selectedDisplays.forEach(r=>{const s=r.effectData.node;this.updateAnchorNodeData(r),this.reDrawAnchorPoint(s)}),!0}else return!1}elementsToGuidelinePlugin(t={}){var c;const i=We(t,"selected",null)||this.selectedDisplays;let r=We(t,"unSelected",null);const s=We(t,"excludeDisplay",[]);r=this.getInteractElement(ll.TEMP_LAYER).filter(u=>u.type===it.ANCHOR_POINT&&![...i,...s].map(h=>h.id).includes(u.id));const a=(c=this.options)==null?void 0:c.display,l=this.getInteractElement(ll.DISPLAY_LAYER);return{selected:i,unSelected:r,extraElements:l.filter(({id:u})=>u!==(a==null?void 0:a.id))}}translatePointGraphics(t,i){let r;if(t.length===1){const s=t[0];s.position=i.clone()}else{const s=this.pointGraphicMap.get(this.curClickGraphicTag);s.position=i.clone(),t.forEach(o=>{if(o.name!==this.curClickGraphicTag){const a=this.selectedOffsetMap.get(o.name);o.position={x:s.position.x+a.x,y:s.position.y+a.y}}})}return r}resetHoverStatus(){var o,a,l,c;const t=(a=(o=this.hover)==null?void 0:o.lineGraphic)==null?void 0:a.name,i=this.lineGraphics.get(t);i==null||i.setLineMode();const r=(c=(l=this.hover)==null?void 0:l.pointGraphic)==null?void 0:c.name,s=this.pointGraphicMap.get(r);s==null||s.destroy(),this.pointGraphicMap.delete(gR),this.hover={}}clearContainer(){super.clearContainer(),this.selectedDisplays={data:[],options:{ignoreEmitSelected:!0}}}destroy(){var t;super.destroy(),(t=this.options)!=null&&t.display&&(this.options.display.visible=!0)}drawAuxiliaryGraphics(t){}}const Vu={showAuxiliaryGraphic:!0,circleAnchorConf:{radius:5,hitArea:5},rectAnchorConf:{w:8,h:8,hitAreaW:8,hitAreaH:8}};class d7 extends Zr{constructor(t){super();E(this,"name",Jxe);E(this,"type",cb);E(this,"options");this.options=t}get vectorOperator(){const t=Symbol.for("vectorOperator");return this[t]}set vectorOperator(t){var r;const i=Symbol.for("vectorOperator");((r=this[i])==null?void 0:r.mode)!==(t==null?void 0:t.mode)&&(this[i]=t,this.setupVectorOperatorEvent())}init(t){var s,o;const i=this.getCurLayerColor();this.options.layerColor=i;const{mode:r=wi.EDITOR}=this.options;r===wi.EDITOR?((s=this.options)!=null&&s.pathPoints||(this.options=this.getEditorRequestOptions(this.options)),this.vectorOperator=new b4(this,this.options)):this.vectorOperator=new A4(this,this.options),this.switchToEditMode(),this.vectorOperator.viewport=t,t.displayLayer.interactiveChildren=!1,this.vectorOperator.pointLinkList=this.vectorOperator.init((o=this.vectorOperator.options.pathPoints)==null?void 0:o.contours),console.log("[  插件初始化] >",this.vectorOperator.pointLinkList)}switchToEditMode(){this.onUpdateNormalMode(this.getCorrespondEditMode())}getCurLayerColor(){let t;return this.once(at.MESSAGE_TO_PLUGIN,({eventName:i,result:r})=>{i===xi.CUR_LAYER_CONFIG&&(t=r.layerColor.replace("#","0x"))}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.CUR_LAYER_CONFIG,data:{attrs:["layerColor"]}}),t}getCorrespondEditMode(){const t=this.vectorOperator.mode;return{[wi.ADD]:Vt.PEN,[wi.EDITOR]:Vt.SELECT}[t]}onUpdateNormalMode(t){this.emit(at.MESSAGE_TO_MANAGER,{eventName:Xa.UPDATE_EDIT_MODE,data:{mode:t}}),console.log("[ mode ] >",t)}initViewportDisplay(){var r;const t=We(this.vectorOperator,"options.display");t&&(t.alpha=0);const i=new mn;return this.vectorOperator.container=i,i.name="VectorPlugin",i.sortableChildren=!0,(r=this.vectorOperator)==null||r.initView(),{display:this.vectorOperator.container,targetContainer:"tempLayer"}}removeSelectedGraphics(){this.vectorOperator.removeSelectedGraphics()}getEditorRequestOptions(t){const i=t==null?void 0:t.display;let r;if(pi(i)?r=this.callMainQueryObject(i):r=i,!r)return null;const s=r.toPathData(),o=s==null?void 0:s.toPathEditData();return{...this.options,pathPoints:o,display:r,mode:wi.EDITOR,needTransform:!0,willRecord:!0}}callMainQueryObject(t){let i;return this.once(at.MESSAGE_TO_PLUGIN,({eventName:r,result:s})=>{r===vo.QUERY&&(i=s)}),this.emit(at.MESSAGE_TO_MAIN,{eventName:vo.QUERY,data:{targets:[t]}}),i?[...i.getKey(t)][0]:null}onViewportScale(t){[...Array.from(this.vectorOperator.pointGraphicMap.values()),...b8(Array.from(this.vectorOperator.cpGraphicsMap.values()).map(i=>Object.values(i))).filter(i=>i instanceof _p)].forEach(i=>{i.scale.x=1/t.scaled,i.scale.y=1/t.scaled})}onViewportPointerDown(t){this.vectorOperator.onViewportPointerDown(t)}onViewportPointerMove(t){this.vectorOperator.onViewportPointerMove(t)}onViewportPointerUp(t){this.vectorOperator.onViewportPointerUp(t)}onViewportPointerupoutside(t){this.onViewportPointerUp(t)}onViewportPointerCancel(){this.onViewportPointerUp()}onViewportDoubleClick(){this.vectorOperator.onViewportDoubleClick()}getEditorOriginDisplay(){var t;return(t=this.vectorOperator.options)==null?void 0:t.display}generatePath(){return this.vectorOperator.generatePath()}vectorOperatorModel(){return this.vectorOperator.mode}align(t){this.vectorOperator.align(t)}exchangeModel(t){let i=this.vectorOperatorModel()===wi.ADD?wi.EDITOR:wi.ADD;i=(t==null?void 0:t.mode)||i;let r;i===wi.EDITOR?r=new b4(this,t):r=new A4(this,t),this.vectorOperator.exchangeModel(this,r),this.vectorOperator=r,this.vectorOperator.prepare(t==null?void 0:t.selectedIds)}setAdsorptionPosition(t){this.vectorOperator.setAdsorptionPosition(t)}translateSelected(t,i){const r=We(i,"displays",this.vectorOperator.selectedDisplays);this.vectorOperator.translateDisplays(t,{...i,displays:r})}updateDisplayObjectsAttributes(t,i){const r=We(i,"displays",this.vectorOperator.selectedDisplays);this.vectorOperator.updateDisplayObjectsAttributes(t,{...i,displays:r},{willRecord:!0})}setupVectorOperatorEvent(){this.vectorOperator.on(at.MESSAGE_TO_MANAGER,t=>{this.emit(at.MESSAGE_TO_MANAGER,t)})}selectingElements(t){this.vectorOperator.selectingElements(t)}onMessage(t){switch(t.eventName){case Gc.SELECT_ATTR_CHANGED:const i=We(t,"data.attrs");this.setAdsorptionPosition(new Ae(i.x,i.y));break;case Lc.UPDATE_INTERNAL_DATA:const r=this.vectorOperator.elementsToGuidelinePlugin();this.emit(at.MESSAGE_TO_PLUGIN,{eventName:Gl.TOGGLE_MODEL,data:{model:Ec.VECTOR_EDITOR,guideLineTriggerModel:this.vectorOperator.mode===wi.ADD?Ad.HOVER:Ad.DOWN,...r}});break}}onEsc(t){this.vectorOperator.onEsc(t)}beforeExit(t){this.vectorOperator.beforeExit(this,t)}destroy(){const t=We(this.vectorOperator,"options.display");t&&(t.alpha=1),this.vectorOperator.viewport.displayLayer.interactiveChildren=!0,this.vectorOperator.destroy()}}class f7 extends c7{constructor(e){super(e),this.selectScope=ll.TEMP_LAYER}setSelected(e){e=e.filter(i=>i.type===it.ANCHOR_POINT).filter(Boolean),super.setSelected(e);const t=this.findCurActiveLinkList();this.selectedPointOnActiveLinkList(e,t)}findCurActiveLinkList(){const t=this.curPlugin.vectorOperator.selectedDisplays??[],i=new Set;return t.forEach(r=>{i.add(this.getLinkListByAnchor(r))}),Array.from(i).filter(Boolean)}selectedPointOnActiveLinkList(e,t){const i=this.curPlugin.vectorOperator;t.length!==0&&(e=e.filter(r=>t.indexOf(this.getLinkListByAnchor(r))!==-1)),i.selectedDisplays=e}getLinkListByAnchor(e){return We(e,"effectData.node.value.otherData.linkListIdx",null)}updateAnchorType(e){this.curPlugin.vectorOperator.changeSelectedPointType(e)}startMode(e){var r,s,o,a;const t=!!this.curPlugin,i=((s=(r=this.curPlugin)==null?void 0:r.vectorOperator)==null?void 0:s.mode)===(e==null?void 0:e.mode);if(t){if(i)return;this.curPlugin.exchangeModel(e)}else{const l=new d7(e);this.curPlugin=l,this.setupPluginToManagerEvents()}this.emit(at.MESSAGE_TO_MANAGER,{eventName:$p.CHANGE_VISIBLE,data:!1}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Rd.REGISTER,data:{plugins:this.curPlugin}}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Lc.UPDATE_INTERNAL_DATA}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.DISPLAY_LAYER_TRANSLUCENT,data:{translucent:!0,excludes:[(a=(o=this.curPlugin)==null?void 0:o.options)==null?void 0:a.display].filter(Boolean)}})}updateMode(e){var i,r;((r=(i=this.curPlugin)==null?void 0:i.vectorOperator)==null?void 0:r.mode)!==(e==null?void 0:e.mode)&&(this.curPlugin.exchangeModel(e),this.curPlugin.switchToEditMode(),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Lc.UPDATE_INTERNAL_DATA}))}endMode(e){this.emit(at.MESSAGE_TO_MANAGER,{eventName:$p.CHANGE_VISIBLE,data:!0}),this.curPlugin.beforeExit(e),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Rd.UNREGISTER,data:{plugins:this.curPlugin}}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Xa.BACK_TO_NORMAL_SELECT,data:{willRecord:!1,autoSelected:!0}}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Lc.UPDATE_INTERNAL_DATA}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.DISPLAY_LAYER_TRANSLUCENT,data:{translucent:!1}}),this.emit(at.MESSAGE_TO_MANAGER,{eventName:xi.CHANGE_CURSOR,data:{type:"default"}})}onEsc(e){this.curPlugin.onEsc&&this.curPlugin.onEsc(e)}removeSelected(){this.curPlugin.vectorOperator.removeSelectedGraphics()}setupVectorPluginEvent(){}updateModeConfig(e){this.modeConfig={...this.modeConfig,...e}}}class A1{constructor(e){E(this,"_target");E(this,"_metrics");this._target=e,this._metrics=an.measureTextDisplay(this._target)}get metrics(){return this._metrics}getChar(e){for(const t of this.iterateCharHandles())if(t.charIndex===e)return t.value;return null}*iterateLineHandles(e){const i=this._metrics.lineMetrics;for(let r=0;r<i.length;r++){const s=i[r];((e==null?void 0:e(s,r))??!0)&&(yield{lineIndex:r,line:s,value:s})}}*iterateCharHandles(e){const{lineFilter:t,charFilter:i}=e??{};let r=0;for(const{lineIndex:s,line:o}of this.iterateLineHandles(t)){const a=Object.values(o.charMetrics);let l=0;for(;l<a.length;l++){const c=a[l];r=c.index,((i==null?void 0:i(c,r))??!0)&&(yield{lineIndex:s,colIndex:l,charIndex:r,char:c,value:c})}}}}const Mo={selectionDirectionMode:"with-none",selectionFillStyle:{color:51200,alpha:.2},textCursorLineStyle:{width:1,color:0,native:!0},textBoundsLineStyle:{width:1,native:!0,color:33143,alpha:1},textCursorAnimationInterval:500,recordInputDelay:500,initialSelectionWhenCreate:"all",initialSelectionWhenUpdate:"end",aligmentWhenCreate:"bbox-lt",textAreaRelativeParent:".m-canvas-container",textAreaClassName:"text-edit",textAreaStyleCssText:`
    position: fixed;
    left: 0;
    top: 0;
    white-space: nowrap;
    text-align: center;
    resize: none;
    width: 0.1px;
    height: 0.1px;
    opacity: 0;
  `};var tE;(function(n){n.START_EDIT="TEXT_EDIT_START_EDIT",n.END_EDIT="TEXT_EDIT_END_EDIT"})(tE||(tE={}));var Sn;class RDe extends Zr{constructor(){super();E(this,"name","textEditPlugin");E(this,"type",cb);E(this,"viewport");E(this,"transformer");ke(this,Sn,void 0);E(this,"mode");E(this,"_selectionStart",0);E(this,"_selectionEnd",0);E(this,"selectionDirection");E(this,"display");E(this,"textMetrics");E(this,"renderDirty",0);E(this,"textAreaEl");E(this,"_pointerDown",!1);E(this,"_pointerDrag",!1);E(this,"_dragStartCharIndex",0);E(this,"_cached",{});E(this,"_willEndByEscapeKey",!1);E(this,"_willRecordInput",!1);E(this,"_debouncedRecordInput");E(this,"_debouncedUpdateTextAreaPos");E(this,"_hitEndEdit");this._debouncedRecordInput=Fc(()=>{this._willRecordInput&&(this._willRecordInput=!1,this._recordInput())},Mo.recordInputDelay),this._debouncedUpdateTextAreaPos=Fc(()=>{this.updateTextAreaElPos()})}get selectionStart(){return this._selectionStart}set selectionStart(t){this._selectionStart=t}get selectionEnd(){return this._selectionEnd}set selectionEnd(t){this._selectionEnd=t}get directionMode(){return Mo.selectionDirectionMode}get value(){var t;return((t=S(this,Sn))==null?void 0:t.text)??""}get activeTarget(){return S(this,Sn)}get dragging(){return this._pointerDrag}get targetTransform(){var t;return(t=S(this,Sn))==null?void 0:t.localTransform}init(t,i){this.viewport=t,this.transformer=i,this.initTextArea()}_callMain(t){this.emit(at.MESSAGE_TO_MAIN,t)}_callMainQueryObject(t){let i;return this.once(at.MESSAGE_TO_PLUGIN,({eventName:r,result:s})=>{r===vo.QUERY&&(i=s)}),this.emit(at.MESSAGE_TO_MAIN,{eventName:vo.QUERY,data:{targets:[t]}}),i?[...i.getKey(t)][0]:null}onMessage(t){const{eventName:i,data:r}=t;switch(i){case tE.START_EDIT:this.startTextEditModeAction(r.options);break;case tE.END_EDIT:this.endTextEditModeAction(r.options);break}}startTextEditModeAction(t){console.log("%c[ Text Edit ] start (at main)","color: green; font-weight: bold; opacity: 0.7",t);const{target:i,globalPoint:r}=t;let s,o;if(typeof i=="string"?(o=i,s=this._callMainQueryObject(o)):s=i,!s){const a=r?this.viewport.toLocal(r):new Ae(0,0);if(this.once(at.MESSAGE_TO_PLUGIN,({eventName:l,result:c})=>{l===vo.CREATE&&(s=c)}),this.emit(at.MESSAGE_TO_MAIN,{eventName:vo.CREATE,data:{withLayerTag:!0,params:{type:it.TEXT,options:{x:a.x,y:a.y}}}}),!s)return}o&&(s.id=o),(t==null?void 0:t.type)==="create"&&this.emit(at.MESSAGE_TO_MAIN,{eventName:xi.ADD_CHILD,data:{type:Fo.VIEWPORT,objs:[s],options:{autoSelected:!1}}}),this.emit(at.MESSAGE_TO_MAIN,{eventName:xi.ADD_CHILD,data:{type:Fo.TEMP_LAYER,objs:[s]}}),this.emit(at.MESSAGE_TO_MAIN,{eventName:$p.CHANGE_VISIBLE,data:!1}),this.emit(at.MESSAGE_TO_MAIN,{eventName:_A.CHANGE_VISIBLE,data:!1}),t={...t,target:s},this.startEditMode(t)}endTextEditModeAction(t){console.log("%c[ Text Edit ] end (at main)","color: maroon; font-weight: bold; opacity: 0.7",t);const i=this.endEditMode(t);if(i){const r=i.isVaild(),{autoSelected:s=!0}=t??{};if(this.emit(at.MESSAGE_TO_MAIN,{eventName:xi.ADD_CHILD,data:{type:Fo.VIEWPORT,objs:[i],options:{autoSelected:r&&s&&!this._hitEndEdit}}}),this._hitEndEdit){const{viewportPt:o,isRightButton:a}=this._hitEndEdit,l=this._getElementByPointerEvent({point:o,rightClick:a});this.emit(at.MESSAGE_TO_MAIN,{eventName:Kl.EXEC_SELECT,data:{obj:l??(!a&&r?i:null),withGroup:!!l}}),this._hitEndEdit=null}r||this.emit(at.MESSAGE_TO_MAIN,{eventName:vo.DESTROY,data:{objs:[i]}})}this.emit(at.MESSAGE_TO_MAIN,{eventName:$p.CHANGE_VISIBLE,data:!0}),this.emit(at.MESSAGE_TO_MAIN,{eventName:_A.CHANGE_VISIBLE,data:!0})}_getElementByPointerEvent(t){let i;return this.once(at.MESSAGE_TO_PLUGIN,({eventName:r,element:s})=>{r===xi.HIT_ELEMENT&&(i=s)}),this.emit(at.MESSAGE_TO_MAIN,{eventName:xi.HIT_ELEMENT,data:t}),i}initTextArea(){this.textAreaEl||(this.textAreaEl=document.createElement("textarea"),this.textAreaEl.classList.add(Mo.textAreaClassName),this.textAreaEl.classList.add("enableHotKey"),this.textAreaEl.style.cssText=Mo.textAreaStyleCssText,this.textAreaEl.setAttribute("tabindex","-1"),this.textAreaEl.addEventListener("keydown",t=>{t.code==="Escape"&&!t.isComposing&&(this._willEndByEscapeKey=!0)}),this.textAreaEl.addEventListener("keyup",t=>{t.code==="Escape"&&this._willEndByEscapeKey&&(this._willEndByEscapeKey=!1,setTimeout(()=>{this._callMain({eventName:Xa.BACK_TO_NORMAL_SELECT})}))}),document.addEventListener("selectionchange",()=>{S(this,Sn)&&document.activeElement===this.textAreaEl&&setTimeout(()=>{this._isEqualToTextareaSelection()||(this.selectionStart=this.textAreaEl.selectionStart,this.selectionEnd=this.textAreaEl.selectionEnd,this.selectionDirection=this.textAreaEl.selectionDirection,this.updateRender())})}),this.textAreaEl.addEventListener("beforeinput",t=>{new Set(["historyUndo","historyRedo","deleteByCut","insertFromPaste"]).has(t.inputType)&&t.preventDefault()}),this.textAreaEl.addEventListener("input",t=>{const r=t.target;S(this,Sn)&&r&&(this._updateText(r.value,r.selectionStart,r.selectionEnd),this._debouncedUpdateTextAreaPos())}))}_isEqualToTextareaSelection(t=this.selectionStart,i=this.selectionEnd,r=this.selectionDirection){return t===this.textAreaEl.selectionStart&&i===this.textAreaEl.selectionEnd&&r===this.textAreaEl.selectionDirection}_setTextareaElSelection(t,i,r){this._isEqualToTextareaSelection(t,i,r)||this.textAreaEl.setSelectionRange(t,i,r)}_mountTextArea(){const t=document.querySelector(Mo.textAreaContainer);t?t.appendChild(this.textAreaEl):(console.warn("[ TextEdit ] mount parent of textarea not found, fallback to use <body>"),document.body.appendChild(this.textAreaEl))}initViewportDisplay(){return this.display||(this.display=new DDe(this)),this.hideDisplay(),this.display}onViewportPointerDown(t){if(!S(this,Sn))return;if(t.target&&t.target===this.viewport){t.stopPropagation(),this._hitEndEdit={viewportPt:t.data.getLocalPosition(this.viewport),isRightButton:t.data.button===2},setTimeout(()=>{this._callMain({eventName:Xa.BACK_TO_NORMAL_SELECT})});return}if(this._pointerDown=!0,t.data.button===2)return;setTimeout(()=>{this.textAreaEl.focus()});const i=t.data.global,r=this.findCharIndexByPoint(i);if(!r)return;const{charIndex:s}=r;let{selectionStart:o,selectionEnd:a,selectionDirection:l}=this;t.data.originalEvent.shiftKey?this.directionMode==="with-none"?(Math.abs(s-this.selectionStart)<=Math.abs(s-this.selectionEnd)?o=s:a=s,l="none"):this.selectionDirection==="backward"?s<=a?(o=s,l="backward"):(a=s,l="forward"):this.selectionDirection==="forward"&&(s>=o?(a=s,l="forward"):(o=s,l="backward")):o=a=s,this.setSelection(o,a,l)}onViewportPointerMove(t,i){if(this._pointerDown)if(!this._pointerDrag)this._pointerDrag=!0,this._dragStartCharIndex=this.selectionStart,i&&(this._cached.viewport={cursor:i.cursor},i.cursor="text");else{if(!S(this,Sn))return;const r=t.data.global,s=this.findCharIndexByPoint(r);if(s){const{charIndex:o}=s;let a,l,c;o>this._dragStartCharIndex?(a=this._dragStartCharIndex,l=o,c="forward"):o<this._dragStartCharIndex?(a=o,l=this._dragStartCharIndex,c="backward"):a=l=o,this.setSelection(a,l,c)}}}onViewportPointerUp(){this._pointerDown=!1,this._pointerDrag&&(this._pointerDrag=!1,this._cached.viewport&&(this.viewport.updateCursor(this._cached.viewport.cursor),this._cached.viewport=null))}onViewportPointerupoutside(){this.onViewportPointerUp()}onViewportPointerCancel(){this.onViewportPointerUp()}_resolveSelectionTuple(t,i,r){let s;if(i||(i=t==="create"?Mo.initialSelectionWhenCreate:Mo.initialSelectionWhenUpdate),Array.isArray(i))s=i;else if(i==="start")s=[0];else if(i==="end")s=[this.value.length];else if(i==="all")s=[0,this.value.length];else if(i==="pointer"&&r){const o=this.findCharIndexByPoint(r);o&&(s=[o.charIndex])}return s}startEditMode(t){const{target:i,globalPoint:r=new Ae(0,0),type:s="update",willRecord:o=!0,selection:a}=t;if(!(i instanceof E2))return;console.log("%c[ Text Edit ] start","color: green; font-weight: bold",t),this.mode=s,Qe(this,Sn,i);const l=S(this,Sn);l.isEditing=!0,l.parentGroup=null,this.mode==="create"&&(this._alignText(l),this.emit(at.MESSAGE_TO_MAIN,{eventName:Kl.SELECT,data:[l]})),this._cached.text={cursor:S(this,Sn).cursor,visible:S(this,Sn).visible},S(this,Sn).visible=!0,S(this,Sn).cursor="text",this.textMetrics=new A1(S(this,Sn)),this._mountTextArea(),this.showDisplay(),this.textAreaEl.style.display="block",this.textAreaEl.focus(),this._syncTextAreaElToText(),setTimeout(()=>{this.textAreaEl.focus()},16.7);const c=this._resolveSelectionTuple(this.mode,a,r);c&&this.setSelection(c[0],c[1]),o&&this._callMain({eventName:Ho.RECORD,data:{objs:[S(this,Sn)],props:{cmd:"StartTextEdit",data:Object.freeze({willRecord:!1,autoSelected:!1,target:S(this,Sn).id,type:this.mode,globalPoint:r,selection:[this.selectionStart,this.selectionEnd],remarks:"By history"})}}}),this.display.glyphBoxes.on(ji.DOUBLE_CLICK,this._handleTextDoubleClick,this)}_handleTextDoubleClick(){this.setSelection(0,this.value.length)}_syncTextAreaElToText(){if(!S(this,Sn))return;const t=S(this,Sn);this.textAreaEl.value!==this.value&&(this.textAreaEl.value=this.value),this._setTextareaElSelection(this.selectionStart,this.selectionEnd,this.selectionDirection),this.textAreaEl.style["text-align"]=t.style.align}endEditMode(t){if(!S(this,Sn))return;const{willRecord:i=!0}=t??{};this._willRecordInput&&(this._willRecordInput=!1,this._recordInput());const r=S(this,Sn);return r&&(this.display.glyphBoxes.off(ji.DOUBLE_CLICK,this._handleTextDoubleClick),this._cached.text&&(r.cursor=this._cached.text.cursor,r.visible=this._cached.text.visible),this._cached.viewport&&this.viewport.updateCursor(this._cached.viewport.cursor),r.isEditing=!1),this._cached={},this.hideDisplay(),this.textAreaEl.value="",this.textAreaEl.blur(),this.textAreaEl.remove(),console.log("%c[ Text Edit ] end","color: maroon; font-weight: bold"),i&&this._callMain({eventName:Ho.RECORD,data:{objs:[r],props:{cmd:"EndTextEdit",data:Object.freeze({willRecord:!1,autoSelected:!1,target:r.id,type:this.mode,selection:[this.selectionStart,this.selectionEnd],remarks:"By history"})}}}),Qe(this,Sn,null),r}emitEvent(t){this.viewport.emit(t)}initEvents(){}findExactGlyphDisplayByPoint(t){return this.pointSearchByTextMetrics(t)}findNearestGlyph(t){var f,p,g,m;const i=S(this,Sn),r=i.toLocal(t);let s;if((f=i.curveInfo)!=null&&f.curveDir){if((g=(p=i.curveInfo)==null?void 0:p.linePaths)!=null&&g[0]){const v=i.curveInfo.linePaths[0],_=Dd(v.c,r);s=i.curveInfo.curveDir*(v.radius-_)+(i.curveInfo.glyphOffsetY??0)}}else s=r.y;const o=new Set;let a=-1,l=1/0;for(const{line:v,lineIndex:_}of this.textMetrics.iterateLineHandles())if(Fp(s)){v.emBox.contains(r)&&o.add(_);const y=wH(r,v.emBox.toPoints());y<l&&(l=y,a=_)}else{s>=v.straightEmBox.minY&&s<=v.straightEmBox.maxY&&o.add(_);const y=Math.min(Math.abs(s-v.straightEmBox.minY),Math.abs(s-v.straightEmBox.maxY));y<l&&(l=y,a=_)}!o.size&&a!==-1&&o.add(a);let c,u,h=1/0;const d=this.textMetrics.iterateCharHandles({lineFilter:(v,_)=>o.has(_)});for(const v of d){const{char:_}=v;if(_.emBox.contains(r)){c=v;break}else{const y=wH(r,_.emBox.toPoints());y<h&&(h=y,u=v)}}if(!c&&u&&(c=u),c){const{char:v,charIndex:_,lineIndex:y}=c,A=v.emBox.matrix.applyInverse(r),w=Math.abs(A.x-v.emBox.maxX)<Math.abs(A.x-v.emBox.minX);return{charIndex:w?_+(Fp((m=v.char)==null?void 0:m.length)?1:v.char.length):_,lineIndex:y,onRightSide:w}}return null}pointSearchByTextMetrics(t){const i=S(this,Sn).toLocal(t),r=this.textMetrics.iterateCharHandles({lineFilter:s=>s.emBox.contains(i)});for(const{char:s,charIndex:o,lineIndex:a}of r)if(s.emBox.contains(i)){const l=s.emBox.matrix.applyInverse(i),c=Math.abs(l.x-s.emBox.maxX)<Math.abs(l.x-s.emBox.minX);return{lineIndex:a,charIndex:c?o+1:o,onRightSide:c}}return null}onTransformerChange(){if(S(this,Sn)){if(this.textMetrics=new A1(S(this,Sn)),this.textAreaEl.value!==this.value){const t=this.value.length-this.textAreaEl.value.length;this.setSelection(this.selectionStart+t,this.selectionEnd+t,this.selectionDirection)}this._syncTextAreaElToText(),setTimeout(()=>{this.updateRender()})}}findCharIndexByPoint(t,i=!0){return i?this.findNearestGlyph(t):this.findExactGlyphDisplayByPoint(t)}setSelection(t,i=t,r){r=this._getValidSelectionDirection(r),this.selectionDirection!==r&&(this.selectionDirection=r),t<=i?(this.selectionStart=this.clampCharIndex(t,"start"),this.selectionEnd=this.clampCharIndex(i,"end")):(this.selectionStart=this.clampCharIndex(i,"start"),this.selectionEnd=this.clampCharIndex(t,"end")),this._setTextareaElSelection(this.selectionStart,this.selectionEnd,this.selectionDirection),this._debouncedUpdateTextAreaPos(),this.updateRender()}async _setTextValue(t){var i;if(!(!S(this,Sn)||typeof t!="string"||t===this.value))try{await an.preloadFontAndGlyphs([t],S(this,Sn).style)}finally{(i=S(this,Sn))==null||i.parseJSON({text:t.toString()}),setTimeout(()=>{this.transformer.emit(sr.TRANSFORM_CHANGE)}),this.textMetrics=new A1(S(this,Sn)),S(this,Sn).applyTextAnchorFixup(),this._willRecordInput=!0,this._debouncedRecordInput()}}_updateText(t,i,r){this.selectionStart=i,this.selectionEnd=r,this._setTextValue(t)}updateTextAreaElPos(){const t=this.getCursorBounds(),{minX:i,maxY:r}=t??{};this._moveTextAreaTo(i,r)}_moveTextAreaTo(t,i){const r=document.querySelector(Mo.textAreaRelativeParent);if(r){const s=r.getBoundingClientRect();t+=s.x,i+=s.y}this.textAreaEl.style.transform=`translate(${t}px,${i}px)`}showDisplay(){this.display.visible=!0}hideDisplay(){this.display.visible=!1}updateRender(){const t={};t.cursor={visible:this.selectionStart===this.selectionEnd||Mo.selectionDirectionMode!=="with-none",shape:this.getCursorCharPoly(this.selectionDirection==="backward"?this.selectionStart:this.selectionEnd)},t.selection={visible:this.selectionStart!==this.selectionEnd,shapes:this.getSelectionCharPolys(this.selectionStart,this.selectionEnd)},Object.keys(t).length&&this.display.update(t)}_alignText(t){var r,s;const i=((s=(r=t.metrics)==null?void 0:r.bbox)==null?void 0:s.getBounds())??Xp(new oi,t.getLocalBounds());t.x-=i.minX,t.y-=i.minY}_getValidSelectionDirection(t){return(r=>r==="forward"||r==="backward"||this.directionMode==="with-none"&&r==="none")(t)?t:this.directionMode==="with-none"?"none":"forward"}clampCharIndex(t,i="end"){const r=this.value.length;return t>=0&&t<=r?t:i==="end"?r:0}getCharPoly(t,i){const{boxType:r="emPoly",collapseToSide:s}=i??{},o=this.textMetrics.getChar(this.clampCharIndex(t,"end"));if(!o)return null;let a;if(r==="emPoly")a=o.emBox.toPoints(),this.targetTransform&&(a=a.map(c=>this.targetTransform.apply(c)));else{let c,u;r==="bbox"?(c=new Ae(o.bbox.minX,o.bbox.minY),u=new Ae(o.bbox.maxX,o.bbox.maxY)):(c=new Ae(o.emBox.minX,o.emBox.minY),u=new Ae(o.emBox.maxX,o.emBox.maxY)),a=s9(new Pt(c.x,c.y,u.x-c.x,u.y-c.y),this.targetTransform)}return ODe(a,s),new qu(a)}getSelectionCharPolys(t,i){const r=[];for(let s=t;s<i;s++){const o=this.getCharPoly(s);o&&r.push(o)}return r}getCursorCharPoly(t){return this.getCharPoly(t,{collapseToSide:"left"})}getCursorBounds(){const t=this.textMetrics.getChar(this.clampCharIndex(this.selectionEnd,"end"))??this.textMetrics.getChar(this.clampCharIndex(this.selectionEnd+1,"start"))??this.textMetrics.getChar(this.clampCharIndex(this.selectionEnd-1,"end"));if(!t)return null;let i=t.emBox.toPoints();S(this,Sn)&&(i=i.map(s=>S(this,Sn).transform.worldTransform.apply(s)));const r=new oi;return i.forEach(s=>r.addPoint(s)),r}_recordInput(){S(this,Sn)&&this._callMain({eventName:Ho.RECORD,data:{objs:[S(this,Sn)],props:{cmd:"InputText",data:{selection:[this.selectionStart,this.selectionEnd],target:S(this,Sn).id},onUndo:({top:t})=>{this._handleInputLog(t)},onRedo:({top:t})=>{this._handleInputLog(t)},subMode:Xi.TEXT_EDIT}}})}_handleInputLog(t){var s,o;if(!t)return;const i=(s=t==null?void 0:t.data)==null?void 0:s.selection;setTimeout(()=>{i&&this.setSelection(...i)});const r=this._callMainQueryObject((o=t==null?void 0:t.data)==null?void 0:o.target);r&&this._callMain({eventName:Kl.SELECT,data:[r]})}onCopy(){return this.value.slice(this.selectionStart,this.selectionEnd)}onCut(){if(this.selectionStart!==this.selectionEnd)return this._replaceText("")}onPaste(t){t!=null&&t.length&&this._replaceText(t)}onDelete(){this._replaceText("")}_replaceText(t=""){if(!t&&this.selectionStart===this.selectionEnd)return"";const i=this.value.slice(this.selectionStart,this.selectionEnd),r=this.value.slice(0,this.selectionStart)+t+this.value.slice(this.selectionEnd,this.value.length),s=this.selectionStart+t.length;return this.textAreaEl.setRangeText(t,this.selectionStart,this.selectionEnd),this._updateText(r,s,s),i}}Sn=new WeakMap;var qm,Mu,h0,Yf;class DDe extends hn{constructor(t){super();E(this,"name","TextEdit");E(this,"textCursor");E(this,"textSelection");E(this,"glyphBoxes");ke(this,qm,void 0);ke(this,Mu,void 0);ke(this,h0,void 0);ke(this,Yf,void 0);Qe(this,qm,t);const i=new hn,r=new hn;r.name="GlyphBoxes",this.glyphBoxes=r,this.glyphBoxes.cursor="text",this.addChild(r);const s=new hn;s.name="TextEditSelection",this.textSelection=s,this.addChild(s),i.name="TextEditCursor",this.textCursor=i,this.addChild(i),this.drawCursor()}update(t){Qe(this,Mu,Ln(pn(t))),this.drawGlyphBoxes(),this.drawSelection(),this.drawCursor()}renderCursor(){const{x:t,y:i,height:r=20}=S(this,Mu).cursor;this.textCursor.position.x=t,this.textCursor.position.y=i,this.textCursor.height=r}drawCursor(){var r;const{shape:t,visible:i=!0}=((r=S(this,Mu))==null?void 0:r.cursor)??{};Qe(this,h0,i),this.textCursor.clear(),!(!i||!t)&&(this.textCursor.visible=i,Qe(this,Yf,Date.now()),this.textCursor.lineStyle(Mo.textCursorLineStyle).drawShape(S(this,Mu).cursor.shape))}drawSelection(){const{shapes:t=[],visible:i=!0}=S(this,Mu).selection??{};if(this.textSelection.visible=i,this.textSelection.clear(),!i||!(t.length>0))return;const r=Mo.selectionFillStyle;this.textSelection.beginFill(r.color,r.alpha),S(this,Mu).selection.shapes.forEach(s=>{s&&this.textSelection.drawShape(s)}),this.textSelection.endFill()}drawGlyphBoxes(){this.glyphBoxes.clear();const t=S(this,qm).activeTarget;t&&(kDe(S(this,qm).textMetrics.metrics,this.glyphBoxes,{drawChar:!1,drawLine:!1}),this.glyphBoxes.transform.setFromMatrix(t.localTransform),this.glyphBoxes.transform.updateLocalTransform())}render(t){if(super.render(t),S(this,h0)){const i=Date.now();i-S(this,Yf)>=Mo.textCursorAnimationInterval&&(Qe(this,Yf,i),this.textCursor.visible=!this.textCursor.visible)}else this.textCursor.visible=!1,Qe(this,Yf,null)}}qm=new WeakMap,Mu=new WeakMap,h0=new WeakMap,Yf=new WeakMap;function kDe(n,e,t){const{drawLine:i=!1,drawChar:r=!1}=t??{};e.lineStyle(Mo.textBoundsLineStyle);const s=c1(n.bbox);e.drawShape(s),e.interactive=!0,e.hitArea=s,Object.values(n.lineMetrics).forEach(o=>{i&&(e.lineStyle({width:1,native:!0,color:8388608,alpha:.8}),e.drawShape(c1(o.emBox)),e.lineStyle({width:1,native:!0,color:8421376,alpha:.8}),e.drawShape(c1(o.straightEmBox))),r&&(e.lineStyle({width:1,native:!0,color:34944,alpha:.4}),Object.values(o.charMetrics).forEach(a=>{e.drawPolygon(a.bbox.toPoints())}),e.lineStyle({width:1,native:!0,color:34944,alpha:.8}),Object.values(o.charMetrics).forEach(a=>{e.drawPolygon(a.emBox.toPoints())}))})}function ODe(n,e){if(e)switch(e){case"left":n[1].copyFrom(n[0]),n[2].copyFrom(n[3]);break;case"right":n[0].copyFrom(n[1]),n[3].copyFrom(n[2]);break;case"top":n[3].copyFrom(n[0]),n[2].copyFrom(n[1]);break;case"bottom":n[0].copyFrom(n[3]),n[1].copyFrom(n[2]);break}return n}class LDe extends c7{constructor(t){super(t);E(this,"selectScope",ll.TEMP_LAYER);this.curPlugin=new RDe}startMode(t){this.emit(at.MESSAGE_TO_MANAGER,{eventName:Rd.REGISTER,data:{plugins:this.curPlugin}}),this.curPlugin.startTextEditModeAction(t)}updateMode(){}endMode(t){this.curPlugin.endTextEditModeAction(t),this.curPlugin.removeAllListeners(),this.emit(at.MESSAGE_TO_MANAGER,{eventName:Rd.UNREGISTER,data:{plugins:this.curPlugin}})}onCopy(){return this.curPlugin.onCopy()}onCut(){return this.curPlugin.onCut()}onPaste(t){this.curPlugin.onPaste(t)}onDelete(){this.curPlugin.onDelete()}removeSelected(){this.curPlugin.onDelete()}}const xw={[Xi.VECTOR_EDITOR]:{Mode:f7,modeConfig:{enableDisplayLayerInteractive:!1},noAutoFinishModes:new Set([Vt.SELECT,Vt.PEN])},[Xi.TEXT_EDIT]:{Mode:LDe,modeConfig:{enableDisplayLayerInteractive:!1},persistent:!0}};class NDe extends Zr{constructor(){super();E(this,"subEditModes",{})}get curMode(){const t=Symbol.for("curMode");return this[t]}set curMode(t){const i=Symbol.for("curMode");this[i]!==t&&(this[i]=t,this.emit(Gc.CHANGE,{mode:this.curMode,subMode:this.curSubEditModeName}))}get curSubEditMode(){const t=Symbol.for("curSubEditMode");return this[t]}set curSubEditMode(t){const i=Symbol.for("curSubEditMode");this[i]!==t&&(this[i]=t,this.setupSubEditModeEvents())}get curSubEditModeName(){var t;return(t=this.curSubEditMode)==null?void 0:t.name}willFinishWhenEditModeChange(t){let i=!0;const r=this.curSubEditModeName;if(r in xw){const s=xw[r];(s==null?void 0:s.noAutoFinishModes)instanceof Set&&(i=!s.noAutoFinishModes.has(t))}return i}getSubMode(t){if(t in this.subEditModes)return this.subEditModes[t];if(!t||!(t in xw))return null;const{Mode:i,modeConfig:r,persistent:s}=xw[String(t)],o=new i({name:t,modeConfig:r});return s&&(this.subEditModes[t]=o),o}updateSubEditMode(t,i,r){var u,h,d,f;const s=this.curSubEditModeName??void 0,o=t??void 0;let a,l;if(o?(l=i,s&&(a=r??(l?gr(l,["willRecord","autoSelected"]):void 0))):a=r??i,s!==o){const p=this.curSubEditMode;this.curSubEditMode=null,p&&((u=p.endMode)==null||u.call(p,a));const g=this.curSubEditMode=this.getSubMode(o);g&&((h=g.startMode)==null||h.call(g,l))}else{const p=this.curSubEditMode;p&&((d=p.updateMode)==null||d.call(p,l,a))}const c=((f=this.curSubEditMode)==null?void 0:f.modeConfig)??l7();return this.emit(Gc.CHANGE,{mode:this.curMode,subMode:this.curSubEditModeName,otherData:{mode:l==null?void 0:l.mode,formModeChanged:s===o}}),{prevModeName:s,nextModeName:o,modeConfig:c}}setupSubEditModeEvents(){var t;(t=this.curSubEditMode)==null||t.on(at.MESSAGE_TO_MANAGER,i=>{const{eventName:r,data:s}=i;switch(r){case Ns.UPDATE_EDIT_MODE:this.curMode=s.mode;break;default:this.emit(at.MESSAGE_TO_MAIN,{eventName:r,data:s})}})}selectingElements(t){var r;if(!this.curSubEditMode)return;const{curPlugin:i}=this.curSubEditMode;this.curSubEditMode instanceof f7&&((r=i==null?void 0:i.selectingElements)==null||r.call(i,t))}removeSelected(){var t;(t=this.curSubEditMode)==null||t.removeSelected()}}function BDe(n,e,t){const{width:i,height:r,displaysAsGroup:s=!1}=t;(tn(i)||tn(r))&&(s?[e]:Zi(Fr(e,"groupTag"),a=>a)).forEach(a=>HDe(n,a,t))}function FDe(n,e,t){const{x:i,y:r,displaysAsGroup:s=!1}=t;(tn(i)||tn(r))&&(s?[e]:Zi(Fr(e,"groupTag"),a=>a)).forEach(a=>GDe(n,a,t))}function UDe(n,e){const{angle:t,displaysAsGroup:i=!1}=e;tn(t)&&(i?[n]:Zi(Fr(n,"groupTag"),s=>s)).forEach(s=>VDe(s,e))}function GDe(n,e,t){const i=d9(n,e,t),r=Dt.IDENTITY.translate(i.x,i.y);p2(e,r)}function HDe(n,e,t){const{width:i,height:r}=t,s=PSe(e);if(!tn(i)&&!tn(r))return;const o=Xr.calculateGroupOrientedBounds(e,0),a=o.innerBounds;if(a.width<=0||a.height<=0)return;const l=a.bottomRight,c=h9(n,e,i,r,s),u=new Ae(c.maxX,c.maxY),{sx:h,sy:d}=Xr.calculateScaleRatio(u,l,{bounds:o,lockAspectRatio:s}),f=Dt.IDENTITY,p=a.topLeft;h!==0&&f.translate(-p.x,-p.y).scale(h,1).translate(p.x,p.y),d!==0&&f.translate(-p.x,-p.y).scale(1,d).translate(p.x,p.y),p2(e,f)}function VDe(n,e){const{angle:t}=e,i=qY(n,t);p2(n,i)}var qf,d0;class zDe extends Zr{constructor(){super(...arguments);ke(this,qf,lI);ke(this,d0,void 0)}get displayConfig(){return S(this,qf)}set displayConfig(t){Qe(this,qf,{...S(this,qf),...t}),this.emit(mR.DISPLAY_CONFIG_CHANGE,S(this,qf))}update(t){this.displayConfig=t}get imageProcessConfig(){return S(this,d0)}set imageProcessConfig(t){Qe(this,d0,t)}}qf=new WeakMap,d0=new WeakMap;class S2 extends jX{constructor(t,i,r={},s,o,a){super(t,i,r,s,o,a);E(this,"transformer");E(this,"name","textCurveHandle");this.transformer=t,this.name=S2.name}draw(){var o,a,l;const t=this._handle,i=this._style,r=i.radius;if(this.removeChildren(),this.clear().lineStyle(i.outlineThickness,i.outlineColor).beginFill(i.color),i.shape==="square")this.drawRect(-r/2,-r/2,r,r);else if(i.shape==="component"){const c=(l=(a=(o=this._style)==null?void 0:o.shapeAttrs)==null?void 0:a[t])==null?void 0:l.component;c&&(c.on("DOUBLE_CLICK",()=>{this.emit("DOUBLE_CLICK")}),this.addChild(c))}else this.drawCircle(0,0,r);const{style:{hitAreaPadding:s}}=this;if(s){const{x:c,y:u,width:h,height:d}=this.getLocalBounds();h>0&&d>0&&(this.hitArea=new Pt(c-s,u-s,h+s*2,d+s*2))}this.endFill()}}const $De={cursor:"default",startThreshold:2,autoAdjustOnSelect:!0,autoAdjustOnDragEnd:!0,autoAdjustMaxOffset:200,autoAdjustViewPadding:{left:0,top:0,right:0,bottom:0},autoHideTransformer:!0,drawPathWhenPointerDown:!0,mountParent:"stage"};class WDe extends mn{constructor(t){super();E(this,"options");E(this,"transformer");E(this,"view");E(this,"handle");E(this,"handlePathGraphics");E(this,"target");E(this,"handlePointerDown",!1);E(this,"handleDragging",!1);E(this,"hasHideTransformer",!1);E(this,"transformerMoving",!1);this.options=Ln(pn($De),t)}get group(){return this.transformer.group}init(t,i){this.transformer=t,this.view=i;const r=this.options;this.handlePathGraphics=new hn,this.handlePathGraphics.name="textCurveHandlePath",this.addChild(this.handlePathGraphics),this.handle=new S2(t,"textCurve",{...this.transformer.handleStyle,...r.styleOpts},s=>this.onHandleDrag(s),()=>this.onHandleDragEnd(),r.cursor??"default"),this.handle.visible=!1,this.addChild(this.handle),this.handle.on("pointerdown",this.onHandlePointerDown,this),this.handle.on("pointerup",this.onHandlePointerUp,this),this.handle.on("pointerupoutside",this.onHandlePointerUp,this),this.handle.on(ji.DOUBLE_CLICK,Fc(this.onHandleDoubleClick,16),this),this.transformer.on(sr.SELECT,()=>this.onSelectedGroupChange()),this.transformer.on("pointerdown",()=>{this.transformerMoving=!0}),this.transformer.on("pointerup",()=>{this.transformerMoving=!1}),this.transformer.viewport.on("moved",this.draw,this),this.transformer.viewport.on("zoomed",this.draw,this)}mount(t){if(this.options.mountParent==="transformer")t=this.transformer,this.options.zIndex!==void 0?t.addChildAt(this,this.options.zIndex):t.addChild(this);else{const i=t.getChildIndex(this.transformer);t.addChildAt(this,i+1)}}onSelectedGroupChange(){const t=this.group,i=t.length===1&&t[0].type===it.TEXT?t[0]:void 0;this.target!==i&&(i?this.draw():this.cancelHandleInteraction(),this.target=i,this.handle.visible=i&&i.enableTransform!==!1,this.options.autoAdjustOnSelect&&this.doHandlePositionAdjust())}doHandlePositionAdjust(){this.target&&(this.isOutLimitRange()&&this.adjustTextCurveHandle(this.target,Ya.curveX),this.isOutLimitOffset()&&this.adjustTextCurveHandle(this.target,Ya.curveX))}isOutLimitRange(){var c,u;if(!this.options.autoAdjustViewPadding)return!1;const t=this.view,i=this.handle.position,r=typeof this.options.autoAdjustViewPadding=="function"?(u=(c=this.options).autoAdjustViewPadding)==null?void 0:u.call(c):this.options.autoAdjustViewPadding,s=r.left,o=r.top,a=t.clientWidth-r.right,l=t.clientHeight-r.bottom;return i.x>a||i.x<s||i.y>l||i.y<o}isOutLimitOffset(){const t=this.options.autoAdjustMaxOffset;if(isFinite(t)){const i=this.target;return Math.abs(i.style.curveX)>t||Math.abs(i.style.curveY)>t}else return!1}render(t){this.renderable&&this.visible&&this.draw(),super.render(t)}draw(){var i,r,s,o;const t=this.target;if(t&&!this.transformerMoving&&t.enableTransform!==!1){const{width:a,height:l}=((r=(i=this.transformer)==null?void 0:i.groupBounds)==null?void 0:r.innerBounds)??{},c=((s=this.options.styleOpts)==null?void 0:s.minSize)??((o=this.transformer.handleStyle)==null?void 0:o.minSize);if(c>0&&(a<c||l<c)?this.handle.visible=!1:this.handle.visible=!0,this.handle.visible||this.handle.renderable){const u=this.getHandleGlobalPt(t);this.handle.position.set(u.x,u.y)}}else this.handle.position.set(0,0)}onHandlePointerDown(t){var i,r;Nc(t)&&(this.handlePointerDown=!0,this.target&&this.options.drawPathWhenPointerDown&&(this.drawHandlePath(this.target),this._hideTransformer()),(r=(i=this.options.lifecycle)==null?void 0:i.onPointerDown)==null||r.call(i,this._getLifeCycleEventData()))}onHandlePointerUp(){var t,i;this.handlePointerDown=!1,this.handleDragging&&(this.handleDragging=!1),this.handlePathGraphics.clear(),this._showTransformer(),(i=(t=this.options.lifecycle)==null?void 0:t.onPointerUp)==null||i.call(t,this._getLifeCycleEventData())}onHandleDrag(t){var i,r,s,o;if(this.target){const a=this.target;this.drawHandlePath(a);const l=this.toHandleLocalPt(a,t);this.updateTextCurveHandle(a,l),this.handleDragging||(this.handleDragging=!0,this._hideTransformer(),(r=(i=this.options.lifecycle)==null?void 0:i.onDragStart)==null||r.call(i,this._getLifeCycleEventData())),(o=(s=this.options.lifecycle)==null?void 0:s.onDrag)==null||o.call(s,this._getLifeCycleEventData())}}onHandleDragEnd(){var t,i;this.target&&(this.handleDragging&&this.transformer.commitGroup(),(i=(t=this.options.lifecycle)==null?void 0:t.onDragEnd)==null||i.call(t,this._getLifeCycleEventData()),this.options.autoAdjustOnDragEnd&&requestAnimationFrame(()=>{this.doHandlePositionAdjust()}))}onHandleDoubleClick(){var t,i;this.cancelHandleInteraction(),this.target&&this.target.curveInfo.curveDir&&(this.updateTextCurveHandle(this.target,{x:Ya.curveX,y:0}),this.transformer.commitGroup()),(i=(t=this.options.lifecycle)==null?void 0:t.onDoubleClick)==null||i.call(t,this._getLifeCycleEventData())}cancelHandleInteraction(){this.handlePointerDown&&this.onHandlePointerUp(),this.handle.reset()}getHandleGlobalPt(t){return t.toGlobal(new Dt().translate(t.curveInfo.curveAnchor.x,t.curveInfo.curveAnchor.y).apply({x:t.style.curveX,y:t.style.curveY}))}toHandleLocalPt(t,i){const r=new Dt().translate(t.curveInfo.curveAnchor.x,t.curveInfo.curveAnchor.y).applyInverse(t.toLocal(i));return this.applyStartThreshold(t,r),r}applyStartThreshold(t,i){const r=this.options.startThreshold,s=isFinite(r)&&r>0?r:0;if(s){const{c:o,d:a}=t.worldTransform,l=Math.sqrt(o*o+a*a);Math.abs(i.y)<s/l&&(i.y=0)}}drawHandlePath(t){const i=this.handlePathGraphics;if(!i||!t)return;const{curveDir:r,handlePath:s}=t.curveInfo;i.clear(),r&&(i.lineStyle({width:1,native:!0,...this.options.handlePathStyle}).drawCircle(s.c.x,s.c.y,s.radius),i.worldTransform.copyFrom(t.worldTransform))}updateTextCurveHandle(t,i){isFinite(i.x)&&isFinite(i.y)&&t.parseJSON({style:{curveX:i.x,curveY:i.y}})}adjustTextCurveHandle(t,i){const r=t.curveInfo.curveDir;let s=i,o=0;if(r){const a=Math.abs(t.curveInfo.curveRadius);s=Math.abs(i)<a?i:Math.sign(i)*a,o=r?r*(a-Math.sqrt(a**2-s**2)):0}this.updateTextCurveHandle(t,{x:s,y:o})}_hideTransformer(){this.options.autoHideTransformer&&this.options.mountParent!=="transformer"&&this.transformer.visible&&(this.transformer.visible=!1,this.hasHideTransformer=!0)}_showTransformer(){this.options.autoHideTransformer&&this.options.mountParent!=="transformer"&&this.hasHideTransformer&&(this.transformer.visible=!0,this.hasHideTransformer=!1)}_getLifeCycleEventData(){var t;return{id:(t=this.target)==null?void 0:t.id}}}var p7={},P2={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.GRAPH_HEIGHT=n.GRAPH_WIDTH=n.GRAPH_Y=n.FONT_SIZE=n.GRAPH_X=n.TEXT_Y=n.TEXT_X=n.HEIGHT=n.WIDTH=n.PR=void 0,n.PR=4,n.WIDTH=50*n.PR,n.HEIGHT=30*n.PR,n.TEXT_X=7,n.TEXT_Y=7,n.GRAPH_X=n.TEXT_X,n.FONT_SIZE=20,n.GRAPH_Y=n.FONT_SIZE+n.TEXT_Y,n.GRAPH_WIDTH=n.WIDTH-n.GRAPH_X*2,n.GRAPH_HEIGHT=n.HEIGHT-n.GRAPH_X-n.GRAPH_Y})(P2);var l_={};Object.defineProperty(l_,"__esModule",{value:!0});l_.Panel=void 0;const An=P2;class jDe{constructor(e,t,i){this.values=[],this.snapshotSize=30;const r=document.createElement("canvas");r.width=An.WIDTH,r.height=An.HEIGHT;const s=r.getContext("2d");if(!s)throw new Error("Cant get context on canvas");s.font=`bold ${An.FONT_SIZE}px ${getComputedStyle(document.body).fontFamily}`,s.textBaseline="top",s.fillStyle=i,s.fillRect(0,0,An.WIDTH,An.HEIGHT),s.fillStyle=t,s.fillText(e,An.TEXT_X,An.TEXT_Y),s.fillRect(An.GRAPH_X,An.GRAPH_Y,An.GRAPH_WIDTH,An.GRAPH_HEIGHT),s.fillStyle=i,s.globalAlpha=.8,s.fillRect(An.GRAPH_X,An.GRAPH_Y,An.GRAPH_WIDTH,An.GRAPH_HEIGHT),this.name=e,this.dom=r,this.context=s,this.fg=t,this.bg=i}get min(){return this.values.reduce((e,t)=>Math.min(e,t),1/0).toFixed()}get max(){return this.values.reduce((e,t)=>Math.max(e,t),0).toFixed()}get averageValue(){return(this.values.reduce((e,t)=>e+t,0)/this.values.length).toFixed(1)}pushValue(e){this.values.push(e),this.values.length>this.snapshotSize&&(this.values=this.values.slice(-this.snapshotSize))}update(e,t){const i=this.context;this.pushValue(e),i.fillStyle=this.bg,i.globalAlpha=1,i.fillRect(0,0,An.WIDTH,An.GRAPH_Y),i.fillStyle=this.fg,i.font=`bold ${An.FONT_SIZE}px ${getComputedStyle(document.body).fontFamily}`,i.fillText(`${this.averageValue} ${this.name} (${this.min}-${this.max})`,An.TEXT_X,An.TEXT_Y),i.drawImage(this.dom,An.GRAPH_X+An.PR,An.GRAPH_Y,An.GRAPH_WIDTH-An.PR,An.GRAPH_HEIGHT,An.GRAPH_X,An.GRAPH_Y,An.GRAPH_WIDTH-An.PR,An.GRAPH_HEIGHT),i.fillRect(An.GRAPH_X+An.GRAPH_WIDTH-An.PR,An.GRAPH_Y,An.PR,An.GRAPH_HEIGHT),i.fillStyle=this.bg,i.globalAlpha=.8,i.fillRect(An.GRAPH_X+An.GRAPH_WIDTH-An.PR,An.GRAPH_Y,2*An.PR,Math.round((1-e/t)*An.GRAPH_HEIGHT))}}l_.Panel=jDe;var Rv={},qp={};class QDe{constructor(e){this.drawPasses=0,this.isInit=!1,this.realGLDrawElements=function(){},e?e.__proto__.drawElements&&(this.gl=e,this.realGLDrawElements=e.__proto__.drawElements,e.__proto__.drawElements=this.fakeGLdrawElements.bind(this),this.isInit=!0,console.log("[GLHook] GL was Hooked!")):console.error("[GLHook] GL can't be NULL")}fakeGLdrawElements(e,t,i,r){this.drawPasses++,this.realGLDrawElements.call(this.gl,e,t,i,r)}reset(){this.drawPasses=0}release(){this.isInit&&(this.gl.__proto__.drawElements=this.realGLDrawElements,console.log("[GLHook] Hook was removed!")),this.isInit=!1}}class XDe{constructor(e){this.createdTextures=new Array,this.maxTexturesCount=0,this.isInit=!1,this.realGLCreateTexture=function(){},this.realGLDeleteTexture=function(){},e?e.__proto__.createTexture&&(this.gl=e,this.realGLCreateTexture=e.__proto__.createTexture,this.realGLDeleteTexture=e.__proto__.deleteTexture,e.__proto__.createTexture=this.fakeGLCreateTexture.bind(this),e.__proto__.deleteTexture=this.fakeGLDeleteTexture.bind(this),this.isInit=!0,console.log("[TextureHook] GL was Hooked!")):console.error("[TextureHook] GL can't be NULL")}get currentTextureCount(){return this.createdTextures.length}registerTexture(e){this.createdTextures.push(e),this.maxTexturesCount=Math.max(this.createdTextures.length,this.maxTexturesCount)}fakeGLCreateTexture(){var e=this.realGLCreateTexture.call(this.gl);return this.registerTexture(e),e}fakeGLDeleteTexture(e){var t=this.createdTextures.indexOf(e);t>-1&&this.createdTextures.splice(t,1),this.realGLDeleteTexture.call(this.gl,e)}reset(){this.createdTextures=new Array,this.maxTexturesCount=0}release(){this.isInit&&(this.gl.__proto__.createTexture=this.realGLCreateTexture,this.gl.__proto__.deleteTexture=this.realGLDeleteTexture,console.log("[TextureHook] Hook was removed!")),this.isInit=!1}}class YDe{constructor(){this._drawCalls=-1,this._maxDeltaDrawCalls=-1}attach(e){this.glhook=new QDe(e),this.texturehook=new XDe(e)}get drawCalls(){return this.glhook&&this.glhook.isInit?this.glhook.drawPasses:-1}get maxDeltaDrawCalls(){return this._maxDeltaDrawCalls}get deltaDrawCalls(){if(this._drawCalls==-1)return this._drawCalls=this.drawCalls,0;var e=this.drawCalls,t=e-this._drawCalls;return this._drawCalls=e,this._maxDeltaDrawCalls=Math.max(this._maxDeltaDrawCalls,t),t}get maxTextureCount(){return this.texturehook&&this.texturehook.isInit?this.texturehook.maxTexturesCount:0}get texturesCount(){return this.texturehook&&this.texturehook.isInit?this.texturehook.currentTextureCount:0}reset(){this._maxDeltaDrawCalls=-1,this._drawCalls=-1,this.glhook&&this.glhook.reset(),this.texturehook&&this.texturehook.reset()}release(){this.glhook&&this.glhook.release(),this.texturehook&&this.texturehook.release()}}const qDe=Object.freeze(Object.defineProperty({__proto__:null,default:YDe},Symbol.toStringTag,{value:"Module"})),KDe=iO(qDe);var JDe=un&&un.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(qp,"__esModule",{value:!0});qp.PIXIHooks=qp.StatsJSAdapter=void 0;const ZDe=JDe(KDe),w4=l_;class eke{constructor(e,t){if(this.hook=e,t?this.stats=t:window.Stats&&(this.stats=new window.Stats),this.stats)this.dcPanel=this.stats.addPanel(new w4.Panel("DC","#f60","#300")),this.tcPanel=this.stats.addPanel(new w4.Panel("TC","#0c6","#033")),this.stats.showPanel(0);else throw new Error("Stats can't found in window, pass instance of Stats.js as second param")}update(){this.stats&&(this.hook&&(this.dcPanel.update(this.hook.deltaDrawCalls,Math.max(50,this.hook.maxDeltaDrawCalls)),this.tcPanel.update(this.hook.texturesCount,Math.max(20,this.hook.maxTextureCount))),this.stats.update())}reset(){this.hook&&this.hook.reset()}}qp.StatsJSAdapter=eke;class tke extends ZDe.default{constructor(e){if(super(),!e){console.error("[PIXI Hooks] missing PIXI.Application");return}const t=e.renderer;if(t.gl){this.attach(t.gl);const i=t.texture.managedTextures;if(!i||!this.texturehook)console.error("[PIXI Hooks] !startTextures || !this.texturehook");else{console.log("[PIXI Hooks] Collect used textures:",i.length);for(let r=0;r<i.length;r++){const o=i[r]._glTextures;Object.values(o).forEach(a=>{a.gl===e.renderer.gl&&this.texturehook.registerTexture(a.texture)})}}}else console.error("[PIXI Hook] Canvas renderer is not allowed")}}qp.PIXIHooks=tke;Object.defineProperty(Rv,"__esModule",{value:!0});Rv.addStats=Rv.Stats=void 0;const x4=qp,nke=l_;class Ap{constructor(){this.setMode=this.showPanel,this.mode=0,this.domElement=document.createElement("div"),this.domElement.id="stats",this.domElement.addEventListener("click",e=>{e.preventDefault(),this.showPanel(++this.mode%this.domElement.children.length)},!1),this.beginTime=(performance||Date).now(),this.prevTime=this.beginTime,this.frames=0,this.fpsPanel=this.addPanel(new Ap.Panel("FPS","#3ff","#002")),this.msPanel=this.addPanel(new Ap.Panel("MS","#0f0","#020")),performance&&performance.memory&&(this.memPanel=this.addPanel(new Ap.Panel("MB","#f08","#200")))}addPanel(e){return this.domElement.appendChild(e.dom),e}showPanel(e){for(let t=0;t<this.domElement.children.length;t++){const i=this.domElement.children[t];i.style.display=t===e?"block":"none"}this.mode=e}begin(){this.beginTime=(performance||Date).now()}end(){this.frames++;const e=(performance||Date).now();if(this.msPanel.update(e-this.beginTime,200),e>this.prevTime+1e3&&(this.fpsPanel.update(this.frames*1e3/(e-this.prevTime),100),this.prevTime=e,this.frames=0,this.memPanel)){const t=performance.memory;this.memPanel.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e}update(){this.beginTime=this.end()}}Rv.Stats=Ap;Ap.Panel=nke.Panel;function ike(n,e){const t=new Ap,i=new x4.PIXIHooks(e),r=new x4.StatsJSAdapter(i,t);return n.body.appendChild(r.stats.domElement),r}Rv.addStats=ike;(function(n){var e=un&&un.__createBinding||(Object.create?function(i,r,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(r,s);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[s]}}),Object.defineProperty(i,o,a)}:function(i,r,s,o){o===void 0&&(o=s),i[o]=r[s]}),t=un&&un.__exportStar||function(i,r){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(r,s)&&e(r,i,s)};Object.defineProperty(n,"__esModule",{value:!0}),t(P2,n),t(l_,n),t(Rv,n),t(qp,n)})(p7);function g7(n,e,t,i={texture:!0}){const r=u7(...e),s=new Set;r.forEach(c=>{s.add(c.id)});const{curIDs:o,curAttributes:a}=m7(n,t,i);return o.forEach(c=>{s.add(c)}),{allIDs:s,curIDs:o,curAttributes:a}}function m7(n,e,t={texture:!0}){const i=new Map,r=new Set;return n.forEach(s=>{r.add(s.id),s.transform.updateLocalTransform(),s.updateTransform();const o=s.toJSON(e,t),a=sh(s.transform.worldTransform.clone(),e.transform.worldTransform.clone());i.set(s.id,{...o,matrixByViewport:a})}),{curIDs:r,curAttributes:i}}class rke extends hn{constructor(t=eCe){super();E(this,"config");E(this,"isActive",!0);this.config=t,this.visible=!1,this.name="SELECTOR"}start(t){this.isActive&&(this.visible=!0,this.scale.set(.01,.01),this.clear(),this.beginFill(this.config.fillColor,this.config.fillAlpha).drawRect(0,0,1,1).endFill(),this.position.set(t.x,t.y),this.emit(Cy.SELECTING_VIEWPORT_ELEMENTS,!0))}update(t){if(this.isActive&&this.visible){const{x:i,y:r}=this.position,{x:s,y:o}=t;this.scale.set(s-i,o-r)}}toggleActive(t){this.isActive=t}end(t,i){if(this.isActive){if(this.visible){const{width:s,height:o}=this.getBounds();Math.abs(s)>5&&Math.abs(o)>5&&this.emit(Cy.SELECT_VIEWPORT_ELEMENTS,new Ae(this.position.x,this.position.y),t,i)}this.done()}}done(){this.visible=!1,this.scale.set(.01,.01),this.emit(Cy.SELECTING_VIEWPORT_ELEMENTS,!1)}}var la,Km,Kf;class ske{constructor(e){ke(this,la,void 0);E(this,"mask");E(this,"axis");ke(this,Km,void 0);ke(this,Kf,void 0);E(this,"interactiveIcon");E(this,"onDragStart",e=>{Qe(this,Km,e.data),this.interactiveIcon||(this.axis.width=aCe),this.axis.alpha=.5,Qe(this,Kf,!0)});E(this,"onDragMove",()=>{if(S(this,Kf)){const e=S(this,Km).getLocalPosition(this.axis.parent),t=this.mask.parent.toLocal(new Ae(e.x,0));t.x<0?(e.x=this.mask.parent.toGlobal(new Ae(0,0)).x,t.x=0):t.x>S(this,la).worldWidth&&(e.x=this.mask.parent.toGlobal(new Ae(S(this,la).worldWidth,0)).x,t.x=S(this,la).worldWidth),this.axis.position.x=e.x,this.mask.width=t.x}});E(this,"onDragEnd",()=>{S(this,Kf)&&(this.interactiveIcon||(this.axis.width=y3),this.axis.alpha=1,Qe(this,Km,null),Qe(this,Kf,!1),S(this,la).onUpdate())});Qe(this,la,e),this.clear(),this.drawMask(),this.drawAxis()}drawMask(){this.mask=new hn().beginFill(0,.5).drawRect(0,0,S(this,la).viewportX,S(this,la).worldHeight).endFill(),this.mask.name="AXIS_MASK"}drawAxis(){this.axis=new hn().beginFill(2670148,1).drawRect(0,0,y3,S(this,la).stageHeight).endFill(),this.axis.x=S(this,la).stageX,this.axis.interactive=!0,this.axis.cursor="ew-resize",this.axis.name="CENTRAL_AXIS";const{iconOption:e}=S(this,la);e&&this.initInteractiveIcon(e),this.axis.on("pointerdown",this.onDragStart),this.axis.on("pointermove",this.onDragMove),this.axis.on("pointerup",this.onDragEnd),this.axis.on("pointerupoutside",this.onDragEnd)}initInteractiveIcon(e){const{icon:t,x:i,y:r,width:s,height:o}=e;if(!t)return;const a=Wt.from(new In(t)),l=new Ur(a);l.anchor.set(.5,.5),l.x=i??l.x,l.y=r??l.y,l.width=s??l.width,l.height=o??l.height,this.interactiveIcon=l,this.axis.addChild(l)}resize(e){const{worldHeight:t,stageHeight:i}=e;this.mask.height=t,this.axis.height=i}clear(){var e,t;(e=this.axis)==null||e.destroy(!0),(t=this.mask)==null||t.destroy(!0)}}la=new WeakMap,Km=new WeakMap,Kf=new WeakMap;class v7 extends Zr{constructor(t){super();E(this,"name");E(this,"triggerModel");E(this,"context");E(this,"pointerdown");E(this,"container");E(this,"adsorptionDistance",3);E(this,"accuracy",.1);E(this,"dValue");E(this,"selected");E(this,"unSelected");E(this,"options");E(this,"extraElements",[]);E(this,"selectedGroupTags",[]);E(this,"groupMap",{});this.pointerdown=!1,this.container=new mn,this.container.name="GUIDELINE",this.dValue={x:0,y:0},this.selected=[],this.unSelected=[],this.options=Object.assign({},sCe,t)}setGroupSelection(t,i){this.selectedGroupTags=t,this.groupMap=i}set clickCoordinate(t){if(this.triggerModel===Ad.HOVER)return;const i=Symbol.for("clickCoordinate");this[i]=t}get clickCoordinate(){if(this.triggerModel===Ad.HOVER){const i=Pl(this.selected);return{x:i.x+i.width/2,y:i.y+i.height/2}}const t=Symbol.for("clickCoordinate");return this[t]}get worldGroupBounds(){return Yp(this.selected.filter(i=>i.enableTransform),this.context)}setContext(t){this.context=t}addExtraCompareTarget(t){this.extraElements.push(...t)}removeExtraCompareTarget(t){$ue(this.extraElements,...t)}clearExtraCompareTarget(){this.extraElements=[]}onPointerdown(t){this.pointerdown=!0,this.clickCoordinate=t.data.global.clone(),this.calDeltaToSelected()}calDeltaToSelected(){if(!this.clickCoordinate||!this.clickCoordinate.x||!this.clickCoordinate.y)return;const t=this.context,{x:i,y:r,scale:s}=t,o=this.worldGroupBounds,a=o.minX-Number((this.clickCoordinate.x-i)/s.x),l=o.minY-Number((this.clickCoordinate.y-r)/s.y);this.dValue={x:a,y:l}}onPointerup(){this.pointerdown=!1,this.container.removeChildren()}onObjectMoving(t){if(!(this.triggerModel===Ad.DOWN&&!this.pointerdown)){if(this.selected){if(this.selected.length===0)return}else return;this.container.children.length>0&&this.correctPosition(t),this.container.removeChildren(),this.options.enableAdsorb&&this.compareWithUnselected()}}compareWithUnselected(){var r;const t=[],i=[];if(((r=this.selected)==null?void 0:r.length)>0){const s=this.context,o=this.worldGroupBounds,a=this.handleBounds(o.minX,o.maxX),l=this.handleBounds(o.minY,o.maxY),u=(this.unSelected||[]).filter(_=>_.visible&&!_.destroyed).map(_=>{const y=this.toLocal(_.getBounds());return{displayBounds:y,datumCoordinatesH:this.handleBounds(y.left,y.right)||[0,0,0],datumCoordinatesV:this.handleBounds(y.top,y.bottom)||[0,0,0]}}),h=this.extraElements.filter(_=>_.visible&&!_.destroyed).map(_=>{const y=this.toLocal(_.getBounds());return{displayBounds:y,datumCoordinatesH:this.handleExtraDisplayBounds(y.left,y.right)||[0,0,0],datumCoordinatesV:this.handleExtraDisplayBounds(y.top,y.bottom)||[0,0,0]}});let d=this.adsorptionDistance,f=this.adsorptionDistance;[...u,...h].forEach(_=>{const y=_.displayBounds,A=this.compareCoordinate(a,_.datumCoordinatesH);A.coordinateArr.forEach(b=>{t.push({coordinate:b,min:y.top,max:y.bottom})}),d=Math.abs(A.min)<Math.abs(d)?A.min:d;const w=this.compareCoordinate(l,_.datumCoordinatesV);w.coordinateArr.forEach(b=>{i.push({coordinate:b,min:y.left,max:y.right})}),f=Math.abs(w.min)<Math.abs(f)?w.min:f});const{worldHeight:p,worldWidth:g}=s,m=this.compareCoordinate(a,[g/2]),v=this.compareCoordinate(l,[p/2]);if(d=Math.abs(m.min)<Math.abs(d)?m.min:d,f=Math.abs(v.min)<Math.abs(f)?v.min:f,m.coordinateArr.forEach(_=>{t.push({coordinate:_,min:0,max:p})}),v.coordinateArr.forEach(_=>{i.push({coordinate:_,min:0,max:g})}),Math.abs(d)<this.adsorptionDistance&&d!==0||Math.abs(f)<this.adsorptionDistance&&f!==0)this.moveSelectedGraphical(d,f),this.emitAdsorptionPosition();else{if(t.length>0){const _=this.handleCoordinate(t,l);this.createGuideLineCoordinate(_,Uh.VERTICAL)}if(i.length>0){const _=this.handleCoordinate(i,a);this.createGuideLineCoordinate(_,Uh.HORIZONTAL)}}}}emitAdsorptionPosition(){const t=Yp(this.selected,this.context),{minX:i,maxX:r,minY:s,maxY:o}=t,a={x:i+(r-i)/2,y:s+(o-s)/2};this.emit(at.MESSAGE_TO_PLUGIN,{eventName:Gc.SELECT_ATTR_CHANGED,data:{attrs:{...a}}})}correctPosition(t){const{x:i,y:r}=t.data.global;if(this.selected){const s=this.context,o=this.worldGroupBounds,a={x:Number((i-s.x)/s.scale.x)+this.dValue.x,y:Number((r-s.y)/s.scale.y)+this.dValue.y},l={x:a.x-o.minX,y:a.y-o.minY};this.selected.filter(u=>{let h=!0;const{groupTag:d,lockState:f}=u;return d.startsWith("g-")&&this.selectedGroupTags.includes(d)?h=this.groupMap[d].enableTransform:h=!f,h}).forEach(u=>{const h=u.getPointToRelativeElement(s),d=new Ae(h.x+l.x,h.y+l.y);_d(u,d,s)})}}handleCoordinate(t,i){const r=i[0],s=i[2],o=[];return Array.isArray(t)&&t.forEach(a=>{if(o.filter(c=>c.coordinate===a.coordinate).length===0){const c={coordinate:a.coordinate,middleMin:r,middleMax:s};a.min>s?(c.largeNear=a.min,c.large=a.max):a.max<r?(c.littleNear=a.max,c.little=a.min):(a.max>s&&(c.large=a.max),a.min<r&&(c.little=a.min)),o.push(c)}else o.forEach(c=>{c.coordinate===a.coordinate&&(a.min>s?(c.largeNear=c.largeNear!==void 0?Math.min(c.largeNear,a.min):a.min,c.large=c.large!==void 0?Math.max(c.large,a.max):a.max):a.max<r?(c.littleNear=c.littleNear!==void 0?Math.max(c.littleNear,a.max):a.max,c.little=c.little!==void 0?Math.min(c.little,a.min):a.min):(a.max>s&&(c.large=c.large!==void 0?Math.max(c.large,a.max):a.max),a.min<r&&(c.little=c.little!==void 0?Math.min(c.little,a.min):a.min)))})}),o}createGuideLineCoordinate(t,i){const{alignLineColor:r,distanceLineColor:s}=this.options;if(Array.isArray(t)){const o=[],a=[],l=[];t.forEach(c=>{c.little!==void 0&&(c.littleNear!==void 0&&!o.includes(c.littleNear)?(l.push({min:c.little,max:c.littleNear,coordinate:c.coordinate,color:r}),l.push({min:c.littleNear,max:c.middleMin,coordinate:c.coordinate,color:s}),o.push(c.littleNear)):l.push({min:c.little,max:c.middleMin,coordinate:c.coordinate,color:r})),c.large!==void 0&&(c.largeNear!==void 0&&!a.includes(c.largeNear)?(l.push({min:c.largeNear,max:c.large,coordinate:c.coordinate,color:r}),l.push({min:c.middleMax,max:c.largeNear,coordinate:c.coordinate,color:s}),a.push(c.largeNear)):l.push({min:c.middleMax,max:c.large,coordinate:c.coordinate,color:r})),l.push({min:c.middleMin,max:c.middleMax,coordinate:c.coordinate,color:r})}),this.createLine(l,i)}}createLine(t,i){const{distanceLineColor:r}=this.options;if(Array.isArray(t)){const s=new hn;t.forEach(o=>{if(o.color===r&&this.distanceText(o.min,o.max,o.coordinate,i),i===Uh.HORIZONTAL){const a={x:o.min,y:o.coordinate},l={x:o.max,y:o.coordinate};s.lineStyle({width:1,color:o.color,native:!0}).moveTo(a.x,a.y).lineTo(l.x,l.y)}else if(i===Uh.VERTICAL){const a={x:o.coordinate,y:o.min},l={x:o.coordinate,y:o.max};s.lineStyle({width:1,color:o.color,native:!0}).moveTo(a.x,a.y).lineTo(l.x,l.y)}}),this.container.addChild(s)}}distanceText(t,i,r,s){const{fractionDigits:o,unit:a,pixelPerUnit:l}=this.options,c=this.context,u=new Sv(`${((i-t)/l).toFixed(o)} ${a}`,{fontSize:this.options.fontSize,fill:this.options.fontColor});if(u.resolution=2,u.scale.x=1/c.scaled,u.scale.y=1/c.scaled,s===Uh.HORIZONTAL){const h={x:(i+t)/2,y:r};u.position.set(h.x,h.y),u.anchor.set(.5,1)}else if(s===Uh.VERTICAL){const h={x:r,y:(t+i)/2};u.position.set(h.x,h.y),u.anchor.set(1,.5)}this.container.addChild(u)}compareCoordinate(t,i){let r=this.adsorptionDistance;const s=[];return Array.isArray(t)&&Array.isArray(i)&&t.forEach(o=>{i.forEach(a=>{Math.abs(o-a)<this.accuracy?(s.push(o),r=0):Math.abs(a-o)<Math.abs(r)&&(r=a-o)})}),{coordinateArr:s,min:r}}toLocal(t){if(this.context){const{x:i,y:r,scale:s}=this.context;return{left:Number((t.left-i)/s.x),right:Number((t.right-i)/s.x),top:Number((t.top-r)/s.y),bottom:Number((t.bottom-r)/s.y)}}else return{left:0,right:0,top:0,bottom:0}}moveSelectedGraphical(t,i){const r=this.context;t=Math.abs(t)<this.adsorptionDistance?t:0,i=Math.abs(i)<this.adsorptionDistance?i:0,this.selected.filter(o=>{let a=!0;const{groupTag:l,lockState:c}=o;return l.startsWith("g-")&&this.selectedGroupTags.includes(l)?a=this.groupMap[l].enableTransform:a=!c,a}).forEach(o=>{const a=o.getPointToRelativeElement(r),l=new Ae(a.x+t,a.y+i);_d(o,l,r)}),this.compareWithUnselected()}updateTextScale(t){const i=Math.max(t,.25);this.container.children.forEach(r=>{r instanceof Sv&&(r.scale.x=1/i,r.scale.y=1/i)})}updateOptions(t){Object.assign(this.options,t)}clear(){this.container.removeChildren()}reset(){this.container.removeChildren(),this.selected=[],this.unSelected=[],this.extraElements=[],this.pointerdown=!1,this.dValue={x:0,y:0}}onTransformSelected(t){}}class C4 extends v7{constructor(t){super(t);E(this,"name",yp.NORMAL);E(this,"transformer")}onTransformSelected(t){this.selected=t.selected,this.unSelected=t.unSelected.filter(i=>i.visible),this.transformer=t}onPointerdown(t){super.onPointerdown(t)}onPointerup(){super.onPointerup()}handleBounds(t,i){return[t,(t+i)/2,i]}handleExtraDisplayBounds(t,i){return[t,(t+i)/2,i]}onObjectMoving(t){super.onObjectMoving(t)}}const Ws={zero:0,min:.01,half:.5,full:1};var LA;(function(n){n.light="light",n.dark="dark"})(LA||(LA={}));var nE;(function(n){n.square="square",n.ellipse="ellipse"})(nE||(nE={}));var NA;(function(n){n.left="left",n.center="center",n.right="right"})(NA||(NA={}));var wf;(function(n){n.horizontal="horizontal",n.vertical="vertical"})(wf||(wf={}));var BA;(function(n){n.default="default",n.checkbox="checkbox"})(BA||(BA={}));var Om;(function(n){n.start="start",n.end="end",n.center="center"})(Om||(Om={}));const b1={margin:6,padding:2,radius:4,fast:.25,normal:.5,slow:1,primaryColor:0,color1:0,color2:16777215,fill:0,fillAlpha:1,fillActive:0,fillActiveAlpha:1,stroke:16777215,strokeWidth:.6,strokeAlpha:1,strokeActive:16777215,strokeActiveWidth:.6,strokeActiveAlpha:1,iconSize:0,iconColor:16777215,iconColorActive:0,background:0},E4={fontFamily:'"Avenir Next", "Open Sans", "Segoe UI", "Roboto", "Helvetica Neue", -apple-system, system-ui, BlinkMacSystemFont, Arial, sans-serif !default',fontWeight:500,fontSize:16,fill:16777215,stroke:0,strokeThickness:0,miterLimit:1,lineJoin:"round"},oke={color1:16185078,color2:2631720},ake={color1:16185078,color2:2631720},T4={[LA.light]:oke,[LA.dark]:ake};function lke(n=LA.light){if(!T4[n])return b1;const{color1:e,color2:t}=T4[n];return{...b1,fill:e,fillActive:e,background:e,stroke:t,strokeActive:t,iconColor:t,textStyle:{...E4,fill:t,stroke:e},textActiveStyle:{...E4,fill:b1.primaryColor}}}const _7={getThemeConfig:lke};function Cw(n,e){if(n instanceof rn)return n;{const t=Wt.from(new In(n)),i=new Ur(t);return i.width=e,i.height=e,i}}class iE extends mn{constructor(t={}){super();E(this,"options");E(this,"layout");E(this,"content");E(this,"text");E(this,"icon");E(this,"iconInactive");E(this,"iconActive");E(this,"iconHover");E(this,"iconActiveHover");E(this,"theme");E(this,"buttonActive");E(this,"isButtonHover");E(this,"isButtonDisabled");E(this,"isClickDown",!1);E(this,"buttonWidth");E(this,"buttonHeight");this.init(t),this.setupLayout(),this.setupEvent()}get isActive(){return this.buttonActive}set isActive(t){this.buttonActive=t,this.renderContent()}get isHover(){return this.isButtonHover}set isHover(t){this.isButtonHover=t,this.renderContent()}get isDisabled(){return this.isButtonDisabled}set isDisabled(t){this.isButtonDisabled=t,this.isButtonDisabled?(this.interactive=!1,this.layout.alpha=Ws.half,this.icon&&(this.icon.alpha=Ws.half),this.text&&(this.text.alpha=Ws.half)):(this.layout.interactive=!0,this.layout.alpha=Ws.full,this.icon&&(this.icon.alpha=Ws.full),this.text&&(this.text.alpha=Ws.full))}init(t){const{theme:i,icon:r,iconHover:s,iconActive:o,iconActiveHover:a,...l}=t;this.theme=_7.getThemeConfig(i),this.options={label:null,x:0,y:0,padding:this.theme.padding,shape:nE.square,icon:r||o,iconHover:s||r,iconActive:o||r,iconActiveHover:a||o||r,iconPosition:NA.left,iconColor:this.theme.iconColor,iconColorActive:this.theme.iconColorActive,fill:this.theme.fill,fillAlpha:this.theme.fillAlpha,fillActive:this.theme.fillActive,fillActiveAlpha:this.theme.fillActiveAlpha,stroke:this.theme.stroke,strokeWidth:this.theme.strokeWidth,strokeAlpha:this.theme.strokeAlpha,strokeActive:this.theme.strokeActive,strokeActiveWidth:this.theme.strokeActiveWidth,strokeActiveAlpha:this.theme.strokeActiveAlpha,textStyle:this.theme.textStyle,textActiveStyle:this.theme.textActiveStyle,radius:this.theme.radius,disabled:!1,active:!1,visible:!0,action:null,type:BA.default,...l},this.interactive=!0,this.cursor="pointer",this.visible=this.options.visible,this.text=null,this.layout=null,this.content=null}setupLayout(){this.layout=new hn,this.addChild(this.layout),this.content=new mn,this.addChild(this.content),this.options.label&&(this.text=new Sv(this.options.label,this.options.textStyle));let t=20;this.text&&(t=this.text.height),this.options.icon&&(this.iconInactive=Cw(this.options.icon,this.options.iconSize||t),this.iconHover=this.iconInactive,this.iconActive=this.iconInactive,this.iconActiveHover=this.iconInactive),this.options.icon!==this.options.iconHover&&(this.iconHover=Cw(this.options.iconHover,this.options.iconSize||t)),this.options.icon!==this.options.iconActive&&(this.iconActive=Cw(this.options.iconActive,this.options.iconSize||t)),this.options.icon!==this.options.iconActiveHover&&(this.iconActiveHover=Cw(this.options.iconActiveHover,this.options.iconSize||t)),this.isActive=this.options.active,this.isDisabled=this.options.disabled,this.position.set(this.options.x,this.options.y)}setupEvent(){this.on("pointerover",()=>{this.isHover=!0}),this.on("pointerout",()=>{this.isHover=!1}),this.on("pointerdown",()=>{this.isClickDown=!0}),this.on("pointerup",t=>{this.isClickDown&&(this.options.type===BA.checkbox&&(this.isActive=!this.isActive),this.options.action&&typeof this.options.action=="function"&&this.options.action(t),this.isClickDown=!1)})}renderContent(){this.removeChild(this.content),this.content=new mn,this.addChild(this.content),this.isActive?this.icon=this.isHover?this.iconActiveHover:this.iconActive:this.icon=this.isHover?this.iconHover:this.iconInactive,this.text&&(this.text.position.set(0,0),this.text.style=this.isActive?this.options.textActiveStyle:this.options.textStyle);let t=0;this.icon&&this.text?t=this.icon.width+this.text.width+3*this.options.padding:this.icon?t=this.icon.width+2*this.options.padding:this.text&&(t=this.text.width+2*this.options.padding);let i=0;this.icon?i=this.icon.height+2*this.options.padding:this.text&&(i=this.text.height+2*this.options.padding),this.icon&&!this.text&&(t=i=Math.max(t,i)),this.buttonWidth=t,this.buttonHeight=i,this.icon&&this.text?(this.options.iconPosition===NA.right?this.icon.x=this.text.width+this.options.padding:this.text.x=this.icon.width+this.options.padding,this.content.addChild(this.icon,this.text)):this.icon?this.content.addChild(this.icon):this.text&&this.content.addChild(this.text),this.content.x=(this.buttonWidth-this.content.width)/2,this.content.y=(this.buttonHeight-this.content.height)/2;for(const r of this.content.children)r.y=this.content.height/2-r.height/2;this.draw()}draw(){this.layout.clear(),this.isActive?(this.layout.lineStyle(this.options.strokeActiveWidth,this.options.strokeActive,this.options.strokeActiveAlpha),this.layout.beginFill(this.options.fillActive,this.options.fillActiveAlpha)):(this.layout.lineStyle(this.options.strokeWidth,this.options.stroke,this.options.strokeAlpha),this.layout.beginFill(this.options.fill,this.options.fillAlpha)),this.options.shape===nE.ellipse?this.layout.drawEllipse(this.buttonWidth/2,this.buttonHeight/2,this.buttonWidth/2,this.buttonHeight/2):this.layout.drawRoundedRect(0,0,this.buttonWidth,this.buttonHeight,this.options.radius),this.layout.endFill()}show(){this.options.strokeAlpha=Ws.full,this.options.strokeActiveAlpha=Ws.full,this.options.fillAlpha=Ws.full,this.options.fillActiveAlpha=Ws.full,this.renderContent()}hide(){this.options.strokeAlpha=Ws.min,this.options.strokeActiveAlpha=Ws.min,this.options.fillAlpha=Ws.min,this.options.fillActiveAlpha=Ws.min,this.renderContent()}}let cke=class extends hn{constructor(t={}){super();E(this,"options");E(this,"theme");E(this,"buttons",[]);E(this,"isGroupDisabled",!1);this.init(t),this.setupLayout(),this.renderContent()}get isDisabled(){return this.isGroupDisabled}set isDisabled(t){this.isGroupDisabled=t,this.buttons.forEach(i=>i.isDisabled=t)}init(t){const{theme:i,...r}=t;this.theme=_7.getThemeConfig(i),this.options={x:0,y:0,padding:this.theme.padding,iconPosition:NA.left,iconColor:this.theme.iconColor,iconColorActive:this.theme.iconColorActive,fill:this.theme.fill,fillAlpha:this.theme.fillAlpha,fillActive:this.theme.fillActive,fillActiveAlpha:this.theme.fillActiveAlpha,stroke:this.theme.stroke,strokeWidth:this.theme.strokeWidth,strokeAlpha:this.theme.strokeAlpha,strokeActive:this.theme.strokeActive,strokeActiveWidth:this.theme.strokeActiveWidth,strokeActiveAlpha:this.theme.strokeActiveAlpha,textStyle:this.theme.textStyle,textActiveStyle:this.theme.textActiveStyle,radius:this.theme.radius,disabled:null,visible:!0,type:BA.default,orientation:wf.horizontal,space:0,...r},this.buttons=[],this.interactive=!0}setupLayout(){let t=0;for(const i of this.options.buttons){delete i.x,delete i.y,this.options.orientation===wf.horizontal?i.x=t:i.y=t,i.theme=i.theme||this.options.theme,i.padding=i.padding||this.options.padding,i.iconPosition=i.iconPosition||this.options.iconPosition,i.iconColor=i.iconColor||this.options.iconColor,i.iconColorActive=i.iconColorActive||this.options.iconColorActive,i.fill=i.fill||this.options.fill,i.fillAlpha=i.fillAlpha||this.options.fillAlpha,i.fillActive=i.fillActive||this.options.fillActive,i.fillActiveAlpha=i.fillActiveAlpha||this.options.fillActiveAlpha,i.stroke=i.stroke||this.options.stroke,i.strokeWidth=i.strokeWidth??this.options.strokeWidth,i.strokeAlpha=i.strokeAlpha??this.options.strokeAlpha,i.strokeActive=i.strokeActive||this.options.strokeActive,i.strokeActiveWidth=i.strokeActiveWidth??this.options.strokeActiveWidth,i.strokeActiveAlpha=i.strokeActiveAlpha??this.options.strokeActiveAlpha,i.textStyle=i.textStyle||this.options.textStyle,i.textActiveStyle=i.textActiveStyle||this.options.textActiveStyle,i.radius=i.radius??this.options.radius;const r=new iE(i);this.addChild(r),this.buttons.push(r),t+=this.options.orientation===wf.horizontal?r.width:r.height,this.options.separate&&(t+=this.options.space)}if(this.options.orientation===wf.vertical){const i=this.buttons.map(s=>s.width),r=Math.max(...i);this.buttons.forEach(s=>{s.width=r,s.renderContent()})}this.options.disabled!==null&&(this.isDisabled=this.options.disabled),this.position.set(this.options.x,this.options.y)}renderContent(){this.options.separate||this.draw()}draw(){this.buttons.forEach(t=>t.hide()),this.clear(),this.lineStyle(this.options.strokeWidth,this.options.stroke,this.options.strokeAlpha),this.beginFill(this.options.fill,this.options.fillAlpha),this.drawRoundedRect(0,0,this.width,this.height,this.options.radius),this.lineStyle(this.options.strokeWidth,this.options.stroke,this.options.strokeAlpha/2),this.buttons.forEach((t,i)=>{i>0&&(this.moveTo(t.x,t.y),this.options.orientation===wf.horizontal?this.lineTo(t.x,t.height):this.lineTo(t.width,t.y))}),this.endFill()}show(){this.alpha=Ws.full}hide(){this.alpha=Ws.min}};var uo,Ii,Ru,UE,y7,GE,A7,f0,JD,HE,b7,p0,ZD,VE,w7;class uke extends mn{constructor(t){super();ke(this,UE);ke(this,GE);ke(this,f0);ke(this,HE);ke(this,p0);ke(this,VE);E(this,"config");E(this,"addToContainer");E(this,"isPointerDown");ke(this,uo,void 0);ke(this,Ii,void 0);ke(this,Ru,void 0);E(this,"buttonGroup");E(this,"display");E(this,"viewportScale");E(this,"viewportWorldWidth");E(this,"viewportWorldHeight");E(this,"onRecord");E(this,"selectDisplay");E(this,"processController");E(this,"imageProcessConfig");E(this,"mountMode");E(this,"getViewSize");E(this,"start",t=>{S(this,uo).visible||(this.isPointerDown=!0,Ht(this,f0,JD).call(this),S(this,Ii).clear().lineStyle(Za).drawRect(0,0,1,1).endFill(),S(this,Ii).position.set(t.x,t.y))});E(this,"update",t=>{if(this.isPointerDown){const{x:i,y:r}=S(this,Ii).position,{x:s,y:o}=t;S(this,Ii).clear().lineStyle(Za).drawRect(0,0,s-i,o-r)}});E(this,"end",(t,i)=>{if(!this.isPointerDown)return;this.isPointerDown=!1;const{position:{x:r,y:s}}=S(this,Ii),{x:o,y:a}=t,l=r.toFixed()===o.toFixed(),c=s.toFixed()===a.toFixed();if(l&&c){S(this,Ii).clear();return}o<r&&(S(this,Ii).position.x=o),a<s&&(S(this,Ii).position.y=a);const u=Math.abs(o-r),h=Math.abs(a-s);if(u<=1||h<=1){S(this,Ii).clear();return}this.display=i,this.drawCutterArea({width:u,height:h})});E(this,"confirm",()=>{S(this,uo).visible&&(Ht(this,UE,y7).call(this),this.cancel())});E(this,"cancel",()=>{var t;S(this,uo).visible&&(S(this,uo).visible=!1,S(this,Ii).destroy(),(t=this.buttonGroup)==null||t.destroy(),Qe(this,Ii,null),this.buttonGroup=null,S(this,Ru).filters=[],this.selectDisplay([]),this.interactive=!1)});const{newDisplay:i}=t;this.config=tCe,this.name=rh.CUTTER,this.cursor=rh.CUTTER,this.addToContainer=!0,this.isPointerDown=!1,this.viewportScale=t.viewportScale,this.viewportWorldWidth=t.viewportWorldWidth,this.viewportWorldHeight=t.viewportWorldHeight,this.mountMode=t.mountMode,this.onRecord=t.onRecord,this.selectDisplay=t.selectDisplay,this.processController=t.processController,this.imageProcessConfig=t.imageProcessConfig,this.display=i,this.getViewSize=t.getViewSize,Qe(this,Ru,new mn),this.addChild(S(this,Ru)),Ht(this,GE,A7).call(this)}calIsNotIntersect(t){const{x:i,y:r,width:s,height:o}=this.display.getBounds(),a=new Ae(i,r),l=new Ae(i+s,r+o),c=new Ae(l.x,a.y),u=new Ae(a.x,l.y),d=[a,c,l,u].every(p=>!S(this,Ii).containsPoint(p)),f=t.every(p=>!CMe(this.display,p));return d&&f}updateBounds(t,i){const{x:r,y:s,width:o,height:a}=this.display.getBounds(),l=r+o,c=s+a;t.x<r?t.x=r:t.x>l&&(t.x=l),t.y<s?t.y=s:t.y>c&&(t.y=c),i.x<r?i.x=r:i.x>l&&(i.x=l),i.y<s?i.y=s:i.y>c&&(i.y=c)}updateAttr(){}onStageResize(t,i){this.mountMode==="stage"&&S(this,uo)&&(S(this,uo).width=t,S(this,uo).height=i)}drawCutterArea(t,i){const{width:r,height:s}=t;S(this,Ii)||Ht(this,f0,JD).call(this),S(this,Ii).clear().beginFill(0,1).lineStyle(Za).drawRect(0,0,r,s).endFill(),this.interactive=!0,i&&S(this,Ii).position.set(i.x,i.y),this.selectDisplay([S(this,Ii)]),S(this,Ii).blendMode=Xt.ERASE,S(this,uo).visible=!0,S(this,Ru).filters=[new BY.AlphaFilter],Ht(this,HE,b7).call(this)}actived(){const{display:{width:t,height:i,x:r,y:s}}=this,{cutter:{showDefaultArea:o=!1}}=this.imageProcessConfig;o&&this.drawCutterArea({width:t,height:i},{x:r,y:s})}}uo=new WeakMap,Ii=new WeakMap,Ru=new WeakMap,UE=new WeakSet,y7=function(){const{display:t}=this,{x:i,y:r,width:s,height:o}=S(this,Ii).getBounds(),a=new Ae(i,r),l=new Ae(i+s,r+o);this.updateBounds(a,l);const c=Math.abs(l.x-a.x),u=Math.abs(l.y-a.y);if(c<=1||u<=1)return;const h=new Ae(l.x,a.y),d=new Ae(a.x,l.y);if(this.calIsNotIntersect([a,h,l,d]))return;const p=t.toLocal(a),g=t.toLocal(h),m=t.toLocal(l),v=t.toLocal(d),_={minLocalPoint:p,rtLocalPoint:g,maxLocalPoint:m,lbLocalPoint:v};if(this.processController.clip(_),t.angle%360===0){const y=t.parent.toLocal(a);t.x=y.x,t.y=y.y}else if(t.angle%360===90){const y=t.parent.toLocal(h);t.x=y.x,t.y=y.y}this.display.texture.update(),this.onRecord()},GE=new WeakSet,A7=function(){const{width:t,height:i}=this.getViewSize();Qe(this,uo,new hn().beginFill(0,.6).drawRect(0,0,t,i).endFill()),S(this,uo).name="SHADOW",S(this,uo).visible=!1,S(this,Ru).addChild(S(this,uo))},f0=new WeakSet,JD=function(){Qe(this,Ii,new hn),S(this,Ii).lockRatio=!1,S(this,Ii).name="SELECTOR",S(this,Ii).transformUpdate=()=>{Ht(this,p0,ZD).call(this)},S(this,Ru).addChild(S(this,Ii))},HE=new WeakSet,b7=function(){const t=this.imageProcessConfig.cutter,{confirm:i,cancel:r,groupConfig:s}=t;if(i&&r){const o=new cke({...s,padding:0,strokeWidth:0,strokeActiveWidth:0,buttons:[{iconSize:24,...r,icon:(r==null?void 0:r.icon)||"cancel",iconHover:(r==null?void 0:r.iconHover)||"cancel_hover",action:this.cancel,padding:6},{iconSize:24,...i,icon:(i==null?void 0:i.icon)||"cancel",iconHover:(i==null?void 0:i.iconHover)||"confirm_hover",action:this.confirm,padding:6}],stroke:9610137,strokeAlpha:.3});this.addChild(o),this.buttonGroup=o,Ht(this,p0,ZD).call(this)}},p0=new WeakSet,ZD=function(){if(this.buttonGroup){const t=Ht(this,VE,w7).call(this);this.buttonGroup.position.set(t.x,t.y)}},VE=new WeakSet,w7=function(){var o,a,l,c;const t=((a=(o=this.imageProcessConfig.cutter)==null?void 0:o.groupConfig)==null?void 0:a.margin)??0,i=((c=(l=this.imageProcessConfig.cutter)==null?void 0:l.groupConfig)==null?void 0:c.align)||"end",r=S(this,Ii).getBounds();return{[Om.start]:()=>{const u=this.toLocal(new Ae(r.x,r.height+r.y));return{x:u.x,y:u.y+t}},[Om.center]:()=>{const u=this.toLocal(new Ae(r.x+r.width/2,r.height+r.y));return{x:u.x-this.buttonGroup.width/2,y:u.y+t}},[Om.end]:()=>{const u=this.toLocal(new Ae(r.x+r.width,r.height+r.y));return{x:u.x-this.buttonGroup.width,y:u.y+t}}}[i]()};var Jf,Ma,g0,ek,Jm,jx;class hke extends hn{constructor(t){super();ke(this,g0);ke(this,Jm);E(this,"size");E(this,"addToContainer");E(this,"isPointerDown");E(this,"viewportWorldWidth");E(this,"viewportWorldHeight");ke(this,Jf,void 0);ke(this,Ma,void 0);E(this,"onRecord");E(this,"processController");E(this,"scaleNum");E(this,"viewportScale");E(this,"mountMode");E(this,"getViewSize");E(this,"start",(t,i)=>{this.size!==0&&(Qe(this,Jf,t),S(this,Ma).push(t),this.isPointerDown=!0,Ht(this,Jm,jx).call(this,i))});E(this,"update",(t,i)=>{if(this.updateCursorVisible(t),!!this.isPointerDown&&this.size!==0&&(S(this,Ma).push(t),S(this,Ma).length>3)){const r=S(this,Ma).slice(-2),s=r[0],o=new Ae((r[0].x+r[1].x)/2,(r[0].y+r[1].y)/2);Ht(this,Jm,jx).call(this,i,s,o),Qe(this,Jf,o)}});E(this,"end",(t,i)=>{if(this.isPointerDown&&this.size!==0){if(S(this,Ma).push(t),S(this,Ma).length>3){const r=S(this,Ma).slice(-2),s=r[0],o=r[1];Ht(this,Jm,jx).call(this,i,s,o)}Qe(this,Jf,null),this.isPointerDown=!1,Qe(this,Ma,[]),this.onRecord()}});this.name=rh.ERASER,this.cursor="none",this.size=0,Qe(this,Ma,[]),this.viewportWorldHeight=t.viewportWorldHeight,this.viewportWorldWidth=t.viewportWorldWidth,this.viewportScale=t.viewportScale,this.mountMode=t.mountMode,this.processController=t.processController,this.onRecord=t.onRecord,this.visible=!1,this.addToContainer=!0,this.isPointerDown=!1,this.getViewSize=t.getViewSize,Ht(this,g0,ek).call(this)}updateAttr(t){"size"in t&&(this.size=Number(t.size)||0,Ht(this,g0,ek).call(this))}updateCursorVisible(t){const{width:i,height:r}=this.getViewSize();this.x=t.x,this.y=t.y,this.visible=t.x>=0&&t.x<=i&&t.y>=0&&t.y<=r}unactived(){this.visible=!1}}Jf=new WeakMap,Ma=new WeakMap,g0=new WeakSet,ek=function(t=new Ae(0,0)){this.clear().lineStyle(Za);const i=this.size||1;this.drawEllipse(t.x,t.y,i/2,i/2)},Jm=new WeakSet,jx=function(t,i,r){const s=this.mountMode==="stage"?this.viewportScale.x:1,o=this.size/t.scale.x/s,a=t.parent.parent.toGlobal(S(this,Jf)),l=t.toLocal(a);let c,u,h=!1;if(i&&r){const d=t.parent.parent.toGlobal(i);c=t.toLocal(d);const f=t.parent.parent.toGlobal(r);u=t.toLocal(f),h=!0}this.processController.erasing({isCurveTo:h,radius:o,beginPoint:l,controlPoint:c,endPoint:u})};class dke{constructor(e){E(this,"aberration");E(this,"name");E(this,"isPointerDown");E(this,"cursor");E(this,"onRecord");E(this,"processController");E(this,"start",()=>{this.isPointerDown=!0});E(this,"update",()=>{});E(this,"end",(e,t)=>{if(!this.isPointerDown||(this.isPointerDown=!1,this.aberration===0))return;const i=t.parent.parent.toGlobal(e);if(!t.containsPoint(i))return;const s=t.toLocal(i);this.processController.magicSelect(s,this.aberration),this.onRecord()});this.isPointerDown=!1,this.name=rh.MAGIC_WAND,this.cursor=rh.MAGIC_WAND,this.aberration=0,this.onRecord=e.onRecord,this.processController=e.processController}updateAttr(e){"aberration"in e&&(this.aberration=Number(e.aberration)||0)}}const fke=[uke,dke,hke];var Pn,yi,Ts,kl,Zm,Zf,ep,m0,v0,_0,y0,zE,x7,$E,C7,WE,E7,jE,T7,QE,I7,XE,S7,ev,Qx,YE,P7,qE,A0,tk,b0,nk,KE,M7,JE,R7,ZE,D7;class I4{constructor(e){ke(this,zE);ke(this,$E);ke(this,WE);ke(this,jE);ke(this,QE);ke(this,XE);ke(this,ev);ke(this,YE);ke(this,A0);ke(this,b0);ke(this,KE);ke(this,JE);ke(this,ZE);ke(this,Pn,void 0);E(this,"container");E(this,"newDisplay");E(this,"backdrop");ke(this,yi,void 0);ke(this,Ts,void 0);ke(this,kl,void 0);ke(this,Zm,void 0);ke(this,Zf,void 0);E(this,"operationStack");E(this,"rect");ke(this,ep,void 0);E(this,"ratio");ke(this,m0,!1);E(this,"destroyed",!1);ke(this,v0,void 0);ke(this,_0,void 0);ke(this,y0,new Map);E(this,"onPointerDown",e=>{var t;Nc(e)&&(Qe(this,Zf,!0),(t=S(this,yi))==null||t.start(Ht(this,ev,Qx).call(this,e),this.newDisplay),this.newDisplay.texture.update())});E(this,"onPointerUp",e=>{var t;S(this,Zf)&&(Qe(this,Zf,!1),(t=S(this,yi))==null||t.end(Ht(this,ev,Qx).call(this,e),this.newDisplay),this.newDisplay.texture.update())});E(this,"onPointerMove",e=>{var t;Nc(e)&&e.isInView&&((t=S(this,yi))==null||t.update(Ht(this,ev,Qx).call(this,e),this.newDisplay),this.newDisplay.texture.update())});ke(this,qE,()=>{if(this.locking)return;const e=S(this,kl).getImageData(0,0,S(this,Ts).width,S(this,Ts).height);this.asyncModeEnabled?(this.locking=!0,Ht(this,JE,R7).call(this,e).then(t=>{Ht(this,A0,tk).call(this,t)},console.warn).finally(()=>{this.locking=!1})):Ht(this,A0,tk).call(this,e)});Qe(this,Zf,!1),Qe(this,Pn,e),Qe(this,ep,new a7),this.operationStack=new aI,Ht(this,$E,C7).call(this),Ht(this,WE,E7).call(this),Ht(this,jE,T7).call(this),Ht(this,XE,S7).call(this,e.tool,e),this.asyncModeEnabled&&(console.log("[ ImageProcess ] asyncMode",this.asyncModeEnabled),Ht(this,KE,M7).call(this,e.imageProcessConfig.asyncMode)),Ht(this,zE,x7).call(this),Ht(this,QE,I7).call(this),Ht(this,YE,P7).call(this),S(this,Pn).onStageResize&&S(this,Pn).onStageResize.add(this)}get locking(){return this.asyncModeEnabled?S(this,m0):!1}set locking(e){this.asyncModeEnabled&&Qe(this,m0,e)}get asyncModeEnabled(){var e,t,i;return((i=(t=(e=S(this,Pn))==null?void 0:e.imageProcessConfig)==null?void 0:t.asyncMode)==null?void 0:i.enabled)??!1}get viewSize(){let e;return S(this,Pn).mountMode==="stage"?e={width:S(this,Pn).viewportScreenWidth,height:S(this,Pn).viewportScreenHeight}:e={width:S(this,Pn).viewportWorldWidth,height:S(this,Pn).viewportWorldHeight},e}onStageResize(e,t){var i,r;if(((i=S(this,Pn))==null?void 0:i.mountMode)==="stage"){S(this,Pn)&&(S(this,Pn).viewportScreenWidth=e,S(this,Pn).viewportScreenHeight=t);const s=(r=this.container)==null?void 0:r.hitArea;s&&(s.width=e,s.height=t),this.backdrop&&(this.backdrop.width=e,this.backdrop.height=t)}}wrapEventHandler(e){return this.asyncModeEnabled?(...t)=>{if(!this.locking)return e(...t)}:e}updateTool(e,t){var r,s,o;mt(S(this,yi).cancel)&&S(this,yi).cancel();const{updateCursor:i}=S(this,Pn);if(this[`#${e}`]){if(S(this,yi).name!==e){const a=S(this,yi);(r=a.unactived)==null||r.call(a),Qe(this,yi,this[`#${e}`]),(o=(s=S(this,yi)).actived)==null||o.call(s)}i==null||i(S(this,yi).cursor),S(this,yi).updateAttr&&t&&S(this,yi).updateAttr(t)}}cancel(){S(this,yi)&&mt(S(this,yi).cancel)&&S(this,yi).cancel()}confirm(){S(this,yi)&&mt(S(this,yi).confirm)&&S(this,yi).confirm()}destroyAll(){mt(S(this,yi).cancel)&&S(this,yi).cancel(),S(this,Pn).onStageResize&&(S(this,Pn).onStageResize.remove(this),S(this,y0).forEach(e=>{S(this,Pn).onStageResize.remove(e)})),this.destoryContainer(this.newDisplay),this.newDisplay=null,this.destoryContainer(this.backdrop),this.backdrop=null,this.destoryContainer(this.container),this.container=null,Qe(this,Ts,null),Qe(this,kl,null),Qe(this,Zm,null),Qe(this,ep,null),this.destroyed=!0}destoryContainer(e){e&&(e.children.forEach(t=>{t.destroy(!0)}),e.destroy(!0))}setFinalDisplay(){const{width:e,height:t,data:i}=L9(S(this,Ts));if(!i){this.newDisplay=null;return}const r=S(this,Pn).display;S(this,Ts).width=e,S(this,Ts).height=t,S(this,kl).putImageData(i,0,0),this.newDisplay.texture.update(),this.ratio&&(this.newDisplay.width*=this.ratio.x,this.newDisplay.height*=this.ratio.y),this.newDisplay.interactive=!0,this.newDisplay.lockRatio=!0,S(this,Pn).isBackground||(this.newDisplay.id=r.id);const s=N9(r);this.newDisplay.parseJSON(s),this.newDisplay.grayValue=Ty.GRAY_VALUE,this.newDisplay.sharpness=Ty.SHARPNESS,this.newDisplay.anchor.set(0,0),this.newDisplay.x=S(this,Pn).finalPosition.x,this.newDisplay.y=S(this,Pn).finalPosition.y,this.newDisplay.updateOriginDatasource(S(this,Ts),S(this,kl))}getOriginalDisplay(){var e;return(e=S(this,Pn))==null?void 0:e.display}enableDestroyOriginalDisplay(){return!S(this,Pn).isBackground}getResult(){var t,i,r;this.setFinalDisplay(),(t=this.newDisplay)==null||t.emit(mo.DRAW_DONE,this.newDisplay),this.operationStack.clear();const e=this.newDisplay;return this.newDisplay&&((r=(i=this.newDisplay.parent)==null?void 0:i.removeChild)==null||r.call(i,this.newDisplay),this.newDisplay=null),e}get canUndo(){return this.operationStack.canUndo}get canRedo(){return this.operationStack.canRedo}undo(){this.locking||(this.operationStack.undo(),this.redraw())}redo(){this.locking||(this.operationStack.redo(),this.redraw())}redraw(){if(this.locking)return;const{curImageData:e}=this.operationStackTop;this.asyncModeEnabled?(this.locking=!0,Ht(this,ZE,D7).call(this,e).then(t=>{Ht(this,b0,nk).call(this,t)},console.warn).finally(()=>{this.locking=!1})):Ht(this,b0,nk).call(this,e)}get operationStackTop(){return this.operationStack.top||S(this,Zm)}}Pn=new WeakMap,yi=new WeakMap,Ts=new WeakMap,kl=new WeakMap,Zm=new WeakMap,Zf=new WeakMap,ep=new WeakMap,m0=new WeakMap,v0=new WeakMap,_0=new WeakMap,y0=new WeakMap,zE=new WeakSet,x7=function(){var e,t,i,r,s,o,a,l,c;((e=S(this,Pn))==null?void 0:e.mountMode)==="stage"?((i=(t=S(this,Pn))==null?void 0:t.setStageBg)==null||i.call(t,this.backdrop),(s=(r=S(this,Pn)).addViewportChild)==null||s.call(r,this.newDisplay),(a=(o=S(this,Pn)).addStageChild)==null||a.call(o,this.container,2)):(this.container.addChildAt(this.newDisplay,0),this.container.addChildAt(this.backdrop,0),(c=(l=S(this,Pn)).addViewportChild)==null||c.call(l,this.container))},$E=new WeakSet,C7=function(){const{width:e,height:t}=this.viewSize,i=new mn;i.name="ImageProcess",i.width=e,i.height=t,i.position.set(0,0),this.container=i},WE=new WeakSet,E7=function(){const{width:e,height:t}=this.viewSize,{imageProcessConfig:i}=S(this,Pn),r=new Image;r.src=i.backdrop;const s=Wt.from(r),o=new o2(s,e,t);o.name="ALPHA_BG",o.interactive=!1,this.backdrop=o},jE=new WeakSet,T7=function(){const{newDisplay:e}=S(this,Pn),{canvas:t,ctx:i}=tD(e);Qe(this,Ts,t),Qe(this,kl,i),S(this,ep).setOptions({canvas:S(this,Ts),ctx:S(this,kl)}),this.newDisplay=e},QE=new WeakSet,I7=function(){const{viewportScale:e,viewportPosition:t,viewportWorldWidth:i,viewportWorldHeight:r,setDisplayPosition:s,finalPosition:o}=S(this,Pn),{width:a,height:l}=GC(this.newDisplay,{width:i,height:r});this.newDisplay.width=a,this.newDisplay.height=l,this.ratio={x:o.width/a,y:o.height/l};const c=mp(this.newDisplay).getRectangle(),u=t.x+i*e.x/2,h=t.y+r*e.y/2,d=(c.x+c.width/2-u)/e.x,f=(c.y+c.height/2-h)/e.y,p=new Ae(this.newDisplay.x-d,this.newDisplay.y-f);s(this.newDisplay,p)},XE=new WeakSet,S7=function(e=rh.MAGIC_WAND,t){fke.forEach(i=>{const{viewportScreenWidth:r,viewportScreenHeight:s,viewportWorldWidth:o,viewportWorldHeight:a,viewportScale:l,selectDisplay:c,imageProcessConfig:u,newDisplay:h,updateCursor:d}=S(this,Pn),f=new i({viewportScreenWidth:r,viewportScreenHeight:s,viewportWorldHeight:a,viewportWorldWidth:o,viewportScale:l,mountMode:S(this,Pn).mountMode,onRecord:S(this,qE),processController:S(this,ep),selectDisplay:c,imageProcessConfig:u,newDisplay:h,getViewSize:()=>this.viewSize}),p=f.name;this[`#${p}`]=f,this[`#${p}`].addToContainer&&this.container.addChild(this[`#${p}`]),S(this,y0).set(f.name,f),S(this,Pn).onStageResize&&S(this,Pn).onStageResize.add(f),e===p&&(Qe(this,yi,this[`#${p}`]),S(this,yi).updateAttr(t),d==null||d(S(this,yi).cursor))})},ev=new WeakSet,Qx=function(e){return e.data.getLocalPosition(this.container)},YE=new WeakSet,P7=function(){const{width:e,height:t}=S(this,Ts),{x:i,y:r}=this.newDisplay,s=S(this,kl).getImageData(0,0,e,t);Qe(this,Zm,{curTool:S(this,yi).name,curImageData:s,curCanvasWidth:e,curCanvasHeight:t,curDisplayX:i,curDisplayY:r})},qE=new WeakMap,A0=new WeakSet,tk=function(e){if(this.destroyed)return;const t={curTool:S(this,yi).name,curCanvasWidth:S(this,Ts).width,curCanvasHeight:S(this,Ts).height,curDisplayX:this.newDisplay.x,curDisplayY:this.newDisplay.y,curImageData:e};this.operationStack.push(t)},b0=new WeakSet,nk=function(e){if(this.destroyed)return;if(!(e instanceof ImageData))throw TypeError("imageData not valid");const{curCanvasWidth:t,curCanvasHeight:i,curDisplayX:r,curDisplayY:s}=this.operationStackTop;S(this,Ts).width=t,S(this,Ts).height=i,S(this,kl).putImageData(e,0,0),this.newDisplay.x=r,this.newDisplay.y=s,this.newDisplay.texture.update()},KE=new WeakSet,M7=function(e){if(typeof e.saveImageData!="function"||typeof e.loadImageData!="function")throw TypeError("saveImageData and loadImageData must be a function");Qe(this,v0,e.saveImageData),Qe(this,_0,e.loadImageData)},JE=new WeakSet,R7=async function(e){try{const t=await S(this,v0).call(this,e);return t===void 0&&console.error("saveImageDataFn must return a not empty value"),t??e}catch(t){return console.error(t),e}},ZE=new WeakSet,D7=async function(e){if(e instanceof ImageData)return e;try{const t=await S(this,_0).call(this,e);return t===void 0&&console.error("loadImageDataFn must return a not empty value"),t??e}catch(t){return console.error(t),e}};const pke="trace_background";var Is,eT,k7;class gke{constructor(e){ke(this,eT);ke(this,Is,void 0);E(this,"container");E(this,"backdrop");E(this,"bitmapBg");E(this,"moldDisplay");E(this,"traceDisplays");E(this,"imageDataScale",1);E(this,"setTransformBy",(e,t,i)=>{const r=new Dt;if(r.scale(1/this.imageDataScale,1/this.imageDataScale),t.mask){const s=mp(t,t),o={x:s.minX,y:s.minY};r.translate(o.x,o.y)}r.prepend(t.localTransform),this.container.parent!==t.parent&&(t=t.parent,r.prepend(t.localTransform)),e.transform.setFromMatrix(r)});Qe(this,Is,e),this.createContainer(),this.renderBackdrop(),this.addDisplay(),Ht(this,eT,k7).call(this),this.updateCloneDisplayAttrs(),S(this,Is).onStageResize&&S(this,Is).onStageResize.add(this)}get options(){return S(this,Is)}get originDisplay(){return this.options.display}get viewSize(){let e;return S(this,Is).mountMode==="stage"?e={width:S(this,Is).viewportScreenWidth,height:S(this,Is).viewportScreenHeight}:e={width:S(this,Is).viewportWorldWidth,height:S(this,Is).viewportWorldHeight},e}onStageResize(e,t){var i;((i=S(this,Is))==null?void 0:i.mountMode)==="stage"&&this.backdrop&&(this.backdrop.width=e,this.backdrop.height=t)}removeTraceDisplay(){this.traceDisplays&&this.traceDisplays.length>0&&this.traceDisplays.forEach(e=>{e.destroy(!0),e=null}),this.traceDisplays=[]}getTraceDisplay(){return this.traceDisplays.forEach(e=>{this.reproducePosition(e,this.options.display,!0)}),this.traceDisplays}addPathToContainer(e,t,i){if(!e||e==="M0,0")return null;const{lineColor:r}=this.options.displayConfig,s=Us(it.PATH,{dPath:e,graphicX:0,graphicY:0,fillColor:null,lineColor:r,layerColor:t,layerTag:kd.convertToLayerColorHex(i),isFill:!1,enableFill:!1});return s.originColor=i,this.addTraceDisplay(s),s}reproducePosition(e,t,i){this.setTransformBy(e,t,i)}addTraceDisplay(e){this.reproducePosition(e,this.moldDisplay,!1),this.traceDisplays.push(e),this.container.addChild(e)}createContainer(){const{viewportWorldWidth:e,viewportWorldHeight:t}=this.options,i=new mn;i.width=e,i.height=t,i.position.set(0,0),this.container=i}renderBackdrop(){const{width:e,height:t}=this.viewSize,{imageProcessConfig:i}=this.options,r=new Image;r.src=i.backdrop;const s=Wt.from(r),o=new o2(s,e,t);o.name=pke,o.interactive=!1,this.backdrop=o}addDisplay(){const e=this.options.moldDisplay,t=new Ur(e.texture);t.filters=[new F1e(16777215,1)],t.mask=e.mask,t.transform.setFromMatrix(t.localTransform.copyFrom(e.localTransform)),this.bitmapBg=t,this.container.addChild(t),this.moldDisplay=e,this.moldDisplay.alpha=.2,this.container.addChild(this.moldDisplay)}updateCloneDisplayAttrs(){return this.fitToViewport(this.options.display,this.moldDisplay)}fitToViewport(e,t){const i=[0,0,this.options.viewportWorldWidth,this.options.viewportWorldHeight];let r;if(e.mask)r=mp(e,e.parent).getRectangle();else{const o=new oi;Xp(o,e.getBounds()),r=YY(e.parent,o).getRectangle()}const s=EMe(r,i);t.transform.setFromMatrix(t.localTransform.prepend(s)),this.bitmapBg.transform.setFromMatrix(this.bitmapBg.localTransform.copyFrom(t.localTransform))}getOriginalDisplay(){var e;return(e=this.options)==null?void 0:e.display}destroyAll(){S(this,Is).onStageResize&&S(this,Is).onStageResize.remove(this),this.container.children.forEach(e=>{e.destroy(!0)}),this.container.destroy(),this.container=null,this.moldDisplay=null}}Is=new WeakMap,eT=new WeakSet,k7=function(){var e,t,i;((e=S(this,Is))==null?void 0:e.mountMode)==="stage"?(i=(t=S(this,Is))==null?void 0:t.setStageBg)==null||i.call(t,this.backdrop):this.container.addChildAt(this.backdrop,0),this.options.addViewportChild(this.container)};const S4={minX:NaN,minY:NaN,maxX:NaN,maxY:NaN};class mke extends hn{constructor(t){super();E(this,"ruler");E(this,"params",S4);this.ruler=t}draw(){this.clear();const{positions:t,markColor:i,markAlpha:r}=this.ruler.options;this.beginFill(i,r),t.forEach(s=>{const{x:o,y:a,w:l,h:c}=this.getDrawOptions(s);this.drawRect(o,a,l,c)}),this.endFill()}update(t){this.params=t,this.draw()}getDrawOptions(t){const{stageWidth:i,stageHeight:r,stageScale:s,offset:o,size:a}=this.ruler,{minX:l,maxX:c,minY:u,maxY:h}=this.params;return{[fs.TOP]:{x:l*s+o.x,y:0,w:(c-l)*s,h:a},[fs.BOTTOM]:{x:l*s+o.x,y:r-a,w:(c-l)*s,h:a},[fs.LEFT]:{x:0,y:u*s+o.y,w:a,h:(h-u)*s},[fs.RIGHT]:{x:i-a,y:u*s+o.y,w:a,h:(h-u)*s}}[t]}clean(){this.clear(),this.params=S4}}var tp,is,tT,O7,nT,L7,iT,N7,rT,B7,sT,F7,oT,U7,aT,G7;class vke extends hn{constructor(t,i){super();ke(this,tT);ke(this,nT);ke(this,iT);ke(this,rT);ke(this,sT);ke(this,oT);ke(this,aT);E(this,"size",20);ke(this,tp,1);ke(this,is,void 0);E(this,"stageWidth");E(this,"stageHeight");E(this,"stageScale",1);E(this,"offset",{x:0,y:0});E(this,"scales");E(this,"mark");this.stageWidth=t.width,this.stageHeight=t.height,Qe(this,is,Object.assign({},iCe,i)),this.size=S(this,is).size,this.scales=new hn,this.mark=new mke(this),this.addChild(this.scales,this.mark),Qe(this,tp,window.devicePixelRatio)}get sparsity(){const t=this.stageWidth,i=this.stageScale,r=S(this,is).pixelPerUnit,s=t/i/r;return s<=20?1:s<=200?10:s<=2e3?100:s<=1e4?500:1e4}get options(){return S(this,is)}zoom(t,i,r){this.stageScale=t,this.offset.x=i,this.offset.y=r,this.draw()}resize(t,i){this.stageWidth=t,this.stageHeight=i,this.draw()}highlight(t){this.mark.update(t)}unHighlight(){this.mark.clean()}updateOptions(t){Qe(this,is,Object.assign({},S(this,is),t)),this.draw()}draw(){this.clearScale(),S(this,is).positions.forEach(t=>{const{canvasOption:{w:i,h:r},position:{x:s,y:o},offset:a,scaleTopWard:l,reverse:c}=Ht(this,sT,F7).call(this,t),u=Ht(this,oT,U7).call(this,i,r,a,l,c),h=new Ur(Wt.from(u));this.scales.addChild(h),u.remove(),h.x=s,h.y=o,h.scale.x=1/S(this,tp),h.scale.y=1/S(this,tp),c&&(h.angle=-90)}),this.mark.draw()}getRGBAFromHex(t,i){const r=t>>16&255,s=t>>8&255,o=t&255;return`rgba(${r},${s},${o},${i})`}clearScale(){this.scales.removeChildren().forEach(i=>{i.destroy(!0)})}}tp=new WeakMap,is=new WeakMap,tT=new WeakSet,O7=function(t){return t==="-0"?"0":t},nT=new WeakSet,L7=function(t){const i=String(t).indexOf("."),r=String(t).length;return i<0?0:r-i-1},iT=new WeakSet,N7=function(t,i){const r=document.createElement("canvas"),s=r.getContext("2d");return r.width=t,r.height=i,s.fillStyle=this.getRGBAFromHex(S(this,is).backgroundColor,1),s.fillRect(0,0,t,i),{canvas:r,ctx:s}},rT=new WeakSet,B7=function(t,i,r,s){t.lineWidth=1,t.strokeStyle=this.getRGBAFromHex(S(this,is).borderColor,S(this,is).borderAlpha),t.beginPath(),s?(t.moveTo(0,0),t.lineTo(i,0)):(t.moveTo(0,r),t.lineTo(i,r)),t.closePath(),t.stroke()},sT=new WeakSet,F7=function(t){const{stageWidth:i,stageHeight:r,size:s,offset:o}=this;return{[fs.TOP]:{canvasOption:{w:i,h:s},position:{x:0,y:0},offset:-o.x,scaleTopWard:!1,reverse:!1},[fs.BOTTOM]:{canvasOption:{w:i,h:s},position:{x:0,y:r-s},offset:-o.x,scaleTopWard:!0,reverse:!1},[fs.LEFT]:{canvasOption:{w:r,h:s},position:{x:0,y:r},offset:-o.y,scaleTopWard:!1,reverse:!0},[fs.RIGHT]:{canvasOption:{w:r,h:s},position:{x:i-s,y:r},offset:-o.y,scaleTopWard:!0,reverse:!0}}[t]},oT=new WeakSet,U7=function(t,i,r,s,o){const a=S(this,is).pixelPerUnit,l=S(this,tp),{stageScale:c,sparsity:u}=this;t=t*l,i=i*l,r=r*l;const{canvas:h,ctx:d}=Ht(this,iT,N7).call(this,t,i);Ht(this,rT,B7).call(this,d,t,i,s);const f=a*c*u*l,p=f/10,g=Ht(this,nT,L7).call(this,u);let m=r%p>0?p-r%p:-r%p;d.lineWidth=1*l,d.strokeStyle=this.getRGBAFromHex(S(this,is).scaleColor,S(this,is).scaleAlpha),d.font=`normal ${S(this,is).fontSize*l}px v-sans, system-ui, -apple-system, BlinkMacSystemFont, sans-serif`,d.fillStyle=this.getRGBAFromHex(S(this,is).fontColor,1);do{const v=(r+m)/f*u,_=o?t-m:m;Ht(this,aT,G7).call(this,v/u)?(d.moveTo(_,i),d.lineTo(_,0),d.fillText(Ht(this,tT,O7).call(this,v.toFixed(g)),_+4.5,i*(s?.65:.5))):(d.moveTo(_,s?0:i*.75),d.lineTo(_,s?i*.25:i)),m+=p}while(m<t);return d.closePath(),d.stroke(),h},aT=new WeakSet,G7=function(t){return Math.abs(t-Math.round(t))<1e-7};function _ke(n){if(!(this._activeParentLayer&&this._activeParentLayer!==n._activeLayer)){if(!this.visible){this.displayOrder=0;return}this.displayOrder=n.incDisplayOrder(),!(this.worldAlpha<=0||!this.renderable)&&(n._activeLayer=null,this.containerRenderWebGL(n),n._activeLayer=this._activeParentLayer)}}function yke(){if(rn.prototype.displayOrder!==void 0)return;Object.assign(rn.prototype,{parentLayer:null,_activeParentLayer:null,parentGroup:null,zOrder:0,zIndex:0,updateOrder:0,displayOrder:0,layerableChildren:!0,isLayer:!1});const n=mn.prototype;n.containerRenderWebGL=n.render,n.render=_ke}class Ake{constructor(){this._tempPoint=new Ae,this._queue=[[],[]],this._eventDisplayOrder=0,this.worksWithLayers=!0}recursiveFindHit(e,t,i,r,s){if(!t||!t.visible)return 0;let o=0,a=r=t.interactive||r;t.hitArea&&(a=!1),t._activeParentLayer&&(s=!1);const l=t._mask;i<1/0&&l&&l.containsPoint&&!l.containsPoint(e)&&(s=!0),i<1/0&&t.filterArea&&(t.filterArea.contains(e.x,e.y)||(s=!0));const c=t.children;if(t.interactiveChildren&&c)for(let u=c.length-1;u>=0;u--){const h=c[u],d=this.recursiveFindHit(e,h,i,a,s);if(d){if(!h.parent)continue;o=d,i=d}}return r&&(s?t.interactive&&this._queueAdd(t,0):(i<t.displayOrder&&(t.hitArea?(t.worldTransform.applyInverse(e,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)&&(o=t.displayOrder)):t.containsPoint&&t.containsPoint(e)&&(o=t.displayOrder)),t.interactive&&this._queueAdd(t,o===1/0?0:o))),o}findHit(e,t,i,r){const s=e.data.global;this._startInteractionProcess(),this.recursiveFindHit(s,t,r?0:1/0,!1,!1),this._finishInteractionProcess(e,i)}_startInteractionProcess(){this._eventDisplayOrder=1,this._queue||(this._queue=[[],[]]),this._queue[0].length=0,this._queue[1].length=0}_queueAdd(e,t){const i=this._queue;if(t<this._eventDisplayOrder)i[0].push(e);else{if(t>this._eventDisplayOrder){this._eventDisplayOrder=t;const r=i[1];for(let s=0,o=r.length;s<o;s++)i[0].push(r[s]);i[1].length=0}i[1].push(e)}}_finishInteractionProcess(e,t){const i=this._queue;let r=i[0];for(let s=0,o=r.length;s<o;s++)t&&t(e,r[s],!1);r=i[1];for(let s=0,o=r.length;s<o;s++)e.target||(e.target=r[s]),t&&t(e,r[s],!0)}}function bke(n){return function(t,i,r,s,o){(!i||!i.renderTexture&&!i.baseTexture)&&(this._lastDisplayOrder=0),this._activeLayer=null,t.isStage&&t.updateStage(),this.plugins.interaction&&!this.plugins.interaction.search.worksWithLayers&&(this.plugins.interaction.search=new Ake),n.call(this,t,i,r,s,o)}}function wke(n){const e=n.prototype;e._oldRender||(Object.assign(e,{_lastDisplayOrder:0,_activeLayer:null,incDisplayOrder(){return++this._lastDisplayOrder},_oldRender:sb.prototype.render}),e._oldRender=e.render,e.render=bke(e.render))}let ub=class pf extends Zr{constructor(e=0,t=!1){super(),this.useRenderTexture=!1,this.useDoubleBuffer=!1,this.sortPriority=0,this.clearColor=new Float32Array([0,0,0,0]),this.canDrawWithoutLayer=!1,this.canDrawInParentStage=!0,this._activeLayer=null,this._activeStage=null,this._activeChildren=[],this._lastUpdateId=-1,this.zIndex=e||0,this.enableSort=!!t,typeof t=="function"&&this.on("sort",t)}doSort(e,t){if(this.listeners("sort",!0))for(let i=0;i<t.length;i++)this.emit("sort",t[i]);t.sort(pf.compareZIndex)}static compareZIndex(e,t){return e.zOrder<t.zOrder?-1:e.zOrder>t.zOrder?1:e.updateOrder-t.updateOrder}clear(){this._activeLayer=null,this._activeStage=null,this._activeChildren.length=0}_resolveChildDisplayObject(e,t){this.check(e),t._activeParentLayer=this._activeLayer,this._activeLayer?this._activeLayer._activeChildren.push(t):this._activeChildren.push(t)}_resolveLayer(e,t){this.check(e),this._activeLayer&&pf.conflict(),this._activeLayer=t,this._activeStage=e}check(e){if(this._lastUpdateId<pf._layerUpdateId)this._lastUpdateId=pf._layerUpdateId,this.clear(),this._activeStage=e;else if(this.canDrawInParentStage){let t=this._activeStage;for(;t&&t!==e;)t=t._activeParentStage;this._activeStage=t,t===null&&this.clear()}}static conflict(){pf._lastLayerConflict+5e3<Date.now()&&(pf._lastLayerConflict=Date.now(),console.log("@pixi/layers found two layers with the same group in one stage - that's not healthy. Please place a breakpoint here and debug it"))}};ub._layerUpdateId=0;ub._lastLayerConflict=0;class P4{constructor(e){this.layer=e,this.renderTexture=null,this.doubleBuffer=null,this.currentBufferIndex=0,this._tempRenderTarget=null,this._tempRenderTargetSource=new Pt,this._tempRenderTargetDestination=new Pt}init(e){const t=e?e.screen.width:100,i=e?e.screen.height:100,r=e?e.resolution:xt.RESOLUTION;this.renderTexture=va.create({width:t,height:i,resolution:r}),this.layer.group.useDoubleBuffer&&(this.doubleBuffer=[va.create({width:t,height:i,resolution:r}),va.create({width:t,height:i,resolution:r})])}getRenderTexture(){return this.renderTexture||this.init(),this.renderTexture}pushTexture(e){const t=e.screen;this.renderTexture||this.init(e);const i=this.renderTexture,r=this.layer.group,s=this.doubleBuffer;if((i.width!==t.width||i.height!==t.height||i.baseTexture.resolution!==e.resolution)&&(i.baseTexture.resolution=e.resolution,i.resize(t.width,t.height),s&&(s[0].baseTexture.resolution=e.resolution,s[0].resize(t.width,t.height),s[1].baseTexture.resolution=e.resolution,s[1].resize(t.width,t.height))),s&&(s[0].framebuffer.multisample=i.framebuffer.multisample,s[1].framebuffer.multisample=i.framebuffer.multisample),this._tempRenderTarget=e.renderTexture.current,this._tempRenderTargetSource.copyFrom(e.renderTexture.sourceFrame),this._tempRenderTargetDestination.copyFrom(e.renderTexture.destinationFrame),e.batch.flush(),r.useDoubleBuffer){let a=s[this.currentBufferIndex];a.baseTexture._glTextures[e.CONTEXT_UID]||(e.renderTexture.bind(a,void 0,void 0),e.texture.bind(a),r.clearColor&&e.renderTexture.clear(r.clearColor)),e.texture.unbind(i.baseTexture),i.baseTexture._glTextures=a.baseTexture._glTextures,i.baseTexture.framebuffer=a.baseTexture.framebuffer,a=s[1-this.currentBufferIndex],e.renderTexture.bind(a,void 0,void 0)}else e.renderTexture.bind(i,void 0,void 0);r.clearColor&&e.renderTexture.clear(r.clearColor);const o=e.filter.defaultFilterStack;o.length>1&&(o[o.length-1].renderTexture=e.renderTexture.current)}popTexture(e){e.batch.flush(),e.framebuffer.blit();const t=e.filter.defaultFilterStack;t.length>1&&(t[t.length-1].renderTexture=this._tempRenderTarget),e.renderTexture.bind(this._tempRenderTarget,this._tempRenderTargetSource,this._tempRenderTargetDestination),this._tempRenderTarget=null;const i=this.renderTexture,r=this.layer.group,s=this.doubleBuffer;if(r.useDoubleBuffer){e.texture.unbind(i.baseTexture),this.currentBufferIndex=1-this.currentBufferIndex;const o=s[this.currentBufferIndex];i.baseTexture._glTextures=o.baseTexture._glTextures,i.baseTexture.framebuffer=o.baseTexture.framebuffer}}destroy(){this.renderTexture&&(this.renderTexture.destroy(),this.doubleBuffer&&(this.doubleBuffer[0].destroy(!0),this.doubleBuffer[1].destroy(!0)))}}class FA extends mn{constructor(e=null){super(),this.isLayer=!0,this.group=null,this._activeChildren=[],this._tempChildren=null,this._activeStageParent=null,this._sortedChildren=[],this._tempLayerParent=null,this.insertChildrenBeforeActive=!0,this.insertChildrenAfterActive=!0,e?(this.group=e,this.zIndex=e.zIndex):this.group=new ub(0,!1),this._tempChildren=this.children}get useRenderTexture(){return this.group.useRenderTexture}set useRenderTexture(e){this.group.useRenderTexture=e}get useDoubleBuffer(){return this.group.useDoubleBuffer}set useDoubleBuffer(e){this.group.useDoubleBuffer=e}get clearColor(){return this.group.clearColor}set clearColor(e){this.group.clearColor=e}get sortPriority(){return this.group.sortPriority}set sortPriority(e){this.group.sortPriority=e}getRenderTexture(){return this.textureCache||(this.textureCache=new P4(this)),this.textureCache.getRenderTexture()}doSort(){this.group.doSort(this,this._sortedChildren)}destroy(e){this.textureCache&&(this.textureCache.destroy(),this.textureCache=null),super.destroy(e)}render(e){this.prerender(e)&&(this.group.useRenderTexture&&(this.textureCache||(this.textureCache=new P4(this)),this.textureCache.pushTexture(e)),this.containerRenderWebGL(e),this.postrender(e),this.group.useRenderTexture&&this.textureCache.popTexture(e))}layerRenderCanvas(e){this.prerender(e)&&(this.containerRenderCanvas(e),this.postrender(e))}_onBeginLayerSubtreeTraversal(e){const t=this._activeChildren;this._activeStageParent=e,this.group._resolveLayer(e,this);const i=this.group._activeChildren;t.length=0;for(let r=0;r<i.length;r++)i[r]._activeParentLayer=this,t.push(i[r]);i.length=0}_onEndLayerSubtreeTraversal(){const e=this.children,t=this._activeChildren,i=this._sortedChildren;for(let r=0;r<t.length;r++)this.emit("display",t[r]);if(i.length=0,this.insertChildrenBeforeActive)for(let r=0;r<e.length;r++)i.push(e[r]);for(let r=0;r<t.length;r++)i.push(t[r]);if(!this.insertChildrenBeforeActive&&this.insertChildrenAfterActive)for(let r=0;r<e.length;r++)i.push(e[r]);this.group.enableSort&&this.doSort()}prerender(e){return this._activeParentLayer&&this._activeParentLayer!=e._activeLayer?!1:this.visible?(this.displayOrder=e.incDisplayOrder(),this.worldAlpha<=0||!this.renderable?!1:(this.children!==this._sortedChildren&&this._tempChildren!==this.children&&(this._tempChildren=this.children),this._boundsID++,this.children=this._sortedChildren,this._tempLayerParent=e._activeLayer,e._activeLayer=this,!0)):(this.displayOrder=0,!1)}postrender(e){this.children=this._tempChildren,e._activeLayer=this._tempLayerParent,this._tempLayerParent=null}}FA.prototype.renderCanvas=FA.prototype.layerRenderCanvas;class UA extends FA{constructor(){super(...arguments),this.isStage=!0,this._tempGroups=[],this._activeLayers=[],this._activeParentStage=null}clear(){this._activeLayers.length=0,this._tempGroups.length=0}destroy(e){this.clear(),super.destroy(e)}updateStage(){this._activeParentStage=null,ub._layerUpdateId++,this._updateStageInner()}updateAsChildStage(e){this._activeParentStage=e,UA._updateOrderCounter=0,this._updateStageInner()}_updateStageInner(){this.clear(),this._addRecursive(this);const e=this._activeLayers;for(let t=0;t<e.length;t++){const i=e[t];if(i.group.sortPriority){i._onEndLayerSubtreeTraversal();const r=i._sortedChildren;for(let s=0;s<r.length;s++)this._addRecursiveChildren(r[s])}}for(let t=0;t<e.length;t++){const i=e[t];i.group.sortPriority||i._onEndLayerSubtreeTraversal()}}_addRecursive(e){if(!e.visible)return;if(e.isLayer){const s=e;this._activeLayers.push(s),s._onBeginLayerSubtreeTraversal(this)}if(e!==this&&e.isStage){e.updateAsChildStage(this);return}e._activeParentLayer=null;let t=e.parentGroup;t&&t._resolveChildDisplayObject(this,e);const i=e.parentLayer;if(i&&(t=i.group,t._resolveChildDisplayObject(this,e)),e.updateOrder=++UA._updateOrderCounter,e.alpha<=0||!e.renderable||!e.layerableChildren||t&&t.sortPriority)return;const r=e.children;if(r&&r.length)for(let s=0;s<r.length;s++)this._addRecursive(r[s])}_addRecursiveChildren(e){if(e.alpha<=0||!e.renderable||!e.layerableChildren)return;const t=e.children;if(t&&t.length)for(let i=0;i<t.length;i++)this._addRecursive(t[i])}}UA._updateOrderCounter=0;yke();wke(sb);class xke extends UA{constructor(){super();E(this,"bgContainer");this.createBgContainer()}createBgContainer(){this.bgContainer=new mn,this.bgContainer.name="bgContainer",this.addChild(this.bgContainer)}updateBg(t){this.bgContainer.removeChildren(),this.bgContainer.addChild(t)}clearBg(){this.bgContainer.removeChildren()}}class Cke extends mn{constructor(){super(),this.name="tempLayer"}}class Eke extends Xr{constructor(t,i){const r=Object.assign(oCe,i);super(r);E(this,"viewport");E(this,"enableEmit",!0);E(this,"elementMinWidth");E(this,"isPointDown");E(this,"pointerId");E(this,"enableClearSelected",!0);E(this,"enableDBClick",!0);this.elementMinWidth=r.elementMinWidth,this.viewport=t,this.initEvent()}scaleGroup(t,i){var r;super.scaleGroup(t,i,this.elementMinWidth,((r=this.viewport)==null?void 0:r.scale.x)||1)}clear(){this.selected.length>0&&this.enableClearSelected&&(this.selected=[])}toggleEnableClearSelected(t){this.enableClearSelected=t}toggleEnableDBClick(t){this.enableDBClick=t}initEvent(){this.on(sr.TRANSFORM_CHANGE,()=>{this.update()}),this.on(sr.TRANSFORM_COMMIT,()=>{this.commit(),this.onUpdateState({lockRatio:this.groupJSON.lockRatio})})}translateSelected(t){const{deltaX:i=0,deltaY:r=0}=t;this.selected.forEach(s=>{s.x+=i,s.y+=r}),this.emit(sr.TRANSFORM_CHANGE,"matrix")}flipSelected(t){const{flipX:i=!1,flipY:r=!1}=t,s=i?-1:1,o=r?-1:1,a=Dt.IDENTITY,c=Xr.calculateGroupOrientedBounds(this.selected,0).center;a.translate(-c.x,-c.y).scale(s,o).translate(c.x,c.y),this.updateSelectedTransform(a)}rotateSelected(t){if(tn(t)){const i=qY(this.group,t);this.updateSelectedTransform(i),this.groupBounds.rotation=t*Yo}}updateSelectedTransform(t){this.selected.forEach(i=>{d2(i,t)}),this.emit(sr.TRANSFORM_CHANGE,"matrix")}updateGroupSize(t,i,r=this.lockAspectRatio){if(!tn(t)&&!tn(i))return;this.groupBounds.rotation!==0&&this.updateGroupBounds(0);const s=h9(this.viewport,this.group,t,i,r),o=new Ae(s.maxX,s.maxY);this.scaleGroup("bottomRight",o)}updateGroupPosition(t,i){if(tn(t)||tn(i)){const r=d9(this.viewport,this.group,{x:t,y:i});this.translateGroup(r)}}set selectedIDs(t){const r=this.viewport.getInteractiveElements().filter(s=>t.includes(s.id));this.selected=r}get selectedIDs(){return this.selected.map(t=>t.id)}get selected(){return this.group}set selected(t){Array.isArray(t)&&(this.setSelection(t),this.updateLockRatio(),this.emit(sr.SELECT)),this.onUpdateState({lockRatio:this.groupJSON.lockRatio})}updateLockRatio(){const i=this.selected.some(r=>r.lockRatio);this.lockAspectRatio=i}changeMode(t){super.changeMode(t),this.onUpdateState({lockRatio:this.groupJSON.lockRatio})}update(){this.group.forEach(i=>{i.transformUpdate&&i.transformUpdate()}),this.updateLockRatio(),this.onUpdateState({lockRatio:this.groupJSON.lockRatio})}commit(){this.group.forEach(i=>{i.transformCommit&&i.transformCommit()})}get worldGroupBounds(){const t=Xr.calculateGroupOrientedBounds(this.group,0),i=new oi,r=this.viewport.toLocal(t.topLeft),s=this.viewport.toLocal(t.bottomRight);return i.minX=r.x,i.minY=r.y,i.maxX=s.x,i.maxY=s.y,i}get worldGroupBoundsCenter(){const t=this.worldGroupBounds.getRectangle(),i=t.x+t.width/2,r=t.y+t.height/2;return new Ae(i,r)}get groupJSON(){const{x:t,y:i,width:r,height:s}=this.worldGroupBounds.getRectangle(),o=this.groupBounds.rotation*XT,a="GROUP",l=Ui();return{x:t,y:i,width:r,height:s,id:l,type:a,angle:o,lockRatio:this.lockAspectRatio}}removeSelected(){const t=this.selected;t==null||t.forEach(i=>{m2(i)}),this.clear()}get unSelected(){const t=this.viewport.getInteractiveElements()||[],i=this.selected,r=[];return Array.isArray(t)&&t.length>0&&(t==null||t.forEach(s=>{i.includes(s)||r.push(s)})),r}onPointerMove(t){Nc(t)&&this.pointerId===Sy(t)&&super.onPointerMove(t)}onPointerDown(t){Nc(t)&&(this.pointerId=Sy(t),super.onPointerDown(t))}onPointerUp(t){jR(t).includes(this.pointerId)&&super.onPointerUp(t)}}class fl{constructor(e){this.parent=e,this.paused=!1}destroy(){}down(e){return!1}move(e){return!1}up(e){return!1}wheel(e){return!1}update(e){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}var Tke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ike(n,e,t){return t={path:e,exports:{},require:function(i,r){return Ske(i,r??t.path)}},n(t,t.exports),t.exports}function Ske(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var M4=Ike(function(n,e){(function(){var t,i;i=function(r){return n.exports=r},t={linear:function(r,s,o,a){return o*r/a+s},easeInQuad:function(r,s,o,a){return o*(r/=a)*r+s},easeOutQuad:function(r,s,o,a){return-o*(r/=a)*(r-2)+s},easeInOutQuad:function(r,s,o,a){return(r/=a/2)<1?o/2*r*r+s:-o/2*(--r*(r-2)-1)+s},easeInCubic:function(r,s,o,a){return o*(r/=a)*r*r+s},easeOutCubic:function(r,s,o,a){return o*((r=r/a-1)*r*r+1)+s},easeInOutCubic:function(r,s,o,a){return(r/=a/2)<1?o/2*r*r*r+s:o/2*((r-=2)*r*r+2)+s},easeInQuart:function(r,s,o,a){return o*(r/=a)*r*r*r+s},easeOutQuart:function(r,s,o,a){return-o*((r=r/a-1)*r*r*r-1)+s},easeInOutQuart:function(r,s,o,a){return(r/=a/2)<1?o/2*r*r*r*r+s:-o/2*((r-=2)*r*r*r-2)+s},easeInQuint:function(r,s,o,a){return o*(r/=a)*r*r*r*r+s},easeOutQuint:function(r,s,o,a){return o*((r=r/a-1)*r*r*r*r+1)+s},easeInOutQuint:function(r,s,o,a){return(r/=a/2)<1?o/2*r*r*r*r*r+s:o/2*((r-=2)*r*r*r*r+2)+s},easeInSine:function(r,s,o,a){return-o*Math.cos(r/a*(Math.PI/2))+o+s},easeOutSine:function(r,s,o,a){return o*Math.sin(r/a*(Math.PI/2))+s},easeInOutSine:function(r,s,o,a){return-o/2*(Math.cos(Math.PI*r/a)-1)+s},easeInExpo:function(r,s,o,a){return r===0?s:o*Math.pow(2,10*(r/a-1))+s},easeOutExpo:function(r,s,o,a){return r===a?s+o:o*(-Math.pow(2,-10*r/a)+1)+s},easeInOutExpo:function(r,s,o,a){return(r/=a/2)<1?o/2*Math.pow(2,10*(r-1))+s:o/2*(-Math.pow(2,-10*--r)+2)+s},easeInCirc:function(r,s,o,a){return-o*(Math.sqrt(1-(r/=a)*r)-1)+s},easeOutCirc:function(r,s,o,a){return o*Math.sqrt(1-(r=r/a-1)*r)+s},easeInOutCirc:function(r,s,o,a){return(r/=a/2)<1?-o/2*(Math.sqrt(1-r*r)-1)+s:o/2*(Math.sqrt(1-(r-=2)*r)+1)+s},easeInElastic:function(r,s,o,a){var l,c,u;return u=1.70158,c=0,l=o,r===0||(r/=a),c||(c=a*.3),l<Math.abs(o)?(l=o,u=c/4):u=c/(2*Math.PI)*Math.asin(o/l),-(l*Math.pow(2,10*(r-=1))*Math.sin((r*a-u)*(2*Math.PI)/c))+s},easeOutElastic:function(r,s,o,a){var l,c,u;return u=1.70158,c=0,l=o,r===0||(r/=a),c||(c=a*.3),l<Math.abs(o)?(l=o,u=c/4):u=c/(2*Math.PI)*Math.asin(o/l),l*Math.pow(2,-10*r)*Math.sin((r*a-u)*(2*Math.PI)/c)+o+s},easeInOutElastic:function(r,s,o,a){var l,c,u;return u=1.70158,c=0,l=o,r===0||(r/=a/2),c||(c=a*(.3*1.5)),l<Math.abs(o)?(l=o,u=c/4):u=c/(2*Math.PI)*Math.asin(o/l),r<1?-.5*(l*Math.pow(2,10*(r-=1))*Math.sin((r*a-u)*(2*Math.PI)/c))+s:l*Math.pow(2,-10*(r-=1))*Math.sin((r*a-u)*(2*Math.PI)/c)*.5+o+s},easeInBack:function(r,s,o,a,l){return l===void 0&&(l=1.70158),o*(r/=a)*r*((l+1)*r-l)+s},easeOutBack:function(r,s,o,a,l){return l===void 0&&(l=1.70158),o*((r=r/a-1)*r*((l+1)*r+l)+1)+s},easeInOutBack:function(r,s,o,a,l){return l===void 0&&(l=1.70158),(r/=a/2)<1?o/2*(r*r*(((l*=1.525)+1)*r-l))+s:o/2*((r-=2)*r*(((l*=1.525)+1)*r+l)+2)+s},easeInBounce:function(r,s,o,a){var l;return l=t.easeOutBounce(a-r,0,o,a),o-l+s},easeOutBounce:function(r,s,o,a){return(r/=a)<1/2.75?o*(7.5625*r*r)+s:r<2/2.75?o*(7.5625*(r-=1.5/2.75)*r+.75)+s:r<2.5/2.75?o*(7.5625*(r-=2.25/2.75)*r+.9375)+s:o*(7.5625*(r-=2.625/2.75)*r+.984375)+s},easeInOutBounce:function(r,s,o,a){var l;return r<a/2?(l=t.easeInBounce(r*2,0,o,a),l*.5+s):(l=t.easeOutBounce(r*2-a,0,o,a),l*.5+o*.5+s)}},i(t)}).call(Tke)});function _I(n,e){if(n){if(typeof n=="function")return n;if(typeof n=="string")return M4[n]}else return M4[e]}const Pke={removeOnInterrupt:!1,ease:"linear",time:1e3};class gu extends fl{__init(){this.startWidth=null}__init2(){this.startHeight=null}__init3(){this.deltaWidth=null}__init4(){this.deltaHeight=null}__init5(){this.width=null}__init6(){this.height=null}__init7(){this.time=0}constructor(e,t={}){super(e),gu.prototype.__init.call(this),gu.prototype.__init2.call(this),gu.prototype.__init3.call(this),gu.prototype.__init4.call(this),gu.prototype.__init5.call(this),gu.prototype.__init6.call(this),gu.prototype.__init7.call(this),this.options=Object.assign({},Pke,t),this.options.ease=_I(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),this.width!==null&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),this.height!==null&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),this.width!==null&&this.parent.fitWidth(this.width,this.keepCenter,this.height===null),this.height!==null&&this.parent.fitHeight(this.height,this.keepCenter,this.width===null),this.keepCenter||this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(e){if(this.paused)return;this.time+=e;const t=new Ae(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){const i=this.parent.width,r=this.parent.height;this.complete(),(i!==this.parent.width||r!==this.parent.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:t,type:"animate"})}else{const i=this.options.ease(this.time,0,1,this.options.time);if(this.width!==null){const r=this.startWidth,s=this.deltaWidth;this.parent.fitWidth(r+s*i,this.keepCenter,this.height===null)}if(this.height!==null){const r=this.startHeight,s=this.deltaHeight;this.parent.fitHeight(r+s*i,this.keepCenter,this.width===null)}if(this.width===null?this.parent.scale.x=this.parent.scale.y:this.height===null&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const r=this.startX,s=this.startY,o=this.deltaX,a=this.deltaY,l=new Ae(this.parent.x,this.parent.y);this.parent.moveCenter(r+o*i,s+a*i),this.parent.emit("moved",{viewport:this.parent,original:l,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:t,type:"animate"})}}}function Ew(n){let e,t=n[0],i=1;for(;i<n.length;){const r=n[i],s=n[i+1];if(i+=2,(r==="optionalAccess"||r==="optionalCall")&&t==null)return;r==="access"||r==="optionalAccess"?(e=t,t=s(t)):(r==="call"||r==="optionalCall")&&(t=s((...o)=>t.call(e,...o)),e=void 0)}return t}const Mke={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class Rke extends fl{constructor(e,t={}){super(e),this.options=Object.assign({},Mke,t),this.ease=_I(this.options.ease,"easeInOutSine"),this.options.sides?this.options.sides==="all"?this.top=this.bottom=this.left=this.right=!0:this.options.sides==="horizontal"?(this.right=this.left=!0,this.top=this.bottom=!1):this.options.sides==="vertical"?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=this.options.sides.indexOf("top")!==-1,this.bottom=this.options.sides.indexOf("bottom")!==-1,this.left=this.options.sides.indexOf("left")!==-1,this.right=this.options.sides.indexOf("right")!==-1):this.left=this.top=this.right=this.bottom=!1;const i=this.options.underflow.toLowerCase();i==="center"?(this.underflowX=0,this.underflowY=0):(this.underflowX=i.indexOf("left")!==-1?-1:i.indexOf("right")!==-1?1:0,this.underflowY=i.indexOf("top")!==-1?-1:i.indexOf("bottom")!==-1?1:0),this.reset()}isActive(){return this.toX!==null||this.toY!==null}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(e){if(!this.paused){if(this.bounce(),this.toX){const t=this.toX;t.time+=e,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),t.time>=this.options.time?(this.parent.x=t.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(t.time,t.start,t.delta,this.options.time)}if(this.toY){const t=this.toY;t.time+=e,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),t.time>=this.options.time?(this.parent.y=t.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(t.time,t.start,t.delta,this.options.time)}}}calcUnderflowX(){let e;switch(this.underflowX){case-1:e=0;break;case 1:e=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:e=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return e}calcUnderflowY(){let e;switch(this.underflowY){case-1:e=0;break;case 1:e=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:e=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return e}oob(){const e=this.options.bounceBox;if(e){const t=typeof e.x>"u"?0:e.x,i=typeof e.y>"u"?0:e.y,r=typeof e.width>"u"?this.parent.worldWidth:e.width,s=typeof e.height>"u"?this.parent.worldHeight:e.height;return{left:this.parent.left<t,right:this.parent.right>r,top:this.parent.top<i,bottom:this.parent.bottom>s,topLeft:new Ae(t*this.parent.scale.x,i*this.parent.scale.y),bottomRight:new Ae(r*this.parent.scale.x-this.parent.screenWidth,s*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new Ae(0,0),bottomRight:new Ae(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){if(this.paused)return;let e,t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.x&&t.percentChangeX===Ew([t,"access",s=>s.options,"optionalAccess",s=>s.friction])||t.y&&t.percentChangeY===Ew([t,"access",s=>s.options,"optionalAccess",s=>s.friction]))&&(e=this.oob(),(e.left&&this.left||e.right&&this.right)&&(t.percentChangeX=this.options.friction),(e.top&&this.top||e.bottom&&this.bottom)&&(t.percentChangeY=this.options.friction));const i=this.parent.plugins.get("drag",!0)||{},r=this.parent.plugins.get("pinch",!0)||{};if(t=t||{},!Ew([i,"optionalAccess",s=>s.active])&&!Ew([r,"optionalAccess",s=>s.active])&&(!this.toX||!this.toY)&&(!t.x||!t.y)){e=e||this.oob();const s=e.topLeft,o=e.bottomRight;if(!this.toX&&!t.x){let a=null;e.left&&this.left?a=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-s.x:e.right&&this.right&&(a=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-o.x),a!==null&&this.parent.x!==a&&(this.toX={time:0,start:this.parent.x,delta:a-this.parent.x,end:a},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!t.y){let a=null;e.top&&this.top?a=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-s.y:e.bottom&&this.bottom&&(a=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-o.y),a!==null&&this.parent.y!==a&&(this.toY={time:0,start:this.parent.y,delta:a-this.parent.y,end:a},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const Dke={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class kke extends fl{constructor(e,t={}){super(e),this.options=Object.assign({},Dke,t),this.options.direction&&(this.options.left=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.right=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.top=this.options.direction==="y"||this.options.direction==="all"?!0:null,this.options.bottom=this.options.direction==="y"||this.options.direction==="all"?!0:null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const e=this.options.underflow.toLowerCase();e==="none"?this.noUnderflow=!0:e==="center"?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=e.indexOf("left")!==-1?-1:e.indexOf("right")!==-1?1:0,this.underflowY=e.indexOf("top")!==-1?-1:e.indexOf("bottom")!==-1?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const e={x:this.parent.x,y:this.parent.y},t=this.parent.plugins.decelerate||{};if(this.options.left!==null||this.options.right!==null){let i=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x!==0&&(this.parent.x=0,i=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,i=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,i=!0)}else this.options.left!==null&&this.parent.left<(this.options.left===!0?0:this.options.left)&&(this.parent.x=-(this.options.left===!0?0:this.options.left)*this.parent.scale.x,t.x=0,i=!0),this.options.right!==null&&this.parent.right>(this.options.right===!0?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(this.options.right===!0?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,t.x=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:e,type:"clamp-x"})}if(this.options.top!==null||this.options.bottom!==null){let i=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y!==0&&(this.parent.y=0,i=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,i=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,i=!0)}else this.options.top!==null&&this.parent.top<(this.options.top===!0?0:this.options.top)&&(this.parent.y=-(this.options.top===!0?0:this.options.top)*this.parent.scale.y,t.y=0,i=!0),this.options.bottom!==null&&this.parent.bottom>(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,t.y=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:e,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const Oke={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class Lke extends fl{constructor(e,t={}){super(e),this.options=Object.assign({},Oke,t),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused){if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight;if(this.options.minWidth!==null&&e<this.options.minWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxWidth!==null&&e>this.options.maxWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.minHeight!==null&&t<this.options.minHeight){const i=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxHeight!==null&&t>this.options.maxHeight){const i=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const e={x:null,y:null},t={x:null,y:null};if(typeof this.options.minScale=="number")e.x=this.options.minScale,e.y=this.options.minScale;else if(this.options.minScale!==null){const s=this.options.minScale;e.x=typeof s.x>"u"?null:s.x,e.y=typeof s.y>"u"?null:s.y}if(typeof this.options.maxScale=="number")t.x=this.options.maxScale,t.y=this.options.maxScale;else if(this.options.maxScale!==null){const s=this.options.maxScale;t.x=typeof s.x>"u"?null:s.x,t.y=typeof s.y>"u"?null:s.y}let i=this.parent.scale.x,r=this.parent.scale.y;e.x!==null&&i<e.x&&(i=e.x),t.x!==null&&i>t.x&&(i=t.x),e.y!==null&&r<e.y&&(r=e.y),t.y!==null&&r>t.y&&(r=t.y),(i!==this.parent.scale.x||r!==this.parent.scale.y)&&(this.parent.scale.set(i,r),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}}reset(){this.clamp()}}const Nke={friction:.98,bounce:.8,minSpeed:.01},Ch=16;class Bke extends fl{constructor(e,t={}){super(e),this.options=Object.assign({},Nke,t),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",i=>this.moved(i))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!!(this.x||this.y)}move(){if(this.paused)return!1;const e=this.parent.input.count();return(e===1||e>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}moved(e){if(this.saved.length){const t=this.saved[this.saved.length-1];e.type==="clamp-x"?t.x===e.original.x&&(t.x=this.parent.x):e.type==="clamp-y"&&t.y===e.original.y&&(t.y=this.parent.y)}}up(){if(this.parent.input.count()===0&&this.saved.length){const e=performance.now();for(const t of this.saved)if(t.time>=e-100){const i=e-t.time;this.x=(this.parent.x-t.x)/i,this.y=(this.parent.y-t.y)/i,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(e){e=e||{},typeof e.x<"u"&&(this.x=e.x,this.percentChangeX=this.options.friction),typeof e.y<"u"&&(this.y=e.y,this.percentChangeY=this.options.friction)}update(e){if(this.paused)return;const t=this.x||this.y,i=this.timeSinceRelease,r=this.timeSinceRelease+e;if(this.x){const s=this.percentChangeX,o=Math.log(s);this.parent.x+=this.x*Ch/o*(Math.pow(s,r/Ch)-Math.pow(s,i/Ch)),this.x*=Math.pow(this.percentChangeX,e/Ch)}if(this.y){const s=this.percentChangeY,o=Math.log(s);this.parent.y+=this.y*Ch/o*(Math.pow(s,r/Ch)-Math.pow(s,i/Ch)),this.y*=Math.pow(this.percentChangeY,e/Ch)}this.timeSinceRelease+=e,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),t&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const Fke={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class H7 extends fl{constructor(e,t={}){super(e),this.options=Object.assign({},Fke,t),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="x",this.yDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="y",this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(e){window.addEventListener("keydown",t=>{e.includes(t.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",t=>{e.includes(t.code)&&(this.keyIsPressed=!1)})}mouseButtons(e){!e||e==="all"?this.mouse=[!0,!0,!0]:this.mouse=[e.indexOf("left")!==-1,e.indexOf("middle")!==-1,e.indexOf("right")!==-1]}parseUnderflow(){const e=this.options.underflow.toLowerCase();e==="center"?(this.underflowX=0,this.underflowY=0):(e.includes("left")?this.underflowX=-1:e.includes("right")?this.underflowX=1:this.underflowX=0,e.includes("top")?this.underflowY=-1:e.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(e){const t=e.data.pointerType==="mouse",i=this.parent.input.count();return!!((i===1||i>1&&!this.parent.plugins.get("pinch",!0))&&(!t||this.mouse[e.data.button]))}checkKeyPress(e){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&e.data.pointerType==="touch"}down(e){return this.paused||!this.options.pressDrag?!1:this.checkButtons(e)&&this.checkKeyPress(e)?(this.last={x:e.data.global.x,y:e.data.global.y},this.current=e.data.pointerId,!0):(this.last=null,!1)}get active(){return this.moved}move(e){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===e.data.pointerId){const t=e.data.global.x,i=e.data.global.y,r=this.parent.input.count();if(r===1||r>1&&!this.parent.plugins.get("pinch",!0)){const s=t-this.last.x,o=i-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(s)||this.yDirection&&this.parent.input.checkThreshold(o)){const a={x:t,y:i};return this.xDirection&&(this.parent.x+=(a.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(a.y-this.last.y)*this.options.factor),this.last=a,this.moved||this.parent.emit("drag-start",{event:e,screen:new Ae(this.last.x,this.last.y),world:this.parent.toWorld(new Ae(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(e){if(this.paused)return!1;const t=this.parent.input.touches;if(t.length===1){const i=t[0];return i.last&&(this.last={x:i.last.x,y:i.last.y},this.current=i.id),this.moved=!1,!0}else if(this.last&&this.moved){const i=new Ae(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:e,screen:i,world:this.parent.toWorld(i),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(e){if(this.paused)return!1;if(this.options.wheel){const t=this.parent.plugins.get("wheel",!0);if(!t||!t.options.wheelZoom&&!e.ctrlKey){const i=e.deltaMode?this.options.lineHeight:1,r=[e.deltaX,e.deltaY],[s,o]=this.options.wheelSwapAxes?r.reverse():r;return this.xDirection&&(this.parent.x+=s*i*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=o*i*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||e.preventDefault(),this.parent.options.stopPropagation&&e.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const e=this.parent.plugins.get("decelerate",!0)||{};if(this.options.clampWheel!=="y")if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,e.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,e.x=0);if(this.options.clampWheel!=="x")if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,e.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,e.y=0)}}const Uke={speed:0,acceleration:null,radius:null};class Gke extends fl{constructor(e,t,i={}){super(e),this.target=t,this.options=Object.assign({},Uke,i),this.velocity={x:0,y:0}}update(e){if(this.paused)return;const t=this.parent.center;let i=this.target.x,r=this.target.y;if(this.options.radius)if(Math.sqrt(Math.pow(this.target.y-t.y,2)+Math.pow(this.target.x-t.x,2))>this.options.radius){const l=Math.atan2(this.target.y-t.y,this.target.x-t.x);i=this.target.x-Math.cos(l)*this.options.radius,r=this.target.y-Math.sin(l)*this.options.radius}else return;const s=i-t.x,o=r-t.y;if(s||o)if(this.options.speed)if(this.options.acceleration){const a=Math.atan2(r-t.y,i-t.x),l=Math.sqrt(Math.pow(s,2)+Math.pow(o,2));if(l){const c=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);l>c?this.velocity={x:Math.min(this.velocity.x+this.options.acceleration*e,this.options.speed),y:Math.min(this.velocity.y+this.options.acceleration*e,this.options.speed)}:this.velocity={x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const u=Math.cos(a)*this.velocity.x,h=Math.sin(a)*this.velocity.y,d=Math.abs(u)>Math.abs(s)?i:t.x+u,f=Math.abs(h)>Math.abs(o)?r:t.y+h;this.parent.moveCenter(d,f),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const a=Math.atan2(r-t.y,i-t.x),l=Math.cos(a)*this.options.speed,c=Math.sin(a)*this.options.speed,u=Math.abs(l)>Math.abs(s)?i:t.x+l,h=Math.abs(c)>Math.abs(o)?r:t.y+c;this.parent.moveCenter(u,h),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(i,r),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const Hke={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class Vke extends fl{constructor(e,t={}){super(e),this.options=Object.assign({},Hke,t),this.reverse=this.options.reverse?1:-1,this.radiusSquared=typeof this.options.radius=="number"?Math.pow(this.options.radius,2):null,this.resize()}resize(){const e=this.options.distance;e!==null?(this.left=e,this.top=e,this.right=this.parent.screenWidth-e,this.bottom=this.parent.screenHeight-e):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=this.options.right===null?null:this.parent.screenWidth-this.options.right,this.bottom=this.options.bottom===null?null:this.parent.screenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(e){if(this.paused||e.data.pointerType!=="mouse"&&e.data.identifier!==1||!this.options.allowButtons&&e.data.buttons!==0)return!1;const t=e.data.global.x,i=e.data.global.y;if(this.radiusSquared){const r=this.parent.toScreen(this.parent.center);if(Math.pow(r.x-t,2)+Math.pow(r.y-i,2)>=this.radiusSquared){const o=Math.atan2(r.y-i,r.x-t);this.options.linear?(this.horizontal=Math.round(Math.cos(o))*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.round(Math.sin(o))*this.options.speed*this.reverse*(60/1e3)):(this.horizontal=Math.cos(o)*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.sin(o)*this.options.speed*this.reverse*(60/1e3))}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else this.left!==null&&t<this.left?this.horizontal=Number(this.reverse)*this.options.speed*(60/1e3):this.right!==null&&t>this.right?this.horizontal=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateHorizontal(),this.horizontal=0),this.top!==null&&i<this.top?this.vertical=Number(this.reverse)*this.options.speed*(60/1e3):this.bottom!==null&&i>this.bottom?this.vertical=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const e=this.parent.plugins.get("decelerate",!0);this.horizontal&&e&&!this.options.noDecelerate&&e.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const e=this.parent.plugins.get("decelerate",!0);this.vertical&&e&&!this.options.noDecelerate&&e.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const e=this.parent.center;this.horizontal&&(e.x+=this.horizontal*this.options.speed),this.vertical&&(e.y+=this.vertical*this.options.speed),this.parent.moveCenter(e),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const zke={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class Oy extends fl{__init(){this.active=!1}__init2(){this.pinching=!1}__init3(){this.moved=!1}constructor(e,t={}){super(e),Oy.prototype.__init.call(this),Oy.prototype.__init2.call(this),Oy.prototype.__init3.call(this),this.options=Object.assign({},zke,t)}down(){return this.parent.input.count()>=2?(this.active=!0,!0):!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(e){if(this.paused||!this.active)return!1;const t=e.data.global.x,i=e.data.global.y,r=this.parent.input.touches;if(r.length>=2){const s=r[0],o=r[1],a=s.last&&o.last?Math.sqrt(Math.pow(o.last.x-s.last.x,2)+Math.pow(o.last.y-s.last.y,2)):null;if(s.id===e.data.pointerId?s.last={x:t,y:i,data:e.data}:o.id===e.data.pointerId&&(o.last={x:t,y:i,data:e.data}),a){let l;const c={x:s.last.x+(o.last.x-s.last.x)/2,y:s.last.y+(o.last.y-s.last.y)/2};this.options.center||(l=this.parent.toLocal(c));let u=Math.sqrt(Math.pow(o.last.x-s.last.x,2)+Math.pow(o.last.y-s.last.y,2));u=u===0?u=1e-10:u;const h=(1-a/u)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=h),this.isAxisY()&&(this.parent.scale.y+=h),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:c});const d=this.parent.plugins.get("clamp-zoom",!0);if(d&&d.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const f=this.parent.toGlobal(l);this.parent.x+=(c.x-f.x)*this.options.factor,this.parent.y+=(c.y-f.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(c.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(c.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=c,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return this.pinching&&this.parent.input.touches.length<=1?(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0):!1}}const $ke={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class Wke extends fl{constructor(e,t,i,r={}){super(e),this.options=Object.assign({},$ke,r),this.ease=_I(r.ease,"easeInOutSine"),this.x=t,this.y=i,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const e=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-e.x,this.deltaY=this.y-e.y,this.startX=e.x,this.startY=e.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(this.parent.input.count()===0){const e=this.parent.plugins.get("decelerate",!0);e&&(e.x||e.y)&&(e.percentChangeX=e.percentChangeY=this.options.friction)}return!1}update(e){if(!this.paused&&!(this.options.interrupt&&this.parent.input.count()!==0))if(this.snapping){const t=this.snapping;t.time+=e;let i,r,s;const o=this.startX,a=this.startY,l=this.deltaX,c=this.deltaY;if(t.time>this.options.time)i=!0,r=o+l,s=a+c;else{const u=this.ease(t.time,0,1,this.options.time);r=o+l*u,s=a+c*u}this.options.topLeft?this.parent.moveCorner(r,s):this.parent.moveCenter(r,s),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),i&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;(t.x!==this.x||t.y!==this.y)&&this.snapStart()}}}const jke={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class Qke extends fl{constructor(e,t={}){super(e),this.options=Object.assign({},jke,t),this.ease=_I(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=e.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=e.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,this.options.time===0?(e.container.scale.x=this.xScale,e.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):t.forceStart&&this.createSnapping()}createSnapping(){const e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight,i=this.parent.screenWidth/this.xScale,r=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:e,startY:t,deltaX:i-e,deltaY:r-t},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(e){if(this.paused||this.options.interrupt&&this.parent.input.count()!==0)return;let t;if(!this.options.center&&!this.options.noMove&&(t=this.parent.center),!this.snapping)(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping();else if(this.snapping){const i=this.snapping;if(i.time+=e,i.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const s=this.snapping,o=this.ease(s.time,s.startX,s.deltaX,this.options.time),a=this.ease(s.time,s.startY,s.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/o,this.parent.scale.y=this.parent.screenHeight/a}const r=this.parent.plugins.get("clamp-zoom",!0);r&&r.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(t))}}resume(){this.snapping=null,super.resume()}}const Xke={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class Yke extends fl{constructor(e,t={}){super(e),this.options=Object.assign({},Xke,t),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(e){window.addEventListener("keydown",t=>{e.includes(t.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",t=>{e.includes(t.code)&&(this.keyIsPressed=!1)})}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const e=this.smoothingCenter,t=this.smoothing;let i;this.options.center||(i=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x+=t.x),this.isAxisY()&&(this.parent.scale.y+=t.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const r=this.parent.plugins.get("clamp-zoom",!0);if(r&&r.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const s=this.parent.toGlobal(i);this.parent.x+=e.x-s.x,this.parent.y+=e.y-s.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(e){if(this.paused)return;const t=this.parent.input.getPointerPosition(e),i=-e.deltaY*(e.deltaMode?this.options.lineHeight:1)/200,r=Math.pow(2,(1+this.options.percent)*i);let s;this.options.center||(s=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x*=r),this.isAxisY()&&(this.parent.scale.y*=r),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const o=this.parent.plugins.get("clamp-zoom",!0);if(o&&o.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const a=this.parent.toGlobal(s);this.parent.x+=t.x-a.x,this.parent.y+=t.y-a.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:e.deltaX,dy:e.deltaY,dz:e.deltaZ},event:e,viewport:this.parent})}wheel(e){if(this.paused||!this.checkKeyPress())return!1;if(e.ctrlKey&&this.options.trackpadPinch)this.pinch(e);else if(this.options.wheelZoom){const t=this.parent.input.getPointerPosition(e),r=(this.options.reverse?-1:1)*-e.deltaY*(e.deltaMode?this.options.lineHeight:1)/500,s=Math.pow(2,(1+this.options.percent)*r);if(this.options.smooth){const o={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+o.x)*s-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+o.y)*s-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=t}else{let o;this.options.center||(o=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x*=s),this.isAxisY()&&(this.parent.scale.y*=s),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const l=this.parent.toGlobal(o);this.parent.x+=t.x-l.x,this.parent.y+=t.y-l.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:e.deltaX,dy:e.deltaY,dz:e.deltaZ},event:e,viewport:this.parent})}return!this.parent.options.passiveWheel}}class qke{constructor(e){this.viewport=e,this.touches=[],this.addListeners()}addListeners(){this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new Pt(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=e=>this.handleWheel(e),this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}down(e){if(this.viewport.pause||!this.viewport.worldVisible)return;if(e.data.pointerType==="mouse"?this.isMouseDown=!0:this.get(e.data.pointerId)||this.touches.push({id:e.data.pointerId,last:null}),this.count()===1){this.last=e.data.global.clone();const i=this.viewport.plugins.get("decelerate",!0),r=this.viewport.plugins.get("bounce",!0);(!i||!i.isActive())&&(!r||!r.isActive())?this.clickedAvailable=!0:this.clickedAvailable=!1}else this.clickedAvailable=!1;this.viewport.plugins.down(e)&&this.viewport.options.stopPropagation&&e.stopPropagation()}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(e){return Math.abs(e)>=this.viewport.threshold}move(e){if(this.viewport.pause||!this.viewport.worldVisible)return;const t=this.viewport.plugins.move(e);if(this.clickedAvailable&&this.last){const i=e.data.global.x-this.last.x,r=e.data.global.y-this.last.y;(this.checkThreshold(i)||this.checkThreshold(r))&&(this.clickedAvailable=!1)}t&&this.viewport.options.stopPropagation&&e.stopPropagation()}up(e){if(this.viewport.pause||!this.viewport.worldVisible)return;e.data.pointerType==="mouse"&&(this.isMouseDown=!1),e.data.pointerType!=="mouse"&&this.remove(e.data.pointerId);const t=this.viewport.plugins.up(e);this.clickedAvailable&&this.count()===0&&this.last&&(this.viewport.emit("clicked",{event:e,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1),t&&this.viewport.options.stopPropagation&&e.stopPropagation()}getPointerPosition(e){const t=new Ae;if(this.viewport.options.interaction)this.viewport.options.interaction.mapPositionToPoint(t,e.clientX,e.clientY);else if(this.viewport.options.useDivWheelForInputManager&&this.viewport.options.divWheel){const i=this.viewport.options.divWheel.getBoundingClientRect();t.x=e.clientX-i.left,t.y=e.clientY-i.top}else t.x=e.clientX,t.y=e.clientY;return t}handleWheel(e){if(this.viewport.pause||!this.viewport.worldVisible||this.viewport.options.interaction&&this.viewport.options.interaction.interactionDOMElement!==e.target)return;const t=this.viewport.toLocal(this.getPointerPosition(e));this.viewport.left<=t.x&&t.x<=this.viewport.right&&this.viewport.top<=t.y&&t.y<=this.viewport.bottom&&this.viewport.plugins.wheel(e)&&!this.viewport.options.passiveWheel&&e.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(e){for(const t of this.touches)if(t.id===e)return t;return null}remove(e){for(let t=0;t<this.touches.length;t++)if(this.touches[t].id===e){this.touches.splice(t,1);return}}count(){return(this.isMouseDown?1:0)+this.touches.length}}function w1(n){let e,t=n[0],i=1;for(;i<n.length;){const r=n[i],s=n[i+1];if(i+=2,(r==="optionalAccess"||r==="optionalCall")&&t==null)return;r==="access"||r==="optionalAccess"?(e=t,t=s(t)):(r==="call"||r==="optionalCall")&&(t=s((...o)=>t.call(e,...o)),e=void 0)}return t}const V_=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class Kke{constructor(e){this.viewport=e,this.list=[],this.plugins={}}add(e,t,i=V_.length){this.plugins[e]=t;const r=V_.indexOf(e);r!==-1&&V_.splice(r,1),V_.splice(i,0,e),this.sort()}get(e,t){return t&&w1([this,"access",i=>i.plugins,"access",i=>i[e],"optionalAccess",i=>i.paused])?null:this.plugins[e]}update(e){for(const t of this.list)t.update(e)}resize(){for(const e of this.list)e.resize()}reset(){for(const e of this.list)e.reset()}removeAll(){this.plugins={},this.sort()}remove(e){this.plugins[e]&&(delete this.plugins[e],this.viewport.emit(`${e}-remove`),this.sort())}pause(e){w1([this,"access",t=>t.plugins,"access",t=>t[e],"optionalAccess",t=>t.pause,"call",t=>t()])}resume(e){w1([this,"access",t=>t.plugins,"access",t=>t[e],"optionalAccess",t=>t.resume,"call",t=>t()])}sort(){this.list=[];for(const e of V_)this.plugins[e]&&this.list.push(this.plugins[e])}down(e){let t=!1;for(const i of this.list)i.down(e)&&(t=!0);return t}move(e){let t=!1;for(const i of this.viewport.plugins.list)i.move(e)&&(t=!0);return t}up(e){let t=!1;for(const i of this.list)i.up(e)&&(t=!0);return t}wheel(e){let t=!1;for(const i of this.list)i.wheel(e)&&(t=!0);return t}}const Jke={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1,ticker:Qi.shared};class M2 extends mn{__init(){this._disableOnContextMenu=e=>e.preventDefault()}constructor(e={}){super(),M2.prototype.__init.call(this),this.options=Object.assign({},{divWheel:document.body},Jke,e),this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.divWheel=this.options.divWheel||document.body,this.options.disableOnContextMenu&&this.options.divWheel.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new qke(this),this.plugins=new Kke(this)}destroy(e){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&this.options.divWheel.removeEventListener("contextmenu",this._disableOnContextMenu),this.input.destroy(),super.destroy(e)}update(e){this.pause||(this.plugins.update(e),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new Pt(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(e=window.innerWidth,t=window.innerHeight,i,r){this.screenWidth=e,this.screenHeight=t,typeof i<"u"&&(this._worldWidth=i),typeof r<"u"&&(this._worldHeight=r),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(e){this._worldWidth=e,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(e){this._worldHeight=e,this.plugins.resize()}getVisibleBounds(){return new Pt(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(e,t){return arguments.length===2?this.toLocal(new Ae(e,t)):this.toLocal(e)}toScreen(e,t){return arguments.length===2?this.toGlobal(new Ae(e,t)):this.toGlobal(e)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new Ae(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(e){this.moveCenter(e)}moveCenter(...e){let t,i;typeof e[0]=="number"?(t=e[0],i=e[1]):(t=e[0].x,i=e[0].y);const r=(this.worldScreenWidth/2-t)*this.scale.x,s=(this.worldScreenHeight/2-i)*this.scale.y;return(this.x!==r||this.y!==s)&&(this.position.set(r,s),this.plugins.reset(),this.dirty=!0),this}get corner(){return new Ae(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(e){this.moveCorner(e)}moveCorner(...e){let t,i;return e.length===1?(t=-e[0].x*this.scale.x,i=-e[0].y*this.scale.y):(t=-e[0]*this.scale.x,i=-e[1]*this.scale.y),(t!==this.x||i!==this.y)&&(this.position.set(t,i),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(e){return this.screenWidth/e}findFitHeight(e){return this.screenHeight/e}findFit(e,t){const i=this.screenWidth/e,r=this.screenHeight/t;return Math.min(i,r)}findCover(e,t){const i=this.screenWidth/e,r=this.screenHeight/t;return Math.max(i,r)}fitWidth(e=this.worldWidth,t,i=!0,r){let s;t&&(s=this.center),this.scale.x=this.screenWidth/e,i&&(this.scale.y=this.scale.x);const o=this.plugins.get("clamp-zoom",!0);return!r&&o&&o.clamp(),t&&s&&this.moveCenter(s),this}fitHeight(e=this.worldHeight,t,i=!0,r){let s;t&&(s=this.center),this.scale.y=this.screenHeight/e,i&&(this.scale.x=this.scale.y);const o=this.plugins.get("clamp-zoom",!0);return!r&&o&&o.clamp(),t&&s&&this.moveCenter(s),this}fitWorld(e){let t;e&&(t=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),e&&t&&this.moveCenter(t),this}fit(e,t=this.worldWidth,i=this.worldHeight){let r;e&&(r=this.center),this.scale.x=this.screenWidth/t,this.scale.y=this.screenHeight/i,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const s=this.plugins.get("clamp-zoom",!0);return s&&s.clamp(),e&&r&&this.moveCenter(r),this}setZoom(e,t){let i;t&&(i=this.center),this.scale.set(e);const r=this.plugins.get("clamp-zoom",!0);return r&&r.clamp(),t&&i&&this.moveCenter(i),this}zoomPercent(e,t){return this.setZoom(this.scale.x+this.scale.x*e,t)}zoom(e,t){return this.fitWidth(e+this.worldScreenWidth,t),this}get scaled(){return this.scale.x}set scaled(e){this.setZoom(e,!0)}snapZoom(e){return this.plugins.add("snap-zoom",new Qke(this,e)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new Ae(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(e){this.x=-e*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(e){this.x=-e*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(e){this.y=-e*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(e){this.y=-e*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(e){this._dirty=e}get forceHitArea(){return this._forceHitArea}set forceHitArea(e){e?(this._forceHitArea=e,this.hitArea=e):(this._forceHitArea=null,this.hitArea=new Pt(0,0,this.worldWidth,this.worldHeight))}drag(e){return this.plugins.add("drag",new H7(this,e)),this}clamp(e){return this.plugins.add("clamp",new kke(this,e)),this}decelerate(e){return this.plugins.add("decelerate",new Bke(this,e)),this}bounce(e){return this.plugins.add("bounce",new Rke(this,e)),this}pinch(e){return this.plugins.add("pinch",new Oy(this,e)),this}snap(e,t,i){return this.plugins.add("snap",new Wke(this,e,t,i)),this}follow(e,t){return this.plugins.add("follow",new Gke(this,e,t)),this}wheel(e){return this.plugins.add("wheel",new Yke(this,e)),this}animate(e){return this.plugins.add("animate",new gu(this,e)),this}clampZoom(e){return this.plugins.add("clamp-zoom",new Lke(this,e)),this}mouseEdges(e){return this.plugins.add("mouse-edges",new Vke(this,e)),this}get pause(){return!!this._pause}set pause(e){this._pause=e,this.lastViewport=null,this.moving=!1,this.zooming=!1,e&&this.input.pause()}ensureVisible(e,t,i,r,s){s&&(i>this.worldScreenWidth||r>this.worldScreenHeight)&&(this.fit(!0,i,r),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let o=!1;e<this.left?(this.left=e,o=!0):e+i>this.right&&(this.right=e+i,o=!0),t<this.top?(this.top=t,o=!0):t+r>this.bottom&&(this.bottom=t+r,o=!0),o&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}var Kh;class Zke extends hn{constructor(t){super();ke(this,Kh,void 0);this.name="GRID",this.interactive=!1,this.x=0,this.y=0,Qe(this,Kh,Object.assign({},rCe,t)),this.draw()}draw(){const{cellSize:t,lineNative:i,lineWidth:r,lineColor:s,lineAlpha:o,cellSize2:a,lineNative2:l,lineWidth2:c,lineColor2:u,lineAlpha2:h}=S(this,Kh);this.drawGridLines(t,r,s,o,i),this.drawGridLines(a,c,u,h,l),this.endFill()}redraw(){this.clear(),this.draw()}drawGridLines(t,i,r,s,o){if(!tn(t)||t<=0)return;const{width:a,height:l}=S(this,Kh),c={width:i,color:r,alpha:s,native:o};this.lineStyle(c),this.horizontalLines(a,l,t),this.verticalLines(a,l,t)}updateOptions(t){Qe(this,Kh,Ln(S(this,Kh),t))}horizontalLines(t,i,r){let s=r;const o=t,a=i;if(i>r)do this.moveTo(0,s),this.lineTo(o,s),s+=r;while(s<a)}verticalLines(t,i,r){let s=r;const o=i,a=t;if(t>r)do this.moveTo(s,0),this.lineTo(s,o),s+=r;while(s<a)}}Kh=new WeakMap;class eOe extends hn{constructor(){super(...arguments);E(this,"ele",new hn)}setup(t,i,r){const{width:s=100,height:o=100,x:a=0,y:l=0,color:c=255,angle:u=0,alpha:h=1,offsetX:d=0,offsetY:f=0,showStar:p=!0,icon:g,limitBounds:m}=r;if(this.ele.x=a||this.ele.x,this.ele.y=l||this.ele.y,this.ele.beginFill(c,h),this.ele.drawRect(0,0,s,o),this.ele.endFill(),p&&(this.ele.lineStyle(1,16711680),this.ele.moveTo(-d-5,-f),this.ele.lineTo(-d+5,-f),this.ele.moveTo(-d,-f-5),this.ele.lineTo(-d,-f+5)),g){const x=Ur.from(g.url);g.width&&(x.width=g.width),g.height&&(x.height=g.height),x.angle=g.angle||0,x.x=g.x,x.y=g.y,this.ele.addChild(x)}this.ele.angle=u,this.ele.interactive=!0,this.addChild(this.ele);const{topLeft:v={x:0,y:0},bottomRight:_={x:t,y:i}}=m||{},y=new hn;y.beginFill(0),y.drawRect(v.x,v.y,_.x-v.x,_.y-v.y),y.endFill(),this.addChild(y);const A=x=>{if(!Nc(x))return;this.ele.cursor=null;const T=x.data.getLocalPosition(this);this.ele.x=T.x+d,this.ele.y=T.y+f,this.ele.x<v.x&&(this.ele.cursor="none",this.ele.x=v.x),this.ele.y<v.y&&(this.ele.cursor="none",this.ele.y=v.y),this.ele.x+this.ele.width>_.x&&(this.ele.cursor="none",this.ele.x=_.x-this.ele.width),this.ele.y+this.ele.height>_.y&&(this.ele.cursor="none",this.ele.y=_.y-this.ele.height)},w=()=>{this.ele.clear(),this.ele.children.forEach(x=>{x.destroy()}),I(),this.ele.parent&&this.ele.parent.removeChild(this.ele),y.parent&&y.destroy()},b=x=>{if(!Nc(x))return;const{button:T,buttons:O,pointerType:F,originalEvent:G}=x.data;window.TouchEvent&&G instanceof TouchEvent&&A(x),!(!(T===0&&O===1)||F==="pen")&&(x.stopPropagation(),I(),C(),console.log("拍摄点：",a,l))},C=()=>{this.parent.emit(Wp.GET_POSITION,{x:this.ele.x,y:this.ele.y})},I=()=>{this.parent.off("pointermove",A),this.parent.off("pointerdown",b)};return this.parent.on("pointermove",A),this.parent.on("pointerdown",b),{clearFn:w,mask:y,confirm:C}}}class tOe extends H7{wheel(e){return this.options.wheelSwapAxes=e.shiftKey,super.wheel(e)}}const nOe=(n,e,t)=>{const{backgroundColor:i,backgroundAlpha:r,outlineColor:s,outlineAlpha:o,outlineWidth:a,outlineNative:l}=t,c=new hn;return c.name="BACKDROP",c.lineStyle({width:a,native:l,color:s,alpha:o,alignment:0}).beginFill(i,r).drawRect(0,0,n,e).endFill(),c};var Du,Io,Ss,Ol,w0,Jh,vc,tv,Ys,Ra,x0,_c,yc,Zh,ed;class iOe extends M2{constructor(t){super(t);ke(this,Du,void 0);ke(this,Io,void 0);ke(this,Ss,void 0);ke(this,Ol,new mn);ke(this,w0,new hn);ke(this,Jh,new mn);E(this,"bgLayer",new mn);ke(this,vc,new hn);ke(this,tv,void 0);ke(this,Ys,void 0);E(this,"displayGroup",new ub(0,!0));E(this,"displayLayer");ke(this,Ra,void 0);ke(this,x0,void 0);ke(this,_c,void 0);ke(this,yc,void 0);ke(this,Zh,void 0);ke(this,ed,void 0);E(this,"tempLayer");E(this,"isDragMode",!1);E(this,"bgMaskSize");const{worldWidth:i,worldHeight:r,minScale:s,maxScale:o,fitOffsetRatio:a,align:l=Ua.CENTER,offsetX:c=0,offsetY:u=0,offsetBottom:h=0,offsetRight:d=0}=t;Qe(this,Du,nOe(i||0,r||0,t)),Qe(this,Ra,a),Qe(this,_c,c),Qe(this,yc,u),Qe(this,Zh,h),Qe(this,ed,d),Qe(this,x0,l),this.pinch({factor:1,noDrag:!1}),this.clampZoom({minScale:s,maxScale:o}),Qe(this,Ys,new Zke(Object.assign({width:i||0,height:r||0},t.grid))),this.bgLayer.name="bgLayer",this.addChild(this.bgLayer,S(this,Ys)),Qe(this,tv,new eOe),this.sortableChildren=!0,this.bgLayer.zIndex=-1,this.bgLayer.addChild(S(this,Du),S(this,Jh),S(this,vc)),this.setupLocalBgContainer(),this.align(l),this.setupDisplayLayer(),this.setupBgContainer(),this.addChild(S(this,tv))}get grid(){return S(this,Ys)}updateViewportConfig(t){const{gridVisible:i=S(this,Ys).visible,backdropVisible:r=S(this,Du).visible}=t;S(this,Ys).visible=i,S(this,Du).visible=r}setupLocalBgContainer(){S(this,Jh).addChild(S(this,Ol)),S(this,Ol).addChild(S(this,w0)),S(this,Ol).name="localBgContainer",S(this,Ol).visible=!1}setupBgContainer(){S(this,vc).beginFill(0,.5).drawRect(0,0,this.worldWidth,this.worldHeight).endFill(),S(this,Jh).mask=S(this,vc)}setupDisplayLayer(){this.displayLayer=new FA(this.displayGroup),this.displayLayer.name="displayLayer";const t=new mn;t.name="layerContainer",t.addChild(this.displayLayer),this.displayLayer.addChild(new FA),this.addChild(t)}toWheelMode(t=!0,i=!0){var s;this.updateCursor("default");const r={wheel:t,pressDrag:!1,ignoreKeyToPressOnTouch:!0};((s=globalThis.navigator)==null?void 0:s.platform)==="Win32"?this.plugins.add("drag",new tOe(this,r)):this.drag(r),this.wheel({wheelZoom:!1,trackpadPinch:i}),this.isDragMode=!1}toDragMode(){this.cursor="grab",this.drag({wheel:!1,pressDrag:!0}),this.isDragMode=!0}toZoomMode(){}alignment(t,i){let r=0,s=0;switch(t){case bu.LEFT:r=this.screenWidth*S(this,Ra)+S(this,_c);break;case bu.CENTER:r=(this.screenWidth-this.screenWorldWidth-S(this,_c)-S(this,ed))/2+S(this,_c);break;case bu.RIGHT:default:r=this.screenWidth-S(this,ed)-this.screenWorldWidth-this.screenWidth*S(this,Ra);break}switch(i){case wu.TOP:s=this.screenHeight*S(this,Ra)+S(this,yc);break;case wu.CENTER:s=(this.screenHeight-this.screenWorldHeight-S(this,yc)-S(this,Zh))/2+S(this,yc);break;case wu.BOTTOM:default:s=this.screenHeight-S(this,Zh)-this.screenHeight*S(this,Ra)-this.screenWorldHeight;break}this.position.set(r,s)}fit(t,i=this.worldWidth,r=this.worldHeight){let s;t&&(s=this.center);const o=this.screenWidth*S(this,Ra)+S(this,_c)+S(this,ed),a=this.screenHeight*S(this,Ra)+S(this,yc)+S(this,Zh);this.scale.x=(this.screenWidth-o)/i,this.scale.y=(this.screenHeight-a)/r,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const l=this.plugins.get("clamp-zoom",!0);return l&&l.clamp(),t&&s&&this.moveCenter(s),this}fitWidth(t=this.worldWidth,i,r=!0,s){let o;i&&(o=this.center);const a=this.screenWidth*S(this,Ra)*2+S(this,_c)+S(this,ed);this.scale.x=(this.screenWidth-a)/t,r&&(this.scale.y=this.scale.x);const l=this.plugins.get("clamp-zoom",!0);return!s&&l&&l.clamp(),i&&o&&this.moveCenter(o),this}fitHeight(t=this.worldHeight,i,r=!0,s){let o;i&&(o=this.center);const a=this.screenHeight*S(this,Ra)*2+S(this,yc)+S(this,Zh);this.scale.y=(this.screenHeight-a)/t,r&&(this.scale.x=this.scale.y);const l=this.plugins.get("clamp-zoom",!0);return!s&&l&&l.clamp(),i&&o&&this.moveCenter(o),this}addToLayer(t){return t.parentGroup=this.displayGroup,this.displayLayer.addChild(t)}clearLayer(){this.getInteractiveElements().forEach(i=>{m2(i)})}setupAssistantEle(t){const{clearFn:i,mask:r,confirm:s}=S(this,tv).setup(this.worldWidth,this.worldHeight,t),o=this.getChildByName("AXIS_MASK"),a=o?o.mask:null,l=S(this,Ys).mask,c=this.bgLayer.mask;return o&&(o.mask=r),S(this,Ys).mask=r,this.bgLayer.mask=r,u=>{S(this,Ys).mask=l,this.bgLayer.mask=c,o&&(o.mask=a),u&&s(),i()}}setLocalBackgroundImage(t,i){var r;if((r=S(this,Ss))==null||r.destroy({texture:!0}),Qe(this,Ss,null),S(this,Ol).visible=!1,t&&t instanceof HTMLImageElement){const s=new Fi(t);s.filters=[],s.interactive=!1;const{x:o=0,y:a=0,angle:l=0,width:c=140,height:u=100,boundColor:h=16711680,boundAlpha:d=.5}=i;s.width=c,s.height=u,this._redrawLocalBgBounds(this.worldWidth,this.worldHeight,h,d),s.x=o,s.y=a,s.angle=l,Qe(this,Ss,s),S(this,Ol).addChild(s),S(this,Ol).visible=!0}}updateLocalBackgroundImage(t){if(S(this,Ss)){const{x:i=S(this,Ss).x,y:r=S(this,Ss).y,angle:s=S(this,Ss).angle,width:o=S(this,Ss).width,height:a=S(this,Ss).height,boundColor:l=16711680,boundAlpha:c=.5}=t;S(this,Ss).x=i,S(this,Ss).y=r,S(this,Ss).angle=s,S(this,Ss).width=o,S(this,Ss).height=a,this._redrawLocalBgBounds(this.worldWidth,this.worldHeight,l,c)}}setLocalBackdropVisible(t){S(this,Ol).visible=t}_redrawLocalBgBounds(t,i,r=16777215,s=.5){const o=S(this,w0);o.clear(),o.beginFill(r,s),o.drawRect(0,0,t,i),o.endFill()}set backgroundImage(t){var i;if((i=S(this,Io))==null||i.destroy({texture:!0}),Qe(this,Io,null),t&&t instanceof HTMLImageElement){const r=new Fi(t);r.filters=[],r.interactive=!1,Qe(this,Io,r),S(this,Jh).addChildAt(r,0)}}get backgroundSprite(){return S(this,Io)}get bgContainer(){return S(this,Jh)}get backgroundImageData(){const t=_Se(S(this,Io),S(this,Io).width,S(this,Io).height);if(!t)return null;const{canvas:i,ctx:r}=t;return r.getImageData(0,0,i.width,i.height)}align(t){const{worldWidth:i,worldHeight:r}=this;switch(S(this,x0)||t){case Ua.TOP_LEFT:this.fit(!0,i,r),this.position.set(S(this,_c),S(this,yc));break;case Ua.WIDTH:this.fitWidth(i,!1),this.alignment(bu.CENTER,wu.TOP);break;case Ua.HEIGHT:this.fitHeight(r,!1),this.alignment(bu.LEFT,wu.CENTER);break;case Ua.AUTO:case Ua.CENTER:default:this.fit(!0,i,r),this.alignment(bu.CENTER,wu.CENTER);break}this.emit(kC.ZOOMED,{viewport:this})}destroyBackgroundImage(){var t;(t=S(this,Io))==null||t.destroy({texture:!0}),Qe(this,Io,null)}updateBackgroundImage(t,i){i&&(this.backgroundImage=i);const r=S(this,Io);if(t&&r){this.fitBGToCenter();const{align:s=zh.TOP_LEFT,offsetX:o,offsetY:a,width:l=r.width,height:c=r.height,bgMaskSize:u}=t;this.bgMaskSize=u,S(this,vc).width=(u==null?void 0:u.width)??this.worldWidth,S(this,vc).height=(u==null?void 0:u.height)??this.worldHeight,r.width=l,r.height=c,r.parseJSON(t);const{angle:h=r.angle}=t;let d=l-this.worldWidth,f=c-this.worldHeight;(h%360===90||h%360===270)&&(d=c-this.worldWidth,f=l-this.worldHeight);const g={[zh.TOP_LEFT]:{x:d/2,y:f/2},[zh.BOTTOM_LEFT]:{x:d/2,y:-f/2},[zh.TOP_RIGHT]:{x:-d/2,y:f/2},[zh.BOTTOM_RIGHT]:{x:-d/2,y:-f/2}}[s];g&&(r.position.x+=g.x,r.position.y+=g.y),tn(o)&&(r.position.x+=o),tn(a)&&(r.position.y+=a)}}fitBGToCenter(){const t=S(this,Io);t&&(t.anchor.set(.5,.5),t.position.x=this.worldWidth/2,t.position.y=this.worldHeight/2)}isOutSide(t,i,r=.001){const{minX:s,minY:o,maxX:a,maxY:l}=Yp([t],this);let c=!1;const{x:u=0,y:h=0,width:d=this.worldWidth,height:f=this.worldHeight}=i||{};return c=a<u-r||l<h-r||s>u+d+r||o>h+f+r,c}getInteractiveElements(t={excludeOutSide:!1,excludeHidden:!1}){const{scope:i}=t,r=this.getContainer(i);if(!r.visible)return[];const{excludeOutSide:s,outSideRange:o,excludeHidden:a=!1,excludeLock:l,ids:c,excludeIds:u}=t,h=c?new Set(c):null,d=u?new Set(u):null;let f=[];return f=_2(r,g=>{let m=!0;const v=g.id;return h&&!h.has(v)||d&&d.has(v)?!1:(g.interactive?s&&this.isOutSide(g,o)&&(m=!1):m=!1,a&&g.visible===!1&&(m=!1),l&&g.enableTransform===!1&&(m=!1),m)}),f}resize(t,i,r,s,o,a){var l,c;super.resize(t,i,r,s),S(this,Ys).updateOptions({...a,width:r,height:s}),S(this,Ys).redraw(),this.align(o),S(this,Du).width=r,S(this,Du).height=s,S(this,vc).width=((l=this.bgMaskSize)==null?void 0:l.width)??r,S(this,vc).height=((c=this.bgMaskSize)==null?void 0:c.height)??s}updateGrid(t){S(this,Ys).updateOptions(t),S(this,Ys).redraw()}getPointClickElements(t,i){return i=i??this.getInteractiveElements({excludeHidden:!0}),dSe(t,i,this,{scale:this.scale,touchTor:6})}getRegionalElements(t,i,r){const s=r??this.getInteractiveElements();return fSe(t,i,s,this)}set gridVisible(t){S(this,Ys).visible=t}set displayLayerVisible(t){this.displayLayer.visible=t}getContainer(t){switch(t){case"displayLayer":return this.displayLayer;case"tempLayer":return this.tempLayer;default:return this.displayLayer}}addToContainer(t,i){var r;switch(i){case"bgLayer":this.bgLayer.addChild(t);break;case"displayLayer":this.displayLayer.addChild(t);break;case"tempLayer":(r=this.tempLayer)==null||r.addChild(t);break;default:this.addChild(t);break}}updatePosition(t,i){this.position.set(t,i),this.emit(kC.MOVED,{viewport:this})}updateCursor(t){this.cursor=t}updateInteractivedDisplay(t){this.getInteractiveElements().forEach(r=>{r.parseJSON({...t})})}}Du=new WeakMap,Io=new WeakMap,Ss=new WeakMap,Ol=new WeakMap,w0=new WeakMap,Jh=new WeakMap,vc=new WeakMap,tv=new WeakMap,Ys=new WeakMap,Ra=new WeakMap,x0=new WeakMap,_c=new WeakMap,yc=new WeakMap,Zh=new WeakMap,ed=new WeakMap;rc.add({name:"interaction",type:ai.RendererPlugin,ref:YTe});ms.minSegments=50;class oc extends Zr{constructor(){super(...arguments);E(this,"plugins",[]);E(this,"app");E(this,"viewport");E(this,"transformer");E(this,"tempLayer");E(this,"selector");E(this,"centralAxis");E(this,"imageProcess");E(this,"imageTracing");E(this,"_operationStack",new aI);E(this,"curDisplayObject");E(this,"modeManager",new NDe);E(this,"configManager",new zDe);E(this,"globalManager",Qp.getInstance());E(this,"layerManager",new SDe);E(this,"batchCreate",new FRe);E(this,"alignController",new Q9);E(this,"centralAxisCb");E(this,"isDragMode",!1);E(this,"enableSelectElements",!0);E(this,"canvasOptions");E(this,"tempOutline",null);E(this,"hitAreaManager");E(this,"textCurve");E(this,"otherData",null);E(this,"scaleMode");E(this,"_id",Ui());E(this,"onStageResize",new us("onStageResize"));E(this,"_isMultiSelectMode",!1);E(this,"selectedGroupTags",[]);E(this,"groupMap",{});E(this,"zOrderImage",{});E(this,"contextInfo");E(this,"elementsFillMap",{})}get id(){return this._id}set id(t){this._id=t}get view(){return this.app.view}get isMultiSelectMode(){return this._isMultiSelectMode}set isMultiSelectMode(t){this._isMultiSelectMode=t}get operationStack(){return this._operationStack}set operationStack(t){this._operationStack=t}viewportAddChild(t){this.viewport.displayLayer.addChild(...t)}get currentState(){return{hasBackground:!!this.viewport.backgroundSprite,backgroundVisible:this.backgroundVisible(),enableCombine:!!this.selectedPathsClosed,scaled:this.viewport.scaled,enableMoveBack:!1,enableMoveForward:!1,enableRedo:this.canRedo,enableUndo:this.canUndo,enableSelectElements:this.enableSelectElements,viewportWidth:this.viewport.worldWidth,viewportHeight:this.viewport.worldHeight,isMultiSelectMode:this.isMultiSelectMode,...this.getSelectedData()}}get curMaxZOrder(){return lj(this.getInteractiveElements().map(({zOrder:t})=>t))||0}beforeAddDisplayToViewport(t,i){if(!t||Array.isArray(t)&&t.length===0)return;(Array.isArray(t)?t:[t]).forEach(s=>{if(this.commonActionToDisplay(s),i&&i.length>0)for(let o=0;o<i.length;o++){const{action:a}=i[o];let{args:l}=i[o];l=l||[s],a(...l)}})}updateStageBg(t){this.app.stage.updateBg(t)}clearStageBg(){this.app.stage.clearBg()}addDisplayToViewport(t,i=!0,r=!1){this.viewport.addToLayer(t),this.updateAllDisplaysOrder(r),t.interactive&&i&&(this.selected=[t])}commonActionToDisplay(t){const{displayConfig:i}=this.configManager,{enableShowFill:r=!0}=i;t.interactive=!0,xMe(t);const s=t.layerColor??i.layerColor,o=t.layerTag??i.layerTag;t.parseJSON({...i,isFill:r&&t.isFill,layerColor:s,layerTag:o}),t.parentGroup=this.viewport.displayGroup}initApp(t){const i=Object.assign({resolution:window.devicePixelRatio,antialias:!0,autoStart:!1,autoDensity:!0,backgroundColor:nCe},t),r=i.resizeTo;delete i.resizeTo,this.app=new u2(i),this.app.view.style.width="100%",this.app.view.style.height="100%",this.app.queueResize=()=>{this.app.resize(),this.app.render()},this.app.resizeTo=r,this.app.stage=new xke,this.app.stage.sortableChildren=!0,this.app.ticker.maxFPS=30,this.app.renderer.on("resize",(s,o)=>{var a;if(this.app.renderer._renderByLeftPanel){this.handleCanvasResize({canvasW:s,canvasH:o}),delete this.app.renderer._renderByLeftPanel;return}this.resizeViewport({width:s,height:o,scaleMode:this.scaleMode}),this.plugins.forEach(l=>{l.resize&&l.resize(s,o)}),(a=this.centralAxis)==null||a.resize({worldHeight:this.viewport.worldHeight,stageHeight:o}),this.onStageResize.emit(s,o)}),globalThis.__PIXI_APP__=this.app}addStatsPanel(){const t=p7.addStats(document,this.app);this.app.ticker.add(()=>{t.update()},t,rl.UTILITY),t.stats.domElement.style.position="absolute",t.stats.domElement.style.top="0",t.stats.domElement.style.zIndex="1000"}resizeCanvas(t){const i=We(t,"width",null),r=We(t,"height",null);!i&&!r||(this.app.renderer._renderByLeftPanel=!0,this.app.renderer.resize(i,r),this.app.render())}handleCanvasResize(t,i=Ey.LEFT){const{worldWidth:r,worldHeight:s,x:o,y:a}=this.viewport,{screenWidth:l,screenHeight:c}=this.viewport,u=(t==null?void 0:t.canvasW)||l,h=(t==null?void 0:t.canvasH)||c,d=this.viewportScaled;if(this.resizeStage(u,h,r,s),this.setZoom(d),[Ey.LEFT,Ey.TOP].includes(i)){const f=l-r*d-o,p=c-s*d-a,g=u-r*d-f,m=h-s*d-p;this.viewport.updatePosition(g,m)}else this.viewport.updatePosition(o,a)}resizeStage(t,i,r,s){var o;this.resizeViewport({width:t,height:i,viewportWidth:r,viewportHeight:s,scaleMode:this.scaleMode}),this.plugins.forEach(a=>{a.resize&&a.resize(t,i)}),(o=this.centralAxis)==null||o.resize({worldHeight:this.viewport.worldHeight,stageHeight:i})}initViewport(t){const{offsetX:i=0,offsetY:r=0,wheelOnView:s=!1}=t||{},o=Object.assign({screenWidth:this.app.screen.width-i,screenHeight:this.app.screen.height-r,worldWidth:ml.worldWidth,worldHeight:ml.worldHeight,interaction:this.app.renderer.plugins.interaction,disableOnContextMenu:!0,divWheel:s?this.app.view:"",passiveWheel:!1,stopPropagation:!0,minScale:ml.minScale,maxScale:ml.maxScale,fitOffsetRatio:ml.fitOffsetRatio,backgroundColor:ml.backgroundColor,backgroundAlpha:ml.backgroundAlpha,outlineNative:ml.outlineNative,outlineWidth:ml.outlineWidth,outlineColor:ml.outlineColor,outlineAlpha:ml.outlineAlpha},t);this.viewport=new iOe(o),this.viewport.toWheelMode(),this.app.stage.addChild(this.viewport)}initTransformer(t){this.transformer=new Eke(this.viewport,t),this.app.stage.addChild(this.transformer)}initTextCurve(t){t&&(this.textCurve=new WDe(t),this.textCurve.init(this.transformer,this.app.view),this.textCurve.mount(this.app.stage))}initEnv(){var s;const i=this.app.renderer.gl;let r=-1;i&&(r=(s=i.getParameter)==null?void 0:s.call(i,i.MAX_TEXTURE_SIZE)),this.contextInfo={version:xt.PREFER_ENV,max_texture_size:r,get bitmapMaxSize(){return uI()}},console.log("[ canvas context Info ] >",this.contextInfo)}initHitAreaManager(t){this.hitAreaManager=new o7(t),this.hitAreaManager.init(this.viewport,this.transformer)}init(t){const{cursorConfig:i,imageProcessConfig:r}=t||{};this.initViews(t),this.initCursor(i),this.configManager.imageProcessConfig=r,this.canvasOptions=t}initTempLayer(){this.tempLayer=new Cke,this.viewport.addChild(this.tempLayer),this.viewport.tempLayer=this.tempLayer}initSelector(t){this.selector=new rke(t),this.viewport.addChild(this.selector)}initViews(t){const{appConfig:i,viewportConfig:r,selectorConfig:s,transformerConfig:o,hitAreaConfig:a,textCurveConfig:l}=t||{};this.initApp(i),this.initViewport(r),this.initTransformer(o),this.initTextCurve(l),this.initTempLayer(),this.initSelector(s),this.initHitAreaManager(a),this.initEnv(),this.initEventForMask()}initCursor(t){t==null||t.forEach(i=>{const r=`url(${i.url}) ${i.style}`;this.app.renderer.plugins.interaction.cursorStyles[i.name]=r})}getPointByViewport(t){const{data:i}=t;return i.getLocalPosition(this.viewport)}handleDrawDisplayDone(t){this.curDisplayObject=void 0;const i=t.getBounds();i.width<_3&&i.height<_3?t.destroy(!0):(this.beforeAddDisplayToViewport(t),this.addDisplayToViewport(t),this.recordOperationLog(t)),this.emit(gn.DRAW_DISPLAY_DONE)}finishCurMode(t){const{resetEditMode:i=!0}=t||{};this.curDisplayObject&&this.curDisplayObject.done&&this.curDisplayObject.done(),this.imageProcess&&this.closeImageProcess(),this.imageTracing&&this.closeImageTracing(),this.modeManager.curMode===Vt.BITMAP_MASK&&this.bitmapMaskEditing&&(this.endMaskEditMode(!0,!0),this.updateEditMode(Vt.SELECT)),this.modeManager.curSubEditMode&&this.updateSubEditMode(null),i&&this.modeManager.curMode!==Vt.SELECT&&this.updateEditMode(Vt.SELECT),this.curDisplayObject=void 0,this.viewport.cursor="default"}executeSelect(t,i){if(this.modeManager.curSubEditMode)this.modeManager.curSubEditMode.setSelected(t);else{if(i&&Array.isArray(i)){const r=i.filter(s=>s&&typeof s=="string"&&s.startsWith("g-"));this.selectedGroupTags=r}t.length===0&&(this.selectedGroupTags=[]),this.plugins.forEach(r=>{r.setGroupSelection&&r.setGroupSelection(this.selectedGroupTags,this.groupMap)}),this.transformer.setGroupSelection(this.selectedGroupTags,this.groupMap),this.transformer.selected=t,this.refreshLockStyle()}}getSelectedData(){const t=this.exportSelectedJSON();let i=this.transformer.groupJSON;if(this.selected.length===1){const{x:r,y:s,width:o,height:a,angle:l,...c}=t[0];i={...i,...c}}return{canvasId:this.id,selectedJSON:t,isGroup:this.selectedGroupTags.length>0,groupNum:this.selectedGroupTags.length,selectedLength:zC(this.transformer.selected).length,groupJSON:i,bitmapMask:this.getBitmapMaskState()}}findSameGroupElements(t,i){const r=i?t.groupTag&&i[t.groupTag]||[]:this.getElementsByGroupTag(t.groupTag);return r.length===0&&r.push(t),r}getElementsByGroupTag(t,i){i=i??this.getSelectionActiveTargets();const r=[];return i.forEach(s=>{s.groupTag&&s.groupTag===t&&r.push(s)}),r}getMinAreaElementByPoint(t,i=!1){var o;const r=this.getSelectionActiveTargets({excludeHidden:!0,excludeLock:!i}),s=((o=this.viewport)==null?void 0:o.getPointClickElements(t,r))||[];return s.length>0?(s.sort(this.sortByZOrder),this.getMinAreaElement(s)):null}sortByZOrder(t,i){return t.zOrder-i.zOrder}getMinAreaElement(t,i=!0,r=.01){let s=t.pop();if(i&&s.isFill)return s;for(let o=t.length-1;o>=0;o--){const a=t[o],l=a.width*a.height;if(s.width*s.height-l>r&&(s=a),i&&a.isFill)break}return s}invertSelect(t,i,r){const s=this.findSameGroupElements(t,r),o=t.groupTag.startsWith("g-"),a=this.selectedGroupTags.indexOf(t.groupTag);if(i.includes(t))i=i.filter(l=>!s.includes(l)),o&&a!==-1&&this.selectedGroupTags.splice(a,1);else{const l=new Set(i);s.forEach(c=>{l.has(c)||i.push(c)}),o&&a===-1&&this.selectedGroupTags.push(s[0].groupTag)}return i}existDuplicateGroupTag(t,i){return t.groupTag?i.includes(t.groupTag)?!0:(i.push(t.groupTag),!1):!1}selectAreaElements(t,i,r){var d;const s=this.getSelectionActiveTargets(),o=s.filter(f=>f.visible===!0&&f.enableTransform===!0),a=((d=this.viewport)==null?void 0:d.getRegionalElements(t,i,o))||[];if(a.length<=0){!this.isMultiSelectMode&&this.transformer.selected.length>0&&(console.log(" 没有找到元素"),this.executeSelect([]));return}const l=pSe(this.viewport.toGlobal(t),this.viewport.toGlobal(i),a);let c;const u=[],h=Fr(s,"groupTag");if(r)c=this.transformer.selected.slice(),l.forEach(f=>{this.existDuplicateGroupTag(f,u)||(c=this.invertSelect(f,c,h))});else{const f=[];l.forEach(g=>{if(this.existDuplicateGroupTag(g,u))return;const m=this.findSameGroupElements(g,h);f.push(...m)}),c=Array.from(new Set(l.concat(f)));const p=Array.from(new Set(c.filter(({groupTag:g})=>g.startsWith("g-")).map(({groupTag:g})=>g)));this.selectedGroupTags=p}this.executeSelect(c)}getTextWeldInfo(t=Vh.UNION,i){if(!i){const o=this.transformer.selected;o.length===1&&(i=o[0])}if(!i||i.type!==it.TEXT)return;const r=this.getBoolEleInfo(t,i.children.filter(o=>o==null?void 0:o.dPath)),s=N9(i);return s.fillColor=i.config.fillColor,s.lineColor=i.config.lineColor,s.sourceId=i.id,s.id=Ui(),{info:r,pathJSON:s}}getBoolEleInfo(t,i=this.transformer.selected){if(i.some(d=>d.type===it.BITMAP))return{};const s=[],o=[];i.forEach(d=>{const f=d.getRealPoints(this.viewport);s.push(f),o.push(d.id)});const a=this.judgeIsFill(t,this.transformer.selected),l=i.reduce((d,f,p)=>i[d].displayOrder>f.displayOrder?p:d,i.length-1),{layerTag:c,layerColor:u,visible:h}=i[l];return{pointsList:s,selectedIds:o,isFill:a,bottomIndex:l,layerTag:c,layerColor:u,visible:h}}drawBoolResult(t,i,r={}){if(["M0,0",""].includes(i)){this.recordOperationLog();return}r.isFill===void 0&&(r.isFill=this.judgeIsFill(t,this.transformer.selected));const s=this.configManager.displayConfig,o=Us(it.PATH,{dPath:i,graphicX:0,graphicY:0,fillColor:s.fillColor,lineColor:s.lineColor,...r});this.refreshDisplaysAttr([o]),this.addDisplayToViewport(o,!0,!0),this.recordOperationLog(o)}removeElements(t="selected",i=!1,r=!0){let s=this.getViewportDisplayObjects(t);if(s.length<=0){console.warn("没有元素可以被销毁");return}const o=s.map(f=>f.id),a=this.getMultiDisplayJSON(s),l=()=>{if(i){const{curIDs:f,curAttributes:p}=m7(s,this.viewport,{texture:!0});return{curIDs:f,curAttributes:p}}return{}},c=()=>{s.forEach(f=>{this.removeElement(f)}),this.transformer.selected=this.transformer.selected.filter(f=>!o.includes(f.id))},u=(f,p)=>{const g=new Set;if((o==null?void 0:o.length)>0){const m=this.viewport.getInteractiveElements();s=m.filter(v=>o.includes(v.id)),m.forEach(v=>{g.add(v.id)})}if(r&&this.emit(gn.DISPLAYS_REMOVED,a),i){const m={allIDs:g,curIDs:f,curAttributes:p};this.recordFinalOperationLog(m)}},{curIDs:h,curAttributes:d}=l();c(),u(h,d)}createDisplayByJSON(t,i=!1,r=!0,s=[]){const o=t.map(a=>{const l={...a},c=a.type;i&&(l.sourceId=l.id,l.id=Ui());const u=Us(c,l);return u&&(this.tempLayer.addChild(u),_d(u,new Ae(l.x,l.y),this.viewport),this.tempLayer.removeChild(u)),u}).filter(Boolean);if(r){const a=[];o.forEach(l=>{s.includes(l.groupTag)?a.push(l):l.groupTag=""}),a.length>0&&g9(a,this.groupMap,this.groupMap)}return o}addDisplayToContainerByJSON(t,i=!1,r=!0,s=Fo.VIEWPORT,o=[],a){const l=this.createDisplayByJSON(t,i,r,o),c={[Fo.VIEWPORT]:u=>{this.beforeAddDisplayToViewport(u),this.addDisplayToViewport(u,!1,a)},[Fo.TEMP_LAYER]:u=>{this.beforeAddDisplayToViewport(u),this.tempLayer.addChild(u)}};return this.selected.length===0?l.sort((u,h)=>u.zOrder-h.zOrder):l.sort((u,h)=>h.zOrder-u.zOrder),l.forEach(u=>{c[s](u)}),l}judgeIsFill(t,i){const r=i.reduce((s,o,a)=>i[s].displayOrder>o.displayOrder?a:s,0);switch(t){case Vh.UNION:case Vh.INTERSECTION:case Vh.XOR:return(i.filter(s=>s.isFill)||[]).length===i.length;case Vh.DIFFERENCE:return i[r].isFill;default:return!1}}align(t){var s,o,a;if(this.modeManager.curSubEditMode&&(s=this.modeManager.curSubEditMode.curPlugin)!=null&&s.align){(a=(o=this.modeManager.curSubEditMode.curPlugin)==null?void 0:o.align)==null||a.call(o,t);return}const i=this.transformer.selected,r=zC(i);this.alignController.execute(t,r,this.transformer.getGroupBounds(!0).innerBounds,this.viewport),this.transformer.emit(sr.TRANSFORM_CHANGE,"matrix"),this.recordOperationLog(...this.selected)}updateAnchorType(t){this.modeManager.curSubEditModeName===Xi.VECTOR_EDITOR&&this.modeManager.curSubEditMode.updateAnchorType(t)}recordOuterOperationLog(t){const i=g7(this.transformer.viewport.getInteractiveElements(),[this.viewport,this.tempLayer],this.viewport,{texture:!0}),r={otherData:t,...i};this.recordFinalOperationLog(r)}resizeViewport(t={}){const{screen:i}=this.app,{worldWidth:r,worldHeight:s}=this.viewport,{width:o=i.width,height:a=i.height,viewportWidth:l=r,viewportHeight:c=s,gridOption:u,scaleMode:h=Ua.AUTO}=t;this.scaleMode=h,this.viewport.resize(o,a,l,c,h,u),this.emit(gn.VIEWPORT_RESIZE,{viewportWidth:l,viewportHeight:c})}fitImageToViewport(t){const{worldWidth:i,worldHeight:r}=this.viewport||{},{width:s,height:o}=t,{width:a,height:l}=cI(s,o,i,r);t.width=a,t.height=l}updateBackdrop(t,i){this.viewport&&(this.viewport.updateBackgroundImage(t,i),(!i||i instanceof HTMLImageElement)&&this.emit(gn.UPDATE_BACKDROP_RESULT,!!this.viewport.backgroundSprite))}destroyBackdrop(){this.viewport&&this.viewport.destroyBackgroundImage()}setLocalBackdrop(t,i){this.viewport&&this.viewport.setLocalBackgroundImage(t,i)}setLocalBackdropVisible(t){this.viewport&&this.viewport.setLocalBackdropVisible(t)}updateLocalBackgroundImage(t){this.viewport&&this.viewport.updateLocalBackgroundImage(t)}destroy(){var s,o,a,l;const t=this.app.renderer;xt.PREFER_ENV===Zl.WEBGL2&&((a=(o=(s=t.gl)==null?void 0:s.getExtension("WEBGL_lose_context"))==null?void 0:o.loseContext)==null||a.call(o));const i=this.plugins.slice(0);i.reverse();const r={children:!0,texture:!0,baseTexture:!0};i.forEach(c=>{c.destroy&&c.destroy(r)}),(l=this.app)==null||l.destroy(!0,r)}applyTextAnchorFixup(t){this.getViewportDisplayObjects(t).forEach(r=>{r.type===it.TEXT&&r.applyTextAnchorFixup()})}updateDisplayObjectsAttributes(t,i){const r=(i==null?void 0:i.needRecordOperationLog)??!0,s=this.getViewportDisplayObjects(i==null?void 0:i.displayObjectsQuery);if(s.length===0)return;const{width:o,height:a,x:l,y:c,angle:u,textsFixupAnchor:h,...d}=t;BDe(this.viewport,s,{width:o,height:a,displaysAsGroup:i==null?void 0:i.displaysAsGroup}),FDe(this.viewport,s,{x:l,y:c,displaysAsGroup:i==null?void 0:i.displaysAsGroup}),UDe(s,{angle:u,displaysAsGroup:i==null?void 0:i.displaysAsGroup}),Hu(t,["width","height","x","y","angle"])&&s.forEach(f=>{f.transformCommit&&f.transformCommit()}),s.forEach(f=>{v2(f,d,this.viewport)}),Hu(t,["enableTransform"])&&this.refreshLockStyle(),h&&this.applyTextAnchorFixup(h),this.transformer.emit(sr.TRANSFORM_CHANGE,t),r&&this.recordOperationLog(...s),this.emitTransformerCommit()}updateSelectedAttributes(t,i){var a,l,c;const r=this.modeManager.curSubEditMode;if((a=r==null?void 0:r.curPlugin)!=null&&a.updateDisplayObjectsAttributes){(c=(l=r==null?void 0:r.curPlugin)==null?void 0:l.updateDisplayObjectsAttributes)==null||c.call(l,t,{displaysAsGroup:!1});return}let s=0;const o=tn(t.angle);if(o){s=t.angle;const u=s-this.transformer.getGroupBounds().rotation/Yo;t.angle=u}this.updateDisplayObjectsAttributes(t,{displayObjectsQuery:i??"selected",displaysAsGroup:!0}),o&&this.transformer.updateGroupboundsRotation(s)}updateLockAspectRatio(){const t=!this.transformer.lockAspectRatio;return this.updateSelectedAttributes({lockRatio:t}),t}updateTransformHandleMode(t){this.transformer.changeMode(t)}updateEditMode(t=Vt.SELECT){t!==this.modeManager.curMode&&(this.modeManager.willFinishWhenEditModeChange(t)&&this.finishCurMode({resetEditMode:!1}),this.modeManager.curMode=t,t===Vt.DRAG?this.toDragMode():this.toWheelMode(),this.updateEditModeCursor(t),Vt.SELECT!==t&&(this.selected=[]),t===Vt.PEN&&this.updateSubEditMode(Xi.VECTOR_EDITOR,{mode:wi.ADD,willRecord:!0}))}updateSubEditMode(t,i){const{modeConfig:r}=this.modeManager.updateSubEditMode(t,i);r.enableDisplayLayerInteractive?this.viewport.displayLayer.interactiveChildren=!0:this.viewport.displayLayer.interactiveChildren=!1}updateEditModeCursor(t){const{RECT:i,CIRCLE:r,LINE:s,TEXT:o,PEN:a,DRAG:l}=Vt;let c="default";[i,r,s].includes(t)?c="crosshair":t===a?c="pen":t===o?c="text-add":t===l&&(c="grab"),this.viewport.updateCursor(c)}updateDisplayConfig(t){Ds(t,"enableFill")&&(t.enableShowFill=t.enableFill,delete t.enableFill);const{updateCanvasDisplay:i=!0,groupData:r}=t;r&&(this.groupMap={...this.groupMap,...r}),this.configManager.update(t),i&&this.viewport.updateInteractivedDisplay(t)}updateMultiDisplayConfig(t){const i=this.viewport.getInteractiveElements();t.forEach(r=>{const s=i.find(o=>o.id===r.id);s&&s.parseJSON({...r.config})})}removeSelected(){var t;this.modeManager.curSubEditMode?(t=this.modeManager.curSubEditMode)==null||t.removeSelected():this.removeElements(this.transformer.selectedIDs,!0,!0)}removeElement(t,i=!0){t&&(i?m2(t):t.destroy(),this.elementsFillMap[t.id]=t.isFill)}get selected(){return this.transformer.selected.length===0&&(this.selectedGroupTags=[]),this.transformer.selected}set selected(t){this.executeSelect(t)}selectAll(){const t=this.getSelectionActiveTargets()||[],i=Fr(t,"groupTag"),r=t.filter(a=>a.visible&&a.enableTransform&&!a.groupTag.startsWith("g-")),s=[],o=[];Object.entries(this.groupMap).forEach(([a,l])=>{var c;if(l.visible&&l.enableTransform){const u=i[l.groupTag];((c=u==null?void 0:u.some)==null?void 0:c.call(u,d=>d.visible&&d.enableTransform))&&(s.push(a),o.push(...u))}}),this.selectedGroupTags=s,this.executeSelect(r.concat(o))}selectSpecDisplays(t){this.transformer.selectedIDs=t}clearSelected(){this.selected=[]}getInteractiveElements(t){const{scope:i}=t||{};return i&&Rt(i)?i:this.viewport.getInteractiveElements(t)}getSelectionActiveTargets(t){var s;let i;if(this.modeManager.curMode===Vt.BITMAP_MASK&&this.bitmapMaskEditing)i=this.bitmapMaskEditing.selectionTargets;else{const o=(s=this.modeManager.curSubEditMode)==null?void 0:s.selectScope;i=this.getInteractiveElements({...t,scope:o})}return i??[]}resizeCanvasTo(t){this.app.resizeTo=t}exportSelectedJSON(t={texture:!1}){const i=this.transformer.selected;return this.getMultiDisplayJSON(i,t)}getDisplayJSON(t,i={texture:!1}){return t.toJSON(this.viewport,i)}getMultiDisplayJSON(t,i){return this.getViewportDisplayObjects(t).map(s=>this.getDisplayJSON(s,i))}getDisplayRenderData(t,i=1,r=0,s){const o=t.parentGroup;t.parentGroup=null,this.app.renderer.render(this.app.stage);const a=vSe(this.app.renderer.plugins.extract,t,i,r,s,this.contextInfo.bitmapMaxSize);return t.parentGroup=o,a}updateViewportConfig(t){this.viewport.updateViewportConfig(t)}set gridVisible(t){this.viewport.gridVisible=t}toWheelMode(){this.isDragMode=!1,this.viewport.toWheelMode(),this.updateEditModeCursor(this.modeManager.curMode)}toDragMode(){this.isDragMode||(this.isDragMode=!0,this.viewport.toDragMode())}toZoomMode(){this.viewport.toZoomMode()}setViewportToFit(t){this.viewport.align(t||this.scaleMode),this.viewport.input.clear()}get viewportScaled(){return this.viewport.scaled}setZoom(t,i=!0){this.viewport.setZoom(t,i),this.viewport.emit("zoomed",{viewport:this.viewport,type:"manual"})}zoomPercent(t,i=!0){this.viewport.zoomPercent(t,i),this.viewport.emit("zoomed",{viewport:this.viewport,type:"manual"})}flipSelected(t){this.transformer.flipSelected(t),this.recordOperationLog(...this.selected)}getPathPoints(t){return YIe(t)}getSelectAreaViewport(t){const{start:i,end:r}=t,s=i.x.toFixed()===r.x.toFixed(),o=i.y.toFixed()===r.y.toFixed();if(s&&o)return null;const a=this.viewport.bgLayer,{imageData:l}=this.getDisplayRenderData(a),c=document.createElement("canvas");c.width=l.width,c.height=l.height;const u=c.getContext("2d");u.putImageData(l,0,0);const h={minLocalPoint:i,rtLocalPoint:new Ae(r.x,i.y),maxLocalPoint:r,lbLocalPoint:new Ae(i.x,r.y)},d=new a7;if(d.setOptions({canvas:c,ctx:u}),d.clip(h),c.width===0||c.height===0)return null;const{width:f,height:p,data:g}=L9(c);return c.width=f,c.height=p,u.putImageData(g,0,0),c}translateSelected(t){var i,r;if(this.modeManager.curSubEditModeName===Xi.VECTOR_EDITOR){const s=this.modeManager.curSubEditMode;(r=(i=s==null?void 0:s.curPlugin)==null?void 0:i.translateSelected)==null||r.call(i,t),this.transformer.emit(sr.TRANSFORM_CHANGE,"matrix");return}this.transformer.translateSelected(t),this.recordOperationLog(...this.selected)}get selectedPathsClosed(){return this.selected.length<2?!1:!this.selected.some(t=>!t.isClosePath)}get selectedGroupBoundCenter(){return this.transformer.worldGroupBoundsCenter}clientPointToViewportPoint(t,i){const{top:r,left:s}=this.view.getBoundingClientRect(),o={x:t.x-s,y:t.y-r};return this.viewport.toLocal(o,null,i)}isSelectGroup(t=this.selected){let i=!1,r=[];if(t.length>1)for(let s=1;s<t.length;s++){const o=t[s-1],a=t[s];if(o.groupTag&&o.groupTag===a.groupTag){i=!0,r.push(o.id),s===t.length-1&&r.push(a.id);continue}else{i=!1,r=[];break}}else t.length===1&&(i=t[0].groupTag.startsWith("g-"),i&&r.push(t[0].id));return i&&(i=!this.getViewportDisplayObjects().some(({groupTag:o,id:a})=>o===t[0].groupTag&&!r.includes(a))),i}createGroupByZOrder(t,i){var s;if(!t||!Array.isArray(t)||t.length===0)return"";i=i??this.curMaxZOrder;let r="";if(t.length>1){nD(t),r=(s=t[0])==null?void 0:s.groupTag;const o=Number((1/(t.length+1)).toFixed(2));t.sort((a,l)=>a.zOrder-l.zOrder).forEach(a=>{i+=o,a.zOrder=i}),this.setGroupMapAttributesById(r,{zOrder:i})}else t.length===1&&(t[0].zOrder=i+1);return this.transformer.emit(sr.TRANSFORM_CHANGE,"zOrder"),r}refreshDisplayListZOrder(){this.getInteractiveElements().sort((i,r)=>i.zOrder-r.zOrder).forEach((i,r)=>{i.zOrder=++r,this.groupMap[i.groupTag]&&(this.groupMap[i.groupTag].zOrder=i.zOrder)})}createGroup(t=this.selected,i=!0,r=!0){this.refreshDisplayListZOrder();const s=t.sort((u,h)=>h.zOrder-u.zOrder),o=Number((1/(s.length+1)).toFixed(2));let a=s[0].zOrder;const{groupTag:l}=s[0];l.startsWith("g-")&&(a=this.groupMap[l].zOrder),s.reverse().forEach(u=>{a+=o,u.zOrder=a}),this.refreshDisplayListZOrder();const c=nD(t);this.setGroupMapAttributesById(c,{zOrder:t[t.length-1].zOrder}),this.refreshDisplaysAttr(t),r&&this.executeSelect(t,[c]),this.transformer.emit(sr.TRANSFORM_CHANGE,"zOrder"),i&&this.recordOperationLog(...t)}breakGroup(t=this.selected){t.forEach(i=>{const r=this.selectedGroupTags.indexOf(i.groupTag);r!==-1&&this.selectedGroupTags.splice(r,1),i.groupTag=void 0}),this.refreshDisplaysAttr(t),this.selected=t,this.transformer.emit(sr.TRANSFORM_CHANGE,"zOrder"),this.clearGroupMap()}stop(){this.app.render(),this.app.stop(),Qi.shared.stop(),Qi.system.stop()}start(){this.app.start(),Qi.shared.start(),Qi.system.start()}render(){this.app.render()}showBackground(){this.viewport.bgContainer.visible=!0}hideBackground(){this.viewport.bgContainer.visible=!1}backgroundVisible(){return this.viewport.bgContainer.visible}setupAssistantEle(t){var i;return(i=this.viewport)==null?void 0:i.setupAssistantEle(t)}setEnableSelectElements(t){this.enableSelectElements=t}updateNewElesOrder(t){let i=this.curMaxZOrder;t.filter(r=>!r.zOrder).forEach(r=>{r.zOrder=++i})}addPathToViewport(t,i,r,s){if(!t||t==="M0,0")return null;const{lineColor:o}=this.configManager.displayConfig,a=Us(it.PATH,{dPath:t,graphicX:0,graphicY:0,fillColor:null,lineColor:o,layerColor:i,layerTag:kd.convertToLayerColorHex(r),isFill:s,enableFill:!!s});return a.originColor=r,a.interactive=!0,this.beforeAddDisplayToViewport(a),this.addDisplayToViewport(a,!0),a}getViewportDisplayObjects(t="all"){let i=[];return Array.isArray(t)&&t.length>0?t.every(s=>s instanceof rn)?i=t:i=[...this.queryInteractiveDisplayObjects(t).values()]:t==="selected"?i=[...this.selected]:t==="all"&&(i=this.getInteractiveElements()),i}queryInteractiveDisplayObjects(t,i){i=i??[this.viewport.displayLayer,this.tempLayer];const r=new Set([...t]),s=new o9;for(const o of I2(i))(r.has(o.id)||r.has(o))&&s.add(o.id,o);return s}getOtherData(){}getGraphicsCurves(){return a9(ms)}setGraphicsCurves(t){PA(t,ms)}changeGraphicsCurvesFor(t,i){return rSe(t,i,ms)}updateAppConfig(t){const{interactiveChildren:i}=t;gi(i)||(this.app.stage.interactiveChildren=i)}}class rOe extends oc{constructor(){super(...arguments);E(this,"sourceDisplays",[]);E(this,"sourceDisplaysVisibleState",{});E(this,"editing",!1)}batchCreateOnTemp(t,i){const r=this.exportSelectedJSON({texture:!0});if(this.editing===!1){this.sourceDisplays=[],this.sourceDisplaysVisibleState={};const o=this.getInteractiveElements(),a=r.map(({id:l})=>l);o.forEach(l=>{a.includes(l.id)&&(this.sourceDisplaysVisibleState[l.id]=l.visible,this.sourceDisplays.push(l),l.visible=!1)}),this.editing=!0}else r.forEach(o=>{o.visible=this.sourceDisplaysVisibleState[o.id]});this.batchCreate.create(t,r,this.transformer.worldGroupBounds.getRectangle(),i).forEach(o=>{const a=this.addDisplayToContainerByJSON(o,!1,!0,Fo.TEMP_LAYER);this.batchCreate.appendToTemp(a)})}finishBatchCreate(t=!0,i){let r=[];if(t)this.sourceDisplays.forEach(s=>{s.visible=this.sourceDisplaysVisibleState[s.id]});else{const s=this.batchCreate.temp;s.forEach(l=>{this.addDisplayToViewport(l,!1)});const o=[...s];let a="";i&&(a=this.createGroupByZOrder(o)),this.refreshDisplaysAttr(o),r=this.getMultiDisplayJSON(s,{texture:!1}),this.executeSelect(o,[a]),this.removeElements(this.sourceDisplays),this.recordOperationLog(...o)}return this.sourceDisplays=[],this.sourceDisplaysVisibleState={},this.editing=!1,this.batchCreate.temp.forEach(s=>this.tempLayer.removeChild(s)),this.batchCreate.clearTemp(t),{res:r,matrixResult:this.batchCreate.matrixResult,descriptionResult:this.batchCreate.descriptionResult}}getShapeMatchData(){if(this.selected.length===0)return{};const t=this.viewport.bgLayer,{imageData:{width:i,height:r,data:s}}=this.getDisplayRenderData(t),{x:o,y:a}=this.transformer.worldGroupBoundsCenter,l={x:o,y:a,bitmap:s,w:i,h:r};return{displaysJSON:this.exportSelectedJSON({texture:!0}),options:l}}addShapeMatchResult(t){if(t.length>0){const i=[];return t.forEach(s=>{const o=this.addDisplayToContainerByJSON(s,!0);i.push(...o)}),this.recordOperationLog(...i),this.getMultiDisplayJSON(i,{texture:!1})}return[]}}class sOe extends oc{createCentralAxis(e,t){var c,u;this.centralAxis&&this.destroyCentralAxis(),this.centralAxisCb=()=>{const h=this.viewport.toGlobal(new Ae(this.centralAxis.mask.width,0));this.centralAxis.axis.x=h.x};const{worldHeight:i,worldWidth:r}=this.viewport,{height:s,width:o}=this.app.screen,a=this.viewport.toGlobal(new Ae(e,0)),l=()=>{this.emit(gn.UPDATE_CENTRAL_AXIS,this.centralAxis.mask.width)};this.centralAxis=new ske({viewportX:e,stageX:a.x,stageWidth:o,stageHeight:s,worldWidth:r,worldHeight:i,onUpdate:l,iconOption:t}),this.app.stage.addChild(this.centralAxis.axis),this.viewport.addChild(this.centralAxis.mask),(c=this.viewport)==null||c.on("moved",this.centralAxisCb),(u=this.viewport)==null||u.on("zoomed",this.centralAxisCb)}get centralAxisPosition(){var e;return((e=this.centralAxis)==null?void 0:e.mask.width)||0}destroyCentralAxis(){var e,t,i;this.centralAxisCb&&((e=this.viewport)==null||e.off("moved",this.centralAxisCb),(t=this.viewport)==null||t.off("zoomed",this.centralAxisCb)),(i=this.centralAxis)==null||i.clear(),this.centralAxis=void 0,this.centralAxisCb=void 0}}class oOe extends oc{showInvisible(){for(const t of Object.values(this.groupMap))t.visible=!0;const e=this.getInteractiveElements();e.forEach(t=>{this.updateDisplayObjectsAttributes({visibleState:!0,visible:!0},{displayObjectsQuery:[t],needRecordOperationLog:!1})}),this.recordOperationLog(...e)}getGroupMap(){return this.groupMap}getPasteGroupMap(){const e={};return this.selectedGroupTags.map(t=>{e[t]={...this.groupMap[t]}}),e}createDisplayByCopyPasteData(e){return e.map(i=>{const r={...i},s=i.type;r.sourceId=r.id,r.id=Ui();const o=Us(s,r);return o&&(this.tempLayer.addChild(o),_d(o,new Ae(r.x,r.y),this.viewport),this.tempLayer.removeChild(o)),o}).filter(Boolean)}refreshDisplaysAttr(e,t={visible:{value:void 0},lock:{value:void 0}}){const{visible:i,lock:r}=t,s=this.groupMap;e.forEach(o=>{const{groupTag:a}=o;let{visible:l,visibleState:c,lockState:u,enableTransform:h}=o,d=!0,f=!1;const p=s[a];p&&(typeof i<"u"&&(d=p.visible),typeof r<"u"&&(f=!p.enableTransform));const g={};typeof i<"u"&&(typeof(i==null?void 0:i.value)<"u"&&(c=i.value),l=c&&d,Object.assign(g,{visibleState:c,visible:l})),typeof r<"u"&&(typeof(r==null?void 0:r.value)<"u"&&(u=r.value),h=!(f||u),Object.assign(g,{lockState:u,enableTransform:h})),v2(o,g,this.viewport)}),typeof r<"u"&&this.refreshLockStyle()}addDisplayToContainerByCopyPasteData(e,t=!0,i={},r=[],s){const o=this.createDisplayByCopyPasteData(e);if(t){const a=[];o.forEach(l=>{r.includes(l.groupTag)?a.push(l):l.groupTag=""}),a.length>0&&g9(a,i,this.groupMap)}if(o.forEach(a=>{this.beforeAddDisplayToViewport(a),this.addDisplayToViewport(a,!1,!0)}),!s){if(this.selected.length===0){let a=this.curMaxZOrder;o.sort((l,c)=>l.zOrder-c.zOrder).forEach(l=>{a++,l.zOrder=a})}else{const a=()=>{let c=0,u="";return this.selected.length>0&&this.selected.forEach(({groupTag:h,zOrder:d})=>{c<d&&(c=d,h.startsWith("g-")?u=h:u="")}),{maxZOrder:c,selectedGroupTag:u}},l=Number((1/(o.length+1)).toFixed(2));o.sort((c,u)=>c.zOrder-u.zOrder).forEach((c,u)=>{const{maxZOrder:h,selectedGroupTag:d}=a();c.zOrder=h+(u+1)*l,d&&!this.selectedGroupTags.includes(d)&&(c.groupTag=d)})}this.refreshDisplaysAttr(o),this.refreshDisplayListZOrder()}return o}importCopyPasteData(e,t){const{createNewGroupTag:i=!0,needRecord:r=!0,autoSelected:s=!0,groupTags:o=[],pasteGroupMap:a={},ignoreUpdateZOrder:l=!1}=t||{};if(Rt(e)&&!wt(e)){const c=Object.keys(this.groupMap);let u=this.addDisplayToContainerByCopyPasteData(e,i,a,o,l);const{validDisplays:h}=zx(u);if(u=h,this.recordOperationLogWithProps(u,void 0,r),s){const d=Object.keys(this.groupMap).filter(f=>!c.includes(f));this.executeSelect(u,d)}return this.getMultiDisplayJSON(u,{texture:!1})}return[]}getSelectedGroupTags(){return this.selectedGroupTags}addGroupMapItem(e){this.groupMap[e]={groupName:"",groupTag:e,visible:!0,enableTransform:!0,zOrder:void 0}}editGroupById(e,t){this.setGroupMapAttributesById(e,t);const r=this.getViewportDisplayObjects().filter(({groupTag:s})=>s===e);this.recordOperationLog(...r)}setGroupMapAttributesById(e,t){const i=(u,h)=>{if(h!==void 0)for(const d in h){const f=h[d];if(typeof f>"u"){console.warn(`GroupMap '${u.groupTag}' setValue: '${d}' parameter is undefined.`);continue}d in u&&(u[d]=f)}},r=this.groupMap[e];r?i(r,t):(this.addGroupMapItem(e),i(this.groupMap[e],t));const o=this.getViewportDisplayObjects().filter(({groupTag:u})=>u===e),{visible:a,enableTransform:l}=t||{},c={};typeof a<"u"&&Object.assign(c,{visible:{value:void 0}}),typeof l<"u"&&Object.assign(c,{lock:{value:void 0}}),this.refreshDisplaysAttr(o,c)}toggleVisibleStateByIds(e,t=!1){const i=this.getViewportDisplayObjects(e);this.toggleVisibleState(i,t)}toggleLockStateByIds(e,t=!1){const i=this.getViewportDisplayObjects(e);this.toggleLockState(i,t)}_getToggleFirstAttribute(e,t,i=!0){let r=!1;return e.some(o=>{const a=o[t];return i?!a:a})&&(r=!0),r}toggleVisibleState(e=this.selected,t=!1){let i=e;t||(i=e.filter(s=>!this.selectedGroupTags.includes(s.groupTag)));let r=this._getToggleFirstAttribute(i,"visibleState");if(!t&&this.selectedGroupTags.length>0)if(r)this.selectedGroupTags.forEach(s=>{this.setGroupMapAttributesById(s,{visible:r})});else{const s=this.selectedGroupTags.map(o=>this.groupMap[o]);r=this._getToggleFirstAttribute(s,"visible"),s.forEach(({groupTag:o})=>{this.setGroupMapAttributesById(o,{visible:r})})}this.refreshVisibleState(i,r),this.executeSelect(e),this.recordOperationLog(...e)}toggleLockState(e=this.selected,t=!1){let i=e;t||(i=e.filter(s=>!this.selectedGroupTags.includes(s.groupTag)));let r=this._getToggleFirstAttribute(i,"lockState");if(!t&&this.selectedGroupTags.length>0)if(r)this.selectedGroupTags.forEach(s=>{this.setGroupMapAttributesById(s,{enableTransform:!r})});else{const s=this.selectedGroupTags.map(o=>this.groupMap[o]);r=this._getToggleFirstAttribute(s,"enableTransform",!1),s.forEach(({groupTag:o})=>{this.setGroupMapAttributesById(o,{enableTransform:!r})})}this.refreshLockState(i,r),this.executeSelect(e),this.recordOperationLog(...e)}refreshVisibleState(e=this.selected,t){this.refreshDisplaysAttr(e,{visible:{value:t}})}refreshLockState(e=this.selected,t){this.refreshDisplaysAttr(e,{lock:{value:t}})}clearGroupMap(){const e=new Set,t=this.getViewportDisplayObjects();t.forEach(({groupTag:i})=>{e.add(i)}),Object.keys(this.groupMap).forEach(i=>{e.has(i)||delete this.groupMap[i]}),this.recordOperationLog(...t)}isEnableTransform(e=this.selected){if(e.length>0){let t=!1;for(let i=0;i<e.length;i++){const r=e[i];let s=!1;if(this.selectedGroupTags.includes(r.groupTag)&&(s=this.groupMap[r.groupTag].enableTransform),r.enableTransform===!0||s===!0){t=!0;break}}return t}return!0}refreshLockStyle(){const e=this.transformer.selected;this.isEnableTransform(e)?this.updateTransformHandleMode(this.transformer.defaultHandleMode):this.updateTransformHandleMode(zp.lock)}toggleSelectedByIds(e=[],t="",i="",r){let s=[];if(i?s=this.selected.filter(o=>{const a=e.indexOf(o.id);return a===-1?!0:(e.splice(a,1),this.selectedGroupTags.indexOf(o.groupTag)!==-1&&t.length===0?!0:typeof r<"u"?r:!1)}):this.selectedGroupTags=[],r===!1){if(t&&["ctrlKey","metaKey"].includes(i)){const o=this.selectedGroupTags.indexOf(t);o!==-1&&this.selectedGroupTags.splice(o,1)}}else{const o=this.getViewportDisplayObjects(e);if(s=s.concat(o),typeof r<"u")t&&this.selectedGroupTags.indexOf(t)===-1&&this.selectedGroupTags.push(t);else if(t){const a=this.selectedGroupTags.indexOf(t);a!==-1?["ctrlKey","metaKey"].includes(i)&&this.selectedGroupTags.splice(a,1):this.selectedGroupTags.push(t)}if(i==="shiftKey"){const a=Math.max(...s.map(h=>h.zOrder)),l=Math.min(...s.map(h=>h.zOrder));s=this.getViewportDisplayObjects().filter(({zOrder:h})=>h<=a&&h>=l);const u={};s.forEach(h=>{const{groupTag:d}=h;d!=null&&d.startsWith("g-")&&(u[d]||(u[d]={obj:h,num:0}),u[d].num++)}),Object.entries(u).forEach(([h,d])=>{const{obj:f,num:p}=d,g=this.findSameGroupElements(f),{zOrder:m}=this.groupMap[h];g.length===p&&m<a&&m>=l&&this.selectedGroupTags.indexOf(h)===-1&&this.selectedGroupTags.push(h)})}}this.selected=Array.from(new Set(s)),this.updateTransformHandleMode(this.isEnableTransform()?this.transformer.defaultHandleMode:zp.lock)}updateDisplaysZOrderAfterZOrder(e,t,i=!1,r=!1,s=0){const o=this.getInteractiveElements(),a=this.getViewportDisplayObjects(e),l={};o.forEach(p=>{const{groupTag:g}=p;g!=null&&g.startsWith("g-")&&(l[g]||(l[g]=0),l[g]++)});const c={};a.forEach(p=>{const{groupTag:g}=p;g!=null&&g.startsWith("g-")&&(c[g]||(c[g]=0),c[g]++)});let u=this.curMaxZOrder,h="";if(t){const p=this.getViewportDisplayObjects([t]);u=p[0].zOrder,h=p[0].groupTag,s||(h.startsWith("g-")&&!i&&(u=o.filter(m=>h===m.groupTag).sort((m,v)=>m.zOrder-v.zOrder)[0].zOrder),u-=1)}const d=Number((1/(a.length+1)).toFixed(2));a.sort((p,g)=>p.zOrder-g.zOrder).forEach(p=>{u+=d,p.zOrder=u,i?p.groupTag.startsWith("g-")&&h!==p.groupTag?p.groupTag=h:p.groupTag.startsWith("g-")&&h===p.groupTag||(p.groupTag=h):p.groupTag.startsWith("g-")&&!this.selectedGroupTags.includes(p.groupTag)&&!r&&(l[p.groupTag]!==c[p.groupTag]||c[p.groupTag]===1)&&(p.groupTag="")}),this.refreshVisibleState(a),this.refreshLockState(a);const f=o.sort((p,g)=>p.zOrder-g.zOrder);f.forEach((p,g)=>{p.zOrder=++g,this.groupMap[p.groupTag]&&(this.groupMap[p.groupTag].zOrder=p.zOrder)}),this.recordOperationLog(...f)}updateAllDisplaysOrder(e=!1){if(!e){const t=o=>{const a=o.filter(({zOrder:c})=>c===0);let l=this.curMaxZOrder;a.forEach(c=>{l++,c.zOrder=l})},i=this.getInteractiveElements(),r=i[i.length-1];if(!r.zOrder)t(i);else{const o=i.find(l=>l.id===r.sourceId),a=()=>{let l=0,c="";return this.selected.length>0&&this.selected.forEach(({groupTag:u,zOrder:h})=>{l<h&&(l=h,u.startsWith("g-")?c=u:c="")}),{maxZOrder:l,selectedGroupTag:c}};if(o){const{maxZOrder:l,selectedGroupTag:c}=a();l?(r.zOrder=l+.1,c&&!this.selectedGroupTags.includes(c)&&(r.groupTag=c)):r.zOrder=this.curMaxZOrder+1}else{const{maxZOrder:l,selectedGroupTag:c}=a();l?(r.zOrder=l+.1,c&&!this.selectedGroupTags.includes(c)&&(r.groupTag=c)):r.zOrder=this.curMaxZOrder+1}}i.sort((o,a)=>o.zOrder-a.zOrder).forEach((o,a)=>{o.zOrder=++a,this.groupMap[o.groupTag]&&(this.groupMap[o.groupTag].zOrder=o.zOrder)})}}changeSelectedLayer(e,t=!0){const i=this.getInteractiveElements(),r=u=>this.selected.some(({id:h})=>h===u.id),s=u=>{u.forEach((h,d)=>{h.zOrder=++d,this.groupMap[h.groupTag]&&(this.groupMap[h.groupTag].zOrder=h.zOrder),console.log(h.name,h.type,h.zOrder)})},o=(u,h)=>{const d=i.indexOf(u),f=i.indexOf(h),p=i.splice(d,1)[0];i.splice(f,0,p)},a=(u,h)=>{let d=0;i.forEach((g,m)=>{if(g.groupTag===u)return m>d&&(d=m),!0});const f=i.indexOf(h),p=i.splice(f,1)[0];i.splice(d,0,p)},l=(u="up")=>{u==="up"?(this.selected.sort((f,p)=>p.zOrder-f.zOrder),i.sort((f,p)=>f.zOrder-p.zOrder)):u==="down"&&(this.selected.sort((f,p)=>f.zOrder-p.zOrder),i.sort((f,p)=>p.zOrder-f.zOrder));const h=(f="up",p,g)=>f==="up"?g.zOrder>p.zOrder:g.zOrder<p.zOrder,d=(f,p)=>{const g=p.groupTag.startsWith("g-")?p.groupTag:"isNotGroup",m=f.groupTag.startsWith("g-")?f.groupTag:"isNotGroup";return h(u,f,p)?m==="isNotGroup"?r(p)&&(this.selectedGroupTags.includes(g)||g==="isNotGroup")?!1:g!=="isNotGroup"?(a(g,f),!0):(o(f,p),!0):r(p)?!1:this.selectedGroupTags.includes(m)?g!=="isNotGroup"?(a(g,f),!0):(o(f,p),!0):m===g?(o(f,p),!0):!1:!1};this.selected.forEach(f=>{for(const p of i)if(d(f,p))break}),u==="down"&&i.reverse(),s(i)};let c=0;switch(e){case kc.DOWN:l("down");break;case kc.END:this.selected.sort((d,f)=>f.zOrder-d.zOrder),i.sort((d,f)=>f.zOrder-d.zOrder);const u=d=>{const f=d.groupTag.startsWith("g-")?d.groupTag:"isNotGroup";if(d.groupTag.startsWith("g-")&&!this.selectedGroupTags.includes(f)){const p=i.filter(g=>g.groupTag===f&&!r(g));if(p.length>0){p.sort((m,v)=>m.zOrder-v.zOrder);const g=p[0];if(g.zOrder<d.zOrder){const m=i.indexOf(d),v=i.indexOf(g),_=i.splice(m,1)[0];i.splice(v+c,0,_),c++}}}else{const p=i.indexOf(d),g=i.splice(p,1)[0];i.push(g)}};this.selected.forEach(d=>{u(d)}),s(i.reverse());break;case kc.TOP:this.selected.sort((d,f)=>d.zOrder-f.zOrder),i.sort((d,f)=>d.zOrder-f.zOrder);const h=d=>{const f=d.groupTag.startsWith("g-")?d.groupTag:"isNotGroup";if(d.groupTag.startsWith("g-")&&!this.selectedGroupTags.includes(f)){const p=i.filter(g=>g.groupTag===f&&!r(g));if(p.length>0){p.sort((m,v)=>v.zOrder-m.zOrder);const g=p[0];if(g.zOrder>d.zOrder){const m=i.indexOf(d),v=i.indexOf(g),_=i.splice(m,1)[0];i.splice(v+c,0,_),c++}}}else{const p=i.indexOf(d),g=i.splice(p,1)[0];i.push(g)}};this.selected.forEach(d=>{h(d)}),s(i);break;case kc.UP:l("up");break;default:console.error(`type ${e} is not found`);break}this.transformer.emit(sr.TRANSFORM_CHANGE,"zOrder"),t&&this.recordOperationLog(...i)}exportCanvasJSONTree(){const t=this.getInteractiveElements().sort((s,o)=>o.zOrder-s.zOrder),i=this.getTreeNodesJson(t);return this.mergeGroups(i)}getTreeNodesJson(e){return e.map(t=>{const{id:i,name:r,groupTag:s,type:o,zOrder:a,enableTransform:l,lockState:c,visible:u,visibleState:h}=t;return{id:i,name:r,groupTag:s,type:o,zOrder:a,enableTransform:l,lockState:c,visible:u,visibleState:h}})}mergeGroups(e){const t={},i=new Set(this.selected.map(o=>o.id));e.forEach(o=>{const a=o.groupTag;o.selected=i.has(o.id),o.name=o.name??"",t[a]||(t[a]=[]),t[a].push(o)});const r=[],s=new Set(this.selectedGroupTags);return Object.entries(t).forEach(([o,a])=>{if(o.startsWith("g-")){this.groupMap[o]||(this.addGroupMapItem(o),this.groupMap[o].zOrder=a[0].zOrder);const{groupName:l,...c}=this.groupMap[o],u=s.has(o),h={groupName:l||"",...c,type:"GROUP",selected:u,children:a};r.push(h)}else{const{name:l,...c}=a[0],u={name:l,...c,children:void 0};r.push(u)}}),r}}var R4;(function(n){n.SELECT_OBJECT="SELECT_OBJECT"})(R4||(R4={}));const aOe={clearSelectedWhenClickBlank:!0,clickBlankClearMaxMovement:4};class lOe extends oc{constructor(){super(...arguments);E(this,"currentPointerOverTargets",[]);E(this,"manualSelect");E(this,"multiKey");E(this,"hitBlankWhenPointerDown",!1);E(this,"pointerDownGlobalPos",null)}setupEvents(){var i,r;this.setupViewportEvent(),this.setupTransformEvent(),this.setupSelectorEvent(),this.setupModeEvent(),this.setupOperationStackEvent(),(i=this.setupMessages)==null||i.call(this);const t=(r=this.canvasOptions.shortcutKeyConfig)==null?void 0:r.multiSelectKey;this.multiKey=OC[t]||OC.Shift}isMultiSelectKeyDown({data:t}){const{originalEvent:i}=t;return i[this.multiKey]}setupViewportEvent(){var g,m,v,_,y,A,w,b,C,I;let t,i=!0;const r=({viewport:x})=>{this.plugins.forEach(T=>{T.onViewportMove&&T.onViewportMove(x)})},s=({viewport:x})=>{const{minScale:T,maxScale:O}=x.plugins.get("clamp-zoom").options;x.scaled>=T&&x.scaled<=O&&(this.plugins.forEach(F=>{F.onViewportScale&&F.onViewportScale(x)}),this.emit(gn.ZOOMED,x.scaled))},o=()=>{const x=this.modeManager.curMode;return x===Vt.SELECT||x===Vt.BITMAP_MASK?this.selector:this.curDisplayObject},a=(x,T)=>{var O,F,G;if((F=(O=document.activeElement)==null?void 0:O.blur)==null||F.call(O),this.pointerDownGlobalPos=x.data.global.clone(),this.hitBlankWhenPointerDown=!1,!Nc(x)){i=!1,(G=this.selector)==null||G.done();return}if(!T){if(i=!0,t=Sy(x),!this.isDragMode){const B=this.modeManager.curMode;(B===Vt.SELECT||B===Vt.BITMAP_MASK)&&this.handleSelectModePointerDown(x),g3[B]&&this.handleEditModePointerDown(x)}this.plugins.forEach(B=>{B.onViewportPointerDown&&B.onViewportPointerDown(x,this.viewport)})}},l=(x,T)=>{var O,F,G,B,R;if(x.isInView&&!T&&Nc(x)){if(this.modeManager.curSubEditModeName===Xi.VECTOR_EDITOR&&this.selected.length>0&&((O=this.selector)==null||O.done()),!this.isDragMode){const P=this.getPointByViewport(x);t?t===Sy(x)&&((G=(F=o())==null?void 0:F.update)==null||G.call(F,P,x)):(R=(B=o())==null?void 0:B.update)==null||R.call(B,P,x);const k=this.modeManager.curMode,L=this.modeManager.curSubEditModeName;if((k===Vt.SELECT||k===Vt.BITMAP_MASK)&&!L&&x.target&&x.target!==x.currentTarget){const{minX:H,minY:U,maxX:$,maxY:j}=this.transformer.worldGroupBounds;if(new Pt(H,U,$-H,j-U).contains(P.x,P.y))this.resetPointerOverTarget();else{const ne=this.getPenetrableElement(x);ne?BTe(x)&&c(ne):this.resetPointerOverTarget()}}else this.resetPointerOverTarget()}this.plugins.forEach(P=>{P.onViewportPointerMove&&P.onViewportPointerMove(x,this.viewport)})}},c=x=>{if(!this.currentPointerOverTargets.includes(x)){const T=this.findSameGroupElements(x);this.resetPointerOverTarget(),this.currentPointerOverTargets.push(...T),this.highlightPointerOverTarget();const O=this.getMultiDisplayJSON(T),F=this.mergeGroups(O);this.emit(gn.DISPLAYS_HOVER_CHANGED,F)}},u=(x,T=!1)=>{var O;this.isDragMode||(T||(O=o())==null||O.end(this.getPointByViewport(x),x),this.transformer.emit("pointerup",x)),this.selector.done()},h=(x,T)=>{if(T)return!1;let O;if(this.pointerDownGlobalPos){const G=this.pointerDownGlobalPos,B=x.data.global.clone();O=Math.sqrt((B.x-G.x)**2+(B.y-G.y)**2)}if(this.hitBlankWhenPointerDown){this.hitBlankWhenPointerDown=!1;const{clearSelectedWhenClickBlank:G,clickBlankClearMaxMovement:B}=aOe;this.isMultiSelectMode&&G&&O<=B&&this.transformer.clear()}if(!jR(x).includes(t))return!1;t=null;const{data:{originalEvent:F}}=x;return x.target&&x.target===x.currentTarget&&F instanceof TouchEvent&&i&&!this.isMultiSelectMode&&(console.log("[ clear, 手势触发取消选中 ] >"),this.transformer.clear()),u(x),!0},d=(x,T)=>{h(x,T)&&(this.plugins.forEach(F=>{F.onViewportPointerUp&&F.onViewportPointerUp(x,this.viewport)}),this.isDragMode||this.modeManager.curMode===Vt.TEXT&&(this.updateEditMode(Vt.SELECT),this.updateSubEditMode(Xi.TEXT_EDIT,{target:null,globalPoint:x.data.global.clone(),type:"create",willRecord:!0,selection:"all"})))},f=(x,T)=>{h(x,T)&&this.plugins.forEach(F=>{F.onViewportPointerupoutside&&F.onViewportPointerupoutside(x,this.viewport)})},p=(x,T)=>{T||(u(x,!0),this.plugins.forEach(O=>{O.onViewportPointerCancel&&O.onViewportPointerCancel(x,this.viewport)}))};(g=this.viewport)==null||g.on("pointerdown",a),(m=this.viewport)==null||m.on("pointermove",l),(v=this.viewport)==null||v.on("pointerup",d),(_=this.viewport)==null||_.on("pointerupoutside",f),(y=this.viewport)==null||y.on("pointercancel",p),(A=this.viewport)==null||A.on("moved",r),(w=this.viewport)==null||w.on("zoomed",s),(b=this.viewport)==null||b.on(Wp.GET_POSITION,x=>{this.emit(Wp.GET_POSITION,x)}),(C=this.viewport)==null||C.on(ji.DOUBLE_CLICK,x=>{x.target===this.viewport&&console.log("[viewport 双击  ] >"),this.plugins.forEach(T=>{T.onViewportDoubleClick&&T.onViewportDoubleClick(x,this.viewport)})}),(I=this.viewport.displayLayer)==null||I.on("childAdded",x=>{const T=ySe(x);this.emit(gn.NEW_DISPLAYS_ADDED,this.getMultiDisplayJSON(T,{texture:!0}))})}resetPointerOverTarget(){this.currentPointerOverTargets.length>0&&this.emit(gn.DISPLAYS_HOVER_CHANGED,[]),this.currentPointerOverTargets.forEach(t=>{t&&t&&t.parent&&t.reset&&t.reset()}),this.currentPointerOverTargets=[]}highlightPointerOverTarget(){this.currentPointerOverTargets.forEach(t=>{t&&mt(t.highlightBound)&&t.highlightBound()})}highlightDisplays(t){const i=this.getViewportDisplayObjects(t);this.currentPointerOverTargets=i,this.highlightPointerOverTarget()}resetHighlightDisplays(){this.resetPointerOverTarget()}emitTransformerCommit(){this.emit(gn.SELECTED_TRANSFORM_COMMIT,{getData:()=>({...this.getSelectedData(),enableRedo:this.canRedo,enableUndo:this.canUndo})})}setupTransformEvent(){var r,s,o,a,l,c,u,h,d,f,p,g;this.transformer.on(sr.SELECT,()=>{if(this.transformer.enableEmit){const m={getData:()=>({...this.getSelectedData(),enableCombine:!!this.selectedPathsClosed,enableRedo:this.canRedo,enableUndo:this.canUndo})};this.emit(gn.SELECT_OBJECT,m)}this.plugins.forEach(m=>{m.onTransformerSelect&&m.onTransformerSelect(this.transformer)})});const t=m=>{this.transformer.enableEmit&&this.emit(gn.SELECT_OBJECT_TRANSFORMERED,{getData:()=>({...this.getSelectedData(),enableRedo:this.canRedo,enableUndo:this.canUndo})},m),this.plugins.forEach(v=>{v.onTransformerChange&&v.onTransformerChange(this.transformer)})};this.transformer.on(sr.TRANSFORM_CHANGE,t),(r=this.transformer)==null||r.on(ji.DOUBLE_CLICK,m=>{var C,I,x,T,O,F,G;if(!this.transformer.enableDBClick||this.modeManager.curMode!==Vt.SELECT)return;if(this.selected[0].type===it.TEXT&&this.selected.length===1){const B=this.selected[0];if(B.enableTransform===!1)return;this.transformer.emit("pointerup",m),FD(B,this.viewport.displayLayer),this.updateEditMode(Vt.SELECT),this.updateSubEditMode(Xi.TEXT_EDIT,{target:B,globalPoint:m.data.global.clone(),willRecord:!0});return}const v=this.selected.length===1&&this.selected[0].type===it.BITMAP,_=this.selected[0].toPathData(),y=_==null?void 0:_.toPathEditData(),A=((C=this.selected)==null?void 0:C.length)===1&&((I=y==null?void 0:y.contours)==null?void 0:I.length)>0,b=this.canvasOptions.vectorEditorConfig.enable&&A;if(!(!v&&!b)){if(v){const B=this.selected[0];if(B.enableTransform===!1)return;(x=this.onSelectedDoubleClick)==null||x.call(this,B),this.curDisplayObject=B,this.curDisplayObject.once(mo.DRAW_DONE,()=>{this.updateEditMode(Vt.SELECT),this.beforeAddDisplayToViewport(B),this.addDisplayToViewport(B),this.recordOperationLog(B)})}if(b){const B=this.selected[0];if(B.enableTransform===!1)return;this.transformer.emit("pointerup",m),this.transformer.clear();const R={display:B.id};this.modeManager.updateSubEditMode(Xi.VECTOR_EDITOR,R),(G=(F=(O=(T=this.canvasOptions)==null?void 0:T.vectorEditorConfig)==null?void 0:O.lifeCycleConfig)==null?void 0:F.onStart)==null||G.call(F)}}}),(s=this.transformer)==null||s.on(ji.PINCH_START,()=>{console.log(ji.PINCH_START)}),(o=this.transformer)==null||o.on(ji.PINCH_CHANGE,(m,v)=>{if(console.log(ji.PINCH_CHANGE,m,v),this.selected.length!==1)return;const _=this.selected[0];_.scale.x+=m,_.scale.y+=m}),(a=this.transformer)==null||a.on(ji.PINCH_END,()=>{console.log(ji.PINCH_END)}),(l=this.transformer)==null||l.on(ji.TWO_FINGER_TAP,()=>{console.log(ji.TWO_FINGER_TAP)}),(c=this.transformer)==null||c.on(ji.LONG_PRESS,()=>{console.log(ji.LONG_PRESS)}),(u=this.transformer)==null||u.on(sr.TRANSFORM_COMMIT,()=>{this.transformer.enableEmit&&(this.recordOperationLog(...this.selected),this.emitTransformerCommit())}),(h=this.transformer)==null||h.on("pointerdown",m=>{this.viewport.emit("pointerdown",m,!0),this.transformer.isPointDown=!0,this.plugins.forEach(v=>{v.onTransformerPointerDown&&v.onTransformerPointerDown(m)})}),(d=this.transformer)==null||d.on("pointermove",m=>{this.viewport.emit("pointermove",m,!0),Nc(m)&&this.transformer.pointerId===Sy(m)&&this.plugins.forEach(v=>{v.onTransformerPointerMove&&v.onTransformerPointerMove(m)})});const i=m=>{if(this.viewport.emit("pointerup",m,!0),jR(m).includes(this.transformer.pointerId)&&this.transformer.isPointDown){if(this.transformer.isPointDown=!1,this.transformer.pointerId=null,!this.manualSelect&&!this.transformer.isTranslateChange&&(this.isMultiSelectMode||this.isMultiSelectKeyDown(m))){const v=this.getPenetrableElement(m);v&&v!==this.transformer&&this.multiSelect(v)}this.manualSelect&&(this.manualSelect=!1),this.plugins.forEach(v=>{v.onTransformerPointerUp&&v.onTransformerPointerUp(m)})}};(f=this.transformer)==null||f.on("pointerup",i),(p=this.transformer)==null||p.on("pointercancel",i),(g=this.transformer)==null||g.on("pointerupoutside",i)}setupOperationStackEvent(){this.operationStack.on(ko.CAN_DO_CHANGE,(t,i)=>{this.emit(ko.CAN_DO_CHANGE,t,i)})}setupSelectorEvent(){this.selector.on(Cy.SELECT_VIEWPORT_ELEMENTS,(t,i,r)=>{t&&i&&this.enableSelectElements?this.selectAreaElements(t,i,this.isMultiSelectMode||this.isMultiSelectKeyDown(r)):(console.log("[ 框选区域取消选择 ] >"),this.executeSelect([]))}),this.selector.on(Cy.SELECTING_VIEWPORT_ELEMENTS,t=>{this.modeManager.selectingElements(t)})}setupModeEvent(){this.modeManager.on(Gc.CHANGE,({mode:t,subMode:i,otherData:r})=>{this.emit(Gc.CHANGE,t,i,r)}),this.modeManager.on(at.MESSAGE_TO_MAIN,t=>{const{eventName:i,data:r}=t;switch(i){case at.MESSAGE_TO_MAIN:this.emit(at.MESSAGE_TO_MAIN,r);break;case at.MESSAGE_TO_PLUGIN:this.emit(at.MESSAGE_TO_PLUGIN,r);break;default:this.emit(at.MESSAGE_TO_MAIN,t)}}),this.modeManager.on(at.MESSAGE_TO_PLUGIN,()=>{})}handleSelectModePointerDown(t){const{data:{originalEvent:i}}=t;if(this.modeManager.curSubEditModeName===Xi.TEXT_EDIT)return;if(!this.modeManager.curSubEditMode){const s=this.selected,{validDisplays:o,invalidDisplays:a}=f9(s);this.selected.length!==o.length&&(this.selected=o,this.removeElements(a,!1,!0))}const r=this.modeManager.curSubEditModeName===Xi.VECTOR_EDITOR&&![it.ANCHOR_POINT,it.CONTROL_POINT].includes(t.target.type);t.target&&t.target!==t.currentTarget&&!this.modeManager.curSubEditMode?this.pierceSelect(t):(t.target&&t.target===t.currentTarget||r)&&(this.hitBlankWhenPointerDown=!0,this.isMultiSelectMode||this.isMultiSelectKeyDown(t)||i instanceof MouseEvent&&this.transformer.clear(),this.selector.start(this.getPointByViewport(t)))}getPenetrableElement(t){let i;"point"in t?i=t.point:i=this.getPointByViewport(t);let r;return"rightClick"in t?r=t.rightClick:r=t.data.button===2,this.getMinAreaElementByPoint(i,!!r)}pierceSelect(t){const i=this.getPenetrableElement(t);i?(this.isMultiSelectMode||this.isMultiSelectKeyDown(t)?(this.multiSelect(i),this.resetPointerOverTarget()):(this.selectSameGroup(i),this.refreshLockStyle(),this.resetPointerOverTarget()),this.selected.length>0&&(this.manualSelect=!0,this.transformer.emit("pointerdown",t))):this.transformer.clear()}multiSelect(t){this.selected=this.invertSelect(t,this.selected)}selectSameGroup(t){const i=this.findSameGroupElements(t),{groupTag:r}=t;r.startsWith("g-")?this.selectedGroupTags=[r]:this.selectedGroupTags=[],this.selected=i}handleEditModePointerDown(t){if(!this.curDisplayObject){const i=this.modeManager.curMode,r=g3[i],s=Us(r);if(s){const{layerTag:o,layerColor:a}=this.configManager.displayConfig;s.parseJSON({layerTag:o,layerColor:a}),this.executeSelect([])}this.curDisplayObject=s,this.curDisplayObject&&(this.curDisplayObject.once(mo.DRAW_BEGIN,o=>{this.tempLayer.addChild(o)}),this.curDisplayObject.on(mo.DRAW_UPDATE,o=>{this.recordOperationLog(o)}),this.curDisplayObject.once(mo.DRAW_DONE,o=>{this.handleDrawDisplayDone(o)}))}if(this.curDisplayObject&&this.curDisplayObject.editing&&t.target&&t.target===t.currentTarget){this.selected=[this.curDisplayObject],this.updateEditMode(Vt.SELECT);return}this.curDisplayObject.start(this.getPointByViewport(t),t)}onDelete(){console.log("[ onDelete ] >")}onEsc(t){var i;this.modeManager.curSubEditMode?(i=this.modeManager.curSubEditMode)==null||i.onEsc(t):(this.clearSelected(),this.modeManager.curMode!==Vt.SELECT&&this.finishCurMode())}onDirection(t){var i;(i=this.modeManager.curSubEditMode)==null||i.onDirection(t)}onEnter(){var t;(t=this.modeManager.curSubEditMode)==null||t.onEnter()}onCopy(){var t,i;return(i=(t=this.modeManager.curSubEditMode)==null?void 0:t.onCopy)==null?void 0:i.call(t)}onCut(){var t,i;return(i=(t=this.modeManager.curSubEditMode)==null?void 0:t.onCut)==null?void 0:i.call(t)}onPaste(t){var i,r;(r=(i=this.modeManager.curSubEditMode)==null?void 0:i.onPaste)==null||r.call(i,t)}}class cOe extends oc{get canUndo(){return this.imageProcess?this.imageProcess.canUndo:this.imageTracing?!1:this.operationStack.canUndo}get canRedo(){return this.imageProcess?this.imageProcess.canRedo:this.imageTracing?!1:this.operationStack.canRedo}undo(){var s,o,a;if((s=this.imageProcess)!=null&&s.canUndo){this.imageProcess.undo();return}if(this.imageTracing||!this.canUndo)return;this.transformer.clear();const e=this.operationStack.top,{curIDs:t,otherData:i}=e;this.operationStack.undo(),this.emit(gn.BEFORE_HISTORY_CHANG,"undo",{otherData:i});let r;if(typeof(e==null?void 0:e.onUndo)=="function")r=(o=e==null?void 0:e.onUndo)==null?void 0:o.call(e,this.operationStack);else{const l=this.operationStack.top??{};l.subMode!==((a=this.modeManager.curSubEditMode)==null?void 0:a.name)&&this.updateSubEditMode(l.subMode,e.data)}(!r||!(r!=null&&r.skipRedraw))&&t&&this.redraw(t,!1),this.emit(gn.HISTORY_CHANG,"undo",{otherData:i})}redo(){var s,o,a;if((s=this.imageProcess)!=null&&s.canRedo){this.imageProcess.redo();return}if(this.imageTracing||!this.canRedo)return;this.transformer.clear(),this.operationStack.redo();const e=this.operationStack.top,{curIDs:t,otherData:i}=e;this.emit(gn.BEFORE_HISTORY_CHANG,"redo",{otherData:i});let r;if(typeof(e==null?void 0:e.onRedo)=="function")r=(o=e==null?void 0:e.onRedo)==null?void 0:o.call(e,this.operationStack);else{const l=this.operationStack.top??{};l.subMode!==((a=this.modeManager.curSubEditMode)==null?void 0:a.name)&&this.updateSubEditMode(l.subMode,e.data)}(!r||!(r!=null&&r.skipRedraw))&&t&&this.redraw(t,!0),this.emit(gn.HISTORY_CHANG,"redo",{otherData:i})}redraw(e,t){const i=this.operationStack.top,r=PDe(this.viewport,this.tempLayer);if(!i){r.forEach(c=>{this.removeElement(c,!1)}),this.updateEditMode(Vt.SELECT),this.curDisplayObject=void 0,this.transformer.emit(sr.TRANSFORM_CHANGE,"all");return}const s=new Set(i.allIDs);r.forEach(c=>{const u=c.id;i.allIDs.has(u)?s.delete(u):(this.removeElement(c,!1),this.updateEditMode(Vt.SELECT))});const o=c=>{var d;if(i.curAttributes.has(c))return i.curAttributes.get(c);const u=this.operationStack.undoStack;for(let f=u.length-1;f>=0;f--){const p=u[f];if((d=p==null?void 0:p.curAttributes)!=null&&d.has(c))return p.curAttributes.get(c)}const h=this.operationStack.initOperation;if(h&&h.curAttributes.has(c))return h.curAttributes.get(c)};(c=>{c.forEach(u=>{var f;const h=r.getKey(u),d=h?[...h]:[];if(d.length===1){const p=d[0];if(p&&!p.destroyed){const g=o(p.id);g&&(delete g.isFill,p.updateData&&p.updateData(g,t),v2(p,g,this.viewport),((f=p.isVaild)==null?void 0:f.call(p))===!1&&this.removeElement(p,!1))}}else d.length>1&&console.error("find redundant elements",u)})})(e),(()=>{const{groupData:c,selectedGroupTags:u,zOrderImage:h}=i;this.zOrderImage=h,this.groupMap=JSON.parse(JSON.stringify(c)),this.selectedGroupTags=[...u],this.getInteractiveElements().sort((f,p)=>f.zOrder-p.zOrder).forEach(f=>{this.zOrderImage&&!isNaN(this.zOrderImage[f.id])&&(f.zOrder=this.zOrderImage[f.id]),this.groupMap[f.groupTag]&&(this.groupMap[f.groupTag].zOrder=f.zOrder)})})(),s.forEach(c=>{const u=o(c);u?(u.isFill=this.elementsFillMap[u.id],this.addDisplayToContainerByJSON([u],!1,!1,void 0,void 0,!0).forEach(d=>{var f;((f=d.isVaild)==null?void 0:f.call(d))===!1&&this.removeElement(d,!1)})):console.log("can not find attributes for",c)}),this.transformer.emit(sr.TRANSFORM_CHANGE,"all")}recordOperationLog(...e){const t=this.createOperationLogOnViewport(e);this.recordFinalOperationLog(t)}recordOperationLogWithProps(e,t,i){const r=this.createOperationLogOnViewport(e);Object.prototype.toString.apply(t)==="[object Object]"&&Object.assign(r,t),this.recordFinalOperationLog(r,i)}recordVectorEditorOperationLog(e){this.recordFinalOperationLog(e)}recordFinalOperationLog(e,t){t=t??!0;const i=this._getModeData();Id(i)&&Ln(e,i);const r=t?this.getOtherData():{},s=this.getInteractiveElements();this.zOrderImage={},s.forEach(a=>{this.zOrderImage[a.id]=a.zOrder});const o={otherData:r,...e,groupData:JSON.parse(JSON.stringify(this.groupMap||{})),selectedGroupTags:[...this.selectedGroupTags||[]],zOrderImage:{...this.zOrderImage}};t?this.operationStack.push(o):this.operationStack.initOperation=o}createOperationLogOnViewport(e){return g7(e,[this.viewport,this.tempLayer],this.viewport,{texture:!0})}_getModeData(){var e;return{mode:this.modeManager.curMode,subMode:(e=this.modeManager.curSubEditMode)==null?void 0:e.name}}}class D4{constructor(e){E(this,"name","ImageProcessPlugin");E(this,"imageProcess");E(this,"type",cb);this.imageProcess=e}init(){}onViewportPointerDown(e){this.imageProcess.wrapEventHandler(this.imageProcess.onPointerDown)(e)}onViewportPointerMove(e){this.imageProcess.onPointerMove(e)}onViewportPointerUp(e){this.imageProcess.wrapEventHandler(this.imageProcess.onPointerUp)(e)}onViewportPointerupoutside(e){this.imageProcess.wrapEventHandler(this.imageProcess.onPointerUp)(e)}}class uOe extends oc{constructor(){super(...arguments);E(this,"preViewportPosition",null);E(this,"imageProcessPlugin")}closeImageTracing(t){var r;let i=null;(!t||t.length===0)&&this.imageTracing&&(i=this.imageTracing.getOriginalDisplay()),this.toggleTransformer(!0),(r=this.imageTracing)==null||r.destroyAll(),this.imageTracing=null,this.emit(ko.CAN_DO_CHANGE,this.canUndo,this.canRedo),this.centralAxis&&(this.centralAxis.mask.visible=!0,this.centralAxis.axis.visible=!0),i&&i.interactive&&(this.transformer.selected=[i]),this.resetViewportPosition()}closeImageProcess(t){var i,r,s;this.imageProcess&&(!t&&this.imageProcess&&(t=this.imageProcess.getOriginalDisplay()),this.toggleTransformer(!0),(i=this.imageProcess)==null||i.destroyAll(),this.imageProcess=null,this.emit(ko.CAN_DO_CHANGE,this.canUndo,this.canRedo),this.centralAxis&&(this.centralAxis.mask.visible=!0,this.centralAxis.axis.visible=!0),t&&t.interactive&&(this.transformer.selected=[t]),(s=(r=this.configManager.imageProcessConfig.lifecycle)==null?void 0:r.onClose)==null||s.call(r),this.resetViewportPosition(),this.imageProcessPlugin&&(this.unRegisterPlugin(this.imageProcessPlugin),this.imageProcessPlugin=null),this.clearStageBg())}setViewportCenter(){this.preViewportPosition=this.viewport.position.clone(),this.viewport.alignment(bu.CENTER,wu.CENTER)}resetViewportPosition(){if(this.preViewportPosition){const{x:t,y:i}=this.preViewportPosition;this.viewport.updatePosition(t,i),this.preViewportPosition=null}}updateImageProcessTool(t,i){var r;t===rh.CUTTER?this.viewport.toWheelMode(!1,!1):this.viewport.toWheelMode(),(r=this.imageProcess)==null||r.updateTool(t,i)}saveImageProcess(t=!0,i){var l,c,u,h,d;if(!this.imageProcess)return;if(this.imageProcess.locking)throw Error("failed to save imageProcess when it is locking");const{autoSelected:r=!0,autoDestroyOriginal:s}=i;this.toggleTransformer(!0);const o=(l=this.imageProcess)==null?void 0:l.getResult(),a=(c=this.imageProcess)==null?void 0:c.enableDestroyOriginalDisplay();return s&&a&&this.removeElements([(u=this.imageProcess)==null?void 0:u.getOriginalDisplay()],!1,!0),o?(this.beforeAddDisplayToViewport(o),this.addDisplayToViewport(o,r,!0),t&&this.recordOperationLog(o)):t&&this.recordOperationLog(),(d=(h=this.configManager.imageProcessConfig.lifecycle)==null?void 0:h.onSave)==null||d.call(h),this.closeImageProcess(o),{display:o,canDestoryOriginal:a}}toggleTransformer(t){this.viewport.displayLayerVisible=t,this.transformer.enableEmit=t,this.transformer.rotateEnabled=t,this.transformer.toggleEnableClearSelected(t),this.transformer.toggleEnableDBClick(t),this.selector.toggleActive(t)}processImage(t,i=!0){var o,a;let r=this.selected[0];if(t&&(r=this.viewport.backgroundSprite),!r)return;if(this.finishCurMode(),this.transformer.selected=[],!this.imageProcess){(a=(o=this.configManager.imageProcessConfig.lifecycle)==null?void 0:o.onOpen)==null||a.call(o);const l=this.cloneImageProcessDisplay(r),c=mp(r,this.viewport),u={x:c.minX,y:c.minY,width:c.maxX-c.minX,height:c.maxY-c.minY},h=(g,m)=>{_d(g,m,this.viewport)},d=g=>{this.viewport.addChild(g)},f=(g,m)=>{this.app.stage.addChildAt(g,m??this.app.stage.children.length)},p=g=>{this.selected=g};this.toggleTransformer(!1),this.imageProcess=new I4({viewportScreenWidth:this.viewport.screenWidth,viewportScreenHeight:this.viewport.screenHeight,viewportWorldWidth:this.viewport.worldWidth,viewportWorldHeight:this.viewport.worldHeight,viewportHeight:this.viewport.height,viewportWidth:this.viewport.width,viewportPosition:this.viewport.position,viewportScale:this.viewport.scale,display:r,newDisplay:l,finalPosition:u,isBackground:t,setDisplayPosition:h,addViewportChild:d,addStageChild:f,selectDisplay:p,imageProcessConfig:this.configManager.imageProcessConfig}),this.setUpImageProcessOperationStackEvent(),this.emit(ko.CAN_DO_CHANGE,this.imageProcess.canUndo,this.imageProcess.canRedo)}const s=new D4(this.imageProcess);this.imageProcessPlugin=s,this.registerPlugin(s),this.emit(gn.UPDATE_IMAGE_PROCESS_VISIBLE,!0),this.centralAxis&&(this.centralAxis.mask.visible=!1,this.centralAxis.axis.visible=!1),i&&this.setViewportCenter()}setImageTracingMode(t=!0){const i=this.selected[0];if(i){if(this.finishCurMode(),!this.imageTracing){const r=(l,c)=>{_d(l,c,this.viewport)},s=l=>{this.viewport.addChild(l)},o=l=>{this.selected=l},a=l=>{this.updateStageBg(l)};this.imageTracing=new gke({mountMode:"stage",onStageResize:this.onStageResize,viewportScreenWidth:this.viewport.screenWidth,viewportScreenHeight:this.viewport.screenHeight,viewportWorldWidth:this.viewport.worldWidth,viewportWorldHeight:this.viewport.worldHeight,viewportPosition:this.viewport.position,viewportScale:this.viewport.scale,display:i,moldDisplay:this.cloneImageTracingDisplay(i),setDisplayPosition:r,addViewportChild:s,setStageBg:a,selectDisplay:o,displayConfig:this.configManager.displayConfig,imageProcessConfig:this.configManager.imageProcessConfig})}t&&this.setViewportCenter(),this.emit(gn.UPDATE_IMAGE_TRACING_VISIBLE,!0),this.transformer.selected=[],this.toggleTransformer(!1),this.centralAxis&&(this.centralAxis.mask.visible=!1,this.centralAxis.axis.visible=!1)}}getTracingDisplayImageData(){const t=this.imageTracing.originDisplay,i=this.copySpriteDisplayStyle(t),{imageData:r,imageDataScale:s}=this.getDisplayRenderData(i);return this.imageTracing&&(this.imageTracing.imageDataScale=s),r}addPathToContainer(t,i,r){return this.imageTracing?this.imageTracing.addPathToContainer(t,i,r):null}clearTracingPath(){this.imageTracing&&this.imageTracing.removeTraceDisplay()}getTraceDisplay(){var t;return(t=this.imageTracing)==null?void 0:t.traceDisplays.map(i=>({...i.toJSON(this.viewport),points:i.geometry.points}))}getTracingOriginDisplay(){return this.imageTracing.originDisplay.toJSON(this.viewport,{})}saveImageTracing(){var i;this.toggleTransformer(!0);const t=(i=this.imageTracing)==null?void 0:i.getTraceDisplay();return console.time("add display"),t.forEach(r=>{r&&(r.parseJSON({layerColor:r.layerTag}),this.beforeAddDisplayToViewport(r),this.addDisplayToViewport(r))}),this.createGroup(t),this.closeImageTracing(t),console.timeEnd("add display"),t.map(({id:r,originColor:s})=>({id:r,originColor:s}))}cloneImageProcessDisplay(t){const i=t.cloneWithoutCompress(this.viewport),s=mp(t,this.viewport).getRectangle(),o=t.resourceScale;i.scale.x*=o.x,i.scale.y*=o.y;const{imageData:a}=this.getDisplayRenderData(i),l=document.createElement("canvas");l.width=a.width,l.height=a.height,l.getContext("2d").putImageData(a,0,0);const c=new Fi(l);return c.width=s.width,c.height=s.height,c.interactive=!1,c}copySpriteDisplayStyle(t){const i=Fi.from(t.texture.clone());UD(i,t.exportMaskJSON(this.viewport));const{grayValue:r,sharpness:s,colorInverted:o,filterList:a,filters:l}=t;return i.parseJSON({grayValue:r,sharpness:s,colorInverted:o,filterList:a}),i.filters=l,i}cloneImageTracingDisplay(t){const i=(s,o)=>{const a=new Dt;a.prepend(o.localTransform),s.transform.setFromMatrix(a)},r=this.copySpriteDisplayStyle(t);return i(r,t),r.width=t.width,r.height=t.height,r.transform.updateLocalTransform(),r.interactive=!1,r}setUpImageProcessOperationStackEvent(){this.imageProcess.operationStack.on(ko.CAN_DO_CHANGE,(t,i)=>{this.emit(ko.CAN_DO_CHANGE,t,i)})}cancelImageProcessTool(){var t;(t=this.imageProcess)==null||t.cancel(),this.imageProcessPlugin&&this.unRegisterPlugin(this.imageProcessPlugin)}confirmImageProcessTool(){var t;(t=this.imageProcess)==null||t.confirm(),this.imageProcessPlugin&&this.unRegisterPlugin(this.imageProcessPlugin)}processImageInToolCanvas(t=!0,i,r,s){var o,a;if(this.finishCurMode(),this.transformer.selected=[],!this.imageProcess){(a=(o=this.configManager.imageProcessConfig.lifecycle)==null?void 0:o.onOpen)==null||a.call(o);const l=(g,m)=>{_d(g,m,this.viewport)},c=g=>{this.viewport.addChild(g)},u=(g,m)=>{this.app.stage.addChildAt(g,m??this.app.stage.children.length)},h=g=>{this.updateStageBg(g)},d=g=>{this.selected=g},f=g=>{this.viewport.updateCursor(g)};this.toggleTransformer(!1),this.imageProcess=new I4({mountMode:"stage",onStageResize:this.onStageResize,viewportScreenWidth:this.viewport.screenWidth,viewportScreenHeight:this.viewport.screenHeight,viewportWorldWidth:this.viewport.worldWidth,viewportWorldHeight:this.viewport.worldHeight,viewportHeight:this.viewport.height,viewportWidth:this.viewport.width,viewportPosition:this.viewport.position,viewportScale:this.viewport.scale,display:i,newDisplay:r,finalPosition:s,isBackground:!1,setDisplayPosition:l,addViewportChild:c,addStageChild:u,setStageBg:h,selectDisplay:d,imageProcessConfig:this.configManager.imageProcessConfig,updateCursor:f});const p=new D4(this.imageProcess);this.imageProcessPlugin=p,this.registerPlugin(p),this.setUpImageProcessOperationStackEvent(),this.emit(ko.CAN_DO_CHANGE,this.imageProcess.canUndo,this.imageProcess.canRedo)}this.emit(gn.UPDATE_IMAGE_PROCESS_VISIBLE,!0),this.centralAxis&&(this.centralAxis.mask.visible=!1,this.centralAxis.axis.visible=!1),t&&this.setViewportCenter(),globalThis.__PIXI_APP__=this.app}async prepareSelectedForToolCanvas(t){var o;const i=this==null?void 0:this.exportSelectedJSON({texture:!0}),r=this==null?void 0:this.getDisplaysBounds("selected");console.log("displaysBounds",r);const s=i[0];if(s)return await hSe(s.base64),t.importDisplayJSON(i),(o=t.updateViewportConfig)==null||o.call(t,{gridVisible:!1,backdropVisible:!1}),{bitmapJSON:s,displaysBounds:r}}async processImageNew(t,i,r=!0){var c,u;if(t.imageProcess)return;let s=this.selected[0];if(i&&(s=this.viewport.backgroundSprite),!s)return;(u=(c=this.configManager.imageProcessConfig.lifecycle)==null?void 0:c.onOpen)==null||u.call(c);const o=this.cloneImageProcessDisplay(s),a=mp(s,this.viewport),l={x:a.minX,y:a.minY,width:a.maxX-a.minX,height:a.maxY-a.minY};t.updateViewportConfig({worldWidth:a.maxX-a.minX,worldHeight:a.maxY-a.minY,gridVisible:!1,backdropVisible:!1}),t.processImageInToolCanvas(r,s,o,l)}saveImageProcessNew(t,i=!0,r=!0){var c,u,h,d;if(!t)return;if(t.imageProcess.locking)throw Error("failed to save imageProcess when it is locking");const s=(u=(c=t.imageProcess)==null?void 0:c.getOriginalDisplay)==null?void 0:u.call(c),o=t.saveImageProcess(!1,{autoDestroyOriginal:!1});if(!o)return;const{display:a,canDestoryOriginal:l}=o;a&&(s&&l&&this.removeElements([s],!1,!0),this.beforeAddDisplayToViewport(a),this.addDisplayToViewport(a,r,!0),i&&this.recordOperationLog(a)),(d=(h=this.configManager.imageProcessConfig.lifecycle)==null?void 0:h.onSave)==null||d.call(h),this.closeImageProcessNew(t)}closeImageProcessNew(t){var i,r;t&&(t.closeImageProcess(),t.selected=[],t.updateTransformHandleMode(_R.custom),(r=(i=this.configManager.imageProcessConfig.lifecycle)==null?void 0:i.onClose)==null||r.call(i),t.imageProcessPlugin&&t.unRegisterPlugin(t.imageProcessPlugin))}confirmImageTracing(){var i;this.toggleTransformer(!0);const t=(i=this.imageTracing)==null?void 0:i.getTraceDisplay();return console.time("add display"),t.forEach(r=>{r&&(r.parseJSON({layerColor:r.layerTag}),this.beforeAddDisplayToViewport(r),this.addDisplayToViewport(r,!1,!0))}),this.closeImageTracing(t),console.timeEnd("add display"),t}}class hOe extends oc{importDisplayJSON(e,t){const{createNewID:i=!1,createNewGroupTag:r=!0,needRecord:s=!0,autoSelected:o=!0,groupTags:a=[],ignoreUpdateZOrder:l=!1}=t||{};if(Rt(e)&&!wt(e)){const c=Object.keys(this.groupMap);let u=this.addDisplayToContainerByJSON(e,i,r,void 0,a,l);const{validDisplays:h}=zx(u);if(u=h,s&&this.recordOperationLogWithProps(u,void 0,s),o){const d=Object.keys(this.groupMap).filter(f=>!c.includes(f));this.executeSelect(u,d)}return this.getMultiDisplayJSON(u,{texture:!1})}return[]}updateInitLog(){const e=this.getInteractiveElements();this.recordOperationLogWithProps(e,void 0,!1)}exportCanvasJSON(e={texture:!0}){const i=this.getInteractiveElements().sort((r,s)=>s.zOrder-r.zOrder);return this.getMultiDisplayJSON(i,e)}getDisplayLayerBounds(){return this.viewport.displayLayer.getLocalBounds()}getDisplaysBounds(e){const t=this.getViewportDisplayObjects(e),i=Xr.calculateGroupOrientedBounds(t,0),r=new oi,s=this.viewport.displayLayer.toLocal(i.topLeft),o=this.viewport.displayLayer.toLocal(i.bottomRight);return r.minX=s.x,r.minY=s.y,r.maxX=o.x,r.maxY=o.y,r.getRectangle()}async getSelectedShot(e){const t=u1(this.selected,e);return await this.getDisplaysShot(t,this.transformer.worldGroupBounds.getRectangle(),e==null?void 0:e.scaleNum)}async getAllDisplaysShot(e){const t=u1(this.viewport.getInteractiveElements(),e);return await this.getDisplaysShot(t,this.getDisplayLayerBounds(),e==null?void 0:e.scaleNum)}async getSpecifiedDisplaysShot(e){return await this.getDisplaysShot(e.targetDisplays,this.getDisplaysBounds(e.targetDisplays),e.scaleNum)}async getSpecifiedDisplaysShotById(e){const i=this.viewport.getInteractiveElements().filter(p=>e.displayIds.includes(p.id)),r=this.getDisplaysBounds(i),{x:s,y:o}=r;if(i.length===0)return null;let a=e!=null&&e.scaleNum?e==null?void 0:e.scaleNum:zS;a=_w({srcWidth:r.width,srcHeight:r.height,scaleNum:a,maxWidth:this.contextInfo.bitmapMaxSize,maxHeight:this.contextInfo.bitmapMaxSize});const l=[];for(let p=0;p<i.length;p++){const g=i[p];let m;if(g instanceof Fi)m=g.cloneWithoutCompress(this.viewport),m.scale.x=g.scale.x,m.scale.y=g.scale.y;else{const v=g.toJSON(this.viewport);v.x=v.offsetX,v.y=v.offsetY,gi(e.tintColor)||(v.layerColor=e.tintColor),m=Us(v.type,v)}l.push(m)}const c=new mn;c.addChild(...l);const{width:u,height:h}=c.getLocalBounds(),{imageData:d}=this.getDisplayRenderData(c,a,1);return c.destroy({children:!0}),{canvas:xH(d),width:u,height:h,oWidth:d.width,oHeight:d.height,x:s,y:o}}async getDisplayLayerShot(e){var o,a;const{include:t,exclude:i,onlyViewportArea:r}=e||{};let{scaleNum:s=zS}=e||{};if(i||t){const l=this.viewport.getInteractiveElements(),c=u1(l,e),u=this.getDisplaysBounds(l),h=await this.getDisplaysShot(c,u,s),{canvas:d,...f}=h;return{url:eD(d),...f}}else{const l=this.viewport.displayLayer,c=this.getDisplayLayerBounds(),{x:u,y:h}=c;s=_w({srcWidth:c.width,srcHeight:c.height,scaleNum:s,maxWidth:((o=this.contextInfo)==null?void 0:o.bitmapMaxSize)||4096,maxHeight:((a=this.contextInfo)==null?void 0:a.bitmapMaxSize)||4096}),console.log("[ 缩略图最终放大尺寸 ] >",s);const{imageData:d}=this.getDisplayRenderData(l,s,1);let f={};return r&&(f={offset:{x:u*s,y:h*s},canvasSize:{width:this.viewport.worldWidth*s,height:this.viewport.worldHeight*s}}),{canvas:xH(d,f),scaleNum:s}}}async getDisplaysShot(e,t,i){const{x:r,y:s,width:o,height:a}=t;i=i||zS,i=_w({srcWidth:t.width,srcHeight:t.height,scaleNum:i,maxWidth:this.contextInfo.bitmapMaxSize,maxHeight:this.contextInfo.bitmapMaxSize});const l=document.createElement("canvas");l.width=Math.round(Number((o*i).toFixed(3))),l.height=Math.round(Number((a*i).toFixed(3)));const c=l.getContext("2d");for(let u=0;u<e.length;u++){const h=e[u];let d;if(h instanceof Fi)d=h.cloneWithoutCompress(this.viewport),d.scale.x=h.scale.x*i,d.scale.y=h.scale.y*i;else{const v=h.toJSON(this.viewport);d=Us(v.type,v),d.scale.x*=i,d.scale.y*=i}const{imageData:f}=this.getDisplayRenderData(d),{minX:p,minY:g}=mp(e[u],this.viewport),m=await createImageBitmap(f);d.destroy(),c.drawImage(m,(p-r)*i,(g-s)*i)}return window.canvas_debug.previewImage&&JY(l),{canvas:l,width:o,height:a,oWidth:l.width,oHeight:l.height}}async getCanvasData(e=Zxe){console.time("getCanvasData"),this.finishCurMode();const{imageData:t=!0,path:i=!0,excludeOutSide:r=!0,outSideRange:s,exportVectorPathWhenFill:o=!1,ids:a,excludeIds:l,clearSelected:c=!0}=e;let u=this.viewport.getInteractiveElements({excludeOutSide:r,outSideRange:s,ids:a,excludeIds:l});c&&this.transformer.clear();const{validDisplays:h}=zx(u);u=h;const d=[];for(let f=0;f<u.length;f++){const p=u[f],g=p.toJSON(this.viewport),m=Yp([p],this.viewport);let v=m;p.getRealBounds&&(v=p.getRealBounds(),v=YY(this.viewport,v));const{minX:_,minY:y,maxX:A,maxY:w}=v;let b={};const C=()=>g.type===it.BITMAP||g.isFill&&p.enableFill,I=()=>!(g.type===it.BITMAP)&&g.isFill&&o;if(C()){if(t&&(b=await this.configDisplayBitMap(e,p,v,m),I())){const x=await this.configDisplayDPath(e,p);b={...b,...x}}}else i&&(b=await this.configDisplayDPath(e,p));d.push({...g,...b,x:_,y,width:A-_,height:w-y})}return window.canvas_debug.logGetCanvasData&&console.log("[Canvas-getCanvasData]",d),console.timeEnd("getCanvasData"),d}async configDisplayBitMap(e,t,i,r){let s=t;const{minX:o,minY:a,maxX:l,maxY:c}=i;let u=null;if(t.type===it.BITMAP)s=t.cloneWithoutCompress(this.viewport);else{const g=t.toJSON(this.viewport);s=Us(g.type,g);let m=e.vectorScaleNum;(l-o)*(c-a)<100*100?m=30:m=10,m=_w({srcWidth:l-o,srcHeight:c-a,scaleNum:m,maxWidth:this.contextInfo.bitmapMaxSize,maxHeight:this.contextInfo.bitmapMaxSize}),s.scale.x*=m,s.scale.y*=m,u=(()=>{const _=i.minX-r.minX,y=i.minY-r.minY,A=i.maxX-i.minX,w=i.maxY-i.minY;return new Pt(_*m,y*m,A*m,w*m)})()}const{imageData:h}=this.getDisplayRenderData(s,1,0,u);s.destroy();const{data:d,width:f,height:p}=h;if(e.dataImageExport){const g=await e.dataImageExport(d);return{oWidth:f,oHeight:p,extraPath:g}}return{imgData:d,oWidth:f,oHeight:p}}async configDisplayDPath(e,t){const i=gSe(t,this.viewport);return e.dataPathExport?{extraPath:await e.dataPathExport(i)}:{path:i}}async loadResToViewport(e,t,i){var h;this.finishCurMode(),console.time("loadResToViewport");const{result:r,lossFonts:s}=await PRe(e,t);if(!r)throw new Error("load res error, loader name: ${loaderName}.");const{width:o,height:a}=t;let l=[r];const c=_2(r,this._getFilterFn(r));if(l=zx(c).validDisplays,l.length>0){typeof(i==null?void 0:i.beforePlace)=="function"&&await((h=i==null?void 0:i.beforePlace)==null?void 0:h.call(i,{lossFonts:s})),this.beforeAddDisplayToViewport(l,[{action:f=>{i!=null&&i.resourceOrigin&&f.parseJSON({resourceOrigin:i.resourceOrigin})}}]),this.addDisplayToViewport(r,!1);let d=[];l.length>1&&(d=[this.createGroupByZOrder(l)]),this.executeSelect(l,d),this.placeSelectedToViewport({width:o,height:a,...i})}else this.selected=[];return console.timeEnd("loadResToViewport"),this.getMultiDisplayJSON(l,{texture:!1})}placeSelectedToViewport(e){const t=this.transformer.worldGroupBounds.getRectangle();let{width:i,height:r}=e;const{needRecord:s=!0}=e,{fitToViewPort:o=!1,fitViewportRatio:a=1}=e;e.fitSize&&({width:i,height:r}=GC({width:i,height:r},e.fitSize)),!i&&!r?(i=t.width,r=t.height):i?r||(r=i/t.width*t.height):i=r/t.height*t.width,o&&({width:i,height:r}=cI(i,r,this.viewport.worldWidth*a,this.viewport.worldHeight*a)),(i!==t.width||r!==t.height)&&this.transformer.updateGroupSize(i,null,!0);const{offsetX:l=0,offsetY:c=0}=e;let u=l,h=c;tn(l)||(u=UC(l,this.viewport.worldWidth,i)),tn(c)||(h=UC(c,this.viewport.worldHeight,r)),this.transformer.updateGroupPosition(u,h),s&&this.transformer.emit(sr.TRANSFORM_COMMIT),this.transformer.emit(sr.SELECT)}addTextToViewport(e,t){this.finishCurMode();const i=s=>{s.parseJSON(t)},r=Us(it.TEXT);this.beforeAddDisplayToViewport(r,[{action:i}]),this.addDisplayToViewport(r,!0),this.placeSelectedToViewport(e)}exportSVG(e){this.finishCurMode();const t=Ln(pn(lCe),{getDataOptions:{relativeObj:this.viewport}},e),i=this.getViewportDisplayObjects(t.objs);t!=null&&t.sortByZOrder&&i.sort((f,p)=>f.zOrder-p.zOrder);const r={};let s="";for(const f of i)try{s+=(f==null?void 0:f.toSVG(t.getDataOptions))??"",r[f.type]=(r[f.type]??0)+1}catch(p){console.error(p)}const o=f=>isFinite(f)?hM(f,1):0,a=this.getDisplaysBounds(i),l=o(a.width),c=o(a.height),u=o(a.x),h=o(a.y);return{data:mH({content:s,contentWidth:l,contentHeight:c,viewBox:[u,h,l,c]},t==null?void 0:t.template),objTypeCounts:r,preview(){return vH(this.data)}}}testBatchToPathData(e,t=!0){const i=this.viewport,r=f=>isFinite(f)?hM(f,1):0,s=this.getDisplaysBounds(e),o=r(s.width),a=r(s.height),l=r(s.x),c=r(s.y),u=[],h=e.map(f=>{const p=f.toPathData();if(t){const m=sh(f.worldTransform.clone(),i.worldTransform.clone());p.transform(m)}const g={tag:"path",attrs:{d:p.toString(),fill:"none",stroke:"#000000",...t?{}:KY(f,{relativeObj:i})}};return u.push(TA(g)),p});return{data:mH({content:u.join(""),contentWidth:o,contentHeight:a,viewBox:[l,c,o,a]}),pathDataList:h,preview(){return vH(this.data)}}}_getFilterFn(e){return{[it.BITMAP]:()=>!0}[e.type]}}const hu={enabled:!0,enabledDoubleClickInteraction:!1,bitmapBgLineStyle:{width:1,color:33143,native:!0},bitmapBgFillStyle:{color:16777215,alpha:1},bitmapAlpha:.3,displayLayerAlpha:.05};class dOe extends oc{constructor(){super(...arguments);E(this,"bitmapMaskEditing")}selectedBuildAndStartEditMaskAction(){const[t,i]=this.selectedPickBitmapMaskEditTarget();this.startMaskEditMode(t,i,"create",{willRecord:!0})}selectedStartEditMaskAction(){if(this.canModifyBitmapMask()){const t=this.selected[0];this.startMaskEditMode(t,Ul(t),"update",{willRecord:!0})}}selectedReleaseMaskAction(){if(this.canModifyBitmapMask()){const t=this.selected[0];this.releaseMask(t,!0),this.selected=[]}}endEditMaskAction(){this.endMaskEditMode(!0,!0)}initEventForMask(){var t;hu.enabledDoubleClickInteraction&&((t=this.viewport)==null||t.on(ji.DOUBLE_CLICK,()=>{this.bitmapMaskEditing&&this.endEditMaskAction()}))}onSelectedDoubleClick(t){hu.enabledDoubleClickInteraction&&this.startMaskEditMode(t,Ul(t),"update",{willRecord:!0})}selectedPickBitmapMaskEditTarget(){const t=this.selected,i=()=>console.error("not valid input objs");if(t.length!==2)return i(),[];let r,s;for(const o of t)o instanceof Fi&&!o.mask?s=o:!(o instanceof Fi)&&!o.isMask&&(r=o);return!r||!s?(i(),[]):[s,r]}buildMaskThenStartEdit(t,i,r=!1,s){this.buildMask(i,t),this.startMaskEditMode(t,i,"create",{willRecord:r,helperRecord:s})}endEditThenReleaseMask(t,i=!1){this.endMaskEditMode(i),this.releaseMask(t,!1)}buildMask(t,i){var s;i.mask&&i.mask!==t&&_m(i),FD(t,this.viewport.displayLayer),t.parentGroup=null,t.interactive=!1,t.visible=!0;const r=sh(t.worldTransform.clone(),i.worldTransform.clone());return t.transform.setFromMatrix(t.transform.localTransform.copyFrom(r)),(s=t.transformCommit)==null||s.call(t),BD(i,t),i.addChild(t),i.updateMaskedCache(),i}releaseMask(t,i=!1,r=!1){var a;if(!t.mask)return[];const s=Ul(t);if(!s)return[];const o=s.localTransform.clone().prepend(t.localTransform);return s.transform.setFromMatrix(s.transform.localTransform.copyFrom(o)),(a=s.transformCommit)==null||a.call(s),_m(t),t.updateMaskedCache(),r||(t.groupTag.startsWith("g-")?s.groupTag=t.groupTag:s.groupTag="",s.zOrder=t.zOrder),this.refreshDisplaysAttr([s]),this.beforeAddDisplayToViewport(s),this.addDisplayToViewport(s,!1,!1),i&&this.recordReleaseMask(t,s),[t,s]}startMaskEditMode(t,i,r,s){if(!t||!i||!hu.enabled)return;const{willRecord:o=!1,helperRecord:a}=s??{};this.updateEditMode(Vt.BITMAP_MASK),this.prepareMaskEdit(t,i,r,a),o&&(r==="create"?this.recordBuildAndStartEditMask(t,i,this.bitmapMaskEditing.helperRecord,this.bitmapMaskEditing.helpers):this.recordStartEditMask(t,i,this.bitmapMaskEditing.helperRecord,this.bitmapMaskEditing.helpers))}endMaskEditMode(t=!1,i=!1){let r;if(this.bitmapMaskEditing){const{bitmap:s,mask:o,clearHelpers:a,cachedTargetJSON:l,cachedMaskJSON:c}=this.bitmapMaskEditing;if(r=s,a==null||a(),s.groupTag=l.groupTag,s.zOrder=l.zOrder,s.visible=l.visible,o.groupTag=c.groupTag,o.zOrder=c.zOrder,o.visible=c.visible,this.buildMask(o,s),RA(this.viewport.displayLayer,s)||(this.beforeAddDisplayToViewport(s),this.addDisplayToViewport(s,!1,!0)),s.isMaskOverlap)t&&(this.bitmapMaskEditing.helperRecord,this.recordEndEditMask(s,this.bitmapMaskEditing.helperRecord));else{const u=this.bitmapMaskEditing.type==="create";this.releaseMask(s,!1,u),t&&this.recordEndEditAndReleaseMask(s,o,this.bitmapMaskEditing.helperRecord)}this.bitmapMaskEditing=null}this.viewport.displayLayer.interactiveChildren=!0,this.viewport.displayLayer.alpha=1,r&&i?this.executeSelect([r]):this.transformer.selected=[],this.textCurve.visible=!0,this.updateEditMode(Vt.SELECT)}prepareMaskEdit(t,i,r,s){if(this.bitmapMaskEditing)try{this.endMaskEditMode()}catch(h){console.error(h)}if(this.viewport.displayLayer.interactiveChildren=!1,this.viewport.displayLayer.alpha=hu.displayLayerAlpha,this.transformer.selected=[],this.textCurve.visible=!1,!RA(t,i))FD(i,this.viewport.displayLayer);else{this.tempLayer.addChild(t),gMe(t,[t,i]);const h=i.localTransform.clone().prepend(t.localTransform);i.transform.setFromMatrix(i.localTransform.copyFrom(h))}const o={groupTag:t.groupTag,zOrder:t.zOrder,visible:t.visible},a={groupTag:i.groupTag,zOrder:i.zOrder,visible:i.visible};t.groupTag="",t.zOrder=0,t.visible=!0,i.groupTag="",i.zOrder=1,i.visible=!0,t.parentGroup=null,i.parentGroup=null,i.interactive=!0;const{helpers:l,clear:c,helperRecord:u}=this.createMaskEditHelpers(t,i,s);this.bitmapMaskEditing={type:r,bitmap:t,mask:i,cachedTargetJSON:o,cachedMaskJSON:a,helpers:l,helperRecord:u,clearHelpers(){c()},selectionTargets:[t,i,...l]}}createMaskEditHelpers(t,i,r){const s=this.createBitmapHelpers(t),o=this.createMaskHelpers(i),[a,l]=s,[c]=o;if(t.mask&&_m(t),t.alpha=hu.bitmapAlpha,t.interactive=!0,i.interactive=!0,BD(a,i),[l,t,a,i,c].forEach((d,f)=>{this.tempLayer.addChildAt(d,f)}),!r)this.createGroupByZOrder([t,a,l]),this.createGroupByZOrder([i,c]),r={helperIDs:{bitmapShadow:a.id,bitmapBg:l.id,maskOutline:c.id},groupTags:{bitmapShadow:a.groupTag,bitmapBg:l.groupTag,maskOutline:c.groupTag}};else{const{helperIDs:d,groupTags:f}=r;a.id=d.bitmapShadow,l.id=d.bitmapBg,c.id=d.maskOutline,a.groupTag=f.bitmapShadow,l.groupTag=f.bitmapBg,c.groupTag=f.maskOutline,Promise.resolve().then(()=>{i.groupTag=f.maskOutline})}return{helpers:[...s,...o],clear:()=>{t.alpha=1,t.groupTag="",i.groupTag="",_m(a),this.tempLayer.removeChild(a),a.destroy({children:!0}),this.tempLayer.removeChild(l),l.destroy(!0),this.tempLayer.removeChild(c),c.destroy(!0)},helperRecord:r}}createBitmapHelpers(t,i=!1){const r=t.getLocalBounds(),s=new hn,o=Ln({color:16777215,alpha:1},hu.bitmapBgFillStyle);hu.bitmapBgLineStyle&&s.lineStyle(hu.bitmapBgLineStyle),s.beginFill(o.color,o.alpha).drawRect(r.x,r.y,r.width,r.height).endFill(),s.transform.setFromMatrix(t.localTransform),s.transform.updateLocalTransform(),s.name="bitmapBg",s.interactive=!0;let a;if(i){const l=t.toJSON(this.viewport,{texture:!0});delete l.mask,delete l.id,a=Us(l.type,l)}else a=new Ur(t.texture),a.filters=t.filters,a.transform.setFromMatrix(t.localTransform),a.transform.updateLocalTransform();return a.name="bitmapShadow",a.interactive=!0,[a,s]}createMaskHelpers(t){const i=t.toJSON(this.viewport);i.isFill=!1,delete i.id;const r=Us(i.type,i);return r.transform.setFromMatrix(t.localTransform),r.transform.updateLocalTransform(),r.name="maskOutline",r.interactive=!0,[r]}canBuildBitmapMask(){const t=this.selected;if(t.length!==2)return!1;let i,r;for(const s of t)s instanceof Fi?s.mask||(r=s):s.isMask||(i=s);return!!(i&&r)}canModifyBitmapMask(){const t=this.selected;if(t.length!==1)return!1;const i=t[0];return i instanceof Fi&&!!i.mask}getBitmapMaskState(){return this.bitmapMaskEditing?this.bitmapMaskEditing.type:this.canBuildBitmapMask()?"can-build":this.canModifyBitmapMask()?"can-modify":""}recordBuildAndStartEditMask(t,i,r,s){console.log("[ Record ] BuildAndStartEditMask");const o=t.id,a=i.id;this.recordOperationLogWithProps([t,i,...s],{cmd:"BuildAndStartEditMask",helperRecord:r,onUndo:()=>{if(this.bitmapMaskEditing){console.log("[ MaskEdit ] exit edit mask by undo");const c=[...this.queryInteractiveDisplayObjects([o]).getKey(o)][0];c instanceof Fi&&this.endEditThenReleaseMask(c,!1)}},onRedo:()=>{console.log("[ MaskEdit ] start edit mask by redo");const l=this.queryInteractiveDisplayObjects([o,a]),c=[...l.getKey(o)][0],u=[...l.getKey(a)][0];c instanceof Fi&&u instanceof mn&&this.buildMaskThenStartEdit(c,u,!1,r)}})}recordEndEditAndReleaseMask(t,i,r){console.log("[ Record ] EndEditAndReleaseMask");const s=t.id,o=i.id;this.recordOperationLogWithProps([t,i],{cmd:"EndEditAndReleaseMask",helperRecord:r,onUndo:()=>{const a=this.queryInteractiveDisplayObjects([s,o]),l=[...a.getKey(s)][0],c=[...a.getKey(o)][0];l instanceof Fi&&c instanceof mn&&this.buildMaskThenStartEdit(l,c,!1,r)},onRedo:()=>{if(this.bitmapMaskEditing){const l=[...this.queryInteractiveDisplayObjects([s]).getKey(s)][0];l instanceof Fi&&this.endEditThenReleaseMask(l,!1)}}})}recordStartEditMask(t,i,r,s){console.log("[ Record ] StartEditMask");const o=t.id;this.recordOperationLogWithProps([t,i,...s],{cmd:"StartEditMask",helperRecord:r,onUndo:()=>{this.endMaskEditMode(!1)},onRedo:()=>{const l=[...this.queryInteractiveDisplayObjects([o]).getKey(o)][0];l instanceof Fi&&this.startMaskEditMode(l,Ul(l),"update",{willRecord:!1,helperRecord:r})}})}recordEndEditMask(t,i){console.log("[ Record ] EndEditMask");const r=t.id;this.recordOperationLogWithProps([t],{cmd:"EndEditMask",helperRecord:i,onUndo:()=>{const o=[...this.queryInteractiveDisplayObjects([r]).getKey(r)][0];o instanceof Fi&&this.startMaskEditMode(o,Ul(o),"update",{willRecord:!1,helperRecord:i})},onRedo:()=>{this.endMaskEditMode(!1)}})}recordReleaseMask(t,i){console.log("[ Record ] ReleaseMask");const r=t.id,s=i.id;this.recordOperationLogWithProps([t,i],{cmd:"ReleaseMask",onUndo:()=>{const o=this.queryInteractiveDisplayObjects([r,s]),a=[...o.getKey(r)][0],l=[...o.getKey(s)][0];a instanceof Fi&&l instanceof mn&&this.buildMask(l,a)},onRedo:()=>{const a=[...this.queryInteractiveDisplayObjects([r,s]).getKey(r)][0];a instanceof Fi&&this.releaseMask(a,!1)}})}}class fOe extends oc{setupMessages(){console.log("[ MCanvas Message ] setup messages"),this.on(at.MESSAGE_TO_PLUGIN,e=>{this.plugins.forEach(t=>{var i;(i=t.onMessage)==null||i.call(t,e)})}),this.on(at.MESSAGE_TO_MAIN,e=>{try{this.handleMessageToMain(e)}catch(t){console.error(t)}})}handleMessageToMain(e){const{eventName:t,data:i,source:r}=e;let s;switch(t){case Kl.SELECT:this.transformer.selected=i;break;case Kl.SELECT_REMOVE:{const o=new Set(i);this.transformer.selected=this.transformer.selected.filter(a=>!o.has(a))}break;case Kl.EXEC_SELECT:{const{obj:o,withGroup:a=!0}=i;o?a?this.selectSameGroup(o):this.selected=[o]:this.selected=[]}break;case Xa.BACK_TO_NORMAL_SELECT:this.updateSubEditMode(null,{...i}),this.updateEditMode(Vt.SELECT);break;case Xa.GET_MODE_MANAGER:s=this.modeManager,this._replyMessageToPlugin({eventName:t,result:s},r);break;case Xa.UPDATE_SUB_EDIT_MODE:this.modeManager.updateSubEditMode((i==null?void 0:i.mode)||null,(i==null?void 0:i.options)||{});break;case Xa.UPDATE_EDIT_MODE:this.updateEditMode(i.mode);break;case Ho.RECORD:{let o;typeof i.props=="function"?this.modeManager.curSubEditMode.curPlugin instanceof d7&&(o=i.props(this.modeManager)):o=i.props,i.ignoreSelected?this.recordFinalOperationLog(o):this.recordOperationLogWithProps(i.objs,o??{})}break;case Ho.REDO:this.undo();break;case Ho.UNDO:this.redo();break;case vo.QUERY:{const o={[Fo.VIEWPORT]:this.viewport,[Fo.TEMP_LAYER]:this.tempLayer},a=i.containers&&i.containers.reduce((l,c)=>{const u=o[c];return u&&l.push(u),l},[]);s=this.queryInteractiveDisplayObjects(i.targets,a),this._replyMessageToPlugin({eventName:t,result:s},r)}break;case vo.CREATE:{let o=i.params.options;if(o&&i.withLayerTag){const{layerTag:a,layerColor:l}=this.configManager.displayConfig;o=Ln(o,{layerTag:a,layerColor:l})}s=Us(i.params.type,o),this._replyMessageToPlugin({eventName:t,result:s},r)}break;case vo.DESTROY:this.removeElements(i.objs);break;case xi.ADD_CHILD:{const o={[Fo.VIEWPORT]:(a,l)=>{this.beforeAddDisplayToViewport(a,l==null?void 0:l.beforeAddActions),this.addDisplayToViewport(a,l==null?void 0:l.autoSelected,l==null?void 0:l.ignoreUpdateZOrder)},[Fo.TEMP_LAYER]:(a,l)=>{this.beforeAddDisplayToViewport(a,l==null?void 0:l.beforeAddActions),this.tempLayer.addChild(a)}};if(i.objs)for(const a of i.objs)o[i.type](a,i.options)}break;case xi.HIT_ELEMENT:{const o=this.getPenetrableElement(i);this._replyMessageToPlugin({eventName:t,element:o},r)}break;case xi.GET_INTERACT_ELEMENT:{const{scope:o=ll.DISPLAY_LAYER,options:a={}}=i,l=this.getInteractiveElements({...a,scope:o});this._replyMessageToPlugin({eventName:t,result:l},r)}break;case xi.CHANGE_CURSOR:this.viewport.updateCursor(i.type??"default");break;case xi.DISPLAY_LAYER_TRANSLUCENT:{const{translucent:o,excludes:a=[]}=i,l=this.getInteractiveElements({scope:ll.DISPLAY_LAYER}),c=a.map(u=>u.id);l.forEach(u=>{c.includes(u.id)||(u.alpha=o?.3:1)})}break;case xi.CUR_LAYER_CONFIG:{const{attrs:o}=i,a=gr(this.configManager.displayConfig,o);this._replyMessageToPlugin({eventName:t,result:a},r)}break;case $p.CHANGE_VISIBLE:typeof i=="boolean"&&(this.transformer.visible=i);break;case _A.CHANGE_VISIBLE:typeof i=="boolean"&&(this.textCurve.visible=i);break;case Lc.UPDATE_INTERNAL_DATA:this.modeManager.curSubEditMode?this.emit(at.MESSAGE_TO_PLUGIN,{eventName:Lc.UPDATE_INTERNAL_DATA}):this.emit(at.MESSAGE_TO_PLUGIN,{eventName:Gl.TOGGLE_MODEL,data:{model:Ec.NORMAL,selected:this.transformer.selected,unSelected:this.transformer.unSelected}});break;case Lc.CLEAR_LINE:this.emit(at.MESSAGE_TO_PLUGIN,{eventName:Gl.CLEAR_LINE});break;case Rd.REGISTER:(Array.isArray(i.plugins)?i.plugins:[i.plugins]).forEach(a=>this.registerPlugin(a));break;case Rd.UNREGISTER:(Array.isArray(i.plugins)?i.plugins:[i.plugins]).forEach(a=>this.unRegisterPlugin(a));break;case gp.EVENT_TRACKING:{const o=eb(i,["eventName"]);this.handleVectorEditorEventTracking(i.eventName,o)}break;default:console.log("[  ] >")}}_replyMessageToPlugin(e,t){var r;const i=this._iteratePlugin(t);for(const s of i)(r=s==null?void 0:s.emit)==null||r.call(s,at.MESSAGE_TO_PLUGIN,e)}*_iteratePlugin(e){if(Fp(e))yield*this.plugins;else{const t=new Set([].concat(e));for(const i of this.plugins)t.has(i.name)&&(yield i)}}handleVectorEditorEventTracking(e,t){var i,r,s,o,a,l,c,u,h,d,f,p;e==="anchorTypeChanged"?(s=(r=(i=this.canvasOptions)==null?void 0:i.vectorEditorConfig)==null?void 0:r.lifeCycleConfig)==null||s.onAnchorTypeChange(t.type):e==="addNode"?(l=(a=(o=this.canvasOptions)==null?void 0:o.vectorEditorConfig)==null?void 0:a.lifeCycleConfig)==null||l.onAnchorAdd():e==="fusionNode"?(h=(u=(c=this.canvasOptions)==null?void 0:c.vectorEditorConfig)==null?void 0:u.lifeCycleConfig)==null||h.onFusionNode():e==="exitVectorDraw"&&((p=(f=(d=this.canvasOptions)==null?void 0:d.vectorEditorConfig)==null?void 0:f.lifeCycleConfig)==null||p.onExitVectorDraw())}}class pOe extends oc{constructor(){super(...arguments);E(this,"potraceOutline",(t,i,r,s=0,o=0)=>new Promise(a=>{y1.loadImageFromGrayAlpha(t,i,r);const l=()=>{const c=y1.getTransformPath(1,s,o);a(c)};y1.process(l)}));E(this,"getPotracePath",async t=>{const{canvas:i}=t,s=i.getContext("2d").getImageData(0,0,i.width,i.height),{data:o,width:a,height:l}=this.marginalize(s);return await this.potraceOutline(o,a,l,-Og,-Og)})}marginalize(t){const i=document.createElement("canvas");i.width=t.width+Og*2,i.height=t.height+Og*2;const r=i.getContext("2d");return r.putImageData(t,Og,Og),r.getImageData(0,0,i.width,i.height)}async getOutlineBitmapData(t,i=!0,r=fu.SELECTED){var u,h;const s={[fu.SELECTED]:{getShot:()=>this.getSelectedShot({include:[it.BITMAP],scaleNum:rw}),displaysBounds:()=>this.transformer.worldGroupBounds.getRectangle()},[fu.ALL]:{getShot:()=>this.getAllDisplaysShot({include:[it.BITMAP],scaleNum:rw}),displaysBounds:this.getDisplayLayerBounds},[fu.SPECIFIED]:{getShot:()=>this.getSpecifiedDisplaysShot({targetDisplays:t,scaleNum:rw}),displaysBounds:()=>this.getDisplaysBounds(t)}},o=(u=s[r])==null?void 0:u.displaysBounds.bind(this)(),a=await((h=s[r])==null?void 0:h.getShot.bind(this)()),l=await this.getPotracePath(a),c={displaysBounds:o,bitmapScale:rw,bitmapShot:a};return i?c.pathPointsList=this.getPathPoints(l):c.potracePath=l,c}async getOutlineVectorData(t,i){if(i!==0){const r=[],s=[];return t.forEach(o=>{o.getRealPoints(this.viewport).forEach(l=>{o.isClosePath?r.push(l):s.push(l)})}),{closePathPointsList:r,openPathPointsList:s}}else{const r=[];return t.forEach(s=>{if(s.type===it.PATH){const o=s.toGlobal(new Ae(0,0)),{x:a,y:l}=this.viewport.toLocal({x:o.x,y:o.y}),c=s.toJSON(this.viewport);r.push({type:s.type,dPath:s.dPath,pivot:c.pivot,scale:c.scale,angle:c.angle,skew:c.skew,x:a,y:l})}else{const o=s.getRealPoints(this.viewport);r.push({type:s.type,realPointList:o})}}),{vectorDisplays:r}}}async getSelectedOutlineEleInfo(t){const i=this.selected;return await this.getOutlineEleInfo(i,{type:fu.SELECTED,offset:t})}async getAllOutlineEleInfo(t){const i=this.viewport.getInteractiveElements();return await this.getOutlineEleInfo(i,{type:fu.ALL,offset:t})}async getSpecifiedOutlineEleInfo(t,i=[]){if(i.length===0)return null;const s=this.viewport.getInteractiveElements().filter(a=>i.includes(a.id));return s.length===0?null:await this.getOutlineEleInfo(s,{type:fu.SPECIFIED,offset:t})}async getOutlineEleInfo(t,i){const r={};if(t.length===0)return r;const s=[],o=[];if(t.forEach(a=>{a.type!==it.BITMAP?o.push(a):s.push(a)}),s.length>0){const a=(i==null?void 0:i.offset)!==0;r.bitmapData=await this.getOutlineBitmapData(s,a,i==null?void 0:i.type)}return o.length>0&&(r.vectorData=await this.getOutlineVectorData(o,i==null?void 0:i.offset)),r}drawOutline(t){if(this.tempOutline&&this.clearOutline(),!t||t==="M0,0")return;const{fillColor:i,lineColor:r,layerColor:s,layerTag:o}=this.configManager.displayConfig,a=Us(it.PATH,{dPath:t,graphicX:0,graphicY:0,fillColor:i,lineColor:r,layerColor:s,layerTag:o,isFill:!1});this.tempOutline=a,a&&this.tempLayer.addChild(a)}clearOutline(t=!0){var i;if(t)this.tempOutline&&!this.tempOutline.destroyed&&((i=this.tempOutline)==null||i.destroy(!0));else if(this.tempOutline){const r=this.createGroupByZOrder([this.tempOutline]);this.viewport.addToLayer(this.tempOutline),this.executeSelect([this.tempOutline],[r]),this.recordOperationLog(this.tempOutline)}this.tempOutline=null}}function k4(n,e){const t=Us(n,e);return t&&(e&&t.parseJSON({enableFill:!0}),t.interactive=!1,t.interactiveChildren=!1),t}class gOe extends oc{registerPlugin(e){if(!this.plugins.find(t=>t.name===e.name)){if(this.plugins.push(e),this.initPluginEvent(e),e.getDisplayObject){const t=e.getDisplayObject();t&&this.app.stage.addChild(t)}if(e.init&&(e.init(this.viewport,this.transformer),e.initStageDisplay&&this.app.stage.addChild(e.initStageDisplay(k4)),e.initViewportDisplay)){const t=e.initViewportDisplay(k4);if(t instanceof rn)this.viewport.addChild(t);else{const{display:i,targetContainer:r}=t;this.viewport.addToContainer(i,r)}}}}initPluginEvent(e){var t,i;e&&((t=e.on)==null||t.call(e,at.MESSAGE_TO_MAIN,r=>{this.emit(at.MESSAGE_TO_MAIN,r)}),(i=e.on)==null||i.call(e,at.MESSAGE_TO_PLUGIN,r=>{this.emit(at.MESSAGE_TO_PLUGIN,r)}))}unRegisterPlugin(e){var i;const t=this.plugins.indexOf(e,0);t>-1&&((i=e==null?void 0:e.destroy)==null||i.call(e),this.plugins.splice(t,1))}unRegisterPluginByName(e){const t=this.plugins.find(i=>i.name===e);t&&this.unRegisterPlugin(t)}getPluginByName(e){return this.plugins.find(i=>i.name===e)}unRegisterPluginByType(e){this.plugins.filter(i=>i.type===e).forEach(i=>{this.unRegisterPlugin(i)})}}class x1 extends zD(zD(cOe,lOe),uOe,sOe,rOe,hOe,pOe,gOe,dOe,fOe,oOe){constructor(e){super(),this.init(e),this.setupEvents()}}window.__PIXI_INSPECTOR_GLOBAL_HOOK__&&window.__PIXI_INSPECTOR_GLOBAL_HOOK__.register({PIXI:STe});window.canvas_debug={};class mOe extends v7{constructor(t){super(t);E(this,"name",yp.VECTOR_EDITOR);E(this,"accuracy",1e-4)}handleBounds(t,i){return[(t+i)/2,(t+i)/2,(t+i)/2]}handleExtraDisplayBounds(t,i){return[t,(t+i)/2,i]}}const vOe={unit:"mm",pixelPerUnit:1,fractionDigits:1,enableAdsorb:!0};class _Oe extends Zr{constructor(t=vOe){super();E(this,"controlMap",new Map);E(this,"guideLine");E(this,"name","guideLine");E(this,"type",cb);this.guideLine=new C4(t)}init(t){this.guideLine.setContext(t),t.addChild(this.guideLine.container)}destroy(){}set selected(t){this.guideLine.selected=t}get selected(){return this.guideLine.selected}setUnSelected(t){this.guideLine.unSelected=t}updateConfig(t){this.guideLine.updateOptions(t)}calDeltaToSelected(){this.guideLine.calDeltaToSelected()}onTransformerSelect(t){var i,r;(r=(i=this.guideLine).onTransformSelected)==null||r.call(i,t)}onMessage(t){const{eventName:i,data:r}=t;switch(i){case Gl.ADD_EXTRA_COMPARE_TARGET:this.guideLine.addExtraCompareTarget(r);break;case Gl.REMOVE_EXTRA_COMPARE_TARGET:this.guideLine.removeExtraCompareTarget(r);break;case Gl.TOGGLE_MODEL:const s=eb(r,["model"]),{model:o}=r;this.toggleModel(o,s);break;case Gl.UPDATE_ELEMENTS:this.guideLine.selected=r.selected??[],this.guideLine.unSelected=r.unSelected??[],this.calDeltaToSelected();break;case Gl.CLEAR_LINE:this.guideLine.clear()}}setGroupSelection(t,i){this.guideLine.setGroupSelection(t,i)}onTransformerChange(){}onTransformerPointerDown(t){this.guideLine.onPointerdown(t)}onTransformerPointerUp(){this.guideLine.onPointerup()}onViewportPointerDown(t){this.guideLine.name===yp.VECTOR_EDITOR&&this.guideLine.onPointerdown(t)}onViewportPointerMove(t){var i;this.guideLine.name===yp.VECTOR_EDITOR&&((i=this.guideLine.selected)==null?void 0:i.length)>0&&this.guideLine.onObjectMoving(t)}onViewportPointerUp(){this.guideLine.name===yp.VECTOR_EDITOR&&this.guideLine.onPointerup()}onViewportPointerupoutside(){this.onViewportPointerUp()}onTransformerPointerMove(t){this.guideLine.onObjectMoving(t)}onViewportScale(t){this.guideLine.updateTextScale(t.scaled)}toggleModel(t,i){const{config:r,selected:s,unSelected:o,extraElements:a,guideLineTriggerModel:l}=i;switch(t){case Ec.NORMAL:this.guideLine.reset(),this.setNormalModel({options:r,selected:s,unSelected:o});break;case Ec.VECTOR_EDITOR:this.guideLine.reset(),this.setVectorEditorModel({extraElements:a,selected:[...s],unSelected:[...o],guideLineTriggerModel:l});break}this.setupControlEvent()}setupControlEvent(){this.guideLine&&(this.guideLine.on(at.MESSAGE_TO_MAIN,t=>{this.emit(at.MESSAGE_TO_MAIN,t)}),this.guideLine.on(at.MESSAGE_TO_PLUGIN,t=>{this.emit(at.MESSAGE_TO_PLUGIN,t)}))}setNormalModel(t){const{options:i,selected:r,unSelected:s}=t,o=this.generatorNewControl(Ec.NORMAL,{selected:r,unSelected:s},i);this.guideLine=o}setVectorEditorModel(t){const{extraElements:i,guideLineTriggerModel:r=Ad.DOWN,selected:s,unSelected:o}=t,a=this.generatorNewControl(Ec.VECTOR_EDITOR,{selected:s,unSelected:o,extraElements:i},this.guideLine.options);a.triggerModel=r,this.guideLine=a}generatorNewControl(t,i,r){const s={[Ec.NORMAL]:C4,[Ec.VECTOR_EDITOR]:mOe},o=this.guideLine,a=o==null?void 0:o.options,l=Object.assign({},a,r??{}),{context:c,container:u}=this.getControlConf(o),h=new s[t](l);h.options=l,h.context=c,h.container=u,h.clearExtraCompareTarget();const{selected:d,unSelected:f,extraElements:p}=i;return Ft(h,"selected",d??[]),Ft(h,"unSelected",f??[]),p&&h.addExtraCompareTarget(p),h}getControlConf(t){const i=We(t,"context"),r=We(t,"container");return{context:i,container:r}}}var Da;class yOe{constructor(e,t){ke(this,Da,void 0);E(this,"name","ruler");E(this,"type",cb);E(this,"zoom",bhe(e=>{var t;(t=S(this,Da))==null||t.zoom(e.scaled,e.x,e.y)},60,{trailing:!0}));Qe(this,Da,new vke(e,t))}getDisplayObject(){return S(this,Da)}init(e){var t;(t=S(this,Da))==null||t.zoom(e.scaled,e.x,e.y)}destroy(e){var t;(t=S(this,Da))==null||t.destroy(e)}updateConfig(e){var t;(t=S(this,Da))==null||t.updateOptions(e)}resize(e,t){S(this,Da).resize(e,t)}onViewportMove(e){this.zoom(e)}onViewportScale(e){this.zoom(e)}onTransformerSelect(e){var t;(t=S(this,Da))==null||t.highlight(e.worldGroupBounds)}onTransformerChange(e){var t;(t=S(this,Da))==null||t.highlight(e.worldGroupBounds)}}Da=new WeakMap;$ve(zve.version);var ku,np,nO,Ac;const lT=class lT{constructor(e){ke(this,ku,new Map);ke(this,np,new Set);ke(this,nO,new AOe(lT.ExpiredAt,()=>{this._autoClearAction()}));ke(this,Ac,void 0);if(typeof e!="function")throw Error("a function to get key must be provided");Qe(this,Ac,e)}_autoClearAction(){for(const e of S(this,ku).keys())S(this,np).has(e)||S(this,ku).delete(e)}has(e){return S(this,ku).has(S(this,Ac).call(this,e))}get(e){return S(this,ku).get(S(this,Ac).call(this,e))}set(e,t){if(!e)throw TypeError("buffer不能为空");S(this,ku).set(S(this,Ac).call(this,e),t)}delete(e){const t=S(this,Ac).call(this,e);return S(this,np).has(t)?!1:(S(this,ku).delete(t),!0)}setPersistent(e){const t=S(this,Ac).call(this,e);t&&S(this,np).add(t)}cancelPersistent(e){S(this,np).delete(S(this,Ac).call(this,e))}};ku=new WeakMap,np=new WeakMap,nO=new WeakMap,Ac=new WeakMap,E(lT,"ExpiredAt",1e4);let ik=lT;class AOe{constructor(e,t){E(this,"period");E(this,"timeout");E(this,"handler");if(!isFinite(e))throw TypeError("period must be a finite number");this.period=e,this.handler=t,this._setup()}_setup(){this.timeout=setTimeout(()=>{this.handler(),this._setup()},this.period)}}const bOe=""+new URL("../assets/StardosStencil-Bold-yiDt7Zlz.ttf",import.meta.url).href,wOe=""+new URL("../assets/StardosStencil-Regular-StlXrX0Q.ttf",import.meta.url).href,xOe=""+new URL("../assets/LondrinaOutline-Regular-59qKCmYv.ttf",import.meta.url).href,COe=""+new URL("../assets/Amita-Bold-aSQAuye3.ttf",import.meta.url).href,EOe=""+new URL("../assets/Amita-Regular-_h7-nezl.ttf",import.meta.url).href,TOe=""+new URL("../assets/Lobster-Regular-fCeQKSet.ttf",import.meta.url).href,IOe=""+new URL("../assets/Atma-Bold-rDMbUHGR.ttf",import.meta.url).href,SOe=""+new URL("../assets/Atma-Light-3It1QeeG.ttf",import.meta.url).href,POe=""+new URL("../assets/Atma-Regular-_KjjDvpp.ttf",import.meta.url).href,MOe=""+new URL("../assets/Combo-Regular--JoyUCC_.ttf",import.meta.url).href,ROe=""+new URL("../assets/DancingScript-Bold-RoOiZ2Tr.ttf",import.meta.url).href,DOe=""+new URL("../assets/DancingScript-Medium-2y-0RL2N.ttf",import.meta.url).href,kOe=""+new URL("../assets/DancingScript-Regular-HXqfuoR2.ttf",import.meta.url).href,OOe=""+new URL("../assets/AlegreyaSC-Bold-OM00CjCF.ttf",import.meta.url).href,LOe=""+new URL("../assets/AlegreyaSC-Italic-tIIFYXhr.ttf",import.meta.url).href,NOe=""+new URL("../assets/AlegreyaSC-Medium-K24WcUkF.ttf",import.meta.url).href,BOe=""+new URL("../assets/AlegreyaSC-Regular-6LCBTB8u.ttf",import.meta.url).href,FOe=""+new URL("../assets/Caveat-Bold-1IHp6qF_.ttf",import.meta.url).href,UOe=""+new URL("../assets/Caveat-Medium-ZsNvV8kS.ttf",import.meta.url).href,GOe=""+new URL("../assets/Caveat-Regular-HJubXlEO.ttf",import.meta.url).href,HOe=""+new URL("../assets/Caveat-SemiBold-RkD_bU6w.ttf",import.meta.url).href,VOe=""+new URL("../assets/Gorditas-Bold-OhdgKsA4.ttf",import.meta.url).href,zOe=""+new URL("../assets/Gorditas-Regular-fNPCL8rI.ttf",import.meta.url).href,$Oe=""+new URL("../assets/LifeSavers-Bold-q9RowP4f.ttf",import.meta.url).href,WOe=""+new URL("../assets/LifeSavers-Regular-WvQ0kid3.ttf",import.meta.url).href,jOe=""+new URL("../assets/Shalimar-Regular-QUlSC-Ja.ttf",import.meta.url).href,QOe=""+new URL("../assets/SpaceGrotesk-Bold-li6q3koE.ttf",import.meta.url).href,XOe=""+new URL("../assets/SpaceGrotesk-Light-Lc-q3MMX.ttf",import.meta.url).href,YOe=""+new URL("../assets/SpaceGrotesk-Medium-zBPIYFBD.ttf",import.meta.url).href,qOe=""+new URL("../assets/SpaceGrotesk-Regular-jBy04Num.ttf",import.meta.url).href,KOe=""+new URL("../assets/SpaceGrotesk-SemiBold-Qtlx220X.ttf",import.meta.url).href,JOe=""+new URL("../assets/Grandstander-Bold-vkXJFwen.ttf",import.meta.url).href,ZOe=""+new URL("../assets/Grandstander-BoldItalic-abeP-kBD.ttf",import.meta.url).href,eLe=""+new URL("../assets/Grandstander-Light-JmZ2yXGS.ttf",import.meta.url).href,tLe=""+new URL("../assets/Grandstander-LightItalic-rO-vOiZ7.ttf",import.meta.url).href,nLe=""+new URL("../assets/Grandstander-Medium-l6IO-Hb2.ttf",import.meta.url).href,iLe=""+new URL("../assets/Grandstander-Regular-fr-oBN9L.ttf",import.meta.url).href,rLe=""+new URL("../assets/Grandstander-Thin-JcfqeSNW.ttf",import.meta.url).href,sLe=""+new URL("../assets/Lato-Bold-eYg99ZDq.ttf",import.meta.url).href,oLe=""+new URL("../assets/Lato-BoldItalic-k-ptzsAK.ttf",import.meta.url).href,aLe=""+new URL("../assets/Lato-Italic-zkynN_7x.ttf",import.meta.url).href,V7=""+new URL("../assets/Lato-Regular-cCyHrdQq.ttf",import.meta.url).href,lLe=""+new URL("../assets/DroidSansFallback-n5BSEnYa.ttf",import.meta.url).href;function O4(n,e="en"){if(!n)return"";const t=r=>typeof r=="string"&&r,i=r=>t(n[r])?n[r]:null;return i(e)??i("en")??Object.values(n).find(r=>t(r))??""}const Ly=(n,e,t)=>{var p,g;const{name:i,fullName:r,postscriptName:s}=n,o=(i==null?void 0:i.records)??{},a=o.preferredFamily??o.fontFamily??{},l=O4(a),c=o.preferredSubfamily??o.fontSubfamily??{},u=O4(c);if(!l||!u||l.startsWith("."))return;const h=gr(n["OS/2"],["usWeightClass","usWidthClass","fsSelection"]),d=new Set([]),f=(g=(p=n.GPOS)==null?void 0:p.scriptList)==null?void 0:g.map(m=>m.tag);return{type:e,path:t,postscriptName:s,fullName:r,familyName:l,subfamilyName:u,familyNames:a,subfamilyNames:c,"OS/2":h,characterSet:d,numGlyphs:n.numGlyphs,scriptList:f}};function cLe(n,e,t){var s,o;z7(n);const i=((o=(s=n==null?void 0:n.fvar)==null?void 0:s.instance)==null?void 0:o.reduce((a,l)=>l.name?Object.assign(a,{[l.name.en]:l.name}):a,{}))??[];function r(a,l,c){return`${a}-${l}${c!=="Regular"?`_${c.replace(/\s+/g,"-")}`:""}`}Object.keys(n.namedVariations).forEach(a=>{const l={...e,subfamilyName:a,subfamilyNames:i[a],postscriptName:r(n.familyName,n.subfamilyName,a),isVariation:!0};t.push(l)})}function z7(n){var i,r;if(!((i=n==null?void 0:n.fvar)!=null&&i.instance))return;const e=(r=n==null?void 0:n.name)==null?void 0:r.records;let t=0;n.fvar.instance.forEach(s=>{if(!s.name){const o={...e.fontSubfamily};t>0&&(o.en=`${o.en??"unknown"}_${t}`),s.name=o,t++}})}async function uLe(n,e){try{if(!e)return[];const t=[],i=e.type;if(e.fonts)e.fonts.forEach(r=>{const s=Ly(r,i,n);s&&t.push(s)});else if(e.fvar){const r=Ly(e,i,n);r&&cLe(e,r,t)}else{const r=Ly(e,i,n);r&&t.push(r)}return t}catch(t){return hLe(n,t),[]}}function hLe(n,e){Tt.error("ReadFontFileError:",n,`
`,e)}const dLe=["Regular","Regular Italic","Italic","Oblique","Thin","Thin Italic","ExtraLight","ExtraLight Italic","UltraLight","UltraLight Italic","Light","Light Italic","Light Oblique","Medium","Medium Italic","Medium Oblique","Semibold","SemiBold Italic","Demi","DemiBold","DemiBold Italic","Bold","Bold Italic","Bold Oblique","ExtraBold","ExtraBold Italic","UltraBold","UltraBold Italic","Black","Black Italic","Black Oblique","Heavy","Heavy Italic","Heavy Oblique","ExtraBlack","UltraBlack","Condensed","Condensed Thin","Condensed Light","Condensed Medium","Condensed Bold","Condensed ExtraBold","Condensed Black"].reduce((e,t,i)=>Object.assign(e,{[GA(t)]:i}),{});function fLe(n,e,t){const i=GA(n),r=GA(e),s=t[i]??9999,o=t[r]??9999;return s!==o?s-o:i.localeCompare(r,void 0,{numeric:!0})}function GA(n){return n.replace(/\s+/g,"").toLowerCase()}function pLe(n){if(n&&typeof n=="string"){const e=/^[A-Za-z ]+$/;return n.split("").every(t=>e.test(t))}else return!1}const gLe=(()=>{const n=[[["Thin"],"纤细体","纖細體"],[["Extra Light","Ultra Light"],"极细体","極細體"],[["Light"],"细体","細體"],[["Regular","Normal"],"常规","常規"],[["Medium"],"中等","中等"],[["Semi Bold","Demi Bold"],"半粗体","半粗體"],[["Bold"],"粗体","粗體"],[["Extra Bold","Ultra Bold"],"特粗体","半粗體"],[["Black","Heavy"],"黑体","黑體"],[["Extra Black","Ultra Black"],"特黑体","特黑體"]],e=[];return n.forEach(([t,...i])=>{t.forEach(r=>{e.push([GA(r),...i])})}),e})();function mLe(n){["zh","zh-TW","zh-HK","zh-Hant"].forEach(t=>{const i=n.names[t];if(i&&pLe(i)){const r=GA(i),s=gLe.find(([o])=>o===r);if(s){let o;t==="zh"?o=s[1]:o=s[2],n.names[t]=o}}})}const vLe=async n=>{var t,i;let e;try{e=(i=(t=globalThis==null?void 0:globalThis.MeApi)==null?void 0:t.fs)==null?void 0:i.stat(n)}catch(r){Tt.error(r)}return e},_Le=(n,e)=>!n||!e?!1:e.mtimeMs===n.mtimeMs;async function yLe(n,e,t={}){const{fontRecordCache:i}=t,r=[];let s={};const o=new Set,a={new:0,old:0,unuse:0};if(await lL(n,4,async c=>{var u;try{let h,d,f=!1,p,g=!1;if(i){g=!j7(c),g&&(p=await vLe(c));const m=i.get(c);m&&(f=!g||_Le(m,p),f?(h=m.data,f=!0,o.add(c),a.old++):(i.delete(c),a.unuse++))}if(!h&&(d=await R2(c),d)){(u=t.onLoadBuffer)==null||u.call(t,{path:c,bufferView:d});const m=await W7(d);h=await uLe(c,m)}i&&!f&&h&&(!g||p)&&(i.set(c,{data:h,mtimeMs:p==null?void 0:p.mtimeMs}),a.new++,o.add(c)),h==null||h.forEach(m=>{var v;ALe(m,s,e),(v=t.onEachFont)==null||v.call(t,{font:m,bufferView:d})})}catch(h){Tt.error(h),r.push({path:c,error:h})}}),i){for(const c of i.keys())o.has(c)||(i.delete(c),a.unuse++);Tt.log("[ FontRecordCache ]",e,a)}return s=bLe(s),r.length&&Tt.warn("load failed font list",r),{fonts:s,fontRecordCache:i}}function ALe(n,e,t){const{familyNames:i,subfamilyNames:r,...s}=n;let o=e[n.familyName];o||(o={type:n.type,names:i,subFontFamilyType:"intergration",subFontFamilys:{},postscriptName:"",fullName:"",source:t},e[n.familyName]=o);const a={...s,names:r,familyName:n.familyName,source:t};return o.subFontFamilys[n.subfamilyName]=a,a}function bLe(n){const e=Object.entries(n).sort(([i],[r])=>i.localeCompare(r,void 0,{numeric:!0}));return e.forEach(([,i])=>{var s,o;const r=Object.entries(i.subFontFamilys).sort(([a],[l])=>fLe(a,l,dLe));if(r.forEach(([,a])=>mLe(a)),i.subFontFamilys=Object.fromEntries(r),r.length>1){const a=r.map(([,c])=>c.path);new Set(a).size>1&&(i.subFontFamilyType="single")}i.postscriptName=(s=r[0][1])==null?void 0:s.postscriptName,i.fullName=(o=r[0][1])==null?void 0:o.fullName}),Object.fromEntries(e)}async function wLe(){var t,i;const n=[],e=PLe();if(e.length>0&&n.push({key:Ar.BUILD_IN,paths:e}),globalThis!=null&&globalThis.MeApi){const r=await((i=(t=globalThis==null?void 0:globalThis.MeApi)==null?void 0:t.getFontPaths)==null?void 0:i.call(t))??[];r.length>0&&n.push({key:Ar.SYSTEM,paths:r})}return Tt.debug("fontPathGroups: ",n),n}function xLe(){var n,e;return((e=(n=globalThis==null?void 0:globalThis.MeApi)==null?void 0:n.getOsPlatform)==null?void 0:e.call(n))??""}function $7(){var n,e;return((e=(n=globalThis==null?void 0:globalThis.MeApi)==null?void 0:n.getFetchFileHost)==null?void 0:e.call(n))??""}let C1;async function CLe(){return C1||(C1=await Pi(()=>import("./browser-module--7s41BTz.js"),__vite__mapDeps([8,1,4,5,6,7]),import.meta.url)),C1}async function W7(n,e=""){return n?(await CLe()).create(n,e):void 0}async function R2(n){var i,r,s;if(!n)return;let e;const t=j7(n);return globalThis!=null&&globalThis.MeApi&&!t?e=await((s=(r=(i=globalThis==null?void 0:globalThis.MeApi)==null?void 0:i.fileHelper)==null?void 0:r.read)==null?void 0:s.call(r,n)):e=await ELe(n),e}async function ELe(n){const e=await fetch(n);return new Uint8Array(await e.arrayBuffer())}function L4(n){let e;if(typeof n=="string"&&n){const t=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]?|[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g;e=n.match(t)}return e??[]}function TLe(){const n=Object.values(Object.assign({"/src/assets/fonts/build-in/01_Stardos_Stencil/StardosStencil-Bold.ttf":bOe,"/src/assets/fonts/build-in/01_Stardos_Stencil/StardosStencil-Regular.ttf":wOe,"/src/assets/fonts/build-in/02_Londrina_Outline/LondrinaOutline-Regular.ttf":xOe,"/src/assets/fonts/build-in/03_Amita/Amita-Bold.ttf":COe,"/src/assets/fonts/build-in/03_Amita/Amita-Regular.ttf":EOe,"/src/assets/fonts/build-in/04_Lobster/Lobster-Regular.ttf":TOe,"/src/assets/fonts/build-in/05_Atma/Atma-Bold.ttf":IOe,"/src/assets/fonts/build-in/05_Atma/Atma-Light.ttf":SOe,"/src/assets/fonts/build-in/05_Atma/Atma-Regular.ttf":POe,"/src/assets/fonts/build-in/06_Combo/Combo-Regular.ttf":MOe,"/src/assets/fonts/build-in/07_Dancing_Script/DancingScript-Bold.ttf":ROe,"/src/assets/fonts/build-in/07_Dancing_Script/DancingScript-Medium.ttf":DOe,"/src/assets/fonts/build-in/07_Dancing_Script/DancingScript-Regular.ttf":kOe,"/src/assets/fonts/build-in/08_Alegreya_SC/AlegreyaSC-Bold.ttf":OOe,"/src/assets/fonts/build-in/08_Alegreya_SC/AlegreyaSC-Italic.ttf":LOe,"/src/assets/fonts/build-in/08_Alegreya_SC/AlegreyaSC-Medium.ttf":NOe,"/src/assets/fonts/build-in/08_Alegreya_SC/AlegreyaSC-Regular.ttf":BOe,"/src/assets/fonts/build-in/09_Caveat/Caveat-Bold.ttf":FOe,"/src/assets/fonts/build-in/09_Caveat/Caveat-Medium.ttf":UOe,"/src/assets/fonts/build-in/09_Caveat/Caveat-Regular.ttf":GOe,"/src/assets/fonts/build-in/09_Caveat/Caveat-SemiBold.ttf":HOe,"/src/assets/fonts/build-in/10_Gorditas/Gorditas-Bold.ttf":VOe,"/src/assets/fonts/build-in/10_Gorditas/Gorditas-Regular.ttf":zOe,"/src/assets/fonts/build-in/11_Life_Savers/LifeSavers-Bold.ttf":$Oe,"/src/assets/fonts/build-in/11_Life_Savers/LifeSavers-Regular.ttf":WOe,"/src/assets/fonts/build-in/12_Shalimar/Shalimar-Regular.ttf":jOe,"/src/assets/fonts/build-in/13_Space_Grotesk/SpaceGrotesk-Bold.ttf":QOe,"/src/assets/fonts/build-in/13_Space_Grotesk/SpaceGrotesk-Light.ttf":XOe,"/src/assets/fonts/build-in/13_Space_Grotesk/SpaceGrotesk-Medium.ttf":YOe,"/src/assets/fonts/build-in/13_Space_Grotesk/SpaceGrotesk-Regular.ttf":qOe,"/src/assets/fonts/build-in/13_Space_Grotesk/SpaceGrotesk-SemiBold.ttf":KOe,"/src/assets/fonts/build-in/14_Grandstander/Grandstander-Bold.ttf":JOe,"/src/assets/fonts/build-in/14_Grandstander/Grandstander-BoldItalic.ttf":ZOe,"/src/assets/fonts/build-in/14_Grandstander/Grandstander-Light.ttf":eLe,"/src/assets/fonts/build-in/14_Grandstander/Grandstander-LightItalic.ttf":tLe,"/src/assets/fonts/build-in/14_Grandstander/Grandstander-Medium.ttf":nLe,"/src/assets/fonts/build-in/14_Grandstander/Grandstander-Regular.ttf":iLe,"/src/assets/fonts/build-in/14_Grandstander/Grandstander-Thin.ttf":rLe,"/src/assets/fonts/build-in/15_Lato/Lato-Bold.ttf":sLe,"/src/assets/fonts/build-in/15_Lato/Lato-BoldItalic.ttf":oLe,"/src/assets/fonts/build-in/15_Lato/Lato-Italic.ttf":aLe,"/src/assets/fonts/build-in/15_Lato/Lato-Regular.ttf":V7}));return n.length||Tt.error("Error: Build-in font assets is empty, check if font directory is the wrong place!"),n}function ILe(){const n=Object.values(Object.assign({"/src/assets/fonts/build-in/15_Lato/Lato-Regular.ttf":V7}))[0];return n||Tt.error("Error: Default font is empty, check if font is the wrong place!"),n}function SLe(){const n=Object.values(Object.assign({"/src/assets/fonts/DroidSansFallback.ttf":lLe}))[0];return n||Tt.error("Error: Build-in fallback font is empty, check if font is the wrong place!"),n}var Ar=(n=>(n.BUILD_IN="build-in",n.SYSTEM="system",n))(Ar||{});let Tw;function PLe(){return Tw||(Tw=TLe().map(e=>D2(e)),Tw)}function D2(n){var r;const e=new URL(import.meta.url).origin,t=$7();let i=new URL(n,(r=globalThis==null?void 0:globalThis.location)==null?void 0:r.origin).href;return t&&(i=i.replace(e,t)),i}function MLe(){const n=$7(),e=["http:","https:","ws:","wws:","file:"];return n&&e.push(n),new RegExp(`^(${e.join("|")})`)}let E1;function j7(n){return E1||(E1=MLe()),E1.test(n)}let Iw;function lm(){return Iw||(Iw={familyName:"Lato",subfamilyName:"Regular",postscriptName:"Lato-Regular",source:"build-in",path:D2(ILe())},Iw)}let Sw;function rk(){return Sw||(Sw={familyName:"Droid Sans Fallback",subfamilyName:"Regular",postscriptName:"DroidSansFallback",source:"build-in",path:D2(SLe())},Sw)}const RLe={win32:[{familyName:"Segoe UI",subfamilyName:"Regular",postscriptName:"SegoeUI",source:"system"},{familyName:"Segoe UI Symbol",subfamilyName:"Regular",postscriptName:"SegoeUISymbol",source:"system"},{familyName:"Segoe UI Emoji",subfamilyName:"Regular",postscriptName:"SegoeUIEmoji",source:"system"},{familyName:"Noto Emoji",subfamilyName:"Regular",postscriptName:"NotoEmoji-Regular",source:"system"},{familyName:"Microsoft YaHei",subfamilyName:"Regular",postscriptName:"MicrosoftYaHei",source:"system"},{familyName:"Microsoft JhengHei",subfamilyName:"Regular",postscriptName:"MicrosoftJhengHeiRegular",source:"system"},{familyName:"SimHei",subfamilyName:"Regular",postscriptName:"SimHei",source:"system"},{familyName:"STSong",subfamilyName:"Regular",postscriptName:"STSong",source:"system"},{familyName:"SimSun",subfamilyName:"Regular",postscriptName:"SimSun",source:"system"},{familyName:"Yu Gothic",subfamilyName:"Regular",postscriptName:"YuGothic-Regular",source:"system"},{familyName:"Malgun Gothic",subfamilyName:"Regular",postscriptName:"MalgunGothic",source:"system"},{familyName:"Arial Unicode MS",subfamilyName:"Regular",postscriptName:"ArialUnicodeMS",source:"system"}],darwin:[{familyName:"Apple Symbols",subfamilyName:"Regular",postscriptName:"AppleSymbols",source:"system"},{familyName:"Noto Emoji",subfamilyName:"Regular",postscriptName:"NotoEmoji-Regular",source:"system"},{familyName:"PingFang SC",subfamilyName:"Regular",postscriptName:"PingFangSC-Regular",source:"system"},{familyName:"PingFang TC",subfamilyName:"Regular",postscriptName:"PingFangTC-Regular",source:"system"},{familyName:"STHeiti",subfamilyName:"Regular",postscriptName:"STHeiti",source:"system"},{familyName:"STSong",subfamilyName:"Regular",postscriptName:"STSong",source:"system"},{familyName:"SimSong",subfamilyName:"Regular",postscriptName:"SimSong-Regular",source:"system"},{familyName:"Toppan Bunkyu Gothic",subfamilyName:"Regular",postscriptName:"ToppanBunkyuGothicPr6N-Regular",source:"system"},{familyName:"Nanum Gothic",subfamilyName:"Regular",postscriptName:"NanumGothic",source:"system"},{familyName:"Arial Unicode MS",subfamilyName:"Regular",postscriptName:"ArialUnicodeMS",source:"system"}]};function DLe(){const n=xLe();return[rk()].concat(RLe[n]??[])}const N4={"ultra-condensed":1,"extra-condensed":2,condensed:3,"semi-condensed":4,normal:5,"semi-expanded":6,expanded:7,"extra-expanded":8,"ultra-expanded":9,"50%":1,"62.5%":2,"75%":3,"87.5%":4,"100%":5,"112.5%":6,"125%":7,"150%":8,"200%":9},sk=25.4;var bc;class kLe{constructor(){E(this,"fontList");E(this,"_getFontListPromise");E(this,"loaded",!1);E(this,"fontFaceAdded",new Set);E(this,"ignoreCharPattern",/[\n\r\t\f]/);ke(this,bc,new ik(e=>!e.familyName||!e.subfamilyName||!e.source?(Tt.warn("familyName, subfamilyName或source不应该为空",e),""):`[${e.familyName},${e.subfamilyName}],${e.source}`));E(this,"charToGlyph",new Map);E(this,"glyphCache",new Map);E(this,"fontInfoCache",new Map);E(this,"currentFont");E(this,"fonts");this._init()}_init(){[lm(),rk()].forEach(t=>{S(this,bc).setPersistent(t),this.resolveFont(t)})}async getGroupedFontList(){return this.fontList?this.fontList:this._getFontListPromise?this._getFontListPromise:(console.time("getFontList"),this._getFontListPromise=this._getFontList(),this.fontList=await this._getFontListPromise,console.timeEnd("getFontList"),this.initFontFace(),this.initFontCollections(),this.loaded=!0,this.fontList)}async _getFontList(){const e=await wLe();return this._getFontGroupsAction(e)}*iterateFonts(e){var t;if(this.fontList){const i=e?Array.isArray(e)?e:[e]:[Ar.SYSTEM,Ar.BUILD_IN];for(const r of i){const s=(t=this.fontList)==null?void 0:t[r];if(s)for(const o of Object.values(s.fonts))for(const a of Object.values(o.subFontFamilys))yield a}}}initFontCollections(){var s;const e=new Map,t=(o,a,l)=>{const c=o.get(l??"");c?Array.isArray(c)?c.push(a):o.set(l,[c,a]):o.set(l,a)},i=[Ar.SYSTEM,Ar.BUILD_IN];for(const o of i){const a=(s=this.fontList)==null?void 0:s[o];if(!a)continue;const l=new Map,c=new Map;for(const u of this.iterateFonts(o))if(t(l,u,u.postscriptName),t(c,u,u.fullName),u.scriptList)for(const h of u.scriptList)t(e,u,h);a.postscriptNames=l,a.fullNames=c}const r=[...this.iterateFonts()];r.sort((o,a)=>a.numGlyphs-o.numGlyphs),this.fonts={scripts:e,sortedFontsByNumGlyphs:r}}getCssFontFamilyName(e){var t,i;return(i=(t=globalThis.navigator)==null?void 0:t.platform)!=null&&i.startsWith("Win")?e.fullName:e.postscriptName}initFontFace(){var t;const e=(t=this.fontList)==null?void 0:t[Ar.BUILD_IN];e&&Object.values(e.fonts??{}).forEach(i=>{Object.values(i.subFontFamilys??{}).forEach(async r=>{if(r){const s=this.getCssFontFamilyName(r);this.fontFaceAdded.has(s)||(F4(s,await R2(r.path)),this.fontFaceAdded.add(s))}})})}async _getFontGroupsAction(e){const t={},i=await BLe()??{},r=[];for(const s of e){const o=i[s.key]??new Map,a=s.key===Ar.BUILD_IN?{onEachFont:({font:c,bufferView:u})=>{if(u){const h=this.getCssFontFamilyName(c);F4(h,u),this.fontFaceAdded.add(h)}},fontRecordCache:o}:{fontRecordCache:o},l=yLe(s.paths,s.key,a).then(async({fonts:c,fontRecordCache:u})=>{const h={key:s.key,fonts:c};t[s.key]=h,u&&(i[s.key]=u)});r.push(l)}return Promise.allSettled(r).then(async()=>(await FLe(i),t))}async preloadTextGlyphs(e){if(!e)return;"fontSize"in e&&console.warn("calling preloadTextGlyphs with fontSize may be unexpected");const{fontFamily:t,fontSubfamily:i,fontSource:r,text:s,fontSize:o=sk}=e,a={familyName:t,subfamilyName:i,source:r};for(const l of L4(s)){if(this.ignoreCharPattern.test(l))continue;const c=this._charKeyOf(l,a);if(this.charToGlyph.has(c))continue;let u;const h=await this._resolveCharGlyph(l,o,this.fontsForSearchGlyph(a)).catch(Tt.warn);if(h){const{fontData:d,glyphData:f,hasDef:p}=h;u=this._charKeyOf(p?l:"(.notdef)",d),this.glyphCache.has(u)||this.glyphCache.set(u,f)}u&&this.charToGlyph.set(c,u)}}getTextGlyphsSync(e){if(!e)return;const{fontFamily:t,fontSubfamily:i,fontSource:r,text:s,fontSize:o=sk}=e,a={familyName:t,subfamilyName:i,source:r},l={};for(const d of L4(s)){if(this.ignoreCharPattern.test(d))continue;const f=this._charKeyOf(d,a);let p=this.charToGlyph.get(f);if(p)l[d]=this.glyphCache.get(p);else{const g=this._getGlyphSync(d,o,this.fontsForSearchGlyph(a));if(g){const{fontData:m,glyphData:v,hasDef:_}=g;p=this._charKeyOf(_?d:"(.notdef)",m),this.glyphCache.has(p)||this.glyphCache.set(p,v),l[d]=v}}}let c={};const u=this._fontKeyOf(a);if(this.fontInfoCache.has(u))c=this.fontInfoCache.get(u);else{const d=this._getCachedFont(a)??this._getCachedFont(lm());d&&(c=this.getFontInfo(d,o),this.fontInfoCache.set(u,c))}return{fontInfo:c,glyphData:l}}getFontInfo(e,t){const i=T1(e),r=(1/i||1e3)*t,s=(a,l=0)=>{const c=Number(a);return Number.isFinite(c)?c:l};return{unitsPerEm:s(i),lineHeight:s(Math.abs(e.ascent-e.descent))*r,ascent:s(e.ascent)*r,descent:s(e.descent)*r,capHeight:s(e.capHeight,18.199)*r,xHeight:s(e.xHeight,12.8651)*r,lineGap:s(e.lineGap)*r}}setCurrentFont(e){const t=e??{},i=this.currentFont??{};U4(t,i)&&(this.currentFont&&this.clearCurrentFont(),e&&(S(this,bc).setPersistent(e),this.currentFont=e))}clearCurrentFont(){if(!this.currentFont)return;const e=this.currentFont;[lm(),rk()].find(r=>U4(e,r))||S(this,bc).cancelPersistent(e),this.currentFont=void 0}async resolveFont(e){let t;if(S(this,bc).has(e))t=S(this,bc).get(e);else{const i=e.path||this.getFontPathInList(e.familyName,e.subfamilyName,e.source);i&&(t=await LLe(i,e).catch(r=>{Tt.error(r)}),t&&S(this,bc).set(e,t))}return t||Tt.warn("font is not available",e),t}_getCachedFont(e){return S(this,bc).get(e)}getFontPathInList(e,t,i){var r,s,o,a,l;if(this.fontList)return(l=(a=(o=(s=(r=this.fontList)==null?void 0:r[i])==null?void 0:s.fonts[e])==null?void 0:o.subFontFamilys)==null?void 0:a[t])==null?void 0:l.path}getFont(e){var t,i,r,s,o;return(o=(s=(r=(i=(t=this.fontList)==null?void 0:t[e.fontSource])==null?void 0:i.fonts)==null?void 0:r[e.fontFamily])==null?void 0:s.subFontFamilys)==null?void 0:o[e.fontSubfamily]}getSubstitutedFontData(e){if(!this.fontList||this.getFont(e))return;let t,i;for(const r of Object.values(Ar))if(r!==e.fontSource&&(i={...e,fontSource:r},t=this.getFont(i),t))return i;return i=G4(),i}_charKeyOf(e,t){return[e,[t.familyName,t.subfamilyName].join("|")].join("|")}_fontKeyOf(e){return`[${e.familyName??""},${e.subfamilyName??""}],${e.source}`}async _resolveCharGlyph(e,t,i){var s;const r=e.codePointAt(0);if(r!==void 0)try{let o;for(const a of i){const l=NLe(a),c=this.getFont(l);if((c==null?void 0:c.characterSet)instanceof Set&&(c==null?void 0:c.characterSet.size)>0&&!((s=c==null?void 0:c.characterSet)!=null&&s.has(r)))continue;const u=await this.resolveFont(a);if(u){if(c&&!c.characterSet)try{c.characterSet=new Set(u.characterSet)}catch(m){Tt.error(m)}const h=u.hasGlyphForCodePoint(r),d=u.glyphForCodePoint(r),f=B4(d,T1(u),t);if(!f){Tt.warn("ignore empty glyphData  for",{char:e});continue}const p=!!f.dPath,g={fontData:a,glyphData:f,hasDef:h,isVisible:p};if(h&&(p||/\s+/.test(e)))return g;!o&&p&&(o=g)}}return o}catch(o){Tt.error("fail resolve glyph",o)}}_getGlyphSync(e,t,i){const r=e.codePointAt(0);if(r!==void 0)try{let s;for(const o of i){const a=this._getCachedFont(o);if(a){const l=a.hasGlyphForCodePoint(r),c=a.glyphForCodePoint(r),u=B4(c,T1(a),t);if(!u){Tt.warn("ignore empty glyphData  for",{char:e});continue}const h=!!u.dPath,d={fontData:o,glyphData:u,hasDef:l,isVisible:h};if(l)return d;!s&&h&&(s=d)}}return s}catch(s){Tt.error("fail get glyph",s)}}*fontsForSearchGlyph(e){var o;e&&(yield e),yield lm(),yield*DLe();const t=((o=this.fonts)==null?void 0:o.sortedFontsByNumGlyphs)??this.iterateFonts([Ar.SYSTEM]),i=30,r=new Set;let s=0;for(const a of t){const l=a.familyName;!l.startsWith("Noto")&&s>i||r.has(l)||(r.add(l),yield{familyName:l,subfamilyName:a.subfamilyName,source:a.source},s++)}}getFamilyItem(e){var t,i,r;return(r=(i=(t=this.fontList)==null?void 0:t[e.fontSource])==null?void 0:i.fonts)==null?void 0:r[e.fontFamily]}async preloadFontAndGlyphs(e,t){try{const i=Dv({style:t}),r=ok(i);this.setCurrentFont(r),await this.resolveFont(r).catch(console.warn);for(const s of e)s&&typeof s=="string"&&await this.preloadTextGlyphs({...i,text:s})}catch(i){console.warn(i)}}async preloadFontAndGlyphsForObjs(e){try{for(const t of e)if(t.type===it.TEXT){const i=t,r=Dv(i),s=i.text;await this.preloadTextGlyphs({...r,text:s})}}catch(t){console.warn(t)}}getSubFontByName(e,t){var a,l,c,u;if(!this.fontList)return;const{nameType:i,source:r}=t??{},s=r?Array.isArray(r)?r:[r]:[Ar.SYSTEM,Ar.BUILD_IN],o=i?Array.isArray(i)?i:[i]:["postscriptName","fullName"];for(const h of s){const d=(a=this.fontList)==null?void 0:a[h];if(!d)continue;let f;for(const p of o)if(p==="postscriptName"?f=(c=(l=d.postscriptNames)==null?void 0:l.get)==null?void 0:c.call(l,e):p==="fullName"&&(f=(u=d.fullNames)==null?void 0:u.get(e)),f)return f}}*searchSubFontByFontFamily(e){var r,s,o;if(!this.fontList)return;const t=Array.isArray(e)?e:[e],i=[Ar.SYSTEM,Ar.BUILD_IN];for(const a of t)for(const l of i){const c=(o=(s=(r=this.fontList)==null?void 0:r[l])==null?void 0:s.fonts)==null?void 0:o[a];let u;if(c)u=Object.values(c.subFontFamilys);else{const h=this.getSubFontByName(a,{source:l});h&&(u=[].concat(h))}u!=null&&u.length&&(yield{fontSource:l,subFamilyItems:u})}}fuzzyMatchFontByCssStyle(e){var a;const t=(((a=e["font-family"])==null?void 0:a.split(/\s*,\s*/))??[]).map(l=>{var c;return(c=l==null?void 0:l.replace)==null?void 0:c.call(l,/['"]/g,"")});let i=e["font-weight"];i==="normal"?i=400:i==="bold"?i=700:typeof Number(i)=="number"?i=Number(i):i=400;let r=e["font-stretch"];r in N4&&(r=N4[r]);const s=e["font-style"];let o;for(const{fontSource:l,subFamilyItems:c}of this.searchSubFontByFontFamily(t)){let u=c;if(!(u!=null&&u.length)||((u==null?void 0:u.length)>1&&(u=this._searchSubfamilyByFontWeight(u,i)),!(u!=null&&u.length))||((u==null?void 0:u.length)>1&&(u=this._searchSubfamilyByFontStyle(u,s)),!(u!=null&&u.length))||((u==null?void 0:u.length)>1&&(u=this._searchSubfamilyByFontStretch(u,r)),!(u!=null&&u.length)))continue;const h=s==="normal"?0:u.length-1,d=u[h];if(d){o={fontSource:l,fontFamily:d.familyName,fontSubfamily:d.subfamilyName};break}}return!o&&t.includes(lm().familyName)&&(o=G4()),o??null}_searchSubfamilyByFontStyle(e,t){var a,l,c,u,h,d,f,p;let i,r,s;for(const g of e)t==="normal"?!((l=(a=g==null?void 0:g["OS/2"])==null?void 0:a.fsSelection)!=null&&l.italic)&&!((u=(c=g==null?void 0:g["OS/2"])==null?void 0:c.fsSelection)!=null&&u.oblique)&&(i||(i=[]),i.push(g)):((d=(h=g==null?void 0:g["OS/2"])==null?void 0:h.fsSelection)!=null&&d.italic&&(r||(r=[]),r.push(g)),(p=(f=g==null?void 0:g["OS/2"])==null?void 0:f.fsSelection)!=null&&p.oblique&&(r||(r=[]),r.push(g)));return(t==="normal"?i:t==="italic"?r??s:t==="oblique"?s??r:void 0)??e}_searchSubfamilyByFontWeight(e,t){let i;const r=Object.entries(Fr(e,s=>{var o;return(o=s==null?void 0:s["OS/2"])==null?void 0:o.usWeightClass})).sort((s,o)=>Number(s[0])-Number(o[0]));for(let s=0;s<r.length;s++){const o=Number(r[s][0]);if(o===t){i=r[s][1];break}if(o>t){t<400&&(i=r[s>0?s-1:s][1]),t>500&&(i=r[s][1]),o>500&&(i=r[s>0?s-1:s][1]),i=r[s][1];break}}return i!=null&&i.length||(i=r[r.length-1][1]),i??e}_searchSubfamilyByFontStretch(e,t){let i;const r=Object.entries(Fr(e,s=>{var o;return(o=s==null?void 0:s["OS/2"])==null?void 0:o.usWidthClass})).sort((s,o)=>Number(s[0]??1/0)-Number(o[0]??1/0));for(let s=0;s<r.length;s++)if(r[s][0]>=t){i=r[s][1];break}return i!=null&&i.length||(i=r[r.length-1][1]),i??e}}bc=new WeakMap;function OLe(n,e,t){if(!n)return;let i;if(n.type==="TTC"&&Array.isArray(n.fonts))i=n.fonts.find(r=>{const{subfamilyName:s}=Ly(r,r.type,"")||{};return s===t});else{const{subfamilyName:r}=Ly(n,n.type,"")||{};n.fvar?(z7(n),i=n.getVariation(t)):r===t&&(i=n)}return i||Tt.warn(`There has no actual font of [${e}, ${t}]`),i}function B4(n,e=1e3,t=sk){var h,d;if(!n)return;let i=0,r=0,s=0,o=0;const a={minX:0,minY:0,maxX:0,maxY:0};try{a.minX=n.bbox.minX,a.minY=n.bbox.minY,a.maxX=n.bbox.maxX,a.maxY=n.bbox.maxY,i=n.advanceWidth,r=n.advanceHeight,s=((h=n._metrics)==null?void 0:h.leftBearing)??0,o=((d=n._metrics)==null?void 0:d.topBearing)??0}catch(f){Tt.error(f),i||(i=a.maxX-a.minX+e*.1),r||(r=a.maxY-a.minY+e*.1)}const l=1/e*t,c=n.getScaledPath(t).scale(1,-1).toSVG();return Object.keys(a).forEach(f=>{a[f]=a[f]*l}),{dPath:c,advanceWidth:i*l,advanceHeight:r*l,leftBearing:s*l,topBearing:o*l,bbox:a}}async function LLe(n,e){if(!n)return;const t=await R2(n);let i=await W7(t);return i&&(i=OLe(i,e.familyName,e.subfamilyName)),i}async function F4(n,e){var i,r;if(!n)return;const t=new FontFace(n,e);t.load(),(r=(i=globalThis==null?void 0:globalThis.document)==null?void 0:i.fonts)!=null&&r.add&&globalThis.document.fonts.add(t)}function U4(n,e){return n&&e&&n.familyName===e.familyName&&n.subfamilyName===e.subfamilyName&&n.source===e.source}function Dv(n){const e={fontFamily:"",fontSubfamily:"",fontSource:""},t=n.style;return t&&(e.fontFamily=(Array.isArray(t.fontFamily)?t.fontFamily[0]:t.fontFamily)??"",e.fontSubfamily=t.fontSubfamily??"",e.fontSource=t.fontSource??""),e}function ok(n){return{familyName:n.fontFamily,subfamilyName:n.fontSubfamily,source:n.fontSource}}function NLe(n){return{fontFamily:n.familyName,fontSubfamily:n.subfamilyName,fontSource:n.source}}function T1(n){try{return n.unitsPerEm}catch(e){return console.warn(e),1e3}}function G4(){const n=lm();return{fontSource:n.source,fontFamily:n.familyName,fontSubfamily:n.subfamilyName}}const Q7="FontRecordCache";async function BLe(){let n;try{const e=localStorage.getItem(Q7);if(e){const t=JSON.parse(e);t.appVersion===(GT??"")&&(n=Object.fromEntries(t.fonts.map(([i,r])=>[i,new Map(r)])))}}catch(e){Tt.error(e)}return n}async function FLe(n){if(n)try{const e={appVersion:GT??"",fonts:Object.entries(n).map(([i,r])=>[i,[...r.entries()]])},t=JSON.stringify(e);localStorage.setItem(Q7,t)}catch(e){Tt.error(e)}}function ULe(n){var i;const{displays:e}=n||{},t=Wv.groupBy(e,"groupTag");for(const r in t)if(t[r]){const s=t[r];if(s.length===1){const o=s[0];o.groupTag=(i=o.groupTag)==null?void 0:i.replace("g-","")}}return n}var ak=(n=>(n.REPLACE_FONT="replace-font",n.TO_PATHS="to-paths",n))(ak||{});const H4="0.0.0.0",lk="#444444";function GLe(n){return n.layerTag===lk&&(n.layerTag=nA,n.layerColor=nA),n}function HLe(n){if(n.layerData){const e=n.layerData[lk];e&&(n.layerData[nA]=e,delete n.layerData[lk])}return n}function VLe(n,e,t,i,r){var c;let s=!1,o=!0;const a=new Set,l=new Set;for(let u=0;u<n.length;u++){const h={};let d=n[u];r!==H4&&yv(r,"2.0.0")<0&&(d=ULe(d)),d=HLe(d),(c=d==null?void 0:d.displays)==null||c.forEach((f,p)=>{var m,v;if(f.layerTag===void 0||f.layerColor===void 0){const _=WLe(f,i);f.layerTag=_,f.layerColor=_}if(f=GLe(f),f.type===i.TEXT){let _=f;t.isTextNeededAdapt(_)&&(_=Object.assign(_,t.adaptMText(_)),s=!0),o&&!t.detectSupportTextToPath(_)&&(o=!1),(m=_.style)!=null&&m.fontSource||(_.style.fontSource=Ar.SYSTEM),r!==H4&&yv(r,"1.3.0")<0&&jLe(_);const y=Dv(_);e.getFont(y)||(a.add(y.fontFamily),l.add({canvasIndex:u,canvasId:n[u].id,displayIndex:p,text:_,fontAttrs:y}))}const{groupTag:g}=f;if(g!=null&&g.startsWith("g-")){const _=((v=n[u])==null?void 0:v.groupData)??{},{groupName:y="",visible:A=!0,enableTransform:w=!0,zOrder:b}=_[g]??{};h[g]={groupName:y,groupTag:g,visible:A,enableTransform:w,zOrder:b}}typeof f.visibleState>"u"&&(f.visibleState=f.visible),typeof f.enableTransform>"u"&&(f.enableTransform=!0),typeof f.lockState>"u"&&(f.lockState=!f.enableTransform)}),d.groupData=h,n[u]=d}return{hasBetaText:s,supportTextToPath:o,lossFonts:a,lossFontTextInfos:l}}function V4(n,e){const t=new Map;for(const{text:i,fontAttrs:r}of n){const s=[r.fontSource,r.fontFamily,r.fontSubfamily].join(";");let o;t.has(s)?o=t.get(s):(o=e.getSubstitutedFontData(r),t.set(s,o)),o&&(i.style.fontFamily=o.fontFamily,i.style.fontSubfamily=o.fontSubfamily,i.style.fontSource=o.fontSource)}}function zLe(n,e,t,i=!0){const r=[];for(const{text:s,canvasIndex:o,displayIndex:a}of n){const l=t.convertTextJSONToPathJSONs(s),c=e[o];i&&c.displays&&(c.displays[a]=l),r.push({canvasId:c.id,text:s,paths:l})}if(i)for(const s of e)s.displays&&(s.displays=s.displays.flat());return r}async function $Le(n,e,t){const i=[];if(n.forEach(r=>{var s;(s=r==null?void 0:r.displays)==null||s.forEach(o=>{if(o.type===t.TEXT){const a=o;i.push({...Dv(a),text:a.text})}})}),i.length)for(const r of i)await e.preloadTextGlyphs(r)}function WLe(n,e){const t=VO,i=gj,r=nA,s={16421416:t,10036991:i,2597107:i};return n.type===e.BITMAP?t:n.lineColor!==void 0&&n.lineColor in s?s[n.lineColor]:r}function jLe(n){n.style.leading&&(n.style.leading*=n.scale.y),n.style.letterSpacing&&(n.style.letterSpacing*=n.scale.y)}class QLe{async resize(e){const{bitmapMode:t,extraPath:i,oWidth:r,oHeight:s,destWidth:o,destHeight:a}=e;let l=i;return l=await window.MeApi.wasmKit.bitmap_dataToGray(l),l=await window.MeApi.wasmKit.bitmap_resize(l,r,s,o,a),t.toLowerCase()!==sL.Grayscale&&(l=await window.MeApi.wasmKit.bitmap_calDataWithMode(t,l,o,a,127)),l=await window.MeApi.wasmKit.bitmap_grayDataToImg(l,o,a),l}}function XLe(n){return new Worker(""+new URL("../assets/clipperWorker-wYew2Nyb.js",import.meta.url).href,{name:n==null?void 0:n.name})}class YLe extends t_{constructor(){super(XLe)}boolCalculate(e){return this.request({type:"boolCalculate",data:e})}scaleOffsetPoints(e){return this.request({type:"scaleOffsetPoints",data:e})}area(e){return this.request({type:"area",data:e})}}var X7={},k2={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e={verbose:!1};n.default=e})(k2);var O2={},Y7={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i){var r,s={};return i.forEach(function(o){var a=o[0],l=o[1];switch(l){case"$MEASUREMENT":{r="measurement";break}case"$INSUNITS":{r="insUnits";break}case"$EXTMIN":s.extMin={},r="extMin";break;case"$EXTMAX":s.extMax={},r="extMax";break;case"$DIMASZ":s.dimArrowSize={},r="dimArrowSize";break;default:switch(r){case"extMin":case"extMax":{switch(a){case 10:s[r].x=l;break;case 20:s[r].y=l;break;case 30:s[r].z=l,r=void 0;break}break}case"measurement":case"insUnits":{switch(a){case 70:{s[r]=l,r=void 0;break}}break}case"dimArrowSize":{switch(a){case 40:{s[r]=l,r=void 0;break}}break}}}}),s};n.default=e})(Y7);var q7={},Qc={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(k2);function t(a){return a&&a.__esModule?a:{default:a}}function i(){e.default.verbose&&console.info.apply(void 0,arguments)}function r(){e.default.verbose&&console.warn.apply(void 0,arguments)}function s(){console.error.apply(void 0,arguments)}var o={info:i,warn:r,error:s};n.default=o})(Qc);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(Qc);function t(c){return c&&c.__esModule?c:{default:c}}var i=function(u){var h=null,d=null;return u.reduce(function(f,p){var g=p[0],m=p[1];switch(g){case 2:f.name=m;break;case 3:f.description=m;break;case 70:f.flag=m;break;case 72:f.alignment=m;break;case 73:f.elementCount=parseInt(m);break;case 40:f.patternLength=m;break;case 49:h=Object.create({scales:[],offset:[]}),h.length=m,f.pattern.push(h);break;case 74:h.shape=m;break;case 75:h.shapeNumber=m;break;case 340:h.styleHandle=m;break;case 46:h.scales.push(m);break;case 50:h.rotation=m;break;case 44:d=Object.create({x:m,y:0}),h.offset.push(d);break;case 45:d.y=m;break;case 9:h.text=m;break}return f},{type:"LTYPE",pattern:[]})},r=function(u){return u.reduce(function(h,d){var f=d[0],p=d[1];switch(f){case 2:h.name=p;break;case 6:h.lineTypeName=p;break;case 62:h.colorNumber=p;break;case 70:h.flags=p;break;case 290:h.plot=parseInt(p)!==0;break;case 370:h.lineWeightEnum=p;break}return h},{type:"LAYER"})},s=function(u){return u.reduce(function(h,d){var f=d[0],p=d[1];switch(f){case 2:h.name=p;break;case 6:h.lineTypeName=p;break;case 40:h.fixedTextHeight=p;break;case 41:h.widthFactor=p;break;case 50:h.obliqueAngle=p;break;case 71:h.flags=p;break;case 42:h.lastHeightUsed=p;break;case 3:h.primaryFontFileName=p;break;case 4:h.bigFontFileName=p;break}return h},{type:"STYLE"})},o=function(u){return u.reduce(function(h,d){var f=d[0],p=d[1];switch(f){case 2:h.name=p;break;case 5:h.handle=p;break;case 70:h.flags=p;break;case 10:h.lowerLeft.x=parseFloat(p);break;case 20:h.lowerLeft.y=parseFloat(p);break;case 11:h.upperRight.x=parseFloat(p);break;case 21:h.upperRight.y=parseFloat(p);break;case 12:h.center.x=parseFloat(p);break;case 22:h.center.y=parseFloat(p);break;case 14:h.snapSpacing.x=parseFloat(p);break;case 24:h.snapSpacing.y=parseFloat(p);break;case 15:h.gridSpacing.x=parseFloat(p);break;case 25:h.gridSpacing.y=parseFloat(p);break;case 16:h.direction.x=parseFloat(p);break;case 26:h.direction.y=parseFloat(p);break;case 36:h.direction.z=parseFloat(p);break;case 17:h.target.x=parseFloat(p);break;case 27:h.target.y=parseFloat(p);break;case 37:h.target.z=parseFloat(p);break;case 45:h.height=parseFloat(p);break;case 50:h.snapAngle=parseFloat(p);break;case 51:h.angle=parseFloat(p);break;case 110:h.x=parseFloat(p);break;case 120:h.y=parseFloat(p);break;case 130:h.z=parseFloat(p);break;case 111:h.xAxisX=parseFloat(p);break;case 121:h.xAxisY=parseFloat(p);break;case 131:h.xAxisZ=parseFloat(p);break;case 112:h.xAxisX=parseFloat(p);break;case 122:h.xAxisY=parseFloat(p);break;case 132:h.xAxisZ=parseFloat(p);break;case 146:h.elevation=parseFloat(p);break}return h},{type:"VPORT",center:{},lowerLeft:{},upperRight:{},snap:{},snapSpacing:{},gridSpacing:{},direction:{},target:{}})},a=function(u,h,d){var f=[],p;return u.forEach(function(g){var m=g[0],v=g[1];(m===0||m===2)&&v===h?(p=[],f.push(p)):p.push(g)}),f.reduce(function(g,m){var v=d(m);return v.name?g[v.name]=v:e.default.warn("table row without name:",v),g},{})},l=function(u){var h=[],d;u.forEach(function(v){var _=v[1];_==="TABLE"?(d=[],h.push(d)):_==="ENDTAB"?h.push(d):d.push(v)});var f=[],p=[],g=[],m=[];return h.forEach(function(v){v[0][1]==="STYLE"?f=v:v[0][1]==="LTYPE"?m=v:v[0][1]==="LAYER"?p=v:v[0][1]==="VPORT"&&(g=v)}),{layers:a(p,"LAYER",r),styles:a(f,"STYLE",s),vports:a(g,"VPORT",o),ltypes:a(m,"LTYPE",i)}};n.default=l})(q7);var K7={},L2={},J7={},As={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i,r){switch(i){case 5:return{handle:r};case 6:return{lineTypeName:r};case 8:return{layer:r};case 48:return{lineTypeScale:r};case 60:return{visible:r===0};case 62:return{colorNumber:r};case 67:return r===0?{}:{paperSpace:r};case 68:return{viewportOn:r};case 69:return{viewport:r};case 210:return{extrusionX:r};case 220:return{extrusionY:r};case 230:return{extrusionZ:r};case 410:return{layout:r};default:return{}}};n.default=e})(As);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="POINT";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 10:l.x=h;break;case 20:l.y=h;break;case 30:l.z=h;break;case 39:l.thickness=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i})};n.process=r;var s={TYPE:i,process:r};n.default=s})(J7);var Z7={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="LINE";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 10:l.start.x=h;break;case 20:l.start.y=h;break;case 30:l.start.z=h;break;case 39:l.thickness=h;break;case 11:l.end.x=h;break;case 21:l.end.y=h;break;case 31:l.end.z=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i,start:{},end:{}})};n.process=r;var s={TYPE:i,process:r};n.default=s})(Z7);var eq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="LWPOLYLINE";n.TYPE=i;var r=function(a){var l;return a.reduce(function(c,u){var h=u[0],d=u[1];switch(h){case 70:c.closed=(d&1)===1;break;case 10:l={x:d,y:0},c.vertices.push(l);break;case 20:l.y=d;break;case 39:c.thickness=d;break;case 42:l.bulge=d;break;default:Object.assign(c,(0,e.default)(h,d));break}return c},{type:i,vertices:[]})};n.process=r;var s={TYPE:i,process:r};n.default=s})(eq);var tq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="POLYLINE";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 70:l.closed=(h&1)===1,l.polygonMesh=(h&16)===16,l.polyfaceMesh=(h&64)===64;break;case 39:l.thickness=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i,vertices:[]})};n.process=r;var s={TYPE:i,process:r};n.default=s})(tq);var nq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e="VERTEX";n.TYPE=e;var t=function(s){return s.reduce(function(o,a){var l=a[0],c=a[1];switch(l){case 10:o.x=c;break;case 20:o.y=c;break;case 30:o.z=c;break;case 42:o.bulge=c;break}return o},{})};n.process=t;var i={TYPE:e,process:t};n.default=i})(nq);var iq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="CIRCLE";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 10:l.x=h;break;case 20:l.y=h;break;case 30:l.z=h;break;case 40:l.r=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i})};n.process=r;var s={TYPE:i,process:r};n.default=s})(iq);var rq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="ARC";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 10:l.x=h;break;case 20:l.y=h;break;case 30:l.z=h;break;case 39:l.thickness=h;break;case 40:l.r=h;break;case 50:l.startAngle=h/180*Math.PI;break;case 51:l.endAngle=h/180*Math.PI;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i})};n.process=r;var s={TYPE:i,process:r};n.default=s})(rq);var sq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="ELLIPSE";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 10:l.x=h;break;case 11:l.majorX=h;break;case 20:l.y=h;break;case 21:l.majorY=h;break;case 30:l.z=h;break;case 31:l.majorZ=h;break;case 40:l.axisRatio=h;break;case 41:l.startAngle=h;break;case 42:l.endAngle=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i})};n.process=r;var s={TYPE:i,process:r};n.default=s})(sq);var oq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="SPLINE";n.TYPE=i;var r=function(a){var l;return a.reduce(function(c,u){var h=u[0],d=u[1];switch(h){case 10:l={x:d,y:0},c.controlPoints.push(l);break;case 20:l.y=d;break;case 30:l.z=d;break;case 40:c.knots.push(d);break;case 41:c.weights||(c.weights=[]),c.weights.push(d);break;case 42:c.knotTolerance=d;break;case 43:c.controlPointTolerance=d;break;case 44:c.fitTolerance=d;break;case 70:c.flag=d,c.closed=(d&1)===1;break;case 71:c.degree=d;break;case 72:c.numberOfKnots=d;break;case 73:c.numberOfControlPoints=d;break;case 74:c.numberOfFitPoints=d;break;default:Object.assign(c,(0,e.default)(h,d));break}return c},{type:i,controlPoints:[],knots:[]})};n.process=r;var s={TYPE:i,process:r};n.default=s})(oq);var aq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="SOLID";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 10:l.corners[0].x=h;break;case 20:l.corners[0].y=h;break;case 30:l.corners[0].z=h;break;case 11:l.corners[1].x=h;break;case 21:l.corners[1].y=h;break;case 31:l.corners[1].z=h;break;case 12:l.corners[2].x=h;break;case 22:l.corners[2].y=h;break;case 32:l.corners[2].z=h;break;case 13:l.corners[3].x=h;break;case 23:l.corners[3].y=h;break;case 33:l.corners[3].z=h;break;case 39:l.thickness=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i,corners:[{},{},{},{}]})};n.process=r;var s={TYPE:i,process:r};n.default=s})(aq);var lq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(g){return g&&g.__esModule?g:{default:g}}var i="HATCH";n.TYPE=i;var r="IDLE",s={},o=0,a=!1,l=null,c={references:[],entities:[]},u=null,h=function(m){return m.reduce(function(v,_){var y=_[0],A=_[1];switch(y){case 100:r="IDLE";break;case 2:v.patternName=A;break;case 10:r==="IDLE"?v.elevation.x=parseFloat(A):r==="POLYLINE"?(u=Object.create({x:parseFloat(A),y:0,bulge:0}),c.entities[0].points.push(u)):r==="SEED"?(l||(l={x:0,y:0},v.seeds.seeds.push(l)),l.x=parseFloat(A)):p(y,o,parseFloat(A));break;case 20:r==="IDLE"?v.elevation.y=parseFloat(A):r==="POLYLINE"?u.y=parseFloat(A):r==="SEED"?(l.y=parseFloat(A),l=null):p(y,o,parseFloat(A));break;case 30:v.elevation.z=parseFloat(A);break;case 63:v.fillColor=A;break;case 70:v.fillType=parseFloat(A)===1?"SOLID":"PATTERN";break;case 210:v.extrusionDir.x=parseFloat(A);break;case 220:v.extrusionDir.y=parseFloat(A);break;case 230:v.extrusionDir.z=parseFloat(A);break;case 91:v.boundary.count=parseFloat(A);break;case 92:if(c={references:[],entities:[]},v.boundary.loops.push(c),c.type=parseFloat(A),a=(c.type&2)===2,a){var w={type:"POLYLINE",points:[]};c.entities.push(w),r="POLYLINE"}break;case 93:r==="IDLE"&&(r="ENT"),c.count=parseFloat(A);break;case 11:case 21:case 40:case 50:case 51:case 74:case 94:case 95:case 96:p(y,o,parseFloat(A));break;case 42:a?u.bulge=parseFloat(A):p(y,o,parseFloat(A));break;case 72:o=parseFloat(A),c[a?"hasBulge":"edgeType"]=o,a||(s=f(o),c.entities.push(s));break;case 73:r==="IDLE"||a?c.entities[0].closed=A:p(y,o,parseFloat(A));break;case 75:r="IDLE",v.style=parseFloat(A);break;case 76:v.hatchType=parseFloat(A);break;case 97:r="IDLE",a=!1,c.sourceObjects=parseFloat(A);break;case 98:r="SEED",v.seeds.count=parseFloat(A);break;case 52:v.shadowPatternAngle=parseFloat(A);break;case 41:v.spacing=parseFloat(A);break;case 77:v.double=parseFloat(A)===1;break;case 78:v.pattern.lineCount=parseFloat(A);break;case 53:v.pattern.angle=parseFloat(A);break;case 43:v.pattern.x=parseFloat(A);break;case 44:v.pattern.y=parseFloat(A);break;case 45:v.pattern.offsetX=parseFloat(A);break;case 46:v.pattern.offsetY=parseFloat(A);break;case 79:v.pattern.dashCount=parseFloat(A);break;case 49:v.pattern.length.push(A);break;case 330:c.references.push(A);break;case 450:v.solidOrGradient=parseFloat(A)===0?"SOLID":"GRADIENT";break;case 453:v.color.count=parseFloat(A);break;case 460:v.color.rotation=A;break;case 461:v.color.gradient=A;break;case 462:v.color.tint=A;break;default:Object.assign(v,(0,e.default)(y,A));break}return v},{type:i,elevation:{},extrusionDir:{x:0,y:0,z:1},pattern:{length:[]},boundary:{loops:[]},seeds:{count:0,seeds:[]},color:{}})};n.process=h;var d={TYPE:i,process:h};n.default=d;function f(g){if(a)return{};switch(g){case 1:return{type:"LINE",start:{x:0,y:0},end:{x:0,y:0}};case 2:return{type:"ARC",center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,counterClockWise:!1};case 3:return{type:"ELLIPSE",center:{x:0,y:0},startAngle:0,endAngle:0,counterClockWise:!1,major:{x:0,y:0},minor:0};case 4:return{type:"SPLINE",degree:0,rational:0,periodic:0,knots:{count:0,knots:[]},controlPoints:{count:0,point:{x:0,y:0}},weights:1}}return{}}function p(g,m,v){switch(g){case 10:switch(m){case 1:s.start.x=v;break;case 2:s.center.x=v;break;case 3:s.center.x=v;break;case 4:s.controlPoints.point.x=v;break}break;case 20:{switch(m){case 1:s.start.y=v;break;case 2:s.center.y=v;break;case 3:s.center.y=v;break;case 4:s.controlPoints.point.y=v;break}break}case 11:switch(m){case 1:s.end.x=v;break;case 3:s.major.x=v;break}break;case 21:{switch(m){case 1:s.end.y=v;break;case 3:s.major.y=v;break}break}case 40:switch(m){case 2:s.radius=v;break;case 3:s.minor=v;break;case 4:s.knots.knots.push(v);break}break;case 42:switch(m){case 4:s.weights=v;break}break;case 50:switch(m){case 2:s.startAngle=v;break;case 3:s.startAngle=v;break}break;case 51:switch(m){case 2:s.endAngle=v;break;case 3:s.endAngle=v;break}break;case 73:switch(m){case 2:s.counterClockWise=parseFloat(v)===1;break;case 3:s.counterClockWise=parseFloat(v)===1;break;case 4:s.rational=v;break}break;case 74:switch(m){case 4:s.periodic=v;break}break;case 94:switch(m){case 4:s.degree=v;break}break;case 95:switch(m){case 4:s.knots.count=v;break}break;case 96:switch(m){case 4:s.controlPoints.count=v;break}break}}})(lq);var N2={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.assign=n.TYPE=void 0;var e=t(As);function t(l){return l&&l.__esModule?l:{default:l}}var i="MTEXT";n.TYPE=i;var r={10:"x",20:"y",30:"z",40:"nominalTextHeight",41:"refRectangleWidth",71:"attachmentPoint",72:"drawingDirection",7:"styleName",11:"xAxisX",21:"xAxisY",31:"xAxisZ",42:"horizontalWidth",43:"verticalHeight",73:"lineSpacingStyle",44:"lineSpacingFactor",90:"backgroundFill",420:"bgColorRGB0",421:"bgColorRGB1",422:"bgColorRGB2",423:"bgColorRGB3",424:"bgColorRGB4",425:"bgColorRGB5",426:"bgColorRGB6",427:"bgColorRGB7",428:"bgColorRGB8",429:"bgColorRGB9",430:"bgColorName0",431:"bgColorName1",432:"bgColorName2",433:"bgColorName3",434:"bgColorName4",435:"bgColorName5",436:"bgColorName6",437:"bgColorName7",438:"bgColorName8",439:"bgColorName9",45:"fillBoxStyle",63:"bgFillColor",441:"bgFillTransparency",75:"columnType",76:"columnCount",78:"columnFlowReversed",79:"columnAutoheight",48:"columnWidth",49:"columnGutter",50:"columnHeights"},s=function(c){return c.reduce(function(u,h){var d=h[0],f=h[1];return o(u,d,f),u},{type:i,string:""})};n.process=s;var o=function(c,u,h){return r[u]!==void 0?c[r[u]]=h:u===1||u===3?c.string+=h:u===50?(c.xAxisX=Math.cos(h),c.xAxisY=Math.sin(h)):Object.assign(c,(0,e.default)(u,h)),c};n.assign=o;var a={TYPE:i,process:s,assign:o};n.default=a})(N2);var B2={},F2={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.assign=n.TYPE=void 0;var e=t(As);function t(l){return l&&l.__esModule?l:{default:l}}var i="TEXT";n.TYPE=i;var r={1:"string",10:"x",20:"y",30:"z",11:"x2",21:"y2",31:"z2",39:"thickness",40:"textHeight",41:"relScaleX",50:"rotation",51:"obliqueAngle",7:"styleName",71:"mirror",72:"hAlign",73:"vAlign"},s=function(c){return c.reduce(function(u,h){var d=h[0],f=h[1];return o(u,d,f),u},{type:i,string:""})};n.process=s;var o=function(c,u,h){r[u]!==void 0?c[r[u]]=h:Object.assign(c,(0,e.default)(u,h))};n.assign=o;var a={TYPE:i,process:s,assign:o};n.default=a})(F2);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.assign=n.TYPE=void 0;var e=r(As),t=N2,i=F2;function r(c){return c&&c.__esModule?c:{default:c}}var s="ATTDEF";n.TYPE=s;var o=function(u){return u.reduce(function(h,d){var f=d[0],p=d[1];return a(h,f,p),h},{type:s,subclassMarker:"AcDbText",thickness:0,scaleX:1,mtext:{},text:{}})};n.process=o;var a=function(u,h,d){switch(h){case 100:{u.subclassMarker=d;break}case 1:switch(u.subclassMarker){case"AcDbText":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 2:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":u.tag=d;break;case"AcDbXrecord":u.attdefFlag=d;break}break;case 3:switch(u.subclassMarker){case"AcDbAttributeDefinition":u.prompt=d;break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 7:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 10:switch(u.subclassMarker){case"AcDbText":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break;case"AcDbXrecord":u.x=d;break}break;case 20:switch(u.subclassMarker){case"AcDbText":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break;case"AcDbXrecord":u.y=d;break}break;case 30:switch(u.subclassMarker){case"AcDbText":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break;case"AcDbXrecord":u.z=d;break}break;case 11:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":u.x2=d;break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 21:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":u.y2=d;break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 31:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":u.z2=d;break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 39:(0,i.assign)(u.text,h,d);break;case 40:switch(u.subclassMarker){case"AcDbText":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break;case"AcDbXrecord":u.annotationScale=d;break}break;case 41:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 42:case 43:case 44:case 45:(0,t.assign)(u.mtext,h,d);break;case 46:u.mtext.annotationHeight=d;break;case 48:case 49:(0,t.assign)(u.mtext,h,d);break;case 50:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 51:(0,i.assign)(u.text,h,d);break;case 63:(0,t.assign)(u.mtext,h,d);break;case 70:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":u.attributeFlags=d;break;case"AcDbXrecord":typeof u.mTextFlag>"u"?u.mTextFlag=d:typeof u.isReallyLocked>"u"?u.isReallyLocked=d:u.secondaryAttdefCount=d;break}break;case 71:case 72:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,i.assign)(u.text,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 73:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":u.fieldLength=d;break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 74:(0,i.assign)(u.text,73,d);break;case 75:case 76:case 78:case 79:(0,t.assign)(u.mtext,h,d);break;case 90:(0,t.assign)(u.mtext,h,d);break;case 210:case 220:case 230:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":(0,i.assign)(u.mtext,h,d);break;case"AcDbMText":(0,t.assign)(u.mtext,h,d);break}break;case 280:switch(u.subclassMarker){case"AcDbAttributeDefinition":case"AcDbAttribute":u.lock=d;break;case"AcDbXrecord":u.clone=!0;break}break;case 340:u.attdefHandle=d;break;case 420:case 421:case 422:case 423:case 424:case 425:case 426:case 427:case 428:case 429:case 430:case 431:case 432:case 433:case 434:case 435:case 436:case 437:case 438:case 439:case 441:(0,t.assign)(u.mtext,h,d);break;default:Object.assign(u,(0,e.default)(h,d));break}};n.assign=a;var l={TYPE:s,process:o,assign:a};n.default=l})(B2);var cq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=B2,t="ATTRIB";n.TYPE=t;var i=function(o){return o.reduce(function(a,l){var c=l[0],u=l[1];return(0,e.assign)(a,c,u),a},{type:t,subclassMarker:"AcDbText",thickness:0,scaleX:1,mtext:{},text:{}})};n.process=i;var r={TYPE:t,process:i};n.default=r})(cq);var uq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="INSERT";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 2:l.block=h;break;case 10:l.x=h;break;case 20:l.y=h;break;case 30:l.z=h;break;case 41:l.scaleX=h;break;case 42:l.scaleY=h;break;case 43:l.scaleZ=h;break;case 44:l.columnSpacing=h;break;case 45:l.rowSpacing=h;break;case 50:l.rotation=h;break;case 70:l.columnCount=h;break;case 71:l.rowCount=h;break;case 210:l.extrusionX=h;break;case 220:l.extrusionY=h;break;case 230:l.extrusionZ=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i})};n.process=r;var s={TYPE:i,process:r};n.default=s})(uq);var hq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="3DFACE";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 10:l.vertices[0].x=h;break;case 20:l.vertices[0].y=h;break;case 30:l.vertices[0].z=h;break;case 11:l.vertices[1].x=h;break;case 21:l.vertices[1].y=h;break;case 31:l.vertices[1].z=h;break;case 12:l.vertices[2].x=h;break;case 22:l.vertices[2].y=h;break;case 32:l.vertices[2].z=h;break;case 13:l.vertices[3].x=h;break;case 23:l.vertices[3].y=h;break;case 33:l.vertices[3].z=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i,vertices:[{},{},{},{}]})};n.process=r;var s={TYPE:i,process:r};n.default=s})(hq);var dq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(a){return a&&a.__esModule?a:{default:a}}var i="DIMENSION";n.TYPE=i;var r=function(l){return l.reduce(function(c,u){var h=u[0],d=u[1];switch(h){case 2:c.block=d;break;case 10:c.start.x=d;break;case 20:c.start.y=d;break;case 30:c.start.z=d;break;case 11:c.textMidpoint.x=d;break;case 21:c.textMidpoint.y=d;break;case 31:c.textMidpoint.z=d;break;case 13:c.measureStart.x=d;break;case 23:c.measureStart.y=d;break;case 33:c.measureStart.z=d;break;case 14:c.measureEnd.x=d;break;case 24:c.measureEnd.y=d;break;case 34:c.measureEnd.z=d;break;case 50:c.rotation=d;break;case 51:c.horizonRotation=d;break;case 52:c.extensionRotation=d;break;case 53:c.textRotation=d;break;case 70:{var f=s(d);f.ordinateType&&(c.ordinateType=!0),f.uniqueBlockReference&&(c.uniqueBlockReference=!0),f.userDefinedLocation&&(c.userDefinedLocation=!0),c.dimensionType=f.dimensionType;break}case 71:c.attachementPoint=d;break;case 210:c.extrudeDirection=c.extrudeDirection||{},c.extrudeDirection.x=d;break;case 220:c.extrudeDirection=c.extrudeDirection||{},c.extrudeDirection.y=d;break;case 230:c.extrudeDirection=c.extrudeDirection||{},c.extrudeDirection.z=d;break;default:Object.assign(c,(0,e.default)(h,d));break}return c},{type:i,start:{x:0,y:0,z:0},measureStart:{x:0,y:0,z:0},measureEnd:{x:0,y:0,z:0},textMidpoint:{x:0,y:0,z:0},attachementPoint:1,dimensionType:0})};n.process=r;function s(a){var l=!1,c=!1,u=!1;if(a>6){var h=a-32,d=a-64,f=a-32-64,p=a-32-128,g=a-32-64-128;h>=0&&h<=6?(l=!0,a=h):d>=0&&d<=6?(c=!0,a=d):f>=0&&f<=6?(l=!0,c=!0,a=f):p>=0&&p<=6?(l=!0,u=!0,a=p):g>=0&&g<=6&&(l=!0,c=!0,u=!0,a=g)}return{dimensionType:a,uniqueBlockReference:l,ordinateType:c,userDefinedLocation:u}}var o={TYPE:i,process:r};n.default=o})(dq);var fq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.process=n.default=n.TYPE=void 0;var e=t(As);function t(o){return o&&o.__esModule?o:{default:o}}var i="VIEWPORT";n.TYPE=i;var r=function(a){return a.reduce(function(l,c){var u=c[0],h=c[1];switch(u){case 1:l.layout=parseFloat(h);break;case 10:l.center.x=parseFloat(h);break;case 20:l.center.y=parseFloat(h);break;case 30:l.center.z=parseFloat(h);break;case 12:l.centerDCS.x=parseFloat(h);break;case 22:l.centerDCS.y=parseFloat(h);break;case 13:l.snap.x=parseFloat(h);break;case 23:l.snap.y=parseFloat(h);break;case 14:l.snapSpacing.x=parseFloat(h);break;case 24:l.snapSpacing.y=parseFloat(h);break;case 15:l.gridSpacing.x=parseFloat(h);break;case 25:l.gridSpacing.y=parseFloat(h);break;case 16:l.direction.x=parseFloat(h);break;case 26:l.direction.y=parseFloat(h);break;case 36:l.direction.z=parseFloat(h);break;case 17:l.target.x=parseFloat(h);break;case 27:l.target.y=parseFloat(h);break;case 37:l.target.z=parseFloat(h);break;case 40:l.width=parseFloat(h);break;case 41:l.height=parseFloat(h);break;case 50:l.snapAngle=parseFloat(h);break;case 51:l.angle=parseFloat(h);break;case 68:l.status=h;break;case 69:l.id=h;break;case 90:l.flags=h;break;case 110:l.x=parseFloat(h);break;case 120:l.y=parseFloat(h);break;case 130:l.z=parseFloat(h);break;case 111:l.xAxisX=parseFloat(h);break;case 121:l.xAxisY=parseFloat(h);break;case 131:l.xAxisZ=parseFloat(h);break;case 112:l.xAxisX=parseFloat(h);break;case 122:l.xAxisY=parseFloat(h);break;case 132:l.xAxisZ=parseFloat(h);break;case 146:l.elevation=parseFloat(h);break;case 281:l.render=h;break;default:Object.assign(l,(0,e.default)(u,h));break}return l},{type:i,center:{},centerDCS:{},snap:{},snapSpacing:{},gridSpacing:{},direction:{},target:{}})};n.process=r;var s={TYPE:i,process:r};n.default=s})(fq);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=w(Qc),t=w(J7),i=w(Z7),r=w(eq),s=w(tq),o=w(nq),a=w(iq),l=w(rq),c=w(sq),u=w(oq),h=w(aq),d=w(lq),f=w(N2),p=w(B2),g=w(cq),m=w(uq),v=w(hq),_=w(dq),y=w(F2),A=w(fq);function w(I){return I&&I.__esModule?I:{default:I}}var b=[t.default,i.default,r.default,s.default,o.default,a.default,l.default,c.default,u.default,h.default,d.default,f.default,p.default,g.default,y.default,m.default,_.default,v.default,A.default].reduce(function(I,x){return I[x.TYPE]=x,I},{}),C=function(x){var T=[],O=[],F;x.forEach(function(B){var R=B[0];R===0&&(F=[],O.push(F)),F.push(B)});var G;return O.forEach(function(B){var R=B[0][1],P=B.slice(1);if(b[R]!==void 0){var k=b[R].process(P);R==="POLYLINE"?(G=k,T.push(k)):R==="VERTEX"?G?G.vertices.push(k):e.default.error("ignoring invalid VERTEX entity"):R==="SEQEND"?G=void 0:T.push(k)}else e.default.warn("unsupported type in ENTITIES section:",R)}),T};n.default=C})(L2);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(L2);function t(r){return r&&r.__esModule?r:{default:r}}var i=function(s){var o,a=[],l,c=[];return s.forEach(function(u){var h=u[0],d=u[1];if(d==="BLOCK")o="block",l={},c=[],a.push(l);else if(d==="ENDBLK")o==="entities"?l.entities=(0,e.default)(c):l.entities=[],c=void 0,o=void 0;else if(o==="block"&&h!==0)switch(h){case 1:l.xref=d;break;case 2:l.name=d;break;case 10:l.x=d;break;case 20:l.y=d;break;case 30:l.z=d;break;case 67:d!==0&&(l.paperSpace=d);break;case 410:l.layout=d;break}else o==="block"&&h===0?(o="entities",c.push(u)):o==="entities"&&c.push(u)}),a};n.default=i})(K7);var pq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i){var r,s={layouts:[]},o={};return i.forEach(function(a,l){var c=a[0],u=a[1];if(c===0&&(r="IDLE"),u==="LAYOUT"&&(r="layout",o={},s.layouts.push(o)),r==="layout"&&c!==0)switch(c){case 100:u==="AcDbLayout"&&(r="AcDbLayout");break}if(r==="AcDbLayout"&&c!==0)switch(c){case 1:o.name=u;break;case 5:o.handle=u;break;case 10:o.minLimitX=parseFloat(u);break;case 20:o.minLimitY=parseFloat(u);break;case 11:o.maxLimitX=parseFloat(u);break;case 21:o.maxLimitY=parseFloat(u);break;case 12:o.x=parseFloat(u);break;case 22:o.y=parseFloat(u);break;case 32:o.z=parseFloat(u);break;case 14:o.minX=parseFloat(u);break;case 24:o.minY=parseFloat(u);break;case 34:o.minZ=parseFloat(u);break;case 15:o.maxX=parseFloat(u);break;case 25:o.maxY=parseFloat(u);break;case 35:o.maxZ=parseFloat(u);break;case 70:o.flag=u===1?"PSLTSCALE":"LIMCHECK";break;case 71:o.tabOrder=u;break;case 146:o.elevation=parseFloat(u);break;case 13:o.ucsX=parseFloat(u);break;case 23:o.ucsY=parseFloat(u);break;case 33:o.ucsZ=parseFloat(u);break;case 16:o.ucsXaxisX=parseFloat(u);break;case 26:o.ucsXaxisY=parseFloat(u);break;case 36:o.ucsXaxisZ=parseFloat(u);break;case 17:o.ucsYaxisX=parseFloat(u);break;case 27:o.ucsYaxisY=parseFloat(u);break;case 37:o.ucsYaxisZ=parseFloat(u);break;case 76:switch(u){case 0:o.ucsType="NOT ORTHOGRAPHIC";break;case 1:o.ucsType="TOP";break;case 2:o.ucsType="BOTTOM";break;case 3:o.ucsType="FRONT";break;case 4:o.ucsType="BACK";break;case 5:o.ucsType="LEFT";break;case 6:o.ucsType="RIGHT";break}break;case 330:o.tableRecord=u;break;case 331:o.lastActiveViewport=u;break;case 333:o.shadePlot=u;break}}),s};n.default=e})(pq);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=a(Y7),t=a(q7),i=a(K7),r=a(L2),s=a(pq),o=a(Qc);function a(m){return m&&m.__esModule?m:{default:m}}function l(m,v){var _=typeof Symbol<"u"&&m[Symbol.iterator]||m["@@iterator"];if(!_){if(Array.isArray(m)||(_=c(m))||v&&m&&typeof m.length=="number"){_&&(m=_);var y=0,A=function(){};return{s:A,n:function(){return y>=m.length?{done:!0}:{done:!1,value:m[y++]}},e:function(x){throw x},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w=!0,b=!1,C;return{s:function(){_=_.call(m)},n:function(){var x=_.next();return w=x.done,x},e:function(x){b=!0,C=x},f:function(){try{!w&&_.return!=null&&_.return()}finally{if(b)throw C}}}}function c(m,v){if(m){if(typeof m=="string")return u(m,v);var _=Object.prototype.toString.call(m).slice(8,-1);if(_==="Object"&&m.constructor&&(_=m.constructor.name),_==="Map"||_==="Set")return Array.from(m);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return u(m,v)}}function u(m,v){(v==null||v>m.length)&&(v=m.length);for(var _=0,y=new Array(v);_<v;_++)y[_]=m[_];return y}var h=function(v,_){return v>=10&&v<60||v>=210&&v<240?parseFloat(_,10):v>=60&&v<100?parseInt(_,10):_},d=function(v){var _="type",y,A=[],w=l(v),b;try{for(w.s();!(b=w.n()).done;){var C=b.value;_==="type"?(y=parseInt(C,10),_="value"):(A.push([y,h(y,C)]),_="type")}}catch(I){w.e(I)}finally{w.f()}return A},f=function(v){var _;return v.reduce(function(y,A){return A[0]===0&&A[1]==="SECTION"?_=[]:A[0]===0&&A[1]==="ENDSEC"?(y.push(_),_=void 0):_!==void 0&&_.push(A),y},[])},p=function(v,_){var y=_[0][1],A=_.slice(1);switch(y){case"HEADER":v.header=(0,e.default)(A);break;case"TABLES":v.tables=(0,t.default)(A);break;case"BLOCKS":v.blocks=(0,i.default)(A);break;case"ENTITIES":v.entities=(0,r.default)(A);break;case"OBJECTS":v.objects=(0,s.default)(A);break;default:o.default.warn("Unsupported section: ".concat(y))}return v},g=function(v){var _=v.split(/\r\n|\r|\n/g),y=d(_),A=f(y),w=A.reduce(p,{header:{},blocks:[],entities:[],objects:{layouts:[]},tables:{layers:{},styles:{},ltypes:{}}});return w};n.default=g})(O2);var hb={};function qLe(){this.__data__=[],this.size=0}var KLe=qLe;function JLe(n,e){return n===e||n!==n&&e!==e}var gq=JLe,ZLe=gq;function e2e(n,e){for(var t=n.length;t--;)if(ZLe(n[t][0],e))return t;return-1}var yI=e2e,t2e=yI,n2e=Array.prototype,i2e=n2e.splice;function r2e(n){var e=this.__data__,t=t2e(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():i2e.call(e,t,1),--this.size,!0}var s2e=r2e,o2e=yI;function a2e(n){var e=this.__data__,t=o2e(e,n);return t<0?void 0:e[t][1]}var l2e=a2e,c2e=yI;function u2e(n){return c2e(this.__data__,n)>-1}var h2e=u2e,d2e=yI;function f2e(n,e){var t=this.__data__,i=d2e(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}var p2e=f2e,g2e=KLe,m2e=s2e,v2e=l2e,_2e=h2e,y2e=p2e;function c_(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}c_.prototype.clear=g2e;c_.prototype.delete=m2e;c_.prototype.get=v2e;c_.prototype.has=_2e;c_.prototype.set=y2e;var AI=c_,A2e=AI;function b2e(){this.__data__=new A2e,this.size=0}var w2e=b2e;function x2e(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}var C2e=x2e;function E2e(n){return this.__data__.get(n)}var T2e=E2e;function I2e(n){return this.__data__.has(n)}var S2e=I2e,P2e=typeof un=="object"&&un&&un.Object===Object&&un,mq=P2e,M2e=mq,R2e=typeof self=="object"&&self&&self.Object===Object&&self,D2e=M2e||R2e||Function("return this")(),Xc=D2e,k2e=Xc,O2e=k2e.Symbol,U2=O2e,z4=U2,vq=Object.prototype,L2e=vq.hasOwnProperty,N2e=vq.toString,z_=z4?z4.toStringTag:void 0;function B2e(n){var e=L2e.call(n,z_),t=n[z_];try{n[z_]=void 0;var i=!0}catch{}var r=N2e.call(n);return i&&(e?n[z_]=t:delete n[z_]),r}var F2e=B2e,U2e=Object.prototype,G2e=U2e.toString;function H2e(n){return G2e.call(n)}var V2e=H2e,$4=U2,z2e=F2e,$2e=V2e,W2e="[object Null]",j2e="[object Undefined]",W4=$4?$4.toStringTag:void 0;function Q2e(n){return n==null?n===void 0?j2e:W2e:W4&&W4 in Object(n)?z2e(n):$2e(n)}var bI=Q2e;function X2e(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var db=X2e,Y2e=bI,q2e=db,K2e="[object AsyncFunction]",J2e="[object Function]",Z2e="[object GeneratorFunction]",eNe="[object Proxy]";function tNe(n){if(!q2e(n))return!1;var e=Y2e(n);return e==J2e||e==Z2e||e==K2e||e==eNe}var _q=tNe,nNe=Xc,iNe=nNe["__core-js_shared__"],rNe=iNe,I1=rNe,j4=function(){var n=/[^.]+$/.exec(I1&&I1.keys&&I1.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function sNe(n){return!!j4&&j4 in n}var oNe=sNe,aNe=Function.prototype,lNe=aNe.toString;function cNe(n){if(n!=null){try{return lNe.call(n)}catch{}try{return n+""}catch{}}return""}var yq=cNe,uNe=_q,hNe=oNe,dNe=db,fNe=yq,pNe=/[\\^$.*+?()[\]{}|]/g,gNe=/^\[object .+?Constructor\]$/,mNe=Function.prototype,vNe=Object.prototype,_Ne=mNe.toString,yNe=vNe.hasOwnProperty,ANe=RegExp("^"+_Ne.call(yNe).replace(pNe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bNe(n){if(!dNe(n)||hNe(n))return!1;var e=uNe(n)?ANe:gNe;return e.test(fNe(n))}var wNe=bNe;function xNe(n,e){return n==null?void 0:n[e]}var CNe=xNe,ENe=wNe,TNe=CNe;function INe(n,e){var t=TNe(n,e);return ENe(t)?t:void 0}var fg=INe,SNe=fg,PNe=Xc,MNe=SNe(PNe,"Map"),G2=MNe,RNe=fg,DNe=RNe(Object,"create"),wI=DNe,Q4=wI;function kNe(){this.__data__=Q4?Q4(null):{},this.size=0}var ONe=kNe;function LNe(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var NNe=LNe,BNe=wI,FNe="__lodash_hash_undefined__",UNe=Object.prototype,GNe=UNe.hasOwnProperty;function HNe(n){var e=this.__data__;if(BNe){var t=e[n];return t===FNe?void 0:t}return GNe.call(e,n)?e[n]:void 0}var VNe=HNe,zNe=wI,$Ne=Object.prototype,WNe=$Ne.hasOwnProperty;function jNe(n){var e=this.__data__;return zNe?e[n]!==void 0:WNe.call(e,n)}var QNe=jNe,XNe=wI,YNe="__lodash_hash_undefined__";function qNe(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=XNe&&e===void 0?YNe:e,this}var KNe=qNe,JNe=ONe,ZNe=NNe,eBe=VNe,tBe=QNe,nBe=KNe;function u_(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}u_.prototype.clear=JNe;u_.prototype.delete=ZNe;u_.prototype.get=eBe;u_.prototype.has=tBe;u_.prototype.set=nBe;var iBe=u_,X4=iBe,rBe=AI,sBe=G2;function oBe(){this.size=0,this.__data__={hash:new X4,map:new(sBe||rBe),string:new X4}}var aBe=oBe;function lBe(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}var cBe=lBe,uBe=cBe;function hBe(n,e){var t=n.__data__;return uBe(e)?t[typeof e=="string"?"string":"hash"]:t.map}var xI=hBe,dBe=xI;function fBe(n){var e=dBe(this,n).delete(n);return this.size-=e?1:0,e}var pBe=fBe,gBe=xI;function mBe(n){return gBe(this,n).get(n)}var vBe=mBe,_Be=xI;function yBe(n){return _Be(this,n).has(n)}var ABe=yBe,bBe=xI;function wBe(n,e){var t=bBe(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}var xBe=wBe,CBe=aBe,EBe=pBe,TBe=vBe,IBe=ABe,SBe=xBe;function h_(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}h_.prototype.clear=CBe;h_.prototype.delete=EBe;h_.prototype.get=TBe;h_.prototype.has=IBe;h_.prototype.set=SBe;var PBe=h_,MBe=AI,RBe=G2,DBe=PBe,kBe=200;function OBe(n,e){var t=this.__data__;if(t instanceof MBe){var i=t.__data__;if(!RBe||i.length<kBe-1)return i.push([n,e]),this.size=++t.size,this;t=this.__data__=new DBe(i)}return t.set(n,e),this.size=t.size,this}var LBe=OBe,NBe=AI,BBe=w2e,FBe=C2e,UBe=T2e,GBe=S2e,HBe=LBe;function d_(n){var e=this.__data__=new NBe(n);this.size=e.size}d_.prototype.clear=BBe;d_.prototype.delete=FBe;d_.prototype.get=UBe;d_.prototype.has=GBe;d_.prototype.set=HBe;var VBe=d_;function zBe(n,e){for(var t=-1,i=n==null?0:n.length;++t<i&&e(n[t],t,n)!==!1;);return n}var $Be=zBe,WBe=fg,jBe=function(){try{var n=WBe(Object,"defineProperty");return n({},"",{}),n}catch{}}(),QBe=jBe,Y4=QBe;function XBe(n,e,t){e=="__proto__"&&Y4?Y4(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}var Aq=XBe,YBe=Aq,qBe=gq,KBe=Object.prototype,JBe=KBe.hasOwnProperty;function ZBe(n,e,t){var i=n[e];(!(JBe.call(n,e)&&qBe(i,t))||t===void 0&&!(e in n))&&YBe(n,e,t)}var bq=ZBe,eFe=bq,tFe=Aq;function nFe(n,e,t,i){var r=!t;t||(t={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(t[a],n[a],a,t,n):void 0;l===void 0&&(l=n[a]),r?tFe(t,a,l):eFe(t,a,l)}return t}var CI=nFe;function iFe(n,e){for(var t=-1,i=Array(n);++t<n;)i[t]=e(t);return i}var rFe=iFe;function sFe(n){return n!=null&&typeof n=="object"}var fb=sFe,oFe=bI,aFe=fb,lFe="[object Arguments]";function cFe(n){return aFe(n)&&oFe(n)==lFe}var uFe=cFe,q4=uFe,hFe=fb,wq=Object.prototype,dFe=wq.hasOwnProperty,fFe=wq.propertyIsEnumerable,pFe=q4(function(){return arguments}())?q4:function(n){return hFe(n)&&dFe.call(n,"callee")&&!fFe.call(n,"callee")},gFe=pFe,mFe=Array.isArray,H2=mFe,rE={exports:{}};function vFe(){return!1}var _Fe=vFe;rE.exports;(function(n,e){var t=Xc,i=_Fe,r=e&&!e.nodeType&&e,s=r&&!0&&n&&!n.nodeType&&n,o=s&&s.exports===r,a=o?t.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||i;n.exports=c})(rE,rE.exports);var xq=rE.exports,yFe=9007199254740991,AFe=/^(?:0|[1-9]\d*)$/;function bFe(n,e){var t=typeof n;return e=e??yFe,!!e&&(t=="number"||t!="symbol"&&AFe.test(n))&&n>-1&&n%1==0&&n<e}var wFe=bFe,xFe=9007199254740991;function CFe(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=xFe}var Cq=CFe,EFe=bI,TFe=Cq,IFe=fb,SFe="[object Arguments]",PFe="[object Array]",MFe="[object Boolean]",RFe="[object Date]",DFe="[object Error]",kFe="[object Function]",OFe="[object Map]",LFe="[object Number]",NFe="[object Object]",BFe="[object RegExp]",FFe="[object Set]",UFe="[object String]",GFe="[object WeakMap]",HFe="[object ArrayBuffer]",VFe="[object DataView]",zFe="[object Float32Array]",$Fe="[object Float64Array]",WFe="[object Int8Array]",jFe="[object Int16Array]",QFe="[object Int32Array]",XFe="[object Uint8Array]",YFe="[object Uint8ClampedArray]",qFe="[object Uint16Array]",KFe="[object Uint32Array]",Wi={};Wi[zFe]=Wi[$Fe]=Wi[WFe]=Wi[jFe]=Wi[QFe]=Wi[XFe]=Wi[YFe]=Wi[qFe]=Wi[KFe]=!0;Wi[SFe]=Wi[PFe]=Wi[HFe]=Wi[MFe]=Wi[VFe]=Wi[RFe]=Wi[DFe]=Wi[kFe]=Wi[OFe]=Wi[LFe]=Wi[NFe]=Wi[BFe]=Wi[FFe]=Wi[UFe]=Wi[GFe]=!1;function JFe(n){return IFe(n)&&TFe(n.length)&&!!Wi[EFe(n)]}var ZFe=JFe;function eUe(n){return function(e){return n(e)}}var V2=eUe,sE={exports:{}};sE.exports;(function(n,e){var t=mq,i=e&&!e.nodeType&&e,r=i&&!0&&n&&!n.nodeType&&n,s=r&&r.exports===i,o=s&&t.process,a=function(){try{var l=r&&r.require&&r.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();n.exports=a})(sE,sE.exports);var z2=sE.exports,tUe=ZFe,nUe=V2,K4=z2,J4=K4&&K4.isTypedArray,iUe=J4?nUe(J4):tUe,rUe=iUe,sUe=rFe,oUe=gFe,aUe=H2,lUe=xq,cUe=wFe,uUe=rUe,hUe=Object.prototype,dUe=hUe.hasOwnProperty;function fUe(n,e){var t=aUe(n),i=!t&&oUe(n),r=!t&&!i&&lUe(n),s=!t&&!i&&!r&&uUe(n),o=t||i||r||s,a=o?sUe(n.length,String):[],l=a.length;for(var c in n)(e||dUe.call(n,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||cUe(c,l)))&&a.push(c);return a}var Eq=fUe,pUe=Object.prototype;function gUe(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||pUe;return n===t}var $2=gUe;function mUe(n,e){return function(t){return n(e(t))}}var Tq=mUe,vUe=Tq,_Ue=vUe(Object.keys,Object),yUe=_Ue,AUe=$2,bUe=yUe,wUe=Object.prototype,xUe=wUe.hasOwnProperty;function CUe(n){if(!AUe(n))return bUe(n);var e=[];for(var t in Object(n))xUe.call(n,t)&&t!="constructor"&&e.push(t);return e}var EUe=CUe,TUe=_q,IUe=Cq;function SUe(n){return n!=null&&IUe(n.length)&&!TUe(n)}var Iq=SUe,PUe=Eq,MUe=EUe,RUe=Iq;function DUe(n){return RUe(n)?PUe(n):MUe(n)}var W2=DUe,kUe=CI,OUe=W2;function LUe(n,e){return n&&kUe(e,OUe(e),n)}var NUe=LUe;function BUe(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var FUe=BUe,UUe=db,GUe=$2,HUe=FUe,VUe=Object.prototype,zUe=VUe.hasOwnProperty;function $Ue(n){if(!UUe(n))return HUe(n);var e=GUe(n),t=[];for(var i in n)i=="constructor"&&(e||!zUe.call(n,i))||t.push(i);return t}var WUe=$Ue,jUe=Eq,QUe=WUe,XUe=Iq;function YUe(n){return XUe(n)?jUe(n,!0):QUe(n)}var j2=YUe,qUe=CI,KUe=j2;function JUe(n,e){return n&&qUe(e,KUe(e),n)}var ZUe=JUe,oE={exports:{}};oE.exports;(function(n,e){var t=Xc,i=e&&!e.nodeType&&e,r=i&&!0&&n&&!n.nodeType&&n,s=r&&r.exports===i,o=s?t.Buffer:void 0,a=o?o.allocUnsafe:void 0;function l(c,u){if(u)return c.slice();var h=c.length,d=a?a(h):new c.constructor(h);return c.copy(d),d}n.exports=l})(oE,oE.exports);var e3e=oE.exports;function t3e(n,e){var t=-1,i=n.length;for(e||(e=Array(i));++t<i;)e[t]=n[t];return e}var n3e=t3e;function i3e(n,e){for(var t=-1,i=n==null?0:n.length,r=0,s=[];++t<i;){var o=n[t];e(o,t,n)&&(s[r++]=o)}return s}var r3e=i3e;function s3e(){return[]}var Sq=s3e,o3e=r3e,a3e=Sq,l3e=Object.prototype,c3e=l3e.propertyIsEnumerable,Z4=Object.getOwnPropertySymbols,u3e=Z4?function(n){return n==null?[]:(n=Object(n),o3e(Z4(n),function(e){return c3e.call(n,e)}))}:a3e,Q2=u3e,h3e=CI,d3e=Q2;function f3e(n,e){return h3e(n,d3e(n),e)}var p3e=f3e;function g3e(n,e){for(var t=-1,i=e.length,r=n.length;++t<i;)n[r+t]=e[t];return n}var Pq=g3e,m3e=Tq,v3e=m3e(Object.getPrototypeOf,Object),Mq=v3e,_3e=Pq,y3e=Mq,A3e=Q2,b3e=Sq,w3e=Object.getOwnPropertySymbols,x3e=w3e?function(n){for(var e=[];n;)_3e(e,A3e(n)),n=y3e(n);return e}:b3e,Rq=x3e,C3e=CI,E3e=Rq;function T3e(n,e){return C3e(n,E3e(n),e)}var I3e=T3e,S3e=Pq,P3e=H2;function M3e(n,e,t){var i=e(n);return P3e(n)?i:S3e(i,t(n))}var Dq=M3e,R3e=Dq,D3e=Q2,k3e=W2;function O3e(n){return R3e(n,k3e,D3e)}var L3e=O3e,N3e=Dq,B3e=Rq,F3e=j2;function U3e(n){return N3e(n,F3e,B3e)}var G3e=U3e,H3e=fg,V3e=Xc,z3e=H3e(V3e,"DataView"),$3e=z3e,W3e=fg,j3e=Xc,Q3e=W3e(j3e,"Promise"),X3e=Q3e,Y3e=fg,q3e=Xc,K3e=Y3e(q3e,"Set"),J3e=K3e,Z3e=fg,eGe=Xc,tGe=Z3e(eGe,"WeakMap"),nGe=tGe,ck=$3e,uk=G2,hk=X3e,dk=J3e,fk=nGe,kq=bI,f_=yq,eV="[object Map]",iGe="[object Object]",tV="[object Promise]",nV="[object Set]",iV="[object WeakMap]",rV="[object DataView]",rGe=f_(ck),sGe=f_(uk),oGe=f_(hk),aGe=f_(dk),lGe=f_(fk),gf=kq;(ck&&gf(new ck(new ArrayBuffer(1)))!=rV||uk&&gf(new uk)!=eV||hk&&gf(hk.resolve())!=tV||dk&&gf(new dk)!=nV||fk&&gf(new fk)!=iV)&&(gf=function(n){var e=kq(n),t=e==iGe?n.constructor:void 0,i=t?f_(t):"";if(i)switch(i){case rGe:return rV;case sGe:return eV;case oGe:return tV;case aGe:return nV;case lGe:return iV}return e});var X2=gf,cGe=Object.prototype,uGe=cGe.hasOwnProperty;function hGe(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&uGe.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var dGe=hGe,fGe=Xc,pGe=fGe.Uint8Array,gGe=pGe,sV=gGe;function mGe(n){var e=new n.constructor(n.byteLength);return new sV(e).set(new sV(n)),e}var Y2=mGe,vGe=Y2;function _Ge(n,e){var t=e?vGe(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}var yGe=_Ge,AGe=/\w*$/;function bGe(n){var e=new n.constructor(n.source,AGe.exec(n));return e.lastIndex=n.lastIndex,e}var wGe=bGe,oV=U2,aV=oV?oV.prototype:void 0,lV=aV?aV.valueOf:void 0;function xGe(n){return lV?Object(lV.call(n)):{}}var CGe=xGe,EGe=Y2;function TGe(n,e){var t=e?EGe(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var IGe=TGe,SGe=Y2,PGe=yGe,MGe=wGe,RGe=CGe,DGe=IGe,kGe="[object Boolean]",OGe="[object Date]",LGe="[object Map]",NGe="[object Number]",BGe="[object RegExp]",FGe="[object Set]",UGe="[object String]",GGe="[object Symbol]",HGe="[object ArrayBuffer]",VGe="[object DataView]",zGe="[object Float32Array]",$Ge="[object Float64Array]",WGe="[object Int8Array]",jGe="[object Int16Array]",QGe="[object Int32Array]",XGe="[object Uint8Array]",YGe="[object Uint8ClampedArray]",qGe="[object Uint16Array]",KGe="[object Uint32Array]";function JGe(n,e,t){var i=n.constructor;switch(e){case HGe:return SGe(n);case kGe:case OGe:return new i(+n);case VGe:return PGe(n,t);case zGe:case $Ge:case WGe:case jGe:case QGe:case XGe:case YGe:case qGe:case KGe:return DGe(n,t);case LGe:return new i;case NGe:case UGe:return new i(n);case BGe:return MGe(n);case FGe:return new i;case GGe:return RGe(n)}}var ZGe=JGe,eHe=db,cV=Object.create,tHe=function(){function n(){}return function(e){if(!eHe(e))return{};if(cV)return cV(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}(),nHe=tHe,iHe=nHe,rHe=Mq,sHe=$2;function oHe(n){return typeof n.constructor=="function"&&!sHe(n)?iHe(rHe(n)):{}}var aHe=oHe,lHe=X2,cHe=fb,uHe="[object Map]";function hHe(n){return cHe(n)&&lHe(n)==uHe}var dHe=hHe,fHe=dHe,pHe=V2,uV=z2,hV=uV&&uV.isMap,gHe=hV?pHe(hV):fHe,mHe=gHe,vHe=X2,_He=fb,yHe="[object Set]";function AHe(n){return _He(n)&&vHe(n)==yHe}var bHe=AHe,wHe=bHe,xHe=V2,dV=z2,fV=dV&&dV.isSet,CHe=fV?xHe(fV):wHe,EHe=CHe,THe=VBe,IHe=$Be,SHe=bq,PHe=NUe,MHe=ZUe,RHe=e3e,DHe=n3e,kHe=p3e,OHe=I3e,LHe=L3e,NHe=G3e,BHe=X2,FHe=dGe,UHe=ZGe,GHe=aHe,HHe=H2,VHe=xq,zHe=mHe,$He=db,WHe=EHe,jHe=W2,QHe=j2,XHe=1,YHe=2,qHe=4,Oq="[object Arguments]",KHe="[object Array]",JHe="[object Boolean]",ZHe="[object Date]",e4e="[object Error]",Lq="[object Function]",t4e="[object GeneratorFunction]",n4e="[object Map]",i4e="[object Number]",Nq="[object Object]",r4e="[object RegExp]",s4e="[object Set]",o4e="[object String]",a4e="[object Symbol]",l4e="[object WeakMap]",c4e="[object ArrayBuffer]",u4e="[object DataView]",h4e="[object Float32Array]",d4e="[object Float64Array]",f4e="[object Int8Array]",p4e="[object Int16Array]",g4e="[object Int32Array]",m4e="[object Uint8Array]",v4e="[object Uint8ClampedArray]",_4e="[object Uint16Array]",y4e="[object Uint32Array]",Bi={};Bi[Oq]=Bi[KHe]=Bi[c4e]=Bi[u4e]=Bi[JHe]=Bi[ZHe]=Bi[h4e]=Bi[d4e]=Bi[f4e]=Bi[p4e]=Bi[g4e]=Bi[n4e]=Bi[i4e]=Bi[Nq]=Bi[r4e]=Bi[s4e]=Bi[o4e]=Bi[a4e]=Bi[m4e]=Bi[v4e]=Bi[_4e]=Bi[y4e]=!0;Bi[e4e]=Bi[Lq]=Bi[l4e]=!1;function Xx(n,e,t,i,r,s){var o,a=e&XHe,l=e&YHe,c=e&qHe;if(t&&(o=r?t(n,i,r,s):t(n)),o!==void 0)return o;if(!$He(n))return n;var u=HHe(n);if(u){if(o=FHe(n),!a)return DHe(n,o)}else{var h=BHe(n),d=h==Lq||h==t4e;if(VHe(n))return RHe(n,a);if(h==Nq||h==Oq||d&&!r){if(o=l||d?{}:GHe(n),!a)return l?OHe(n,MHe(o,n)):kHe(n,PHe(o,n))}else{if(!Bi[h])return r?n:{};o=UHe(n,h,a)}}s||(s=new THe);var f=s.get(n);if(f)return f;s.set(n,o),WHe(n)?n.forEach(function(m){o.add(Xx(m,e,t,m,n,s))}):zHe(n)&&n.forEach(function(m,v){o.set(v,Xx(m,e,t,v,n,s))});var p=c?l?NHe:LHe:l?QHe:jHe,g=u?void 0:p(n);return IHe(g||n,function(m,v){g&&(v=m,m=n[v]),SHe(o,v,Xx(m,e,t,v,n,s))}),o}var A4e=Xx,b4e=A4e,w4e=1,x4e=4;function C4e(n){return b4e(n,w4e|x4e)}var E4e=C4e;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=i(E4e),t=i(Qc);function i(o){return o&&o.__esModule?o:{default:o}}function r(o){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},r(o)}var s=function(a){var l=a.blocks.reduce(function(u,h){return u[h.name]=h,u},{}),c=function u(h,d){var f=[];return h.forEach(function(p){if(p.type==="INSERT"){var g=function(){var v,_,y,A,w,b=p,C=l[b.block];if(!C)return t.default.error("no block found for insert. block:",b.block),{v:void 0};var I=(v=b.rowCount)!==null&&v!==void 0?v:1,x=(_=b.columnCount)!==null&&_!==void 0?_:1,T=(y=b.rowSpacing)!==null&&y!==void 0?y:0,O=(A=b.columnSpacing)!==null&&A!==void 0?A:0,F=(w=b.rotation)!==null&&w!==void 0?w:0,G,B;if(I>1||x>1){var R=Math.cos(F*Math.PI/180),P=Math.sin(F*Math.PI/180);G={x:-P*T,y:R*T},B={x:R*O,y:P*O}}else G={x:0,y:0},B={x:0,y:0};for(var k=0;k<I;k++)for(var L=0;L<x;L++){var H={x:b.x+G.x*k+B.x*L,y:b.y+G.y*k+B.y*L,scaleX:b.scaleX,scaleY:b.scaleY,scaleZ:b.scaleZ,extrusionX:b.extrusionX,extrusionY:b.extrusionY,extrusionZ:b.extrusionZ,rotation:b.rotation},U=d.slice(0);U.push(H);var $=C.entities.map(function(j){var Q=(0,e.default)(j);switch(Q.layer=b.layer,Q.type){case"LINE":{Q.start.x-=C.x,Q.start.y-=C.y,Q.end.x-=C.x,Q.end.y-=C.y;break}case"LWPOLYLINE":case"POLYLINE":{Q.vertices.forEach(function(ne){ne.x-=C.x,ne.y-=C.y});break}case"CIRCLE":case"ELLIPSE":case"ARC":{Q.x-=C.x,Q.y-=C.y;break}case"SPLINE":{Q.controlPoints.forEach(function(ne){ne.x-=C.x,ne.y-=C.y});break}}return Q});f=f.concat(u($,U))}}();if(r(g)==="object")return g.v}else{var m=(0,e.default)(p);m.transforms=d.slice().reverse(),f.push(m)}}),f};return c(a.entities,[])};n.default=s})(hb);var q2={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i){return i.reduce(function(r,s){var o=s.layer;return r[o]||(r[o]=[]),r[o].push(s),r},{})};n.default=e})(q2);var K2={},pb={},EI={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;function e(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(c){return typeof c}:e=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},e(a)}function t(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")}function i(a,l){for(var c=0;c<l.length;c++){var u=l[c];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}function r(a,l,c){return l&&i(a.prototype,l),c&&i(a,c),a}var s=function(){function a(l,c){t(this,a),e(l)==="object"?(this.x=l.x,this.y=l.y):(this.x=l,this.y=c)}return r(a,[{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function(){return new a(-this.x,-this.y)}},{key:"add",value:function(c){return new a(this.x+c.x,this.y+c.y)}},{key:"sub",value:function(c){return new a(this.x-c.x,this.y-c.y)}},{key:"multiply",value:function(c){return new a(this.x*c,this.y*c)}},{key:"norm",value:function(){return this.multiply(1/this.length())}},{key:"dot",value:function(c){return this.x*c.x+this.y*c.y}}]),a}(),o=s;n.default=o})(EI);var gb={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;function e(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(c){return typeof c}:e=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},e(a)}function t(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")}function i(a,l){for(var c=0;c<l.length;c++){var u=l[c];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}function r(a,l,c){return l&&i(a.prototype,l),c&&i(a,c),a}var s=function(){function a(l,c,u){t(this,a),e(l)==="object"?(this.x=l.x,this.y=l.y,this.z=l.z):l===void 0?(this.x=0,this.y=0,this.z=0):(this.x=l,this.y=c,this.z=u)}return r(a,[{key:"equals",value:function(c,u){return u===void 0&&(u=0),Math.abs(this.x-c.x)<=u&&Math.abs(this.y-c.y)<=u&&Math.abs(this.z-c.z)<=u}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"neg",value:function(){return new a(-this.x,-this.y,-this.z)}},{key:"add",value:function(c){return new a(this.x+c.x,this.y+c.y,this.z+c.z)}},{key:"sub",value:function(c){return new a(this.x-c.x,this.y-c.y,this.z-c.z)}},{key:"multiply",value:function(c){return new a(this.x*c,this.y*c,this.z*c)}},{key:"norm",value:function(){return this.multiply(1/this.length())}},{key:"dot",value:function(c){return this.x*c.x+this.y*c.y+this.z*c.z}},{key:"cross",value:function(c){return new a(this.y*c.z-this.z*c.y,this.z*c.x-this.x*c.z,this.x*c.y-this.y*c.x)}}]),a}(),o=s;n.default=o})(gb);var Bq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(EI);function t(c){return c&&c.__esModule?c:{default:c}}function i(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(h){return typeof h}:i=function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},i(c)}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function s(c,u){for(var h=0;h<u.length;h++){var d=u[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function o(c,u,h){return u&&s(c.prototype,u),h&&s(c,h),c}var a=function(){function c(u,h){if(r(this,c),i(u)==="object"&&i(h)==="object"&&u.x!==void 0&&u.y!==void 0&&h.x!==void 0&&h.y!==void 0)this.min=new e.default(u),this.max=new e.default(h),this.valid=!0;else if(u===void 0&&h===void 0)this.min=new e.default(1/0,1/0),this.max=new e.default(-1/0,-1/0),this.valid=!1;else throw Error("Illegal construction - must use { x, y } objects")}return o(c,[{key:"equals",value:function(h){if(!this.valid)throw Error("Box2 is invalid");return this.min.equals(h.min)&&this.max.equals(h.max)}},{key:"expandByPoint",value:function(h){return this.min=new e.default(Math.min(this.min.x,h.x),Math.min(this.min.y,h.y)),this.max=new e.default(Math.max(this.max.x,h.x),Math.max(this.max.y,h.y)),this.valid=!0,this}},{key:"expandByPoints",value:function(h){var d=this;return h.forEach(function(f){d.expandByPoint(f)},this),this}},{key:"isPointInside",value:function(h){return h.x>=this.min.x&&h.y>=this.min.y&&h.x<=this.max.x&&h.y<=this.max.y}},{key:"width",get:function(){if(!this.valid)throw Error("Box2 is invalid");return this.max.x-this.min.x}},{key:"height",get:function(){if(!this.valid)throw Error("Box2 is invalid");return this.max.y-this.min.y}}]),c}();a.fromPoints=function(c){return new a().expandByPoints(c)};var l=a;n.default=l})(Bq);var Fq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(gb);function t(c){return c&&c.__esModule?c:{default:c}}function i(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(h){return typeof h}:i=function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},i(c)}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function s(c,u){for(var h=0;h<u.length;h++){var d=u[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function o(c,u,h){return u&&s(c.prototype,u),h&&s(c,h),c}var a=function(){function c(u,h){if(r(this,c),i(u)==="object"&&i(h)==="object"&&u.x!==void 0&&u.y!==void 0&&u.z!==void 0&&h.x!==void 0&&h.y!==void 0&&h.z!==void 0)this.min=new e.default(u),this.max=new e.default(h),this.valid=!0;else if(u===void 0&&h===void 0)this.min=new e.default(1/0,1/0,1/0),this.max=new e.default(-1/0,-1/0,-1/0),this.valid=!1;else throw Error("Illegal construction - must use { x, y, z } objects")}return o(c,[{key:"equals",value:function(h){if(!this.valid)throw Error("Box3 is invalid");return this.min.equals(h.min)&&this.max.equals(h.max)}},{key:"expandByPoint",value:function(h){return this.min=new e.default(Math.min(this.min.x,h.x),Math.min(this.min.y,h.y),Math.min(this.min.z,h.z)),this.max=new e.default(Math.max(this.max.x,h.x),Math.max(this.max.y,h.y),Math.max(this.max.z,h.z)),this.valid=!0,this}},{key:"expandByPoints",value:function(h){var d=this;return h.forEach(function(f){d.expandByPoint(f)},this),this}},{key:"isPointInside",value:function(h){return h.x>=this.min.x&&h.y>=this.min.y&&h.z>=this.min.z&&h.x<=this.max.x&&h.y<=this.max.y&&h.z<=this.max.z}},{key:"width",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.x-this.min.x}},{key:"depth",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.y-this.min.y}},{key:"height",get:function(){if(!this.valid)throw Error("Box3 is invalid");return this.max.z-this.min.z}}]),c}();a.fromPoints=function(c){return new a().expandByPoints(c)};var l=a;n.default=l})(Fq);var Uq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;function e(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")}function t(o,a){for(var l=0;l<a.length;l++){var c=a[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(o,c.key,c)}}function i(o,a,l){return a&&t(o.prototype,a),l&&t(o,l),o}var r=function(){function o(a,l,c,u){e(this,o),this.a=a,this.b=l,this.c=c,this.d=u}return i(o,[{key:"distanceToPoint",value:function(l){var c=(this.a*l.x+this.b*l.y+this.c*l.z+this.d)/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);return c}},{key:"equals",value:function(l){return this.a===l.a&&this.b===l.b&&this.c===l.c&&this.d===l.d}},{key:"coPlanar",value:function(l){var c=this.a===l.a&&this.b===l.b&&this.c===l.c&&this.d===l.d,u=this.a===-l.a&&this.b===-l.b&&this.c===-l.c&&this.d===-l.d;return c||u}}]),o}();r.fromPointAndNormal=function(o,a){var l=a.x,c=a.y,u=a.z,h=-(o.x*l+o.y*c+o.z*u);return new r(a.x,a.y,a.z,h)},r.fromPoints=function(o){for(var a,l=0,c=o.length;l<c;++l){var u=o[(l+1)%c].sub(o[l]),h=o[(l+2)%c].sub(o[(l+1)%c]),d=u.cross(h);if(!(isNaN(d.length())||d.length()===0))if(!a)a=d.norm();else{var f=d.norm().equals(a,1e-6),p=d.neg().norm().equals(a,1e-6);if(!(f||p))throw Error("points not on a plane")}}if(!a)throw Error("points not on a plane");return r.fromPointAndNormal(o[0],a.norm())};var s=r;n.default=s})(Uq);var Gq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(gb);function t(l){return l&&l.__esModule?l:{default:l}}function i(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function r(l,c){for(var u=0;u<c.length;u++){var h=c[u];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(l,h.key,h)}}function s(l,c,u){return c&&r(l.prototype,c),u&&r(l,u),l}var o=function(){function l(c,u,h,d){i(this,l),this.x=c,this.y=u,this.z=h,this.w=d}return s(l,[{key:"applyToVec3",value:function(u){var h=u.x,d=u.y,f=u.z,p=this.x,g=this.y,m=this.z,v=this.w,_=v*h+g*f-m*d,y=v*d+m*h-p*f,A=v*f+p*d-g*h,w=-p*h-g*d-m*f;return new e.default(_*v+w*-p+y*-m-A*-g,y*v+w*-g+A*-p-_*-m,A*v+w*-m+_*-g-y*-p)}}]),l}();o.fromAxisAngle=function(l,c){var u=l.norm(),h=c/2,d=Math.sin(h);return new o(u.x*d,u.y*d,u.z*d,Math.cos(h))};var a=o;n.default=a})(Gq);var Hq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(EI);function t(f){return f&&f.__esModule?f:{default:f}}function i(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(g){return typeof g}:i=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},i(f)}function r(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function s(f,p){for(var g=0;g<p.length;g++){var m=p[g];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function o(f,p,g){return p&&s(f.prototype,p),g&&s(f,g),f}var a=function(p,g,m){var v=p.x,_=p.y,y=g.x,A=g.y,w=m.x,b=m.y,C=(b-_)*(y-v),I=(A-_)*(w-v);return C>I+Number.EPSILON?1:C+Number.EPSILON<I?-1:0},l=function(p,g){var m=p.a,v=p.b,_=g.a,y=g.b;return a(m,_,y)!==a(v,_,y)&&a(m,v,_)!==a(m,v,y)},c=function(p,g){var m=p.a.x,v=p.b.x,_=p.a.y,y=p.b.y,A=g.a.x,w=g.b.x,b=g.a.y,C=g.b.y,I=m-v,x=A-w,T=_-y,O=b-C,F=I*O-T*x,G=((m*y-_*v)*x-I*(A*C-b*w))/F,B=((m*y-_*v)*O-T*(A*C-b*w))/F;return isNaN(G)||isNaN(B)?null:new e.default(G,B)},u=function(p,g){return Math.sqrt(Math.pow(p.x-g.x,2)+Math.pow(p.y-g.y,2))},h=function(){function f(p,g){if(r(this,f),i(p)!=="object"||p.x===void 0||p.y===void 0)throw Error("expected first argument to have x and y properties");if(i(g)!=="object"||g.x===void 0||g.y===void 0)throw Error("expected second argument to have x and y properties");this.a=new e.default(p),this.b=new e.default(g)}return o(f,[{key:"length",value:function(){return this.a.sub(this.b).length()}},{key:"intersects",value:function(g){if(!(g instanceof f))throw new Error("expected argument to be an instance of vecks.Line2");return l(this,g)}},{key:"getIntersection",value:function(g){return this.intersects(g)?c(this,g):null}},{key:"containsPoint",value:function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e-12;return Math.abs(u(this.a,this.b)-u(g,this.a)-u(g,this.b))<m}}]),f}(),d=h;n.default=d})(Hq);var Vq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t(gb);function t(u){return u&&u.__esModule?u:{default:u}}function i(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(d){return typeof d}:i=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},i(u)}function r(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function s(u,h){for(var d=0;d<h.length;d++){var f=h[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}function o(u,h,d){return h&&s(u.prototype,h),d&&s(u,d),u}var a=function(h,d){return Math.sqrt(Math.pow(h.x-d.x,2)+Math.pow(h.y-d.y,2)+Math.pow(h.z-d.z,2))},l=function(){function u(h,d){if(r(this,u),i(h)!=="object"||h.x===void 0||h.y===void 0||h.z===void 0)throw Error("expected first argument to have x, y and z properties");if(i(d)!=="object"||d.x===void 0||d.y===void 0||d.y===void 0)throw Error("expected second argument to have x, y and z properties");this.a=new e.default(h),this.b=new e.default(d)}return o(u,[{key:"length",value:function(){return this.a.sub(this.b).length()}},{key:"containsPoint",value:function(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e-12;return Math.abs(a(this.a,this.b)-a(d,this.a)-a(d,this.b))<f}}]),u}(),c=l;n.default=c})(Vq);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"V2",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"V3",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"Box2",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"Box3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"Plane3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"Quaternion",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"Line2",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"Line3",{enumerable:!0,get:function(){return l.default}});var e=c(EI),t=c(gb),i=c(Bq),r=c(Fq),s=c(Uq),o=c(Gq),a=c(Hq),l=c(Vq);function c(u){return u&&u.__esModule?u:{default:u}}})(pb);var TI={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=[[0,0,0],[255,0,0],[255,255,0],[0,255,0],[0,255,255],[0,0,255],[255,0,255],[255,255,255],[65,65,65],[128,128,128],[255,0,0],[255,170,170],[189,0,0],[189,126,126],[129,0,0],[129,86,86],[104,0,0],[104,69,69],[79,0,0],[79,53,53],[255,63,0],[255,191,170],[189,46,0],[189,141,126],[129,31,0],[129,96,86],[104,25,0],[104,78,69],[79,19,0],[79,59,53],[255,127,0],[255,212,170],[189,94,0],[189,157,126],[129,64,0],[129,107,86],[104,52,0],[104,86,69],[79,39,0],[79,66,53],[255,191,0],[255,234,170],[189,141,0],[189,173,126],[129,96,0],[129,118,86],[104,78,0],[104,95,69],[79,59,0],[79,73,53],[255,255,0],[255,255,170],[189,189,0],[189,189,126],[129,129,0],[129,129,86],[104,104,0],[104,104,69],[79,79,0],[79,79,53],[191,255,0],[234,255,170],[141,189,0],[173,189,126],[96,129,0],[118,129,86],[78,104,0],[95,104,69],[59,79,0],[73,79,53],[127,255,0],[212,255,170],[94,189,0],[157,189,126],[64,129,0],[107,129,86],[52,104,0],[86,104,69],[39,79,0],[66,79,53],[63,255,0],[191,255,170],[46,189,0],[141,189,126],[31,129,0],[96,129,86],[25,104,0],[78,104,69],[19,79,0],[59,79,53],[0,255,0],[170,255,170],[0,189,0],[126,189,126],[0,129,0],[86,129,86],[0,104,0],[69,104,69],[0,79,0],[53,79,53],[0,255,63],[170,255,191],[0,189,46],[126,189,141],[0,129,31],[86,129,96],[0,104,25],[69,104,78],[0,79,19],[53,79,59],[0,255,127],[170,255,212],[0,189,94],[126,189,157],[0,129,64],[86,129,107],[0,104,52],[69,104,86],[0,79,39],[53,79,66],[0,255,191],[170,255,234],[0,189,141],[126,189,173],[0,129,96],[86,129,118],[0,104,78],[69,104,95],[0,79,59],[53,79,73],[0,255,255],[170,255,255],[0,189,189],[126,189,189],[0,129,129],[86,129,129],[0,104,104],[69,104,104],[0,79,79],[53,79,79],[0,191,255],[170,234,255],[0,141,189],[126,173,189],[0,96,129],[86,118,129],[0,78,104],[69,95,104],[0,59,79],[53,73,79],[0,127,255],[170,212,255],[0,94,189],[126,157,189],[0,64,129],[86,107,129],[0,52,104],[69,86,104],[0,39,79],[53,66,79],[0,63,255],[170,191,255],[0,46,189],[126,141,189],[0,31,129],[86,96,129],[0,25,104],[69,78,104],[0,19,79],[53,59,79],[0,0,255],[170,170,255],[0,0,189],[126,126,189],[0,0,129],[86,86,129],[0,0,104],[69,69,104],[0,0,79],[53,53,79],[63,0,255],[191,170,255],[46,0,189],[141,126,189],[31,0,129],[96,86,129],[25,0,104],[78,69,104],[19,0,79],[59,53,79],[127,0,255],[212,170,255],[94,0,189],[157,126,189],[64,0,129],[107,86,129],[52,0,104],[86,69,104],[39,0,79],[66,53,79],[191,0,255],[234,170,255],[141,0,189],[173,126,189],[96,0,129],[118,86,129],[78,0,104],[95,69,104],[59,0,79],[73,53,79],[255,0,255],[255,170,255],[189,0,189],[189,126,189],[129,0,129],[129,86,129],[104,0,104],[104,69,104],[79,0,79],[79,53,79],[255,0,191],[255,170,234],[189,0,141],[189,126,173],[129,0,96],[129,86,118],[104,0,78],[104,69,95],[79,0,59],[79,53,73],[255,0,127],[255,170,212],[189,0,94],[189,126,157],[129,0,64],[129,86,107],[104,0,52],[104,69,86],[79,0,39],[79,53,66],[255,0,63],[255,170,191],[189,0,46],[189,126,141],[129,0,31],[129,86,96],[104,0,25],[104,69,78],[79,0,19],[79,53,59],[51,51,51],[80,80,80],[105,105,105],[130,130,130],[190,190,190],[255,255,255]];n.default=e})(TI);var J2={},zq={},$q={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i,r){return typeof r>"u"||+r==0?Math.round(i):(i=+i,r=+r,isNaN(i)||!(typeof r=="number"&&r%1===0)?NaN:(i=i.toString().split("e"),i=Math.round(+(i[0]+"e"+(i[1]?+i[1]-r:-r))),i=i.toString().split("e"),+(i[0]+"e"+(i[1]?+i[1]+r:r))))};n.default=e})($q);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=t($q);function t(r){return r&&r.__esModule?r:{default:r}}var i=function(s,o,a,l,c){var u=a.length,h=a[0].length;if(s<0||s>1)throw new Error("t out of bounds [0,1]: "+s);if(o<1)throw new Error("degree must be at least 1 (linear)");if(o>u-1)throw new Error("degree must be less than or equal to point count - 1");if(!c){c=[];for(var d=0;d<u;d++)c[d]=1}if(l){if(l.length!==u+o+1)throw new Error("bad knot vector length")}else{l=[];for(var f=0;f<u+o+1;f++)l[f]=f}var p=[o,l.length-1-o],g=l[p[0]],m=l[p[1]];s=s*(m-g)+g,s=Math.max(s,g),s=Math.min(s,m);var v;for(v=p[0];v<p[1]&&!(s>=l[v]&&s<=l[v+1]);v++);for(var _=[],y=0;y<u;y++){_[y]=[];for(var A=0;A<h;A++)_[y][A]=a[y][A]*c[y];_[y][h]=c[y]}for(var w,b=1;b<=o+1;b++)for(var C=v;C>v-o-1+b;C--){w=(s-l[C])/(l[C+o+1-b]-l[C]);for(var I=0;I<h+1;I++)_[C][I]=(1-w)*_[C-1][I]+w*_[C][I]}for(var x=[],T=0;T<h;T++)x[T]=(0,e.default)(_[v][T]/_[v][h],-9);return x};n.default=i})(zq);var Wq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=pb,t=function(r,s,o,a){a||(a=5);var l,c,u;o<0?(l=Math.atan(-o)*4,c=new e.V2(r[0],r[1]),u=new e.V2(s[0],s[1])):(l=Math.atan(o)*4,c=new e.V2(s[0],s[1]),u=new e.V2(r[0],r[1]));var h=u.sub(c),d=h.length(),f=c.add(h.multiply(.5)),p=Math.abs(d/2/Math.tan(l/2)),g=h.norm(),m;if(l<Math.PI){var v=new e.V2(g.x*Math.cos(Math.PI/2)-g.y*Math.sin(Math.PI/2),g.y*Math.cos(Math.PI/2)+g.x*Math.sin(Math.PI/2));m=f.add(v.multiply(-p))}else{var _=new e.V2(g.x*Math.cos(Math.PI/2)-g.y*Math.sin(Math.PI/2),g.y*Math.cos(Math.PI/2)+g.x*Math.sin(Math.PI/2));m=f.add(_.multiply(p))}var y=Math.atan2(u.y-m.y,u.x-m.x)/Math.PI*180,A=Math.atan2(c.y-m.y,c.x-m.x)/Math.PI*180;A<y&&(A+=360);for(var w=u.sub(m).length(),b=Math.floor(y/a)*a+a,C=Math.ceil(A/a)*a-a,I=[],x=b;x<=C;x+=a)I.push(m.add(new e.V2(Math.cos(x/180*Math.PI)*w,Math.sin(x/180*Math.PI)*w)));return o<0&&I.reverse(),I.map(function(T){return[T.x,T.y]})};n.default=t})(Wq);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.interpolateBSpline=n.default=void 0;var e=r(zq),t=r(Qc),i=r(Wq);function r(c){return c&&c.__esModule?c:{default:c}}var s=function(u,h){return u.map(function(d){return[d[0]*Math.cos(h)-d[1]*Math.sin(h),d[1]*Math.cos(h)+d[0]*Math.sin(h)]})},o=function(u,h,d,f,p,g,m){g<p&&(g+=Math.PI*2);for(var v=[],_=Math.PI*2/72,y=1e-6,A=p;A<g-y;A+=_)v.push([Math.cos(A)*d,Math.sin(A)*f]);return v.push([Math.cos(g)*d,Math.sin(g)*f]),m&&(v=s(v,m)),v=v.map(function(w){return[u+w[0],h+w[1]]}),v},a=function(u,h,d,f,p){for(var g=[],m=u.map(function(O){return[O.x,O.y]}),v=[d[h]],_=[d[h],d[d.length-1-h]],y=h+1;y<d.length-h;++y)v[v.length-1]!==d[y]&&v.push(d[y]);f=f||25;for(var A=1;A<v.length;++A)for(var w=v[A-1],b=v[A],C=0;C<=f;++C){var I=C/f*(b-w)+w,x=(I-_[0])/(_[1]-_[0]);x=Math.max(x,0),x=Math.min(x,1);var T=(0,e.default)(x,h,m,d,p);g.push(T)}return g};n.interpolateBSpline=a;var l=function(u,h){h=h||{};var d;if(u.type==="LINE"&&(d=[[u.start.x,u.start.y],[u.end.x,u.end.y]]),(u.type==="LWPOLYLINE"||u.type==="POLYLINE")&&(d=[],!(u.polygonMesh||u.polyfaceMesh)))if(u.vertices.length){u.closed&&(u.vertices=u.vertices.concat(u.vertices[0]));for(var f=0,p=u.vertices.length;f<p-1;++f){var g=[u.vertices[f].x,u.vertices[f].y],m=[u.vertices[f+1].x,u.vertices[f+1].y];d.push(g),u.vertices[f].bulge&&(d=d.concat((0,i.default)(g,m,u.vertices[f].bulge))),f===p-2&&d.push(m)}}else t.default.warn("Polyline entity with no vertices");if(u.type==="CIRCLE"&&(d=o(u.x,u.y,u.r,u.r,0,Math.PI*2),u.extrusionZ===-1&&(d=d.map(function(A){return[-A[0],A[1]]}))),u.type==="ELLIPSE"){var v=Math.sqrt(u.majorX*u.majorX+u.majorY*u.majorY),_=u.axisRatio*v,y=-Math.atan2(-u.majorY,u.majorX);d=o(u.x,u.y,v,_,u.startAngle,u.endAngle,y),u.extrusionZ===-1&&(d=d.map(function(A){return[-A[0],A[1]]}))}return u.type==="ARC"&&(d=o(u.x,u.y,u.r,u.r,u.startAngle,u.endAngle,void 0),u.extrusionZ===-1&&(d=d.map(function(A){return[-A[0],A[1]]}))),u.type==="SPLINE"&&(d=a(u.controlPoints,u.degree,u.knots,h.interpolationsPerSplineSegment,u.weights)),d||(t.default.warn("unsupported entity for converting to polyline:",u.type),[])};n.default=l})(J2);var jq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i,r){return r.forEach(function(s){i=i.map(function(o){var a=[o[0],o[1]];if(s.scaleX&&(a[0]=a[0]*s.scaleX),s.scaleY&&(a[1]=a[1]*s.scaleY),s.rotation){var l=s.rotation/180*Math.PI;a=[a[0]*Math.cos(l)-a[1]*Math.sin(l),a[1]*Math.cos(l)+a[0]*Math.sin(l)]}return s.x&&(a[0]=a[0]+s.x),s.y&&(a[1]=a[1]+s.y),s.extrusionZ===-1&&(a[0]=-a[0]),a})}),i};n.default=e})(jq);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=pb,t=a(TI),i=a(hb),r=a(J2),s=a(jq),o=a(Qc);function a(c){return c&&c.__esModule?c:{default:c}}var l=function(u){var h=(0,i.default)(u),d=h.map(function(p){var g=u.tables.layers[p.layer],m;if(g){var v="colorNumber"in p?p.colorNumber:g.colorNumber;m=t.default[v],m===void 0&&(o.default.warn("Color index",v,"invalid, defaulting to black"),m=[0,0,0])}else o.default.warn("no layer table for layer:"+p.layer),m=[0,0,0];return{rgb:m,vertices:(0,s.default)((0,r.default)(p),p.transforms)}}),f=new e.Box2;return d.forEach(function(p){p.vertices.forEach(function(g){f.expandByPoint({x:g[0],y:g[1]})})}),{bbox:f,polylines:d}};n.default=l})(K2);var Z2={},Qq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=i(TI),t=i(Qc);function i(s){return s&&s.__esModule?s:{default:s}}var r=function(o,a){var l=o[a.layer];if(l){var c="colorNumber"in a&&a.colorNumber!==256,u=c?a.colorNumber:l.colorNumber,h=e.default[u];return h||(t.default.warn("Color index",u,"invalid, defaulting to black"),[0,0,0])}else return t.default.warn("no layer table for layer:"+a.layer),[0,0,0]};n.default=r})(Qq);var Xq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i,r){return{x:i.x*Math.cos(r)-i.y*Math.sin(r),y:i.y*Math.cos(r)+i.x*Math.sin(r)}};n.default=e})(Xq);var Yq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i){return i[0]===255&&i[1]===255&&i[2]===255?"rgb(0, 0, 0)":"rgb(".concat(i[0],", ").concat(i[1],", ").concat(i[2],")")};n.default=e})(Yq);var qq={},Kq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(i,r,s,o){for(var a=s,l=r,c=r.length,u=0,h=!1,d=0;d<c+i;d++)if(o>a[d]&&o<=a[d+1]){u=d,h=!0;break}if(!h)throw new Error("invalid new knot");for(var f=[],p=0;p<c+i+1;p++)p<=u?f[p]=a[p]:p===u+1?f[p]=o:f[p]=a[p-1];for(var g,m=[],v=0;v<c+1;v++)v<=u-i+1?g=1:u-i+2<=v&&v<=u?a[v+i-1]-a[v]===0?g=0:g=(o-a[v])/(a[v+i-1]-a[v]):g=0,g===0?m[v]=l[v-1]:g===1?m[v]=l[v]:m[v]={x:(1-g)*l[v-1].x+g*l[v].x,y:(1-g)*l[v-1].y+g*l[v].y};return{controlPoints:m,knots:f}};n.default=e})(Kq);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.multiplicity=n.default=n.computeInsertions=n.checkPinned=void 0;var e=t(Kq);function t(a){return a&&a.__esModule?a:{default:a}}var i=function(l,c){for(var u=1;u<l;++u)if(c[u]!==c[0])throw Error("not pinned. order: ".concat(l," knots: ").concat(c));for(var h=c.length-2;h>c.length-l-1;--h)if(c[h]!==c[c.length-1])throw Error("not pinned. order: ".concat(l," knots: ").concat(c))};n.checkPinned=i;var r=function(l,c){for(var u=1,h=c+1;h<l.length&&l[h]===l[c];++h)++u;return u};n.multiplicity=r;var s=function(l,c){for(var u=[],h=l;h<c.length-l;){for(var d=c[h],f=r(c,h),p=0;p<l-f-1;++p)u.push(d);h=h+f}return u};n.computeInsertions=s;var o=function(l,c,u){i(l,u);var h=s(l,u);return h.reduce(function(d,f){return(0,e.default)(l,d.controlPoints,d.knots,f)},{controlPoints:c,knots:u})};n.default=o})(qq);var Jq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=pb;function t(c,u){return a(c)||o(c,u)||r(c,u)||i()}function i(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(c,u){if(c){if(typeof c=="string")return s(c,u);var h=Object.prototype.toString.call(c).slice(8,-1);if(h==="Object"&&c.constructor&&(h=c.constructor.name),h==="Map"||h==="Set")return Array.from(c);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return s(c,u)}}function s(c,u){(u==null||u>c.length)&&(u=c.length);for(var h=0,d=new Array(u);h<u;h++)d[h]=c[h];return d}function o(c,u){var h=c==null?null:typeof Symbol<"u"&&c[Symbol.iterator]||c["@@iterator"];if(h!=null){var d,f,p,g,m=[],v=!0,_=!1;try{if(p=(h=h.call(c)).next,u===0){if(Object(h)!==h)return;v=!1}else for(;!(v=(d=p.call(h)).done)&&(m.push(d.value),m.length!==u);v=!0);}catch(y){_=!0,f=y}finally{try{if(!v&&h.return!=null&&(g=h.return(),Object(g)!==g))return}finally{if(_)throw f}}return m}}function a(c){if(Array.isArray(c))return c}var l=function(u,h,d){var f="",p=d.map(function(v){var _=v.x||0,y=v.y||0,A=v.scaleX||1,w=v.scaleY||1,b=(v.rotation||0)/180*Math.PI,C=Math.cos,I=Math.sin,x,T,O,F,G,B;return v.extrusionZ===-1?(x=-A*C(b),T=A*I(b),O=w*I(b),F=w*C(b),G=-_,B=y):(x=A*C(b),T=A*I(b),O=-w*I(b),F=w*C(b),G=_,B=y),[x,T,O,F,G,B]}),g=new e.Box2;if(u.valid){var m=[{x:u.min.x,y:u.min.y},{x:u.max.x,y:u.min.y},{x:u.max.x,y:u.max.y},{x:u.min.x,y:u.max.y}];p.forEach(function(v){var _=t(v,6),y=_[0],A=_[1],w=_[2],b=_[3],C=_[4],I=_[5];m=m.map(function(x){return{x:x.x*y+x.y*w+C,y:x.x*A+x.y*b+I}})}),g=m.reduce(function(v,_){return v.expandByPoint(_)},new e.Box2)}return p.reverse(),p.forEach(function(v){var _=t(v,6),y=_[0],A=_[1],w=_[2],b=_[3],C=_[4],I=_[5];f+='<g transform="matrix('.concat(y," ").concat(A," ").concat(w," ").concat(b," ").concat(C," ").concat(I,')">')}),f+=h,p.forEach(function(v){f+="</g>"}),{bbox:g,element:f}};n.default=l})(Jq);(function(n){function e(R){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},e(R)}Object.defineProperty(n,"__esModule",{value:!0}),n.piecewiseToPaths=n.default=void 0;var t=pb,i=f(J2),r=f(hb),s=f(Qq),o=f(Qc),a=f(Xq),l=f(Yq),c=d(qq),u=f(Jq);function h(R){if(typeof WeakMap!="function")return null;var P=new WeakMap,k=new WeakMap;return(h=function(H){return H?k:P})(R)}function d(R,P){if(!P&&R&&R.__esModule)return R;if(R===null||e(R)!=="object"&&typeof R!="function")return{default:R};var k=h(P);if(k&&k.has(R))return k.get(R);var L={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in R)if(U!=="default"&&Object.prototype.hasOwnProperty.call(R,U)){var $=H?Object.getOwnPropertyDescriptor(R,U):null;$&&($.get||$.set)?Object.defineProperty(L,U,$):L[U]=R[U]}return L.default=R,k&&k.set(R,L),L}function f(R){return R&&R.__esModule?R:{default:R}}function p(R,P){return y(R)||_(R,P)||m(R,P)||g()}function g(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m(R,P){if(R){if(typeof R=="string")return v(R,P);var k=Object.prototype.toString.call(R).slice(8,-1);if(k==="Object"&&R.constructor&&(k=R.constructor.name),k==="Map"||k==="Set")return Array.from(R);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return v(R,P)}}function v(R,P){(P==null||P>R.length)&&(P=R.length);for(var k=0,L=new Array(P);k<P;k++)L[k]=R[k];return L}function _(R,P){var k=R==null?null:typeof Symbol<"u"&&R[Symbol.iterator]||R["@@iterator"];if(k!=null){var L,H,U,$,j=[],Q=!0,ne=!1;try{if(U=(k=k.call(R)).next,P===0){if(Object(k)!==k)return;Q=!1}else for(;!(Q=(L=U.call(k)).done)&&(j.push(L.value),j.length!==P);Q=!0);}catch(ve){ne=!0,H=ve}finally{try{if(!Q&&k.return!=null&&($=k.return(),Object($)!==$))return}finally{if(ne)throw H}}return j}}function y(R){if(Array.isArray(R))return R}var A=function(P,k){var L=k.bbox,H=k.element;return P.extrusionZ===-1?{bbox:new t.Box2().expandByPoint({x:-L.min.x,y:L.min.y}).expandByPoint({x:-L.max.x,y:L.max.y}),element:`<g transform="matrix(-1 0 0 1 0 0)">
        `.concat(H,`
      </g>`)}:{bbox:L,element:H}},w=function(P){var k=(0,i.default)(P),L=k.reduce(function(U,$){var j=p($,2),Q=j[0],ne=j[1];return U.expandByPoint({x:Q,y:ne})},new t.Box2),H=k.reduce(function(U,$,j){return U+=j===0?"M":"L",U+=$[0]+","+$[1],U},"");return(0,u.default)(L,'<path d="'.concat(H,'" />'),P.transforms)},b=function(P){var k=new t.Box2().expandByPoint({x:P.x+P.r,y:P.y+P.r}).expandByPoint({x:P.x-P.r,y:P.y-P.r}),L='<circle cx="'.concat(P.x,'" cy="').concat(P.y,'" r="').concat(P.r,'" />'),H=A(P,{bbox:k,element:L}),U=H.bbox,$=H.element;return(0,u.default)(U,$,P.transforms)},C=function(P,k,L,H,U,$,j,Q){var ne=Math.sqrt(L*L+H*H),ve=U*ne,Pe=-Math.atan2(-H,L),De=I(P,k,L,H,U,$,j);if(Math.abs($-j)<1e-9||Math.abs($-j+Math.PI*2)<1e-9){var Xe='<g transform="rotate('.concat(Pe/Math.PI*180," ").concat(P,", ").concat(k,`)">
      <ellipse cx="`).concat(P,'" cy="').concat(k,'" rx="').concat(ne,'" ry="').concat(ve,`" />
    </g>`);return{bbox:De,element:Xe}}else{var Ne=(0,a.default)({x:Math.cos($)*ne,y:Math.sin($)*ve},Pe),et={x:P+Ne.x,y:k+Ne.y},ze=(0,a.default)({x:Math.cos(j)*ne,y:Math.sin(j)*ve},Pe),de={x:P+ze.x,y:k+ze.y},lt=j<$?j+Math.PI*2:j,he=lt-$<Math.PI?0:1,Ce="M ".concat(et.x," ").concat(et.y," A ").concat(ne," ").concat(ve," ").concat(Pe/Math.PI*180," ").concat(he," 1 ").concat(de.x," ").concat(de.y),se='<path d="'.concat(Ce,'" />');return{bbox:De,element:se}}},I=function(P,k,L,H,U,$,j,Q){for(;$<0;)$+=Math.PI*2;for(;j<=$;)j+=Math.PI*2;var ne=[];if(Math.abs(L)<1e-12||Math.abs(H)<1e-12)for(var ve=0;ve<4;ve++)ne.push(ve/2*Math.PI);else ne[0]=Math.atan(-H*U/L)-Math.PI,ne[1]=Math.atan(L*U/H)-Math.PI,ne[2]=ne[0]-Math.PI,ne[3]=ne[1]-Math.PI;for(var Pe=4;Pe>=0;Pe--){for(;ne[Pe]<$;)ne[Pe]+=Math.PI*2;ne[Pe]>j&&ne.splice(Pe,1)}ne.push($),ne.push(j);var De=ne.map(function(ze){return{x:Math.cos(ze),y:Math.sin(ze)}}),Xe=[[L,-H*U],[H,L*U]],Ne=De.map(function(ze){return{x:ze.x*Xe[0][0]+ze.y*Xe[0][1]+P,y:ze.x*Xe[1][0]+ze.y*Xe[1][1]+k}}),et=Ne.reduce(function(ze,de){return ze.expandByPoint(de),ze},new t.Box2);return et},x=function(P){var k=C(P.x,P.y,P.majorX,P.majorY,P.axisRatio,P.startAngle,P.endAngle),L=k.bbox,H=k.element,U=A(P,{bbox:L,element:H}),$=U.bbox,j=U.element;return(0,u.default)($,j,P.transforms)},T=function(P){var k=C(P.x,P.y,P.r,0,1,P.startAngle,P.endAngle,P.extrusionZ===-1),L=k.bbox,H=k.element,U=A(P,{bbox:L,element:H}),$=U.bbox,j=U.element;return(0,u.default)($,j,P.transforms)},O=function(P,k,L){for(var H=[],U=0,$=P,j=[];$<k.length-P+1;){var Q=(0,c.multiplicity)(k,$),ne=L.slice(U,U+P);j.length||j.push("M ".concat(ne[0].x," ").concat(ne[0].y)),P===4?j.push("C ".concat(ne[1].x," ").concat(ne[1].y," ").concat(ne[2].x," ").concat(ne[2].y," ").concat(ne[3].x," ").concat(ne[3].y)):P===3&&j.push("Q ".concat(ne[1].x," ").concat(ne[1].y," ").concat(ne[2].x," ").concat(ne[2].y)),U+=Q,$+=Q}var ve=j.join(" ");return H.push('<path d="'.concat(ve,'" />')),H};n.piecewiseToPaths=O;var F=function(P){var k=new t.Box2;P.controlPoints.forEach(function(j){k=k.expandByPoint(j)});var L=P.degree+1,H=(0,c.default)(L,P.controlPoints,P.knots),U=O(L,H.knots,H.controlPoints),$="<g>".concat(U.join(""),"</g>");return(0,u.default)(k,$,P.transforms)},G=function(P){switch(P.type){case"CIRCLE":return b(P);case"ELLIPSE":return x(P);case"ARC":return T(P);case"SPLINE":{var k=P.weights&&P.weights.some(function(L){return L!==1});if((P.degree===2||P.degree===3)&&!k)try{return F(P)}catch{return w(P)}else return w(P)}case"LINE":case"LWPOLYLINE":case"POLYLINE":return w(P);default:return o.default.warn("entity type not supported in SVG rendering:",P.type),null}},B=function(P){var k=(0,r.default)(P),L=k.reduce(function(j,Q,ne){var ve=(0,s.default)(P.tables.layers,Q),Pe=G(Q);if(Pe){var De=Pe.bbox,Xe=Pe.element;De.valid&&(j.bbox.expandByPoint(De.min),j.bbox.expandByPoint(De.max)),j.elements.push('<g stroke="'.concat((0,l.default)(ve),'">').concat(Xe,"</g>"))}return j},{bbox:new t.Box2,elements:[]}),H=L.bbox,U=L.elements,$=H.valid?{x:H.min.x,y:-H.max.y,width:H.max.x-H.min.x,height:H.max.y-H.min.y}:{x:0,y:0,width:0,height:0};return`<?xml version="1.0"?>
<svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
  preserveAspectRatio="xMinYMin meet"
  viewBox="`.concat($.x," ").concat($.y," ").concat($.width," ").concat($.height,`"
  width="100%" height="100%"
>
  <g stroke="#000000" stroke-width="0.1%" fill="none" transform="matrix(1,0,0,-1,0,0)">
    `).concat(U.join(`
`),`
  </g>
</svg>`)};n.default=B})(Z2);var Zq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=a(Qc),t=a(O2),i=a(hb),r=a(Z2),s=a(K2),o=a(q2);function a(g){return g&&g.__esModule?g:{default:g}}function l(g){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},l(g)}function c(g,m){if(!(g instanceof m))throw new TypeError("Cannot call a class as a function")}function u(g,m){for(var v=0;v<m.length;v++){var _=m[v];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(g,d(_.key),_)}}function h(g,m,v){return m&&u(g.prototype,m),v&&u(g,v),Object.defineProperty(g,"prototype",{writable:!1}),g}function d(g){var m=f(g,"string");return l(m)==="symbol"?m:String(m)}function f(g,m){if(l(g)!=="object"||g===null)return g;var v=g[Symbol.toPrimitive];if(v!==void 0){var _=v.call(g,m||"default");if(l(_)!=="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(g)}var p=function(){function g(m){if(c(this,g),typeof m!="string")throw Error("Helper constructor expects a DXF string");this._contents=m,this._parsed=null,this._denormalised=null}return h(g,[{key:"parse",value:function(){return this._parsed=(0,t.default)(this._contents),e.default.info("parsed:",this.parsed),this._parsed}},{key:"parsed",get:function(){return this._parsed===null&&this.parse(),this._parsed}},{key:"denormalise",value:function(){return this._denormalised=(0,i.default)(this.parsed),e.default.info("denormalised:",this._denormalised),this._denormalised}},{key:"denormalised",get:function(){return this._denormalised||this.denormalise(),this._denormalised}},{key:"group",value:function(){this._groups=(0,o.default)(this.denormalised)}},{key:"groups",get:function(){return this._groups||this.group(),this._groups}},{key:"toSVG",value:function(){return(0,r.default)(this.parsed)}},{key:"toPolylines",value:function(){return(0,s.default)(this.parsed)}}]),g}();n.default=p})(Zq);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Helper",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"colors",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"config",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"denormalise",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"groupEntitiesByLayer",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"parseString",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"toPolylines",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"toSVG",{enumerable:!0,get:function(){return o.default}});var e=c(k2),t=c(O2),i=c(hb),r=c(q2),s=c(K2),o=c(Z2),a=c(TI),l=c(Zq);function c(u){return u&&u.__esModule?u:{default:u}}})(X7);const T4e=function(n){if(typeof exports=="object"&&typeof module<"u")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.DxfParser=n()}return n()}(function(){return function n(e,t,i){function r(a,l){if(!t[a]){if(!e[a]){var c=typeof require=="function"&&require;if(!l&&c)return c(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=t[a]={exports:{}};e[a][0].call(h.exports,function(d){var f=e[a][1][d];return r(f||d)},h,h.exports,n,e,t,i)}return t[a].exports}for(var s=typeof require=="function"&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(n,e,t){e.exports=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215]},{}],2:[function(n,e,t){function i(o){this._pointer=0,this._data=o,this._eof=!1}i.prototype.next=function(){var o;if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);return o={code:parseInt(this._data[this._pointer])},this._pointer++,o.value=r(o.code,this._data[this._pointer].trim()),this._pointer++,o.code===0&&o.value==="EOF"&&(this._eof=!0),this.lastReadGroup=o,o},i.prototype.peek=function(){if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);var o={code:parseInt(this._data[this._pointer])};return o.value=r(o.code,this._data[this._pointer+1].trim()),o},i.prototype.rewind=function(o){o=o||1,this._pointer=this._pointer-o*2},i.prototype.hasNext=function(){return!(this._eof||this._pointer>this._data.length-2)},i.prototype.isEOF=function(){return this._eof};function r(o,a){return o<=9?a:o>=10&&o<=59?parseFloat(a):o>=60&&o<=99?parseInt(a):o>=100&&o<=109?a:o>=110&&o<=149?parseFloat(a):o>=160&&o<=179?parseInt(a):o>=210&&o<=239?parseFloat(a):o>=270&&o<=289?parseInt(a):o>=290&&o<=299?s(a):o>=300&&o<=369?a:o>=370&&o<=389?parseInt(a):o>=390&&o<=399?a:o>=400&&o<=409?parseInt(a):o>=410&&o<=419?a:o>=420&&o<=429?parseInt(a):o>=430&&o<=439?a:o>=440&&o<=459?parseInt(a):o>=460&&o<=469?parseFloat(a):o>=470&&o<=481||o===999||o>=1e3&&o<=1009?a:o>=1010&&o<=1059?parseFloat(a):o>=1060&&o<=1071?parseInt(a):(console.log("WARNING: Group code does not have a defined type: %j",{code:o,value:a}),a)}function s(o){return o==="0"?!1:o==="1"}e.exports=i},{}],3:[function(n,e,t){var i=n("./DxfArrayScanner.js"),r=n("./AutoCadColorIndex"),s={setLevel:()=>{},debug:()=>{},warn:h=>{console.warn(h)},trace:()=>{},info:()=>{}};s.setLevel("error");function o(h){h.registerEntityHandler(n("./entities/3dface")),h.registerEntityHandler(n("./entities/arc")),h.registerEntityHandler(n("./entities/attdef")),h.registerEntityHandler(n("./entities/circle")),h.registerEntityHandler(n("./entities/dimension")),h.registerEntityHandler(n("./entities/ellipse")),h.registerEntityHandler(n("./entities/insert")),h.registerEntityHandler(n("./entities/line")),h.registerEntityHandler(n("./entities/lwpolyline")),h.registerEntityHandler(n("./entities/mtext")),h.registerEntityHandler(n("./entities/point")),h.registerEntityHandler(n("./entities/polyline")),h.registerEntityHandler(n("./entities/solid")),h.registerEntityHandler(n("./entities/spline")),h.registerEntityHandler(n("./entities/hatch")),h.registerEntityHandler(n("./entities/text"))}function a(){this._entityHandlers={},o(this)}a.prototype.parse=function(h,d){throw new Error("read() not implemented. Use readSync()")},a.prototype.registerEntityHandler=function(h){var d=new h;this._entityHandlers[h.ForEntityName]=d},a.prototype.parseSync=function(h){return typeof h=="string"?this._parse(h):(console.error("Cannot read dxf source of type `"+typeof h),null)},a.prototype.parseStream=function(h,d){var f="",p=this;h.on("data",g),h.on("end",m),h.on("error",v);function g(_){f+=_}function m(){try{var _=p._parse(f)}catch(y){return d(y)}d(null,_)}function v(_){d(_)}},a.prototype._parse=function(h){var d,f,p={},g=0,m=h.split(/\r\n|\r|\n/g);if(d=new i(m),!d.hasNext())throw Error("Empty file");var v=this,_=function(){for(f=d.next();!d.isEOF();)if(f.code===0&&f.value==="SECTION"){if(f=d.next(),f.code!==2){console.error("Unexpected code %s after 0:SECTION",c(f)),f=d.next();continue}f.value==="HEADER"?(s.debug("> HEADER"),p.header=A(),s.debug("<")):f.value==="BLOCKS"?(s.debug("> BLOCKS"),p.blocks=w(),s.debug("<")):f.value==="ENTITIES"?(s.debug("> ENTITIES"),p.entities=B(!1),s.debug("<")):f.value==="TABLES"?(s.debug("> TABLES"),p.tables=C(),s.debug("<")):f.value==="EOF"?s.debug("EOF"):s.warn("Skipping section '"+f.value+"'")}else f=d.next()},y=function(k,L){return f.code===k&&f.value===L},A=function(){var k=null,L=null,H={};for(f=d.next();;){if(y(0,"ENDSEC")){k&&(H[k]=L);break}else f.code===9?(k&&(H[k]=L),k=f.value):f.code===10?L={x:f.value}:f.code===20?L&&(L.y=f.value):f.code===30?L&&(L.z=f.value):L=f.value;f=d.next()}return f=d.next(),H},w=function(){var k={},L;for(f=d.next();f.value!=="EOF"&&!y(0,"ENDSEC");)y(0,"BLOCK")?(s.debug("block {"),L=b(),s.debug("}"),P(L),L.name?k[L.name]=L:s.error('block with handle "'+L.handle+'" is missing a name.')):(l(f),f=d.next());return k},b=function(){var k={};for(f=d.next();f.value!=="EOF";){switch(f.code){case 1:k.xrefPath=f.value,f=d.next();break;case 2:k.name=f.value,f=d.next();break;case 3:k.name2=f.value,f=d.next();break;case 5:k.handle=f.value,f=d.next();break;case 8:k.layer=f.value,f=d.next();break;case 10:k.position=R(),f=d.next();break;case 67:k.paperSpace=!!(f.value&&f.value==1),f=d.next();break;case 70:f.value!=0&&(k.type=f.value),f=d.next();break;case 100:f=d.next();break;case 330:k.ownerHandle=f.value,f=d.next();break;case 0:if(f.value=="ENDBLK")break;k.entities=B(!0);break;default:l(f),f=d.next()}if(y(0,"ENDBLK")){f=d.next();break}}return k},C=function(){var k={};for(f=d.next();f.value!=="EOF"&&!y(0,"ENDSEC");)if(y(0,"TABLE")){f=d.next();var L=G[f.value];L?(s.debug(f.value+" Table {"),k[G[f.value].tableName]=x(),s.debug("}")):s.debug("Unhandled Table "+f.value)}else f=d.next();return f=d.next(),k};const I="ENDTAB";var x=function(){var k=G[f.value],L={},H=0,U;for(f=d.next();!y(0,I);)switch(f.code){case 5:L.handle=f.value,f=d.next();break;case 330:L.ownerHandle=f.value,f=d.next();break;case 100:f.value==="AcDbSymbolTable"||l(f),f=d.next();break;case 70:H=f.value,f=d.next();break;case 0:f.value===k.dxfSymbolName?L[k.tableRecordsProperty]=k.parseTableRecords():(l(f),f=d.next());break;default:l(f),f=d.next()}var $=L[k.tableRecordsProperty];return $&&($.constructor===Array?U=$.length:typeof $=="object"&&(U=Object.keys($).length),H!==U&&s.warn("Parsed "+U+" "+k.dxfSymbolName+"'s but expected "+H)),f=d.next(),L},T=function(){var k=[],L={};for(s.debug("ViewPort {"),f=d.next();!y(0,I);)switch(f.code){case 2:L.name=f.value,f=d.next();break;case 10:L.lowerLeftCorner=R(),f=d.next();break;case 11:L.upperRightCorner=R(),f=d.next();break;case 12:L.center=R(),f=d.next();break;case 13:L.snapBasePoint=R(),f=d.next();break;case 14:L.snapSpacing=R(),f=d.next();break;case 15:L.gridSpacing=R(),f=d.next();break;case 16:L.viewDirectionFromTarget=R(),f=d.next();break;case 17:L.viewTarget=R(),f=d.next();break;case 42:L.lensLength=f.value,f=d.next();break;case 43:L.frontClippingPlane=f.value,f=d.next();break;case 44:L.backClippingPlane=f.value,f=d.next();break;case 45:L.viewHeight=f.value,f=d.next();break;case 50:L.snapRotationAngle=f.value,f=d.next();break;case 51:L.viewTwistAngle=f.value,f=d.next();break;case 79:L.orthographicType=f.value,f=d.next();break;case 110:L.ucsOrigin=R(),f=d.next();break;case 111:L.ucsXAxis=R(),f=d.next();break;case 112:L.ucsYAxis=R(),f=d.next();break;case 281:L.renderMode=f.value,f=d.next();break;case 292:L.defaultLightingOn=f.value,f=d.next();break;case 330:L.ownerHandle=f.value,f=d.next();break;case 63:case 421:case 431:L.ambientColor=f.value,f=d.next();break;case 0:f.value==="VPORT"&&(s.debug("}"),k.push(L),s.debug("ViewPort {"),L={},f=d.next());break;default:l(f),f=d.next();break}return s.debug("}"),k.push(L),k},O=function(){var k={},L,H={},U;for(s.debug("LType {"),f=d.next();!y(0,"ENDTAB");)switch(f.code){case 2:H.name=f.value,L=f.value,f=d.next();break;case 3:H.description=f.value,f=d.next();break;case 73:U=f.value,U>0&&(H.pattern=[]),f=d.next();break;case 40:H.patternLength=f.value,f=d.next();break;case 49:H.pattern.push(f.value),f=d.next();break;case 0:s.debug("}"),U>0&&U!==H.pattern.length&&s.warn("lengths do not match on LTYPE pattern"),k[L]=H,H={},s.debug("LType {"),f=d.next();break;default:f=d.next()}return s.debug("}"),k[L]=H,k},F=function(){var k={},L,H={};for(s.debug("Layer {"),f=d.next();!y(0,"ENDTAB");)switch(f.code){case 2:H.name=f.value,L=f.value,f=d.next();break;case 62:H.visible=f.value>=0,H.color=u(Math.abs(f.value)),f=d.next();break;case 70:H.frozen=(f.value&1)!=0||(f.value&2)!=0,f=d.next();break;case 0:f.value==="LAYER"&&(s.debug("}"),k[L]=H,s.debug("Layer {"),H={},L=void 0,f=d.next());break;default:l(f),f=d.next();break}return s.debug("}"),k[L]=H,k},G={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:T},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:O},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:F}},B=function(k){var L=[],H=k?"ENDBLK":"ENDSEC";for(k||(f=d.next());;)if(f.code===0){if(f.value===H)break;var U,$=v._entityHandlers[f.value];if($!=null)s.debug(f.value+" {"),U=$.parseEntity(d,f),f=d.lastReadGroup,s.debug("}");else{s.warn("Unhandled entity "+f.value),f=d.next();continue}P(U),L.push(U)}else f=d.next();return H=="ENDSEC"&&(f=d.next()),L},R=function(){var k={},L=f.code;if(k.x=f.value,L+=10,f=d.next(),f.code!=L)throw new Error("Expected code for point value to be "+L+" but got "+f.code+".");return k.y=f.value,L+=10,f=d.next(),f.code!=L?(d.rewind(),k):(k.z=f.value,k)},P=function(k){if(!k)throw new TypeError("entity cannot be undefined or null");k.handle||(k.handle=g++)};return _(),p};function l(h){s.debug("unhandled group "+c(h))}function c(h){return h.code+":"+h.value}function u(h){return r[h]}e.exports=a},{"./AutoCadColorIndex":1,"./DxfArrayScanner.js":2,"./entities/3dface":5,"./entities/arc":6,"./entities/attdef":7,"./entities/circle":8,"./entities/dimension":9,"./entities/ellipse":10,"./entities/insert":11,"./entities/line":12,"./entities/lwpolyline":13,"./entities/mtext":14,"./entities/point":15,"./entities/polyline":16,"./entities/solid":17,"./entities/spline":18,"./entities/text":19,"./entities/hatch":118,loglevel:21}],4:[function(n,e,t){var i=n("./AutoCadColorIndex");t.getAcadColor=function(s){return i[s]};var r=t.getAcadColor;t.parsePoint=function(s){var o={};s.rewind();var a=s.next(),l=a.code;o.x=a.value,l+=10,a=s.next();var c=!1;if(a.code!=l){if(c=!0,a=s.next(),a.code!=l)throw new Error("Expected code for point value to be "+l+" but got "+a.code+".");o.y=a.value}else o.y=a.value;return c&&(s.rewind(),s.rewind()),o},t.checkCommonEntityProperties=function(s,o){switch(o.code){case 0:s.type=o.value;break;case 5:s.handle=o.value;break;case 6:s.lineType=o.value;break;case 8:s.layer=o.value;break;case 48:s.lineTypeScale=o.value;break;case 60:s.visible=o.value===0;break;case 62:s.colorIndex=o.value,s.color=r(Math.abs(o.value));break;case 67:s.inPaperSpace=o.value!==0;break;case 100:break;case 330:s.ownerHandle=o.value;break;case 347:s.materialObjectHandle=o.value;break;case 370:s.lineweight=o.value;break;case 420:s.color=o.value;break;case 1e3:s.extendedData=s.extendedData||{},s.extendedData.customStrings=s.extendedData.customStrings||[],s.extendedData.customStrings.push(o.value);break;case 1001:s.extendedData=s.extendedData||{},s.extendedData.applicationName=o.value;break;default:return!1}return!0}},{"./AutoCadColorIndex":1}],5:[function(n,e,t){n("../ParseHelpers"),e.exports=i;function i(){}i.ForEntityName="3DFACE",i.prototype.parseEntity=function(s,o){var a={type:o.value,vertices:[]};for(o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 70:a.shape=(o.value&1)===1,a.hasContinuousLinetypePattern=(o.value&128)===128;break;case 10:a.vertices=r(s,o),o=s.lastReadGroup;break;default:checkCommonEntityProperties(a);break}o=s.next()}return a};function r(s,o){var a=[],l,c=!1,u=!1,h=4;for(l=0;l<=h;l++){for(var d={};o!=="EOF"&&!(o.code===0||u);){switch(o.code){case 10:case 11:case 12:case 13:if(c){u=!0;continue}d.x=o.value,c=!0;break;case 20:case 21:case 22:case 23:d.y=o.value;break;case 30:case 31:case 32:case 33:d.z=o.value;break;default:return a}o=s.next()}a.push(d),c=!1,u=!1}return s.rewind(),a}},{"../ParseHelpers":4}],6:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="ARC",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.center=i.parsePoint(s);break;case 39:a.thickness=o.value;case 40:a.radius=o.value;break;case 50:a.startAngle=Math.PI/180*o.value;break;case 51:a.endAngle=Math.PI/180*o.value,a.angleLength=a.endAngle-a.startAngle;break;case 210:a.extrusionDirectionX=o.value;break;case 220:a.extrusionDirectionY=o.value;break;case 230:a.extrusionDirectionZ=o.value;break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],7:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="ATTDEF",r.prototype.parseEntity=function(s,o){var a={type:o.value,scale:1,textStyle:"STANDARD"};for(o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 1:a.text=o.value;break;case 2:a.tag=o.value;break;case 3:a.prompt=o.value;break;case 7:a.textStyle=o.value;break;case 10:a.startPoint=i.parsePoint(s);break;case 11:a.endPoint=i.parsePoint(s);break;case 39:a.thickness=o.value;break;case 40:a.textHeight=o.value;break;case 41:a.scale=o.value;break;case 50:a.rotation=o.value;break;case 51:a.obliqueAngle=o.value;break;case 70:a.invisible=!!(o.value&1),a.constant=!!(o.value&2),a.verificationRequired=!!(o.value&4),a.preset=!!(o.value&8);break;case 71:a.backwards=!!(o.value&2),a.mirrored=!!(o.value&4);break;case 72:a.horizontalJustification=o.value;break;case 73:a.fieldLength=o.value;break;case 74:a.verticalJustification=o.value;break;case 100:break;case 210:a.extrusionDirectionX=o.value;break;case 220:a.extrusionDirectionY=o.value;break;case 230:a.extrusionDirectionZ=o.value;break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],8:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="CIRCLE",r.prototype.parseEntity=function(s,o){var a,l;for(a={type:o.value},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.center=i.parsePoint(s);break;case 40:a.radius=o.value;break;case 50:a.startAngle=Math.PI/180*o.value;break;case 51:l=Math.PI/180*o.value,l<a.startAngle?a.angleLength=l+2*Math.PI-a.startAngle:a.angleLength=l-a.startAngle,a.endAngle=l;break;case 210:a.directionX=o.value;break;case 220:a.directionY=o.value;break;case 230:a.directionZ=o.value;break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],9:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="DIMENSION",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 2:a.block=o.value;break;case 10:a.anchorPoint=i.parsePoint(s);break;case 11:a.middleOfText=i.parsePoint(s);break;case 71:a.attachmentPoint=o.value;break;case 42:a.actualMeasurement=o.value;break;case 1:a.text=o.value;break;case 50:a.angle=o.value;break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],10:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="ELLIPSE",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.center=i.parsePoint(s);break;case 11:a.majorAxisEndPoint=i.parsePoint(s);break;case 40:a.axisRatio=o.value;break;case 41:a.startAngle=o.value;break;case 42:a.endAngle=o.value;break;case 2:a.name=o.value;break;case 210:a.extrusionDirectionX=o.value;break;case 220:a.extrusionDirectionY=o.value;break;case 230:a.extrusionDirectionZ=o.value;break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],11:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="INSERT",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 2:a.name=o.value;break;case 41:a.xScale=o.value;break;case 42:a.yScale=o.value;break;case 43:a.zScale=o.value;break;case 10:a.position=i.parsePoint(s);break;case 50:a.rotation=o.value;break;case 70:a.columnCount=o.value;break;case 71:a.rowCount=o.value;break;case 44:a.columnSpacing=o.value;break;case 45:a.rowSpacing=o.value;break;case 210:a.extrusionDirection=i.parsePoint(s);break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],12:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="LINE",r.prototype.parseEntity=function(s,o){var a={type:o.value,vertices:[]};for(o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.vertices.unshift(i.parsePoint(s));break;case 11:a.vertices.push(i.parsePoint(s));break;case 210:a.extrusionDirection=i.parsePoint(s);break;case 100:break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],13:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="LWPOLYLINE",r.prototype.parseEntity=function(o,a){var l={type:a.value,vertices:[],flags:0},c=0;for(a=o.next();a!=="EOF"&&a.code!==0;){switch(a.code){case 38:l.elevation=a.value;break;case 39:l.depth=a.value;break;case 70:l.flags=a.value,l.shape=(a.value&1)===1,l.hasContinuousLinetypePattern=(a.value&128)===128;break;case 90:c=a.value;break;case 10:l.vertices=s(c,o);break;case 43:a.value!==0&&(l.width=a.value);break;case 210:l.extrusionDirectionX=a.value;break;case 220:l.extrusionDirectionY=a.value;break;case 230:l.extrusionDirectionZ=a.value;break;default:i.checkCommonEntityProperties(l,a);break}a=o.next()}return l};function s(o,a){if(!o||o<=0)throw Error("n must be greater than 0 verticies");var l=[],c,u=!1,h=!1,d=a.lastReadGroup;for(c=0;c<o;c++){for(var f={};d!=="EOF"&&!(d.code===0||h);){switch(d.code){case 10:if(u){h=!0;continue}f.x=d.value,u=!0;break;case 20:f.y=d.value;break;case 30:f.z=d.value;break;case 40:f.startWidth=d.value;break;case 41:f.endWidth=d.value;break;case 42:d.value!=0&&(f.bulge=d.value);break;default:return u&&l.push(f),l}d=a.next()}l.push(f),u=!1,h=!1}return a.rewind(),l}},{"../ParseHelpers":4}],14:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="MTEXT",r.prototype.parseEntity=function(s,o){var a={type:o.value};for(o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 1:a.text=o.value;break;case 3:a.text+=o.value;break;case 10:a.position=i.parsePoint(s);break;case 40:a.height=o.value;break;case 41:a.width=o.value;break;case 50:a.rotation=o.value;break;case 71:a.attachmentPoint=o.value;break;case 72:a.drawingDirection=o.value;break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],15:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="POINT",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.position=i.parsePoint(s);break;case 39:a.thickness=o.value;break;case 210:a.extrusionDirection=i.parsePoint(s);break;case 100:break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],16:[function(n,e,t){var i=n("../ParseHelpers"),r=n("./vertex");e.exports=s;function s(){}s.ForEntityName="POLYLINE",s.prototype.parseEntity=function(l,c){var u={type:c.value,vertices:[]};for(c=l.next();c!=="EOF"&&c.code!==0;){switch(c.code){case 10:case 20:case 30:case 39:u.thickness=c.value;break;case 40:case 41:break;case 70:u.shape=(c.value&1)!==0,u.includesCurveFitVertices=(c.value&2)!==0,u.includesSplineFitVertices=(c.value&4)!==0,u.is3dPolyline=(c.value&8)!==0,u.is3dPolygonMesh=(c.value&16)!==0,u.is3dPolygonMeshClosed=(c.value&32)!==0,u.isPolyfaceMesh=(c.value&64)!==0,u.hasContinuousLinetypePattern=(c.value&128)!==0;break;case 71:case 72:case 73:case 74:case 75:break;case 210:u.extrusionDirection=i.parsePoint(l);break;default:i.checkCommonEntityProperties(u,c);break}c=l.next()}return u.vertices=o(l,c),u};function o(l,c){for(var u=new r,h=[];!l.isEOF();)if(c.code===0){if(c.value==="VERTEX")h.push(u.parseEntity(l,c)),c=l.lastReadGroup;else if(c.value==="SEQEND"){a(l,c);break}}return h}function a(l,c){var u={type:c.value};for(c=l.next();c!="EOF"&&c.code!=0;)i.checkCommonEntityProperties(u,c),c=l.next();return u}},{"../ParseHelpers":4,"./vertex":20}],17:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="SOLID",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value},a.points=[],o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.points[0]=i.parsePoint(s);break;case 11:a.points[1]=i.parsePoint(s);break;case 12:a.points[2]=i.parsePoint(s);break;case 13:a.points[3]=i.parsePoint(s);break;case 210:a.extrusionDirection=i.parsePoint(s);break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],18:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="SPLINE",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.controlPoints||(a.controlPoints=[]),a.controlPoints.push(i.parsePoint(s));break;case 11:a.fitPoints||(a.fitPoints=[]),a.fitPoints.push(i.parsePoint(s));break;case 12:a.startTangent=i.parsePoint(s);break;case 13:a.endTangent=i.parsePoint(s);break;case 40:a.knotValues||(a.knotValues=[]),a.knotValues.push(o.value);break;case 70:o.value&1&&(a.closed=!0),o.value&2&&(a.periodic=!0),o.value&4&&(a.rational=!0),o.value&8&&(a.planar=!0),o.value&16&&(a.planar=!0,a.linear=!0);break;case 71:a.degreeOfSplineCurve=o.value;break;case 72:a.numberOfKnots=o.value;break;case 73:a.numberOfControlPoints=o.value;break;case 74:a.numberOfFitPoints=o.value;break;case 210:a.normalVector=i.parsePoint(s);break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],19:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="TEXT",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.startPoint=i.parsePoint(s);break;case 11:a.endPoint=i.parsePoint(s);break;case 40:a.textHeight=o.value;break;case 41:a.xScale=o.value;break;case 50:a.rotation=o.value;break;case 1:a.text=o.value;break;case 72:a.halign=o.value;break;case 73:a.valign=o.value;break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],118:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="HATCH",r.prototype.parseEntity=function(s,o){var a;for(a={type:o.value,paths:[]},o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.typeOfPath&&(a.typeOfPath[a.typeOfPath.length-1]==4?a.paths[a.paths.length-1].controlPoints[a.paths[a.paths.length-1].controlPoints.length-1].push(i.parsePoint(s)):a.typeOfPath[a.typeOfPath.length-1]==1&&(a.paths[a.paths.length-1].points||(a.paths[a.paths.length-1].points=[]),a.paths[a.paths.length-1].points.unshift(i.parsePoint(s))));break;case 11:a.paths[a.paths.length-1].points.push(i.parsePoint(s));break;case 40:a.typeOfPath&&a.typeOfPath[a.typeOfPath.length-1]==4&&a.paths[a.paths.length-1].knotValues[a.paths[a.paths.length-1].knotValues.length-1].push(o.value);break;case 70:a.solid=o.value;break;case 72:a.typeOfPath||(a.typeOfPath=[]),a.typeOfPath.push(o.value),a.paths.push({});break;case 92:break;case 93:break;case 94:a.paths[a.paths.length-1].degreeOfSplineCurve=o.value;break;case 95:a.paths[a.paths.length-1].numberOfKnots||(a.paths[a.paths.length-1].numberOfKnots=[]),a.paths[a.paths.length-1].numberOfKnots.push(o.value),a.paths[a.paths.length-1].knotValues?a.paths[a.paths.length-1].knotValues.push([]):a.paths[a.paths.length-1].knotValues=[[]];break;case 96:a.paths[a.paths.length-1].numberOfControlPoints||(a.paths[a.paths.length-1].numberOfControlPoints=[]),a.paths[a.paths.length-1].numberOfControlPoints.push(o.value),a.paths[a.paths.length-1].controlPoints?a.paths[a.paths.length-1].controlPoints.push([]):a.paths[a.paths.length-1].controlPoints=[[]];break;case 97:break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],20:[function(n,e,t){var i=n("../ParseHelpers");e.exports=r;function r(){}r.ForEntityName="VERTEX",r.prototype.parseEntity=function(s,o){var a={type:o.value,flags:0};for(o=s.next();o!=="EOF"&&o.code!==0;){switch(o.code){case 10:a.x=o.value;break;case 20:a.y=o.value;break;case 30:a.z=o.value;break;case 40:case 41:case 42:o.value!=0&&(a.bulge=o.value);break;case 70:a.flags=o.value,a.curveFittingVertex=(o.value&1)!==0,a.curveFitTangent=(o.value&2)!==0,a.splineVertex=(o.value&8)!==0,a.splineControlPoint=(o.value&16)!==0,a.threeDPolylineVertex=(o.value&32)!==0,a.threeDPolylineMesh=(o.value&64)!==0,a.polyfaceMeshVertex=(o.value&128)!==0;break;case 50:case 71:case 72:case 73:case 74:break;default:i.checkCommonEntityProperties(a,o);break}o=s.next()}return a}},{"../ParseHelpers":4}],21:[function(n,e,t){(function(i,r){typeof e=="object"&&e.exports&&typeof n=="function"?e.exports=r():i.log=r()})(this,function(){var i={},r=function(){},s="undefined";function o(p){return typeof console===s?!1:console[p]!==void 0?a(console,p):console.log!==void 0?a(console,"log"):r}function a(p,g){var m=p[g];if(typeof m.bind=="function")return m.bind(p);try{return Function.prototype.bind.call(m,p)}catch{return function(){return Function.prototype.apply.apply(m,[p,arguments])}}}function l(p,g){return function(){typeof console!==s&&(u(g),i[p].apply(i,arguments))}}var c=["trace","debug","info","warn","error"];function u(p){for(var g=0;g<c.length;g++){var m=c[g];i[m]=g<p?r:i.methodFactory(m,p)}}function h(p){var g=(c[p]||"silent").toUpperCase();try{window.localStorage.loglevel=g;return}catch{}try{window.document.cookie="loglevel="+g+";"}catch{}}function d(){var p;try{p=window.localStorage.loglevel}catch{}if(typeof p===s)try{p=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch{}i.levels[p]===void 0&&(p="WARN"),i.setLevel(i.levels[p],!1)}i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=function(p,g){return o(p)||l(p,g)},i.setLevel=function(p,g){if(typeof p=="string"&&i.levels[p.toUpperCase()]!==void 0&&(p=i.levels[p.toUpperCase()]),typeof p=="number"&&p>=0&&p<=i.levels.SILENT){if(g!==!1&&h(p),u(p),typeof console===s&&p<i.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+p},i.enableAll=function(p){i.setLevel(i.levels.TRACE,p)},i.disableAll=function(p){i.setLevel(i.levels.SILENT,p)};var f=typeof window!==s?window.log:void 0;return i.noConflict=function(){return typeof window!==s&&window.log===i&&(window.log=f),i},d(),i})},{}]},{},[3])(3)});function I4e(n,e,t,i,r,v){var o,a,l,c,u=t.length,h=t[0].length;if(e<1)throw new Error("degree must be at least 1 (linear)");if(e>u-1)throw new Error("degree must be less than or equal to point count - 1");if(!r)for(r=[],o=0;o<u;o++)r[o]=1;if(i){if(i.length!==u+e+1)throw new Error("bad knot vector length")}else{var i=[];for(o=0;o<u+e+1;o++)i[o]=o}var d=[e,i.length-1-e],f=i[d[0]],p=i[d[1]];if(n=n*(p-f)+f,n<f||n>p)throw new Error("out of bounds");for(l=d[0];l<d[1]&&!(n>=i[l]&&n<=i[l+1]);l++);var g=[];for(o=0;o<u;o++){for(g[o]=[],a=0;a<h;a++)g[o][a]=t[o][a]*r[o];g[o][h]=r[o]}var m;for(c=1;c<=e+1;c++)for(o=l;o>l-e-1+c;o--)for(m=(n-i[o])/(i[o+e+1-c]-i[o]),a=0;a<h+1;a++)g[o][a]=(1-m)*g[o-1][a]+m*g[o][a];var v=v||[];for(o=0;o<h;o++)v[o]=g[l][o]/g[l][h];return v}class S4e{constructor(){}static interpolateBSpline(e,t,i,r){const s=[];let o=e.map(function(c){return[c.x,c.y]});if(e.length>500){let c=[],u=[0,0];o=[];for(let d=0,f=e.length;d<f;d++)e[d].x==u[0]&&e[d].y==u[1]||(u=[e[d].x,e[d].y],c.push(i[d]),o.push(u));const h=i[i.length-1];if(c.push(h),c.push(h),c.push(h),c.push(h),Math.abs(i.length-e.length)>100?i=c:o=e.map(function(d){return[d.x,d.y]}),i.length>1500)return o}const a=[i[t]],l=[i[t],i[i.length-1-t]];for(let c=t+1;c<i.length-t;++c)a[a.length-1]!==i[c]&&a.push(i[c]);r=r||10;for(let c=1;c<a.length;++c){const u=a[c-1],h=a[c];for(let d=0;d<=r;++d)try{const p=(d/r*(h-u)+u-l[0])/(l[1]-l[0]),g=I4e(p,t,o,i);s.push(g)}catch{}}return s}}class P4e{constructor(){this.parser=new T4e}async parse(e,t){const i=this;var r=new Date().getTime();try{this._dxf=i.parser.parseSync(e)}catch{return""}console.log("dxf parse:",new Date().getTime()-r);var s="";const o={英寸:25.4,英尺:304.8,毫米:1,厘米:10,米:1e3,分米:100,微米:.001,inch:25.4,foot:304.8,mm:1,cm:10,meter:1e3,decimeter:100,micron:.001,无单位:1},a=["无单位","英寸","英尺","英里","毫米","厘米","米","千米","微英寸","密耳","码","埃","纳米","微米","分米"];let l=1;this._dxf.header?(this._dxf.header.$DIMALTF||(this._dxf.header.$DIMALTF=1),l=t?o[t]:o[a[this._dxf.header.$INSUNITS]]||1):(this._dxf.header={},this._dxf.header.$DIMALTF=1),this._globalScale=1,this._globalScaleY=1;let c=this._globalScale;this._globalLineScale=c,this._lineTypes={},this._layers={},this._dxf.tables&&(this._dxf.tables.lineType&&(this._lineTypes=this._dxf.tables.lineType.lineTypes),this._dxf.tables.layer&&this._dxf.tables.layer.layers&&(this._layers=this._dxf.tables.layer.layers)),this._minX=9999,this._minY=9999,this._maxX=-9999,this._maxY=-9999,this._position={x:0,y:0},this._elems={};let u=[];for(let f=0,p=this._dxf.entities.length;f<p;f++){let g=await this.parseEntitle(this._dxf.entities[f]);u.push(g)}s+=u.join("");var h=this._maxX-this._minX,d=this._maxY-this._minY;return s=`<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="${h*l/c}mm" height="${d*l/c}mm"><g transform="translate(${-this._minX*l/c},${-this._minY*l/c}) scale(${l/c},-${l/c})" style="fill:none;">${s}</g></svg>`,s}checkLimits(e,t){e+=this._position.x,t+=this._position.y,e<this._minX&&(this._minX=e),e>this._maxX&&(this._maxX=e),t<this._minY&&(this._minY=t),t>this._maxY&&(this._maxY=t)}async parseInsert(e){let t=this._globalScale,i=this._dxf.blocks[e.name],r=[];if(i.entities){if(e.position){const s=e.rotation?"rotate("+e.rotation+",0,0)":"";if(s!=""){const o=e.xScale?`scale(${e.xScale},${e.yScale})`:"";r.push(`<g transform="translate(${(e.position.x*t).toFixed(5)}, ${(e.position.y*this._globalScaleY).toFixed(5)}) ${s} ${o}">`)}else{const o=e.xScale?`scale(${e.xScale},${e.yScale})`:"";r.push(`<g transform="translate(${(e.position.x*t).toFixed(5)}, ${(e.position.y*this._globalScaleY).toFixed(5)}) ${o}">`)}}else r.push("<g>");for(let s=0,o=i.entities.length;s<o;s++){let a=await this.parseEntitle(i.entities[s]);r.push(a)}return r.push("</g>"),r.join("")}}toRGB(e){return e==16777215?"#000000":`#${("00000"+e.toString(16)).substr(-6,6)}`}async parseEntitle(e){let t=this._lineTypes,i=this._layers[e.layer],r=this._globalScale,s=this._globalLineScale,o="";this._elems[e.type]?this._elems[e.type]++:this._elems[e.type]=1;let a="",l={x:0,y:0};e.position&&(l.x=e.position.x*r,l.y=e.position.y*this._globalScaleY),i&&i.color&&(e.color?e.color=this.toRGB(e.color):e.color=this.toRGB(i.color));let c="";if(e.lineType&&t[e.lineType]&&t[e.lineType].pattern){for(var u=0;u<t[e.lineType].pattern.length;u++)t[e.lineType].pattern[u]=Math.abs(t[e.lineType].pattern[u]);c="stroke-dasharray:"+t[e.lineType].pattern.join(",")+";"}let h=[];switch(e.type){case"INSERT":{let R=await this.parseInsert(e);h.push(R)}break;case"SOLID":{let R=e.points;l.x*=r,l.y*=this._globalScaleY;let P=R.length;for(let L=0;L<P;L++)R[L].x*=r,R[L].y*=this._globalScaleY;let k=[];if(P==4){for(let L=0;L<3;L++)k.push(L==0?"M":"L"),k.push(R[L].x.toFixed(5)),k.push(R[L].y.toFixed(5)),this.checkLimits(R[L].x,R[L].y);k.push("Z");for(let L=1;L<4;L++)k.push(L==1?"M":"L"),k.push(R[L].x.toFixed(5)),k.push(R[L].y.toFixed(5)),this.checkLimits(R[L].x,R[L].y);k.push("Z")}var d=e.color?e.color:"#000000";o="style='fill:"+d+";stroke:none;"+c+"'",h.push("<path "+a+" "+o+" d='"+k.join(" ")+"'/>")}break;case"LWPOLYLINE":{let R=e.vertices,P=R.length,k=[];for(let H=0;H<P;H++)R[H].x*=r,R[H].y*=this._globalScaleY;for(let H=0;H<P;H++){if(k.push(H==0?"M":"L"),k.push(R[H].x.toFixed(5)),k.push(R[H].y.toFixed(5)),R[H].bulge){let U=H<P-1?R[H+1].x:R[0].x,$=H<P-1?R[H+1].y:R[0].y,j=R[H].x-U,Q=R[H].y-$,ne=Math.sqrt(j*j+Q*Q),ve=R[H].bulge%(Math.PI*2),Pe=(ne/2/Math.sin(Math.atan(R[H].bulge)*2)).toFixed(5);k.push("A"+Pe+","+Pe+","+(ve*180/Math.PI).toFixed(5),Math.abs(ve)>Math.PI/2?1:0,ve>0?1:0,U,$)}this.checkLimits(R[H].x,R[H].y)}let L=e.color?e.color:"#000000";o="style='stroke:"+L+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'",e.lineweight>=0&&(o="style='stroke:"+L+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'"),k=k.join(" ")+(e.closed==!0||e.shape==!0?"z":""),h.push("<path "+a+" "+o+" d='"+k+"'/>")}break;case"ARC":{var f=Math.abs(e.angleLength+Math.PI*2)%(Math.PI*2)>Math.PI,p=!1;e.radius*=r,e.center.x*=r,e.center.y*=this._globalScaleY;let R=e.center.x+e.radius*Math.cos(e.startAngle)*r,P=e.center.y+e.radius*Math.sin(e.startAngle)*this._globalScaleY,k=e.center.x+e.radius*Math.cos(e.endAngle)*r,L=e.center.y+e.radius*Math.sin(e.endAngle)*this._globalScaleY;e.extrusionDirectionZ&&(R*=e.extrusionDirectionZ,k*=e.extrusionDirectionZ,p=e.extrusionDirectionZ<0),p=this._globalScaleY<0?!p:p;var g=e.radius;this.checkLimits(R,P),this.checkLimits(k,L);var d=e.color?e.color:"#000000";o="style='stroke:"+d+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'",e.lineweight>=0&&(o="style='stroke:"+d+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'");let U=this.drawArcByRadiusDeg(R,P,k,L,g,f,!p);h.push("<path "+a+" "+o+" d='"+U+"'/>")}break;case"LINE":{if(e.vertices.length<2)break;let R=["M",(e.vertices[0].x*r).toFixed(5),(e.vertices[0].y*this._globalScaleY).toFixed(5),"L",(e.vertices[1].x*r).toFixed(5),(e.vertices[1].y*this._globalScaleY).toFixed(5)];this.checkLimits(e.vertices[0].x*r,e.vertices[0].y*this._globalScaleY),this.checkLimits(e.vertices[1].x*r,e.vertices[1].y*this._globalScaleY);let P=e.color?e.color:"#000000";o="style='stroke:"+P+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'",e.lineweight>=0&&(o="style='stroke:"+P+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'"),h.push("<path "+a+" "+o+" d='"+R.join(" ")+"'/>")}break;case"CIRCLE":{e.center.x*=r,e.center.y*=this._globalScaleY,e.directionZ&&(e.center.x*=e.directionZ),e.radius*=r,this.checkLimits(e.center.x,e.center.y);var d=e.color?e.color:"#000000";o="style='stroke:"+d+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'",e.lineweight>=0&&(o="style='stroke:"+d+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'");let P=e.center.x,k=e.center.y;var m=e.radius;h.push("<path "+o+" "+a+" d='M"+(P-m)+" "+k+"a"+m+" "+m+" 0 1 0 "+2*m+" 0a"+m+" "+m+" 0 1 0 "+-2*m+" 0z'/>")}break;case"TEXT":break;case"SPLINE":{var v=[],_=[];e.periodic=!1;for(var u=0,y=e.periodic?e.numberOfControlPoints-3:e.numberOfControlPoints;u<y;u++)e.controlPoints[u].x*=r,e.controlPoints[u].y*=this._globalScaleY,_.push(e.controlPoints[u]);for(var A=[],u=0,w=e.periodic?_.length+4:e.numberOfKnots;u<w;u++)A.push(e.knotValues[u]);let R=S4e.interpolateBSpline(_,e.degreeOfSplineCurve,A,_.length<40?20:10);if(R.length==0)break;v.push("M"+R[0][0].toFixed(5)+","+R[0][1].toFixed(5)),this.checkLimits(R[0][0],R[0][1]);for(var u=1;u<R.length;u++)v.push("L"+R[u][0].toFixed(5)+","+R[u][1].toFixed(5)),this.checkLimits(R[u][0],R[u][1]);var d=e.color?e.color:"#000000";o="style='stroke:"+d+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'",e.lineweight>=0&&(o="style='stroke:"+d+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'"),h.push("<path "+o+" d='"+v.join(" ")+(e.closed==!0||e.shape==!0?"z":"")+"'/>")}break;case"HATCH":{for(var b=e.color?e.color:"#000000",v=[],C=0;C<e.paths.length;C++)if(e.typeOfPath[C]==4)for(var I=0;I<e.paths[C].numberOfKnots.length;I++){for(var _=[],u=0;u<e.paths[C].numberOfControlPoints[I];u++)_.push(e.paths[C].controlPoints[I][u]);for(var A=[],u=0;u<e.paths[C].numberOfKnots[I];u++)A.push(e.paths[C].knotValues[I][u]);if(v.push("M"+(_[0].x*r).toFixed(5)+","+(_[0].y*this._globalScaleY).toFixed(5)),(e.paths[C].numberOfControlPoints[I]-1)%3==0)for(var x=1;x<e.paths[C].numberOfControlPoints[I];x+=3)v.push("C"+(_[x].x*r).toFixed(5)+","+(_[x].y*this._globalScaleY).toFixed(5)),v.push((_[x+1].x*r).toFixed(5)+","+(_[x+1].y*this._globalScaleY).toFixed(5)),v.push((_[x+2].x*r).toFixed(5)+","+(_[x+2].y*this._globalScaleY).toFixed(5));else for(var x=1;x<e.paths[C].numberOfControlPoints[I]-2;x+=4)v.push("C"+(_[x].x*r).toFixed(5)+","+(_[x].y*this._globalScaleY).toFixed(5)),v.push((_[x+1].x*r).toFixed(5)+","+(_[x+1].y*this._globalScaleY).toFixed(5)),v.push((_[x+2].x*r).toFixed(5)+","+(_[x+2].y*this._globalScaleY).toFixed(5))}else if(e.typeOfPath[C]==1){var T=e.paths[C].points;for(let P=0;P<T.length;P++)T[P].x*=r,T[P].y*=this._globalScaleY;T.length==2&&(v.push("M"+T[0].x.toFixed(5)+","+T[0].y.toFixed(5)),v[v.length-2]&&v[v.length-1].split("M")[1]==v[v.length-2].split("L")[1]&&v.pop(),this.checkLimits(T[0].x,T[0].y),v.push("L"+T[1].x.toFixed(5)+","+T[1].y.toFixed(5)),this.checkLimits(T[1].x,T[1].y))}v.length>0&&(o="fill='#"+b+"'",h.push("<path "+a+" "+o+" d='"+v.join(" ")+"'/>"))}break;case"POLYLINE":{let R=e.vertices;for(let L=0;L<R.length;L++)R[L].x*=r,R[L].y*=this._globalScaleY;let P=[];for(let L=0,H=R.length;L<H;L++)if(P.push((L==0?"M":"L")+R[L].x+", "+R[L].y),this.checkLimits(R[L].x,R[L].y),R[L].bulge&&R[L].flags){let U=L<H-1?R[L+1].x:R[0].x,$=L<H-1?R[L+1].y:R[0].y,j=R[L].x-U,Q=R[L].y-$,ne=Math.sqrt(j*j+Q*Q),ve=R[L].bulge%(Math.PI*2),Pe=ne/2/Math.sin(Math.atan(R[L].bulge)*2);P.push("A"+Pe+","+Pe+","+ve*180/Math.PI+", "+(Math.abs(ve)>Math.PI/2?1:0)+","+(ve<0?1:0)+","+U+","+$)}let k=e.color?e.color:"#000000";o="style='stroke:"+k+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'",e.lineweight>=0&&(o="style='stroke:"+k+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'"),P=P.join(" ")+(e.closed==!0||e.shape==!0?"z":""),h.push("<path "+a+" "+o+" d='"+P+"'/>")}break;case"ELLIPSE":{var O=e.majorAxisEndPoint.x,F=e.majorAxisEndPoint.y,G=e.startAngle,B=e.endAngle,d=e.color?e.color:"#000000";o="style='stroke:"+d+";stroke-width:"+(.5*s).toFixed(5)+"px;"+c+"'";let P=this.ellipseOrArc(e.center.x,e.center.y,O,F,e.axisRatio,G,B);h.push(P.split("style").join(o));break}}return h.join("")}ellipseOrArc(e,t,i,r,s,o,a,l){const c=(_,y)=>({x:_.x*Math.cos(y)-_.y*Math.sin(y),y:_.y*Math.cos(y)+_.x*Math.sin(y)}),u=Math.sqrt(i*i+r*r),h=s*u,d=-Math.atan2(-r,i);if(Math.abs(o-a)<1e-9||Math.abs(o-a+Math.PI*2)<1e-9){var f=e-u,p=t,g=parseFloat(e)+parseFloat(u),m=t,v="M"+f+","+p+"A"+u+","+h+" 0,1,1 "+g+","+m+"A"+u+","+h+" 0,1,1 "+f+","+m;return`<g transform="rotate(${d/Math.PI*180} ${e}, ${t})"><path style d="${v}" /></g>`}else{const _=c({x:Math.cos(o)*u,y:Math.sin(o)*h},d),y={x:e+_.x,y:t+_.y},A=c({x:Math.cos(a)*u,y:Math.sin(a)*h},d),w={x:e+A.x,y:t+A.y},C=(a<o?a+Math.PI*2:a)-o<Math.PI?0:1;return`<path style d="${`M ${y.x} ${y.y} A ${u} ${h} ${d/Math.PI*180} ${C} 1 ${w.x} ${w.y}`}" />`}}spline(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(var t=0;t<this.length-1;t++){var i=this.points[t],r=this.points[t+1];this.centers.push({x:(i.x+r.x)/2,y:(i.y+r.y)/2,z:(i.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var t=0;t<this.centers.length-1;t++){var i=this.centers[t],r=this.centers[t+1],s=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,o=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,a=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+s),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+o),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+a)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+s),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+o),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+a)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}getNaturalKs(e,t,i){for(var r=e.length-1,s=this.zerosMat(r+1,r+2),o=1;o<r;o++)s[o][o-1]=1/(e[o]-e[o-1]),s[o][o]=2*(1/(e[o]-e[o-1])+1/(e[o+1]-e[o])),s[o][o+1]=1/(e[o+1]-e[o]),s[o][r+1]=3*((t[o]-t[o-1])/((e[o]-e[o-1])*(e[o]-e[o-1]))+(t[o+1]-t[o])/((e[o+1]-e[o])*(e[o+1]-e[o])));return s[0][0]=2/(e[1]-e[0]),s[0][1]=1/(e[1]-e[0]),s[0][r+1]=3*(t[1]-t[0])/((e[1]-e[0])*(e[1]-e[0])),s[r][r-1]=1/(e[r]-e[r-1]),s[r][r]=2/(e[r]-e[r-1]),s[r][r+1]=3*(t[r]-t[r-1])/((e[r]-e[r-1])*(e[r]-e[r-1])),this.solve(s,i)}solve(e,t){for(var i=e.length,r=0;r<i;r++){for(var s=0,o=Number.NEGATIVE_INFINITY,a=r;a<i;a++)e[a][r]>o&&(s=a,o=e[a][r]);this.swapRows(e,r,s);for(var a=r+1;a<i;a++){for(var l=r+1;l<i+1;l++)e[a][l]=e[a][l]-e[r][l]*(e[a][r]/e[r][r]);e[a][r]=0}}for(var a=i-1;a>=0;a--){var c=e[a][i]/e[a][a];t[a]=c;for(var l=a-1;l>=0;l--)e[l][i]-=e[l][a]*c,e[l][a]=0}return t}zerosMat(e,t){for(var i=[],r=0;r<e;r++){i.push([]);for(var s=0;s<t;s++)i[r].push(0)}return i}swapRows(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}drawArcByRadiusDeg(e,t,i,r,s,o,a){return"M "+e.toFixed(5)+" "+t.toFixed(5)+" A "+s.toFixed(5)+" "+s.toFixed(5)+" 0 "+(o?1:0)+" "+(a?1:0)+" "+i.toFixed(5)+" "+r.toFixed(5)}}async function M4e(n){var s,o,a;let e,t=Mm.OLD;typeof n=="string"?e=n:(e=n.text,t=((s=n.options)==null?void 0:s.parser)??t);let i,r;if(t===Mm.NEW){const l=new X7.Helper(e);i=l.toSVG();const c=(a=(o=l.parsed)==null?void 0:o.header)==null?void 0:a.insUnits;r=Ppe(c)}else i=await new P4e().parse(e),r=1;return{svgStr:i,unitScale:r}}class R4e{async preprocess(e){var c;let t=0;typeof e!="string"&&(t=((c=e.options)==null?void 0:c.precision)||0);const{svgStr:i,unitScale:r}=await M4e(e),s=window.LinkNative?void 0:"xcsfetch:/",{filePath:o}=await window.MeApi.fileHelper.saveFileWithFetch("temporary","/process_path.source",i,!1,s),a=await window.MeApi.wasmKit.process_path(o,t),l=await window.MeApi.fileHelper.read2Str(a);return{svg:i,res:l,unitScale:r}}destroy(){}}function D4e(n){return new Worker(""+new URL("../assets/dxfWorker-NHk2239M.js",import.meta.url).href,{name:n==null?void 0:n.name})}class k4e extends t_{constructor(){super(D4e)}preprocess(e){return this.request({type:"preprocess",data:e})}}var ZW,C0;class O4e{constructor(){ke(this,C0,(ZW=window.MeApi)!=null&&ZW.wasmKit?new R4e:new k4e)}preprocess(e){return S(this,C0).preprocess(e)}destroy(){S(this,C0).destroy()}}C0=new WeakMap;class eN{constructor(e,t=1){E(this,"workers",{busyness:[],idle:[]});E(this,"WorkerClass",null);E(this,"tasks",[]);E(this,"maxWorkersSize",2);e&&(this.maxWorkersSize=t,this.WorkerClass=e)}buildThread(e){let t=this.maxWorkersSize-(this.workers.busyness.length+this.workers.idle.length);for(;t>0;){const i=Gp(),r=new e;this.workers.idle.push({pid:i,worker:r}),--t}}executeTask(e){return this.WorkerClass?(this.buildThread(this.WorkerClass),new Promise((t,i)=>{e.resolve=t,e.reject=i,this.workers.idle.length>0?this.execute(e):this.tasks.push(e)})):Promise.reject("WorkerClass is not defined")}execute(e){const{resolve:t,reject:i,addCallback:r,...s}=e,o=this.createChannel(t,i),{pid:a,worker:l}=this.workers.idle.shift();this.workers.busyness.push({pid:a,worker:l}),typeof r=="function"&&r(e.type,()=>{o&&o.port1&&o.port1.close();const c=dC(this.workers.busyness,({pid:u})=>a===u);this.workers.idle.push({...c[0]}),this.tasks.length>0&&this.execute(this.tasks.shift()),this.workers.busyness.length===0&&this.clearWorkers(),i(new Error("cancel"))}),l.postMessage({...s,pid:a},[o.port2])}createChannel(e,t){const i=new MessageChannel;return i.port1.onmessage=({data:r})=>{i.port1.close(),e&&e(r.data);const{pid:s}=r,o=dC(this.workers.busyness,({pid:a})=>s===a);this.workers.idle.push({...o[0]}),this.tasks.length>0&&this.execute(this.tasks.shift()),this.workers.busyness.length===0&&this.clearWorkers()},i.port1.onmessageerror=r=>{t(r)},i}clearWorkers(){[...this.workers.busyness,...this.workers.idle].forEach(({worker:e})=>{e&&e.terminate()}),this.workers.busyness=[],this.workers.idle=[]}}function L4e(n){return new Worker(""+new URL("../assets/svgPathCombinedWorker-_qw1yrSb.js",import.meta.url).href,{name:n==null?void 0:n.name})}class N4e extends eN{constructor(){super(L4e,10)}async combinedPath(e,t){const i=[];for(const r in e){const s=e[r];i.push(new Promise(async(o,a)=>{Array.isArray(s.path)||o(s.path);const l={type:"combinedPath",params:[s.path],addCallback:t};try{s.path=await this.executeTask(l),o(s.path)}catch(c){a(c)}}))}return await Promise.all(i),e}}function B4e(n){return new Worker(""+new URL("../assets/potraceWorker-Js0j5xpT.js",import.meta.url).href,{name:n==null?void 0:n.name})}class F4e extends eN{get svgPathCombinedHelper(){const e=Symbol.for("svgPathCombinedHelper");return this[e]||(this[e]=new N4e),this[e]}constructor(){super(B4e,3)}async convertToSvgPath(e,t,i){const{aberrationThreshold:r}=t,{imageData:s,width:o,height:a}=ade(e),l={type:"imageDataToBitmap",params:[s,r,o,a],addCallback:i};console.time("imageDataToBitmap");let c;try{c=await this.executeTask(l)}catch(h){return h.message==="cancel"?"cancel":""}finally{console.timeEnd("imageDataToBitmap")}console.time("generatorPath");const u=await this.generatorPath(c,t,i);return console.timeEnd("generatorPath"),u}async generatorPath(e,t,i){const{aberrationThreshold:r,turdsize:s,alphamax:o,layeredByColor:a}=t;try{let l=await Promise.all(Object.keys(e).map(u=>new Promise(async(h,d)=>{const p={type:"findPath",params:[e[u],r,s,o],addCallback:i};let g;try{g=await this.executeTask(p),h({path:g,color:u})}catch(m){d(m)}}))),c="";return a?(console.time("combinedPath"),l=await this.combinedPath(l,i),console.timeEnd("combinedPath")):c=l.map(({path:u})=>Array.isArray(u)?u.reduce((h,d)=>(d=d.replace(/(.*?<svg[^>]+>)(.*?)(<\/svg>)/,"$2").replace(/(<path\s+d=\")(.*?)(")(.*)/,"$2"),`${h} ${d}`),""):u).join(" "),a?l:c}catch(l){return l.message==="cancel"?"cancel":""}}async combinedPath(e,t){return await this.svgPathCombinedHelper.combinedPath(e,t)}}function U4e(n){return new Worker(""+new URL("../assets/outlineWorker-SJE0bzah.js",import.meta.url).href,{name:n==null?void 0:n.name})}const G4e=2,Bg=100;class H4e extends t_{constructor(){super(U4e)}async getBitmapOutLineSvg(e,t,i){const{bitmapShot:r,displaysBounds:s,bitmapScale:o,potracePath:a,extendPoints:l}=e,{width:c,height:u,canvas:h}=r,d=c/h.width,f=u/h.height,{x:p,y:g}=s;let m="";t!==0?(pde(l,{x:p/d*Bg,y:g/f*Bg}),m=uS(l,{x:Bg/d,y:Bg/f})):m=SA(a).scale(1/o).translate(p,g).toString();let v=Sb(m);return i||(v=await this.request({type:"getRemoveSmallAreaSvg",data:{svg:v}})),v}async getVectorOutLineSvg(e,t){const{vectorDisplays:i,closePathPointsList:r,openPathPointsList:s,shapeExtendPoints:o}=e;if(t===0){const u=await this.request({type:"genVectorZeroOffsetPath",data:{vectorDisplays:i}});return Sb(u)}let a="";if((s==null?void 0:s.length)>0){const u=uS(o,{x:Bg,y:Bg});if(!["M0,0",""].includes(u)){const h=Sb(u);a=await this.request({type:"getRemoveSmallAreaSvg",data:{svg:h}})}}let l="";if((r==null?void 0:r.length)>0){const u=uS(r);if(!["M0,0",""].includes(u)){const h=Sb(u);l=await this.request({type:"genVectorCloseSvg",data:{svg:h,offset:t}})}}let c="";return a&&l?c=await this.request({type:"getUniteResult",data:{svgList:[a,l]}}):a?c=a:l&&(c=l),c}async genOutline(e=G4e,t={addBitmapInner:!0,bitmapPointsList:[]},i){const{addBitmapInner:r=!0}=t;let s="";i!=null&&i.bitmapData&&(s=await this.getBitmapOutLineSvg(i.bitmapData,e,r));let o="";i!=null&&i.vectorData&&(o=await this.getVectorOutLineSvg(i==null?void 0:i.vectorData,e));let a="";const l=hS(s),c=hS(o);return l&&c?(a=await this.request({type:"getUniteResult",data:{svgList:[s,o]}}),a=hS(a)):l?a=l:c&&(a=c),a}cancelGeneral(){this.destroy()}}function V4e(n){return new Worker(""+new URL("../assets/cacheWorker-AEJGm9I_.js",import.meta.url).href,{name:n==null?void 0:n.name})}class z4e extends eN{constructor(){super(V4e,1);E(this,"pendingTask",{tasks:[],clear(){this.tasks=[]},push(t){this.tasks.push(...t)},get(){const t=pn(this.tasks);return this.clear(),t}})}async appendTask(t){this.pendingTask.push(Array.isArray(t)?t:[t])}async fetchProjectCacheUpdateInfo(t,i){const s={type:"fetchProjectCacheUpdateInfo",params:[this.pendingTask.get(),JSON.stringify(t),i]};return await this.executeTask(s)}}function $4e(n){return new Worker(""+new URL("../assets/shapeMatchWorker-51xIikwg.js",import.meta.url).href,{name:n==null?void 0:n.name})}class W4e extends t_{constructor(){super($4e)}async shapeMatch(e,t){return await this.request({type:"getShapeMatchResult",data:{displaysJSON:e,options:t}})}}const{CANCEL_PROCESS:j4e,FINISH_PROCESS:Q4e,START_PROCESS:pV,PAUSE_PROCESS:X4e,DISCONNECT:Pw}=It;var rs,So,cT,ip,E0,T0;class Y4e{constructor(){ke(this,rs,void 0);ke(this,So,void 0);E(this,"MAX_HISTORY_TASKS",20);ke(this,cT,[]);E(this,"taskList",ee({processingTasks:[],historyTasks:[]}));ke(this,ip,void 0);ke(this,E0,ee(!1));ke(this,T0,ee(!1));Qe(this,rs,[]),Qe(this,So,[]),this.updateTask(),Qe(this,ip,setInterval(()=>{this.shouldAutoMoveTaskToHistory()},10*1e3))}get listener(){return S(this,cT)}shouldAutoMoveTaskToHistory(){var t;const e=Date.now();(t=S(this,rs))==null||t.forEach(i=>{if(i.currentStatus===Pw){const r=new Date(i.finishTime).getTime();r&&e-r>30*60*1e3&&this.moveTaskToHistory(i.id)}})}async updateTaskList(e,t){const i=await Nr.readTaskList();i.forEach(r=>{the(r.filePath,e)&&(r.filePath=`${e}_${t}`)}),await Nr.addTaskList(i),Qe(this,rs,[]),Qe(this,So,[]),this.updateTask(i)}async updateTask(e){let t=e;t||(t=await Nr.readTaskList()),t==null||t.forEach(i=>{this.checkCurrentStatus(i)?Qe(this,rs,[...S(this,rs),i]):Qe(this,So,[...S(this,So),i])}),this.updateTaskListValue(S(this,rs),S(this,So));try{const i=t==null?void 0:t.map(o=>o.id),r=await Nr.getLocalTaskDirs();if(!r)return;const s=r.filter(o=>!(i!=null&&i.includes(o)));for(const o of s){const a=`${Js}/task/${o}`;Nr.removeTaskDir(a)}}catch(i){console.log("TaskListManager","init",i)}}checkCurrentStatus(e){return(e==null?void 0:e.currentStatus)&&(window.VITE_PHONE?[pV,Pw,X4e]:Pw).includes(e.currentStatus)&&(e==null?void 0:e.manualSet)===!1}async moveTaskToHistory(e){const t=S(this,rs).findIndex(s=>s.id===e);if(t!==-1){const s=S(this,rs).splice(t,1)[0];S(this,So).unshift(s)}const i=await Nr.readTaskList(),r=i==null?void 0:i.find(s=>s.id===e);r&&(r.manualSet=!0,await Nr.addTaskList(i)),this.callListener()}updateProcessInfo(e){const t=S(this,rs).findIndex(r=>r.id===e.id),i=S(this,So).findIndex(r=>r.id===e.id);if(t!==-1){S(this,rs)[t]=tj(S(this,rs)[t],e,(s,o)=>{if(o===""||o===void 0||o===null||o===0)return s});const r=S(this,rs)[t];([j4e,Q4e].includes(r.currentStatus)||r.currentStatus===Pw&&(r==null?void 0:r.cannotReconnect)===!0)&&(S(this,rs).splice(t,1),S(this,So).length>=this.MAX_HISTORY_TASKS&&S(this,So).pop(),S(this,So).unshift(r),Nr.updateTask(r))}else e.currentStatus===pV&&i===-1&&S(this,rs).unshift(e);this.callListener()}async getValueByTaskId(e,t){const i=await Nr.readTaskList(),r=i==null?void 0:i.find(s=>s.id===e);return r?r[t]:null}async getTaskById(e){const t=await Nr.readTaskList();return t==null?void 0:t.find(i=>i.id===e)}callListener(){const e=[...S(this,rs)],t=[...S(this,So)];this.updateTaskListValue(e,t)}updateTaskListValue(e,t){t.length>this.MAX_HISTORY_TASKS&&(t=t.slice(0,this.MAX_HISTORY_TASKS)),this.taskList.value={processingTasks:e,historyTasks:t}}get hideMinimizedWindow(){return S(this,E0).value}set hideMinimizedWindow(e){S(this,E0).value=e}get isMinimized(){return S(this,T0).value}set isMinimized(e){S(this,T0).value=e}clearInterval(){S(this,ip)&&(clearInterval(S(this,ip)),Qe(this,ip,void 0))}}rs=new WeakMap,So=new WeakMap,cT=new WeakMap,ip=new WeakMap,E0=new WeakMap,T0=new WeakMap;const hs=new Y4e;window.ME.taskListManager=hs;var nv;const Tf=class Tf{constructor(){E(this,"stack",[]);E(this,"callbackPopSet",new Set)}static getInstance(){return S(Tf,nv)||Qe(Tf,nv,new Tf),S(Tf,nv)}has(e){var i;let t=!1;for(let r=0;r<this.stack.length;r++)if(((i=this.stack[r])==null?void 0:i.key)===e){t=!0;break}return t}getIndexByKey(e){var t;for(let i=0;i<this.stack.length;i++)if(((t=this.stack[i])==null?void 0:t.key)===e)return i;return-1}pushPage(e){this.stack.push({key:e})}popPage(e){var t;for(let i=e+1;i<this.stack.length;i++)this.notifyPop((t=this.stack[i])==null?void 0:t.key),this.stack[i]=null;this.stack.splice(e+1)}notifyPop(e){if(e)for(const t of this.callbackPopSet)t(e)}addPopCallback(e){this.callbackPopSet.add(e)}};nv=new WeakMap,ke(Tf,nv,void 0);let bp=Tf;const fa={componentName:"VuePageStack",keyName:"stack-key",pushName:"push",goName:"go",replaceName:"replace",backName:"back",forwardName:"forward"},gV={ELEMENT:1,FUNCTIONAL_COMPONENT:2,STATEFUL_COMPONENT:4,TEXT_CHILDREN:8,ARRAY_CHILDREN:16,SLOTS_CHILDREN:32,TELEPORT:64,SUSPENSE:128,COMPONENT_SHOULD_KEEP_ALIVE:256,COMPONENT_KEPT_ALIVE:512,COMPONENT:6},q4e=n=>Fe({name:fa.componentName,__isKeepAlive:!0,setup(e,{slots:t}){let i=null,r=!0;const s=()=>{i!==null&&r&&bp.getInstance().pushPage(i)};Zn(s),zee(s);const o=N0();return()=>{i=null,r=!0;const a=o.query[n]||"";if(!t.default)return null;const l=t.default(),c=l[0];if(l.length>1)return l;if(!r6(c)||!(c.shapeFlag&gV.STATEFUL_COMPONENT)&&!(c.shapeFlag&gV.SUSPENSE))return c;i=a;const u=bp.getInstance().getIndexByKey(a);return u!==-1&&(bp.getInstance().popPage(u),r=!1),c}}}),cm={action:fa.pushName},K4e=n=>{const e=n.push.bind(n),t=n.go.bind(n),i=n.replace.bind(n),r=n.back.bind(n),s=n.forward.bind(n);n.push=o=>(cm.action=fa.pushName,e(o)),n.go=o=>{cm.action=fa.goName,t(o)},n.replace=o=>(cm.action=fa.replaceName,i(o)),n.back=()=>{cm.action=fa.backName,r()},n.forward=()=>{cm.action=fa.forwardName,s()}};function mV(n,e){return!!n[e]}function J4e(n){return n.replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}const Z4e={install(n,{router:e,name:t=fa.componentName,keyName:i=fa.keyName}){if(!e)throw Error(`
 vue-router is necessary. 

`);n.component(t,q4e(i)),K4e(e),e.beforeEach((r,s)=>{if(mV(r.query,i)){const o=r.query[i];bp.getInstance().getIndexByKey(o)===-1?r.params[`${i}-dir`]=fa.forwardName:r.params[`${i}-dir`]=fa.backName}else{r.query[i]=J4e("xxxxxxxx");const o=cm.action===fa.replaceName||!mV(s.query,i);return{hash:r.hash,path:r.path,name:r.name,params:r.params,query:r.query,meta:r.meta,replace:o}}})}};class Yc{constructor(){E(this,"_uiState",QP(this.createState()));E(this,"uiState",kp(this._uiState));E(this,"_uiEffect",QP({}));E(this,"uiEffect",kp(this._uiEffect));E(this,"eventHandlerMap",new Map);E(this,"_effectScope");this.setEventHandler(),this._effectScope=new pT(!0),this._effectScope.run(this.initWatch.bind(this))}initWatch(){}effectWatch(e){var t;(t=this._effectScope)==null||t.run(e)}registerEventHandler(e,t){this.eventHandlerMap.set(e.name,t.bind(this))}updateState(e){for(const t in e)this.isKey(this._uiState,t)&&(this._uiState[t]=e[t])}isKey(e,t){return t in e}sendEffect(e){for(const t in e)this._uiEffect[t]=e[t]}sendEvent(e){var i;const t=e.constructor.name;return(i=this.eventHandlerMap.get(t))==null?void 0:i(e)}onDestroy(){var e;(e=this._effectScope)==null||e.stop()}}const If=class If{constructor(){E(this,"viewModelMap",new Map);bp.getInstance().addPopCallback(e=>{this.viewModelMap.forEach((t,i)=>{if(i.indexOf(e)===0){const r=t;r&&(r.onDestroy(),this.viewModelMap.delete(e))}})})}static getInstance(){return If.instance||(If.instance=new If),If.instance}getViewModel(e,t,i=!0){let r;return i&&(r=this.getViewModelByKey(e)),r||(r=this.create(t),i&&this.viewModelMap.set(e,r)),r}getViewModelByKey(e){const t=this.viewModelMap.get(e);return t}create(e){return new e}};E(If,"instance");let aE=If;function II(n,e){yt(n,e,{immediate:!1})}function Lo(n,e){yt(n,e,{immediate:!0})}function pg(n,e=!0){var l;const i=((l=N0().query[fa.keyName])==null?void 0:l.toString())||"",r=n.toString(),s=r.length,o=r.slice(s/2,Math.min(s/2+20,s)),a=`${i}-${n.name}_${s}_${o}`;if(e){const c=aE.getInstance().getViewModelByKey(a);if(c)return c}return aE.getInstance().getViewModel(a,n,e)}var pk=(n=>(n.fireWarning="fireWarning",n.noParameters="noParameters",n))(pk||{}),um=(n=>(n.myProject="myProject",n.addProject="addProject",n.homeCaseRecommend="homeCaseRecommend",n.communityCaseRecommend="communityCaseRecommend",n.homeFile="homeFile",n.openProject="openProject",n.cloudClick="cloudClick",n.externalImport="externalImport",n.switchProject="switchProject",n))(um||{}),El=(n=>(n.drawerDetection="drawerDetection",n.exhaustFan="exhaustFan",n.backgroundIntensity="backgroundIntensity",n.buzzer="buzzer",n.flameSensitivity="flameSensitivity",n.flameAlarm="flameAlarm",n.moveStop="moveStop",n.coverOpenPause="coverOpenPause",n.infraredLightPreheat="infraredLightPreheat",n.workReminder="workReminder",n))(El||{}),eVe=(n=>(n.homePage="homePage",n.editPage="editPage",n.connectDevice="connectDevice",n.selectDevice="selectDevice",n.resetDevice="resetDevice",n.addDevice="addDevice",n.obtainPermission="obtainPermission",n.enterPassword="enterPassword",n.deviceHotspot="deviceHotspot",n.connectResult="connectResult",n.setupComplete="setupComplete",n.wifi="wifi",n.hotspot="hotspot",n.hotspotSelect="hotspotSelect",n.ip="ip",n.hotspotConnect="hotspotConnect",n.hotspotSwitch="hotspotSwitch",n))(eVe||{}),eK=(n=>(n.wifi="wifi",n.hotspot="hotspot",n.ip="ip",n))(eK||{}),gk={},Va={},kv={};Object.defineProperty(kv,"__esModule",{value:!0});kv.assertDefined=kv.asyncDecorator=void 0;const tVe=n=>()=>new Promise((e,t)=>{try{e(n())}catch(i){t(i)}});kv.asyncDecorator=tVe;const nVe=(n,e)=>{if(n===void 0||n==null)throw new Error(e);return!0};kv.assertDefined=nVe;var tN={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultDuration=n.setDefaultDuration=n.defaultDuration=void 0,n.defaultDuration=60*1e3;function e(i){n.defaultDuration=i}n.setDefaultDuration=e;function t(){return n.defaultDuration}n.getDefaultDuration=t})(tN);var nN=un&&un.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};Object.defineProperty(Va,"__esModule",{value:!0});Va.isTimeoutError=Va.TimeoutError=Va.waitUntilAsync=Va.waitUntil=Va.wait=void 0;const iVe=kv,tK=tN;function nK(n=tK.defaultDuration){return new Promise(e=>setTimeout(e,n))}Va.wait=nK;function rVe(n,e,t){return nN(this,void 0,void 0,function*(){const i=(0,iVe.asyncDecorator)(n);return yield iK(i,e,t)})}Va.waitUntil=rVe;function iK(n,e=tK.defaultDuration,t=new rK("function did not complete within allowed time")){return nN(this,void 0,void 0,function*(){const i=Symbol("DELAY_EXPIRED"),r=yield Promise.race([n(),sVe(e,i)]);if(r===i)throw t;return r})}Va.waitUntilAsync=iK;const sVe=(n,e)=>nN(void 0,void 0,void 0,function*(){return yield nK(n),e});class rK extends Error{constructor(){super(...arguments),this.isTimeout=!0}}Va.TimeoutError=rK;function oVe(n){return n.isTimeout===!0}Va.isTimeoutError=oVe;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.setDefaultDuration=n.getDefaultDuration=n.waitUntilAsync=n.waitUntil=n.wait=n.TimeoutError=n.isTimeoutError=void 0;var e=Va;Object.defineProperty(n,"isTimeoutError",{enumerable:!0,get:function(){return e.isTimeoutError}}),Object.defineProperty(n,"TimeoutError",{enumerable:!0,get:function(){return e.TimeoutError}}),Object.defineProperty(n,"wait",{enumerable:!0,get:function(){return e.wait}}),Object.defineProperty(n,"waitUntil",{enumerable:!0,get:function(){return e.waitUntil}}),Object.defineProperty(n,"waitUntilAsync",{enumerable:!0,get:function(){return e.waitUntilAsync}});var t=tN;Object.defineProperty(n,"getDefaultDuration",{enumerable:!0,get:function(){return t.getDefaultDuration}}),Object.defineProperty(n,"setDefaultDuration",{enumerable:!0,get:function(){return t.setDefaultDuration}})})(gk);const aVe={announcement:"Announcement",empty:"You have no announcement",no_reminder:"Don't pop up for the next 7 days",network_error:"Network connection failed, please check your network settings",server_error:"Something went wrong, please try again later"},lVe={announcement:aVe},cVe={drop_file:"Drop the file here",add:"Add",rename:"Rename",panel:"Canvas",empty:"Canvas Empty!",context_menu:{insert:"Insert",delete:"Delete",rename:"Rename"},delete_dialog:{title:"Delete",content:"Are you sure you want to delete it?"},delete_dialog_confirm:{title:"Tips",content:"Deletion cannot be undone. Are you sure you want to delete the canvas?"},message:{text_version_not_match:"Due to the upgrade of the 'Text' function, the text size of imported projects may change.",learn_more:"More details"}},uVe={canvas:cVe},hVe={upload_from_computer:"Upload from computer",empty:"Empty",free_count_used:"Free count used",file_title:"File title",file_size:"File size",created:"Created",save_to_computer:"Save to computer",rename:"Rename",delete:"Delete",uploading:"Uploading ...",upload_succeeded:"Upload succeeded",upload_failed:"Upload failed",downloading:"Downloading ... Please wait",tips:"Tips",open_file_in_cloud:"Opening a file stored in Cloud does not modify it.",cancel:"Cancel",confirm:"Yes",delete_file:"Delete file",confirm_delete_file:"Want to delete the file? A file deleted cannot be restored.",space_available_limit:"The space available in Cloud has reached the upper limit. Please delete the files you don't need and then upload files.",confirm_else:"OK",editor:"Back to editor",refresh:"Refresh",remaining_free_count:"Remaining free count",remaining_free_count_tip:"Need more Cloud space? Learn more about Cloud space",view:"View",file_download_completed:"File download completed",secure:"Secure",secure_desc:"Powered by Azure Cloud services, secure, enduring, and highly available",efficient:"Efficient",efficient_desc:"Files can be accessed anytime, improving the creation efficiency",synchronous:"Synchronous",synchronous_desc:"With one xTool account, you can sync files and data in XCS across multiple platforms",try_it_now:"Try it now"},dVe={cloud:hVe},fVe={app:{name:"xTool Creative Space"},menu:{main_menu:"Main Menu",file:"File",check_for_update:"Check for Updates...",quit:"Quit",close:"Close",close_project:"Close Project",rename:"Rename",file_untitled:"Untitled",file_import:"Open project...",file_import_image:"Import image...",file_new:"New",file_save:"Save",file_save_as:"Save as…",file_rename:"Rename",community:"Community",community_home:"Home",community_inspiration:"Inspiration",community_how_tos:"How-tos",community_tips_tricks:"Tips&Tricks",community_ask_me:"Ask the Community",community_discussion:"Discussion",community_weekly_updates:"Weekly Updates",link_info:"Info",link_weekly_updates:"Weekly Updates",link_tips:"Tips & Tricks",link_example:"Projects",link_help:"Support",link_mall:"Shop",setting:"Settings",in_app_project:"In-App Projects",featured:"Featured Projects",machines:"By Machine",materials:"By Material",occasions:"By Occasion",discussion:"Discussion",export_svg:"Export as SVG...",points_history:"Points history",user_setting:"Setting",login:"Log in",logout:"Logout",cloud_projects:"Cloud projects",my_space:"My Space",go_mall:"shop",xtool_projects:"xTool Projects",edit:"Edit",help:"Help",account:"Account",user_center:"User center",points:"Points",safety:"Safety"},msg:{layer_rename:"Layer rename",update_app_required:"The project file is created in a later version of XCS and cannot be opened. You need to update your XCS version before opening the project file.",ok:"OK",cancel:"Cancel",saving:"Saving…",material_loading:"Design elements loading…",project_loading:"Project loading…",save_success:"Saving succeeded",import_font_success:"The font is imported. Restart XCS for it to take effect.",driver_notification_title:"Install driver: {name}",driver_notification_content:`The driver required for your device is missing. Click Install to install it.
After installing the driver, unplug the USB cable from your computer and then plug it in again.`,driver_notification_button_text:"Install",driver_download_fail:"Downloading failed due to network connection exceptions",driver_download_fail_link_href:"https://s.xtool.com/doc/device/device-connection"},project:{project_crash:"Sorry, the project is not responding. You can:",project_restore:"Restore project"},punctuation:{colon:":",percent:"%"},dialog:{tips:"Tips",ok:"OK",confirm_title:"Confirm",rename:"Rename",processing_do_not_close:"The project is in progress. Please wait for the processing to complete before you close it.",create_prompt:"Tips",create_prompt_content:"The maximum number (6) of projects has been reached. Please close some of them and then open a project.",no_more_reminders:"No more reminders"},forward:"Forward",backward:"Backward",refresh:"Refresh",reload:"Reload",close:"Close",copy_link:"Copy link",copy_success:"Copy successfully",copy_failed:"Copy failed",network_error:"Network connection error",network_error_retry:"Network error. Please try again later!",open_in_browser_failed:"Open in browser failed",open_in_browser:"Open in browser","input-multi-state":"Mixed"},pVe={common:fVe},gVe={button:{yes:"YES",no:"NO",ok:"Done",done:"Done",confirm:"Confirm",cancel:"Cancel",save:"Save",choose:"Choose file",update_firmware:"Update firmware",refresh:"Refresh",select_device:"Connect device",connect:"Connect",yes_fit_size:"Yes, scale it to fit on canvas",no_fit_size:"No, display it in the original size",iknow:"Got it",get_help:"Get Help",cache_yes:"Recover",cache_no:"Discard"},link:{device_not_found:"Device not found"},input:{placeholder_file:"File name"},table:{},form:{},checkbox:{remember_choose:"Remember my choice"},modal:{confirm_title:"Confirm",confirm_save:"Save the project?",fit_size:" The image is too large to be displayed on the canvas. Do you want to scale it?",loss_fonts_title:"Typeface not supported",loss_fonts:"The typeface used in the project file is not supported. The missing typeface is replaced with the default typeface.",loss_fonts_description:"The typeface used in the project file is not supported. You can choose to:",loss_fonts_option_replace_font:"Use the default typeface",loss_fonts_option_to_paths:"Convert them into vector paths",project_cache_content:"There's a file unsaved due to an unexpected interruption. Do you want to recover it?"},message:{loading_cache_fail:"Exceptions occur in reading the cache. Recovery failed."}},mVe={component:gVe},vVe={common:{material:"Material",thickness:"Thickness",focal_length:"Focal distance",distance:"Distance",perimeter:"Perimeter",diameter:"Diameter",roller:"Roller",catch:"Chuck",rotary_attachment_type_tip:"In Chuck mode, the maximum processing speed changes with the diameter.",rotary_attachment_type:"Accessory",capture_alignment:"Snapshot preview",slat:"Slat",power:"Power",brush_pressure:"Pen pressure",speed:"Speed",mode:"Mode",pass:"Pass",curve:"Curved surface",view:"View",bitmap_scan_mode:"Engraving mode",z_mode:"Bi-directional",one_way:"Uni-directional",light_source_mode:"Laser Mode",gear_mode:"Gear",offset_z:"Z-offset",blue_light:"Blue light",red_light:"IR",blue_red_light:"Blue Laser&IR laser Process",lines_per_cm:"Lines per cm",bitmap_mode:"Bitmap mode",cut_pressure:"Cut pressure",break_point_cut:"Tab generation",break_point_size:"Tab size",break_point_count:"Number of tabs",break_point_power:"Tab cut power",break_point_mode:"Generate",break_point_by_count:"by number",break_point_by_distance:"by spacing",break_point_distance:"Tab spacing",auto_measure:"Auto-measure",Automatic_measurement:"Auto-measuring ...",quick_measure:"Quick-measure",curve_measure:"Curve-measure",preview:"Preview",rise:"Rise",decline:"Decline",precise_measure:"Aimed-measure",height_raising:"Height raised",none:"No",triangular_prism:"Triangular prism",ok:"OK",cancel:"Cancel",user_defined_material:"User-defined material",refresh:"Refresh",back:"Back",connect:"Connect",password:"Password",wifi_name:"Wi-Fi name",previous_step:"Previous",next_step:"Next",complete:"Complete",grayscale:"Grayscale",bayer:"Bayer",floyd:"Floyd",stucki:"Stucki",atkinson:"Atkinson",jarvis:"Jarvis",sierra:"Sierra",export:"Export",photograph:"Refresh",confirm:"Confirm",reset:"Reset",reset_success:"Reset succeeded",reset_fail:"Homing failed",serial:"Serial port",serial_port:"Serial port",baud:"Baud",crd_card:"Board type",update:"Update",reset_tips:"Are you sure you want to reset it?",yes:"Yes",no:"No",get_help:"Get help",laser_light_mode:"Laser type",platform_speed:"Processing panel moving speed",on:"On",off:"Off",calculate_gcode_tip:"Preparing for preview...",dpi:"DPI",dot_duration:"Dot duration",power_range:"Power range",never_remain:"No more reminders",countdown:"Countdown: ",process_path:"Processing path",process_path_by_auto:"Auto planning",process_path_by_auto_desc:"Engrave first, cutting next",process_path_by_layer:"By layer",process_path_by_layer_desc:"From top to bottom",learn_more:"Learn more",ext_updated_tip:"A new {deviceName} plug-in version is available. Restart XCS for it to take effect.",check_change_log:"Info",ext_drop_success_tip:"The new {deviceName} plug-in version is ready.",not_configured:"Not configured",estimate_time:"Total time estimated",laser_module_trajectory:"Laser module trajectory",planning_mode:"Planning mode",one_by_one:"One by one",all_together:"All together",smart_scan:"Smart",path_only_move:"Path along which the laser module moves without producing laser beams",path_process:"Path along which the laser module produces laser beams",position_for_laser_module:"Position of the laser module",got_it:"Got it",laser_module_position:"Laser module position",processing_path:"Processing path",fill_path:"Scanning path for engraving",auto_planning:"Auto planning",user_defining:"User defining",new_lang_tip:"New language package found. You can restart XCS to use it.",frequency:"Frequency",step:"Step"},mode:{laser_flat:"Process on flat surface",bottom_laser_flat:"Process on baseplate",slats_flat:"Process on slats",laser_curved_surface:"Laser curve",laser_cylindrical:"Use rotary attachment",laser_cylindrical_curved_surface:"Laser cylindrical surface",super_laser_plane:"Use slide extension",laser_conveyor_feeder:"Use conveyor feeder",open_plane:"Baseplate removed",pass_through:"Pass Through",curve_process:"Curved material",blade_cutting:"Blade cut",print_blade_cutting:"Print & blade cut",laser_extender:"Use slide extension",floor_plane:"Process on baseplate",passive_knife:"Fine-point blade",active_knife:"Cutting blade",active_press:"Foil transfer tip",active_disc:"Rotary blade",passive_brush:"Pen drawing",ink_print:"Inkjet printing",screen_print:"Screen preparation",user_defined:"Multi-module processing",function_is_not_supported:"This function is not supported in the selected processing mode.",conveyor_belt:"Use conveyor-batch",conveyor_extension:"Use conveyor-large"},processing_type:{line_cut:"Cut",line_engrave:"Score",fill_engrave:"Engrave",cut:"Cut",engrave:"Engrave",brush_line:"Line drawing",brush_block:"Color filling",ink_print:"Inkjet printing",passive_cut:"Cut",active_cut:"Fine-cut",disc_press:"Rotary cutting",transfer:"Transfer",relief:"Emboss",line_transfer:"线条压印",fill_transfer:"填充压印"},processing_attrs:{select_diff_elements:"You have selected different types of design elements, and therefore you can't modify the parameters all at once.",x_tool_parameter_reference:"Reference",x_tool_parameter_reference_not_supported:"Not supported",user_defined_parameters:"User-defined parameters",parameter_tips:"The outcome of the processing using the recommended parameter settings may be influenced by the ambient environment, material differences, or other objective factors.",know_more:"Learn more ...",out_put:"Output",processing_path_tips:"1. Auto planning:<br/>XCS automatically plans the processing path based on intelligent algorithms. Efficiency comes first.<br/>2. User defining:<br/>You can set the processing paths of some objects.",processing_path_know_more:"Learn more about the options >"},offline_work:{offline_key:"Process what you draw",black_carving:"Laser engrave black patterns",black_cutting:"Laser cut black outline",red_cutting:"Laser cut red outline"},safety:{click_to_learning:"Click to go to Safety training",safety_training_tip:"The device connected is a Class 4 laser machine. For your safety, according to the applicable laws and regulations, please complete laser safety training before operating the device.",safety_always_tip:"You haven't completed the laser safety training. Improper operation of laser machines may cause safety hazards.",safety_always_tip_link:"Complete safety training.",login_learning_complete:"Login succeeded! You have completed the laser safety training for this account."},status:{loading:"Loading...",empty:"Empty",device_not_connected:"Device not connected",please_connect_device:"Please connect a device first.",connected:"Connected",not_connected:"Not connected",taking_picture:"Image capturing, {percent}% loaded",take_picture_success:"Refresh succeeded",take_picture_fail:"Refresh failed",take_picture_fail_link_href:"https://support.xtool.com/hc/en-us/articles/4719484188439-FAQ-on-xTool-M1#%233%20Failed%20to%20capture%20or%20refresh%20the%20image.%20Why%3F",manual_picture:"Manually refresh the image captured ",immediately_refresh:"Refresh"},setting:{change:"Switch device",disconnect:"Disconnect",setting:"Device settings",basic:"Basic info",import:"Import",import_gcode:"Import Gcode",export_gcode:"Export elements on the canvas as GCode",send:"Send",please_upload_gcode_file:"Click to select file",upload_success_tips:"Sending completed. Press the button on your device to start processing.",upload_gcode_tips:"Please delete the following file before selecting a new one",work_info:"Working info",work_param:"Working parameters",model:"Laser model",unrecognized_head_model:"Processing module not recognized",model_head:"Processing module",unrecognized_laser_model:"No laser model recognized",process_head_model:"Processing head model",unrecognized_process_head_model:"Processing head not recognized",unrecognized_laser_faq:"Recognition failed?",name:"Device name",name_is_empty:"Please enter a device name.",name_is_too_long:"Device name too long",serial_num:"Serial number",firmware_version:"Firmware version",check_firmware:"Check for updates",copy:"Copy",device:"Device",edit:"Edit","work-information":"Work information","machine-parameter":"Machine parameter","device-handbook":"Device handbook",position_mode:"Positioning mode",red_cross:"Red cross",laser_spot:"Laser spot",red_dot:"Red dot",red_cross_offset:"Red cross offset",flame_alarm:"Flame alarm",stop_move:"Stops when moved",limit:"Limit switch",standby_time:"Standby time",working_time:"Working time",operating_times:"Operating times",work_log:"Work log",hour:"h",time:"Times",working_parameters:"Parameters",fill_light_brightness:"Fill light brightness",time_continues_work:"Time the exhaust fan continues to work",smoking_fan_laser:"Exhaust fan (for laser processing)",smoking_fan_block:"Fan blocking detection",exhaust_time:"Exhaust time after processing",camera_calibration:"Camera calibration",calibrate:"Calibrate",ranging:"Distance measurement",import_tips:"How do I export a GCode file I need in LightBurn?",backlash:"Backlash",test:"Test",wifi_connected:"Connected",wifi_not_connected:"Not connected",export_success:"Exporting succeeded",export_fail:"Exporting failed",high_sensitivity:"High sensitivity",low_sensitivity:"Low sensitivity",not_show_sensitivity_again:"Do not show again",backlash_title:"Test backlash",open_lid_tips:"Note that the task will be canceled if you open the lid.",backlash_step_0:"Place a basswood board 3mm in the center of the working area.",backlash_step_1:"Press the button on the device to start testing.",backlash_step_2:"Processing...  It may take some time.",backlash_step_3:"Be patient and do not turn off the machine.",backlash_success:"Great! Processing completed",backlash_fail:"Processing failed",cut_press_step_0:"Place a piece of blank A4 paper in the middle of the cutting mat, and place the cutting mat into the device",cut_press_step_1:"Press the button on the device to start processing",cut_press_step_2:"Processing ...",cut_press_step_3:"Select the position corresponding to the lightest cut on the material",cut_press_title:"Cut pressure calibration",cut_press_ok:"Calibration succeeded",cut_press_fail:"Calibration failed",cut_press_img:"Position check",camera_step_0:"Paste two pieces of A4 blank paper or a piece of A3 blank paper in the center of the baseplate. Ensure that the paper is pasted flat on the baseplate.",camera_step_1:"Press the button on your device to start processing.Exercise caution when processing flammable materials. Do not leave the device unattended when it's working.",camera_step_2:"Calibrating...",camera_step_3:"Check whether the points on the material overlap with the calibration lines.",camera_success:"Camera calibration completed",camera_fail:"Camera calibration failed",camera_step_start:"Start",camera_tips:"Camera calibration can help improve the image positioning accuracy of xTool M1 to the factory level, that is, about 2 mm.",purifier_timeout:"Time the purifier continues to work",purifier_check:"Purifier check",output_power:"Lowest output power",light_path_title:"Optical path setup",light_tips:"When do I need to set up the optical path?",light_path_tips_1:"Follow the instructions to set up",light_path_tips_2:"How to set up the optical path",light_path_check:"Optical path test",light_path_warn:"Close the lid before you click Pulse. Do not open the lid before it is unlocked when the release of a laser beam is complete.",pulse_tips:"Close the lid before you click Pulse.",pulse:"Pulse",laser_head_tips:"Move the laser module to facilitate the setup of the reflector. Do not move it manually.",move_distance:"Distance",move_laser_head:"Move laser module",click_view:"Click to view",light_path_helper_link:"https://support.xtool.com/hc/en-us/articles/12823378816151",handheld:"Stops when moved",auto_vertical_origin:"Auto origin calibration at startup",open_gap_stop_work:"Stops when enclosure opened",infrared_light_preheat:"Infrared ray preheat",infrared_light_preheat_info:"When you process with the infrared ray under the low temperature environment, you can enable the preheat function to get better results.",infrared_light_preheat_info_link:"When should I enable the preheat function?",delay_time_setting:"Engraving delay settings",open_light_delay_time:"Start delay",corner_delay_time:"Turning delay",close_light_delay_time:"End delay",close_light_local_delay_time:"Delay in the end position",jump_local_delay_time:"Delay after a jump",jump_length_delay_time:"Delay in a jump distance",close_laser_speed:"Speed after end",dot_location_finish:"Delay after dot",setting_error_in_processing:"The device is processing. Please try again later.",open_gap_stop_tips:"Processing is paused when you open the lid during processing. To use xTool F1 with the lid opened, you need to disable this function.",check_drawer:"Baseplate detection",air_pump_title:"Airflow of air pump",req_timeout:"Request timed out. Please try again.",beeper_enable:"Buzzer reminders",beeper_enable_tip:"If it is enabled, the buzzer sounds when the device enters some states, such as ready for processing, processing completed, and so on.",flame_alarm_confirm:"No flame alarm will be triggered if you disable it. Fires may cause serious injuries and property damage. Are you sure you want to disable it?",ext_version:"Plug-in version",has_new_ext_version:"has new version",update_new_ext_version:"Update",use_new_ext_version_after_reopen:"Restart to use new version",upload_ext_fail:"The file cannot be recognized. Plug-in installation failed.",part_info:"Accessory Information",airAssist_v2:"Smart Air Pump 2.0",airAssist_v2_tips:"When cutting, large airflow can ensure better processing results. For materials such as acrylic, large airflow may affect the cutting ability, you can adjust the airflow as needed.",airAssist_v2_firmware:" Smart Air Pump 2.0 Firmware Version",cutting_airflow:"Cutting Airflow(%)"},connect:{firmware:"Firmware",usb:"USB",wifi:"Wi-Fi",eth:"Ethernet",wifi_config:"Wi-Fi setting",wifi_config_button_label:"Setting",hotspot_password:"Hotspot Password",hotspot_password_button_modify:"Change",wifi_config_failed:"Wi-Fi setting failed!",ip:"IP",hotspot:"Hotspot",ip_connection:"IP connection",wifi_configuration:"Wi-Fi configuration",usb_connection:"USB connection",wifi_setting:"Wi-Fi setting",searching:"Searching...",connect_break:"Device disconnected",can_not_find_device:"Can't find your device?",no_device_find:"Can't find device connected through {device}.",password_input_error_massage:"Please enter the password. To ensure device security, routers without passwords are not supported.",wifi_input_error_massage:"Please select Wi-Fi",usb_connect_step_0:"Power on the device.",usb_connect_step_1:"Connect the device to your PC through a USB cable.",usb_connect_step_2:"Select your device from the list and click Next.",usb_input_placeholder:"Please select a USB device",connect_wifi_success_tips_0:"Wi-Fi configuration is complete.",connect_wifi_success_tips_1:"Now disconnect the USB cable and try operating your device wirelessly.",ip_input_error_massage:"Please enter the IP address in the proper format.",enter_ip_address:"Enter the IP address of the device",wifi_connect_error_tips_0:"Ensure that the device is powered on.",wifi_connect_error_tips_1:"Ensure that the device and your PC are using the same Wi-Fi network.",wifi_connect_error_tips_2:"Click Refresh.",wifi_connect_error_tips_3:" If the connection fails, click Wi-Fi setting to configure your device.",choose_network:"Please select a network to join by the device",device_list:"Devices list",switch_device:"Switch device",switch_device_content:"Switching the device will reset the parameters. Are you sure you want to switch it?",switch_device_content_new:"The device to be switched to differs from that in the project file. The settings of the processing mode, material, and other parameters may be changed. Are you sure you want to switch the device?",switch_device_content_power:"The processing module of the device selected does not match the parameter settings in the project file. To ensure proper processing, you need to change the involved parameter settings. Do you want to change them?",no_eth_device:"Can't find device connected through Ethernet",no_usb_device:"Can't find device connected through USB",no_wifi_device:"Can't find device connected through Wi-Fi",connect_failed:"Connection failed",device_refresh:"Refreshing the device list ..."},firmware:{update:"Update firmware",need_update:"The firmware version is an early one. It is recommended that you update it.",current_version:"Current version",latest_version:"Latest version",update_now:"Update",not_now:"Not now",later_remind:"No reminder for three days",tips:`Firmware updating... 
It may take some time. Please do not shut down the device and wait patiently for it to complete.`,succeeded:"Firmware update succeeded",failed:"Firmware update failed",app_version_low:"You are using an earlier firmware version and software version. Please update the software before updating the device firmware.",latest_firmware:"The current firmware version is the latest one.",retry:"Retry",close:"Close",cancel:"Cancel",done:"Confirm",next:"Next",version:"Current firmware version: ",download_fail:"Firmware download failed",downloading:"Firmware downloading... {percent}% downloaded",uploading:"Firmware uploading... {percent}% downloaded",updating:"Firmware updating...",updating_tip1:"Firmware updating... {percent}% completed",updating_tip2:"Disconnection may occur during software update. Please be patient, and do not turn off the device.",need_update_firmware:"A new firmware version is found: {latestVersion}, it's recommended you update the version.",force_update_firmware_1:"The new firmware version {latestVersion} is found.",force_update_firmware_2:"It has updated or improved some key functions. To ensure the proper operation of your device, you need to update it to the new version.",force_update_tips:"A mandatory firmware version is found. To ensure the proper operation of your device, you need to go to Settings to update the firmware.",helper:"Getting help",empty_ext:"Updating firmware after connecting the device",find_new_version:"New firmware version found",busy_tips:"The device is working. Please update the firmware later.",upload_on_tip:"Before firmware update, ensure that the Update switch is turned on, or the update may fail.",upload_off_tip:"Turn off the Update switch, or the processing may be interfered.",tips_confirm:"It is ON",update_tool_title:"Firmware update tool",update_tool_tips:"Select the firmware or drag it here",new_firmware:"Latest firmware",local_firmware:"Firmware from local disk",update_later:"Not now",update_must_tips:"The new firmware version has improved some key functions. To ensure the proper operation of your device, you need to update the firmware.",download:"Downloading firmware",update_success:"Updated successfully"},process:{hour:"hour",minutes:"min",second:"s",actual_processing_time:"Time used {time}",save_tip:"Do not leave the device unattended when it is working.",move_laser_module:"Move laser module",distance:"Distance",speed:"Speed",laser_spot:"Laser spot",low_light:"Low Light",enable:"Enable",disable:"Disable",origin:"Origin",minimize:"Minimize",click_start_point:"Click to set the start point of the processing on a design element.",preview_start_point:"Preview the start point of the processing on a design element.",start_processing:"Start",send_gcode:"Start",cancel_processing:"Cancel",pause:"Pause",estimated_time:"Estimated time: ",left_process_time:"Left time: ",time_used:"Time used: ",paused:"Paused",complete:"Complete",ready:"Ready",ok:"OK",task_canceled:"Task canceled",framing:"Framing",stop_framing:"Stop Framing",framing_power:"Light power",framing_power_tip:"Note: The material may get burnt if the light power is set too high!",framing_settings:"Framing settings",setting:"Setting",framing_speed:"Speed",framing_mode:"Mode",framing_rect:"Rect",framing_outline:"Outline",sending_the_file:"Sending the file for processing ... ",send_success:"Sending file succeeded",task_done:"Complete",task_completed:"Complete",confirm_cancel_task:"Confirm to cancel the task",file_done_and_start:"Press the button on the device to start processing. Exercise caution when processing flammable materials .",fire_warning_tips:"Do not leave the device unattended when it is working.",again_processing_tips:"Press the button on the device to start processing. Exercise caution when processing flammable materials .",processing:"Process",continue:"Continue",preview_processing:"Preview",processing_status_2_step:`Press the button on xTool to start processing.
To avoid fire risk, handle flammable materials with care. Do not leave the device unattended when it is working.`,walk_border:"The framing function is ready. Press the button on the device to start framing, and press it again to perform framing once more.",tf_tips:"Ensure that you've inserted the TF card",task_canceled_title:"Task canceled",task_canceled_text:"The current processing task has been canceled",less_than_one_minute:"Less than 1 minute",more_than_999_hours:"Greater than 999 hours",minute:"min",is_processing:"Processing",btn_is_processing:"Processing...",no_elements:"No design elements are available on the canvas.",no_tf_card:"No TF card is detected in the device. Please insert the TF card, restart the machine and try again.",catch_data_empty:"Perimeter or diameter needs to be added in Chuck mode",device_is_offline:"The device is offline. Please connect the device.",thickness_is_empty:"Processing exceptions may occur if Thickness is empty.",focal_length_is_empty:"Processing exceptions may occur if Distance is empty. ",drawer_is_open:"The baseplate is not installed properly. Please install it in place.",drawer_is_close:"Please take out the baseplate first and measure the distance again.",disconnect:"The device has been disconnected",disconnect_tip:"Pay attention to the material processing status of the device. To pause or cancel the processing, perform the corresponding operation on the device.",unit_mm:"mm",unit_mm_s:"mm/s",no_vector_elements:"No vector elements are available",element_out_zoom:"The element is placed out of the processing area.",walk_border_out_zoom:"Some elements are out of the framing range. Please rearrange them.",file_is_too_large:"The processing file generated is too large. Please set the parameter Lines per cm or Pass to a smaller value.",file_is_too_large_link_href:"https://s.xtool.com/doc/editor/gcode-large",device_is_working:"The device is working. Please try again later.",request_status_fail:"Error! Can’t find out the working status of the device",gcode_upload_fail:"Sending file failed. Please try again later.",gcode_upload_success:"Sending file success",print_fail:"Printing failed",gcode_is_too_large:"When the size of the Gcode file generated is greater than 512M, the file cannot be previewed.",gcode_is_too_large_link_href:"https://s.xtool.com/doc/editor/gcode-fail",print_graph:"Print pattern",put_material:"Place material",process_preview:"Preview",print_cut_step_1:"Use a printer to print the pattern on a material ",print_cut_step_2:"Place the printed material into the device",print_cut_step_3:"Start blade cutting. Estimated time: {time}",put_material_step_1:"Align the printed material with the grid of the cutting mat, and place it on the cutting mat",put_material_step_2:"Align the cutting mat with the sides of the device, and place it on the baseplate",number_1:"1.",number_2:"2.",prev_step:"Previous",next_step:"Next",print:"Print",bitmap_missing:"Please add the pattern to be printed",vector_missing:"Please add the cutting path of the pattern to be printed",material_identification_failed:"Material recognition failed. Please place the material in the center of the working area, or print the pattern on the material again.",new_material_identification_failed:"Material recognition failed. Please place the material in the center of the working area, and then open and close the lid to refresh the image captured.",material_identification_success:"Material recognition succeeded",cut_print_max_size_tip:"Max. processing area: 182mm * 269mm",over_temperature_tip:`When the indicator lights up in yellow, over-temperature protection is triggered.
When this happens, please stop processing, wait for the laser module to cool down and the indicator to go off, and then start your processing again.`,air_assist_set_tip_for_40w:"If you use the 40 W laser module, turn on the air assist set before you start the processing to ensure better processing results.",cylinder_red_cross_warning_tip:"It is detected that you are using the Laser cylindrical mode. Please set the positioning mode to laser spot instead of red cross.",prepare_preview:"Preparing for preview...",resize_preview:"Restore to fit on screen",gap_check_close_tips:"Close the enclosure or disable the Stops when enclosure opened function",go_to_close:"Disable",no_key_lock:"The operation access control key is not inserted. Please insert the key properly on the device.",extend_walk_border_tip:"In framing, turn the knob to move the processing panel. You can stop turning the knob to stop the processing panel, observe where the laser light falls on the material, and adjust the position of the material.",extend_walk_border_tip_modal_head:"Framing operation",ir_heating:"Infrared ray preheating...",process_after_heat:"Start to process automatically when the countdown is completed.",heating_save_tip:"Do not open the lid and move the materials when preheating. Or you may get hurt.",edge_collision_prompt_title:"Processing speed may be too high",edge_collision_prompt:"The elements on the canvas edge may not be properly processed with the current speed setting. You are advised to set a lower speed or move the elements to the center of the canvas.",edge_collision_prompt_confirm:"Process anyway",break_point_build_fail_tip:"Partial breakpoint generation failed and will not be processed",in_initialization_status:"The device is initializing, please try again later",in_set_wifi_status:"Distribution is in progress. Please try again later.",in_frame_ready_status:"Walking Edge State Ready State",in_frame_working_status:"out-of-box state",in_processing_ready_status:"Process ready status",in_processing_status:"processing state",in_pause_processing_status:"Machining pause status",in_updating_firmware_status:"Update Firmware Status",in_sleeping_status:"sleep state",in_cancel_processing_status:"Cancellation of processing status",in_finish_processing_status:"Finished processing status",in_processing_limit_status:"Machining Limit Status",interrupted_tip:"If the current equipment is still processing, reconnecting the equipment can resume the processing process. If no processing is performed for 30 minutes, it will automatically be moved to the historical task.",interrupted_at:"Interrupted at ",done_in:"Done in",history_tab_tip:"Only 20 recent historical tasks can be retained. When exceeded, the oldest historical tasks will be automatically cleared.",history:"History",take_time:"Takes",process_path:"Processing path",processing_task_tip:"You can view the ongoing tasks in the task list.",cancel_task:"Cancel task",continue_task:"Continue task",restart:"Restart",remove:"Remove",view_files:"View files",how_to_resolve:"Solution",calculating:"calculating...",before_process_default_data_tips_title:"Tips",before_process_default_data_tips_content:"It is detected that the power is set to {power} for one or more objects. Please set the power properly, or the processing result may be poor.",before_process_default_data_tips_cancel:"Ignore",before_process_default_data_tips_confirm:"Adjust"},color:{black:"Black",red:"Red",orange:"Orange",yellow:"Yellow",green:"Green",cyan:"Cyan",blue:"Blue",purple:"Purple",white:"White",water_blue:"Aqua",light_blue:"Pale blue",light_green:"Pale green",light_grass_green:"Light grass green",light_yellow:"Primrose",light_orange:"Light orange",light_red:"Light red",light_pink:"Light pink",light_purple:"Pale purple",grey:"Gray",lake_blue:"Lake blue",azure:"Sky blue",grass_green:"Grass green",pink:"Pink",dark_blue:"Dark blue",daisy:"Bluish",dark_green:"Dark green",olive_green:"Olive green",dark_yellow:"Deep yellow",brown:"Brown",dark_red:"Deep red",pink_purple:"Lilac",dark_purple:"Amaranth"},d1:{cylinder_connected_placed_tip:"Ensure that you have connected and placed the Rotary Attachment properly"},d1pro:{process_start_point:"Processing start point",device_relative_position:"Relative coords",device_absolute_position:"Absolute coords",back_origin:"Laser module homing ...",walk_border_forward_back_origin:"Wait for the homing to complete before you press the button on the device for framing. You can press the button again to perform framing.",cylinder_connected_placed_tip:"Ensure that you have connected and placed the Rotary Attachment properly",screen_print_tip:"To use the Screen print mode, you need to complete origin calibration. Ignore this if it is already done. ",reset_measurement_tips:"Perform the calibration again if you've installed another screen and frame or replaced the laser module.",how_use_origin_calibration:"Use the arrow icons to position the laser module so the laser spot falls perfectly at the upper right corner of the screen frame.",screen_print_origin:"Screen processing origin",back_origin_unable_cancel:"The device cannot be cancelled in the home position"},f1:{cylinder_connected_placed_tip:"Ensure that you have connected and placed the Rotary Attachment properly",walk_border_follow_stop:"Framing is stopped due to processing mode change."},p2:{drain:"Exhausting gas",drain_info:"Please do not open the lid before the exhaust is finished",cylinder_alive_tip:"Ensure that the red spot falls at the highest point of the cylinder.",remove_slat_tip:"Ensure that the slats are removed.",curve_alive_tip:"In this mode, do not align your elements directly based on the image captured.",exhaust:"Smoke exhaust (after processing) ",exhaust_time:"Exhaust time after processing",low_power:"Lowest output power",accessory_settings:"Accessory settings",finish_reset:"Convey the material back after processing",hand_measure_with_hand_step_1:"1. Measure the distance (mm) between the top of the laser module and the upper surface of the material with a ruler.",hand_measure_with_hand_step_2:"2. Subtract {unit} from the measured result.",hand_measure_with_hand_title:"Manual Measurement",hand_measure_with_hand_tips:"1. Measure the distance (mm) between the top of the laser module and the upper surface of the material with a ruler.<br/>2. Subtract 3mm (0.118in) from the measured result.",error_sub_type:"The file includes a processing mode not supported and can't be opened currently.",flame_sensitivity:"Flame sensing sensitivity",flame_sensitivity_low:"Low",flame_sensitivity_mid:"Medium",flame_sensitivity_hight:"High",smoking_fan:"Exhaust fan",exposure_increase:"Background brightness increase",exposure_increase_tip:"It helps you see black materials more clearly inside the machine. Refresh the image captured after enabling it.",sub_type_lable:"Laser safety classification",sub_type_one:"Class 1",sub_type_four:"Class 4",sub_type_undefined:"Unknown",clean_baseplate:"Clean the baseplate if there are any residues on it.",fireproof_title:"Tips",fireproof_tips_1:"A high power and low speed have been set for this processing task:",fireproof_tips_2:"Ensure that the baseplate is clean without any wood or other combustible residues.",fireproof_tips_3:"Pay attention to the material processing status inside the machine.",fireproof_tips:`A high power and low speed have been set for this processing task:
1. Ensure that the baseplate is clean without any wood or other combustible residues.
2.Pay attention to the material processing status inside the machine.`,ok_process:"OK, process",close_gap_process:"The lid is not closed. Please close the lid before processing.",buzzer:"Buzzer"},m1:{cylinder_alive_tip:"Ensure that the red spot falls at the highest point of the cylinder."},m1lite:{drain:"Exhausting gas",drain_info:"Please do not open the lid before the exhaust is finished",identify_head_title:"Please follow the prompts to install the corresponding machining tools",identify_head_tips:"Do not add tools",identify_head_help:"How to install",identify_laser_head:"Laser module",identify_print_head:"Ink module",identify_knife_head:"Cutting blade",head_installed:"was installed",walk_border_speed:"Framing Speed",xy_speed:"XY speed",xy_distance:"XY distance",laser_head_position:"Red cross positioning",mark:"Mark",active_laser_head:"Laser module",active_printer_head:"Ink module",active_knife_head:"Cutting blade",active_press_head:"Foil transfer tip",active_disc_knife:"Rotary blade",passive_brush_head:"Drawing pen",passive_knife_head:"Fine-point blade",base_board:"Baseplate",heighten:"Riser base",base_board_heighten:"Baseplate/Riser base",mark_processing_area_info:"Move the carriage to mark multiple points to define the processing area. Press the button on the device to mark each point. (Note: The processing area is defined based on the marking sequence. After the marking is completed, an enclosed processing area is defined on the canvas.)",clear_mark_data:"The processing areas defined on the canvas will be deleted. Are you sure you want to delete them?",point_again:"Mark again",point_confirm:"OK",button_confirm:"Confirm",button_cancel:"Cancel",foundation_bracket:"Basic carriage",multi_function_bracket:"Multi-function carriage",current_task_take_time:"Estimated time for the task in progress",all_task_take_time:"Estimated time for all the tasks",task:"Task",measuring_work:"Distance measuring for laser processing ... Do not move the device.",measuring_work_err:"Failed to measure the distance. Please try again or enter the distance value.",processing_info:"Processing information",processing_check:"Processing detection",processing_baseboard:"Baseplate",attention:"Attention",current_module_attention:"The processing module is {headModel}, please pay attention to the following:",material_tips:"Material: Acrylic is flammable. Please process it with caution.",params_tips:"Processing parameters: The values of the parameters are the default ones. Please modify them.",rotate_attachment:"RA: Ensure that the rotary attachment {rotate} has been installed properly.",ink_many_tip:"Remaining ink: Please pay attention to the amount of ink left in the cartridge. If it's running low, refill it.",brush_many_tip:"Remaining ink: Please pay attention to the amount of ink left in the drawing pen. If it's running low, replace it.",board_tip:"Cutting mat: To prevent the blade from damage, place the cutting mat properly on the baseplate.",process_effect_tip:"Processing result: For a raised effect, cover foil on the material first.",not_valid_head:"The {head} installed does not match. Please change it.",driving_unlock:"The processing module is not properly locked by the locking bar. Please lock it and try again.",no_foundation_bracket:"No {header} is detected on the {bracket}. Please install it properly.",no_head_driving_unlock:"The processing module on the xxx is not properly locked by the locking bar. Please lock it and try again.",please_reset_home:"Complete laser module homing first",measure_timeout:"Measurement timed out. Please try again.",out_of_max_range:"The material is too far away from the processing module and the distance cannot be measured. Please raise it closer to the processing module.",out_of_min_range:"The material is too close to the processing module and the distance cannot be measured. Please move it farther from the processing module.",head_is_not_correct:"Please install the required processing module first.",break_operation:"Operation interrupted. Please close the lid and try again.",no_people:"Do not leave the machine unattended during processing.",work_finish:"Processing completed",current_task_finish:"The task is complete.",please_click_next:"Click 'Next' to proceed to the next task.",total_working_time:"Total time:",current_laser_measure_err:"Failed to measure the distance. Please try again or enter the distance value.",no_move_device:"Distance measuring for {head} processing ... Do not move the device.",accessory_settings:"Accessory settings",purifier_working:"Purifier working time after processing",lower_focus:"Lower the focus",open_lower_focus:"To cut a thick material, you can enable 'Lower the focus' to get a better result.",learn_more:"Learn more",by:"By",heighten_remove:"Note that the riser base has been removed.",heighten_remove_install:"The riser base has been removed. Please change the processing mode or install the riser base again.",heighten_install_success_distance:"The riser base is installed, which widens the processing range.",heighten_install_success:"The riser base is installed properly.",usb_install:"The USB key has been inserted.",usb_remove:"The USB key has been removed.",smoking_no_install:"The exhaust fan is not installed. Please install it and try again.",x_axis:"X-axis lines per cm",y_axis:"Y-axis lines per cm",ink_get_block:"The ink module is easy to get blocked due to the ambient environment and other factors. To ensure better processing results, please test it before processing.",ink_module_test:"Ink module test",install_ink_paper:"Paste the sticker in the preset area.",ink_test:"Test",ensure_result:"After completing the test, examine the test paper. Ensure that the printing is clear and the ink module remains unblocked. If the ink module is blocked, gently wipe it with soft tissue paper and perform another test.",see_help:"Help",done:"Done",pass_number:"Pass",xtool_pen:"xTool Drawing Pen",user_defined_pen:"Custom pen",pen_manger:"Drawing pen settings",manger:"Manage",user_pen_open_tip:"Make sure that your pen is compatible with the xTool pen holder. After selecting 'User-defined pen', you are allowed to process with the lid opened. For your safety, remove the blade module from the multi-function carriage before processing, and do not put your hands into the processing area during processing.",pen_press:"Pen pressure",intensity:"Intensity",brightness:"Brightness",contrast:"Contrast",laser_type:"Style",xtool_brush:"fine point pen",work_voice:"Buzzer",tips:"Tips",stroke:"Stroke",stroke_tip:"If you disable it, the object will not be processed with an outline.",pressure:"Pressure",material_right_header:"It is recommended to use {header} to cut this material.",change_knife_tip:"Note that the processing module changes accordingly after you change the material.",custom_brush_not_enable:"Custom pen not enabled",choose_you_brush:"A custom pen is used in the project file. You can:/n(Note: Make sure that the custom pen is compatible with the xTool pen holder. After you enable the custom pen, processing can be done with the lid open. To ensure safety, when using a custom pen, remove the blade first and keep your hands away from the processing area.)",open_brush_permission:"Enable custom pen",replace_other_brush:"Replace with xTool pen of similar color",no_custom_brush:"Custom pen not found",no_custom_brushes:"The following custom pens used in the project file are not found. They will be replaced with xTool pens of similar colors.",no_xtool_brush:"xTool pen not found",no_xtool_brushes:"The following xTool pens used in the project file are not found. ",has_xtool_brush:"I have purchased xTool pens. Click to use.",no_this_xtool_brush:"xTool pens not purchased. Use pens of similar colors.",confirm_open_permission:"Make sure that the custom pen is compatible with the xTool pen holder. After you enable the custom pen, processing can be done with the lid open. To ensure safety, when using a custom pen, remove the blade first and keep your hands away from the processing area.",add:"Add",delete:"Delete",edit:"Edit",pen_name:"Name",pen_type:"Type",pen_stroke:"Stroke size",pen_color:"Color",pen_save:"Save",pen_cancel:"Cancel",mark_pen:"Maker",ball_pen:"Ballpoint pen",water_pen:"Watercolor pen",other:"Other",delete_custom_brush:"Delete custom pen",confirm_delete_custom_brush:"Are you sure you want to delete the custom pen?",pen_limit_tip:"The number of custom pens has reached the upper limit. Please delete unnecessary ones.",brush_fill_mode:"Filling mode",meander_brush:"Meander",spiral_brush:"Spiral",line_brush:"Line",element_out_canvas:"The object to be printed is out of the processing area.",print_not_in_area:"Do not place objects in this area. The ink module can't process them.",no_support_params:"Creating material test array is not supported currently.",red_cross_out_range:"The red cross is out of the processing area. Please move the laser module to the processing area.",task_max_tips:"Too many processing tasks. Please simplify the drawing or reduce processing modules.",work_head_type:"Processing module type",work_head:"Processing module",only_preview_current_task:"Preview tasks in progress only",no_install_header:"No {header} installed",current_unreset_home:"Please {operate} and complete laser module homing. Otherwise, the processing position may be wrong.",close_gap:"Close the lid",install_usb_key:"Insert the USB access-control key.",install_border_heighten:"Install the baseplate or riser base.",close_heighten_door:"Close the front panel of the riser base.",close_gap_reset:"Home laser module",first_close_gap:"Please close the lid first.",close_gap_process:"Please close the lid before processing.",use_usb_key:"The operation access control key is not inserted. Please insert the key properly on the device.",no_board_heighten:"No riser base or baseplate is detected. Please install one.",no_heighten_door:"The front panel of the riser base is not closed properly. Please close it.",border_heighten_tip:"No {boardOrHeighten} is detected. Please install it properly.",for_you_safety:"To ensure safety, remove the blade first.",right_install_frame:"Install the frame fixing piece on the right side. You need to reflect the pattern horizontally.",laser_head_exceed_area:"The red cross is out of the processing area.",mark_processing_area:"Mark processing area",smoking_fan_block_tip:"After you disable this function, XCS will not remind you of exhaust fan blocking. Fan blocking may cause poor processing results, and you need to pay close attention to the processing status. Are you sure you want to disable it?",smoking_fan_auto:"Exhaust fan speed setting",air_assist_auto_fix:"Auto-adjustment for the air assist set",ink_test_tip:"Test the ink module before processing.",ink_install_tip:"Install the ink module on the multi-function carriage. Close the lid and click Test.",preset_test:"Test in preset area",current_test:"Test in current position",under_ink_module:"Paste the sticker under the ink module.",ink_test_tips:"The ink module can get blocked easily. Test it before processing.",ink_maintenance:"Ink module test",beeper_tip:"After you disable it, XCS beeps only when exceptions occur.",before_ink_process:"Before processing, slide the placing board along the handle to fit it on the baseplate, and then remove the lower cover from the ink module and put it on the placing board.",chang_laser_header:"The laser module has been replaced successfully.",ink_offset:"Inkjet offset",ink_x_offset:"x-offset",ink_y_offset:"y-offset",ensure_type_c:"Ensure that the ink module connection cable is properly connected to the multi-function holder.",rectangle:"Rectangle",rectangle_tip:"Mark two points on different horizontal lines to form a rectangle.",circle:"Circle",circle_points3:"Mark any three points not on the same line to generate a circular processing area.",same_line_points3:"The three points cannot be on the same line.",polygon:"Polygon",polygon_tip:"Mark three points or more, and end the marking. The first and last points are connected to form a polygon.",line:"Line",line_tip:"Mark at least two points to form a circle.",end_marking:"End marking",marking_operate1:"Select a marking mode",marking_operate2:"Move the laser module to the target points, and press the button on the device to mark the points.",measure_processing_area:"Mark processing area",exit_yes:"Yes",exit_cancel:"Cancel",marking_exit:"Marking is not finished. Are you sure you want to quit? Data is cleared on exit.",measure:"Start marking",not_enough_points:"Not enough points to form a shape.",marking_mode:"Marking mode",mark_point:"Point",mark_point1:"Mark points to define a processing area"},s1:{cylinder_connected_placed_tip:"Ensure that you have connected and placed the Rotary Attachment properly",curve_alive_tip:"Curved surface processing instructions",point:"Vertex",cutting_drop_tip:"To cut a thick material, you can enable Lower the focus to get a better result.",learn_how_to_measure:"How to perform manual-measure",how_to_measure_tip:"Obtain distance through auto-measure or manual-measure",laser_tempter:"Temperature of the laser module: {tempter} ℃",focal_length_is_empty:"Processing exceptions may occur if Distance is empty.",laser_head_position:"Laser module position",laser_head_position_is_out_of_processing_area:"The laser module is out of the processing area",get_laser_head_position_fail_tip:"Obtaining position failed.",element_is_out_of_walk_border_area:"Some elements are out of the framing range. Please rearrange them.",to_reset:"Reset it",measuring_tip:"Distance measuring ... Please try again later.",current_area_is_not_support_measure:"Automatic distance measurement can't be performed in this area.",measure_note:"Obtain focal distance through auto-measure or manual-measure",how_to_measure_with_hand:"How to perform manual-measure",hand_measure_with_hand_step_1:"Measure the distance between the top of the laser module and the upper surface of the material with a ruler.",hand_measure_with_hand_step_2:"Subtract 100 mm(3.937in) from the measured result.",hand_measure_with_hand_step_3:"Input the calculated result as Distance.",hand_measure_with_hand_tip:"1.Measure the distance between the top of the laser module and the upper surface of the material with a ruler.<br/> 2.Subtract 100 mm(3.937in) from the measured result. Input the calculated result as Distance.",ok:"OK",xy_move_distance:"XY distance (mm)",xy_move_speed:"XY speed (mm/s)",z_move_distance:"Z distance (mm)",measure_processing_area:"Mark processing area",measure:"Start marking",measure_processing_area_info:"Move the laser module to make the light spot fall at the upper left vertex of the target processing area, and press the button on the device to record the position. Repeat the same steps to record the bottom right vertex of the target processing area.",measure_point_1:"Vertex 1",measure_point_2:"Vertex 2",measure_point_location:"Coordinates of the recorded vertex",focal_change_while_measuring:"It’s detected that the Distance value has changed. The marked processing area changed accordingly.",suggest_measure_again:"You’re advised to mark the processing area again.",measure_point_holder:"No coordinate yet",cutting_drop:"Lower the focus",cutting_drop_distance:"By",purifier_close_delay:"Time the purifier continues to work",air_assist_auto_fix:"Auto-adjustment for the air assist set",measure_status:"Focus setting ... Long press the button on the device to stop.",measure_area_status:"Processing area measuring ... Long press the button on the device to stop.",to_location_accurate_tip:"For more accurate positioning, set the Distance before the operation.",framing_speed:"Framing Speed(mm/s)",main_board:"Main control board (motion control)",drive_board:"Laser driver board",wifi_module:"Wi-Fi module",back_to_origin:"Convey the material back after processing",in_set_wifi_status:"Network setting ... Please try again later.",many_device_tip:"The number of multiple software connections to this device detected at the same time exceeds the limit, the current connection may be unstable or unable to process properly, please reduce the number of software connections.",error:{m222_s4:{title:"Device moved",content:"Oops! The device has been moved, which may cause device failure. The device has stopped working. Please deal with it as soon as possible."},m222_s5:{title:"Distance sensor exceptions",content:"Distance sensor exceptions"},m222_s6:{title:"Baseplate or riser base exceptions",content:"The baseplate or riser base is not properly connected./nClick Get help to see how to check and install the baseplate and riser base"},m222_s7:{title:"Please close the lid before you start or continue the processing.",content:"Please close the lid before you start or continue the processing."},m53_t0:{title:"The flash storage encounters an exception or is damaged.",content:"The flash storage encounters an exception or is damaged."},m222_s9:{title:"Flame detected",content:"Oops! A flame is detected, which may cause a fire. The device has stopped working. Please deal with it as soon as possible."},m222_s20:{title:"The device reached position limits during processing",content:"The device reached position limits during processing"},m222_s21:{title:"Communication exceptions between the Wi-Fi module and the main controller",content:"Communication exceptions between the Wi-Fi module and the main controller"},m222_s22:{title:"Communication exceptions between the laser module and the main controller",content:"Communication exceptions between the laser module and the main controller"},m222_s23:{title:"Access-control key removed",content:"Access-control key removed"},m53_c1:{title:"Baseplate or riser base exceptions",content:`The baseplate or riser base is not properly connected.
Click How to resolve it to see how to check and install the baseplate and riser base`},m53_c2:{title:"Baseplate exceptions",content:`The baseplate is not properly connected. 
 Click How to resolve it to see how to check and install the baseplate`},help_btn:"How to resolve it",m53_s0:{title:"USB access-control Key removed",content:"It is detected that the USB access-control key has not been properly inserted on the device."},m363_s0:{title:"Distance sensor exceptions",content:"Distance measurement exceptions. Please check the distance sensor."},m363_s2:{title:"Distance sensor exceptions",content:"Distance sensor signal exceptions. Please use manual-measure or replace the laser module."},m363_s3:{title:"Distance sensor exceptions",content:"The distance sensor has not been reset."},m8:{title:"Motor driver chip errors",content:"Motor driver chip errors"},m53_w0:{title:"Laser module overtemperature",content:"⚠️ Oops! The temperature of the laser module has reached 38℃, which may shorten the service life of the device. You're advised to pause processing and wait for the laser module to cool down and then continue the processing."},m53_w1:{title:"Laser module overtemperature",content:"⚠️ Oops! The temperature of the laser module has reached 40℃, which may shorten the service life of the device. The processing has been paused. Please wait for the laser module to cool down and then continue the processing."},m53_w2:{title:"Riser base exceptions",content:"The riser base is not properly installed when you fit the machine on it. Click How to resolve it to see how to check and install the rise base."},m363_s4:{title:"Distance sensor exceptions",content:"Distance measurement exceptions. Please check the distance sensor."},m363_s5:{title:"Distance sensor exceptions",content:"Distance measurement exceptions. Please check the distance sensor."},m53_l1:{title:"Cleaning the laser module",content:"Oops! The cumulative processing time of the device is too long. The smoke from processing accumulates on the lens, which may lead to a poor performance in laser processing. Please clean the lens with a dry tissue or cotton swab in a timely manner."}},reset_measurement_tips:"Perform the calibration again if you've installed another screen and frame or replaced the laser module.",screen_print_tip:"You need to reflect the pattern horizontally for screen printing.",screen_print_tip_new:"Install the frame fixing piece on the right side. You need to reflect the pattern horizontally.",smoking_fan:"Exhaust fan",exhaust_time:"Exhaust time after processing",rectangle:"Rectangle",line:"Line",circle:"Circle",polygon:"Polygon",line_tip:"Mark at least 2 points to form a line.",circle_tip1:"Mark at least 2 points to form a circle.",circle_tip2:"The circle is formed based on the diameter you've marked.",rectangle_tip:"Mark two points on different horizontal lines to form a rectangle.",end_marking:"End marking",by_rectangle:"By rectangle",by_line:"By line",by_circle:"By circle",by_polygon:"By polygon",marking_exit:"Marking is not done yet. Are you sure you want to exit? The data will not be saved.",marking_operate1:"Select an area marking mode.",marking_operate2:"move the laser module to the target points, and press the button on the device to mark the points.",polygon_tip1:"Mark 3 points or more, and end the marking. ",polygon_tip2:"The first and last points are connected to form a polygon.",not_enough_points:"The processing area is not generated due to the lack of points marked.",exit_yes:"Yes",exit_cancel:"Cancel",mark_point:"Point",marking_mode:"Marking mode",circle_points3:"Mark a circle with 3 points: Mark any 3 points on a circle to generate a circular processing area.",same_line_points3:"The circle cannot be marked with 3 points on the same line.",fireproof_title:"Tips",fireproof_tips_1:"A high power and low speed have been set for this processing task:",fireproof_tips_2:"Ensure that the baseplate is clean without any wood or other combustible residues.",fireproof_tips_3:"Pay attention to the material processing status inside the machine.",ok_process:"OK, process",framing:"Framing(mm/s)",move_laser_module:"Move laser module",laser_head_speed:"Framing",position_shot:{title:"Snapshot preview",shot_bg:"Shoot background",shot_title:"Shoot background",follow_steps:"You can shoot the background with the XCS app on your mobile device as follows:",tip1:"1. Connect your laser device to the XCS app on your mobile device.",tip2:"2. Follow the instructions to attach the stickers and complete the calibration.",tip3:'3. Take a picture of the background and click "Send to computer" to scan the QR code on your computer.',note:"Note: To show the QR code, you need to log in to XCS  on your computer.",obtain_bg_tip:'Click "Obtain background" to obtain the background image.',obtain_bg_btn:"Obtain background",obtain_bg_title:"Obtain background",scan_tip:'Please shoot the background in the XCS app on your mobile device, click "Send to computer", and then scan this QR code to send it to the computer. Note: Please make sure that the PC XCS and the scanning device are connected under the same SN ',click_refresh:"Click to refresh",transfer_tip:"Sending picture ... Please wait. After the picture is received, it is added to the canvas.",sending_success:"Sending succeeded",sending_fail:"Sending failed",cancel_transfer_confirm:"Are you sure you want to cancel the sending of the picture?"}},empty:"Connect your device before starting the processing",modal:{tip:"Tips",confirm:"Confirm",cancel:"Cancel",done:"Done",end:"Framing completed",yes:"Yes",no:"No",redo:"Process again",ignore:"Ignore",closeFlameAlarm:"Disable flame alarm"},error:{error_code:"Error Code {code}",how_resolve:"How to resolve it",err_flame_check:{title:"Flame detected",content:"Oops! A flame is detected, which may cause a fire. The device has stopped working. Please deal with it as soon as possible."},err_limit_check:{title:"Laser module moving over the position limit",content:"Oops! The laser module has moved over the position limit, which may cause device failure. The device has stopped working. Please deal with it as soon as possible."},err_tilt_check:{title:"Device moved",content:"Oops! The device has been moved, which may cause device failure. The device has stopped working. Please deal with it as soon as possible."},err_moving_check:{title:"Device moved",content:"Oops! The device has been moved, which may cause device failure. The device has stopped working. Please deal with it as soon as possible."},err_incline:{title:"Device tilted",content:"Oops! The device is tilted, which may cause safety hazards. Please place the device properly and restart it or contact after-sales services."},err_laser_head:{title:"Laser module exception",content:"Oops! An exception occurs on the laser module, which may cause device operation failure. Please refer to the online help or contact after-sales services to solve the problem."},err_gyro:{title:"Gyroscope initialization exception",content:"Oops! An exception occurs during the initialization of the gyroscope, which may cause safety hazards. Please restart the device or contact after-sales services. "},err_heighten:{title:"Riser base exception",content:"Oops! The riser base is not properly installed, which may cause safety hazards. Please check it and install it properly."},err_drawer:{title:"Baseplate exception",content:"Oops! The baseplate is not properly installed, which may cause safety hazards. Please check it and install it properly."},err_heighten_open:{title:"Front door of the riser base not properly closed",content:"Oops! The front door of the riser base is not properly closed, which may cause safety hazards. Please check it and install it properly."},err_gap_open:{title:"Lid opened",content:"Oops! The lid is not properly closed, which may cause device operation failure. Please close the lid."},err_smoking_fan:{title:"Exhaust fan not connected",content:"Oops! The exhaust fan is not properly connected, which may cause safety hazards. Please check it and connect it properly."},err_smoking_fan_block:{title:"Exhaust fan filter blocked",content:"Oops! The filter of the exhaust fan is blocked, which may cause poor processing results. Please refer to the online help or contact after-sales services to solve the problem."},err_header_no:{title:"Processing module not matching the processing type",content:"Oops! The processing module does not match the processing type, which may cause device operation failure. The processing task has been canceled. Please perform the task again."},err_flame_check_error:{title:"Flame detected",content:"Oops! Oops! A flame is detected, which may cause safety hazards. The processing has been paused. Please handle it as soon as possible."},err_flame_check_fatal:{title:"Flame detected",content:"Oops! Oops! A flame is detected, which may cause safety hazards. Please turn off the device and contact after-sales service."},err_ink_bltouch:{title:"Ink module damaged",content:"Oops! The ink module is damaged, which may cause device operation failure. Please refer to the online help or contact after-sales services to solve the problem."},err_laser_bltouch:{title:"Laser module distance sensor damaged",content:"Oops! The distance sensor on the laser module is damaged, which may cause device operation failure. Please refer to the online help or contact after-sales services to solve the problem."},err_laser_eeppom:{title:"Laser module chip exception",content:"Oops! An exception occurs on the chip of the laser module, which may cause device operation failure. Please refer to the online help or contact after-sales services to solve the problem."},err_knife_eeppom:{title:"Multi-function carriage chip exception",content:"Oops! An exception occurs on the chip of the multi-function carriage, which may cause device operation failure. Please refer to the online help or contact after-sales services to solve the problem."},err_ink_eeppom:{title:"Ink module chip exception",content:"Oops! An exception occurs on the chip of the ink module, which may cause device operation failure. Please refer to the online help or contact after-sales services to solve the problem."},err_usb_unlock:{title:"USB key not connected",content:"Oops! The USB access-control key is not properly inserted. Please insert it properly."},err_key_lock:{title:"Security key",content:"It is detected that the device key controller is not plugged in. Please plug in the key controller correctly."},err_temp_error:{title:"File sending exceptions",content:"The file is not properly sent, causing the processing to be canceled. For more information, click Get help."},qx01_0:{title:"Water tank temperature too low",content:"Oops! The temperature of the water tank is too low, which may reduce the service life of the device. The device has stopped working. Please use the device after it has recovered to its normal state."},qx01_1:{title:"Water tank temperature too high",content:"Oops! The temperature of the water tank is too high, which may reduce the service life of the device. The device has stopped working. Please use the device after it has recovered to its normal state."},qx01_2:{title:"Water tank temperature sensor exception",content:"Oops! An exception occurs on the temperature sensor of the water tank, which may reduce the service life of the device. The device has stopped working. Please restart the device or contact after-sales services."},qx02_0:{title:"Water pump blocked",content:"Oops! The water pump of the device is blocked, which may cause safety hazards. The device has stopped working. Please deal with it as soon as possible."},qx03_0:{title:"Water tank water level too low",content:"Oops! The water level in the water tank is too low, which may reduce the service life of the device. The device has stopped working. Please deal with it as soon as possible."},qx05_0:{title:"Purifier blocked",content:"Oops! The purifier of the device is blocked, which may cause safety hazards. The device has stopped working. Please deal with it as soon as possible."},qx05_2:{title:"Purifier not connected",content:"Oops! The purifier of the device is not connected, which may cause safety hazards. The device has stopped processing this time. Please deal with it as soon as possible."},qx06_0:{title:"",content:"The motion control unit (MCU) communication is disconnected. Please restart the machine."},qx08_0:{title:"Water pump current too low",content:"Oops! The current of the water pump is too low, which may reduce the service life of the device. The device has stopped working. Please restart the device or contact after-sales services."},qx08_1:{title:"Water pump current too high",content:"Oops! The current of the water pump is too high, which may reduce the service life of the device. The device has stopped working. Please restart the device or contact after-sales services."},qx08_2:{title:"Water pump current exception",content:"Oops! A current exception occurs on the water pump of the device, which may reduce the service life of the device. The device has stopped working. Please restart the device or contact after-sales services."},qx09_0:{title:"Exhaust fan not working",content:"Oops! The exhaust fan of the device does not work, which may reduce the service life of the device. The device has stopped working. Please deal with it as soon as possible."},qx09_1:{title:"Exhaust fan not working",content:"Oops! The exhaust fan of the device does not work, which may reduce the service life of the device. The device has stopped working. Please deal with it as soon as possible."},qx10_2:{title:"Update failed",content:"Oops! The update of the device motion control unit (MCU) failed, which may cause device failure. The update has been stopped. Please deal with it as soon as possible."},qx11_2:{title:"Update failed",content:"Oops! The update of the external microcontroller unit (MCU) of the device failed, which may cause device operation failure. The update has been stopped. Please deal with it as soon as possible."},qx14_1:{title:"X-axis homing failure",content:"Oops! Homing of the laser module at the x-axis failed, which may cause laser module motion exception. The device has stopped working. Please restart the device or contact after-sales services."},qx14_2:{title:"Y-axis homing failure",content:"Oops! Homing of the laser module at the y-axis failed, which may cause laser module motion exception. The device has stopped working. Please restart the device or contact after-sales services."},qx14_3:{title:"Z-axis homing failure",content:"Oops! Homing of the laser module at the z-axis failed, which may cause laser module motion exception. The device has stopped working. Please restart the device or contact after-sales services."},qx14_8:{title:"U-axis homing failure",content:"Oops! Homing of the laser module at the u-axis failed, which may cause laser module motion exception. The device has stopped working. Please restart the device or contact after-sales services."},qx14_4:{title:"X-axis driver exception",content:"Oops! An error occurs in the x-axis motor driver, which may cause device operation failure. The device has stopped working. Please restart the device or contact after-sales services."},qx14_5:{title:"Y-axis driver exception",content:"Oops! An error occurs in the y-axis motor driver, which may cause device operation failure. The device has stopped working. Please restart the device or contact after-sales services."},qx14_6:{title:"Z-axis driver exception",content:"Oops! An error occurs in the z-axis motor driver, which may cause device operation failure. The device has stopped working. Please restart the device or contact after-sales services."},qx14_7:{title:"U-axis driver exception",content:"Oops! An error occurs in the u-axis motor driver, which may cause device operation failure. The device has stopped working. Please restart the device or contact after-sales services."},qx14_9:{title:"W-axis driver exception",content:"Oops! An error occurs in the w-axis motor driver, which may cause device operation failure. The device has stopped working. Please restart the device or contact after-sales services."},qx14_10:{title:"W-axis homing failure",content:"Oops! Homing of the laser module at the w-axis failed, which may cause laser module motion exception. The device has stopped working. Please restart the device or contact after-sales services."},qx14:{title:"Motion axis limit error",content:"Oops! An error occurs on the position limit at the motion axis, which may cause laser module motion exception. The device has stopped working. Please restart the device or contact after-sales services."},qx16:{title:"Main control board temperature exception",content:"Oops! A temperature exception occurs on the main control board of the device, which may reduce the service life of the device. The device has stopped working. Please use the device after it has recovered to its normal state."},qx17:{title:"Camera exception",content:"Oops! The camera of the device does not work, which may cause device operation failure. The device has stopped working. Please deal with it as soon as possible."},qx17_0:{title:"Camera not found",content:"Oops! An exception occurs on the camera of the device, which may cause device operation failure. Please restart the device or contact after-sales services."},qx17_1:{title:"Camera exception",content:"Oops! An exception occurs on the camera of the device, which may cause device operation failure. Please restart the device or contact after-sales services."},wx13:{title:"Cleaning the laser module",content:"Oops! The cumulative processing time of the device is too long. Please clean the laser module."},wx13_new:{title:"Cleaning the laser module",content:"Oops! The cumulative processing time of the device is too long. The smoke from processing accumulates on the lens, which may lead to a poor performance in laser processing. Please clean the lens with a dry tissue or cotton swab in a timely manner."},qx20_1:{title:"Control board exceptions",content:"Oops! The control board of the device is not working properly, which may reduce the service life of the device. The device has stopped working. Please deal with it as soon as possible."},qx20_2:{title:"Control board exceptions",content:"Oops! The control board of the device is not working properly, which may reduce the service life of the device. The device has stopped working. Please deal with it as soon as possible."},qx20_3:{title:"Control board exceptions",content:"Oops! The control board of the device is not working properly, which may reduce the service life of the device. The device has stopped working. Please deal with it as soon as possible."},qx20_4:{title:"The control panel is not working properly",content:"Oops! The control board of the device is not working properly, which may reduce the service life of the device. The device has stopped working. Please deal with it as soon as possible."},qx20_5:{title:"Processing path error",content:"Oops! An error occurs in the processing path of the device, which may cause device failure. The processing has been stopped. Please deal with it as soon as possible."},qx21_1:{title:"Laser module not working",content:"Oops! The laser module of the device is not working, which may cause device failure. The device has stopped working. Please deal with it as soon as possible."},qx30_0:{title:"Firmware version info not found",content:"Oops! Firmware version information can't be found, which may cause device operation failure. Please restart the device or contact after-sales services."},qx30_1:{title:"Board communication failure",content:"Oops! Communication with the board failed, which may cause device operation failure. Please restart the device or contact after-sales services."},qx30_1_1:{title:"Board communication failure",content:"Oops! Communication with the board failed, which may cause device operation failure. Please restart the device or contact after-sales services."},qx30_1_2:{title:"Board communication failure",content:"Oops! Communication with the board failed, which may cause device operation failure. Please restart the device or contact after-sales services."},qx30_1_3:{title:"Board communication failure",content:"Oops! Communication with the board failed, which may cause device operation failure. Please restart the device or contact after-sales services."},qx30_2:{title:"Water level in the water tank too low",content:"Oops! The water level in the water tank is too low, which may reduce the service life of the device. The device has stopped working. Please fill the water tank with the required liquid in a timely manner."},qx30_3:{title:"Water-cooled fan exception",content:"Oops! An exception occurs on the water-cooled fan of the device, which may reduce the service life of the device. Please restart the device or contact after-sales services."},qx30_4:{title:"Water tank flow too low",content:"Oops! The water flow in the water tank of the device is too low, which may reduce the service life of the device. The device has stopped working. Please solve the problem by referring to the help document."},qx30_5:{title:"X-axis initialization exception",content:"Oops! An error occurs in the configuration for laser module initialization at the x-axis, which may cause laser module motion exception. The device has stopped working. Please contact after-sales services."},qx30_6:{title:"Y-axis initialization exception",content:"Oops! An error occurs in the configuration for laser module initialization at the y-axis, which may cause laser module motion exception. The device has stopped working. Please contact after-sales services."},qx30_7:{title:"Z-axis initialization exception",content:"Oops! An error occurs in the configuration for laser module initialization at the z-axis, which may cause laser module motion exception. The device has stopped working. Please contact after-sales services."},qx30_7_1:{title:"Z-axis initialization exception",content:"Oops! An error occurs in the configuration for laser module initialization at the z-axis, which may cause laser module motion exception. The device has stopped working. Please contact after-sales services."},qx30_7_2:{title:"Z-axis initialization exception of the basic carriage",content:"Oops! An error occurs in the z-axis initialization configuration for basic carriage of the device, which may cause motion exceptions. The device has stopped working. Please contact after-sales services."},qx30_8:{title:"U-axis initialization exception",content:"Oops! An error occurs in the configuration for laser module initialization at the u-axis, which may cause laser module motion exception. The device has stopped working. Please contact after-sales services."},qx30_9:{title:"W-axis initialization exception",content:"Oops! An error occurs in the configuration for laser module initialization at the w-axis, which may cause laser module motion exception. The device has stopped working. Please contact after-sales services."},qx_filter_blocked:{title:"Filter blocked",content:"Oops! The filter of the smoke exhaust fan is blocked, which may cause poor processing results. Please refer to the online help or contact after-sales services to solve the problem."},qx32_0:{title:"Fan current too low",content:"Oops! The current of the fan on the device is too low, which may cause processing exceptions. Please solve the problem by referring to the help document."},qx32_1:{title:"Fan current too high",content:"Oops! The current of the fan on the device is too high, which may reduce the service life of the device. Please solve the problem by referring to the help document."},qx31_1:{title:"Safety lock unlocking exception",content:"Oops! An exception occurs in unlocking the safety lock, which may cause device operation failure. Please restart the device."},qx31_0:{title:"Safety lock locking exception",content:"Oops! An exception occurs in locking the safety lock, which may cause device operation failure. Please restart the device or contact after-sales services."},qx31_2:{title:"Air pump current exception",content:"Oops! A current exception occurs on the air pump of the device, which may cause safety hazards. Please restart the device or contact after-sales services."},qx_x_1:{title:"Device tilted",content:"Oops! The device is tilted, which may cause safety hazards. Please place the device properly and restart it or contact after-sales services."},qx_x_2:{title:"Device casing short-circuited with the circuit board",content:"Oops! A short circuit occurs, which may cause safety hazards. Please contact after-sales services."},qx_x_3:{title:"Flame detected",content:"Oops! A flame is detected, which may cause safety hazards. The device has stopped the processing. Please handle it as soon as possible."},communication_abnormality:{title:"Device communication exception",content:"Oops! A device communication exception occurs, which may cause device operation failure. Please restart the device or contact after-sales services."},camera_abnormality:{title:"Camera exception",content:"Oops! An exception occurs on the camera of the device, which may cause device operation failure. Please restart the device or contact after-sales services."},z_axis_abnormality:{title:"Z-axis exception",content:"Oops! An exception occurs on the z-axis of the device, which may cause device operation failure. Please contact after-sales services."},u_axis_abnormality:{title:"U-axis motor exception",content:"Oops! An exception occurs on the u-axis motor of the device, which may cause device operation failure. Please contact after-sales services."},red_laser_abnormality:{title:"Fiber IR laser module fault",content:"Oops! A fault occurs on the fiber IR laser module of the device, which may cause device operation failure. Please contact after-sales services."},board_fan:{title:"Cooling fan exception",content:"An exception occurs on the cooling fan, which may cause device operation failure. The device has stopped working. Please contact after-sales services."}},material:{input_placeholder:"Search for material by name",all_material_category:"All",supported_only:"Supported only",use:"Use",not_supported_yet:"Not supported yet",not_supported_yet_tips:"The material can't be used due to the device, power of the laser module, processing type, or some other reasons.",more_material:"More",material_lab:"Material EasySet Library",material_flammable:"Flammable",no_content_found:"No content found",request_failed:"Request failed",network_error_1:"Network connection fails. Please check your network settings. ",network_error_2:"Some of the functions that require no network can still be used.",server_error:"System exceptions occur. Please try again later.",how_to_differentiate:"Click to see how to determine the wood core"},measure_guide:{title:"Measure distance",manual_measurement:"Manual-measure",manual_measurement_distance:"Measure the distance as shown in the following figure:",input_distance:"Enter the distance you have measured",re_automatic_measurement:"Auto-measure again",auto_measurement_fail:"Auto-measure failed",auto_measurement_success:"Auto-measure succeeded",solution_1:"Solution 1",solution_1_detail_1_laser_plane:"Ensure that the material to be processed is no more than {min} above or {max} below the baseplate of the device.",solution_1_detail_1_cylinder:"Ensure that the highest point of the cylindrical material to be processed is no more than {min} higher or {max} lower than the baseplate of the device.",solution_1_detail_final:"After adjusting the position of the material, click {re_automatic}.",solution_2:"Solution 2",solution_2_detail_1:"Click {re_manualMeasure} to measure the distance manually.",view_detail_tutorial:"Click to find the tutorial",measuring:"Measuring",measure_fail:"Measurement failed",thickness_to_large:"The material exceeds the thickness limit and cannot be processed.",thickness_to_small:"Thickness measurement failed. Please raise the material higher and try again.",manual_measurement_auto:"Distance information can be obtained by automatic measurement or manual measurement.",failed:"Auto-measure failed",measure_over_thick:"Exceeded the maximum measurable thickness",measure_over_distance:"Exceeded the maximum measurable distance",measure_under_thick:"Thinner than the minimum measurable thickness",measure_under_distance:"Shorter than the minimum measurable distance",measure_error_btn:"possible cause and solution",materials_over_max_thick:"The thickness of the material exceeds the processing range. Please use another material."},ext:{take_local_pic:"Close shot",del_local_pic:"Delete close view"},pass_through:{process_finish_header:"Complete part{currStep}/{totalStep}",set_next_process:"Next part processing setting Part{currStep}/{totalStep}",auto_counterpoint:"Auto-align",auto_counterpoint_again:"Auto-align",close_manual_measure:"Disable manual-align",open_manual_measure:"Enable manual-align",counterpointing:"Aligning…",no_move_or_open:"Do not open the lid or move the material",counterpoint_success:"Auto-align succeeded",click_button_to_process:"Click Process to open the Preview window",counterpoint_fail:"Auto-align failed",please_manual_counterpoint:"Few characteristic points are found. Please align it manually.",taking_photo:"Image capturing…",push_material_tips:"Push the material straight forward,Close to the horizontal line where the red spot falls,Click Auto-align after you push the material",push_no_enough_tips1:"The material is not pushed to the right position.",push_no_enough_tips2:"Push the material straight forward",push_no_enough_tips3:"Close to the horizontal line where the red spot falls",push_no_enough_tips4:"Click Auto-align after you push the material",select_take_local_img:"Select the area you want to shoot on the canvas. Press Esc or right-click to stop selection.",select_precise_measure:"Select the area you want to measure on the canvas. Press Esc or right-click to stop selection.",manual_alignment:"Adjust the position of the design element by clicking the direction buttons, aligning it with the end of the last processed part.",back_auto_align:"Back to auto-align"},measure:{up:"Up",down:"Down",left:"Left",right:"Right",mark:"Mark",point1:"Vertex 1",point2:"Vertex 2",open:"Open",close:"Close",reset:"Homing",setup_title:"Set measurement density",density_title:"Measure density",curve_title:"Preview curved surface",col:"Columns",row:"Rows",estimated_time:"Estimated time",reselect_area:"Select area again",measure_min_error:"The area selected is too small. Please record the vertices again.",no_map:"No element to be mapped",start:"Start measuring",measuring:"Measuring",measuring_progress:"{current} / {total} completed",preview_angle_tip:"You can left-click it to change the preview angle.",smoothness:"Smoothness",tension:"Tension",select_points_remeasure:"You can select a measurement point to measure it again.",remeasure:"Measure again",measure_max_distance:"The maximum measurement range has been reached",measure_fail:"Measurement failed, Please try again.",measure_disable:"Automatic distance measurement can't be performed in this area.",measure_fail_desc:"Unmeasurable points included, Please adjust the object and try again.",how_to:"How to measure a curved surface",measure_fail_disconnect:"Device disconnected, measurement failed.",model_adjustment:"Model Adjustment",record_step1:"1. Move the laser module to make the red spot fall at the upper left vertex and then at the lower right vertex of the target processing area.",record_step2:"2. Record the coordinate position of the red point projected by the laser head.",control_larser:"Control laser module",record_position:"Mark coordinate position",model_adjust_tip:"Make models closer to real objects by adjusting smoothness and tension.",map:"Map",top_view:"Top view",three_d_view:"3D view",hide_grid:"Hide grid",show_grid:"Show grid",move_tip:"If the material has been moved, you need to measure the curved surface again.",curvature_tip:"Part of the curved surface is out of the processing range. Do not place elements there.",busy_tip:"The device is already in use, please try again later.",exit_measure:"The machine is in the measuring state. Please open and then close the lid to exit the state.",measure_is_larger_then_max:"Exceeded the upper distance limit.  Auto-measure failed!",curve_process_mode_data_tip:"There is no surface to process, please measure the surface first",curve_mode_tip:"In this mode, do not align your elements directly based on the image captured.",no_marked_yet:"No processing area marked yet",measure_surface_first:"Click Curve-measure to measure the curved surface first."},origin_calibration:{title:"Origin calibration",back_to_origin:"Back to origin",please_back_origin:"Click Back to origin, wait for the laser module to go back, and click Next.",over_area_tip:"The area obtained in calibration exceeds the canvas area. Please perform calibration again.",done:"Done",screen_size:"Screen size"},auto_focus:{auto_focus_remain_modal_head:"Check before auto-focus",auto_focus_remain_tip1:"1. The laser head is about to be lowered for reset. Please do not place thicker items over 10cm on the floor to avoid damaging the equipment.",auto_focus_remain_tip2:"2. Click the ok button in the lower right corner to start autofocus.",init_before_auto_focus:"Use autofocus before",init:"Init",init_before_auto_focus_tip:"Use autofocus before init"},element_container:{obj_title:"Object setting",obj:"Object",group:"Group",circle:"Circle",line:"Line",rect:"Rectangle",vector:"Vector",text:"Text",image:"Image",multi_obj:"Multiple objects selected",output:"Output",ignore:"Ignore",all_vectors:"All vectors",all_bitmaps:"All bitmaps",not_work_for_bitmaps:"The processing mode does not work for bitmaps.",multiple_values:"*Multiple values",output_type:"Processing type",param:"Setting",cant_set_params_for_both:"You can't set parameters for both a vector and bitmap.",select_vector:"Select vector",select_bitmap:"Select bitmap",processing_is_not_supported:"Processing is not supported for now",no_param:"No setting found",how_to_save_param:"How to save my setting?"},user_defined:{manual_setting:"Manual setting",save_as_setting:"Save as a custom setting",new_setting:"New setting",name:"Name",cancel:"Cancel",save:"Save",enter_name:"Please enter a name",delete:"Delete",is_delete:"Are you sure you want to delete the setting?",cant_be_restored:"The settings can't be restored after the deletion.",think:"Let me think",confirm:"Confirm",no_setting:"No setting found",how_to_save:"How to save my setting?",upper_limit:"The number of settings has reached the upper limit.",custom_settings:"Custom parameter settings",export:"Export",export_success:"Export succeeded",export_fail:"Export failed. Please try again.",import_setting:"Import setting",import:"Import",import_limit:"Each processing mode supports a maximum of 30 custom settings.",import_success:"Import succeeded",import_fail:"Import failed. Please try again."},laser_extend:{extend_install_calibration_entry:"Follow the calibration guide strictly before using the slide extension.",extend_install_calibration:"Laser calibration",extend_install_calibration_guide:"Laser calibration guide",counterpoint:"Counterpoint",pre_lock:"Prelock",calibrate:"Start",completion:"Completion",go:"Go",next_step:"Next step",initial_install_summary:"Follow the guide to align and calibrate:",initial_install_step_1:"·Align the right edge of the movable ruler with scale 0 of the slide extension. Tighten the screw. ",initial_install_step_2:"·Align the vertical line on the side of the slide extension with the edge of the removable baseplate of xTool F1, and align the side of the slide extension with the second line on the baseplate. Move the ruler to the working area. Turn the knob to set the laser focus.",initial_install_step_3:"·Click Next when you complete the steps above.",lock_screw_summary:"Screws pre-locking:",lock_screw_step_1:"·Tighten screws on the left and right side, but do not tighten them fully.",lock_screw_step_2:"·Click Next, and start the laser calibration.",projection_summary:"Start the laser calibration:",projection_step_1:"·Move the slide extension to left or right slightly to align the laser with the middle of the movable ruler.",projection_step_2:"·Tighten the left screw, click Next. Then the slide extension moves to the left automatically.",complete_calibration_summary:"Final calibration and lock:",complete_calibration_step_1:"·Tighten the right screw",complete_calibration_step_2:"·Click Completed to complete the calibration.",platform_speed_tips:"This speed can be modified to better control the movement of the processing panel."},task_list:{unrecoverable_after_disconnection:"Please note that the task cannot be resumed if you disconnect the device and connect it again.",file_name:"File name",device_name:"Device name",remaining_time:"Remaining time",current_processing_time:"current processing time",disconnected_tips:"If the device is in processing but the task status is Device disconnected. You can connect the device again to manage the task. If you don't connect it, the device continues to complete the processing and the task will be moved to the task history in 30 minutes.",move_in_history:"Move to task history",reconnect:"Connect again",open_file:"Open file",task_history:"Task history",in_processing:"In processing",no_in_processing:"No task in progress",no_history_task:"No task history",first_minimize:"You can view the ongoing tasks in the task list."},material_test:{x:{title:"X columns",count:"Columns",spacing:"Spacing"},y:{title:"Y rows",count:"Rows",spacing:"Spacing"},param:"Parameter",max:"Max.",min:"Min."},task:{working:"In processing",history:"Task history",warning_disconnect:"Please note that the task cannot be resumed if you disconnect the device and connect it again.",warning__30min:"The device is disconnected. Please check the device. If you don't connect it again, the device continues to complete the processing and the task will be moved to the task history in 30 minutes.",warning_:"The device is disconnected, please check the device! 30 minutes of non-processing will be automatically moved to the history of the task but does not affect the normal processing of the device;",device_disconnect:"Device disconnected",move_to_history:"Move to task history",connect_again:"Connect again",open_file:"Open file",connect_success:"Device connected successfully",connect_failed:"Device connection failed. Please try again. Solution",connect_failed_fix:"Solution",close_warning:"The project is in progress. Please wait for the processing to complete before you close it.",working_empty:"No task in progress",history_empty:"No task history",working_tips:"You can view the ongoing tasks in the task list."},list:{device_selected_tips:"When you open a project, the device matching the project is selected. You can select another device to replace it.",current_device:"Device selected",switch_device:"Devices available",switch_current_device:"Switch current device",switch_device_tip:`Devices available include those you've connected before and obtained after project files are opened. Devices obtained through files are named "Unknown".`,connect:"Connect device",please_connect:"Please connect a device",empty_device_tip:"Please connect a device first.",delete_device:"Delete device",device_introduction:"User guide",device_setting:"Device settings",delete_device_modal_content:"Are you sure you want to delete the device?",delete_device_modal_cancel_text:"Cancel",delete_device_modal_confirm_text:"Delete",disConnect_device_modal_title:"Disconnect",disConnect_device_modal_content:"Some settings will become unavailable if you disconnect the device. Are you sure you want to disconnect it? (Note: If you disconnect a device during material processing, the processing will be affected.)",disConnect_device_modal_cancel_text:"Cancel",disConnect_device_modal_confirm_text:"Disconnect",connected:"Connected",un_connected:"Not connected",in_processing:"In processing",connecting:"Connecting...",switch_device_model_title:"Tips",switch_device_model_content:"The device to be switched to differs from that in the project file. The settings of the processing mode, material, and other parameters may be changed. Are you sure you want to switch the device?",switch_device_model_cancel_text:"Cancel",switch_device_model_confirm_text:"Switch",switch_device_power_model_tip:"Tips",switch_device_power_model_content:"The processing module of the device selected does not match the parameter settings in the project file. To ensure proper processing, you need to change the involved parameter settings. Do you want to change them?",switch_device_power_model_confirm_text:"Yes",switch_device_power_model_cancel_text:"No",unrecognized_power:"No laser module recognized. Please check your device and then connect it again. ",delete_device_tip:"The device cannot be deleted because it is being used by another project. ",unknown:"Unknown",empty:"No Devices",please_connect_device:"You need to connect a device",wifi_status:"Wi-Fi",Hotspot_status:"Hotspot",xTool:"xTool_",new_project:"New project",open_system_file:"Open system file",add_from_albm:"Add from album",take_picture:"Take a picture"},message:{task_finish_title:"Task done",task_pause_title:"Task paused",task_cancel_title:"Task canceled",device_disconnect_title:"Disconnected",task_finish_content:"The task has been completed. You can view details in the task list. ",device_disconnect_content:"The device has been disconnected. You can view details in the task list.",task_cancel_content:"The task has been canceled. You can view details in the task list.",task_pause_content:"The task has been paused. You can view details in the task list."},parameter_panel:{pin:"Pin the EasySet panel",parameters:"Parameters",title:"EasySet panel",font:"Front view",back:"Back view",array:"One-click set",reference:"Result reference",used_fail:"The parameter settings cannot be used. Please select the device and laser power that match the settings.",recommended:"Recommended value:",default:"Value:",null_value:"null",user_defined:"User-defined",user_guide:"Click the EasySet panel to set the parameters",used_success:"Parameter settings used successfully",success:"Success"},gs002:{backup_file:"Back up file to device",file_name:"File name",backup_file_tip:"Backs up the file to your device. Then you can view it on the device screen and perform offline processing by using it.",unnamed:"Untitled",file_save_success:"File backup succeeded",format_error:"A file name cannot contain special characters",file_already_exists:"Duplicate file name. Please rename your file and try again.",file_does_not_exist:"File not found",space_is_not_enough:"Insufficient space. Please delete other files and try again.",backup_failure:"File backup failed",positioning_photo_tip:"Before shooting, ensure that the material is flat and in focus. This improves positioning accuracy.",take_photo_success:"Image capture succeeded",take_photo_fail:"Image capture failed",camera_abnormality:"",make_video:"Make processing video",make_video_tip:"Captures images of the working area during the processing and combines these images into a video.",ready_shooting:"Ready to record",shooting:"Recording ...",pause_shooting:"Recording paused",making_video:"Video making ...",making_video_tip:"Video making ...  Please try again later.",transmission_photo:"Image transmitting ... ",save_video_failed:"Video saving failed",cant_not_photo:"The device is processing a material. Please try again later.",focusing_tip:"Focusing ... Long press the Start/Stop button to stop focusing and try again.",focusing_success:"Please refresh the image captured.",manually_focusing_success:"Focus changed. Please manually refresh the background",focusing_success_button:"Refresh",focusing_fail:"Auto-measure failed. Possible cause and solution",focusing_light_fail:"Auto focus failed. Please close the protective enclosure or darken the environment and try again.",focusing_button_tip:"Closing the protective enclosure improves focusing accuracy. ",smoke_exhaust_time:"Exhaust time after processing",purifier_beep_enable:"Buzzer indicator for purifier",have_processing_task:"Unfinished processing task detected",have_processing_task_tip:"There is a task not finished due to power failure. You can click Continue and press the button on the device to continue it. Do you want to continue the task?",give_up:"Discard",device_working:"The device is working ...",conveyor_belt_keep_tip:"Read instructions before batch processing",conveyor_extension_tip:"Ensure that the conveyor is installed and connected properly. ",laser_cylinder_tip:"Ensure that the red spot falls at the highest point of the cylinder",step:"step",conveyor_belt_tip_model:{head:"Instructions",step0:"Cloud services are required for this function. Connect to a network and log in to your xTool account first.",step1:"Install and connect a conveyor.",step2:{title:"Create a processing project.",tip1:"Place materials in the processing area;",tip2:"Click the Refresh button to take a picture of the processing area",tip3:"Design a processing object on one of the materials, and set processing parameters."},step3:" Click the Process button to start batch processing."},conveyor_belt_next:"Click Continue to recognize and process the next batch of materials.",batch_close_confirm:"The batch processing stops if you cancel it. Are you sure you want to cancel processing?",batch_process_ready:{head:"Preparing for processing ... Please wait.",notice1:"Do not move or sway the conveyor",notice2:"Do not move the materials inside the processing area",step1:"Convey material",step2:"Shoot material",step3:"Recognize material"},export_xf:"Export .xf file",name_too_long:"The file name exceeds 15 characters",special_characters:"A file name cannot contain special characters",z_axis_move:"Descend at the z-axis","z_scan angle":"Engraving angle",z_layers:"for every N layers",z_decline:"by N mm",avoid_smoke_modal:"Evade smoke",avoid_smoke_modal_tip:"When this function is enabled, the device follows a path less affected by the smoke to process the material. You are advised to enable it for scoring on materials such as wood and corrugated paper that produce heavy smoke.",red_light:"Fiber IR",z_reset:"Do not place a material thicker than 30 cm on the baseplate. Otherwise, the laser module will get damaged due to collision.",z_reset_success:"Homing succeeded",z_reset_fail:"Homing failed. Please try again.",z_reset_tip:"If the red and blue spots overlap but the measured thickness is inaccurate, perform Z-axis homing and try again.",slice_number:"Number of layers",scan_angle:"Engraving angle",element_count_over_limit:"More than one object on the canvas. Please delete extra objects and keep only one.",rest_note:"Note",rest_confirm:"Confirm",rest_cancel:"Cancel",z_reset_modal:"Z-axis homing",reset:"Homing",reset_success:"Homing succeeded",reset_fail:"Homing failed. Please try again.",power_resume:"Unfinished processing task detected",power_resume_content:"There is a task not finished due to power failure. You can click Continue and press the button on the device to continue it. Do you want to continue the task?",trimming:"Score the outline",batch_identify_failed:"No material has been recognized in the last 5 attempts. The processing task is automatically ended.",process_ready_title:"Press the XTOOL button on the touchscreen controller to start processing. Exercise caution when processing inflammable materials to prevent fires.",busy_tip:"The device is working. Please try again later.",usbkey_lost:"The USB key is not inserted. Please insert the key properly.",curve:{warning_tip:"In this mode, do not position an object based on the background image.",area1:"1. Move the material to allow the center blue spot to fall in the center of the desired processing area. Perform focusing on the material.",area2:"2. On the canvas diagram on the left, resize the blue box to adjust the processing area.",measureing:"Measuring curved surface ... Long press the Start/Stop button to stop measuring and try again."},params_setting:"Parameter settings",conveyor_belt_calibration:"Conveyor calibration",x_calibration_title:"X-axis calibration",angle_calibration_title:"Angle calibration",calibration_introduce:"Read before calibration",x_calibration_introduce_detail_1:"Long-distance transport may cause belt misalignment. Please calibrate the belt angle the first time you use the conveyor.",x_calibration_introduce_detail_2:"Besides first-time use, the conveyor needs x-axis calibration in the following scenarios:· Moved for a large distance· Conveyed a heavy material (> 1 kg)· Belt replaced",x_calibration_introduce_detail_3:"Ensure that the belt angle has been calibrated before you calibrate the belt at the x-axis.",x_calibration_introduce_detail_4:"You are advised to use an art scratch paper (220 × 220 mm) in the calibration. Stick it on the belt before engraving on it.",angle_calibration_introduce_detail_1:"Long-distance transport may cause belt misalignment. Please calibrate the belt angle the first time you use the conveyor.",angle_calibration_introduce_detail_2:" Besides first-time use, the conveyor needs belt angle calibration in the following scenarios: · Moved for a large distance   · Conveyed a heavy material (> 1 kg) · Belt replaced",angle_calibration_introduce_detail_3:"You are advised to use an art scratch paper (220 × 220 mm) in the calibration. Stick it on the belt before engraving on it.",start_calibration:"Start calibration",click:"Click",calibration_step_1:"engrave the calibration pattern on the material.",engraving:"Engrave",angle_calibration_step_2:"Read the degrees between the two longer lines, and input the value as the angle offset.",x_calibration_step_2:"Read the length of the horizontal line, and input the value as the x-axis offset.",angle_calibration_result_label:"Angle offset",continue_take_phone:"Continue to take picture",no_album_permission:"The album permission is not enabled",x_calibration_result_label:"Line length (mm)",angle_calibration_step_3:"Click Confirm to save the calibration result. If angle offset still occurs during processing, please perform the calibration again.",batch_process_tip:{step1:{title:"Shoot the sample material",desc:"Click Refresh to shoot the sample material"},step2:{title:"Design a processing object",desc:"Design an object on the sample material and set processing parameters for it"},step3:{title:"Start processing",desc:"Click Process to start batch processing"},empty_canvas:"Please add an object to the canvas first",offline:"Network exceptions. Cloud services are not available for this function. Please check the network connection."},select_area:"Frame out the sample material",select_area_tip:"Frame out the sample material first",z_calibration_title:"Thickness measurement calibration",blue_calibration_title:"Calibrate the infrared laser",red_calibration_title:"Calibrate the blue-light laser",z_calibration_introduce_detail:{title:"When do you need to perform thickness measurement calibration?",illustrate:"During auto focusing, if the auto-measured thickness of a material differs a lot from the actual thickness, check and ensure that the material surface is smooth and flat. If the problem persists, perform thickness measurement calibration.",step_illustrate:"Ensure that the baseplate is flat and clean without any objects on it (as shown in the following picture). Then, start calibation.",button:"Calibrate"},red_blue_calibration_tile:{blue_light:"blue-light laser",red_light:"infrared laser",title_1:"When using the",title_2:"for processing, if the position of the processing result deviates a lot from the design on the canvas, check and ensure the following items first:",title_3:"The material surface is flat and smooth",title_4:"The measured material thickness is correct",tip_1:"If the problem persists, click Start calibration to calibrate the",tip_2:"Note: You are advised to use an art scratch paper (100 × 100 mm) in the calibration. Stick it on the center of the baseplate before engraving on it.",step_1_2:"Open calibration file",step_1_3:",and process the file on the calibration material.",step_2:"Click Refresh to shoot the processing area. On the canvas, zoom in on the engraved square to see the coordinates of its bottom-left corner in the provided coordinate system. Enter the x and y coordinates as the x-axis and y-axis offsets. (Distinguish between positive and negative numbers.)",step_2_x:"X-axis offset (mm)",step_2_y:"Y-axis offset (mm)",step_2_tip:"Example:In the sample graph, the bottom-left corner of the engraved square is at the coordinate of (-0.1, 1.3). Thus, the X-axis offset is -0.1 mm and the Y-axis offset is 1.3 mm.",step_3:" to save the calibration result. If position deviation still occurs, please perform the calibration again or contact our after-sales service.",step_3_button:"Confirm"},process_fulfil_tip:"The material may be hot if it is metal or it has been processed for a long time. Be careful not to get burned.",server_exception:"Server exceptions. Please try again later",batch_select_box:"Batch fill may not be necessarily accurate for materials that are reflective, perforated, looped, hollow, etc. ",batch_select_box_tip:"More details",red_blue_text:{calibration_prompt:"Device calibration",fiber_ir:"Fiber IR",fiber_ir_fault:"Oops! A fault occurs on the fiber IR laser module of the device, which may cause device operation failure. Please contact after-sales services.",befor_calibration:"After long-distance transport, automatic thickness measurement and processing positioning may be inaccurate, which will cause poor processing results, such as engraved lines being too light or invisible. Thus, please calibrate the fiber infrared and blue-light lasers before using the device.",to_calibrate:"Go to calibrate",calibration:"Fiber IR and blue-light laser calibration",calibration_accuracy_tips:"If any of the following situations occur, please perform calibration to ensure processing accuracy:",calibration_accuracy_tips_1:"1. When the baseplate is clear without any material on it, perform auto-focusing but the measured thickness deviates a lot.",calibration_accuracy_tips_2:"2. The material surface is flat and thickness is correct, but the processing position deviates a lot from that set on the canvas.",calibration_1_1:"Use an art scratch paper (100 × 100 mm) as the engraving material for the calibration.",calibration_1_2:"Tape the art scratch paper in the middle of the baseplate. Ensure that it lays flat without any bulges.",calibration_1_note:"Note: If you have performed calibration before, clicking Next will clear the calibration result.",operation_failed:"Operation failed. Click Next again.",calibration_2_1:"Click [Engrave], and then press the XTOOL button on the touchscreen controller to start engraving.",calibration_2_note:"Note: Close the protective enclosure before processing.",carving:"Engrave",calibration_3_1:"In the left-side picture,",calibration_3_2:"observe the centers of the crosses in the blue and red coordinates. Enter their x and y coordinates as the x-axis and y-axis offsets.",calibration_3_2_mobile:"Observe the centers of the crosses in the blue and red coordinates. Enter their x and y coordinates as the x-axis and y-axis offsets.",calibration_3_3:"(Distinguish between positive and negative numbers.)",calibration_3_tips:"For example, the center of this cross is (0, -0.5), so the x-axis offset is 0 mm and y-axis offset is -0.5 mm.",x_deviation:"X-axis offset",y_deviation:"Y-axis offset",calibration_4_1:"First, remove the art scratch paper from the baseplate;",calibration_4_2:"Second, check the blue and red light spots on the baseplate:",calibration_4_3:"- If the blue and red spots do not overlap, click Not overlapped to continue calibration to make the blue and red spots overlap.",calibration_4_4:"- If the blue and red spots overlap, click Overlapped to end the calibration.",overlapped:"Overlapped",not_overlapped:"Not overlapped",calibration_5_1:"Remove the key from the back of the device to disable the laser function. This is to ensure your safety during calibration.",calibration_6_1:"Using the M2.5 hex screwdriver provided with the device, turn the screw to the left of the red light emitter counterclockwise to loosen it.",calibration_6_2:"Note: If the device enters hibernation mode, the red and blue light spots disappear. Please tap the screen of the touchscreen controller to wake up the device. ",calibration_7_1:"Insert the screwdriver into the small hole on the right of the red light emitter. Sway the screwdriver to move the red light spot until it overlaps with the blue one.",calibration_7_note:"Note: Do not let your hands or the screwdriver block the red light beam. Otherwise, you cannot see the spot on the baseplate.",calibration_8_1:"Tighten the screw to the left of the red light emitter, and insert the access-control key back.",please_carve_first:"Engrave the calibration pattern first",calibration_finish:"The calibration is completed. If the  problem still occurs, please perform the calibration in device settings again."}},test_optical_path:{test_optical_path:"Test optical path",brief_1:"The laser beam is produced by the laser tube and reflected by the first and second mirrors, passing through the first, second, and third optical path holes to the laser module, shown as the red line in the figure.",brief_2:"To ensure that the laser beam reaches the laser module, you need to test whether it passes properly through the first, second, and third optical path holes.",brief_2_1:"To ensure that the laser beam reaches the laser module, ",brief_2_2:"you need to test whether it passes properly through the first, second, and third optical path holes.",brief_3:"Get masking tape ready before the testing.",start:"Start",remove_cover_1:"To test whether the laser beam passes properly through the first optical path hole:",remove_cover_2:"1. Turn off the machine, unscrew the screws that fix the back covers and remove them",remove_cover_3:'2. Turn on the machine, open this window again, and click "Back covers removed, next"',remove_cover_next:"Back covers removed, next",close_title:"Are you sure you want to cancel the optical path test?",close_content:"Optical path deviation may cause failure to emit laser beams. You are advised to complete the test to ensure that the optical path is correct.",close_confirm:"Continue",close_cancel:"Cancel",disconnect_title:"Machine disconnected",disconnect_content:"To ensure correct test results, please connect the machine and perform the optical path test again.",disconnect_confirm:"OK",level_1:"First optical path hole test",level_2:"Second optical path hole test",level_3:"Third optical path hole test",level_point_1:"Move the laser module to the front right corner of the machine.",click_move_laser_head:"Click to move the laser module",cancel_test:"Cancel test",level_point_2:'Remove the slide cover on the left side of the machine, and then click "Next."',next:"Next",level_point_3:"Stick a piece of masking tape on the first optical path hole. Press the tape in to allow you to see the outline of the hole.",level_point_4:"Then go to the next step.",close_lid:'Close the lid of the machine and click "Pulse"',pulse:"Pulse",level_point_5:'Check the mark left by the laser beam on the masking tape, select the actual state, and click "Next"',upper_left:"Upper left",upper_center:"Upper center",upper_right:"Upper right",center_left:"Center left",center:"Center",center_right:"Center right",lower_left:"Lower left",lower_center:"Lower center",lower_right:"Lower right",level_point_6:"Find the first mirror.",turn_1:"Turn the upper-left screw 45° counterclockwise",turn_2:"Turn the lower-left screw 45° clockwise",turn_3:"Turn the upper-left screw 45° clockwise, and then turn the lower-left screw 45° clockwise",turn_4:"Turn the upper-left screw 45° counterclockwise, and then turn the lower-left screw 45° counterclockwise",turn_5:"Turn the lower-left screw 45° counterclockwise",turn_6:"Turn the upper-left screw 45° clockwise",level_point_7:'If the hole in the masking tape has been burned large, replace it with a new piece and click "Pulse"',level_point_8:'Use the hex key to loosen the three hex screws around the first mirror without removing them, and click "Next"',level_point_9:"The laser beam passes the first optical path hole properly. Now let's test it on the second one.",level_point_9_1:"The laser beam passes the first optical path hole properly.",level_point_9_2:" Now let's test it on the second one.",level_point_10:"Stick a piece of masking tape on the second optical path hole. Press the tape in to allow you to see the outline of the hole.",level_point_11:"Then go to the next step.",can_not_see:"Can't see any marks?",level_point_13:"Note: You may need to adjust the screws multiple times until the mark is left in the center of the hole outline on the masking tape.",adjustment_1:`If you don't see any mark left by the laser beam, try clicking "Pulse" multiple times.`,adjustment_2:'If still no laser mark is left on the masking tape, move the x-axis guide rail inward by clicking "Move guide rail inward" once and then click "Pulse" to test the path. Repeat this operation until you see a laser mark.',rail_backward:"Move guide rail inward",rail_forward:"Move guide rail outward",adjustment_3:`Check whether the guide rail is in the most outward position. If it isn't, click "Not in the most outward position" to move it outward. Then, test whether the laser beam passes properly through the second optical path hole again to ensure proper optical path calibration.`,not_close_front:"Not in the most outward position",close_front:"In the most outward position",level_point_14:"The laser beam passes the second optical path hole properly. Now let's test it on the third one.",level_point_14_1:"The laser beam passes the second optical path hole properly.",level_point_14_2:"Now let's test it on the third one.",level_point_15:"Stick a piece of masking tape on the third optical path hole. Press the tape in to allow you to see the outline of the hole.",turn_7:"Turn the upper-left screw 45° clockwise, and then turn the lower-right screw 45° clockwise",turn_8:"Turn the lower-right screw 45° clockwise",turn_9:"Turn the upper-right screw 45° counterclockwise",turn_10:"Turn the upper-right screw 45° counterclockwise, and then turn the lower-right screw 45° counterclockwise",turn_11:"Turn the upper-right screw 45° clockwise",turn_12:"Turn the lower-right screw 45° counterclockwise",turn_13:"Turn the upper-right screw 45° clockwise, and then turn the lower-right screw 45° clockwise",adjustment_4:`If you don't see any mark left by the laser beam, try clicking "Pulse" multiple times.`,adjustment_5:'If still no laser mark is left on the masking tape, move the laser module to the left of the machine by clicking "Move laser module left" once and then click "Pulse" to test the path. Repeat this operation until you see a laser mark.',laser_left:"Move laser module left",laser_right:"Move laser module right",ok:"OK",adjustment_6:`Check whether the laser module is close to the right of the machine. If it isn't, click "Not close to the right" to move it close to the right. Then, test whether the laser beam passes properly through the third optical path hole again to ensure proper optical path calibration.`,close_right:"Close to the right",not_close_right:"Not close to the right",test_pass:"Optical path test passed!",enjoy:"Now, enjoy your journey to laser creation.",done:"Done",level_point_16:"Find the second mirror.",tool_1:"Get these items ready",tool_3:"Hex key 1.5 mm (included in the pack)",tool_2:"Screwdriver (included in the pack)",tool_4:"Masking tape (not included)",tool_5:"Ready, next",tool_6:"Use the screwdriver",level_point_17:"Stick masking tape",level_point_18:"Loosen the screws"}},_Ve={device:vVe},yVe={display:{position:"Position",position_x:"X",position_y:"Y",size:"Size",size_width:"W",size_height:"H",rotate:"Rotate",rotate_angle:"°",radius:"Corner radius",lock_aspect_ratio:"Lock aspect ratio",graphic_setting:"Graphic settings",graphic_fill:"Fill",text_setting:"Text settings",text_input:"Text",text_size:"Size",text_placeholder:"Please enter a text",font_family:"Typeface",letter_spacing:"Spacing",filter:"Filter",sharpness:"Sharpness",gray_value:"Grayscale",color_inverted:"Invert",color_inverted_tips:"Inverts the colors of the image. For a colorful image, it is converted into a grayscale image first and then the colors are inverted. You can preview the engraving results on a dark-colored material.",color_inverted_link_text:"View",color_inverted_link_href:"https://s.xtool.com/doc/editor/invert",line_leading:"Leading",text_align:"Align",text_align_left:"Left",text_align_middle:"Middle",text_align_right:"Right",font_weight:"Weight",font_weight_normal:"Normal",font_weight_bold:"Bold",font_weight_thin:"Thin",font_style:"Style",font_style_normal:"Normal",font_style_italic:"Italic",proposed_fonts:"xTool selected typeface",local_fonts:"System typefaces",text_operations:"Operations",text_weld:"Weld"},operation:{undo:"Undo",redo:"Redo",extract_contours:"Outline",extract_contours_inner:"Inner",extract_contours_outer:"Outer",extract_contours_offset:"Offset distance",extract_contours_generate:"Outline generating...",extract_contours_add_inner:"Add inner outline for bitmap",batch_create:"Array",batch_create_liner:"Grid array",batch_create_liner_desc:"Click to create a grid array.",batch_create_radial:"Circular array",batch_create_radial_desc:"Click to create a circular array.",batch_create_material_test:"Material test array",batch_create_material_test_desc:"Click to create an array to test parameter settings for your material.",auto_layout:"Auto layout",shape_match:"Smart fill",smart_filling:"Smart filling ...",smart_fill_failed:"Smart fill failed. Possible cause and solution",shape_match_cloud:"(Internet access required)",shape_match_free_tip:"Limited Offer",shape_match_net_tip:"Cloud services are required when you use the smart fill function. Please connect to a network first.",shape_match_desc:"Click to perform batch processing. Materials of the same shape, color, and size are recognized and the design object is generated for each material.",align:"Align",align_left:"Align left",align_right:"Align right",align_top:"Align top",align_bottom:"Align bottom",align_vertical:"Vertical align center",align_horizontal:"Horizontal align center",align_center:"Align center",distributed:"Distribute",distributed_horizontal:"Distribute horizontally",distributed_vertical:"Distribute vertically",bool:"Combine",bool_union:"Unite",bool_subtract:"Subtract",bool_intersect:"Unite at overlap",bool_exclude:"Subtract at overlap",layer:"Arrange",layer_up:"Bring forward",layer_down:"Send backward",layer_end:"Send to back",layer_top:"Bring to front",flip:"Reflect",flip_horizontal:"Reflect horizontally",flip_vertical:"Reflect vertically",zoom:"Zoom",zoom_adaptive:"Fit on screen",fit_to_width:"Fit to width",fit_to_height:"Fit to height"},mode:{image:"Image",select:"Select",drag:"Hand",graphic:"Insert",graphic_circle:"Circle",graphic_rectangle:"Rectangle",graphic_line:"Line",shape:"Shape",text:"Text",pen:"Vector",extract:"Extract",import:"Artimind",bar_code:"Code",qr_code:"QR code",qr_code_desc:"Enter a text to generate a barcode or QR code and add it to your design.",qr_code_properties:"QR code properties",qr_code_type:"Code type",one_dimensional_properties:"Barcode properties",one_dimensional_code:"Barcode",error_rate:"Fault tolerance",advanced_options:"Advanced settings",content:"Content",please_enter_text:"Please enter text",please_enter:"Please enter figures or characters"},context_menu:{cut:"Cut",copy:"Copy",paste:"Paste",delete:"Delete",select_all:"Select All",zoom_in:"Zoom in",zoom_out:"Zoom out",group:"Group",ungroup:"Ungroup",show_background:"Show background",hide_background:"Hide background",refresh_background:"Refresh background",export_svg:"Export as SVG...",make_mask:"Create mask",edit_mask:"Edit mask",release_mask:"Release mask",exit_vector_editor:"Exit vector editor",toggle_lock:"Lock / Unlock",toggle_visible:"Show / Hide",show_invisible:"Show hidden objects"},hotkey:{select:"Select",pen:"Vector",circle:"Circle",rectangle:"Rectangle",line:"Line",zoom_in:"Zoom in",zoom_out:"Zoom out"},modal:{batch_create_liner:"Grid array",batch_create_liner_col_num:"X columns",batch_create_liner_col_space:"X spacing",batch_create_liner_row_num:"Y rows",batch_create_liner_row_space:"Y spacing",batch_create_radial:"Circular array",batch_create_radial_x:"x",batch_create_radial_y:"y",batch_create_radial_start:"Start",batch_create_radial_end:"End",batch_create_radial_step:"Step",batch_create_radial_copies:"Copies",batch_create_radial_rotate_self:"Rotate object copies",batch_create_negative:"Cancel",batch_create_positive:"Create",take_photo_position:"Snapshot preview"},drawer_title:{text:"Text",bitmap:"Image",edit_image:"Edit image",trace_image:"Trace image"},image_tracing:{tracing:"Trace image",aberration_threshold:"Fuzziness threshold",noise_ignore:"Denoising",smoothness:"Smoothness",preview_generating:"Preview generating...",combined_path:"Layering by color",path_generating:"Path generating...",hard_to_fill_svg:"The current picture is too complex, which may cause a path generation failure. Therefore, save the picture with caution",fail_to_fill_svg:"The current picture is too complicated and the generation path fails. Please adjust the parameters or replace the picture and try again"},image_process:{entry:"Edit image",tool_cutter:"Crop",tool_cutter_desc:"Select the area you want to keep",tool_magic_wand:"Magic wand",tool_magic_wand_desc:"Click the area to be deleted from the image",tool_eraser:"Eraser",tool_eraser_desc:"Drag it over the area you want to erase",attr_aberration:"Fuzziness",attr_size:"Size",fit_on_screen:"Fit on screen"},image_filter:{filter:"Filter"},image_adjust:{adjust:"Adjustments"},filter:{null:"Original",grid:"Grid",sketch:"Sketch",comic:"Comic",emboss:"Embossment",binary:"Black-and-white",attrs:{emboss:{strength:"Strength"}}},bitmap_effect:{loading:"Effect generating ..."},clip_mask:{editing:{title:"Clipping mask",desc:"Move the semitransparent bitmap to the mask",done:"Done"},make_mask:"Create mask",edit_mask:"Edit mask",release_mask:"Release mask"},alert:{shape_match_failed:"Smart fill failed",connect_device:"Please connect a device first.",take_picture_first:"Please refresh the background first.",shape_match_failed_link_href:"https://community.xtool.com/#/making/detail/tips/377",unrecognized_file:"The file can't be opened.",unrecognized_file_link_href:"https://community.xtool.com/#/making/detail/tips/96"},layer:{layer:"Layer",no_layer_yet:"No layer yet",move_the_selected_object_to:"Selected object ",move_to:"Move to",sure_to_delete:"Are you sure you want to delete the layer and all the objects on it?",delete_layer:"Delete Layer",mobile_move_the_selected_object_to:"Selected object move to",layer_object:"Layer and object list",red:"Red",orange:"Orange",yellow:"Yellow",green:"Green",cyan:"Cyan",blue:"Blue",purple:"Purple",black:"Black"},shape:{basic:"Basic shape",plant:"Plant",animal:"Animal",festival:"Festival",border:"Border",other:"Other",parts:"Parts",pattern:"Pattern"},export_svg:{alert_text_conversion:"The texts will be rasterized and then exported.",export_state_processing:"Exporting ... Please wait",export_state_success:"Export succeeded"},import_svg:{alert_has_text:"The SVG file contains texts that cannot be parsed currently.",more_help:"Help"},object_panel:{object:"Object",parameter:"Parameter",processing:"Processing",design:"Design",quick_actions:"Quick actions"},vector:{vector:"Vector",edit_node:"Edit node",cutting:"Cut",node_type:"Node type"},display_list:{title:"Object list",no_object_yet:"No object yet"},application_center:{code:"Code generation",title:"Applications",modal_1:"Select one or more objects on the canvas first.",toast_1:"Please select one or more objects on the canvas first.",toast_2:"Please select one object on the canvas first.",toast_3:"You can select only one object. Please select again.",toast_4:"Please connect a device first.",smart_fill_tip:"This application is available only for xTool M1 and P2. ",fill:"Fill"},vector_editor:{sharp_corner:"Sharp corner",perfect_symmetry:"Perfect symmetry",total_asymmetry:"Total asymmetry",angled_symmetry:"Angled symmetry"},sticker:{camera_location:"Snapshot preview",calibration:"Calibrate",tip1:"1.This function allows you to take a picture of the working area with the camera of your mobile device, and insert it into the canvas as the background.",tip2:"2.Attach the stickers and record their positions first and then shoot the working area, so that the background image you shoot is aligned with the canvas.",tip3:"Note: You need to attach the stickers and perform calibration only once. To do this again, tap the lower-left icon on the screen and select Calibrate.",go_calibration:"Calibrate",step1:"Follow the arrangement shown in the diagram to attach a group of stickers to the working area. Ensure that the stickers are within the processing area of the laser module.",no_sticker:"No stickers yet?",next:"Next",step2:"Move the laser module until the red-cross spot falls at the center of the top-left sticker, and press xTool S1's button to record the position. Record the other stickers in the same way sequentially.",left_top:"Top left",right_top:"Top right",left_bottom:"Bottom left",right_bottom:"Bottom right",complete:"Done",location_repeat_error:"Do not record the same position twice",calibration_order_error:"Please record the positions from left to right and top to bottom",focusing:"Laser module focusing ...",take_photo:"Shoot background",markingPoint:"marking point",step1_title:"Attach sticker (1/2)",step2_title:"Calibrate (2/2)"}},AVe={editor:yVe},bVe={name:"Project center",header:{editor:"Back to editor",refresh:"Refresh"},list:{search_input_placeholder:"Search for project by name or label",apply_device_mode:"Applicable to",difficulty:"Difficulty level",level:"Level {level}",processing_type:"Processing type",material_type:"Material type",reset:"Reset",all:"All",filter:"Filter:"},detail:{name:"Project details",accomplished_by:"This project is created on {device}-{power}. Use the parameter settings only for machines of the same model. You need to modify the parameters when using a machine of another model.",materials:"xTool materials and tools",materia_count:"* {count}",support_materials:"Supporting materials and tools",precautions:"Precautions",steps:"Steps",help_center:"Help center",user_guide:"User guide",expand:"Expand",collapse:"Collapse",start_project:"Start project",print:"Print",buy:"Shop"},newbie_modal:{title:"Hi, we've provided some example projects to help beginners get started. You can click to go to our Support website for more details!",no_more_reminders:"No more reminders"},error:{no_content:"No content found",project_not_view:"This project is not available currently. Please go to the project center to find more projects.",network_error:"Network connection failed. Please check your network settings. Some of the functions that require no network can still be used.",system_error:"System exceptions occur. Please refresh and try again."},other:{ok:"OK"}},wVe={example:bVe},xVe={create_project:"Click to create a project",connect_device:"Switch or connect your device here",add_project:"Add projects here",add_canvas:"Add canvases here",add_elements:"Add objects to a canvas here",layer_control:"Manage layers here",set_object_attr:"Edit objects here",welcome:"Welcome to XCS! Start your journey to laser creation here!",enjoin:"Start your journey to laser creation!",learn_again:"You can find this beginners' guide in Help.",start:"Start",skip:"Skip",finish:"Start",inactive:"Not now",prev:"Previous",next:"Next",done:"Done",feature_1:"New UIs",feature_2:"New design features",feature_3:"Multi-device & multi-task",feature_4:"Processing progress preview"},CVe={guide:xVe},EVe={header:{open_local_proj:"Open from computer",new_proj:"New project"},title:"Home",xtool_projects:"xTool Projects",to_shop:"Shop",my_space:"My Space",recent:{title:"Recently",new:"New project",open:"Open",remove:"Remove",show_local:"Open file location",file_notfound:"Cannot find the file. It may have been moved or deleted."},recommended:{title:"Recommended",more:"More",buy:"Buy & Use",detail:"Details",open_to_editor:"Open in XCS",not_error:"Network connection error",net_error_desc:"Connect to the Internet to get access to over 2,000 projects tailored for you",reload:"Reload",bad_connection:"Bad Connection",is_file_opening:"A file is being opened. Please try again later.",file_open_error:"Failed to open the file"}},TVe={home:EVe},IVe={bar:{connect:"Connect device",framing:"Framing",process:"Process",back:"Back",preview:"Preview",start_processing:"Start",cancel:"Cancel",pause:"Pause",minimize:"Minimize",redo:"Process again",continue:"Continue",confirm:"Confirm",complete:"Complete",settings:{new_construction:"New Project",open_project:"Open Project",rename_project:"Rename Project",save:"Save",export_as_svg:"Export as SVG",view_gesture_guidelines:"Gesture guide",help_center:"Help",newbie_guid:"Beginner's guide",import_custom_parameters:"Import custom setting",export_custom_parameters:"Export custom setting"}},common:{iknow:"Got it",confirm:"Yes",cancel:"Cancel",notice:"Tip",yes:"Yes",no:"No",save:"Save",not_import:"You can't switch projects during processing.",not_import_notice:"Importing files is not supported currently",failed_to_open_file:"Failed to open the file"},home:{cache_notice:`Unsaved changes are found.
Do you want to continue the editing?`,continue_cache:"Continue editing",abandon_cache:"Discard",not_support_mode:"The processing mode used in the project file is not supported. After you open the project file, only the objects on the canvas are retained. Are you sure you want to open it?",not_support_mode_title:"Processing mode not supported",not_support_mode_process:"You can't start processing in the current mode.",not_support_mode_framing:"You can't start framing in the current mode.",user:{points_history:"Points history",user_setting:"Accout setting",logout:"Logout",no_network:"Network exception. Please try again later"},my_project:{my_project:"My projects",new_project:"New project",share:"Share",upload:"Upload to Cloud",copy:"Duplicate",rename:"Rename",delete:"Delete",share_fail:"Sharing failed",share_success:"Sharing success",seconds_ago:"seconds ago",minutes_ago:"minutes ago",hours_ago:"hours ago",days_ago:"days ago"},recommended:{details:"Details",open:"Open in XCS",more:"More",bad_network:"Network connection error",tip_connect:"Connect to the Internet to get access to over 2,000 projects tailored for you",reload:"Reload"},slider:{login:"Log in",home:"Home",space:"My Space",xtool_projects:"xTool Projects",settings:"Settings",shop:"Shop"},help:{help:"Help",beginner_guide:"Beginner's guide"},project:{name:"My Projects",future_project:"Future project",create:"New project",local:"Local projects",cloud:"Cloud projects",cloud_used:"Free count used",rename:"Rename",download:"Download",quick_copy:"Quick copy",share:"Share",delete:"Delete",delete_title:"Delete",delete_content:`Are you sure you want to delete project "{name}"? The deletion can't be undone.`,album:"Photos",save_temp_project:"Are you sure you want to save the project {name}？"},community_new:{name:"Projects",how:{title:"Curated Projects",des_v:"1000+ projects with free design files and tutorials."},tips:{title:"By Machine",des_v:"Discover projects created for your machine."},inspiration:{title:"By Material",des_v:"Let materials guide your creativity! "}},support:{name:"Support",quick_start:"Quick start",video:"Video tutorials"},shop:{name:"Shop",accessory:"Accessories",consumable:"Materials"},restart_xcs:"Restart XCS for the setting to take effect",vector_fill:"Display vector fill",setting:"Settings",privacy:"Tap to view the privacy agreement",privacy_notice_title:"Terms and Policy",privacy_notice_content:"Thank you for choosing Creative Space! To learn more about the services we provide and how we collect and deal with your personal information, see the {privacy_policy}, {user_policy}, and {safe_policy}. By tapping Accept & Continue, you are indicating that you agree to all the terms and policies.",privacy_full:"Read the full version of",privacy_policy_des:"Terms of Service",user_policy_des:"Privacy Policy",safe_policy_des:"Safety Terms",and:"and",feedback:"Feedback",tap_to_see:"Tap to view the {user_policy}, {privacy_policy} and {safe_policy}",accept:"Accept & Continue",decline:"Decline",disagree:"Decline",agree:"Agree",accept_agree:"Accept & Continue",bar_home:"Home",add_projects:"Add project",create_project:"Create project"},gesture:{title:"Gesture",select:"Select",multiple_select:"Multiselect",rotate:"Rotate",move:"Move item",more:"Item short menu",zoom:"Zoom in/out",move_canvas:"Move canvas",more_canvas:"Canvas short menu"},editor:{header:{home:"Back",setting:"Settings",connected:"Connected",not_connect:"Go to connect",editor:"Edit"},layer:{color:{red:"Red",green:"Green",blue:"Blue",yellow:"Yellow",purple:"Purple",black:"Black",cyan:"Cyan",orange:"Orange"},no_layers:"No layer yet",sure_to_delete:"Are you sure you want to delete the layer and all the objects on it?"},current_mode_not_support:"The processing mode set in the project is not supported, but you can still view and edit elements on the canvas.",save_notice_title:"Save the project {name}?",camera:"Camera",album:"Photos",file:"Files",process_notice:"Do not lock your screen or run XCS in the background, or your device may be disconnected, causing processing failure.",camera_title:"Camera Access Not Enabled",camera_content:'Allow access of camera in your iPad"Settings">"Creative Space"',go_system_setting:"Go to Settings",know:"Got it",canvas:"Canvas",import_material_no_match_title:"Material setting not match",import_material_no_match:"The material setting does not match the processing mode. After you use the material setting, the processing mode will change accordingly. Are you sure you want to use it?",multi_canvas:{delete_canvas:"Deletion cannot be undone. Are you sure you want to delete the canvas?",delete_canvas_title:"Tips",confirm:"Confirm"},intelligent_adsorption:"Auto-snapping",gesture_guidance:"Gesture guide",view:"View",accurate_hit_restart:"You need to restart XCS for the function setting to take effect. ",restart:"Restart",select_take_local_img:"Drag the viewfinder frame to the target capturing area",select_precise_measure:"Drag the viewfinder frame to the target measurement area",layout:"Arrange",loosing_text:"Release to refresh ...",quality:"Quality",save_success:"Saving succeeded",save_fail:"Saving failed",graphics_curves_quality:{title:"Vector quality",option_best:"Optimal:",option_best_desc:"ideal for patterns larger than 20 inches and allows for an average speed",option_high:"High:",option_high_desc:"good for patterns of 10 to 20 inches and allows for a moderately faster speed",option_medium:"Medium:",option_medium_desc:"good for patterns smaller than 10 inches and allows for a fast speed",take_effect_tips:"The setting will take effect when you import an image file next time."},vector_part:{vector:"Vector",edit_node:"Edit node",done:"Done",sharp_corner:"Sharp corner",perfect_symmetry:"Perfect symmetry",total_asymmetry:"Total asymmetry",angular_symmetry:"Angled symmetry"},bottom:{multiple_choice_mode:"Multiselect",append:"Append",text:"Text",pen:"Vector",shape:"Shape",graffiti:"Graffiti",x_art:"xArt",expand_application:"Applications",revocation:"Revocation",redo:"Redo",position_shot:{shot_title:"Snapshot preview",hide_background:"Hide background",display_background:"Show background",calibrate:"Calibrate"}},tips:{text:"Text editing",basic_operation:"Basic operation",more:{delete:"Delete",size_locking:"Size locking",size_not_locked:"Size not locked",fast_replication:"Fast replication"},edit_node:"Edit node"},extent:{grid_description:"Tap to create a grid array.",circular_description:"Tap to create a circular array.",material_description:"Tap to create an array to test parameter settings for your material.",code_description:"Enter a text to generate a barcode or QR code and add it to your design.",fill_description:"Click to perform batch processing. Materials of the same shape, color, and size are recognized and the design object is generated for each material."},smart_fill:{fail_toast:{tap_here:"Tap here",desc:"Smart fill failed. {tap_here} to learn more."},shape_match_desc:"Tap to perform batch processing. Materials of the same shape, color, and size are recognized and the design object is generated for each material."},open_xcs_file_error:"Unrecognized file.",lock_aspect_ratio:"Lock aspect ratio",unlock_aspect_ratio:"Unlock aspect ratio",loss_fonts:"The typeface used in the project file is not supported. The missing typeface is replaced with the default typeface.",loss_fonts_description:"The typeface used for the text on the canvas is not supported. You can choose to:"},connect:{device_idel:"Ensure that the device is idle",add_new_device:"Wi-Fi setting",help_title:"Connection help",help_notice_one:"1. Ensure that your device is turned on.",help_notice_two:"2. Ensure that your device has been configured with a Wi-Fi network.",help_notice_three:"3. Ensure that the network connected by your device is turned on and the password has not been changed.",help_notice_four:"4. Ensure that no VPN network is being used on your mobile phone or iPad",reset_notice:"If the preceding conditions are ensured but your device still cannot be connected, please {reset} ",reset:"reset your device.",reset_title:"Enable device hotspot",reset_notice_device:"Configure Wi-Fi when the device is not in use. Hold down the button on the device until the indicator turns {color}, and then tap OK, next.",reset_notice_slow_flashing:"Hold down the button on the device till the indicator blinks slowly {color}",reset_notice_light:"Configure Wi-Fi when the device is not in use. Hold down the button on the device until the indicator turns {color}, and then tap OK, next.",reset_notice_gs002:` If you see the "AP" icon on your mobile device, go to the next step. If you don't see it, press the Start/Stop button of the device for 5s until the icon is displayed.`,reset_notice_device_f1:`1. Power on your device. 
2. Hold down the button on the device for 5s until the {color}. The device enters the network configuration state.`,blue_white:"white/blue",green:"green",white:"white",yellow:"yellow",purple:"purple",solid_yellow:"solid yellow",confirm_next:"OK, next",select_wifi:"Select Wi-Fi",wifi:"Wi-Fi",no_wifi:"The configured Wi-Fi network can't be found. Please enter the network name or check whether Location Services is enabled.",not_support_wifi:"Access to this type of hotspot is not supported",placeholder_wifi:"Enter the Wi-Fi account",placeholder_wifi_name:"Enter the Wi-Fi name",placeholder_password:"Enter the password",connect_wifi:"You need to connect your device to the same Wi-Fi network as iPad.",wifi_notice:"The device supports only 2.4 GHz Wi-Fi networks.",remember_password:"Remember password",select_connect_device:"Connect device hotspot",connect_device_wifi:"Set the WLAN of your iPad to the hotspot of {deviceName},{wifiPwd} wait for the connection to complete, and then go back to XCS.",connect_wifi_pwd:" enter the password 12345678,",go_wifi_setting:"Go to connect device hotspot",connection_completed:"Connection completed",setting_wifi:"Configure Wi-Fi",transmit_to_device:"XCS sends network information to the device.",device_connect_wifi:"The device connects to the Wi-Fi network.",device_connected:"Configuration completed",connected_notice:"Please go to the device list and select your device. If no device is found, try configuring the Wi-Fi network again.",check_net:`Check the network.
`,check_device_open:"Please keep the device turned on.",no_internet:"XCS can't search for and connect to your device. Please choose Settings > Creative Space to enable Local Network.",location_access_needed:"Location access needed",go_to_open:"Go to Settings",select_device:"Select device",select_device_notice:"Select the model of your device for Wi-Fi configuration",wifi_set_completed:"Configuration completed! You can select your device in the Connect device window.",go_to_connect:"Go to connect",yes:"Yes",make_sure_is_same_wifi:"Ensure that your device and iPad are using the same Wi-Fi network.",go_to_setting:"Go to Settings",idle_notice:"Note: Ensure that the device is idle.And then tap OK, next.",firmware_notice:"Note: A low firmware version may lead to exceptions during network setting. If network setting keeps failing, please update the firmware to the latest version through XCS on the computer.",get_more_help:"Get more help",change_password:"Change hotspot password",placeholder_new_password:"Enter password",wifi_name:"Wi-Fi name",wifi_password:"Password",placeholder_confirm_password:"Confirm password",please_enter_password_tip:"Enter a string of 8 to 16 characters.",modify_device_name:"Change device name",modify_device_name_dialog_tip:"After modifying the device name, you will be disconnected once and need to connect the device manually.",hotspot_config_wifi:"Change Wi-Fi setting",hotspot_config_wifi_header_tip:"Enter the Wi-Fi name and Wi-Fi password to complete the Wi-Fi setting",hotspot_config_wifi_header_tip_new:"Select a Wi-Fi network and enter its password",hotspot_config_wifi_dialog_tip:"After the device connects to a Wi-Fi network, the hotspot connection will break. You need to manually reconnect to the device.",hotspot_config_wifi_btn_tip:"Manual setting",hotspot_config_wifi_list:"Wi-Fi available",refresh:"Refresh",modify_password_header_tip:"After the hotspot password is changed, the device will be connected using the new password.",modify_password_dialog_tip:"After changing the password, you will be disconnected once and need to connect the device manually.",hotspot_config_success:"Wi-Fi setting succeeded",hotspot_config_fail:"Wi-Fi setting failed",modify_password_success:"Password changed",modify_password_fail:"Password change failed",modify_password_no_support:"The hotspot password can't be changed currently.",password_inconsistent_tip:"Passwords don't match. Please enter the passwords again.",device_selected:"Device selected",device_available:"Devices available",delete_device:"Delete device",disconnect:"Disconnect",connected:"Connected",connect:"Connect",not_connect:"Not connected",processing:"In processing",not_connectable:"Can't find device connected through Wi-Fi",device_pop:"When you open a project, the device matching the project is selected. You can select another device to replace it."},graffiti:{name:"Graffiti",cancel_title:"Are you sure you want to cancel graffitiing?",cancel_content:"The drawings will not be saved after cancellation.",continue_editing:"Continue editing",pen_width:"Stroke size",erase_width:"Eraser size"},g_code_err:"Preview failed due to timeout. Please go back and try again.",notice:{error:"Network connection failed. Please check your network settings.",empty:'No content. Go to Local projects and tap "{icon_add}" to upload projects.',remaining_free_count_tip:"Need more Cloud space? Learn more about Cloud space",view:"View"},cloud_file:{success_text_:"Refresh succeeded",fail_text:"Refresh failure",pulling_text:"Pull down to refresh...",loosing_text:"Release to refresh...",loading_text:"loading...",uploading:"uploading...{progess}%",upload_success:"File upload succeeded",upload_error:"File upload failed",upload_other:"File uploading ... Please wait.",upload_this:"The file is uploading ... Please wait.",upload_limit:"The space available in Cloud has reached the upper limit. Please delete the files you don't need and then upload files.",upload_limit_title:"Insufficient Cloud storage",download_success:"File download succeeded",download_error:"File download failed",download_other:"File downloading ... Please wait.",download_this:"The file is downloading ... Please wait.",open_file_in_cloud:"Want to open it? The file stored in Cloud is not modified.",downloading:"Downloading",used_files_:"Free count used",used_files_tip_content:"Need more Cloud space？Learn more about Cloud space",rename:"Rename",download:"Download",delete:"Delete",delete_content:`Are you sure you want to delete project "{name}"? The deletion can't be undone.`,file_download_succeeded:"File download succeeded",file_download_failed:"File download failed",file_download_cancel:"Download canceled",upload_file:"Upload file",upload_file_empty_:"No file yet. You can upload files.",try_it_now:"Try it now",non_login_title_1:"Secure",non_login_content_1:"Powered by Azure Cloud services, secure, enduring, and highly available",non_login_title_2:"Efficient",non_login_content_2:"Files can be accessed anytime, improving the creation efficiency",non_login_title_3:"Synchronous",non_login_content_3:"With one xTool account, you can sync files and data in XCS across multiple platforms",refresh:"Refresh",bad_network:"Network connection error"},rate:{title:"Well done!",rate_content:"Did you enjoy your creation journey?",help_improve:"No. Help improve",rate_it:"Yes. Rate it",help_to_improve_title:"Please describe what you think can be improved.",improve_blank_tips:"Leave your email address here if you would like us to contact you.",submit:"Submit",submit_success:"Submitted",submit_fail:"Submission failed. Please check your network."},process:{scale_down:"Zoom out",scale_up:"Zoom in",scale_back_to_origin:"Restore",calculate_gcode_tip:"Preparing for preview...",remaining_time:"Remaining time",estimated_time:"Estimated time",processed_hours:"Time used",laser_trajectory:"Laser module trajectory",laser_trajectory_content:"Path along which the laser module moves without producing laser beams",processing_path:"Processing path",processing_path_content:"Path along which the laser module produces laser beams",laser_position:"Laser module position",laser_position_content:"Position of the laser module",calculating:"Calculating...",calculating_new:"Calculating",total_time_estimated:"Total time estimated",speed:"Speed",process_top_tip:"Do not leave the device unattended when it is working.",process_safe_top_tip1:"You haven't completed the laser safety training. Improper operation of laser machines may cause safety hazards. ",process_safe_top_tip2:"Complete safety training",sending_the_file:"Sending the file for processing ... ",ready:"Ready",process_ready_modal_tip:"Press the button on the device to start the processing.",process_ready_tip1_f1_ultra:"Press the XTOOL button on the touchscreen controller to start processing. Exercise caution when processing inflammable materials to prevent fires.",process_ready_tip1:"Press the button on the device to start processing. Exercise caution when processing flammable materials .",process_ready_tip2:"Do not lock your screen or run XCS in the background, or your device may be disconnected, causing processing failure.",process_processing:"Processing",process_paused:"Paused",process_complete:"Complete",process_canceled:"Task canceled",process_disconnect:"The device has been disconnected",process_disconnect_tip:"Pay attention to the material processing status of the device. To pause or cancel the processing, perform the corresponding operation on the device.",process_burned_tip_f1_ultra:"The material may be hot if it is metal or it has been processed for a long time. Be careful not to get burned.",back_up_file:{file_name:"File name",back_up_file:"Back up file",back_up_file_to_device:"Back up file to device",modal_tip_content:"Backs up the file to your device. Then you can view it on the device screen and use it for offline processing.",toast_loading:"Backing up file ...",toast_success:"File backup succeeded",toast_fail:"File backup failed"},camera:{view_processing_status:"View processing status",save:"Save"}},tasks:{tab_in_processing:"In processing",tab_task_history:"Task history",processing_empty:"No task in progress",history_empty:"No task history",move_to_task_history:"Move to task history",connect_again:"Connect again",open_file:"Open file",pause_:"Pause",continue_:"Continue",cancel_:"Cancel",status_text_interrupted:"Interrupted at ",status_text_finished:"Finished at ",status_text_processing:"In processing",status_text_paused:"Paused",time_remaining:"Remaining ",time_takes:"Takes ",cancel_tip_content:"Confirm to cancel the task?",remove_tip_title:"Remove processing task",remove_tip_content:"Are you sure you want to remove the processing task?",history_tip_content:"Only 20 recent historical tasks can be retained. When exceeded, the oldest historical tasks will be automatically cleared.",interrupted_tip_content:"If the device is in processing but the task status is Device disconnected. You can connect the device again to manage the task. If you don't connect it, the device continues to complete the processing and the task will be moved to the task history in 30 minutes.",task_first_tip_content_:"The processing task has been included in this task list.",connect_again_success:"Device connected successfully",connect_again_failed:"Device connection failed. Please try again. Solution",connect_again_ailed_fix:"Solution",file_not_exist:"Can't find the file."},guide:{create_project:"Tap to create a project",connect_device:"Switch or connect your device here",add_project:"Add projects here",add_canvas:"Add canvases here",add_elements:"Add objects to a canvas here",layer_control:"Manage layers here",set_object_attr:"Set object parameters here",welcome1:"Welcome to XCS! ",welcome2:"Start your journey to laser creation here!",enjoin:"Let's get started on your laser creation journey.",learn_again:"You can find this beginners' guide in Help.",view_again:"You can tap the menu to find this beginners' guide.",start:"Start",skip:"Skip",finish:"Start",inactive:"Not now",prev:"Previous",next:"Next",done:"Done",feature_1:"New UIs",feature_2:"New design features",feature_3:"Multi-device & multi-task",feature_4:"Processing progress preview"},firmware:{downloading:"{percent}%  downloaded",uploading:`{percent}% updated
Please wait. Do not turn off the device.`,succeeded:"Congratulations! The firmware is updated successfully.",need_update_firmware:"A new firmware version is found: {latestVersion}."},dialog:{cancel:"Cancel",confirm:"Confirm",got_it:"Got it",view:"View",information:"Information",tips:"Tips",complete:"Complete",fill:"Fill",save:"Save",create:"Create"},tips:{select_file:"Select file",cancel:"Cancel"},safety:{safety_title:"Safety training",click_to_learning:"Tap to go to Safety training",safety_training_tip:"The device connected is a Class 4 laser machine. For your safety, according to the applicable laws and regulations, please complete laser safety training before operating the device.",safety_always_tip:"You haven't completed the laser safety training. Improper operation of laser machines may cause safety hazards.",safety_always_tip_link:"Complete safety training.",login_learning_complete:"Login succeeded! You have completed the laser safety training for this account.",training:"training"},parameter_panel:{user_guide:"Tap the EasySet panel to set the parameters"},measure:{measure_surface_first:"Tap Curve-measure to measure the curved surface first."}},SVe={ipad:IVe},PVe={title:"Messages",mark_all_read:"Mark All as Read",all:"All",device:"Device",system:"System",app:"App",activity:"Activity",unread:"Unread",read:"Read",view_details:"View Details",view_all_messages:"View All Messages",all_messages:"All Messages",confirm:"Confirm",close:"Close",no_data:"No news yet",seven_days_title:"Do not disturb for seven days",only_a_month_messages:"Only show messages within a month",only_a_month_unread_messages:"Only show unread messages within a month"},MVe={mc:PVe},RVe={common:{loading:"loading...",create_project:"Create project",add_project:"New project",my_project:"My projects",photo:"Camera",photo_album:"Album",save_notice_title:"Save the project?",yes:"Yes",no:"No",confirm:"Confirm",save:"Save",saving:"Saving ...",save_success:"Saving succeeded",save_fail:"Saving failed",cancel:"Cancel",back:"Back",notice:"Tip",local_network_title:"Local Network Access Not Enabled",local_network_tip:'Go to "Settings" > "Creative Space" and enable local network access.',go_to_setting:"Go to Settings",not_yet:"Not yet",update_now:"Update Now",privacy_policy:"Terms and Policy",app_latest:"This is the latest version.",check_update_fail:"Update checking failed. Please check the network.",agree_and_continue:"Accept & Continue ",disagree:"Decline",accurate_location_title:"Precise Location Access Not Enabled",accurate_permission_on:"Precise Location Access Not Enabled",accurate_location_tip:'Go to "Settings" > "Creative Space" and enable precise location access, so that you can search for devices nearby.',discovered_new_version:"New version found",app_version:"Software Version",about:"About",about_software:"About XCS",privacy_policy_des:"Privacy Policy",user_policy_des:"Terms of Service",safe_policy_des:"Safety Terms",privacy_policy_detail:"Thank you for choosing Creative Space!</br>To learn more about the services we provide and how we collect and deal with your personal information, see the {user_policy}, {privacy_policy} and {safe_policy}.</br>By tapping Accept & Continue, you are indicating that you agree to all the terms and policies.",input_effective_range:"Range of validity ",check_for_updates:"Checking for updates...",iknow:"Got it",points_history:"Points history",person_setting:"Settings",person_login:"Log In",person_logout:"Log Out",current_software_version:"Current software version",current_firmware_version:"Current firmware version"},connect:{connect_tip:"Devices found on the same Wi-Fi network. Tap to select",select_device:"Select device",add_new_device:"Add device",quick_connect:"Quick connect",set_psw:"Set hotspot password",to_enable:"Go to enable",ios_reason:"Due to access restrictions, you need to manually connect to the hotspot of the device. Go to Settings > WLAN, connect to the device's hotspot, and go back to the App.",location_permission_tip:"To ensure the proper functioning of the Hotspot feature, please make sure that the precise location permission for the app has been enabled.",connetct_popup:"You cannot access the Internet when XCS connects to the device in hotspot mode. You can use the hotspot connection outdoors without a Wi-Fi network.",not_hotspot:"Press the Start/Stop button on the device for 5 seconds until the light color of the button changes. The device becomes a hotspot and is displayed in the device list.",learn_more:"Learn more",device_not_found:"Device not found?",hotspot_connect:"About Hotspot",forgot_password:"Forgot password",click_here:"Tap to connect",first_connect:"For the first time you use the hotspot connection, you're advised to set a hotspot password for better user experience.",encryption:"Please enter the hotspot password of the device to connect it.",confirm_and_connect:"Confirm and connect",save_and_connect:"Save and connect",ignored_this_time:"Ignore",go_connect:"Go to connect device",switch:"Switch",enter_psw:"Enter password",switch_devices:"Switch device",no_device:"No device",ip_connect:"IP connection",help:"Help",connect_loading_tip:"Connecting...",connect_success:"Connection succeeded",device_step_tip_one:"1. Power on your device.",device_step_tip_two:"2. Hold down the button on the device for 5s until the {preLightColor}. The device enters the network configuration state.",device_f1uitra_step_tip_two:`2. If you see the "AP" icon on your mobile device, go to the next step. If you don't see it, press the Start/Stop button of the device for 5s until the icon is displayed.`,"device-connect-tip":"Check that the device is in the network configuration state",connect_success_tip:"If the connection is successful, the indicator on the device blinks white.",connect_fail_tip:"If the connection failed, the indicator on the device blinks yellow.",connect_d1pro_success_tip:"Connection completed. Check whether the indicator turns {successLightColor}. If yes, the connection is successful; if no, the connection failed.",connect_success_tip_title:"Please confirm whether the indicator light turns {successLightColor}.",connect_success_tip_desc:"If the indicator light does not turn {successLightColor}, it means the configuration failed, please click Retry..",connect_mobile_tip:"Put your mobile phone as close as possible to the device.",send_info_to_device:"XCS sends network information to the device.",connect_wifi:"The device connects to the Wi-Fi network.",setting_wifi:"Go to WLAN settings",setting_wifi_ap:"Set Wi-Fi",not_open_wifi:"Wireless Data Access Not Enabled",not_open_wifi_tip:"Go to “Settings” > “Creative Space” to allow the wireless data access.",mobile_connect_xtool_hot_spot:"1. Connect your mobile phone to the hotspot {selectedDevice}.",mobile_connect_xtool_hot_spot_new:"1. Set the WLAN of your mobile device to the hotspot of {device}.",connect_wifi_pwd:" enter the password 12345678",back_to_app:"2. Go back to XCS.",connect_wifi_tip:"Connect Wi-Fi first",wifi_support_tip:"The device supports only 2.4 GHz Wi-Fi networks.",wifi_name:"Name",wifi_password:"Password",change_password:"Change hotspot password",placeholder_password:"Enter password",placeholder_again_password:"Confirm password again",remember_password:"Remember password",wifi_name_error:"Wi-Fi Incorrect name!",wifi_pwd_error:"Wi-Fi Incorrect password!",permission_gps_title:"To ensure that the hotspot function works properly, please allow location access to the app and enable ’Precise Location‘. ",permission_gps_title_hotspot:"To ensure that the hotspot function works properly, please allow location access to the app and enable ’Precise Location‘. ",permission_gps_info:"Allow location access",permission_gps_on:"Go to enable",permission_on:"Go to enable",permission_gps_off:`If you don't want to allow access, 
you can operate as follows:`,hand_input_wifi:"Enter the Wi-Fi information for connection.",make_sure_is_same_wifi:"Ensure that your device and mobile phone are using the same Wi-Fi network.",find_device_in_the_same_wifi:"Searching for devices at the same network...",connect_device_step_1:"1. Power on your device.",connect_device_step_2:"2. Set the same Wi-Fi network for your device and mobile phone.",connect_device_step_3:"3. After completing steps 1 and 2, tap Refresh.",connect_hotspot_step_1:"1.Ensure that the device is turned on and in hotspot mode.",connect_hotspot_step_2:"2.If the device is not in hotspot mode, press the Start/Stop button on the device for 5s to switch the connection mode from Wi-Fi to hotspot.",go_to_setting_tip:"To automatically obtain information about the Wi-Fi network used, please choose Settings > Privacy & Security to enable Location Services. ",open_gps_permission:"Enable Local Network to ensure the proper operation of your device",connect_xtool_hot_spot_error:"Please connect the correct device hotspot",pre_light_color_white:"Blinking white",pre_light_color_green:"Blinking green",pre_light_color_purple:"Blinking purple",pre_light_indicator_color_yellow:"Blinking yellow",pre_light_color_yellow:"Solid yellow",success_light_color_white:"Solid white",success_light_color_green:"Solid green",success_light_color_blue:"Solid blue",success_light_color_blue_white:"Solid white or solid blue",success_light_color_purple:"Solid purple",d_connect_notice:"Note: A low firmware version may lead to exceptions during network setting. If network setting keeps failing, please update the firmware to the latest version through XCS on the computer.",wifi_name_not_support:"Access to this type of hotspot is not supported",placeholder_new_password:"Enter password",placeholder_confirm_password:"Confirm password",please_enter_password_tip:"Enter a string of 8 to 16 characters.",device_name:"Device name",modify_device_name:"Change device name",modify_device_name_dialog_tip:"After modifying the device name, you will be disconnected once and need to connect the device manually.",hotspot_config_wifi_header_tip:"Enter the Wi-Fi name and Wi-Fi password to complete the Wi-Fi setting",hotspot_config_wifi_header_tip_new:"Select a Wi-Fi network and enter its password",hotspot_config_wifi_dialog_tip:"After the device connects to a Wi-Fi network, the hotspot connection will break. You need to manually reconnect to the device.",hotspot_config_wifi_btn_tip:"Manual setting",hotspot_config_wifi_list:"Wi-Fi available",hotspot_config_no_wifi_list:"No connectable Wi-Fi found, please try to Refresh.",refresh:"Refresh",modify_password_header_tip:"After the hotspot password is changed, the device will be connected using the new password.",modify_password_dialog_tip:"After changing the password, you will be disconnected once and need to connect the device manually.",hotspot_config_success:"Wi-Fi setting succeeded",hotspot_config_fail:"Wi-Fi setting failed",modify_password_success:"Password changed",modify_password_fail:"Password change failed",modify_password_no_support:"The hotspot password can't be changed currently.",password_inconsistent_tip:"Passwords don't match. Please enter the passwords again.",try_update_firmware:"Upgrade to the latest firmware and try again"},toast:{connect_device_first:"Connect your device first",device_not_supported:"Model not supported!",camera_not_authorized:"Camera Access Not Enabled",camera_not_authorized_text:'Go to "Settings" > "Creative Space" and enable camera access.',current_position_out_of_processing_range:"The current position of the laser head is out of the processing range",fail_to_get_position:"Fail to get position, please wait"},device:{select_material:"Material",processing_mode:"Processing mode",processing_type:"Processing type",xtool_selected_setting:"Parameter setting",filter:"Filter",device_details:"Device Details",device_setting:"Device setting",device_model:"Device model",connect_device:"Connect device",enter_canvas:"Tap to start editing or parameter setting",start_processing:"Process",file_save_as:"Save as",file_save:"Save",input_file_name:"Enter a file name",device_not_connected:"Device not connected",process_path_by_auto_desc:"Auto planning: Engrave first, cut next",process_path_by_layer_desc:"By layer: From top to bottom",camera_photo_tip_1:"Use the camera on your mobile phone to take a picture of the working area to serve as the background.",camera_photo_tip_1_pad:"Use the camera on your ipad to take a picture of the working area to serve as the background.",camera_photo_tip_2:"To use this function, you need a baseplate with the positioning markings to help XCS recognize the positions.",camera_photo_tip_3:"If you have the baseplate, you can place it in the working area and take a picture. If you don't have one, you can ",camera_photo_tip_link:"make a baseplate by yourself.",camera_photo_tip_ps:"Start position is set to Absolute coordinates when you use this function.",device_process_type:"Start position",device_relative_position:"Relative coordinates",device_absolute_position:"Absolute coordinates",device_zero_point_title:"Laser module is homing",device_zero_point_tip:"The laser module needs to go back to the origin before processing. Please wait.",device_zero_point_walk_board_tip:"The laser module goes back to the origin before framing. Please wait for a moment.",laser_head_return_tip:"The laser head is returning to its home position. Please operate later.",process_path_by_layer:"By layer",shoot_background:"Background shooting parameters",m1_preview_check_tip:"The {modeName} processing mode is selected. Ensure that the {bottomBoard} is in place and the {headName} has been installed on the {headType}.",process_diagram:"Processing module illustration",process_check:"Checking for processing",process_board:"baseplate",unable_to_detect_cutting_board:"No cutting mat is detected. Please install the cutting mat properly.",process_header:"Process header: ",process_header_checked_info:"The installed processing module does not match the processing mode. Please replace it.",process_preview_check_again:"Check again",laser_head_exception:"Laser module exceptions",base_plate_exception:"Baseplate exceptions"},material:{no_more:"No more",pulling_text:"Pull down to refresh...",loosing_text:"Release to refresh...",loading_text:"loading...",confirmed:"Confirm"},process:{set_up:"Settings",return_item:"Back to project",return_home:"Back to homepage",elapsed_time:"Time used",go_canvas_adjustment:"Go to canvas adjustment",current_mode_not_support:"The processing mode set in the project is not supported, but you can still view and edit elements on the canvas.",mode_not_support:"Processing is not supported in the current mode.",diameter_empty:"Processing exceptions will occur if Diameter is empty.",task_disconnect:"The device is disconnected. Please connect it again.",task_restored_connect:"The device has been connected again.","processing-setting":"Processing setting",before_process_default_data_tips_content_m1:"It is detected that the cut pressure is set to {cutPressure} g for one or more objects. Please set the cut pressure properly, or the processing result may be poor."},projects:{open_system_file:"Import from system file",rename_title:"Rename project",dialog_open_file_error:"The file can't be opened. Please open an {fileType} file.",dialog_delete_title:"Delete project",dialog_delete_msg:"Are you sure you want to delete the project? The deletion can't be undone.",share:"Share",unsave_project:"Found unsaved project",cache_notice:"An unsaved project is found. Do you want to continue editing it?",copy_success:"Copy succeeded",rename_success:"Rename succeeded",delete_success:"Delete succeeded",open_xcs_file_error:"Unrecognized file.",continue_cache:"Continue editing",abandon_cache:"Discard",processing_open_file_error:"It is not support opening during processing",not_support_open_file:"Importing files is not supported currently",not_support_import_file:"You can't import files in this format",local_project:"Local projects",cloud_project:"Cloud projects",my_projects:"My projects",no_login_cloud:"Log in to use the Cloud space",sign_in_now:"Log in",no_network:"Network connection failed. Please check the network settings.",used_file_num:"Free count used",not_enough_space:"Need more Cloud space? ",not_enough_space_link:"Learn more about Cloud space",cloud_project_empty_left:"No content. Go to Local projects",cloud_project_empty:"No file yet. You can upload files.",cloud_project_empty_tap:"and tap",cloud_project_empty_right:"to upload projects.",cloud_project_empty_rightnow:"Upload",local_project_uploading:"File uploading ... Please wait.",local_project_uploading_disable:"The file is uploading ... Please wait.",local_project_empty:"No content yet. Please create ...",project_upload_success:"File upload succeeded",project_upload_fail:"File upload failed",project_upload_cancle:"Upload canceled",project_uploading:"Uploading file …",project_download_success:"File download succeeded",project_download_fail:"File download failed",cloud_project_download:"Download to local projects",cloud_project_downloading:"File downloading...",cloud_project_downloading_other:"File downloading ... Please wait.",cloud_project_downloading_self:"The file is downloading ... Please wait.",cloud_project_space_limit:"The space available in Cloud has reached the upper limit. Please delete the files you don't need and then upload files.",cloud_project_space_limit_tips:"Insufficient Cloud storage",project_delete_failed:"Delete failed",project_rename_failed:"Rename failed",project_opening:"opening...",project_open_failed:"Opening failed. Please try again.",dialog_open_project:"Open",dialog_download_project:"Download to local projects",dialog_rename_project:"Rename",dialog_upload_project:"Upload to Cloud",dialog_share_project:"Share",dialog_delete_project:"Delete",dialog_copy_project:"Copy"},about:{protocol_user:"Terms of Service",protocol_privacy:"Privacy Policy",safe_privacy:"Safety Terms",contact:"Contact us",not_update:"This is the latest version.",need_update:"A new version is found. Tap to update",privacy_policy:"Privacy Policy"},editor:{panel:{main:{snapshot_preview:"Snapshot preview",image:"Image",text:"Text",shape:"Shape",graffiti:"Graffiti",layer:"Layer",canvas:"Canvas",setting:"Setting"},basic:{design:"Design",parameter:"Parameters"},design:{outline:"Outline",copy:"Copy",lock:"Lock",un_lock:"Unlock",delete:"Delete",quick_title:"Quick actions",basic_title:"Edit"},edit_canvas:{done:"Done"}},processing_setting:"Parameter setting",image:"Image",font_setting:"Text setting",display_attrs:"Edit",import_image:"Import image",insert_fonts:"Text",insert_graphics:"Insert shape",insert_graffiti:"Graffiti",insert_code:"Code",qr_code:"QR code",barcode:"Barcode",qr_holder:"Please enter text",barcode_holder:"Please enter figures or characters",insert_shape:"Shape",basic:"Basic",festival:"Festival",plant:"Plant",animal:"Animal",border:"Border",others:"Others",photo:"Camera",open_photo_album:"Photos",my_system_file:"Files",font_spacing:"Spacing",back:"Back",keyboard_confirm:"Done",modify_position:"Position",modify_size:"Size",modify_rotation:"Rotation",modify_outline_offset:"Offset",input_font:"Text box",adjust:"Adjust",camera_location:"Snapshot preview",fail_to_generate_svg_path:"Path generation failed. Please adjust the parameters and try again.",layer_multi_canvas:{delete_canvas:"Deletion cannot be undone. Are you sure you want to delete the canvas?",delete_layer:"Are you sure you want to delete the layer?",delete_canvas_title:"Delete canvas",delete_layer_title:"Delete layer",confirm:"Confirm",cancel:"Cancel",delete:"Delete",rename_layer:"Layer rename",rename_canvas:"Canvas rename"},snap_shot:{Snapshot_preview:"Snapshot preview",hide_background:"Hide background",display_background:"Show background",calibrate:"Calibrate"},loss_fonts:"The typeface used in the project file is not supported. The missing typeface is replaced with the default typeface.",loss_fonts_description:"The typeface used for the text on the canvas is not supported. You can choose to:"},auto_focus:{auto_focus_remain_tip:"The laser module will move down to its origin. Do not place any object thicker than 10 cm on the baseplate, or the device may be damaged. Tap OK to start auto-focus."},graffiti:{name:"Graffiti",cancel_title:"Are you sure you want to cancel graffitiing?",cancel_content:"The drawings will not be saved after cancellation.",continue_editing:"Continue editing",confirm:"Confirm",pen:"Stroke",erase:"Eraser",pen_size:"Stroke size",erase_size:"Eraser size"},rate:{title:"Well done!",rate_content:"Did you enjoy your creation journey?",help_improve:"No. Help improve",rate_it:"Yes. Rate it",help_to_improve_title:"Please describe what you think can be improved.",improve_blank_tips:"Leave your email address here if you would like us to contact you.",submit:"Submit",submit_success:"Submitted",submit_fail:"Submission failed. Please check your network."},guide:{set_process_attr:"Set parameters related to processing here.",add_canvas_elements:"Add objects or switch canvases here.",set_elements_attr:"After selecting an object, edit it and set parameters for it here",set_framing_attr:"Click to perform framing and start processing",to_process_attr:"Click to start the processing process",next:"Next",ok:"OK"}},DVe={mobile:RVe},kVe={title:"Settings",theme:"Theme",light:"Light",dark:"Dark",common:"General",canvas:"Canvas",auto_snapping:"Auto-snapping",about:"About {version}",unit:"Unit",unit_mm:"mm",unit_in:"in",language:"Language",graphic_fill_status:"Graphic fill status",about_software:"About",software_update:"Software update",log_level:"Log level",check_update:"Check for updates",current_version:"Current version: v{version}",current_software_version:"Current software version: v{version}",not_update:"This is the latest version: v{version}",need_update:"New version found: v{version}, it's recommended you update the version. ",software_version:"Current version: v{version}",download_update:"Download",copyright:"Copyright © {previousYear} - {year} XTL US INC. All Rights Reserved.",check_update_fail:"Checking for updates failed. Please check your network.",open:"Open",more_change_log:"For details, see Weekly Updates >",dev_mode:"Developer mode",firmware_update:"Update the firmware anyway",start:"Start",hotkeys:"Hot keys",hotkeys_link_text:"View",hotkeys_link_href:"https://support.xtool.com/hc/en-us/articles/12140908998039",accurate_hit_area:"Precise vector path selection",accurate_hit_area_tips:"Restart XCS for the setting to take effect",display_vector_fill:"Display vector fill",image_fit_canvas:"Imported image too large for the canvas",image_fit_canvas_ask_anytime:"Ask me every time",image_fit_canvas_auto_yes:"Auto-scale it",image_fit_canvas_auto_no:"Keep its size",precise_dxf_file_parsing:"Precise DXF file parsing",auto_update_device_ext:"Auto-update device plug-in",dxf_parse_precision:"DXF auto-close tolerance",operation_prompt:"Function tips",privacy_policy:"Privacy Policy",user_agreement:"Terms of Service",safe_use_specifications:"Safety Terms",graphics_curves_quality:{title:"Vector quality",option_best:"Optimal",option_best_desc:"ideal for patterns larger than 20 inches and allows for an average speed",option_high:"High",option_high_desc:"good for patterns of 10 to 20 inches and allows for a moderately faster speed",option_medium:"Medium",option_medium_desc:"good for patterns smaller than 10 inches and allows for a fast speed",take_effect_tips:"The setting will take effect when you import an image file next time."},file:"File Setting",import:"Import Setting",file_parsing:"File Parsing",others:"Other Setting",uatPwd:"Test key",about_xcs:"About XCS",log_error:"error",log_warn:"warn",log_info:"info",log_debug:"debug"},OVe={setting:kVe},LVe={p2:{precision_measurement_calibration:"Calibrate aimed-measure",first_calibration:"Measure",next_calibration:"Measure again",adjustment_laser_head:"Position the laser module",calibration_z:"Calibrate at z-axis",marking_point:"Process a point",first_calibration_step1_text:'Place a material --on the slats--, move the laser module to the center of the material, and click "Process a point"',first_calibration_step2_text:"Move the laser module to allow the red laser spot to fall perfectly at the point processed in step 1",first_calibration_step2_btn_text:"Done, next",next_calibration_step1_text:'Remove the slats, place a material --on the baseplate--, move the laser module to the center of the material, and click "Process a point"',next_calibration_step2_text:"Move the laser module to allow the red laser spot to fall perfectly at the point processed in step 1",adjustment_step1_text:"Use a screwdriver to adjust the position of the laser module to allow the red laser spot to fall perfectly at the point processed in step 2",calibration_z_step1_text:"Insert the slats upside down and move the laser module to allow the red laser spot to fall on the back side of a slat",calibration_z_step1_btn_text:"Done, start calibration",calibration_z_success:"The calibration is complete."}},NVe={tool:LVe},BVe={...uVe,...pVe,...mVe,...AVe,...wVe,...OVe,..._Ve,...SVe,...DVe,...NVe,...lVe,...dVe,...CVe,...TVe,...MVe},FVe={announcement:"公告",empty:"暂无公告",no_reminder:"7天内不再弹出提醒",network_error:"网络无法连接，请检查网络设置",server_error:"服务器异常，请稍后重试"},UVe={announcement:FVe},GVe={drop_file:"放开这个文件",add:"添加画布",rename:"重命名",panel:"画布",empty:"画布都被你删啦",context_menu:{insert:"插入",delete:"删除",rename:"重命名"},delete_dialog:{title:"删除",content:"确定删除？"},delete_dialog_confirm:{title:"提示",content:"删除操作不可撤销，确定删除该画布吗？"},message:{text_version_not_match:"由于XCS升级了文字功能，旧项目的文字大小可能会变化。",learn_more:"了解更多"}},HVe={canvas:GVe},VVe={upload_from_computer:"从本地上传",empty:"暂无内容",free_count_used:"已用免费文件数",file_title:"文件标题",file_size:"文件大小",created:"创建时间",save_to_computer:"下载到本地",rename:"重命名",delete:"删除",uploading:"正在上传中",upload_succeeded:"文件上传成功",upload_failed:"文件上传失败",downloading:"正在下载中，请稍等...",tips:"提示",open_file_in_cloud:"打开云空间内的文件不会修改文件内容",cancel:"取消",confirm:"确认",delete_file:"删除文件",confirm_delete_file:"是否删除该文件？删除后无法恢复",space_available_limit:"可用云空间已达到上限，请先清理不需要的文件后，再重新上传新的文件",confirm_else:"确定",editor:"编辑器",refresh:"刷新",remaining_free_count:"已用文件数",remaining_free_count_tip:"免费空间不够用？了解更多云空间信息",view:"查看",file_download_completed:"文件下载完成",secure:"安全",secure_desc:"由Azure云服务提供支持，安全、持久且具有高可用性",efficient:"高效",efficient_desc:"可随时访问和存取文件，极大地提升了创作效率",synchronous:"多端协同",synchronous_desc:"只需一个xTool账号，即可在多终端XCS进行文件和数据同步",try_it_now:"立即尝试"},zVe={cloud:VVe},$Ve={app:{name:"xTool Creative Space"},menu:{main_menu:"主菜单",check_for_update:"检查更新...",quit:"退出",close:"关闭",file:"文件",close_project:"关闭项目",rename:"重命名",file_untitled:"未命名",file_import:"打开项目...",file_import_image:"导入图像...",file_new:"新建",file_save:"保存",file_save_as:"另存到本地",file_rename:"重命名",community:"社区",community_home:"首页",community_inspiration:"灵感",community_how_tos:"社区案例",community_tips_tricks:"使用技巧",community_ask_me:"求助社区",community_discussion:"讨论",community_weekly_updates:"每周动态",link_info:"资讯",link_weekly_updates:"每周动态",link_tips:"使用技巧",link_example:"案例",link_help:"帮助",link_mall:"商城",setting:"设置",in_app_project:"一键使用案例",featured:"精选推荐",machines:"机器分类",materials:"材料分类",occasions:"场景分类",discussion:"案例讨论",export_svg:"导出SVG...",points_history:"积分记录",user_setting:"帐号设置",login:"登录",logout:"退出登录",cloud_projects:"云空间项目",my_space:"我的空间",go_mall:"前往商城",xtool_projects:"案例中心",edit:"编辑",help:"帮助",user_center:"用户中心",account:"账号设置",points:"积分记录",safety:"安全培训"},msg:{layer_rename:"层重命名",update_app_required:"当前软件版本不支持打开此项目文件，因为它是由更高版本的软件创建的。请升级软件后重新打开文件。",ok:"确定",cancel:"取消",saving:"保存中……",material_loading:"素材加载中……",project_loading:"项目加载中……",save_success:"保存成功",import_font_success:"该字体已完成导入，重启后即可生效",driver_notification_title:"驱动安装：{name}",driver_notification_content:`检测到你的电脑缺少支持设备运行的驱动，请点击下面的按钮尝试解决。
安装完成后请重新拔插USB连接线`,driver_notification_button_text:"立即安装",driver_download_fail:"下载失败，网络连接异常",driver_download_fail_link_href:"https://s.xtool.com/doc/device/device-connection"},punctuation:{colon:"：",percent:"%"},project:{project_crash:"抱歉，该项目已无响应。您可以：",project_restore:"恢复项目"},dialog:{tips:"提示",ok:"好的",confirm_title:"确认",rename:"重命名",create_prompt:"创建提示",processing_do_not_close:"当前项目正在加工中，请加工完成后再关闭.",create_prompt_content:"最多打开6个项目，请关闭部分项目后打开新项目",no_more_reminders:"不再提示"},forward:"前进",backward:"后退",refresh:"刷新",reload:"重新加载",close:"关闭",copy_link:"复制链接",copy_success:"复制成功",copy_failed:"复制失败",network_error:"网络连接错误",network_error_retry:"网络异常，请稍后重试",open_in_browser_failed:"在浏览器中打开失败",open_in_browser:"在浏览器中打开","input-multi-state":"多个值"},WVe={common:$Ve},jVe={button:{yes:"是",no:"否",ok:"完成",done:"完成编辑",confirm:"确定",cancel:"取消",save:"保存",choose:"选择文件",update_firmware:"更新固件",refresh:"刷新",select_device:"连接设备",connect:"连接",yes_fit_size:"是，缩小至适应画布尺寸",no_fit_size:"否，按原尺寸展示",iknow:"我知道了",get_help:"查看帮助",cache_yes:"恢复",cache_no:"丢弃"},link:{device_not_found:"找不到目标设备？"},input:{placeholder_file:"文件名"},table:{},form:{},checkbox:{remember_choose:"记住我的选择，不再提示"},modal:{confirm_title:"确认",confirm_save:"是否保存项目？",fit_size:"导入图纸的尺寸过大，超出了画布区域，是否缩放？",loss_fonts_title:"缺失字体",loss_fonts:"文件使用了当前系统不支持的字体格式，已替换为默认字体。",loss_fonts_description:"文件使用了当前系统不支持的字体格式，请选择处理方式：",loss_fonts_option_replace_font:"替换为默认字体",loss_fonts_option_to_paths:"转为矢量路径",project_cache_content:"检测到有意外中断未保存的文件，是否恢复"},message:{loading_cache_fail:"缓存文件读取异常，恢复失败"}},QVe={component:jVe},XVe={common:{material:"材料",thickness:"厚度",focal_length:"焦距",distance:"距离",perimeter:"周长",diameter:"直径",roller:"滚轴",catch:"抓盘",rotary_attachment_type_tip:"抓盘模式下，更改材料直径将导致最大加工速度变化",rotary_attachment_type:"配件",capture_alignment:"拍照定位",slat:"刀条",power:"功率",brush_pressure:"笔压",speed:"速度",mode:"模式",pass:"加工次数",curve:"曲面",view:"查看",bitmap_scan_mode:"扫描模式",z_mode:"双向扫描",one_way:"单向扫描",blue_red_light:"蓝红光混合加工",gear_mode:"档位",offset_z:"Z轴偏移",lines_per_cm:"雕刻密度",bitmap_mode:"图像模式",cut_pressure:"刀压",break_point_cut:"断点打印",break_point_mode:"生成规则",break_point_by_count:"按数量",break_point_by_distance:"按距离",break_point_distance:"断点间距离",break_point_size:"断点尺寸",break_point_count:"断点数量",break_point_power:"断点切割功率",auto_measure:"自动测量",Automatic_measurement:"自动测量中",quick_measure:"快速测量",precise_measure:"精准测量",curve_measure:"曲面测量",preview:"预览",rise:"上升",decline:"下降",height_raising:"垫高",none:"无",triangular_prism:"三棱条",ok:"确定",cancel:"取消",user_defined_material:"自定义材料",refresh:"刷新",back:"返回",connect:"连接",password:"密码",wifi_name:"Wi-Fi名称",previous_step:"上一步",next_step:"下一步",complete:"完成",grayscale:"灰度",bayer:"拜耳",floyd:"Floyd",stucki:"Stucki",atkinson:"Atkinson",jarvis:"Jarvis",sierra:"Sierra",export:"导出",photograph:"拍照",confirm:"确定",reset:"还原",reset_success:"还原成功",reset_fail:"还原失败",serial:"串口",serial_port:"串口号",baud:"波特率",crd_card:"板卡类型",update:"更新",reset_tips:"确认进行还原",yes:"是",no:"否",get_help:"获取帮助",light_source_mode:"光源模式",laser_light_mode:"激光光源",red_light:"红光",blue_light:"蓝光",platform_speed:"刀条板速度",on:"开启",off:"关闭",dot_duration:"打点时间",calculate_gcode_tip:"正在生成预览画面…",dpi:"DPI",power_range:"功率范围",never_remain:"不再提醒",countdown:"倒计时: ",process_path:"加工路径",process_path_by_auto:"自动规划",process_path_by_auto_desc:"先雕后切，效率优先",process_path_by_layer:"按层顺序",process_path_by_layer_desc:"按层顺序从上向下加工",learn_more:"了解更多",ext_updated_tip:"有新的 {deviceName} 插件版本可用，重启软件后生效",check_change_log:"说明",ext_drop_success_tip:"新的 {deviceName} 插件版本已经准备好",not_configured:"未配置",estimate_time:"预估总时长",laser_module_trajectory:"移动路径",planning_mode:"规划模式",user_defining:"自定义",auto_planning:"自动规划",one_by_one:"逐个扫描",all_together:"同时扫描",smart_scan:"智能扫描",path_only_move:"激光头仅移动不加工的路径",path_process:"激光头实际加工的路径",position_for_laser_module:"激光头所在位置",got_it:"我知道了",laser_module_position:"激光头位置",processing_path:"加工路径设置",fill_path:"填充路径",new_lang_tip:"发现新的语言包版本，重启软件后生效",z_axis_move:"Z 轴下降距离",frequency:"频率",step:"步骤"},mode:{laser_flat:"平面加工",bottom_laser_flat:"底板平面加工",slats_flat:"刀条平面加工",laser_curved_surface:"激光曲面",laser_cylindrical:"旋转附件加工",laser_cylindrical_curved_surface:"激光圆柱曲面",super_laser_plane:"扩幅配件加工",laser_conveyor_feeder:"送料配件加工",open_plane:"拆底板加工",pass_through:"直通门",curve_process:"曲面材料加工",blade_cutting:"刀切",print_blade_cutting:"打印刀切",laser_extender:"扩幅配件加工",floor_plane:"底板平面加工",laser_floor_plane:"激光底板平面加工",passive_knife:"细切刀模式",active_knife:"裁切刀模式",active_press:"压痕转印",active_disc:"圆盘压切",passive_brush:"画笔绘制",ink_print:"喷墨打印",screen_print:"丝网制版",user_defined:"组合加工",function_is_not_supported:"当前模式不支持此功能",conveyor_belt:"批量加工",conveyor_extension:"大幅面加工"},processing_type:{line_cut:"线条切割",line_engrave:"线条雕刻",fill_engrave:"填充雕刻",cut:"切割",engrave:"雕刻",brush_line:"线条绘制",brush_block:"色块绘制",ink_print:"喷墨打印",passive_cut:"细切",active_cut:"裁切",disc_press:"圆盘压切",transfer:"压印",relief:"浮雕",line_transfer:"线条压印",fill_transfer:"填充压印"},processing_attrs:{select_diff_elements:"您选中了不同类型的素材，不支持批量修改参数",x_tool_parameter_reference:"推荐参数",x_tool_parameter_reference_not_supported:"不支持推荐参数",user_defined_parameters:"自定义参数",parameter_tips:"耗材的使用环境和材料差异等客观因素都可能影响推荐参数的加工效果",know_more:"了解更多",out_put:"执行加工",processing_path_tips:"1. 自动规划：<br/>XCS智能算法将以效率优先为原则，为您自动规划加工路径。<br/>2. 自定义：<br/>您可以自行设置部分加工路径规则。",processing_path_know_more:"了解具体设置项 >"},offline_work:{offline_key:"所画即所得",black_carving:"对黑色图案激光雕刻",black_cutting:"对黑色轮廓激光切割",red_cutting:"对红色轮廓激光切割"},safety:{click_to_learning:"点击前往【安全培训】",safety_training_tip:"当前连接设备为四类激光机器。根据法律法规的要求，您需要参加并完成激光安全培训以保护您的个人安全。",safety_always_tip:"检测到您还未完成激光安全培训，操作激光加工可能存在安全风险，",safety_always_tip_link:"请前往参加激光安全培训",login_learning_complete:"登录成功，您当前帐户已完成激光安全培训课程！"},status:{loading:"加载中...",empty:"暂无内容",device_not_connected:"设备未连接",please_connect_device:"请先连接设备",connected:"已连接",not_connected:"未连接",taking_picture:"正在刷新，已完成{percent}%",take_picture_success:"刷新成功",take_picture_fail:"刷新失败",take_picture_fail_link_href:"https://support.xtool.com/hc/en-us/articles/4719484188439-FAQ-on-xTool-M1#%233%20Failed%20to%20capture%20or%20refresh%20the%20image.%20Why%3F",manual_picture:"手动刷新拍照界面",immediately_refresh:"立即刷新"},setting:{change:"设备切换",disconnect:"断开连接",setting:"设备设置",basic:"基础信息",import:"导入",import_gcode:"导入Gcode",export_gcode:"当前画布内容导出为GCode",send:"发送",please_upload_gcode_file:"点击选择文件",upload_success_tips:"发送完成，点击设备按钮开始加工",upload_gcode_tips:"请先删除下面文件再选择新文件",work_info:"工作信息",work_param:"工作参数",model:"激光型号",unrecognized_head_model:"未识别到加工头",model_head:"加工头型号",unrecognized_laser_model:"未识别激光头",process_head_model:"加工头型号",unrecognized_process_head_model:"未识别加工头",unrecognized_laser_faq:"无法识别?",name:"设备名称",name_is_empty:"请输入设备名称",name_is_too_long:"设备名称太长了",serial_num:"序列号码",firmware_version:"固件版本",check_firmware:"检查更新",copy:"复制",device:"设备",edit:"编辑","work-information":"工作信息","machine-parameter":"设备参数","device-handbook":"设备手册",position_mode:"定位方式",red_cross:"红十字定位",laser_spot:"弱光定位",red_dot:"红点定位",red_cross_offset:"红十字偏移量",flame_alarm:"火焰报警",stop_move:"移动即停",limit:"限位开关",standby_time:"待机时长",working_time:"工作时长",operating_times:"工作次数",work_log:"工作日志",hour:"小时",time:"次",working_parameters:"工作参数",fill_light_brightness:"补光灯亮度",time_continues_work:"排烟风扇持续工作时间",smoking_fan_laser:"排烟风扇（激光）",smoking_fan_block:"排烟风扇堵转检测",exhaust_time:"加工后排烟时间",camera_calibration:"摄像头校准",calibrate:"校准",ranging:"测距模块",import_tips:"如何通过Lightburn导出正确的GCode？",backlash:"反向间隙",test:"测试",wifi_connected:"已连接",wifi_not_connected:"未连接",export_success:"导出成功",export_fail:"导出失败",high_sensitivity:"高灵敏",low_sensitivity:"低灵敏",not_show_sensitivity_again:"不提示",backlash_title:"反向间隙测试",open_lid_tips:"请注意，开盖会自动取消任务",backlash_step_0:"请将一块3mm椴木板放置于工作区域中央",backlash_step_1:"请按下设备上的按钮以开始测试",backlash_step_2:"加工中，这可能会花上一些时间",backlash_step_3:"请稍安勿躁，不要关闭设备",backlash_success:"恭喜! 加工成功",backlash_fail:"加工失败",cut_press_step_0:"放置一张A4空白纸至垫板中央，并将垫板放置到设备中",cut_press_step_1:"请点击机器上的按钮开始加工",cut_press_step_2:"加工中...",cut_press_step_3:"请选择校准材料中最浅刀痕对应的位置",cut_press_title:"刀压基值校准",cut_press_ok:"校准成功",cut_press_fail:"校准失败",cut_press_img:"位置对照图",camera_step_0:"请将两张A4或一张A3空白纸粘贴在底板中央，请确保纸张平整",camera_step_1:"按下设备上的按钮开始加工，请谨慎加工易燃材料，请勿在无人值守的情况下进行加工",camera_step_2:"校准中...",camera_step_3:"请确认校准线是否与校准点重合",camera_success:"摄像头校准已完成",camera_fail:"摄像头校准失败",camera_step_start:"开始校准",camera_tips:"摄像头校准可以使得机器的对位精度重新恢复接近出厂时的水平（2mm左右误差)",handheld:"移动即停",auto_vertical_origin:"开机自动校准竖直原点",open_gap_stop_work:"开盖即停",infrared_light_preheat:"红外光预热",infrared_light_preheat_info:"低温环境下使用红外光雕刻，开启预热可以获得更好的雕刻效果。",infrared_light_preheat_info_link:"什么时候需要预热？",delay_time_setting:"打标延迟设置",open_light_delay_time:"激光开启延时",corner_delay_time:"转角延时",close_light_delay_time:"关光时激光延时",close_light_local_delay_time:"关光时位置延时",jump_local_delay_time:"跳转位置延时",jump_length_delay_time:"跳转距离延时",close_laser_speed:"关光后跳转速度",dot_location_finish:"打点结束后稳定时间",purifier_timeout:"净化器持续工作时间",purifier_check:"净化器检查",output_power:"最低出光功率调整",setting_error_in_processing:"设备加工中，请稍后再试",open_gap_stop_tips:"加工中时开盖会立即暂停加工，如需开盖使用，需要先关闭此开关",light_path_title:"光路调试",light_tips:"什么情况下需要进行光路调整",light_path_tips_1:"请根据指引进行光路调试",light_path_tips_2:"如何进行光路调试",light_path_check:"光路验证",light_path_warn:"请关盖后再触发点射，出光完成解锁前请勿开盖",pulse_tips:"请关盖后再触发点射",pulse:"点射",laser_head_tips:"移动激光头以更方便进行反射镜的调整，请勿手动移动激光头",move_distance:"移动距离",move_laser_head:"移动激光头",click_view:"点击查看",light_path_helper_link:"https://support.xtool.com/hc/en-us/articles/12823378816151",check_drawer:"抽屉检测",air_pump_title:"气泵大小",req_timeout:"请求超时，请重试",beeper_enable:"工作提示音",beeper_enable_tip:"开关开启后，设备工作时，如加工就绪、加工结束等状态会发出提示音“哔”。",flame_alarm_confirm:"选择此选项后将不再进行火焰报警提示，请谨慎选择，起火可能会危害人身财产安全，加工时请持续关注加工情况。确定选择此项吗？",ext_version:"插件版本",has_new_ext_version:"有新版本",update_new_ext_version:"更新",use_new_ext_version_after_reopen:"重启后新版本生效",upload_ext_fail:"无法识别当前文件，插件安装失败",part_info:"配件信息",airAssist_v2:"智能气泵2.0",airAssist_v2_tips:"切割时，大气流可以保证更好的加工效果。对于亚克力等材料，大气流可能会影响切割的能力，您可以根据需要调节气流；",airAssist_v2_firmware:"智能气泵2.0固件版本",cutting_airflow:"切割气流(%)"},connect:{firmware:"固件更新",usb:"USB",wifi:"WIFI",eth:"网口",wifi_config:"WIFI 配置",wifi_config_failed:"WIFI 配置失败！",wifi_config_button_label:"配置",hotspot_password:"Hotspot密码",hotspot_password_button_modify:"修改",ip:"IP",hotspot:"Hotspot",ip_connection:"IP直连",wifi_configuration:"Wi-Fi连接配置",usb_connection:"USB连接",wifi_setting:"WI-FI配置",searching:"查找中...",connect_break:"设备连接已断开",can_not_find_device:"找不到目标设备？",no_device_find:"暂未发现可连接的{device}设备",password_input_error_massage:"请输入密码，为保证设备安全，不支持连接无密码的路由器",wifi_input_error_massage:"请选择设备要加入的网络",usb_connect_step_0:"请开启设备电源",usb_connect_step_1:"将设备通过USB线与电脑连接",usb_connect_step_2:"在下方选择设备，然后点击“下一步”按钮",usb_input_placeholder:"请选择要连接的设备",connect_wifi_success_tips_0:"设备已完成WI-FI配置",connect_wifi_success_tips_1:"断开USB线，尝试一下WI-FI连接吧！",ip_input_error_massage:"请输入正确格式的IP地址",enter_ip_address:"请输入设备的IP地址",wifi_connect_error_tips_0:"请确保设备已开启",wifi_connect_error_tips_1:"设备需要和电脑处于同一WI-FI网络中",wifi_connect_error_tips_2:"完成1、2步骤后，点击【刷新】按钮刷新列表",wifi_connect_error_tips_3:"若仍无法连接，点击【WI-FI配置】按钮进行设备配置",choose_network:"请选择设备要加入的网络",device_list:"设备列表",switch_device:"设备切换",switch_device_content:"设备切换会重置当前图案的加工参数，确定切换？",switch_device_content_new:"切换的设备与项目文件的设备机型不匹配，切换设备后项目文件加工模式、材料、参数可能会发生调整。确定切换吗？",switch_device_content_power:"该项目文件参数与加工设备加工头不匹配，为了保证可以正常加工需要切换相关参数，是否切换？",no_eth_device:"暂未发现可连接的网口设备",no_usb_device:"暂未发现可连接的USB设备",no_wifi_device:"暂未发现可连接的WiFi设备",connect_failed:"连接失败",device_refresh:"设备列表刷新中..."},firmware:{update:"固件升级",need_update:"当前固件版本过低，建议升级固件",current_version:"当前版本",latest_version:"最新版本",update_now:"立即升级",not_now:"暂不升级",later_remind:"三日内不再提醒",tips:`正在安装新版本固件，这可能会花费一些时间。
请耐心等待，不要关闭设备。`,succeeded:"恭喜，固件升级成功",failed:"抱歉，固件升级失败",app_version_low:"当前固件版本与软件版本过低，请升级软件后，再进行固件更新",latest_firmware:"当前固件版本已是最新版",retry:"重试",close:"关闭",cancel:"取消",done:"确定",next:"下一步",version:"当前固件版本：",download_fail:"固件下载失败",downloading:"正在下载固件，当前 {percent}%",uploading:"正在上传固件，当前进度 {percent}%",updating:"正在升级新版本固件...",updating_tip1:"正在更新固件，当前 {percent}%",updating_tip2:"设备升级过程中断连属正常情况，请耐心等待，不要关闭设备",need_update_firmware:"发现新的固件版本 {latestVersion}，建议升级",force_update_firmware_1:"发现新的固件版本 {latestVersion}。",force_update_firmware_2:"该固件版本需要强制升级，升级/修复了一些重要功能。为了保证设备正常使用，请进行升级。",force_update_tips:"存在需要强制升级的固件版本，为了确保您的设备正常使用，请前往设备设置进行固件升级，再对设备进行加工。",helper:"获取帮助",empty_ext:"请连接设备后再进行固件升级",find_new_version:"发现新固件版本",busy_tips:"设备正在工作中，请稍后再进行固件升级",upload_on_tip:"升级前请确认升级开关在“ON”状态，否则可能会导致升级失败",upload_off_tip:"请将升级开关拨到“OFF”状态，否则可能会影响加工",tips_confirm:"我已确认",update_tool_title:"固件更新工具",update_tool_tips:"点击或者拖动固件到该区域",new_firmware:"最新固件",local_firmware:"本地固件",update_later:"暂不升级",update_must_tips:"该固件版本修复了一些重要功能，需要强制升级。为了保证设备正常使用，请进行升级。",download:"固件下载",update_success:"升级成功"},process:{hour:"时",minutes:"分",second:"秒",actual_processing_time:"本次加工耗时: {time}",save_tip:"请勿在无人值守的情况下进行加工",move_laser_module:"移动激光头",distance:"移动距离",speed:"移动速度",ok:"确认",laser_spot:"弱光定位",low_light:"弱光",enable:"开启弱光",disable:"关闭弱光",origin:"加工原点",minimize:"最小化",click_start_point:"可以点击设置激光头与加工图案的相对位置",preview_start_point:"预览激光头与图案的相对位置",start_processing:"开始",send_gcode:"开始",cancel_processing:"取消",pause:"暂停",ready:"就绪",paused:"加工暂停",complete:"加工完成",estimated_time:"预计加工耗时：",task_canceled:"加工取消",left_process_time:"剩余加工耗时：",time_used:"当前加工耗时：",framing:"走边框",stop_framing:"停止走边框",framing_power:"出光功率",framing_power_tip:"请注意，功率过大可能会灼烧材料！",framing_settings:"走边框设置",setting:"设置",framing_speed:"速度",framing_mode:"模式",framing_rect:"矩形",framing_outline:"外轮廓",sending_the_file:"加工文件发送中 ",send_success:"加工文件已发送",task_done:"任务已完成",task_completed:"任务完成",confirm_cancel_task:"确定取消加工任务",file_done_and_start:"请点击机器上的按钮开始加工，为了避免火灾风险，请谨慎加工易燃材料。",fire_warning_tips:"请勿在无人值守的情况下进行加工",again_processing_tips:"请点击机器上的按钮开始加工，为了避免火灾风险，请谨慎加工易燃材料。",processing:"加工",continue:"继续",preview_processing:"预览加工",processing_status_2_step:`按下设备上的按钮来开始工作
为了避免火灾风险，请谨慎加工易燃材料，请勿在无人值守的情况下进行加工`,walk_border:"走边框状态已就绪，按下设备按钮开始走边框，再次点击按钮可重复执行",tf_tips:"请确认你的TF卡已插入",task_canceled_title:"任务已取消",task_canceled_text:"当前加工任务已取消",less_than_one_minute:"小于1分钟",more_than_999_hours:"大于999小时",minute:"分钟",is_processing:"正在加工",btn_is_processing:"加工中...",no_elements:"画布中没有可加工的内容",no_tf_card:"设备中没有检测到 TF 卡，请插入 TF 卡后重启机器后再试",no_key_lock:"检测到设备钥匙控制器未插上，请正确插上钥匙控制器。",catch_data_empty:"抓盘模式下需要添加周长或直径",device_is_offline:"设备处于离线状态，请连接设备",thickness_is_empty:"材料厚度为空会造成加工效果异常",focal_length_is_empty:"距离为空会造成加工效果异常",drawer_is_open:"抽屉未关好，请先关好抽屉",drawer_is_close:"请先取出抽屉，并重新测距",disconnect:"设备断开了连接",disconnect_tip:"请持续关注设备的加工情况,如需控制设备，请在机器上进行",unit_mm:"mm",unit_mm_s:"mm/s",no_vector_elements:"没有可加工的矢量元素",element_out_zoom:"元素摆放位置超出加工区域",walk_border_out_zoom:"元素摆放位置超出走边框范围，请调整",file_is_too_large:"生成的加工文件过大，请降低雕刻密度或减少加工次数",file_is_too_large_link_href:"https://s.xtool.com/doc/editor/gcode-large",device_is_working:"设备处于工作状态，请稍后再试",request_status_fail:"请求错误，无法查询设备工作状态",gcode_upload_fail:"上传文件失败，请稍后再试",gcode_upload_success:"上传文件成功",print_fail:"打印失败",gcode_is_too_large:"生成的Gcode大于512M，无法预览",gcode_is_too_large_link_href:"https://s.xtool.com/doc/editor/gcode-fail",print_graph:"打印图案",put_material:"放置材料",process_preview:"加工预览",print_cut_step_1:"通过打印机将你的图案打印到材料上",print_cut_step_2:"将打印好的材料放置到设备中",print_cut_step_3:"执行刀切加工，预计加工耗时{time}",put_material_step_1:"请将打印好的材料对齐网格线后贴到垫板上",put_material_step_2:"将垫板对齐到设备边框后贴在设备底板上",number_1:"1.",number_2:"2.",prev_step:"上一步",next_step:"下一步",print:"打印",bitmap_missing:"请添加需要打印的图案",vector_missing:"请添加打印的图案的刀切路径",material_identification_failed:"材料识别失败，请将材料放置在中间或重新打印",new_material_identification_failed:"材料识别失败，请将材料放置在加工区域中心，并开关盖手动刷新一次拍照",material_identification_success:"材料识别成功",cut_print_max_size_tip:"加工幅面最大支持 182mm * 269mm",over_temperature_tip:"如果加工过程中指示灯亮起黄色则表明触发了过温保护，此时应停止加工，等待激光器冷却，指示灯灭，然后再开始加工。",air_assist_set_tip_for_40w:"如果使用40W进行切割，为了确保更好的加工效果，请在开始加工前打开气泵",cylinder_red_cross_warning_tip:"检测到您使用旋转附件模式加工，请将红十字定位切换成弱光定位",prepare_preview:"正在生成预览画面…",resize_preview:"恢复默认大小",gap_check_close_tips:"请先合上盖子，或关闭【开盖即停】开关",go_to_close:"关闭",extend_walk_border_tip:"走边框状态中：请旋转加工旋钮，控制刀条板移动，松手即可暂停。期间观察激光投影在材料上的位置，并及时调整对位。",extend_walk_border_tip_modal_head:"走边框操作指引",ir_heating:"红外光正在预热",process_after_heat:"预热倒计时完成后会自动开始加工",heating_save_tip:"预热过程中请不要打开盖子和调整材料，避免受伤",edge_collision_prompt_title:"加工速度可能过快",edge_collision_prompt:"当前加工速度可能会导致边缘效果加工不佳,建议您降低速度或将元素画布居中放置",edge_collision_prompt_confirm:"仍要加工",break_point_build_fail_tip:"部分断点生成失败，将不会被执行加工",in_initialization_status:"设备正在初始化，请稍后再试",in_set_wifi_status:"配网中，请稍后再试",in_frame_ready_status:"走边框状态就绪状态",in_frame_working_status:"走边框状态",in_processing_ready_status:"加工ready状态",in_processing_status:"加工状态",in_pause_processing_status:"加工暂停状态",in_updating_firmware_status:"更新固件状态",in_sleeping_status:"睡眠状态",in_cancel_processing_status:"取消加工状态",in_finish_processing_status:"完成加工状态",in_processing_limit_status:"加工限位状态",interrupted_tip:"若当前设备仍在加工但显示设备断连时，重连设备可以恢复加工控制！30分钟不处理将移入历史任务但不影响设备的正常加工。",interrupted_at:"中断于",done_in:"完成于",history_tab_tip:"只能保留20个最近的历史任务。当超过时，最旧的历史任务将被自动清除。",history:"历史任务",take_time:"加工耗时",process_path:"加工路径",processing_task_tip:"正在加工任务可以到任务列表查看",cancel_task:"取消任务",continue_task:"继续任务",restart:"重新连接",remove:"移除",view_files:"打开文件",how_to_resolve:"如何解决",calculating:"计算中...",before_process_default_data_tips_title:"提示",before_process_default_data_tips_content:"检测到有元素的出光功率参数为{power}，前往加工会影响效果，请调整参数。",before_process_default_data_tips_cancel:"忽略",before_process_default_data_tips_confirm:"调整"},color:{black:"黑色",red:"红色",orange:"橙色",yellow:"黄色",green:"绿色",cyan:"青色",blue:"蓝色",purple:"紫色",white:"白色",grey:"灰色",water_blue:"水蓝",lake_blue:"湖蓝",dark_blue:"深蓝",light_blue:"淡蓝",azure:"天蓝",daisy:"黛色",light_green:"淡绿",dark_green:"深绿",light_grass_green:"淡草绿",grass_green:"草绿",olive_green:"橄榄绿",light_yellow:"淡黄",dark_yellow:"深黄",light_orange:"淡橙",brown:"棕色",light_red:"淡红",dark_red:"深红",light_pink:"淡粉",pink:"粉色",pink_purple:"粉紫",light_purple:"淡紫",dark_purple:"深紫"},d1:{cylinder_connected_placed_tip:"请确认已经连接并正确摆放旋转附件"},d1pro:{process_start_point:"加工起始点",device_absolute_position:"绝对坐标",device_relative_position:"相对坐标",back_origin:"设备回原点中",walk_border_forward_back_origin:"请回原点结束后再点击走边框按钮，再次点击设备按钮可重复执行",cylinder_connected_placed_tip:"请确认已经连接并正确摆放旋转附件",screen_print_tip:"使用丝网制版模式需要完成原点校准，如果已完成校准可忽略",reset_measurement_tips:"如果重新装卸不同的网框或更换激光头，需要重新进行校准。",how_use_origin_calibration:"请通过方向键控制激光头出光点到网框右上角，直至完全重合",screen_print_origin:"丝网加工原点",back_origin_unable_cancel:"设备回原点中无法取消"},f1:{cylinder_connected_placed_tip:"请确认已经连接并正确摆放旋转附件",walk_border_follow_stop:"加工模式已切换，停止走边框"},p2:{drain:"排气中",drain_info:"正在排除废气，请勿开盖",cylinder_alive_tip:"确保机器投射的红点落在圆柱体最高点上",remove_slat_tip:"请确认刀条已经拆除",curve_alive_tip:"此模式不需要通过拍照定位",exhaust:"加工后继续排烟",exhaust_time:"加工后排烟时间",low_power:"最低出光功率",accessory_settings:"配件设置",finish_reset:"加工结束后回到起始位置",hand_measure_with_hand_step_1:"1.请使用尺子测量激光头底部到物体表面的距离",hand_measure_with_hand_step_2:"2.得出的数值减去{unit}，得出最终的焦距",hand_measure_with_hand_title:"手动测量",hand_measure_with_hand_tips:"1.请使用尺子测量激光头底部到物体表面的距离<br/>2.得出的数值减去3mm (0.118in)，得出最终的焦距",error_sub_type:"文件包含不支持的加工模式，暂不支持打开此类文件",flame_sensitivity:"火焰报警灵敏度",flame_sensitivity_low:"低灵敏",flame_sensitivity_mid:"中灵敏",flame_sensitivity_hight:"高灵敏",smoking_fan:"排烟风扇",exposure_increase:"背景亮度增强",exposure_increase_tip:"帮助您在背景中更清楚的看到机器中间的黑色材料，开启后请手动刷新背景照片",sub_type_lable:"激光安全等级",sub_type_one:"一类",sub_type_four:"四类",sub_type_undefined:"未知",clean_baseplate:"若底板有掉落的加工碎片，请及时清理",fireproof_title:"提示",fireproof_tips_1:"检测到本次加工存在高功率低速度的参数设置：",fireproof_tips_2:"请确认底板干净，没有木屑或其他可燃碎屑",fireproof_tips_3:"请务必时刻关注机器内部加工情况",fireproof_tips:`检测到本次加工存在高功率低速度的参数设置：
 1. 请确认底板干净，没有木屑或其他可燃碎屑
 2.请务必时刻关注机器内部加工情况`,ok_process:"已确认，加工",close_gap_process:"盖子未关闭，请关闭盖子后，再进行加工",buzzer:"蜂鸣器"},m1:{cylinder_alive_tip:"确保机器投射的红点落在圆柱体最高点上"},m1lite:{drain:"排气中",drain_info:"正在排除废气，请勿开盖",identify_head_title:"请按照提示安装对应加工工具",identify_head_tips:"可不添加工具",identify_head_help:"如何安装",identify_laser_head:"激光头",identify_print_head:"喷墨头",identify_knife_head:"裁切头",head_installed:"已安装",walk_border_speed:"走边框速度",xy_speed:"XY移动速度",xy_distance:"XY移动距离",laser_head_position:"红十字位置",mark:"标定",active_laser_head:"激光头",active_printer_head:"喷墨头",active_knife_head:"裁切刀",active_press_head:"压印头",active_disc_knife:"圆盘头",passive_brush_head:"画笔",passive_knife_head:"细切刀",base_board:"底板",heighten:"拓展底座",base_board_heighten:"底板/拓展底座",mark_processing_area_info:"请挪动托架，通过多点标记预设加工范围，每确定一个位置，点击设备按键完成该点标记。（注：会根据标定顺序进行区域确定，完成标定后会自动在画布生成封闭加工区域）",clear_mark_data:"将会清空画布生成的加工区域，请确定是否删除？",point_again:"重新标定",button_confirm:"确定",button_cancel:"取消",foundation_bracket:"基础托架",multi_function_bracket:"多功能托架",current_task_take_time:"当前任务预计耗时",all_task_take_time:"所有任务预计耗时",task:"任务",measuring_work:"当前正在进行激光头测距，请勿进行设备移动操作",measuring_work_err:"当前激光头测距失败，请重新尝试测距或者手动输入距离值",processing_info:"加工信息",processing_check:"加工检测",processing_baseboard:"加工底板",attention:"注意事项",current_module_attention:"当前加工头为{headModel}，请注意以下事项",material_tips:"材料提醒：亚克力易燃，请注意加工",params_tips:"参数提醒：当前参数为默认参数，请注意调节",rotate_attachment:"旋转附件：请注意旋转附件{rotate}已安装成功",ink_many_tip:"墨量提醒：请注意观察墨盒余量，如余量不足请及时补足",brush_many_tip:"墨量提醒：请注意观察画笔余量，如余量不足请及时更换",board_tip:"粘板提醒：为防止刀头损坏，确保粘板已粘贴放置完毕",process_effect_tip:"加工效果提醒：如若想要凸起效果，请先覆盖箔纸",not_valid_head:"当前{head}安装不符合，请更换",driving_unlock:"加工头锁扣未扣好，请重试",no_foundation_bracket:"当前{bracket}未识别到{header}，请重新安装",no_head_driving_unlock:"当前xxx的加工头锁扣未扣好，请重试",please_reset_home:"请先完成复位",measure_timeout:"测量超时，请重试",head_is_not_correct:"请先安装对应加工头",out_of_max_range:"超出最大可测量距离，请将材料离加工头近一点",out_of_min_range:"超出最小可测量距离，请将材料离加工头远一点",break_operation:"操作被中断，请关盖后重试",no_people:"请不要无人值守加工",work_finish:"已完成加工",current_task_finish:"当前加工任务已完成",please_click_next:"请点击“下一步”，继续加工下一个任务",total_working_time:"总计加工耗时：",current_laser_measure_err:"当前测距失败，请重新尝试测距或者手动输入距离值",no_move_device:"当前正在进行{head}测距，请勿进行设备移动操作",accessory_settings:"配件信息",purifier_working:"净化器持续工作时间",lower_focus:"焦点下沉",open_lower_focus:"在切割厚物体时,可以开启焦点下沉获得更好的切割效果",learn_more:"了解更多",by:"下沉距离",heighten_remove:"请注意当前拓展底座已被移除",heighten_remove_install:"当前拓展底座已被移除，请切换模式或重新安装",heighten_install_success_distance:"拓展底座安装成功，可加工范围已增加",heighten_install_success:"拓展底座已安装成功",usb_install:"检测到usb钥匙控制器已插上",usb_remove:"检测到usb钥匙控制器已拔出",smoking_no_install:"排烟风扇未安装，请安装好重试",x_axis:"X轴密度",y_axis:"Y轴密度",ink_get_block:"喷墨头由于环境等因素容易堵塞，请在加工前进行测试确保最好加工效果",ink_module_test:"喷墨头测试",see_help:"查看帮助",done:"完成",pass_number:"pass数",xtool_pen:"官方画笔",user_defined_pen:"自定义画笔",pen_manger:"画笔管理",manger:"管理",user_pen_open_tip:"首先请确保您的自定义画笔能适配官方笔套，如若自定义画笔选择开启后将允许开盖加工，为保证安全，使用自定义画笔时需要拆除刀架，同时请注意勿要将手放至加工区域内。",pen_press:"笔压",intensity:"浓度",brightness:"亮度",contrast:"对比度",laser_type:"类型",xtool_brush:"针管笔",work_voice:"工作提示音",tips:"提示",stroke:"描边",stroke_tip:"描边关闭后，元素轮廓将不会被勾勒",pressure:"压力",material_right_header:"该类材料更适合用{header}进行切割",change_knife_tip:"请注意切换材料后加工头也会随之切换",custom_brush_not_enable:"自定义画笔权限未开启",choose_you_brush:"当前加工文件包含自定义画笔，请选择处理方式：/n（注：首先请确保您的自定义画笔适配官方笔套，自定义画笔选择开启后将允许开盖加工，为保证安全，使用自定义画笔时请拆除刀架，同时注意不要将手放至加工区域。）",open_brush_permission:"开启自定义画笔权限",replace_other_brush:"替换为相近颜色的官方画笔",no_custom_brush:"缺少自定义画笔",no_custom_brushes:"缺少当前加工文件中包含的下列自定义画笔，将帮您替换成相近颜色的官方画笔",no_xtool_brush:"缺少官方画笔",no_xtool_brushes:"缺少当前加工文件中包含的下列官方画笔",has_xtool_brush:"已购买官方画笔，一键开启使用",no_this_xtool_brush:"未购买，替换为相近颜色的官方画笔",confirm_open_permission:"首先请确保您的自定义画笔适配官方笔套，自定义画笔选择开启后将允许开盖加工，为保证安全，使用自定义画笔时请拆除刀架，同时注意不要将手放至加工区域",add:"添加",delete:"删除",edit:"编辑",pen_name:"画笔名称",pen_type:"画笔类型",pen_stroke:"画笔粗细",pen_color:"画笔颜色",pen_save:"保存",pen_cancel:"取消",mark_pen:"马克笔",ball_pen:"圆珠笔",water_pen:"水彩笔",other:"其他",delete_custom_brush:"删除自定义画笔",confirm_delete_custom_brush:"确定删除此自定义画笔吗？",pen_limit_tip:"自定义画笔已到达存储上限，请及时清理",brush_fill_mode:"色块绘制方式",meander_brush:"回形",spiral_brush:"螺旋形",line_brush:"直线",element_out_canvas:"打印元素摆放位置超出可加工区域",print_not_in_area:"喷墨模块无法加工灰色区域，请勿将打印元素放置于灰色区域",no_support_params:"暂不支持创建材料测试矩阵",red_cross_out_range:"当前红十字位置超出可加工区域，请将其移至加工区域内",work_head_type:"加工头类型",work_head:"加工头",task_max_tips:"当前加工任务过多，请简化图纸或减少加工头的选择",only_preview_current_task:"仅预览当前加工任务",no_install_header:"当前未安装{header}加工头",current_unreset_home:"请先{operate}完成复位，否则可能会造成位置异常",close_gap:"关盖",install_usb_key:"将钥匙控制器插上",install_border_heighten:"安装底板或拓展底座",close_heighten_door:"关闭拓展底座前门板",close_gap_reset:"复位",first_close_gap:"请先关盖",close_gap_process:"请先关盖再进行加工",use_usb_key:"检测到设备钥匙控制器未插上，请正确插上钥匙控制器",no_board_heighten:"检测到当前拓展底座或底板未安装，请重新安装调整",no_heighten_door:"检测到当前拓展底座前面板关闭异常，请重新关闭",border_heighten_tip:"当前无法检测到{boardOrHeighten}，请安装",for_you_safety:"为保证您的使用安全，请先拆除刀架",right_install_frame:"请将丝网定位件安装在右边！丝网印刷的制版图案需要进行左右翻转",laser_head_exceed_area:"当前红十字位置超出可加工范围",mark_processing_area:"标定加工区域",smoking_fan_block_tip:"关闭后激光加工时将不会有排烟风扇堵转提醒，请谨慎选择，风扇堵转可能影响加工效果，加工时请持续关注加工情况。确定选择此项吗？",smoking_fan_auto:"排烟风扇档位调节",air_assist_auto_fix:"空气辅助自动调节",ink_test_tip:"请在加工前进行喷墨头测试，以确保打印效果；",ink_install_tip:"请将喷墨头安装在多功能托架上，关盖并点击测试",preset_test:"预喷区测试",install_ink_paper:"请将测试纸平整的粘贴在预喷区域",current_test:"原地测试",under_ink_module:"请将测试纸平整的粘贴在喷墨头当前位置",ink_test:"测试",ensure_result:"等测试完成后检查测试效果，确保颜色分明，出墨不堵塞，如若堵塞可用棉柔纸巾擦拭后再进行喷墨测试",ink_test_tips:"喷墨头容易堵塞，请在加工前进行测试，以确保打印效果",ink_maintenance:"喷头测试",beeper_tip:"关闭后，仅设备异常状态会发出提示音“哔”",before_ink_process:"加工前，请将放置板安装到右侧底板提手上，取下喷墨模块下盖，并把它放到放置板上",chang_laser_header:"检测到激光头已更换成功",ink_offset:"喷墨偏移",ink_x_offset:"X轴偏移",ink_y_offset:"Y轴偏移",ensure_type_c:"请确保喷墨头连接线已正常安装",rectangle:"矩形",rectangle_tip:"标记两个不在水平线的点会生成矩形。",circle:"圆形",circle_points3:"三点定圆：标记任意三个不在同一水平线上的点生成圆形",same_line_points3:"三点在同一水平线上不能定位一个圆",polygon:"多边形",polygon_tip:"标记三个点或以上，结束标记后首尾两点封闭形成多边形",line:"线条",line_tip:"请注意至少标记两个点才能生成线段。",end_marking:"结束标记",marking_operate1:"选择以下定位方式",marking_operate2:"移动红十字，通过点击设备按键标定加工区域",measure_processing_area:"标定加工区域",exit_cancel:"取消",exit_yes:"确认",marking_exit:"当前未完成标定，确定要退出吗？退出后数据将会被清除",measure:"开始标定",not_enough_points:"标记点数量不足，当前图形未生成",marking_mode:"定位方式",mark_point:"点",mark_point1:"标定点生成加工区域"},s1:{cylinder_connected_placed_tip:"请确认已经连接并正确摆放旋转附件",curve_alive_tip:"曲面加工阅读须知",point:"点",cutting_drop_tip:"在切割厚物体时,可以开启焦点下沉获得更好的切割效果",learn_how_to_measure:"查看如何手动测量",how_to_measure_tip:"可以通过自动测量或手动测量获取距离信息",laser_tempter:"当前激光头温度: {tempter} 度",focal_length_is_empty:"距离为空会造成加工效果异常",laser_head_position:"激光头位置",laser_head_position_is_out_of_processing_area:"当前激光头位置超出可加工范围",get_laser_head_position_fail_tip:"获取失败，请等待",element_is_out_of_walk_border_area:"元素超出走边框范围，请调整",to_reset:"立即复位",measuring_tip:"正在测量中，请稍后再试",current_area_is_not_support_measure:"该区域无法自动测量",measure_note:"可以通过自动测量或手动测量获取焦距信息",how_to_measure_with_hand:"查看如何手动测量",hand_measure_with_hand_step_1:"请使用尺子测量激光头顶部到物体表面的距离",hand_measure_with_hand_step_2:"得出的数值减去100mm(3.937in)，得出最终的距离",hand_measure_with_hand_step_3:"手动输入数值",hand_measure_with_hand_tip:"1.请使用尺子测量激光头顶部到物体表面的距离<br/>2.得出的数值减去100mm(3.937in)，得出最终的距离手动输入数值",ok:"好的",xy_move_distance:"XY移动距离（mm）",xy_move_speed:"XY移动速度（mm/s）",z_move_distance:"Z移动距离（mm）",measure_processing_area:"标定加工区域",measure:"开始标定",measure_processing_area_info:"请挪动激光头，通过两点标记预设加工范围。每确定一个位置，点击设备按键完成该点标定",measure_point_1:"点1",measure_point_2:"点2",measure_point_location:"标记点的坐标位置",focal_change_while_measuring:"检测到距离发生了变化,已经测量的加工区域也会发生改变",suggest_measure_again:"建议您重新标定加工区域",measure_point_holder:"坐标未获取",cutting_drop:"焦点下沉",cutting_drop_distance:"下沉距离",purifier_close_delay:"净化器关闭延时时长",air_assist_auto_fix:"空气辅助自动调节",measure_status:"设备处于对焦状态，请长按设备按键退出",measure_area_status:"设备正在进行测量材料区域，请长按设备按键退出",to_location_accurate_tip:"为了更准确的定位，请先测量距离再进行该操作",framing_speed:"走边框速度(mm/s)",main_board:"主板（运动板）",drive_board:"激光驱动板",wifi_module:"WI-FI 模组",back_to_origin:"加工结束后回到起始位置",in_set_wifi_status:"配网中，请稍后再试",many_device_tip:"检测到多个软件同时连接该设备的数量超出限制，当前连接可能会不稳定或无法正常加工，请减少软件连接数量。",error:{m222_s4:{title:"检测到移动",content:"发现设备出现位移，该问题可能会导致设备无法正常工作！设备已停止加工。请尽快处理。"},m222_s5:{title:"距离传感器异常警告",content:"距离传感器异常警告"},m222_s6:{title:"底板或扩展底座异常",content:"检测到底板或扩展底座连接异常"},m222_s7:{title:"请先关上机器遮罩再进行加工",content:"请先关上机器遮罩再进行加工"},m53_t0:{title:"存储器异常或损坏",content:"存储器异常或损坏"},m222_s9:{title:"检测到火焰",content:"Oops！设备检测到火焰，该问题可能会导致安全隐患！设备已停止加工。请尽快处理。"},m222_s20:{title:"加工过程中触发限位",content:"加工过程中触发限位"},m222_s21:{title:"WiFi模组与主控通讯异常",content:"WiFi模组与主控通讯异常"},m222_s22:{title:"激光器与主控通讯异常",content:"激光器与主控通讯异常"},m222_s23:{title:"安全锁拔出警告",content:"安全锁拔出警告"},m53_s0:{title:"USB 钥匙拔出警告",content:"检测到设备USB钥匙未正确插上"},m53_c1:{title:"底板或扩展底座异常",content:`检测到底板或扩展底座连接异常
请点击【如何解决】重新检查安装`},m53_c2:{title:"底板异常",content:`检测到底板连接异常 
 请点击【如何解决】重新检查安装`},help_btn:"如何解决",m363_s0:{title:"距离传感器异常",content:"测量异常，请检查距离传感器"},m363_s2:{title:"距离传感器异常",content:"检测到距离传感器信号异常。请使用手动测量或更换激光头"},m363_s3:{title:"距离传感器异常",content:"检测到距离传感器没有复位"},m8:{title:"电机驱动芯片报错",content:"电机驱动芯片报错"},m53_w0:{title:"温度过高",content:"Oops！发现激光头温度已达到38度，该问题可能会导致设备寿命缩短，建议您暂停加工，请等待激光头温度下降后使用"},m53_w1:{title:"温度过高",content:"Oops！发现激光头温度已达到40度，该问题可能会导致设备寿命缩短，设备已暂停工作，请等待激光头温度下降后使用"},m53_w2:{title:"增高台异常",content:"检测到增高台安装异常，请点击【如何解决】重新检查安装"},m363_s4:{title:"距离传感器异常",content:"测量异常，请检查距离传感器"},m363_s5:{title:"距离传感器异常",content:"测量异常，请检查距离传感器"},m53_l1:{title:"清洁激光头",content:"Oops！发现设备累计加工时间过长，加工产生的烟雾将会附着在镜片上，导致激光加工效果不佳。请及时使用干纸巾/棉签清洁镜片"}},reset_measurement_tips:"如果重新装卸不同的网框或更换激光头，需要重新进行校准。",screen_print_tip:"丝网印刷的制版图案需要进行左右翻转",screen_print_tip_new:"请将丝网定位件安装在右边！丝网印刷的制版图案需要进行左右翻转",smoking_fan:"排烟风扇",exhaust_time:"加工后排烟时间",rectangle:"矩形",line:"线条",circle:"圆形",polygon:"多边形",line_tip:"请注意至少标记两个点才能生成直线。",circle_tip1:"请注意至少标记两个点才能生成圆形。",circle_tip2:"寻找圆形物体的直径，根据直径生成圆形。",rectangle_tip:"标记两个不在水平线的点会生成矩形。",end_marking:"结束标记",by_rectangle:"矩形定位",by_line:"线条定位",by_circle:"圆形定位",by_polygon:"多边形定位",marking_exit:"当前未完成标定，确定要退出吗？退出后数据将会被清除",marking_operate1:"选择以下定位方式",marking_operate2:"移动激光头，通过点击设备按键标定加工区域",polygon_tip1:"标记三个点或以上，结束标记",polygon_tip2:"后首尾两点封闭形成多边形",not_enough_points:"标记点数量不足，当前图形未生成",exit_yes:"确认",exit_cancel:"取消",mark_point:"点",marking_mode:"定位方式",circle_points3:"三点定圆：标记任意三个位于圆形轮廓上的点生成圆形",same_line_points3:"三点在同一水平线上不能定位一个圆",fireproof_title:"提示",fireproof_tips_1:"检测到本次加工存在高功率低速度的参数设置：",fireproof_tips_2:"请确认底板干净，没有木屑或其他可燃碎屑",fireproof_tips_3:"请务必时刻关注机器内部加工情况",ok_process:"已确认，加工",close_gap_process:"盖子未关闭，请关闭盖子后，再进行加工",framing:"走边框速度(mm/s)",move_laser_module:"移动激光头",laser_head_speed:"走边框速度",position_shot:{title:"拍照对位",shot_bg:"拍摄背景",shot_title:"拍照对位",follow_steps:"你可以借助移动端XCS获取背景照片，步骤如下：",tip1:"1.借助移动端XCS，获取背景照片，可实现可视化的加工对位体验。",tip2:"2.在使用之前，需要先在移动端XCS APP，连接至该设备。然后根据移动端XCS APP的前端指引，完成贴纸和校准操作。",tip3:"3.上述操作完成后,在移动端XCS APP完成拍照，并点击【发送至PC端】，准备扫描PC端上的二维码。",note:"注意：PC端生成传输维码需要先登录。",obtain_bg_tip:"下一步，点击【获取背景】按钮。",obtain_bg_btn:"获取背景",obtain_bg_title:"获取背景",scan_tip:"请使用手机端或iPad端XCS，拍照完成后，点击【发送至PC端】，扫码将照片传输到PC端。注：请确保PC端XCS和扫码设备连接在同一SN下",click_refresh:"点击刷新",transfer_tip:"照片传输中，请耐心等待，传输完成后将会自动添加到画布背景中。",sending_success:"传输成功",sending_fail:"传输失败",cancel_transfer_confirm:"确认要取消照片传输吗？"}},empty:"连接设备后方可进行加工",modal:{tip:"提示",confirm:"确定",cancel:"取消",done:"完成",end:"结束",yes:"是",no:"否",redo:"再次加工",ignore:"忽略",take_photo_position:"拍照定位",closeFlameAlarm:"关闭火焰报警"},error:{error_code:"错误代码 {code}",how_resolve:"如何解决",err_flame_check:{title:"检测到火焰",content:"设备检测到火焰，该问题可能会导致安全隐患！设备已停止加工。请尽快处理。"},err_limit_check:{title:"加工中超过边界",content:"发现设备的激光头移动超过限位，该问题可能会导致设备无法正常工作！设备已停止加工。请尽快处理。"},err_tilt_check:{title:"检测到移动",content:"发现设备出现位移，该问题可能会导致设备无法正常工作！设备已停止加工。请尽快处理。"},err_moving_check:{title:"检测到移动",content:"发现设备出现位移，该问题可能会导致设备无法正常工作！设备已停止加工。请尽快处理。"},err_incline:{title:"设备倾斜",content:"Oops！发现设备发生了倾斜，该问题可能会引发安全隐患，请将设备正确放置后重启设备或联系售后进行处理。"},err_laser_head:{title:"激光器异常",content:"Oops！检测到激光器异常，该问题可能会导致设备无法正常工作，请参考帮助文档或联系售后进行解决。"},err_gyro:{title:"陀螺仪初始化异常",content:"Oops！发现陀螺仪初始化异常，该问题可能会引发安全隐患，请重启设备或联系售后进行处理。"},err_heighten:{title:"增高台异常",content:"Oops！检测到增高台安装异常，该问题可能会引发安全隐患，请重新检查安装。"},err_drawer:{title:"底板异常",content:"Oops！检测到底板安装异常，该问题可能会引发安全隐患，请重新检查安装。"},err_heighten_open:{title:"拓展底座前门关闭异常",content:"Oops！检测到拓展底座前门关闭异常，该问题可能会引发安全隐患，请重新检查安装。"},err_gap_open:{title:"开盖异常",content:"Oops！检测到设备目前关盖异常，该问题可能会引发安全隐患，请重新检查关盖加工。"},err_smoking_fan:{title:"排烟风扇未连接",content:"Oops！检测到排烟风扇连接异常，该问题可能会引发安全隐患，请重新检查安装。"},err_smoking_fan_block:{title:"排烟风扇滤棉堵塞",content:"oops！发现设备的排烟风扇滤棉堵塞，该问题可能会导致加工效果异常。请参考帮助文档或联系售后进行解决。"},err_header_no:{title:"加工头与加工类型不匹配",content:"Oops！检测到加工头与加工类型不匹配，该问题可能会导致设备无法正常工作，加工任务已取消，请重新执行加工任务。"},err_flame_check_error:{title:"检测到火焰",content:"Oops! 设备检测到火焰，该问题可能会引发安全隐患，请将设备关机静置后联系售后进行处理。"},err_flame_check_fatal:{title:"检测到火焰",content:"Oops! 设备检测到火焰，该问题可能会引发安全隐患，请将设备关机静置后联系售后进行处理。"},err_ink_bltouch:{title:"喷墨头损坏",content:"Oops！检测到喷墨头损坏，该问题可能会导致设备无法正常工作，请参考帮助文档或联系售后进行解决。"},err_laser_bltouch:{title:"激光器测距模组损坏",content:"Oops！检测到激光器测距模组损坏，该问题可能会导致设备无法正常工作，请参考帮助文档或联系售后进行解决。"},err_laser_eeppom:{title:"激光器芯片异常",content:"Oops！检测到激光器芯片异常，该问题可能会导致设备无法正常工作，请参考帮助文档或联系售后进行解决。"},err_knife_eeppom:{title:"主动头刀片芯片异常",content:"Oops！检测到主动头刀片芯片异常，该问题可能会导致设备无法正常工作，请参考帮助文档或联系售后进行解决。"},err_ink_eeppom:{title:"喷墨头芯片异常",content:"Oops！检测到喷墨头芯片异常，该问题可能会导致设备无法正常工作，请参考帮助文档或联系售后进行解决。"},err_usb_unlock:{title:"USB钥匙未连接",content:"Oops！检测到设备钥匙控制器未正确插上，请正确插上后进行设备使用。"},err_key_lock:{title:"检测安全钥匙",content:"检测到设备钥匙控制器未插上，请正确插上钥匙控制器。"},err_temp_error:{title:"文件传输异常",content:"文件传输异常导致加工取消，请点击【查看帮助】了解更多"},qx01_0:{title:"水箱温度过低",content:"Oops！发现设备的水箱温度过低，该问题可能会导致设备使用寿命缩短。设备已停止运行，请待机器恢复正常后使用。"},qx01_1:{title:"水箱温度过高",content:"Oops！发现设备的水箱温度过高，该问题可能会导致设备使用寿命缩短。设备已停止运行，请待机器恢复正常后使用。"},qx01_2:{title:"水箱温度传感器异常",content:"Oops！发现设备的水箱温度传感器异常，该问题可能会导致设备使用寿命缩短。设备已停止运行，请重启设备或联系售后进行处理。"},qx02_0:{title:"水泵堵塞",content:"Oops！发现设备的水泵堵塞，该问题可能导致安全隐患！设备已停止运行，请尽快处理。"},qx03_0:{title:"水箱水位过低",content:"Oops！发现设备的水箱水位过低，该问题可能会导致设备使用寿命缩短。设备已停止运行，请尽快处理。"},qx05_0:{title:"净化器堵塞",content:"Oops！发现设备的排风扇不工作，该问题可能导致安全隐患！设备已停止运行，请尽快处理。"},qx05_2:{title:"净化器未连接",content:"Oops！发现设备的净化器未连接，会导致安全隐患！设备已停止本次加工，请尽快处理。"},qx06_0:{title:"控制板不工作",content:"Oops！发现设备的控制板不工作，该问题可能会导致设备无法正常工作。设备已停止运行，请尽快处理。"},qx08_0:{title:"水泵电流过低",content:"Oops！发现设备的水泵电流过低，该问题可能会导致设备使用寿命缩短。设备已停止运行，请重启设备或联系售后进行处理。"},qx08_1:{title:"水泵电流过高",content:"Oops！发现设备的水泵电流过高，该问题可能会导致设备使用寿命缩短。设备已停止运行，请重启设备或联系售后进行处理。"},qx08_2:{title:"水泵电流不正常",content:"Oops！发现设备的水泵电流不正常，该问题可能会导致设备使用寿命缩短。设备已停止运行，请重启设备或联系售后进行处理。"},qx09_0:{title:"排风扇不工作",content:"Oops！发现设备的排风扇不工作，该问题可能会导致设备使用寿命缩短。设备已停止运行，请尽快处理。"},qx09_1:{title:"排风扇不工作",content:"Oops！发现设备的排风扇不工作，该问题可能会导致设备使用寿命缩短。设备已停止运行，请尽快处理。"},qx10_2:{title:"升级失败",content:"Oops！发现设备的运动控制MCU升级失败，该问题可能会导致设备无法正常工作。设备已停止升级，请尽快处理。"},qx11_2:{title:"升级失败",content:"Oops！发现设备的外设控制MCU升级失败，该问题可能会导致设备无法正常工作。设备已停止升级，请尽快处理。"},qx14_1:{title:"X轴复位失败",content:"Oops！发现设备的X轴复位失败，该问题可能会导致设备运动异常。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_2:{title:"Y轴复位失败",content:"Oops！发现设备的Y轴复位失败，该问题可能会导致设备运动异常。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_3:{title:"Z轴复位失败",content:"Oops！发现设备的Z轴复位失败，该问题可能会导致设备运动异常。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_8:{title:"U轴复位失败",content:"Oops！发现设备的U轴复位失败，该问题可能会导致设备运动异常。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_4:{title:"X轴电机驱动异常",content:"Oops！发现设备的X轴电机驱动报错，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_5:{title:"Y轴电机驱动异常",content:"Oops！发现设备的Y轴电机驱动报错，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_6:{title:"Z轴电机驱动异常",content:"Oops！发现设备的Z轴电机驱动报错，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_7:{title:"U轴电机驱动异常",content:"Oops！发现设备的U轴电机驱动报错，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_9:{title:"W轴电机驱动异常",content:"Oops！发现设备的U轴电机驱动报错，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx14_10:{title:"W轴复位失败",content:"Oops！发现设备的W轴复位失败，该问题可能会导致设备运动异常。设备已停止运行，请重启设备或联系售后进行处理。"},qx14:{title:"运动轴限位报错",content:"Oops！发现设备的运动轴限位报错，该问题可能会导致设备运动异常。设备已停止运行，请重启设备或联系售后进行处理。"},qx16:{title:"设备主控温度异常",content:"Oops！发现设备的主控温度异常，该问题可能会导致设备使用寿命缩短。设备已停止运行，请待机器恢复正常后使用。"},qx17:{title:"摄像头不工作",content:"Oops！发现设备的摄像头不工作，该问题可能会导致设备无法正常工作。设备已停止运行，请尽快处理。"},qx17_0:{title:"无法找到摄像头",content:"Oops！发现设备的摄像头处于异常状态，该问题可能会导致设备无法正常工作。请重启设备或联系售后进行处理。"},qx17_1:{title:"摄像头异常",content:"Oops！发现设备的摄像头处于异常状态，该问题可能会导致设备无法正常工作。请重启设备或联系售后进行处理。"},wx13:{title:"清洁激光头",content:"Oops！发现设备的累计加工时间过长，请清洁激光头。"},wx13_new:{title:"清洁激光头",content:"Oops！发现设备累计加工时间过长，加工产生的烟雾将会附着在镜片上，导致激光加工效果不佳。请及时使用干纸巾/棉签清洁镜片"},qx20_1:{title:"控制板工作异常",content:"Oops！发现设备的控制板工作异常，该问题可能会导致设备使用寿命缩短。设备已停止运行，请尽快处理。"},qx20_2:{title:"控制板工作异常",content:"Oops！发现设备的控制板工作异常，该问题可能会导致设备使用寿命缩短。设备已停止运行，请尽快处理。"},qx20_3:{title:"控制板工作异常",content:"Oops！发现设备的控制板工作异常，该问题可能会导致设备使用寿命缩短。设备已停止运行，请尽快处理。"},qx20_4:{title:"控制板工作异常",content:"Oops！发现设备的控制板工作异常，该问题可能会导致设备使用寿命缩短。设备已停止运行，请尽快处理。"},qx20_5:{title:"加工路径出错",content:"Oops！发现设备的加工路径出错，该问题可能会导致设备无法正常工作。设备已停止本次加工，请尽快处理。"},qx21_1:{title:"激光头不工作",content:"Oops！发现设备的激光头不工作，该问题可能会导致设备无法正常工作。设备已停止运行，请尽快处理。"},qx30_0:{title:"固件版本丢失",content:"Oops！发现设备的固件版本号丢失，该问题可能会导致设备无法正常工作，请重启设备或联系售后进行处理。"},qx30_1:{title:"板卡无法通信",content:"Oops！发现设备的板卡无法通信，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx30_1_1:{title:"板卡无法通信",content:"Oops！发现设备的板卡无法通信，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx30_1_2:{title:"板卡无法通信",content:"Oops！发现设备的板卡无法通信，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx30_1_3:{title:"板卡无法通信",content:"Oops！发现设备的板卡无法通信，该问题可能会导致设备无法正常工作。设备已停止运行，请重启设备或联系售后进行处理。"},qx30_2:{title:"水箱水位过低",content:"Oops！发现设备的水箱水位过低，该问题可能会导致设备使用寿命缩短。设备已停止运行，请及时加水。"},qx30_3:{title:"水冷风扇不正常",content:"Oops！发现设备的水冷风扇不正常，该问题可能会导致设备使用寿命缩短。请重启设备或联系售后进行处理。"},qx30_4:{title:"水箱水流过低",content:"Oops！发现设备的水箱水流过低，该问题可能会导致设备使用寿命缩短。设备已停止运行，请参考帮助文档进行解决。"},qx30_5:{title:"X轴初始化异常",content:"Oops！发现设备的X轴初始化配置错误，该问题可能会导致设备运动异常。设备已停止运行，请联系售后进行处理。"},qx30_6:{title:"Y轴初始化异常",content:"Oops！发现设备的Y轴初始化配置错误，该问题可能会导致设备运动异常。设备已停止运行，请联系售后进行处理。"},qx30_7:{title:"Z轴初始化异常",content:"Oops！发现设备的Z轴初始化配置错误，该问题可能会导致设备运动异常。设备已停止运行，请联系售后进行处理。"},qx30_7_1:{title:"主动Z轴初始化异常",content:"Oops！发现设备的主动头Z轴初始化配置错误，该问题可能会导致设备运动异常。设备已停止运行，请联系售后进行处理。"},qx30_7_2:{title:"从动头Z轴初始化异常",content:"Oops！发现设备的从动头Z轴初始化配置错误，该问题可能会导致设备运动异常。设备已停止运行，请联系售后进行处理。"},qx30_8:{title:"U轴初始化异常",content:"Oops！发现设备的U轴初始化配置错误，该问题可能会导致设备运动异常。设备已停止运行，请联系售后进行处理。"},qx30_9:{title:"W轴初始化异常",content:"Oops！发现设备的W轴初始化配置错误，该问题可能会导致设备运动异常。设备已停止运行，请联系售后进行处理。"},qx_filter_blocked:{title:"滤棉堵塞",content:"oops！发现设备的排烟风扇滤棉堵塞，该问题可能会导致加工效果异常。请参考帮助文档或联系售后进行解决。"},qx32_0:{title:"风扇电流过低",content:"Oops！发现设备的风扇电流过低，该问题可能会导致加工效果异常。请参考帮助文档进行解决。"},qx32_1:{title:"风扇电流过高",content:"Oops！发现设备的风扇电流过高，该问题可能会导致设备使用寿命缩短。请参考帮助文档进行解决。"},qx31_1:{title:"打开电子锁异常",content:"Oops！发现设备开锁异常，该问题可能导致设备无法正常使用。请重启设备。"},qx31_0:{title:"关闭电子锁异常",content:"Oops！发现设备关锁异常，该问题可能导致设备无法正常使用。请重启设备或联系售后进行处理。"},qx31_2:{title:"气泵电流异常",content:"Oops！发现气泵电流异常，该问题可能会引发安全隐患，请重启设备或联系售后进行处理。"},qx_x_1:{title:"设备发生了倾斜",content:"oops！发现设备发生了倾斜，该问题可能会引发安全隐患，请将设备正确放置后重启设备或联系售后进行处理。"},qx_x_2:{title:"设备外壳与电路板发生短路",content:"oops！发现设备发生了短路，该问题可能会引发安全隐患，请联系售后进行处理。"},qx_x_3:{title:"检测到火焰",content:"Oops! 设备检测到火焰，该问题可能会引发安全隐患，设备已停止加工，请尽快处理。"},communication_abnormality:{title:"设备通讯异常",content:"oops！发现设备的通讯异常，该问题可能会导致设备无法正常工作，请重启设备或联系售后进行处理。"},camera_abnormality:{title:"摄像头异常",content:"oops！发现设备的摄像头处于异常状态，该问题可能会导致设备无法正常工作。请重启设备或联系售后进行处理。"},z_axis_abnormality:{title:"Z轴异常",content:"oops！发现设备的Z轴异常，该问题可能会导致设备无法正常工作，请联系售后进行处理。"},u_axis_abnormality:{title:"U轴电机异常",content:"oops！发现设备的U轴电机异常，该问题可能会导致设备无法正常工作，请联系售后进行处理。"},red_laser_abnormality:{title:"光纤红外激光器故障",content:"oops！发现设备的光纤红外激光器故障，该问题可能会导致设备无法正常工作，请联系售后进行处理。"},board_fan:{title:"散热风扇异常",content:"检测到散热风扇异常，该问题可能会导致设备无法正常工作！设备已停止加工，请联系售后处理。"}},material:{input_placeholder:"搜索材料名称",all_material_category:"全部分类",supported_only:"只看可使用材料",use:"使用",not_supported_yet:"暂不支持",not_supported_yet_tips:"由于设备、激光头功率、加工模式等原因，无法使用该材料加工。",more_material:"更多材料",material_lab:"耗材参数库",material_flammable:"易燃",no_content_found:"暂无内容",request_failed:"请求失败",network_error_1:"网络无法连接啦，请检查网络设置。",network_error_2:"但编辑器部分的功能仍然可以使用。",server_error:"系统异常，请稍后重试",how_to_differentiate:"点击查看如何区分木芯"},measure_guide:{title:"距离测量",manual_measurement:"手动测量",manual_measurement_distance:"请根据图示测量数值:",input_distance:"请输入测得的距离值",re_automatic_measurement:"重新自动测量",auto_measurement_fail:"自动测量失败",auto_measurement_success:"自动测量成功",solution_1:"解决方案一",solution_1_detail_1_laser_plane:"将加工材料放置在距离设备底板上 {min} 到下 {max} 的位置。",solution_1_detail_1_cylinder:"将圆柱加工材料最高点放置在距离设备底板上 {min} 到下 {max} 的位置。",solution_1_detail_final:"调整到正确位置后，点击 {re_automatic}。",solution_2:"解决方案二",solution_2_detail_1:"点击 {re_manualMeasure} 按钮，手动测量距离",view_detail_tutorial:"查看详细教程",measuring:"正在测量",measure_fail:"测量失败",thickness_to_large:"材料厚度超出范围限制，无法加工",thickness_to_small:"厚度测量失败，请尝试垫高材料后重试",manual_measurement_auto:"可以通过自动测量或手动测量获取距离信息。",failed:"自动测量失败",measure_over_thick:"超出最大可测量厚度",measure_over_distance:"超出最大可测量距离",measure_under_thick:"超出最小可测量厚度",measure_under_distance:"超出最小可测量距离",measure_error_btn:"可能原因及其解决方法",materials_over_max_thick:"当前材料超出最大可加工厚度，请更换材料"},ext:{take_local_pic:"近景拍照",del_local_pic:"删除近景"},pass_through:{process_finish_header:"加工完成 任务{currStep}/{totalStep}",set_next_process:"下一段任务设置 任务{currStep}/{totalStep}",auto_counterpoint:"自动对位",auto_counterpoint_again:"再次自动对位",close_manual_measure:"关闭手动对位",open_manual_measure:"使用手动对位",counterpointing:"正在自动对位",no_move_or_open:"请勿开盖或挪动材料",counterpoint_success:"自动对位成功",click_button_to_process:"点击加工进入预览界面",counterpoint_fail:"自动对位失败",please_manual_counterpoint:"特征点过少，请手动对位",taking_photo:"正在拍照",push_material_tips:"竖直方向推动代加工材料向上移动,靠近红点所在水平线,完成后点击自动对位",push_no_enough_tips1:"材料未推到相应位置",push_no_enough_tips2:"竖直方向推动代加工材料向上移动",push_no_enough_tips3:"靠近红点所在水平线",push_no_enough_tips4:"完成后点击自动对位",select_take_local_img:"请在画布中选择你要拍摄的区域，按ESC或右键退出选择",select_precise_measure:"请在画布中点击你要测距的区域，按ESC或右键退出选择",manual_alignment:"通过上下左右按钮调整元素位置使其对齐上次加工末尾",back_auto_align:"返回自动对位"},measure:{up:"上",down:"下",left:"左",right:"右",mark:"标记",point1:"点1",point2:"点2",open:"开启",close:"关闭",reset:"归位",setup_title:"设置测量密度",density_title:"密度测量",curve_title:"曲面预览",col:"列",row:"行",estimated_time:"预计测量耗时",reselect_area:"重新选择区域",measure_min_error:"测量区域过小，请重新记录",no_map:"无待贴图元素",start:"开始测量",measuring:"正在测量",measuring_progress:"进度 {current} / {total}",preview_angle_tip:"三维模式下按住鼠标左键可以调整预览角度",smoothness:"平滑度",tension:"张力",select_points_remeasure:"选择测量点可进行重新测量",remeasure:"重新测量",measure_max_distance:"已经到达最大测量范围",measure_fail:"测量失败",measure_disable:"该区域无法自动测量",measure_fail_desc:"存在不可被测量的点，请调整物体后重试",how_to:"如何进行曲面测量",measure_fail_disconnect:"设备断开连接，测量失败",model_adjustment:"模型调整",record_step1:"1、挪动激光头，使其投射出的红点到达想要加工区域的斜对角；",record_step2:"2、分别记录激光头投射红点的坐标位置。",control_larser:"控制激光头",record_position:"标记点的坐标位置",model_adjust_tip:"通过调节平滑度和张力使模型更接近实际物体",map:"贴图",top_view:"顶视图",three_d_view:"三维图",hide_grid:"隐藏网格",show_grid:"显示网格",move_tip:"如果移动了材料，需要重新进行曲面测量",curvature_tip:"存在超出可加工范围的曲面，请不要在该区域放置元素",busy_tip:"设备已被占用，请稍后重试",exit_measure:"机器处于测量中状态，请进行一次开关盖退出该状态",measure_is_larger_then_max:"超出最大可测量距离，自动测量失败",curve_process_mode_data_tip:"无可加工曲面，请先进行曲面测量",curve_mode_tip:"此模式下，请不要直接通过拍照来完成对位",no_marked_yet:"当前没有已经标定的加工区域",measure_surface_first:"请先进行曲面测量"},origin_calibration:{title:"原点校准",back_to_origin:"回原点",please_back_origin:"请控制设备回初始原点，回原点后再点击下一步。",over_area_tip:"校准已超出画布范围，请重新校准",done:"完成校准",screen_size:"网框尺寸"},auto_focus:{auto_focus_remain_modal_head:"自动对焦操作检查",auto_focus_remain_tip1:"1. 激光头即将开始下探进行复位，请不要在底板上放置超过10cm的较厚物品，避免压坏设备",auto_focus_remain_tip2:"2. 点击右下角【确定】按钮开始自动对焦",init_before_auto_focus:"使用自动对焦前请先",init:"初始化",init_before_auto_focus_tip:"使用自动对焦前请先初始化"},element_container:{obj_title:"对象参数",obj:"对象",group:"组",circle:"圆",line:"线段",rect:"矩形",vector:"矢量图形",text:"文字",image:"图像",multi_obj:"多个选中对象",output:"执行",ignore:"忽略",all_vectors:"所有矢量图形",all_bitmaps:"所有位图",not_work_for_bitmaps:"当前加工模式，不支持加工位图对象",multiple_values:"*多个值",output_type:"加工类型",param:"参数方案",cant_set_params_for_both:"暂不支持同时对矢量和位图设置参数",select_vector:"选择矢量",select_bitmap:"选择位图",processing_is_not_supported:"暂不支持加工",no_param:"暂无保存的参数方案",how_to_save_param:"如何保存我的参数方案"},user_defined:{manual_setting:"手动输入",save_as_setting:"保存为新的参数方案",new_setting:"新建参数方案",name:"名称",cancel:"取消",save:"保存",enter_name:"请填写名称",delete:"删除",is_delete:"确认删除该参数方案",cant_be_restored:"删除后参数将无法被复原",think:"我再想想",confirm:"确认删除",no_setting:"暂无保存的参数方案",how_to_save:"如何保存我的参数方案",upper_limit:"参数方案已到达存储上限",custom_settings:"自定义参数方案",export:"导出",export_success:"导出成功",export_fail:"导出失败，请重试",import_setting:"导入参数方案",import:"导入",import_limit:"每种加工方式最多支持保存30套参数方案",import_success:"导入成功",import_fail:"导入失败，请重试"},laser_extend:{extend_install_calibration_entry:"使用扩幅配件前，请先开启安装校准流程进行准确安装",extend_install_calibration:"扩幅配件安装校准",extend_install_calibration_guide:"扩幅配件安装校准",counterpoint:"对位",pre_lock:"预锁",calibrate:"校准",completion:"完成",go:"开启",next_step:"下一步",initial_install_summary:"请按以下指引先完成初步的安装对位:",initial_install_step_1:"·将活动标尺右沿推至横向刻度尺的零点对齐，进行锁定; 并旋转加工旋钮在活动标尺表面手动对好焦;",initial_install_step_2:"·将扩幅配件沿Y轴推至底板的第二条白线并对齐;",initial_install_step_3:"·完成以上调整后点击「下一步」。",lock_screw_summary:"左右螺丝预锁:",lock_screw_step_1:"·对左右两侧的底板螺丝进行预锁;",lock_screw_step_2:"·完成以上调整后点击「下一步」，开始投影校准。",projection_summary:"开始“工”字投影对准:",projection_step_1:"·设备进行“工”字投影中，请左右微调扩幅配件底座，使活动标尺上的“工”字和投影对准重合;",projection_step_2:"·对准后先锁定左侧螺丝，然后点击「下一步」，将刀条板自动移至左侧。",complete_calibration_summary:"完成最终校准和锁定:",complete_calibration_step_1:"·锁定右侧螺丝；",complete_calibration_step_2:"·点击「结束」，完成安装校准。",platform_speed_tips:"可以修改此速度，在走边框中更好地控制刀条板移动"},task_list:{unrecoverable_after_disconnection:"请注意，设备断连后重连该任务将不能恢复",file_name:"文件名称",device_name:"设备名称",remaining_time:"剩余时间",current_processing_time:"当前加工耗时",disconnected_tips:"若当前设备仍在加工但显示设备断连时，重连设备可以恢复加工控制！30分钟不处理将移入历史任务但不影响设备的正常加工。",move_in_history:"移入历史任务",reconnect:"重新连接",open_file:"打开文件",task_history:"历史任务",in_processing:"加工中",no_in_processing:"无加工中任务",no_history_task:"无历史任务",first_minimize:"正在加工任务可以到任务列表查看"},material_test:{x:{title:"列",count:"列数",spacing:"列间距"},y:{title:"行",count:"行数",spacing:"行间距"},param:"参数",max:"最大值",min:"最小值"},task:{working:"加工中",history:"历史任务",warning_disconnect:"请注意，设备断连后重连该任务将不能恢复",warning__30min:"若当前设备仍在加工但显示设备断连时，重连设备可以恢复加工控制！30分钟不处理将移入历史任务但不影响设备的正常加工。",warning_:"设备断连，请查看设备！30分钟不处理将自动移入历史任务但不影响设备的正常加工；",device_disconnect:"设备断连",move_to_history:"移入历史任务",connect_again:"重新连接",open_file:"打开文件",connect_success:"设备连接成功",connect_failed:"设备连接失败，请重试！",connect_failed_fix:"如何解决",close_warning:"当前项目正在加工中，请加工完成后再关闭。",working_empty:"无加工中任务",history_empty:"无历史任务",working_tips:"正在加工任务可以到任务列表查看"},list:{device_selected_tips:"打开项目会自动匹配符合项目的当前设备；您可以通过在其他设备选择设备来更换项目的当前设备",current_device:"当前设备",switch_device:"可切换设备",switch_current_device:"切换当前设备",switch_device_tip:"可切换设备为曾经使用过的设备，包括连接过的设备及通过打开文件获取的设备，通过打开文件获取的设备设备名称为“未知”",connect:"连接设备",please_connect:"请连接设备",empty_device_tip:"请先连接设备",delete_device:"删除设备",device_introduction:"使用说明",device_setting:"设备设置",delete_device_modal_content:"确定要删除当前设备吗？",delete_device_modal_cancel_text:"取消",delete_device_modal_confirm_text:"删除",disConnect_device_modal_title:"断开连接",disConnect_device_modal_content:"断开连接会导致部分设置不可用，确定要断开当前设备的连接吗？（注：设备加工时断开连接会影响加工进程）",disConnect_device_modal_cancel_text:"取消",disConnect_device_modal_confirm_text:"断开",connected:"已连接",un_connected:"未连接",in_processing:"加工中",connecting:"连接中...",switch_device_model_title:"提示",switch_device_model_content:"切换的设备与项目文件的设备机型不匹配，切换设备后项目文件加工模式、材料、参数可能会发生调整。确定切换吗？",switch_device_model_cancel_text:"取消",switch_device_model_confirm_text:"切换",switch_device_power_model_tip:"提示",switch_device_power_model_content:"该项目文件参数与加工设备加工头不匹配，为了保证可以正常加工需要切换相关参数，是否切换？",switch_device_power_model_confirm_text:"是",switch_device_power_model_cancel_text:"否",unrecognized_power:"未识别到激光头，请检查设备后重新连接，",delete_device_tip:"该设备正在被其他项目使用，无法删除",unknown:"未知",empty:"暂无设备",please_connect_device:"请先连接设备",wifi_status:"Wi-Fi",Hotspot_status:"Hotspot",xTool:"xTool_",new_project:"新建项目",open_system_file:"打开系统文件",add_from_albm:"从相册添加",take_picture:"拍照"},message:{task_finish_title:"加工完成",task_pause_title:"加工暂停",task_cancel_title:"加工取消",device_disconnect_title:"断开连接",task_finish_content:"本次加工任务完成，请到加工任务列表查看详情",device_disconnect_content:"设备断开连接，请到加工任务列表查看详情",task_cancel_content:"本次加工任务取消，请到加工任务列表查看详情",task_pause_content:"本次加工任务暂停，请到加工任务列表查看详情"},parameter_panel:{pin:"设为常驻面板",parameters:"参数设置",title:"参数面板",font:"正面",back:"背面",array:"参数矩阵",reference:"参考图",used_fail:"参数带入失败，请选择匹配的设备及激光器再应用",recommended:"推荐值：",default:"值：",null_value:"空值",user_defined:"自定义参数",user_guide:"请点击参数面板进行参数设置",used_success:"参数应用成功",success:"成功"},gs002:{backup_file:"备份到机器“本地文件”",file_name:"文件名称",backup_file_tip:"将文件备份到机器的“本地文件”空间，可以在机器屏幕上查看并进行离线加工。",unnamed:"未命名",file_save_success:"文件备份成功",format_error:"文件名不支持特殊字符",file_already_exists:"该文件名已存在，请修改命名后重试",file_does_not_exist:"文件不存在",space_is_not_enough:"存储空间不足，请删除部分文件后重试",backup_failure:"文件备份失败",positioning_photo_tip:"拍照前，确保材料平整并完成对焦，有利于提升定位精度",take_photo_success:"拍照成功",take_photo_fail:"拍照失败",camera_abnormality:"摄像头异常，暂不支持拍摄",make_video:"制作加工视频",make_video_tip:"使用此功能，可以拍摄加工区域的加工照片，并制作成视频。",ready_shooting:"拍摄就绪",shooting:"正在拍摄",pause_shooting:"拍摄暂停",making_video:"视频制作中……",making_video_tip:"正在制作视频，请稍后再试",transmission_photo:"图片已传输",save_video_failed:"视频保存失败",cant_not_photo:"设备加工中，请稍后再试",focusing_tip:"设备正在对焦，请长按加工按钮退出后重试",focusing_success:"手动刷新拍照界面",manually_focusing_success:"检测到进行了重新对焦，请手动刷新拍照界面",focusing_success_button:"立即刷新",focusing_fail:"自动测量失败，点击查看可能原因",focusing_light_fail:"对焦失败，请盖上罩子或调暗环境光线后重试",focusing_button_tip:"用罩子遮挡光线，对焦更精准",smoke_exhaust_time:"加工后排烟时间",purifier_beep_enable:"净化器工作提示音",have_processing_task:"存在加工任务未完成",have_processing_task_tip:"检测到之前存在因断电而未完成的加工任务，点击确定后再单击设备加工按钮可以继续加工，是否继续？",give_up:"放弃",device_working:"设备正在工作中",conveyor_belt_keep_tip:"使用批量加工前，请先查看使用说明 >>",conveyor_extension_tip:"请确保已正确安装并连接传送带",laser_cylinder_tip:"确保机器投射的红点落在圆柱体最高点上",step:"步骤",conveyor_belt_tip_model:{head:"传送带使用说明",step0:"此功能需要使用云服务。请确保您的电脑已连接网络，并登录 xTool 账号。",step1:"安装并连接传送带。",step2:{title:"设计加工样本。",tip1:"在加工区域，放置待加工的材料；",tip2:"点击“刷新”按钮，拍摄加工区域背景照片；",tip3:"在背景照片的一个材料上，设计加工元素并设置加工参数"},step3:"点击“加工”按钮，开始批量加工。"},conveyor_belt_next:"点击“继续”可识别下一批材料进行加工",batch_close_confirm:"确定取消后将结束本次批量加工，确定取消吗？",batch_process_ready:{head:"加工准备中，请耐心等待……",notice1:"请不要移动或晃动传送带",notice2:"请不要移动加工区域的材料",step1:"传送材料",step2:"拍摄材料",step3:"识别材料"},export_xf:"导出xf",name_too_long:"文件名超过15个字符",special_characters:"含有特殊字符",z_axis_move:"Z 轴下降距离","z_scan angle":"扫描角度",z_layers:"每隔 N 层",z_decline:"下降 N mm",avoid_smoke_modal:"避烟模式",avoid_smoke_modal_tip:"在木材、瓦楞纸等材料使用线条雕刻时，若烟雾较大，可能会影响加工效果，开启此模式，可避免烟雾影响。",red_light:"光纤红外光",z_reset:"操作前，请不要在底板上放置厚度超过 30cm 的物体，以免激光器撞击物体，发生损坏。",z_reset_success:"复位成功",z_reset_fail:"复位失败，请重试",z_reset_tip:"若红蓝点已重叠，测算的材料厚度与实际不符 ，请操作Z轴复位后重试。",slice_number:"分层数",scan_angle:"扫描角度",element_count_over_limit:"画布上元素超过1个，批量加工仅支持单元素",rest_note:"温馨提示",rest_confirm:"确定",rest_cancel:"取消",z_reset_modal:"Z轴复位",reset:"复位",reset_success:"还原成功",reset_fail:"复位失败，请重试",power_resume:"存在加工任务未完成",power_resume_content:"检测到之前存在因断电而未完成的加工任务，点击确定后再单击设备加工按钮可以继续加工，是否继续？",trimming:"外轮廓描边",busy_tip:"设备正在工作中，请稍后再试",usbkey_lost:"检测到设备钥匙控制器未插上，请正确插上钥匙控制器",curve:{warning_tip:"此模式下，请不要直接通过拍照来完成定位",area1:"步骤1.移动材料，使中心的蓝点投影落于想要的测量区域的中心位置，然后进行对焦。",area2:"步骤2.观察矩形框投影，可以在左侧画布上调整矩形框大小，来调整测量区域。",measureing:"设备正在测量曲面，请长按加工按钮退出后重试"},batch_identify_failed:"因连续5批没有识别到加工材料，已自动结束批量加工",process_ready_title:"请点击触屏控制器上的“xtool”按钮开始加工。为了避免火灾风险，请谨慎加工易燃材料。",params_setting:"参数设置",conveyor_belt_calibration:"传送带校准",x_calibration_title:"X轴偏差校准",angle_calibration_title:"角度偏差校准",calibration_introduce:"校准说明",x_calibration_introduce_detail_1:"因长途运输可能会导致传送带的皮带发生角度偏差，首次使用，请先校准X轴偏差。",x_calibration_introduce_detail_2:"如果大幅度移动，加工较重（超过1kg)的材料或更换皮带后，请先校准X轴偏差。",x_calibration_introduce_detail_3:"校准前，请先确认已校准角度偏差。",x_calibration_introduce_detail_4:"建议使用刮画纸（220 × 220mm）作为雕刻材料，辅助校准。雕刻前可以将刮画纸粘贴在皮带上。",angle_calibration_introduce_detail_1:"因长途运输可能会导致传送带的皮带发生角度偏差，首次使用，请先校准角度偏差。",angle_calibration_introduce_detail_2:"如果大幅度移动，加工较重（超过1kg)的材料或更换皮带后，请先校准角度偏差。",angle_calibration_introduce_detail_3:"建议使用刮画纸（220 × 220mm）作为雕刻材料，辅助校准。雕刻前可以将刮画纸粘贴在皮带上。",start_calibration:"开始校准",click:"点击",calibration_step_1:"雕刻校准图纸",engraving:"雕刻",angle_calibration_step_2:"观察横线所在的角度值，并填写偏差值",x_calibration_step_2:"观察横线所在的刻度值，并填写偏差值",angle_calibration_result_label:"角度偏差值 （度）",x_calibration_result_label:"X轴偏差值 （mm）",angle_calibration_step_3:"将完成本次校准。若仍有偏差，请重新校准",continue_take_phone:"继续拍照",no_album_permission:"相册权限未开启",batch_process_tip:{step1:{title:"拍摄样本材料",desc:"点击【刷新】按钮，拍摄样本材料"},step2:{title:"设计加工对象",desc:"在样本材料上，设计加工对象并设置加工参数"},step3:{title:"开始加工",desc:"请点击【加工】按钮，开始体验批量加工"},empty_canvas:"请先在画布上添加加工的对象",offline:"此功能需要使用云服务，检测到网络异常，请检查网络连接"},select_area:"框选样本材料",select_area_tip:"请先框选样本材料",z_calibration_title:"厚度测量校准",red_calibration_title:"红外光校准",blue_calibration_title:"蓝光校准",z_calibration_introduce_detail:{title:"什么时候需要进行厚度测量校准？",illustrate:"自动对焦时，如果自动测量的材料厚度与实际偏差较大，请先检查加工材料表面是否平整。若加工材料表面平整，但是仍然出现厚度测量不准的问题，请进行厚度测量校准。",step_illustrate:"确保加工底板干净平整，没有放置任何物体（参考下图），然后开始校准。",button:"校准"},red_blue_calibration_tile:{blue_light:"蓝光",red_light:"红外光",title_1:"在使用",title_2:"加工时，如果实际加工位置与 XCS 画布中的对象位置偏差较大，请参考以下方案进行问题排查：",title_3:"检查加工材料表面是否平整，确保加工材料表面平整；",title_4:"检查测量的材料厚度是否准确，确保材料厚度参数准确；",tip_1:"如果以上没有解决偏差大的问题，点击”开始校准”进行",tip_2:"建议使用黑色相干纸（100 x 100mm）作为雕刻材料，辅助校准；雕刻前可以将黑色相干纸粘贴在加工底板正中间",step_1_2:"打开校准文件",step_1_3:"，在 XCS 中加工此文件",step_2:" 加工完成后，刷新拍照定位。放大画布，查看加工完成的正方形左下角在所给坐标系中的坐标，该坐标即为偏差值（请注意偏差值的正负）",step_2_x:"X 轴偏差值（mm）",step_2_y:"Y 轴偏差值（mm）",step_2_tip:"例如：示例图中，加工完成的正方形左下角所在的坐标为（-0.1，1.3），则 X 轴偏移值为 -0.1mm，Y 轴偏移值为 1.3mm",step_3:"保存校准结果。若仍存在较大偏差，请重新校准或联系售后解决",step_3_button:"确认"},process_fulfil_tip:"加工金属或加工时间较长（如浮雕），小心材料烫手",server_exception:"服务器异常，请稍后重试",batch_select_box:"暂无法保证下列材料准确填充：反光、带孔、带环、镂空等材料，",batch_select_box_tip:"使用前请查看详细说明",red_blue_text:{calibration_prompt:"设备校准提示",fiber_ir:"光纤红外光",fiber_ir_fault:"光纤红外激光器故障",befor_calibration:"设备经过长途运输后，可能导致厚度测量或加工定位不准，影响加工效果（例如雕刻金属颜色浅或雕刻不上）。为保证加工效果，请先进行红蓝光校准。",to_calibrate:"去校准",calibration:"红蓝光校准",calibration_accuracy_tips:"如出现以下任一情况，请进行校准，以保证加工的准确性：",calibration_accuracy_tips_1:"1. 底板整洁且未放置任何材料时进行自动对焦，测得的厚度偏差较大；",calibration_accuracy_tips_2:"2. 材料表面平整且厚度参数正确，加工时发现实际加工位置与 XCS 画布中的对象位置偏差较大。",calibration_1_1:"使用黑色相干纸（100 x 100mm）作为雕刻材料，辅助校准。",calibration_1_2:"将黑色相干纸粘贴在加工底板正中间，确保粘贴平整、中间不鼓起。",calibration_1_note:"提示：若之前执行过校准，点击【下一步】后将清除原先的校准值。",operation_failed:"操作失败，请重新点击下一步",calibration_2_1:"点击【雕刻】，然后按下触屏控制器上的“XTOOL”按钮，雕刻校准图案。",calibration_2_note:"注意：加工前，先关闭设备的防护罩。",carving:"雕刻",calibration_3_1:"在左边照片中，",calibration_3_2:"分别读取蓝、红坐标系中雕刻的十字中心点所在坐标，将坐标值作为偏差值填入下方。",calibration_3_2_mobile:"分别读取蓝、红坐标系中雕刻的十字中心点所在坐标，将坐标值作为偏差值填入下方。",calibration_3_3:"（注意区分数值的正负。）",calibration_3_tips:"如：十字中心点所在坐标为（0，-0.5），则 X 轴偏移值为 0mm，Y 轴偏移值为 -0.5mm",x_deviation:"X轴偏差值",y_deviation:"Y轴偏差值",calibration_4_1:"首先，拿掉底板上的相干纸;",calibration_4_2:"然后，观察底板上的光斑:",calibration_4_3:"- 若红色与蓝色光斑不重合，点击【不重合】继续校准，使红蓝对焦光斑重合。",calibration_4_4:"- 若重合，则点击【重合】结束校准。",overlapped:"重合",not_overlapped:"不重合",calibration_5_1:"拔掉 xTool F1 Ultra 背部的钥匙，禁用激光功能，以免校准红光发射器的时候意外触发激光，引起危险。",calibration_6_1:"使用 xTool F1 Ultra 配备的 M2.5 内六角螺丝刀，逆时针拧松红光发射器左侧的螺丝。",calibration_6_2:"注意：若在校准过程中，设备进入休眠，红蓝对焦光斑会消失，请点击触屏控制器的屏幕唤醒机器。",calibration_7_1:"将螺丝刀插入红光发射器右侧的小孔中，缓慢摆动螺丝刀，直到红色光斑与蓝色光斑重合。",calibration_7_note:"注意：螺丝刀与手切勿挡住红光，否则在底板上无法观察到红色光斑。",calibration_8_1:"重新拧紧红光发射器左侧的螺丝，并插回权限控制钥匙，以确保设备正常工作。",please_carve_first:"请先雕刻校准图案",calibration_finish:"校准完成，若仍有偏差，请在“设备设置”重新校准"}},test_optical_path:{test_optical_path:"光路测试",brief_1:"激光从发射器中经一级反射器、二级反射器，穿过一级光路孔、二级光路孔、三级光路孔到达激光头内部（见图中红色线条部分）。",brief_2:"为了确保激光能够正确到达激光头，需测试激光光束是否正常通过一级、二级和三级光路孔。",brief_2_1:"为了确保激光能够正确到达激光头，",brief_2_2:"需测试激光光束是否正常通过一级、二级和三级光路孔。",brief_3:"调整前需准备美纹纸。",start:"开始光路测试",remove_cover_1:"要测试激光光束是否正常通过一级光路孔，请执行以下操作：",remove_cover_2:"1. 关闭设备电源，拧下后壳螺丝，打开后顶盖及后壳。",remove_cover_3:"2. 启动设备，再次进入此页面，点击“已拆下后壳，下一步”",remove_cover_next:"已拆下后壳，下一步",close_title:"确定要取消光路测试吗？",close_content:"若光路出现偏移可能会导致激光器不出光等问题，建议完成测试确认光路正确后再退出。",close_confirm:"确认取消",close_cancel:"继续光路测试",disconnect_title:"机器已断开连接",disconnect_content:"为确保光路测试结果的准确性，请先重新连接机器后，再进入光路测试。",disconnect_confirm:"确认",level_1:"一级光路孔测试",level_2:"二级光路孔测试",level_3:"三级光路孔测试",level_point_1:"为完成激光光路测试，需要将激光头移动至机器右前方。",click_move_laser_head:"点击移动激光头",cancel_test:"取消光路测试",level_point_2:"取下设备正前方左侧滑盖。完成后进入下一步。",next:"下一步",level_point_3:"在一级光路孔贴一层美纹纸胶带。（如图所示，需用力压出圆孔痕迹）",level_point_4:"完成后进入下一步。",close_lid:"关闭机器盖子，点击激光头出光。",pulse:"激光头出光",level_point_5:"观察激光光束在美纹胶纸上留下的痕迹，选择对应的状态，并点击下一步。",upper_left:"左上方",upper_center:"正上方",upper_right:"右上方",center_left:"正左方",center:"正中方",center_right:"正右方",lower_left:"左下方",lower_center:"正下方",lower_right:"右下方",level_point_6:"找到一级反光镜的位置。",turn_1:"逆时针旋转左上角螺丝45度",turn_2:"顺时针旋转左下角螺丝45度",turn_3:"顺时针旋转左上角螺丝45度，然后顺时针旋转左下角螺丝45度",turn_4:"逆时针旋转左上角螺丝45度，然后逆时针旋转左下角螺丝45度",turn_5:"逆时针旋转左下角螺丝45度",turn_6:"顺时针旋转左上角螺丝45度",level_point_7:"若美纹纸已被烧灼了较大的洞，请更换新的美纹纸贴上后再点击激光头出光。",level_point_8:"先松开镜子周围的三个内六角螺钉（使用L型扳手），但不要拆卸。然后点击下一步。",level_point_9:"激光光束已正确通过一级光路孔！接下来需要测试激光是否正确通过二级光路孔。",level_point_9_1:"激光光束已正确通过一级光路孔！",level_point_9_2:"接下来需要测试激光是否正确通过二级光路孔。",level_point_10:"请在二级光路孔贴一层美纹纸胶带。（如图所示，需用力压出圆孔痕迹）",level_point_11:"完成后进入下一步。",can_not_see:"没有看到激光痕迹？",level_point_13:"注意：可能需要进行多次的调节，直至激光痕迹留着美纹纸圆形压痕正中间才可结束。",adjustment_1:"若未看见激光痕迹，请先尝试多次点击出光。",adjustment_2:"若多次点击出光后仍发现美纹纸上无激光痕迹，则需要将横梁向设备内侧移动，每点击几次“向内移动横梁”后点击出光，如此反复，直至出现激光痕迹。",rail_backward:"向内移动横梁",rail_forward:"向外移动横梁",adjustment_3:"请确认此时横梁是否在最外侧，如果没有，点击下方的“横梁未在最外侧”，横梁将自动移动到最外侧。请再次测试激光是否正确通过二级光路孔，以确保光路调整准确。",not_close_front:"横梁未在最外侧",close_front:"横梁已在最外侧",level_point_14:"激光光束已正确通过二级光路孔！接下来需要测试激光是否正确通过三级光路孔。",level_point_14_1:"激光光束已正确通过二级光路孔！",level_point_14_2:"接下来需要测试激光是否正确通过三级光路孔。",level_point_15:"请在三级光路孔贴一层美纹纸胶带。（如图所示，需用力压出圆孔痕迹）",turn_7:"顺时针旋转左上角螺丝45度，然后顺时针旋转右下角螺丝45度",turn_8:"顺时针旋转右下角螺丝45度",turn_9:"逆时针旋转右上角螺丝45度",turn_10:"逆时针旋转右上角螺丝45度，然后逆时针旋转右下角螺丝45度",turn_11:"顺时针旋转右上角螺丝45度",turn_12:"逆时针旋转右下角螺丝45度",turn_13:"顺时针旋转右上角螺丝45度，然后顺时针旋转右下角螺丝45度",adjustment_4:"若未看见激光痕迹，请先尝试多次点击出光。",adjustment_5:"若多次点击出光后仍发现美纹纸上无激光痕迹，则需要将激光头向左移动，每点击一次“左移激光头”后点击出光，如此反复，直至出现激光痕迹。",laser_left:"左移激光头",laser_right:"右移激光头",ok:"确认",adjustment_6:"请确认此时激光头是否在最右侧，如果没有，点击下方的“激光头未在最右侧”，激光头将自动移动到最右侧。请再次测试激光是否正确通过三级光路孔，以确保光路调整准确。",close_right:"激光头已在最右",not_close_right:"激光头不在最右",test_pass:"光路测试已通过！",enjoy:"请尽情享受您的激光之旅吧！",done:"完成",level_point_16:"找到二级反光镜的位置。",tool_1:"请将左侧的工具准备好",tool_3:"1.5mm L 型扳手（包装自带）",tool_2:"双头螺丝刀（包装自带）",tool_4:"美纹胶（需自备）",tool_5:"准备完毕，下一步",tool_6:"使用螺丝刀",level_point_17:"贴美纹纸",level_point_18:"松开螺丝"}},YVe={device:XVe},qVe={display:{position:"位置",position_x:"X",position_y:"Y",size:"尺寸",size_width:"宽",size_height:"高",rotate:"旋转",rotate_angle:"°",radius:"矩形圆角",lock_aspect_ratio:"比例约束",graphic_setting:"图形设置",graphic_fill:"填充",text_setting:"文字设置",text_input:"文字",text_size:"大小",text_placeholder:"请输入文字",font_family:"字体",letter_spacing:"字间距",filter:"滤镜",sharpness:"清晰度",gray_value:"灰度",color_inverted:"反色",color_inverted_tips:"启用该功能将反转图像的色彩，但彩色图将先转为灰度图再进行色彩反转，可用于预览深色材料的雕刻效果。",color_inverted_link_text:"查看",color_inverted_link_href:"https://s.xtool.com/doc/editor/invert",line_leading:"行间距",text_align:"对齐",text_align_left:"左对齐",text_align_middle:"居中",text_align_right:"右对齐",font_weight:"粗细",font_weight_normal:"常规",font_weight_bold:"粗",font_weight_thin:"细",font_style:"样式",font_style_normal:"常规",font_style_italic:"斜体",proposed_fonts:"xTool推荐字体",local_fonts:"本地字体",text_operations:"操作",text_weld:"焊接"},operation:{undo:"撤销",redo:"重做",extract_contours:"轮廓",extract_contours_inner:"内轮廓",extract_contours_outer:"外轮廓",extract_contours_offset:"偏移距离",extract_contours_generate:"轮廓生成中……",extract_contours_add_inner:"保留位图内部轮廓",batch_create:"阵列创建",batch_create_liner:"方形阵列",batch_create_liner_desc:"快速创建方形阵列",batch_create_radial:"环形阵列",batch_create_radial_desc:"快速创建环形阵列",batch_create_material_test:"材料测试阵列",batch_create_material_test_desc:"快速创建可用于测试材料参数的阵列",auto_layout:"自动排版",shape_match:"智能填充",shape_match_cloud:"(需联网)",shape_match_free_tip:"限时免费",shape_match_net_tip:"智能填充功能需要使用云服务，请先连接网络",smart_filling:"智能填充中",smart_fill_failed:"智能填充失败，了解更多",shape_match_desc:"智能识别相同形状、颜色和规格的材料，批量创建多个相同的设计",align:"对齐",align_left:"左对齐",align_right:"右对齐",align_top:"顶部对齐",align_bottom:"底部对齐",align_vertical:"垂直居中",align_horizontal:"水平居中",align_center:"中心对齐",distributed:"分布",distributed_horizontal:"水平分布",distributed_vertical:"垂直分布",bool:"合并",bool_union:"合并图形",bool_subtract:"排除顶层",bool_intersect:"图形相交",bool_exclude:"排除相交",layer:"排列",layer_up:"上一层",layer_down:"下一层",layer_end:"置为底层",layer_top:"置为顶层",flip:"翻转",flip_horizontal:"水平翻转",flip_vertical:"垂直翻转",zoom:"视图缩放",zoom_adaptive:"适应画布",fit_to_width:"适应宽度",fit_to_height:"适应高度"},mode:{image:"图像",select:"选择",drag:"拖动",graphic:"插入",graphic_circle:"圆形",graphic_rectangle:"矩形",graphic_line:"线条",shape:"形状",text:"文字",pen:"矢量",extract:"提取",import:"AI绘画",bar_code:"条码",qr_code_properties:"二维码属性",qr_code_type:"条码类型",one_dimensional_properties:"一维码属性",qr_code:"二维码",qr_code_desc:"输入文本即可生成条码并添加至你的设计",one_dimensional_code:"一维码",error_rate:"容错率",advanced_options:"高级选项",content:"内容",please_enter_text:"请输入文本信息",please_enter:"请输入字母/数字信息"},context_menu:{cut:"剪切",copy:"复制",paste:"粘贴",delete:"删除",select_all:"全选",zoom_in:"放大",zoom_out:"缩小",group:"组合",ungroup:"取消组合",show_background:"显示背景",hide_background:"隐藏背景",refresh_background:"刷新背景",export_svg:"导出SVG...",make_mask:"创建剪切蒙版",edit_mask:"修改剪切蒙版",release_mask:"释放剪切蒙版",exit_vector_editor:"退出编辑",toggle_lock:"锁定/解锁",toggle_visible:"显示/隐藏",show_invisible:"显示隐藏的元素"},hotkey:{select:"选择模式",pen:"钢笔",circle:"圆形",rectangle:"矩形",line:"直线",zoom_in:"放大画布",zoom_out:"缩小画布"},modal:{batch_create_liner:"阵列创建",batch_create_liner_col_num:"列数",batch_create_liner_col_space:"列间距",batch_create_liner_row_num:"行数",batch_create_liner_row_space:"行间距",batch_create_radial:"环列创建",batch_create_radial_x:"x",batch_create_radial_y:"y",batch_create_radial_start:"起点角度",batch_create_radial_end:"终点角度",batch_create_radial_step:"间隔角度",batch_create_radial_copies:"复制数量",batch_create_radial_rotate_self:"自旋转",batch_create_negative:"取消",batch_create_positive:"创建"},drawer_title:{text:"文字",bitmap:"位图",edit_image:"图像编辑",trace_image:"图像描摹"},image_tracing:{tracing:"图像描摹",aberration_threshold:"色差阈值",noise_ignore:"噪点忽略",smoothness:"平滑度",preview_generating:"预览生成中...",combined_path:"按颜色分层",path_generating:"路径生成中...",hard_to_fill_svg:"当前图片过于复杂，可能导致路径生成失败，请谨慎保存",fail_to_fill_svg:"当前图片过于复杂，生成路径失败，请调整参数或更换图片再次尝试"},image_process:{entry:"图像编辑",tool_cutter:"裁剪",tool_cutter_desc:"选中图片中需要的区域",tool_magic_wand:"魔法棒",tool_magic_wand_desc:"单击图片中需要删除的区域",tool_eraser:"橡皮",tool_eraser_desc:"按住擦除图片中需要删除的区域",attr_aberration:"色差",attr_size:"大小",fit_on_screen:"适应屏幕"},image_filter:{filter:"滤镜"},image_adjust:{adjust:"图像调节"},filter:{null:"原图",grid:"网格化",sketch:"素描",comic:"漫画",emboss:"浮雕",binary:"黑白",attrs:{emboss:{strength:"强度"}}},bitmap_effect:{loading:"效果生成中..."},clip_mask:{editing:{title:"剪切蒙版",desc:"移动半透明位图至剪切蒙版",done:"完成编辑"},make_mask:"创建剪切蒙版",edit_mask:"修改剪切蒙版",release_mask:"释放剪切蒙版"},alert:{shape_match_failed:"智能填充操作失败",connect_device:"请先连接设备",take_picture_first:"请先刷新背景",shape_match_failed_link_href:"https://community.xtool.com/#/making/detail/tips/377",unrecognized_file:"无法识别的文件",unrecognized_file_link_href:"https://community.xtool.com/#/making/detail/tips/96"},layer:{layer:"层",no_layer_yet:"暂无层",move_the_selected_object_to:"将选中对象",move_to:"移至",sure_to_delete:"确定删除层和层中所有的对象吗？",delete_layer:"删除层",mobile_move_the_selected_object_to:"将选中对象移至",layer_object:"层和对象列表",red:"红色",orange:"橙色",yellow:"黄色",green:"绿色",cyan:"青色",blue:"蓝色",purple:"紫色",black:"黑色"},shape:{basic:"基础",plant:"植物",animal:"动物",festival:"节日",border:"边框",other:"其他",parts:"零件",pattern:"图案"},export_svg:{alert_text_conversion:"文字对象将被转换为图形后导出",export_state_processing:"导出中, 请稍候...",export_state_success:"导出成功"},import_svg:{alert_has_text:"该SVG中包含文本内容，暂不支持解析。",more_help:"更多帮助"},object_panel:{object:"对象",parameter:"参数",processing:"加工",design:"设计",quick_actions:"快速操作"},vector:{vector:"矢量",edit_node:"节点编辑",cutting:"剪切",node_type:"锚点类型"},display_list:{title:"对象列表",no_object_yet:"暂无对象"},application_center:{code:"条码生成",title:"应用中心",modal_1:"请先在画布中选中对象",toast_1:"请先在画布中选中一个或多个元素",toast_2:"请先在画布中选中一个元素",toast_3:"只支持选中一个元素，请重新选择",toast_4:"请先连接设备",smart_fill_tip:"当前仅支持M1和P2设备。",fill:"立即填充"},vector_editor:{sharp_corner:"笔直",perfect_symmetry:"完全对称",total_asymmetry:"完全不对称",angled_symmetry:"角度对称"},sticker:{camera_location:"拍照对位",calibration:"粘贴贴纸（1/2）",tip1:"1.拍照对位，即通过移动设备的摄像头拍摄加工区域，并插入画布作为背景使用，以实现加工对象的可视化对位。",tip2:"2.为了确保拍摄的加工区域与画布位置准确对应，请先粘贴贴纸并标定位置再拍摄。",tip3:"提示：粘贴贴纸并校准只需执行一次，如需再次执行，可点击左下角的“贴纸并校准”。",go_calibration:"去贴纸并校准",step1:"按照图示排列顺序，将一组拍照对位贴纸粘贴到设备的加工区域内，不要超出激光器的加工范围。",no_sticker:"还没有贴纸？",next:"下一步",step2:"请拖动激光头，将红十字中心点，按照顺序依次对准贴纸的中心点，单击加工按钮，逐个完成标定。",left_top:"左上",right_top:"右上",left_bottom:"左下",right_bottom:"右下",complete:"完成",location_repeat_error:"同一位置请勿反复标定",calibration_order_error:"请按位置顺序进行标定",focusing:"正在对焦中...",take_photo:"对位拍照",markingPoint:"标定点",step1_title:"粘贴贴纸（1/2）",step2_title:"激光校准（2/2）"}},KVe={editor:qVe},JVe={name:"案例中心",header:{editor:"编辑器",refresh:"刷新"},list:{search_input_placeholder:"搜索案例名称或标签",apply_device_mode:"适用机型",difficulty:"难度",level:"{level}星",processing_type:"加工类别",material_type:"耗材分类",reset:"重置",all:"全部",filter:"筛选条件："},detail:{name:"案例详情页",accomplished_by:"本案例是在 {device}-{power} 机型上完成的。请在相同的机型上使用本案例中的参数设置。如使用其它机型，需对参数设置做相应的调整。",materials:"制作材料",materia_count:"x {count}",support_materials:"辅助材料",precautions:"注意事项",steps:"制作步骤",help_center:"帮助中心",user_guide:"新手引导",expand:"展开",collapse:"折叠",start_project:"开始制作",print:"打印",buy:"商城"},newbie_modal:{title:"HI，新手小白（beginner），我们为您准备了一些适合入门的案例，感兴趣的话点击下方，前往support站浏览详情吧！",no_more_reminders:"我已了解，不再提醒"},error:{no_content:"暂无内容",project_not_view:"当前案例无法查看，前往案例中心浏览更多",network_error:"网络无法连接啦，请检查网络设置。但编辑器部分的功能仍然可以使用。",system_error:"系统异常，请刷新重试"},other:{ok:"好的"}},ZVe={example:JVe},eze={create_project:"点击创建你的项目",connect_device:"在此处切换或连接你的设备",add_project:"在此处添加多个项目",add_canvas:"在此处添加多个画布",add_elements:"在此处向画布添加元素",layer_control:"在此处进行层的控制操作",set_object_attr:"在此处设置对象属性",welcome:"欢迎来到xcs，开始你的激光创作之旅吧",enjoin:"开始你的激光创作之旅吧",learn_again:"在帮助中可再次学习新手引导",start:"开始",skip:"跳过",finish:"开始",inactive:"暂不创建",prev:"上一步",next:"下一步",done:"完成",feature_1:"界面改版",feature_2:"新设计功能",feature_3:"多任务&多设备",feature_4:"加工预览"},tze={guide:eze},nze={header:{open_local_proj:"打开本地项目",new_proj:"创建新项目"},title:"主页",xtool_projects:"案例中心",to_shop:"前往商城",my_space:"我的空间",recent:{title:"最近打开",new:"新建项目",open:"打开",remove:"移除",show_local:"在文件夹中显示",file_notfound:"无法找到该文件，该文件可能已被移除或移至其他存储位置"},recommended:{title:"为你推荐",more:"查看更多",buy:"购买&使用",detail:"查看详情",open_to_editor:"在编辑器中打开",not_error:"网络连接错误",net_error_desc:"连接到互联网并访问超过 2000 个为您量身定制的项目",reload:"重新加载",bad_connection:"网络连接错误",is_file_opening:"正在打开上一份文件，请稍后再试",file_open_error:"文件打开失败"}},ize={home:nze},rze={bar:{connect:"连接设备",framing:"走边框",process:"加工",back:"返回",preview:"加工预览",start_processing:"开始",cancel:"取消",pause:"暂停",minimize:"最小化",redo:"再次加工",continue:"继续",confirm:"确定",complete:"完成",settings:{new_construction:"新建项目",open_project:"打开项目",rename_project:"项目重命名",save:"保存",export_as_svg:"导出SVG",view_gesture_guidelines:"手势指引",help_center:"帮助中心",newbie_guid:"新手引导",import_custom_parameters:"导入自定义参数",export_custom_parameters:"导出自定义参数"}},common:{iknow:"我已知晓",confirm:"确认",cancel:"取消",notice:"提示",yes:"是",no:"否",save:"保存",not_import:"加工中不支持切换文件",not_import_notice:"当前页面暂不支持导入文件",failed_to_open_file:"文件打开失败"},home:{cache_notice:`检测到上次有未保存的编辑
是否要继续编辑？`,continue_cache:"继续编辑",abandon_cache:"放弃",not_support_mode:"项目文件中存在不支持的加工模式，打开后仅会保留画布内容。确认是否继续打开",not_support_mode_title:"加工模式不支持",not_support_mode_process:"当前模式暂不支持加工",not_support_mode_framing:"当前模式暂不支持走边框",user:{points_history:"积分记录",user_setting:"帐号设置",logout:"退出登录",no_network:"网络异常，请稍后重试"},my_project:{my_project:"我的项目",new_project:"创建新项目",share:"分享",upload:"上传云空间",copy:"复制",rename:"重命名",delete:"删除",share_fail:"分享失败",share_success:"分享成功",seconds_ago:"秒前",minutes_ago:"分钟前",hours_ago:"小时前",days_ago:"天前"},recommended:{details:"查看详情",open:"在编辑器中打开",more:"查看更多",bad_network:"网络连接错误",tip_connect:"连接到互联网并访问超过 2000 个为您量身定制的项目",reload:"重新加载"},slider:{login:"登录",home:"主页",space:"我的空间",xtool_projects:"案例中心",settings:"设置",shop:"前往商城"},help:{help:"帮助中心",beginner_guide:"新手引导"},project:{name:"我的项目",future_project:"未来项目",create:"新建项目",local:"本地项目",cloud:"云空间项目",quick_copy:"快速复制",cloud_used:"已用文件数",rename:"重命名",download:"下载到本地",share:"分享",delete:"删除",delete_title:"删除",delete_content:`确认删除项目“{name}”吗？
删除后不可被恢复。`,album:"照片",save_temp_project:"是否保存项目{name}？"},community_new:{name:"案例",how:{title:"Curated Projects",des_v:"1000+ projects with free design files and tutorials."},tips:{title:"By Machine",des_v:"Discover projects created for your machine."},inspiration:{title:"By Material",des_v:"Let materials guide your creativity! "}},support:{name:"支持",quick_start:"快速入门",video:"视频教程"},shop:{name:"商城",accessory:"配件",consumable:"耗材"},restart_xcs:"重启软件生效",vector_fill:"显示图形填充状态",setting:"设置",privacy:"点击查看隐私协议",privacy_notice_title:"软件相关条款",privacy_notice_content:"感谢您选择使用Creative Space！</br>我们将通过{privacy_policy}、{user_policy}和{safe_policy}帮助您了解我们为您提供的服务，及收集、处理您个人的信息的方式。</br>点击【同意并继续】代表您已同意前述及以下约定。",privacy_full:"点击查看完整版",privacy_policy_des:"《服务条款》",user_policy_des:"《隐私政策》",safe_policy_des:"《安全使用条款》",and:"和",feedback:"我要反馈",tap_to_see:"点击查看{user_policy}、{privacy_policy}和{safe_policy}",accept:"接受并继续",decline:"不接受",disagree:"不同意",agree:"同意",accept_agree:"同意并继续",bar_home:"主页",add_projects:"添加新项目",create_project:"添加新项目"},gesture:{title:"手势",select:"选择",multiple_select:"多选",rotate:"旋转",move:"移动元素",more:"元素菜单",zoom:"放大/缩小画布",move_canvas:"移动画布",more_canvas:"画布菜单"},editor:{header:{home:"返回",setting:"设置",connected:"已连接",not_connect:"去连接",editor:"编辑"},layer:{color:{red:"红色",green:"绿色",blue:"蓝色",yellow:"黄色",purple:"紫色",cyan:"青色",orange:"橙色",black:"黑色"},no_layers:"暂无层",sure_to_delete:"确定删除层和层中所有的对象吗？"},current_mode_not_support:"当前模式暂不支持加工，但仍可查看和编辑画布内容",save_notice_title:"是否保存项目{name}？",camera:"拍照",album:"相册",file:"文件",process_notice:"请勿锁屏或将xcs放到后台，否则可能会导致设备断连，引起加工异常",camera_title:"相机权限未开启",camera_content:`请在"设置>Creative Space"选项中，
允许访问你的摄像头`,go_system_setting:"前往设置",know:"我知道了",canvas:"画布",import_material_no_match_title:"材料参数不适用",import_material_no_match:"材料参数不适用于当前加工模式，应用该参数后会切换到相应加工模式。确认要应用吗？",multi_canvas:{delete_canvas:"删除操作不可撤销，确定删除该画布吗？",delete_canvas_title:"提示",confirm:"确认"},intelligent_adsorption:"智能吸附",gesture_guidance:"手势指引",view:"查看",accurate_hit_restart:"该功能需要重启APP后生效",restart:"确认重启",select_take_local_img:"请将取景框拖到目标拍照区域",select_precise_measure:"请将取景框拖到目标测量区域",layout:"布局",loosing_text:"释放即可刷新...",quality:"质量",save_success:"保存成功",save_fail:"保存失败",graphics_curves_quality:{title:"矢量图形质量",option_best:"最佳：",option_best_desc:"适合加工>20英寸的图形，处理速度一般",option_high:"高：",option_high_desc:"适合加工10-20英寸的图形，处理速度较快",option_medium:"中：",option_medium_desc:"适合加工<10英寸的图形，处理速度快",take_effect_tips:"该设置将对新导入的图纸生效。"},vector_part:{vector:"矢量",edit_node:"节点编辑",done:"完成编辑",sharp_corner:"锐角",perfect_symmetry:"完美对称",total_asymmetry:"完全不对称",angular_symmetry:"角度对称"},bottom:{multiple_choice_mode:"多选模式",append:"添加",text:"文字",pen:"矢量",shape:"形状",graffiti:"涂鸦",x_art:"AI绘画",expand_application:"应用中心",revocation:"撤销",redo:"重做",position_shot:{shot_title:"拍照对位",hide_background:"隐藏背景",display_background:"显示背景",calibrate:"贴纸并校准"}},tips:{text:"文字编辑",basic_operation:"基础操作",more:{delete:"删除",size_locking:"尺寸锁定",size_not_locked:"尺寸不锁定",fast_replication:"快速复制"},edit_node:"编辑节点"},extent:{grid_description:"快速创建方形阵列",circular_description:"快速创建环形阵列 ",material_description:"快速创建可用于测试材料参数的阵列",code_description:"输入文本即可生成条码并添加至你的设计",fill_description:"智能识别相同形状、颜色和规格的材料，批量创建多个相同的设计"},smart_fill:{fail_toast:{tap_here:"点击此处",desc:"智能填充失败，{tap_here}了解更多。"},shape_match_desc:"智能识别相同形状、颜色和规格的材料，批量创建多个相同的设计。"},open_xcs_file_error:"无法识别的文件",lock_aspect_ratio:"锁定宽高比例",unlock_aspect_ratio:"解锁宽高比例",loss_fonts:"文件使用了当前系统不支持的字体格式，已替换为默认字体。",loss_fonts_description:"画布使用了当前系统不支持的字体格式，请选择处理方式："},connect:{device_idel:"确保设备处于空闲状态",add_new_device:"配置Wi-Fi",help_title:"连接帮助",help_notice_one:"1.请确认设备已开启",help_notice_two:"2.请确认设备配置过网络",help_notice_three:"3.请确认设备连接的网络已经开启，且未更换密码",help_notice_four:"4.请确认iPad没有开启VPN",reset_notice:"如果确认上述操作，设备仍然无法连接，请{reset}",reset:"点击重置设备",reset_title:"开启设备热点",reset_notice_device:"长按设备按钮，直到指示灯变为{color}，需要在设备闲置状态下操作。若已是{color}，则直接点击【已确认，下一步】按钮",reset_notice_slow_flashing:"长按设备按钮，直到指示灯变为{color}慢闪",reset_notice_light:"长按设备按钮，直到指示灯变为{color}，需要在设备闲置状态下操作。若已是{color}，则直接点击【已确认，下一步】按钮",reset_notice_gs002:"若设备屏幕上显示了“AP”图标，请直接进行下一步。若没有“AP”图标，请长按设备加工按钮5s，直至显示此图标。",reset_notice_device_f1:`1、设备连接电源 
2、长按设备按钮5s，直至指示灯变成{color}，重置成功进入配网状态。`,blue_white:"白色或蓝色",green:"绿色闪烁",white:"白色闪烁",yellow:"黄色",purple:"紫色闪烁",solid_yellow:"黄色常亮",confirm_next:"已确认，下一步",select_wifi:"选择Wi-Fi",wifi:"Wi-Fi",no_wifi:"无法获取当前Wi-Fi，请尝试手动输入或检查是否开启定位权限",not_support_wifi:"暂不支持接入该热点",placeholder_wifi:"请输入Wi-Fi",placeholder_wifi_name:"请输入Wi-Fi名称",placeholder_password:"请输入密码",connect_wifi:"设备需要连接与iPad相同的Wi-Fi",wifi_notice:"此设备只支持使用2.4G Hz Wi-Fi",remember_password:"记住密码",select_connect_device:"连接设备热点",connect_device_wifi:"请将iPad Wi-Fi连接到{deviceName}设备发出的热点，{wifiPwd}连接后返回App ",connect_wifi_pwd:'密码为"12345678"，',go_wifi_setting:"去连接设备热点",connection_completed:"确认已连接",setting_wifi:"配置Wi-Fi",transmit_to_device:"传输信息给设备",device_connect_wifi:"设备连接Wi-Fi",device_connected:"配置完成",connected_notice:"请到设备列表页，选择对应的设备进行连接。若未找到设备，请再次重试配置Wi-Fi流程",check_net:`请检查网络
`,check_device_open:"请保持设备开启状态",no_internet:"无法搜索和连接设备，请去设置-Creative Space中开启本地网络权限",location_access_needed:"权限请求",go_to_open:"去开启",select_device:"选择设备",select_device_notice:"选择你要配置Wi-Fi的设备型号",wifi_set_completed:"配置完成，请在连接设备页面选择连接此设备",go_to_connect:"去连接",yes:"是",make_sure_is_same_wifi:"确保你的设备和iPad在同一个Wi-Fi下",go_to_setting:"去设置",idle_notice:"需在设备闲置状态下操作。若已是{color}，则直接点击【已确认，下一步】按钮",firmware_notice:"注意：固件版本过低可能会导致无法正常使用配网功能，若反复配网失败，请先通过PC端XCS更新到最新固件后重试",get_more_help:"获取更多帮助",change_password:"修改密码",wifi_name:"Wi-Fi名称",wifi_password:"密码",placeholder_new_password:"请输入密码",placeholder_confirm_password:"再次确认密码",please_enter_password_tip:"请输入8-16个字符",modify_device_name:"修改设备名称",modify_device_name_dialog_tip:"修改设备名称后会触发一次断连，需要手动连接一次设备",hotspot_config_wifi:"修改Wi-Fi配置",hotspot_config_wifi_header_tip:"请手动输入Wi-Fi名称和密码，完成Wi-Fi配置",hotspot_config_wifi_header_tip_new:"请选择 Wi-Fi 网络并输入密码",hotspot_config_wifi_dialog_tip:"配置Wi-Fi后会触发一次断连，需要重新手动连接一次设备。",hotspot_config_wifi_btn_tip:"手动输入",hotspot_config_wifi_list:"Wi-Fi列表",refresh:"刷新",modify_password_header_tip:"修改密码后，将以新的密码连接加密设备",modify_password_dialog_tip:"修改密码后会触发一次断连，需要手动连接一次设备",hotspot_config_success:"wifi配置成功",hotspot_config_fail:"wifi配置失败",modify_password_success:"密码修改成功",modify_password_fail:"密码修改失败",modify_password_no_support:"暂不支持修改Hotspot密码",password_inconsistent_tip:"你两次输入的密码不一致，请检查后再次输入",device_selected:"当前设备",device_available:"可切换设备",delete_device:"删除设备",disconnect:"断开",connect:"连接",connected:"已连接",not_connect:"未连接",processing:"加工中",not_connectable:"暂未发现可连接的WiFi设备",device_pop:"打开项目会自动匹配符合项目的当前设备，您可以选择其他设备来更换当前设备。"},graffiti:{name:"涂鸦",cancel_title:"确认取消本次涂鸦",cancel_content:"取消后，所有绘制内容将不会保留",continue_editing:"继续编辑",pen_width:"笔刷尺寸",erase_width:"橡皮尺寸"},g_code_err:"生成预览图超时，请返回再重试",notice:{error:"网络无法连接，请检查网络设置",empty:"暂无内容，请先到本地项目点击“{icon_add}”手动上传",remaining_free_count_tip:"空间不够用？了解更多云空间信息",view:"查看"},cloud_file:{success_text_:"刷新成功",fail_text:"刷新失败",pulling_text:"下拉即可刷新...",loosing_text:"释放即可刷新...",loading_text:"加载中...",uploading:"正在上传...{progess}%",upload_success:"文件上传成功",upload_cancel:"文件上传成功",upload_error:"文件上传失败",upload_other:"有任务上传中，请稍等",upload_this:"该任务正在上传中，请稍等",upload_limit:"可用云空间已达到上限，请先清理不需要的文件后，再重新上传新的文件。",upload_limit_title:"云空间不足",download_success:"文件下载成功",download_error:"文件下载失败",download_other:"有任务下载中，请稍等",download_this:"该任务正在下载中，请稍等",open_file_in_cloud:"打开文件不会修改云空间内的文件",downloading:"下载中...",used_files_:"已用文件数",used_files_tip_content:"空间不够用？了解更多云空间信息",upload_file:"上传文件",upload_file_empty_:"当前内容为空，请上传",rename:"重命名",download:"下载到本地",delete:"删除",delete_content:`确认删除项目“{name}”吗？
删除后不可被恢复。`,file_download_succeeded:"文件下载成功",file_download_failed:"文件下载失败",file_download_cancel:"文件下载取消",try_it_now:"立即尝试",non_login_title_1:"安全",non_login_content_1:"由Azure云服务提供支持，安全、持久且具有高可用性",non_login_title_2:"高效",non_login_content_2:"可随时访问和存取文件，极大地提升了创作效率",non_login_title_3:"多端协同",non_login_content_3:"只需一个xTool账号，即可在多终端XCS进行文件和数据同步",refresh:"刷新",bad_network:"网络连接错误"},rate:{title:"你做得很棒！",rate_content:"你喜欢刚才的DIY过程吗？",help_improve:"不，去吐槽",rate_it:"去点赞",help_to_improve_title:"请告诉我们如何改进？",improve_blank_tips:"如有必要，请附上邮箱便于联系你",submit:"提交",submit_success:"提交成功",submit_fail:"提交失败，请检查网络"},process:{scale_down:"缩小",scale_up:"放大",scale_back_to_origin:"回到原点",calculate_gcode_tip:"正在生成预览画面…",remaining_time:"剩余时间：",estimated_time:"预估总时长：",processed_hours:"本次加工耗时：",laser_trajectory:"移动路径",laser_trajectory_content:"激光头仅移动不加工的路径",processing_path:"加工路径",processing_path_content:"激光头实际加工的路径",laser_position:"激光头位置",laser_position_content:"激光头所在位置",calculating:"计算中...",calculating_new:"计算中",total_time_estimated:"预估总时长",speed:"倍速",process_top_tip:"请勿在无人值守的情况下进行加工",process_safe_top_tip1:"检测到您还未完成激光安全培训，操作激光加工可能存在安全风险，",process_safe_top_tip2:"请前往参加激光安全培训",sending_the_file:"加工文件发送中 ",ready:"就绪",process_ready_modal_tip:"点击设备上的“按钮”开始加工",process_ready_tip1_f1_ultra:"请点击触屏控制器上的“xtool”按钮开始加工。为了避免火灾风险，请谨慎加工易燃材料。",process_ready_tip1:"请点击机器上的按钮开始加工，为了避免火灾风险，请谨慎加工易燃材料。",process_ready_tip2:"请勿锁屏或将xcs放到后台，否则可能会导致设备断连，引起加工异常",process_processing:"正在加工",process_paused:"加工暂停",process_complete:"加工完成",process_canceled:"加工取消",process_disconnect:"设备断开了连接",process_disconnect_tip:"请持续关注设备的加工情况,如需控制设备，请在机器上进行",process_burned_tip_f1_ultra:"加工金属或加工时间较长（如浮雕），小心材料烫手",back_up_file:{file_name:"文件名称",back_up_file:" 备份文件",back_up_file_to_device:"备份到机器“本地文件”",modal_tip_content:"将文件备份到机器的“本地文件”空间，可以在机器屏幕上查看并进行离线加工。",toast_loading:"正在备份文件",toast_success:"文件备份成功",toast_fail:"文件备份失败"},camera:{view_processing_status:"远程查看",save:"保存"}},tasks:{tab_in_processing:"加工中",tab_task_history:"历史任务",processing_empty:"无加工中任务",history_empty:"无历史任务",move_to_task_history:"移入历史任务",connect_again:"重新连接",open_file:"打开文件",pause_:"暂停",continue_:"继续",cancel_:"取消",status_text_interrupted:"中断于 ",status_text_finished:"完成于 ",status_text_processing:"正在加工",status_text_paused:"已暂停",time_remaining:"剩余时间 ",time_takes:"耗时 ",cancel_tip_content:"确定取消加工任务？",remove_tip_title:"删除加工任务",remove_tip_content:"确定删除此加工任务吗？",history_tip_content:"只能保留20个最近的历史任务。当超过时，最旧的历史任务将被自动清除。",interrupted_tip_content:"若当前设备仍在加工但显示设备断连时，重连设备可以恢复加工控制！30分钟不处理将移入历史任务但不影响设备的正常加工。",task_first_tip_content_:"加工任务已收到任务列表",connect_again_success:"设备连接成功",connect_again_failed:"设备连接失败，请重试！",connect_again_failed_fix:"如何解决",file_not_exist:"找不到文件"},guide:{create_project:"点击创建你的项目",connect_device:"在此处切换或连接你的设备",add_project:"在此处添加多个项目",add_canvas:"在此处添加多个画布",add_elements:"在此处向画布添加元素",layer_control:"在此处进行层的控制操作",set_object_attr:"在此处设置对象参数",welcome1:"欢迎来到xcs，",welcome2:"开始你的激光创作之旅吧",enjoin:"开始你的激光创作之旅吧",learn_again:"在帮助中可再次学习新手引导",view_again:"点击菜单可再次打开新手引导",start:"开始",skip:"跳过",finish:"开始",inactive:"暂不创建",prev:"上一步",next:"下一步",done:"完成",feature_1:"界面改版",feature_2:"新设计功能",feature_3:"多任务&多设备",feature_4:"加工预览"},firmware:{downloading:"正在下载固件，当前 {percent}%",uploading:`正在更新固件
当前{percent}%,请耐心等待，不要关闭设备`,succeeded:"恭喜，固件升级成功！",need_update_firmware:"发现新的固件版本 {latestVersion}"},dialog:{cancel:"取消",confirm:"确定",got_it:"我知道了",view:"查看",information:"Information",tips:"提示",complete:"完成",fill:"立即填充",save:"保存",create:"立即创建"},tips:{select_file:"选择文件",cancel:"取消"},safety:{safety_title:"安全培训",click_to_learning:"点击前往【安全培训】",safety_training_tip:"当前连接设备为四类激光机器。根据法律法规的要求，您需要参加并完成激光安全培训以保护您的个人安全。",safety_always_tip:"检测到您还未完成激光安全培训，操作激光加工可能存在安全风险，",safety_always_tip_link:"请前往参加激光安全培训",login_learning_complete:"登录成功，您当前帐户已完成激光安全培训课程！",training:"前往"},parameter_panel:{user_guide:"请点击参数面板进行参数设置"},measure:{measure_surface_first:"请先进行曲面测量"}},sze={ipad:rze},oze={common:{loading:"加载中...",create_project:"创建项目",add_project:"新建项目",my_project:"我的项目",photo:"拍照",photo_album:"相册",save_notice_title:"是否保存项目?",yes:"是",no:"否",confirm:"确认",save:"保存",saving:"保存中...",save_success:"保存成功",save_fail:"保存失败",cancel:"取消",back:"返回",notice:"提示",local_network_title:"“xTool”想访问你的本地网络",local_network_tip:"请在设置中开启授权，以保证正常连接设备",go_to_setting:"去设置",not_yet:"暂不",update_now:"立即更新",privacy_policy:"软件相关条款",app_latest:"当前软件版本已是最新版",check_update_fail:"检测更新失败，请检查网络",agree_and_continue:"同意并继续",disagree:"不同意",accurate_location_title:"“xTool”想访问你的精确位置",accurate_location_tip:"设置精确位置，以保证搜索附近的设备",accurate_permission_on:"允许开启精确位置",discovered_new_version:"发现新版本",app_version:"软件版本",about:"关于软件",about_software:"关于XCS",privacy_policy_des:"《隐私政策》",user_policy_des:"《服务条款》",safe_policy_des:"《安全使用条款》",privacy_policy_detail:"感谢您选择使用Creative Space！我们将通过{user_policy}、{privacy_policy}和{safe_policy}帮助您了解我们为您提供的服务，及收集、处理您个人的信息的方式。点击【同意并继续】代表您已同意前述及以下约定。",input_effective_range:"有效范围",check_for_updates:"正在检查更新...",iknow:"我已知晓",points_history:"积分历史",person_setting:"设置",person_login:"登录",person_logout:"退出登录",current_software_version:"当前软件版本",current_firmware_version:"当前固件版本"},connect:{connect_tip:"同一Wi-Fi下，搜索到的设备，请选择",select_device:"选择设备",add_new_device:"添加新设备",quick_connect:"快速连接",confirm_and_connect:"确认并连接",save_and_connect:"保存并连接",ignored_this_time:"本次忽略",enter_psw:"输入密码",set_psw:"设置密码",forgot_password:"忘记密码？",device_not_found:"找不到目标设备",hotspot_connect:"关于Hotspot",click_here:"点击此处以连接",first_connect:"首次使用直连功能连接设备，建议先设置密码，以获得更好的使用体验。",encryption:"此直连设备已加密，需要先输入正确的密码，才可以接入。",ios_reason:"由于系统权限的原因，需要打开系统设置->无线局域网，手动选择目标设备发出的热点，完成连入后返回APP。",to_enable:"允许",location_permission_tip:"为了确保Hotspot功能可以正常使用，请确认已经开启了APP的精确定位权限。",connetct_popup:"使用Hotspot模式连接时无法访问互联网，适合在室外场景脱离路由器使用。",not_hotspot:"长按加工按钮5s，当按钮颜色变化后松手，即可进行Wi-Fi和Hotspot连接方式之间的切换。",learn_more:"了解更多",go_connect:"去连接",switch:"切换",switch_devices:"切换设备",no_device:"找不到目标设备？长按设备的加工旋钮5秒灯效变化后，可进行连接模式的互相切换。",ip_connect:"IP连接",help:"帮助",connect_loading_tip:"正在连接...",connect_success:"连接成功",device_step_tip_one:"1、设备连接电源;",device_step_tip_two:"2、长按设备按钮5s，直至指示灯变成{preLightColor}，重置成功，进入配网状态。",device_f1uitra_step_tip_two:"2、若设备屏幕上显示了'AP'图标，请直接进入下一步。若没有‘AP’图标，请长按设备加工按钮5s，直至显示此图标。","device-connect-tip":"检查设备是否处于网络配置状态",connect_success_tip:"如果连接成功您的设备电源会呈现白色闪烁状态",connect_fail_tip:"如果连接失败您的设备电源会呈现黄色闪烁状态",connect_d1pro_success_tip:"连接完成，请确认指示灯是否变为{successLightColor}，设备指示灯呈现{successLightColor}即为连接成功，否则为连接失败",connect_mobile_tip:"将手机与设备尽量靠近",connect_success_tip_title:"请确认指示灯是否变为{successLightColor}",connect_success_tip_desc:"如果指示灯没有变{successLightColor}, 意味着配置失败，请点击“重试”..",send_info_to_device:"传输信息给设备",connect_wifi:"设备连接Wi-Fi",setting_wifi:"去设置Wi-Fi",setting_wifi_ap:"去配置Wi-Fi",not_open_wifi:"Wi-Fi未连接",not_open_wifi_tip:"请连接Wi-Fi，以便正常连接设备。",mobile_connect_xtool_hot_spot:"1、请将手机Wi-Fi连接到{selectedDevice}热点",mobile_connect_xtool_hot_spot_new:"1、请将手机Wi-Fi连接到{device}设备发出的热点",connect_wifi_pwd:'密码为"12345678"',back_to_app:"2、返回app",connect_wifi_tip:"请先连接Wi-Fi",wifi_support_tip:"此设备只支持使用2.4G Hz Wi-Fi连接使用",wifi_name:"名称",wifi_password:"密码",change_password:"修改密码",placeholder_password:"请输入密码",placeholder_again_password:"再次确认密码",remember_password:"记住密码",wifi_name_error:"Wi-Fi 名字错误！",wifi_pwd_error:"Wi-Fi 密码错误！",permission_gps_title:"为了能够自动获取Wi-Fi信息，请允许我们访问位置权限及开启GPS",permission_gps_title_hotspot:"为了确保热点功能能够正常使用，请确认 APP 的精确定位权限已经开启",permission_gps_info:"允许访问位置信息",permission_gps_on:"允许开启GPS",permission_on:"去启用",permission_gps_off:"您如果不想开启权限，您可以通过以下方式操作:",hand_input_wifi:"手动输入Wi-Fi信息连接",make_sure_is_same_wifi:"确保你的设备和手机在同一个Wi-Fi下",find_device_in_the_same_wifi:"正在寻找同网络下的设备…",connect_device_step_1:"1、请确保设备已开启；",connect_device_step_2:"2、设备需要与手机处于同一网络中；",connect_device_step_3:"3、完成 1、2 步骤后，点击“刷新”按钮。",connect_hotspot_step_1:"1、请确保设备已开启，并处于Hotspot（AP）模式；",connect_hotspot_step_2:"2、长按设备的加工按钮5s，可进行连接模式的互相切换。",go_to_setting_tip:"为了能够自动获取当前Wi-Fi信息，请在【设置】中打开【隐私】，并打开【定位服务】",open_gps_permission:"为了设备的正常使用，请开启本地网络权限",connect_xtool_hot_spot_error:"请连接正确的设备热点",pre_light_color_white:"白色闪烁",pre_light_color_green:"绿色闪烁",pre_light_color_purple:"紫色闪烁",pre_light_indicator_color_yellow:"黄色闪烁",pre_light_color_yellow:"黄色常亮",success_light_color_white:"白色常亮",success_light_color_green:"绿色常亮",success_light_color_blue:"蓝色常亮",success_light_color_blue_white:"白色或蓝色常亮",success_light_color_purple:"紫色常亮",d_connect_notice:"注意：固件版本过低可能会导致无法正常使用配网功能，若反复配网失败，请先通过PC端XCS更新到最新固件后重试",wifi_name_not_support:"暂不支持接入该热点",placeholder_new_password:"请输入密码",placeholder_confirm_password:"再次确认密码",please_enter_password_tip:"请输入8-16个字符",device_name:"设备名称",modify_device_name:"修改设备名称",modify_device_name_dialog_tip:"修改设备名称后会触发一次断连，需要手动连接一次设备",hotspot_config_wifi_header_tip:"请手动输入Wi-Fi名称和密码，完成Wi-Fi配置",hotspot_config_wifi_header_tip_new:"请选择 Wi-Fi 网络并输入密码",hotspot_config_wifi_dialog_tip:"配置Wi-Fi后会触发一次断连，需要重新手动连接一次设备。",hotspot_config_wifi_btn_tip:"手动输入",hotspot_config_wifi_list:"WI-FI列表",hotspot_config_no_wifi_list:"暂未发现可连接的Wi-Fi设备，请尝试刷新",refresh:"刷新",modify_password_header_tip:"修改密码后，将以新的密码连接加密设备",modify_password_dialog_tip:"修改密码后会触发一次断连，需要手动连接一次设备",hotspot_config_success:"Wi-Fi配置成功",hotspot_config_fail:"Wi-Fi配置失败",modify_password_success:"密码修改成功",modify_password_fail:"密码修改失败",modify_password_no_support:"暂不支持修改Hotspot密码",password_inconsistent_tip:"你两次输入的密码不一致，请检查后再次输入",try_update_firmware:"固件版本较低，请升级到最新固件后重试"},toast:{connect_device_first:"请先连接设备",device_not_supported:"暂不支持此机型！",camera_not_authorized:"“xTool”想访问你的摄像头",camera_not_authorized_text:"请在设置中开启授权，以保证正常使用拍照相关功能。",current_position_out_of_processing_range:"当前激光头位置超出可加工范围",fail_to_get_position:"获取失败，请等待"},device:{select_material:"材料",processing_mode:"加工模式",processing_type:"加工类型",xtool_selected_setting:"参数设置",filter:"筛选",device_details:"设备详情",device_setting:"设备设置",device_model:"设备型号",connect_device:"连接设备",enter_canvas:"点击进入编辑/参数设置",start_processing:"开始加工",file_save_as:"将文件另存为",file_save:"将文件保存为",input_file_name:"请输入文件名称",device_not_connected:"设备未连接",camera_photo_tip_1:"借助手机的摄像头完成拍照并插入画布，帮助更好地对位",camera_photo_tip_1_pad:"借助ipad的摄像头完成拍照并插入画布，帮助更好地对位",camera_photo_tip_2:"使用前，需要底板带有辅助对位的丝印图案，帮助算法识别和矫正",camera_photo_tip_3:"如果你已有底板，可直接开始拍照。如果没有则需",camera_photo_tip_link:"先去自制",camera_photo_tip_ps:"该功能会切换开始位置为绝对坐标",device_process_type:"开始位置",device_relative_position:"相对坐标",device_absolute_position:"绝对坐标",device_zero_point_title:"激光头正在返回原点",device_zero_point_tip:"开始加工前，激光头需要完成回原点，请耐心等待。",device_zero_point_walk_board_tip:"走边框前，激光头需要完成回原点，请耐心等待。",process_path_by_auto_desc:"自动规划: 先雕后切，效率优先",process_path_by_layer:"按层排序",process_path_by_layer_desc:"按层排序: 按层顺序从上向下加工",laser_head_return_tip:"激光头正在回原点，请稍后操作",shoot_background:"拍照对位参数",m1_preview_check_tip:"当前为{mode}加工模式，请确认{what}和{head}头已放置在{where}上",process_diagram:"加工头示意图",process_check:"加工检测",process_board:"加工底板",unable_to_detect_cutting_board:"当前无法检测到刀切板，请安装。",process_header:"加工头：",process_header_checked_info:"当前加工头和所选加工模式不匹配，请更换。",process_preview_check_again:"再次检测",laser_head_exception:"激光头异常",base_plate_exception:"底板异常"},process:{set_up:"设置",return_item:"返回项目",return_home:"返回首页",elapsed_time:"已使用时间",go_canvas_adjustment:"前往画布调整",current_mode_not_support:"当前模式暂不支持加工，但仍可查看和编辑画布内容",mode_not_support:"当前模式暂不支持加工",diameter_empty:"材料直径为空会造成加工效果异常",task_disconnect:"设备已断连，请重新连接",task_restored_connect:"设备连接已恢复","processing-setting":"加工设置",before_process_default_data_tips_content_m1:"检测到有元素的刀压参数为{cutPressure}g，前往加工会影响效果，请调整参数"},material:{no_more:"没有更多了",pulling_text:"下拉即可刷新...",loosing_text:"释放即可刷新...",loading_text:"加载中...",confirmed:"确认"},projects:{open_system_file:"从系统文件导入",rename_title:"项目重命名",dialog_open_file_error:"打开失败，请打开{fileType}格式文件",dialog_delete_title:"删除项目",dialog_delete_msg:"是否删除该项目？删除后无法恢复",share:"分享",unsave_project:"有未保存的作品",cache_notice:"检测到上次有未保存的作品，是否要继续编辑？",copy_success:"复制成功",rename_success:"重命名成功",delete_success:"删除成功",open_xcs_file_error:"无法识别的文件",continue_cache:"继续编辑",abandon_cache:"放弃",processing_open_file_error:"加工中不支持外部打开文件",not_support_open_file:"当前页面暂不支持导入文件",not_support_import_file:"不支持该文件类型的导入",local_project:"本地项目",cloud_project:"云空间项目",my_projects:"我的项目",no_login_cloud:"需要登录才能使用云空间",sign_in_now:"立即登录",no_network:"网络无法连接，请检查网络设置",used_file_num:"已用文件数",not_enough_space:"空间不够用？",not_enough_space_link:"了解更多云空间信息",cloud_project_empty_left:"暂无内容，请先到本地项目",cloud_project_empty:"当前内容为空，请上传",cloud_project_empty_tap:"点击",cloud_project_empty_right:"手动上传",cloud_project_empty_rightnow:"立刻上传",local_project_uploading:"有上传任务中，请稍等",local_project_uploading_disable:"该任务正在上传中，请稍等",local_project_empty:"暂无内容，请创建",project_upload_success:"文件上传成功",project_upload_fail:"文件上传失败",project_download_success:"文件下载成功",project_upload_cancle:"取消上传...",project_uploading:"文件上传中...",project_download_fail:"文件下载失败",cloud_project_download:"下载到本地",cloud_project_downloading:"文件下载中...",cloud_project_downloading_other:"有任务下载中，请稍等",cloud_project_downloading_self:"该任务正在下载中，请稍等",cloud_project_space_limit:"可用云空间已达到上限，请先清理不需要的文件后，再重新上传新的文件。",cloud_project_space_limit_tips:"云空间不足",project_delete_failed:"删除失败",project_rename_failed:"重命名失败",project_opening:"打开中...",project_open_failed:"打开失败,请重试",dialog_open_project:"打开",dialog_download_project:"下载到本地",dialog_rename_project:"重命名",dialog_upload_project:"上传云空间",dialog_share_project:"分享",dialog_delete_project:"删除",dialog_copy_project:"复制"},about:{protocol_user:"服务条款",protocol_privacy:"隐私政策",safe_privacy:"安全使用规范",contact:"联系我们",not_update:"当前已是最新版本",need_update:"已有新版本，点击更新",privacy_policy:"隐私政策"},editor:{panel:{main:{snapshot_preview:"拍照对位",image:"导入图像",text:"文字",shape:"插入图形",graffiti:"涂鸦",layer:"层",canvas:"画布",setting:"加工设置"},basic:{design:"设计",parameter:"参数"},design:{outline:"轮廓",copy:"复制",lock:"比例约束",un_lock:"比例约束",delete:"删除",quick_title:"快速操作",basic_title:"编辑"},edit_canvas:{done:"完成"}},processing_setting:"参数设置",image_process:"图像处理",font_setting:"文字设置",display_attrs:"编辑",import_image:"导入图像",insert_fonts:"文字",insert_graphics:"插入图形",insert_graffiti:"涂鸦",insert_code:"条码",qr_code:"二维码",barcode:"一维码",qr_holder:"请输入文本信息",barcode_holder:"请输入字母/数字信息",insert_shape:"图形",basic:"基础",festival:"节日",plant:"植物",animal:"动物",border:"边框",others:"其他",photo:"拍照",open_photo_album:"相册",my_system_file:"文件",font_spacing:"间距",back:"返回",keyboard_confirm:"完成",modify_position:"修改位置",modify_size:"修改尺寸",modify_rotation:"旋转角度",modify_outline_offset:"偏移距离",input_font:"文字输入",adjust:"调整",camera_location:"拍照对位",fail_to_generate_svg_path:"生成路径失败，请调整参数后重试",layer_multi_canvas:{delete_canvas:"删除操作不可撤销，确定删除该画布吗？",delete_layer:"删除操作不可撤销，确定删除该层吗？",delete_canvas_title:"删除画布",delete_layer_title:"删除层",confirm:"确认",cancel:"取消",delete:"删除",rename_layer:"层重命名",rename_canvas:"画布重命名"},snap_shot:{Snapshot_preview:"对位预览",hide_background:"隐藏背景",display_background:"显示背景",calibrate:"贴纸并校准"},loss_fonts:"文件使用了当前系统不支持的字体格式，已替换为默认字体。",loss_fonts_description:"画布使用了当前系统不支持的字体格式，请选择处理方式："},auto_focus:{auto_focus_remain_tip:"激光头即将开始向下复位，请不要放置超过10cm的较厚物品，避免压坏设备，点击【确定】按钮开始自动对焦"},graffiti:{name:"涂鸦",cancel_title:"是否取消本次涂鸦",cancel_content:"取消后，所有的绘制内容将不会保留",continue_editing:"继续编辑",confirm:"确认",pen:"笔刷",erase:"橡皮",pen_size:"笔刷尺寸",erase_size:"橡皮尺寸"},rate:{title:"你做得很棒！",rate_content:"你喜欢刚才的DIY过程吗？",help_improve:"不，去吐槽",rate_it:"去点赞",help_to_improve_title:"请告诉我们如何改进？",improve_blank_tips:"如有必要，请附上邮箱便于联系你",submit:"提交",submit_success:"提交成功",submit_fail:"提交失败，请检查网络"},guide:{set_process_attr:"在此处进行加工相关的设置",add_canvas_elements:"在此处添加元素、切换画布等",set_elements_attr:"选中元素后，可编辑元素、对元素进行参数设置",set_framing_attr:"点击后可在下方出现的面板进行走边框和加工",to_process_attr:"点击后可进行加工流程",next:"下一步",ok:"确定"}},aze={mobile:oze},lze={title:"设置",theme:"主题",light:"浅色",dark:"深色",common:"通用设置",about:"关于 {version}",unit:"单位",canvas:"画布",auto_snapping:"智能吸附",unit_mm:"毫米",unit_in:"英寸",language:"语言",graphic_fill_status:"图形填充状态",about_software:"关于软件",software_update:"软件更新",log_level:"日志级别",check_update:"检查更新",current_version:"当前版本：v{version}",current_software_version:"当前软件版本：v{version}",not_update:"当前已是最新版本: v{version}",need_update:"发现新版本: v{version}，建议更新",software_version:"当前软件版本: v{version}",download_update:"立即下载",copyright:"Copyright © {previousYear} - {year} XTL US INC. All Rights Reserved.",check_update_fail:"检测更新失败，请检查网络",open:"打开",more_change_log:"前往更新日志，了解更多 >",dev_mode:"开发者模式",firmware_update:"强制固件升级",start:"开始",hotkeys:"快捷键",hotkeys_link_text:"查看",hotkeys_link_href:"https://support.xtool.com/hc/en-us/articles/12140908998039",accurate_hit_area:"精确选择图形",accurate_hit_area_tips:"重启软件生效",display_vector_fill:"显示图形填充状态",image_fit_canvas:"导入图片尺寸超出画幅",image_fit_canvas_ask_anytime:"每次询问",image_fit_canvas_auto_yes:"自动缩小",image_fit_canvas_auto_no:"原尺寸展示",precise_dxf_file_parsing:"精确解析DXF文件",auto_update_device_ext:"设备插件自动更新",dxf_parse_precision:"DXF自动闭合公差",operation_prompt:"开启功能提示",privacy_policy:"隐私政策",user_agreement:"服务条款",safe_use_specifications:"安全使用规范",graphics_curves_quality:{title:"矢量图形质量",option_best:"最佳",option_best_desc:"适合加工>20英寸的图形，处理速度一般",option_high:"高",option_high_desc:"适合加工10-20英寸的图形，处理速度较快",option_medium:"中",option_medium_desc:"适合加工<10英寸的图形，处理速度快",take_effect_tips:"该设置将对新导入的图纸生效。"},file:"文件设置",import:"导入设置",file_parsing:"文件解析设置",others:"其他设置",uatPwd:"测试口令",about_xcs:"关于xcs",log_error:"错误",log_warn:"警告",log_info:"信息",log_debug:"调试"},cze={setting:lze},uze={p2:{precision_measurement_calibration:"精准测量校准",first_calibration:"首次测量",next_calibration:"再次测量",adjustment_laser_head:"调整激光头",calibration_z:"校准Z轴高度",marking_point:"加工打点",first_calibration_step1_text:"在--刀条上--放置材料，调整激光头到材料中间，点击打点按钮",first_calibration_step2_text:"调整激光头，使红点与第一步的加工点重合",first_calibration_step2_btn_text:"确认重合，进入下一步",next_calibration_step1_text:"在--设备底板--放置材料，调整激光头到材料中间，点击打点按钮",next_calibration_step2_text:"调整激光头，使红点与第一步的加工点重合",adjustment_step1_text:"使用螺丝刀调整激光头，使红色激光点与第二步的加工点重合",calibration_z_step1_text:"将刀条反插，调整激光头，使红色激光点打在刀条背面上",calibration_z_step1_btn_text:"确认位置正确，开始校准",calibration_z_success:"本次校准已完成"}},hze={tool:uze},dze={title:"消息列表",mark_all_read:"一键已读",all:"全部",device:"设备",system:"系统",app:"应用",activity:"活动",unread:"未读",read:"已读",view_details:"查看详情",view_all_messages:"查看所有消息",all_messages:"所有消息",confirm:"确认",close:"关闭",no_data:"没有消息",seven_days_title:"7天内不再展示",only_a_month_messages:"仅展示一个月内的消息",only_a_month_unread_messages:"仅展示一个月内的未读消息"},fze={mc:dze},pze={...HVe,...WVe,...QVe,...KVe,...ZVe,...cze,...YVe,...sze,...aze,...hze,...UVe,...zVe,...tze,...ize,...fze};var iv,wc,I0,rp,ka,Ll,uT,rv,Yx;class gze{constructor(){ke(this,rv);ke(this,iv,vM());ke(this,wc,"en-US");ke(this,I0,[]);ke(this,rp,{zh:"zh-CN",en:"en-US","zh-TW":"zh-hant","zh-HK":"zh-hant","ja-JP":"ja","ko-KR":"ko","uk-UA":"uk"});ke(this,ka,{});ke(this,Ll,void 0);E(this,"version","1.0.0");E(this,"i18n");E(this,"options",{mergeExtRes:!1});ke(this,uT,()=>new Proxy(S(za,rp),{get(e,t){return t in e?e[t]:!za.isSupportLangIncludesProp(t)&&t.includes("-")&&window.VITE_PHONE?t.split("-")[0]:t}}));Qe(this,Ll,new yQ({resId:"xcs-l10n",dest:`${this.langLocalPath}/temp`}))}get langLocalPath(){return Js?`${Js}/l10n`:""}get langFolderName(){return"langs"}get supportLangs(){return S(this,I0).filter(e=>e.platForm.includes(S(this,iv)))}get local(){const e=localStorage.getItem("LANG_KEY")||navigator.language;return S(this,uT).call(this)[e]||e||S(this,wc)}isSupportLangIncludesProp(e){return this.supportLangs.map(t=>t.lang).includes(e)}getLocal(e){return S(this,rp)[e]||e||S(this,wc)}getDefaultLocal(){return S(this,wc)}async loadLocaleMessages(e){if(this.langLocalPath==="")return{};let t=`file://${this.langLocalPath}/${e}`;try{if(["mobile","pad"].includes(S(this,iv))){t=`${this.langLocalPath}/${e}`;const i=await Ri.read(t,"utf-8");return JSON.parse(i)}else return await(await fetch(t)).json()}catch(i){return console.error(["=> loadLocaleMessages",t,i]),{}}}setHtmlLang(e=""){var t;(t=document.querySelector("html"))==null||t.setAttribute("lang",e),["mobile","pad"].includes(S(this,iv))&&window.MeApi.openNative.updateLanguageType(e),this.i18n&&(this.i18n.mode==="legacy"?this.i18n.global.locale=e:this.i18n.global.locale.value=e)}async getLocalMessages(e){const t={"zh-CN":pze,"en-US":BVe},i=this.supportLangs.find(a=>a.lang===e);if(!(i!=null&&i.fileName))return t[e];let s=await this.loadLocaleMessages(`${this.langFolderName}/${i.fileName}`);const o=t[e];if(o&&(s=Ln({},o,s),!this.options.mergeExtRes)){const a=await this.getExtLocalMessages(e);s=Ln({},s,a)}return console.log(["=> getLocalMessages",s]),s}async getExtLocalMessages(e){const t=[];gd.forEach(s=>{t.push(fetch(`${s.path}/src/lang/${e}.json`).then(o=>o.json()))});const i=await Promise.allSettled(t),r={};return i.forEach(s=>{s.status!=="fulfilled"&&Object.assign(r,s.values)}),console.log(["=> getExtLocalMessages",r]),r}async setup(e){this.options=Object.assign({},this.options,e),await Ht(this,rv,Yx).call(this);const t=this.local;return this.i18n=tte({messages:S(this,ka),locale:t,legacy:!1,fallbackLocale:S(this,wc),globalInjection:!0,silentTranslationWarn:!0,missingWarn:!1,silentFallbackWarn:!0}),this.i18n}async updateLocal(e){var t;return S(this,ka).hasOwnProperty(e)||(S(this,ka)[e]=await this.getLocalMessages(e)),(t=this.i18n)==null||t.global.setLocaleMessage(e,S(this,ka)[e]),this.setHtmlLang(e),e}async getMessagesByLocal(e){return S(this,ka).hasOwnProperty(e)||(S(this,ka)[e]=await this.getLocalMessages(e)),S(this,ka)[e]}async checkUpdate(e){const t=vM(),i=[{key:`${t}Version`,op:"<=",values:xj(e)},{key:"platform",op:"include",values:[t]}],r=await S(this,Ll).check(!0,this.version,i,lg.l10nVer);return r?r.shouldUpdate:!1}async download(){var r;const e=await S(this,Ll).download(),t=await(Ri==null?void 0:Ri.calculateMd5(e)),i=((r=S(this,Ll).checkResult)==null?void 0:r.md5List)[0];if(t!==i)return yr.unlink(e,s=>{s&&console.error(s),console.log(`${e} File deleted!`)}),Promise.reject(`检测到服务器返回的MD5${i}与计算得出的MD5${t}不一致`)}async update(){var s;const e=await S(this,Ll).download(),t=await(Ri==null?void 0:Ri.calculateMd5(e)),i=((s=S(this,Ll).checkResult)==null?void 0:s.md5List)[0];if(t!==i)return Promise.reject(`检测到服务器返回的MD5${i}与计算得出的MD5${t}不一致`);const r=await S(this,Ll).unZip(e);await(Ri==null?void 0:Ri.copy(r,this.langLocalPath)),await Ht(this,rv,Yx).call(this),await this.updateLocal(this.local),console.log("升级成功")}async updateLocalFile(e){const t=await S(this,Ll).unZip(e);await(Ri==null?void 0:Ri.copy(t,this.langLocalPath)),await Ht(this,rv,Yx).call(this),await this.updateLocal(this.local),console.log("升级成功")}}iv=new WeakMap,wc=new WeakMap,I0=new WeakMap,rp=new WeakMap,ka=new WeakMap,Ll=new WeakMap,uT=new WeakMap,rv=new WeakSet,Yx=async function(){const e=await this.loadLocaleMessages("package.json"),{supportLangs:t=[],localAlias:i={},version:r}=e||{};if(Qe(this,I0,t),Qe(this,rp,Object.assign({},S(this,rp),i)),this.version=r,S(this,ka)[S(this,wc)]=await this.getLocalMessages(S(this,wc)),S(this,wc)!==this.local){const s=this.local;S(this,ka)[s]=await this.getLocalMessages(s),this.setHtmlLang(s)}};const za=new gze;class Dft{constructor(e){this.data=e}}var mc=(n=>(n.Text="text",n.File="file",n.Shape="shape",n.barcode="barcode",n.qrcode="qrcode",n))(mc||{}),mze=(n=>(n.COPY="copy",n.PASTE="paste",n.CUT="cut",n.COPY_PASTE="copy_paste",n.DELETE="delete",n.CLIP_MASK="clip_mask",n.LOCK="lock",n))(mze||{});class kft{constructor(e,t){this.type=e,this.options=t}}var Am=(n=>(n[n.none=0]="none",n[n.CREATE=1]="CREATE",n[n.MODIFY=2]="MODIFY",n[n.RELEASE=3]="RELEASE",n[n.FINISH=4]="FINISH",n))(Am||{});class Oft{constructor(e){this.type=e}}class Lft{constructor(e,t){this.type=e,this.params=t}}class Nft{constructor(e){this.save=e}}var vze=(n=>(n[n.preview=0]="preview",n[n.finish=1]="finish",n[n.cancel=2]="cancel",n))(vze||{});class Bft{constructor(e,t){this.type=e,this.params=t}}class Fft{constructor(e,t,i){this.attr=e,this.preloadTex=t,this.showLoading=i}}class Uft{constructor(e){this.attr=e}}class Gft{constructor(e){this.clear=e}}class Hft{constructor(e){this.isCancel=e}}class Vft{constructor(){}}class zft{constructor(e){this.all=e}}class $ft{constructor(){}}class Wft{constructor(){}}class jft{constructor(){}}class Qft{constructor(e){this.onExtract=e}}class Xft{constructor(e){this.onCodeFill=e}}class Yft{constructor(e){this.onGraffiti=e}}class _ze{constructor(e){this.data=e}}class yze{constructor(e){this.data=e}}class Aze{}class bze{}class wze{}class xze{constructor(){}}class Cze{constructor(e){this.data=e}}class Eze{constructor(e){this.positive=e}}class Tze{constructor(e){this.show=e}}class Ize{constructor(e){this.scale=e}}class Sze{constructor(e){this.isPenMode=e}}class Pze{constructor(){}}class Mze{}class Rze{constructor(e){this.type=e}}class Dze{constructor(e){this.type=e}}let kze=class{getExt(){return bt().ext}};const mk=new kze;class Oze{constructor(){E(this,"currentModel",ee(""));this.init()}init(){}updateCurrentMode(e){this.currentModel.value=e}updateParamTest(e){console.log("updateParamTest",e);const t=["KNIFE_CUT","PRINTER_KNIFE_CUT"].includes(this.currentModel.value),i=mk.getExt(),r=i.dataSource,s=r.getDeviceFormValues(),o=r.getProcessDataValues(),a=i.getSpeedScope(s,{processingType:t?cn.KNIFE_CUTTING:cn.VECTOR_ENGRAVING}).max,l={...e,maxSpeed:a,extId:i.id,isKnifeCut:t,deviceValues:s,elementValues:o},c=this.transformResult(l);r.updateParamTest(c)}transformResult(e){const{matrixResult:t,descriptionResult:i,maxSpeed:r,extId:s,isKnifeCut:o,deviceValues:a,elementValues:l,xCoordinate:c,yCoordinate:u}=e,h=[],d=["F1","F1Ultra"].includes(s)&&l.processingType===cn.BITMAP_ENGRAVING;t.forEach((m,v)=>{m.forEach((_,y)=>{const A={[c.key]:c.value[y],[u.key]:u.value[v]};d&&(A.powerMinMaxRange=[1,c.value[y]]),h.push({id:_,value:A})})});const f=a.material,p=Math.ceil(r/2),g={testDisplays:h,textDisplays:{ids:[],processingType:cn.VECTOR_ENGRAVING,value:{speed:p}}};return o?(g.textDisplays.processingType=cn.KNIFE_CUTTING,g.textDisplays.value.cutPressure=150):g.textDisplays.value.power=50,f===0&&(g.textDisplays.ids=i),g}}const vk=new Oze,vV=(n,e)=>{Object.assign(n,e),Object.keys(n).forEach(t=>{Ks(e).includes(t)||delete n[t]})},ld=qr({}),_k=qr({}),qx=()=>{const n=ee(""),e=te(()=>{var a;return n.value=((a=bt().ext)==null?void 0:a.id)||"",fo.dataSource}),t=async(a,l,c)=>{if(!c)return;vk.updateCurrentMode(l),await new Promise(d=>{let f=0;const p=setInterval(async()=>{!e.value.canvasManager.getCanvas(a)&&f<15?f++:(clearInterval(p),d("success"))},200)});const u=c.getOriginCurrentArea||c.getCurrentArea,{current:h}=u.call(c,l);console.log("[更新画幅数据]=>",a,h),c.emit(QO.UPDATE_PROCESSING_AREA,{canvasId:a,option:{...h}})},i=a=>{e.value&&(e.value.canvasId=a,r(),t(a,ld.mode,mk.getExt()))},r=()=>{var u,h;const a=pn(ld),l=e.value.getDeviceFormValues();vV(ld,l);const c=pn(l);(h=(u=mk.getExt())==null?void 0:u.handleDeviceFormValueChanged)==null||h.call(u,a,c)},s=()=>{const a=e.value.getProcessDataValues();vV(_k,a)};return{deviceValues:ld,elementValues:_k,updateCanvasId:i,updateSelectedElements:a=>{e.value&&(e.value.elements=a,s())},dataSource:e,deviceDataHandler(a,l){console.log("[更新设备数据DeviceForm]",a,l),e.value.setDeviceFormValues(a,l),r(),a==="mode"&&t(e.value.canvasId,l.value,bt().ext)},elementDataHandler(a,l){console.log("[更新加工数据ProcessData]",a,l),e.value.setProcessDataValues(a,l),s()}}};var Lze=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let sK;const SI=n=>sK=n,oK=Symbol();function yk(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var Ny;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(Ny||(Ny={}));function Nze(){const n=rO(!0),e=n.run(()=>ee({}));let t=[],i=[];const r=s6({install(s){SI(r),r._a=s,s.provide(oK,r),s.config.globalProperties.$pinia=r,i.forEach(o=>t.push(o)),i=[]},use(s){return!this._a&&!Lze?i.push(s):t.push(s),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return r}const aK=()=>{};function _V(n,e,t,i=aK){n.push(e);const r=()=>{const s=n.indexOf(e);s>-1&&(n.splice(s,1),i())};return!t&&n6()&&i6(r),r}function Fg(n,...e){n.slice().forEach(t=>{t(...e)})}const Bze=n=>n();function Ak(n,e){n instanceof Map&&e instanceof Map&&e.forEach((t,i)=>n.set(i,t)),n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const i=e[t],r=n[t];yk(r)&&yk(i)&&n.hasOwnProperty(t)&&!Td(i)&&!sO(i)?n[t]=Ak(r,i):n[t]=i}return n}const Fze=Symbol();function Uze(n){return!yk(n)||!n.hasOwnProperty(Fze)}const{assign:Oh}=Object;function Gze(n){return!!(Td(n)&&n.effect)}function Hze(n,e,t,i){const{state:r,actions:s,getters:o}=e,a=t.state.value[n];let l;function c(){a||(t.state.value[n]=r?r():{});const u=o6(t.state.value[n]);return Oh(u,s,Object.keys(o||{}).reduce((h,d)=>(h[d]=s6(te(()=>{SI(t);const f=t._s.get(n);return o[d].call(f,f)})),h),{}))}return l=lK(n,c,e,t,i,!0),l}function lK(n,e,t={},i,r,s){let o;const a=Oh({actions:{}},t),l={deep:!0};let c,u,h=[],d=[],f;const p=i.state.value[n];!s&&!p&&(i.state.value[n]={}),ee({});let g;function m(I){let x;c=u=!1,typeof I=="function"?(I(i.state.value[n]),x={type:Ny.patchFunction,storeId:n,events:f}):(Ak(i.state.value[n],I),x={type:Ny.patchObject,payload:I,storeId:n,events:f});const T=g=Symbol();Yi().then(()=>{g===T&&(c=!0)}),u=!0,Fg(h,x,i.state.value[n])}const v=s?function(){const{state:x}=t,T=x?x():{};this.$patch(O=>{Oh(O,T)})}:aK;function _(){o.stop(),h=[],d=[],i._s.delete(n)}function y(I,x){return function(){SI(i);const T=Array.from(arguments),O=[],F=[];function G(P){O.push(P)}function B(P){F.push(P)}Fg(d,{args:T,name:I,store:w,after:G,onError:B});let R;try{R=x.apply(this&&this.$id===n?this:w,T)}catch(P){throw Fg(F,P),P}return R instanceof Promise?R.then(P=>(Fg(O,P),P)).catch(P=>(Fg(F,P),Promise.reject(P))):(Fg(O,R),R)}}const A={_p:i,$id:n,$onAction:_V.bind(null,d),$patch:m,$reset:v,$subscribe(I,x={}){const T=_V(h,I,x.detached,()=>O()),O=o.run(()=>yt(()=>i.state.value[n],F=>{(x.flush==="sync"?u:c)&&I({storeId:n,type:Ny.direct,events:f},F)},Oh({},l,x)));return T},$dispose:_},w=qr(A);i._s.set(n,w);const C=(i._a&&i._a.runWithContext||Bze)(()=>i._e.run(()=>(o=rO()).run(e)));for(const I in C){const x=C[I];if(Td(x)&&!Gze(x)||sO(x))s||(p&&Uze(x)&&(Td(x)?x.value=p[I]:Ak(x,p[I])),i.state.value[n][I]=x);else if(typeof x=="function"){const T=y(I,x);C[I]=T,a.actions[I]=x}}return Oh(w,C),Oh(Uu(w),C),Object.defineProperty(w,"$state",{get:()=>i.state.value[n],set:I=>{m(x=>{Oh(x,I)})}}),i._p.forEach(I=>{Oh(w,o.run(()=>I({store:w,app:i._a,pinia:i,options:a})))}),p&&s&&t.hydrate&&t.hydrate(w.$state,p),c=!0,u=!0,w}function ba(n,e,t){let i,r;const s=typeof e=="function";typeof n=="string"?(i=n,r=s?t:e):(r=n,i=n.id);function o(a,l){const c=$ee();return a=a||(c?Er(oK,null):null),a&&SI(a),a=sK,a._s.has(i)||(s?lK(i,e,r,a):Hze(i,r,a)),a._s.get(i)}return o.$id=i,o}function Kft(n){{n=Uu(n);const e={};for(const t in n){const i=n[t];(Td(i)||sO(i))&&(e[t]=ri(n,t))}return e}}class Vze{constructor(){E(this,"localProcessingData",[]);this.init()}async init(){const e=await Mf.getProcessParam();this.updateProcessingParamList(e)}getProcessingParamList(){return this.localProcessingData}updateProcessingParamList(e){this.localProcessingData=e,Mf.setProcessParam(e)}async updateProcessParam(){try{const e=await Mf.getProcessParam();this.updateProcessingParamList(e)}catch(e){console.log(["=> UPDATE_PROCESSING_PARAM_LIST",e])}}saveProcessingParam(e){const t=this.localProcessingData.slice(0);t.unshift(e),this.updateProcessingParamList(t)}selectProcessingParam(e){const t=this.localProcessingData.slice(0),i=t.find(r=>r.id===e);if(i){const r=[i].concat(t.filter(s=>s.id!==e));this.updateProcessingParamList(r)}}removeProcessingParam(e){const i=this.localProcessingData.slice(0).filter(r=>r.id!==e);this.updateProcessingParamList(i)}importProcessingParamFile(e){if(!wt(e)){const t=this.localProcessingData.slice(0),i={},r={},s=Object.keys(cn).map(a=>(i[a]=[],r[a]=0,a));t.forEach(a=>{i[a.processingType]&&i[a.processingType].push(a)});const o=a=>{let l=!0;return["id","name","processingType","data"].forEach(u=>{Ds(a,u)||(l=!1)}),l&&s.includes(a.processingType)&&i[a.processingType].length<Mf.MAX_PARAMS_NUM};e.forEach(a=>{if(o(a)){const l=t.findIndex(c=>c.id===a.id);l>=0?t[l]=a:(t.push(a),i[a.processingType].push(a),r[a.processingType]++)}}),console.log(["=> 导入文件数据",r,t]),this.updateProcessingParamList(t)}}importProcessingParamList(e){if(console.log("导入项目的自定义参数: ",e),!wt(e)){const t=this.localProcessingData.slice(0);e.forEach(i=>{t.some(r=>r.id===i.id)||t.unshift(i)}),this.updateProcessingParamList(t)}}}const Eh=new Vze,Hc=ba("data_project_module",{getters:{currentMode(){return vk.currentModel.value}},actions:{updateParamTest(n){vk.updateParamTest(n)},setDisPlays(n){var e;(e=fo.dataSource)==null||e.setDisplays(n)},removeCanvas(n){var e;(e=fo.dataSource)==null||e.removeCanvas(n)},getProcessingParamList(){return Eh.getProcessingParamList()},updateProcessingParamList(n){Eh.updateProcessingParamList(n)},updateProcessParam(){return Eh.updateProcessParam()},saveProcessingParam(n){Eh.saveProcessingParam(n)},selectProcessingParam(n){Eh.selectProcessingParam(n)},removeProcessingParam(n){Eh.removeProcessingParam(n)},importProcessingParamFile(n){Eh.importProcessingParamFile(n)},importProcessingParamList(n){Eh.importProcessingParamList(n)}}});var gc=(n=>(n[n.SHOW=0]="SHOW",n[n.HIDE=1]="HIDE",n))(gc||{}),cK=(n=>(n.REPLACE_FONT="replace-font",n.TO_PATHS="to-paths",n))(cK||{}),ps=(n=>(n.App="app",n.Pad="pad",n))(ps||{});const yV="CURVE_QUALITY",AV="autoUpdateDeviceExt",bV="ENABLE_SNAPPING",wV="ACCURATE_HIT_AREA",xV="OPERATION_PROMPT_KEY",CV="ENABLE_SHOW_FILL",EV="FIT_RESIZE";var lE=(n=>(n.ASK_ANYTIME="null",n.AUTO_YES="true",n.AUTO_NO="false",n))(lE||{});const TV="dxf_parser",IV="DXF_PARSE_PRECISION",S1="WATERMARK",P1="testEnv",M1="EXT_SELECTOR",R1="mockAppVersion",D1="mockFirmwareVersion",k1="mockExtVersion",O1="mockL10nVersion",L1="mockUpdateDeviceId";var uK=(n=>(n.FORM="",n.TEST="test",n.TEST_US="test_us",n.EXPLOIT="dev",n))(uK||{}),hK=(n=>(n.HIDDEN="Hidden",n.REVEAL="Reveal",n))(hK||{}),dK=(n=>(n.NO="",n.SOFTWARE="test",n.PLUGIN="test_ext",n.TRANS="test_l10n",n))(dK||{});class Jft{constructor(e){this.unit=e}}class Zft{constructor(e){this.lang=e}}class ept{}class tpt{constructor(e){this.quality=e}}class npt{constructor(e){this.isAuto=e}}class ipt{constructor(e){this.isPrecise=e}}class rpt{constructor(e){this.isDisplay=e}}class spt{constructor(e){this.isPrompt=e}}class opt{constructor(e){this.isNeedShowDialog=e}}class apt{constructor(e){this.url=e}}class lpt{constructor(e){this.isAuto=e}}class cpt{}class upt{}class hpt{}class dpt{}class fpt{}class ppt{}class gpt{constructor(e){this.imageFit=e}}class mpt{constructor(e){this.isParse=e}}class vpt{constructor(e){this.value=e}}class _pt{constructor(e){this.debugMode=e}}class ypt{}const SV="SoftwareRemind";class fK{static get laterInfo(){const e=localStorage.getItem(SV);return e?JSON.parse(e):{}}static update(e){const t={...this.laterInfo,...e,time:+new Date};localStorage.setItem(SV,JSON.stringify(t))}static check(e){const t=this.laterInfo,i=60*60*24*3*1e3;return t.version&&e.version===t.version?+new Date-t.time<=i:!1}}const zze="https://passport.xtool.com/terms.html",$ze="https://passport.xtool.com/policy.html",Wze="https://s.xtool.com/doc/lso-training",jze="https://s.xtool.com/community/home",Qze="https://support.xtool.com/community-support",Xze="https://www.xtool.com/";class Yze{constructor(){E(this,"unit",ee(this.getUnit()));E(this,"quality",ee(this.getQuality()));E(this,"enable_snapping",ee(this.getIsEnableSnapping()));E(this,"accurate_hit_area",ee(this.getIsAccurateHitArea()));E(this,"display_vector_fill",ee(this.getIsDisplayVectorFill()));E(this,"operation_prompt",ee(this.getIsOperationPrompt()));E(this,"autoUpdateDeviceExt",ee(this.isAutoUpdateDeviceExt()));E(this,"langKey",ee(za.local));E(this,"image_fit",ee(this.getImageFit()));E(this,"isParseDxfPrecise",ee(this.getIsPreciseParseDxf()));E(this,"parseDxfData",ee(this.getParseDxfData()));E(this,"debugMode",ee(this.getALLDebugData()));E(this,"app_version",ee(""));E(this,"lastCheckUpdateResult",ee(null));E(this,"isShowSoftUpdateDialog",ee(!1))}updateUnit(e){this.unit.value={...this.unit.value,...Kj(e)},Cpe(e)}getUnit(){return Tpe()}updateQuality(e){bv().set(yV,e),this.quality.value=e}getQuality(){return JSON.parse(JSON.stringify(bv().get(yV)))||fd.HIGH}async updateLangKey(e){var i;e===this.langKey.value||!await za.updateLocal(e)||(localStorage.setItem("LANG_KEY",e),(i=window.MeApi)==null||i.openNative.updateLanguageType(e),this.langKey.value=e)}getSupportLangList(){return za.supportLangs.map(e=>({name:e.label,value:e.lang}))}async checkSoftUpdate(){var i,r;const e=await((i=window.MeApi)==null?void 0:i.appContentId()),t=await((r=window.MeApi)==null?void 0:r.getAppVersion());this.app_version.value=t;try{const s=new Promise((l,c)=>{setTimeout(()=>{c("timeout")},5e3)}),o=Pj(t,e,{mockKey:lg.AppVer}),a=await Promise.race([s,o]);console.log("mblock===>","checkSoftUpdate result",a,a===null),a===null||a==="timeout"?this.lastCheckUpdateResult.value=null:(this.lastCheckUpdateResult.value=a,this.lastCheckUpdateResult.value.isRequestedError=!1)}catch(s){console.log(s),console.log("mblock===>","checkSoftUpdate err",s),this.lastCheckUpdateResult.value={isRequestedError:!0,shouldUpdate:!1}}}showUpdateDialog(e=!0,t=!0){try{if(this.lastCheckUpdateResult.value!==null&&this.lastCheckUpdateResult.value.shouldUpdate)if(console.log("==> showUpdateDialog lastCheckUpdateResult ",this.lastCheckUpdateResult.value),e){console.log("==> softUpdate 弹窗之前--检查--时间 ");const i=fK.check({version:this.lastCheckUpdateResult.value.latestVersion});return!i&&t&&tt.modal.showNewSoftDialog(),console.log("==> softUpdate 是否已经超过三天 ",!i),this.isShowSoftUpdateDialog.value=!i,!i}else return console.log("==> softUpdate 弹窗之前--不需要检查--时间 "),t&&tt.modal.showNewSoftDialog(),this.isShowSoftUpdateDialog.value=!0,!0}catch(i){return console.log("==> showUpdateDialog",i),this.isShowSoftUpdateDialog.value=e,e}}async updateLangeFile(){const e=await za.checkUpdate(GT);if(e!==!1&&e)try{await za.update()}catch(t){console.log("==> updateLangeFile",t)}}getIsAccurateHitArea(){return nf(localStorage.getItem(wV),{defaultValue:!1})}updateAccurateHitArea(e){localStorage.setItem(wV,String(e)),this.accurate_hit_area.value=e}getIsEnableSnapping(){return nf(localStorage.getItem(bV),{defaultValue:!0})}updateEnableSnapping(e){localStorage.setItem(bV,String(e)),this.enable_snapping.value=e}getIsDisplayVectorFill(){const e=nf(localStorage.getItem(CV),{defaultValue:!0});return lIe({enableFill:e}),e}updateDisplayVectorFill(e){localStorage.setItem(CV,String(e)),this.display_vector_fill.value=e}updateOperationPrompt(e){localStorage.setItem(xV,String(e)),this.operation_prompt.value=e}getIsOperationPrompt(){return nf(localStorage.getItem(xV),{defaultValue:!0})}updateAutoUpdateDeviceExt(e){localStorage.setItem(AV,String(e)),this.autoUpdateDeviceExt.value=e}isAutoUpdateDeviceExt(){return nf(localStorage.getItem(AV),{defaultValue:!0})}openTermsUrl(){var e,t;(t=(e=window.MeApi)==null?void 0:e.app)==null||t.openBrowser(zze)}openPrivacyUrl(){var e,t;(t=(e=window.MeApi)==null?void 0:e.app)==null||t.openBrowser($ze)}openSafetyUrl(){var e,t;(t=(e=window.MeApi)==null?void 0:e.app)==null||t.openBrowser(Wze)}openHelpCenterUrl(){var e,t;(t=(e=window.MeApi)==null?void 0:e.app)==null||t.openBrowser(Qze)}openProjectUrl(){var e,t;(t=(e=window.MeApi)==null?void 0:e.app)==null||t.openBrowser(jze)}openShopUrl(){var e,t;(t=(e=window.MeApi)==null?void 0:e.app)==null||t.openBrowser(Xze)}updateImageFit(e){localStorage.setItem(EV,e),this.image_fit.value=e}getImageFit(){const e=localStorage.getItem(EV);return e||lE.AUTO_YES}getIsPreciseParseDxf(){const e=localStorage.getItem(TV);return e?e===Mm.NEW:!1}updatePreciseParseDxf(e){const t=e?Mm.NEW:Mm.OLD;localStorage.setItem(TV,t),this.isParseDxfPrecise.value=e}getParseDxfData(){return nf(localStorage.getItem(IV),{defaultValue:.01})}updateParseDxfData(e){localStorage.setItem(IV,String(e)),this.parseDxfData.value=e}getALLDebugData(){let e=localStorage.getItem(S1);e=e||"";let t=localStorage.getItem(P1);t=t||uK.FORM;let i=localStorage.getItem(M1);i=i||hK.HIDDEN;let r=localStorage.getItem(R1);r=r||"";let s=localStorage.getItem(D1);s=s||"";let o=localStorage.getItem(k1);o=o||"";let a=localStorage.getItem(O1);a=a||"";let l=localStorage.getItem(L1);l=l||dK.NO;const c={waterMark:e,env:t,ext_select:i,app_version:r,firmware_version:s,ext_version:o,language_version:a,updated_device_id:l};return console.log("==> debugMode: ",c),c}updateDebugData(e){e&&(e.waterMark&&e.waterMark.trim()!==""?localStorage.setItem(S1,e.waterMark):localStorage.removeItem(S1),e.env?localStorage.setItem(P1,e.env):localStorage.removeItem(P1),e.ext_select?localStorage.setItem(M1,e.ext_select):localStorage.removeItem(M1),e.app_version&&e.app_version.trim()!==""?localStorage.setItem(R1,e.app_version):localStorage.removeItem(R1),e.firmware_version&&e.firmware_version.trim()!==""?localStorage.setItem(D1,String(e.firmware_version)):localStorage.removeItem(D1),e.ext_version&&e.ext_version.trim()!==""?localStorage.setItem(k1,e.ext_version):localStorage.removeItem(k1),e.language_version&&e.language_version.trim()!==""?localStorage.setItem(O1,e.language_version):localStorage.removeItem(O1),e.updated_device_id?localStorage.setItem(L1,e.updated_device_id):localStorage.removeItem(L1)),this.debugMode.value=this.getALLDebugData()}}const qi=new Yze;window.ME.settingManager=qi;const si=ba("setting_module",{getters:{unit(){return qi.unit.value},quality(){return qi.quality.value},langKey(){return qi.langKey.value},autoSnapping(){return qi.enable_snapping.value},preciseVectorPathSelection(){return qi.accurate_hit_area.value},displayVectorFill(){return qi.display_vector_fill.value},operationPrompt(){return qi.operation_prompt.value},autoUpdateDevicePlugins(){return qi.autoUpdateDeviceExt.value},getImageFit(){return qi.image_fit.value},isParseDxfData(){return qi.isParseDxfPrecise.value},dxfParseData(){return qi.parseDxfData.value},debugModeData(){return qi.debugMode.value},currentCheckSoftVersionInfo(){var n;return(n=qi.lastCheckUpdateResult)==null?void 0:n.value}},actions:{async checkSoftUpdate(){await qi.checkSoftUpdate(),qi.showUpdateDialog()},setImageFit(n){qi.updateImageFit(n)},isAutoUpdateDeviceExt(){return qi.isAutoUpdateDeviceExt()},updateLangeFile(){qi.updateLangeFile()}}});class pK{}class qze{}class gK{}class mK{}class Kze{}class Jze extends Yc{constructor(){super(),this.init(),this.initWatch()}async init(){const e=await window.MeApi.app.getAppVersion();this.updateState({currentVersion:e})}initWatch(){super.initWatch(),yt(()=>qi.isShowSoftUpdateDialog.value,e=>{console.log("==>softUpdate isShowSoftUpdateDialog",e),this.updateState({isShouldShowDialog:e})},{immediate:!0})}createState(){return{currentVersion:"",newVersion:"latest",description:"",downloadUrl:"",shouldUpdate:!1,isShouldShowDialog:!1,isAlreadyShow:!1}}getUpdateResult(){const e=za.local,t=qi.lastCheckUpdateResult.value,i=qi.app_version.value;console.log("==> updateResult",t);try{this.updateState({currentVersion:i||""}),t?(this.updateState({newVersion:(t==null?void 0:t.latestVersion)||"latest"}),this.updateState({description:t.changeLog[e==="zh-CN"?"zh":"en"]||""}),this.updateState({downloadUrl:(t==null?void 0:t.downloadUrl[0])||""}),this.updateState({shouldUpdate:(t==null?void 0:t.shouldUpdate)||!1})):(this.updateState({newVersion:"latest"}),this.updateState({description:""}),this.updateState({downloadUrl:""}),this.updateState({shouldUpdate:!1}))}catch(r){console.log("==> getUpdateResult  ",r)}return t}setEventHandler(){this.registerEventHandler(pK,this.getUpdateResult),this.registerEventHandler(gK,this.handleUpdateNowEvent),this.registerEventHandler(mK,this.handleLaterRemindEvent),this.registerEventHandler(Kze,this.handleShouldShowUpdateDialogEvent),this.registerEventHandler(qze,this.handleOpenUpdateUrlEvent)}handleOpenUpdateUrlEvent(){var e;console.log("==> handleOpenUpdateUrlEvent  ",this.uiState.downloadUrl),(e=window.MeApi)==null||e.updateAppVersion(this.uiState.downloadUrl)}handleUpdateNowEvent(){this.handleOpenUpdateUrlEvent()}handleLaterRemindEvent(){const e=this.getUpdateResult();fK.update({version:e.latestVersion})}async handleShouldShowUpdateDialogEvent(){this.uiState.isAlreadyShow||(await qi.checkSoftUpdate(),qi.showUpdateDialog(),this.updateState({isAlreadyShow:!0}))}}class Zze{langKey(){return si().langKey}textAttrs(){return fn().textAttrs}}const e5e=new Zze,t5e={[Ar.BUILD_IN]:"editor.display.proposed_fonts",[Ar.SYSTEM]:"editor.display.local_fonts"};class n5e{constructor(){E(this,"_fontManager",new kLe);E(this,"_fontsRef",ee({}));E(this,"_fontFamilyOpts");E(this,"_loadingPromise");E(this,"_loadResolve");an.measureText=this._fontManager.getTextGlyphsSync.bind(this._fontManager),an.preloadFontAndGlyphs=this._fontManager.preloadFontAndGlyphs.bind(this._fontManager),an.fuzzyMatchFontByCssStyle=this._fontManager.fuzzyMatchFontByCssStyle.bind(this._fontManager),window.appFontManager=this}get loadingPromise(){return this._loadingPromis}get fontManager(){return this._fontManager}get fontFamilyOpts(){return this._fontFamilyOpts||this.getGroupedFontList(),this._fontFamilyOpts}get fonts(){return this._fontsRef.value}get fontsRef(){return this._fontsRef}async getGroupedFontList(){var e;return this._loadingPromise=new Promise(t=>{this._loadResolve=t}),wt(this._fontsRef.value)&&(this._fontsRef.value=await this._fontManager.getGroupedFontList()),(e=this._loadResolve)==null||e.call(this),this._loadingPromis=null,this._fontsRef.value}async preloadTextGlyphs(e){const t=Dv(e),i=ok(t);this._fontManager.setCurrentFont(i),await this._fontManager.resolveFont(i),await this._fontManager.preloadTextGlyphs({...t,text:e.text})}async preloadTextWithText(e,t){const i=ok(t);this._fontManager.setCurrentFont(i),await this._fontManager.resolveFont(i);for(const r of e)await this._fontManager.preloadTextGlyphs({...t,text:r})}toFontSubfamilyOpts(e,{locale:t="en",labelKey:i="label"}={}){return e?Object.entries(e).map(([r,s])=>({...s,value:r,[i]:rf(s.names,t)})):[]}fontList(e){const t=this.langKeyToFontLocaleKey(e),i=this.convertFontGroupsMapToFontItems(this.fonts);let r,s;for(const o of i){const a=this.getLocaleFonts(o.children,t).sort((c,u)=>{var h,d;return((d=(h=c==null?void 0:c.label)==null?void 0:h.localeCompare)==null?void 0:d.call(h,u==null?void 0:u.label,e))??0}),l={type:"group",key:o.key,label:t5e[o.key],children:a};l.children.length&&(o.key===Ar.SYSTEM?r=l:s=l)}return{system:r,buildIn:s}}getLocaleFonts(e,t="en"){return e?e.reduce((i,r)=>{var s;return r&&i.push({...r,label:r.names?rf(r.names,t):r.label,subFontFamilys:((s=r.subFontFamilys)==null?void 0:s.map(o=>({...o,label:rf(o.names,t)})))??[]}),i},[]):[]}convertFontGroupsMapToFontItems(e){const t=[];for(const{key:i,fonts:r}of Object.values(e)){const s=this.convertFontsMapToFontItems(r),o={key:i,children:s};t.push(o)}return t}convertFontsMapToFontItems(e){return Object.entries(e).reduce((i,[r,s])=>{const o=rf(s.names);if(!VB(o))return i;const a=Object.entries(s.subFontFamilys).reduce((c,[u,h])=>{const d=rf(h.names);return VB(d)&&c.push({label:d,value:u,...h}),c},[]),l={label:o,value:this.toFontFamilyOptValue({fontFamily:r,fontSource:s.source}),...s,subFontFamilys:a};return i.push(l),i},[])}toFontFamilyOptValue(e){return this._fontManager.getFamilyItem(e)?JSON.stringify(e):e.fontFamily??""}currentFont(e){return this._fontManager.getFamilyItem(e)?e:{fontFamily:e.fontFamily??"",fontSource:e.fontSource??""}}langKeyToFontLocaleKey(e){let t;return e==="zh-CN"?t="zh":e==="zh-hant"?t="zh-TW":e==="en-US"?t="en":t=e,t}adjustSubfamilyForFamilyChanges(e,t){var o,a,l;const{fontSource:i,fontFamily:r}=e,s=(l=(a=(o=this.fonts)==null?void 0:o[i])==null?void 0:a.fonts)==null?void 0:l[r];if(s){if(s.subFontFamilys[t])return t;{const u=s.subFontFamilys.Regular??Object.values(s.subFontFamilys)[0];if(u)return u.subfamilyName}}return"Regular"}async checkFontAvailable(e,t){let i;const r=new Promise(u=>{i=u}),{hasBetaText:s,supportTextToPath:o,lossFonts:a,lossFontTextInfos:l}=VLe(e,this.fontManager,an,it,t);let c;if(a.size>0){const u=!o;u?(V4(l,Gi.fontManager()),i({convertTextToPathsResults:void 0,hasBetaText:s}),tt.modal.showLossFontsDialog({useLegacy:u,lossFonts:a})):(await tt.modal.showLossFontsDialog({useLegacy:u,lossFonts:a})===cK.REPLACE_FONT?V4(l,Gi.fontManager()):c=zLe(l,e,an,!1),i({convertTextToPathsResults:c,hasBetaText:s}))}else i({convertTextToPathsResults:void 0,hasBetaText:s});return r}getFontName(e){const t=e.fontSource==="build-in"?"buildIn":e.fontSource,i=cue(this.fontList()[t].children,r=>r.label===e.fontFamily);if(i){const r=e5e.langKey().replace("-CN","");return i.names?rf(i.names,r):i.label}return""}}const yl=new n5e;Ar.BUILD_IN+"",Ar.SYSTEM+"";function i5e(n){let e;return n==="zh-CN"?e="zh":n==="zh-hant"?e="zh-TW":n==="en-US"?e="en":e=n,e}function r5e(n,{locale:e="en",labelKey:t="label"}={}){return n?Object.entries(n).map(([i,r])=>({...r,value:i,[t]:rf(r.names,e)})):[]}const bd=ba("font_manager_module",{getters:{getFontManager(){return yl.fontManager},hasFonts(){return!wt(yl.fontsRef.value)}},actions:{async preloadTextGlyphs(n){return await yl.preloadTextGlyphs(n)},async preloadTextWithText(n,e){return await yl.preloadTextWithText(n,e)},async initFont(){await yl.getGroupedFontList()},loadFontPromise(){return yl.loadingPromise??Promise.resolve()},async checkFontAvailable(n,e){return await yl.checkFontAvailable(n,e)},adjustSubfamilyForFamilyChanges(n,e){return yl.adjustSubfamilyForFamilyChanges(n,e)},getFontName(n){return yl.getFontName(n)},postscriptName({fontFamily:n,fontSource:e}){var i,r,s;const{postscriptName:t}=(s=(r=(i=yl.fonts)==null?void 0:i[e])==null?void 0:r.fonts)==null?void 0:s[n];return t??""},localSubFontFamilys(n){var o,a;const{fontSource:e,fontFamily:t}=n,i=si().langKey,r=(a=(o=yl.fonts)==null?void 0:o[e])==null?void 0:a.fonts[t],s=i5e(i);return r?r5e(r.subFontFamilys,{locale:s}).map(l=>({value:l.value,label:l.label})):[]}}});class s5e{getExtId(){return bt().info.extId}getProcessingMode(){return bt().ext.processingMode}getProcessingType(){return _k.processingType}getExt(){return bt().ext}isConnect(){return bt().connected}setDisplays(e){return Hc().setDisPlays(e)}removeCanvas(e){return Hc().removeCanvas(e)}adjustSubfamilyForFamilyChanges(e,t){return bd().adjustSubfamilyForFamilyChanges(e,t)}fontManager(){return bd().getFontManager}unit(){return si().unit}autoSnapping(){return si().autoSnapping}displayVectorFill(){return si().displayVectorFill}quality(){return si().quality}preciseVectorPathSelection(){return si().preciseVectorPathSelection}async checkFontAvailable(e,t){return await bd().checkFontAvailable(e,t)}async saveMultiCanvasShotImg(e,t){return kn().saveMultiCanvasShotImg(e,t)}async getMultiCanvasShotImg(e){return kn().getMultiCanvasShotImg(e)}async deleteMultiCanvasShotImg(e){return kn().deleteMultiCanvasShotImg(e)}dxfParser(){return si().isParseDxfData?"new":"old"}dxfParsePrecision(){return si().dxfParseData}getCurrentXcsFileId(){return kn().getCurrentXcsFileId()}getCurrentXcsTempId(){return kn().getCurrentTempXcsFileId()}}const Gi=new s5e;var sp,op;class No{static get clipperWorker(){let e=S(this,sp);return e||(e=new YLe,Qe(this,sp,e)),e}static destroyClipperHelper(){var e;(e=S(this,sp))==null||e.destroy(),Qe(this,sp,null)}static get outlineWorker(){let e=S(this,op);return e||(e=new H4e,Qe(this,op,e)),e}static destroyOutlineHelper(){var e;(e=S(this,op))==null||e.destroy(),Qe(this,op,null)}static get potraceWorker(){let e=this.potraceHelper;return e||(e=new F4e,this.potraceHelper=e),e}static get projectCacheWorker(){let e=this.projectCacheHelper;return e||(e=new z4e,this.projectCacheHelper=e),e}}sp=new WeakMap,op=new WeakMap,ke(No,sp,void 0),ke(No,op,void 0),E(No,"potraceHelper"),E(No,"projectCacheHelper");const PV=25.4,MV=72,o5e=n=>{const e=new DOMParser().parseFromString(n,"image/svg+xml").documentElement;return e instanceof SVGElement?e:new DOMParser().parseFromString(n,"text/html").documentElement.querySelector("svg")},a5e=n=>{const e=n.width.baseVal.valueInSpecifiedUnits,t=n.height.baseVal.valueInSpecifiedUnits,{width:i,height:r}=n.viewBox.baseVal;let s=1,o=1;return n.width.baseVal.unitType!==SVGLength.SVG_LENGTHTYPE_PERCENTAGE&&(s=e/(i||e)),n.height.baseVal.unitType!==SVGLength.SVG_LENGTHTYPE_PERCENTAGE&&(o=t/(r||t)),{scaleX:s,scaleY:o}},l5e=(n,e)=>{if(!(n instanceof SVGSVGElement))return;const t=`load-svg-container-${String(Date.now())}`,i=document.createElement("div");i.style.visibility="hidden",i.id=t;const r=document.createElement("style");r.innerText=`#${t} text { display: none; }`,i.appendChild(r),i.appendChild(n),document.body.appendChild(i);const{width:s,height:o}=n.getBBox(),a=e??ZB(n.width.baseVal.unitType),l=e??ZB(n.height.baseVal.unitType);return document.body.removeChild(i),{width:s*a,height:o*l}},iN=(n,e)=>{const t=o5e(n);if(t instanceof SVGSVGElement){const{width:i=0,height:r=0}=l5e(t,e)||{},{scaleX:s}=a5e(t);return{source:t,width:i*s,height:r*s}}},c5e=async n=>{const e=await zT(n);return iN(e)},u5e=async(n,e,t)=>{const{dxfParser:i,dxfParsePrecision:r}=t||{},s=await zT(n),o=new O4e,a=await o.preprocess({text:s,options:{parser:i,precision:r}});return o.destroy(),iN(a.res,a.unitScale)},Th=async(n,e=!0)=>{var a;let t=n;n instanceof File&&n.path&&(t=n.path);let i=MV,r,s,o;try{if((a=window.MeApi)!=null&&a.imageOptimize&&pi(t)&&e)try{const{image:u,meta:h}=await h5e(t),d=new Blob([u]);r=await cS(d),i=h.density||MV,s=h.width,o=h.height}catch{r=await cS(n),s=r.width,o=r.height}else r=await cS(n),s=r.width,o=r.height;const l=s/i*PV,c=o/i*PV;return{source:r,width:l,height:c}}catch(l){console.log(l)}},h5e=async n=>{var r,s;const{meta:e,tmpPath:t}=await((r=window.MeApi)==null?void 0:r.imageOptimize(n));return{image:await((s=window.MeApi)==null?void 0:s.fileHelper.read2Buffer(t)),meta:e}},RV={svg:{name:"svg",loader:c5e},dxf:{name:"svg",loader:u5e},png:{name:"bitmap",loader:Th},jpg:{name:"bitmap",loader:Th},jpeg:{name:"bitmap",loader:Th},tiff:{name:"bitmap",loader:Th},ico:{name:"bitmap",loader:Th,shouldOptimize:!1},webp:{name:"bitmap",loader:Th,shouldOptimize:!1},bmp:{name:"bitmap",loader:Th,shouldOptimize:!1},gif:{name:"bitmap",loader:Th,shouldOptimize:!1}},DV=async(n,e)=>{const t=pi(n)?n:n.name,r=rde(t).replace(".","").toLowerCase();if(r in RV){const{name:s,loader:o,shouldOptimize:a}=RV[r],l=await o(n,a,e);return{name:s,data:l}}},d5e=n=>({name:"svg",data:iN(n)}),f5e=async(n,e,t="M")=>{const i=e===mc.qrcode?await Xhe(n,{errorCorrectionLevel:t}):await Yhe(n);if(i)return await ode(i)};class p5e{copyContent(e){const t=this.serialization(e);pi(e)?window.MeApi.openNative.copyToPasteboard(t):(X.clipboardData=e,window.MeApi.openNative.copyToPasteboard(""))}async pasteContent(){try{const e=await window.MeApi.openNative.pasteFromPasteboard();if(e.content==="")return{type:"json",content:X.clipboardData};if(e.type==="text"&&e.content!==void 0)return{type:"text",content:e.content};if(e.type==="image"){if(e.content!==void 0)return{type:"image",content:e.content};tt.modal.showToast({msg:"ipad.editor.open_xcs_file_error",icon:"error",type:"html",linkTips:"canvas.message.learn_more",openCb:()=>{window.open("https://community.xtool.com/#/making/detail/tips/96")}})}else return{}}catch{return{}}}serialization(e){return pi(e)?e:JSON.stringify(e,(i,r)=>r instanceof Map?{dataType:"Map",value:Array.from(r.entries())}:r)}}const N1=new p5e,kV=4;class g5e{async insertElement(e,t){switch(e.type){case mc.Text:await this.cnvOpInsertText(e);break;case mc.File:const i={file:e.file,...e.options};i.fitSize={},await this.cnvOpInsertFile(i);break;case mc.Shape:if(t&&!e.options){const s={...tt.canvasFactory.insertConfig};t!=null&&t.x&&(t!=null&&t.y)&&(s.offsetX=t.x,s.offsetY=t.y,e.options=s)}return await this.cnvOpInsertShape(e);case mc.qrcode:case mc.barcode:const r=await f5e(e.file,e.type,e.errorCorrectionLevel);if(r){const s={file:r,...e.options,...tt.canvasFactory.codeSize(e.type===mc.qrcode)};await this.cnvOpInsertFile(s)}break}}async cnvOpInsertText(e){const{x:t,y:i,worldWidth:r,worldHeight:s,scale:o}=X.currentCanvas.viewport,a=tt.appType===ps.App?s*o.x/2-9.305*o.y:40*o.y,l=t+r*o.x/2-38.5*o.x,c=i+a;X.currentCanvas.updateSubEditMode("TEXT_EDIT",{target:null,type:"create",globalPoint:{x:l,y:c},willRecord:!0,selection:"all"})}async cnvOpInsertShape(e){const{name:t,file:i,options:r}=e;if(i&&typeof i=="string"){const s=await fetch(i).then(l=>l.arrayBuffer()),o=new File([s],`${t}.svg`);return await this.cnvOpLoadResToCanvas({file:o,...r??tt.canvasFactory.insertConfig})}else throw new Error("not support shape type")}async cnvOpLoadResToCanvas(e){var m;const{file:t,offsetX:i,offsetY:r,parseColor:s,cancelSelected:o}=e,a=Gi.dxfParser(),l=Gi.dxfParsePrecision(),c=await DV(t,{dxfParser:a,dxfParsePrecision:l}),{name:u="",data:h}=c||{},d=(e==null?void 0:e.width)??h.width,f=(e==null?void 0:e.height)??h.height;Object.assign(h,{width:d,height:f});const p=gr(e,["width","height","fitSize"]),g=this.cnvOpLoadResToViewport(u,{parseColor:s,...h},{offsetX:i,offsetY:r,fitViewportRatio:.8,fitToViewPort:!0,...p});return o||(m=X.currentCanvas)==null||m.clearSelected(),console.log(g),g}async cnvOpInsertFile(e){const{file:t,offsetX:i,offsetY:r,parseColor:s,isGraffiti:o}=e;let a=[];try{let l;if(o)l=d5e(t);else if(t instanceof HTMLImageElement)l={name:"bitmap",data:{source:t,width:t.width,height:t.height}};else{const c=Gi.dxfParser(),u=Gi.dxfParsePrecision();l=await DV(t,{dxfParser:c,dxfParsePrecision:u})}if(l&&l.data){const{name:c,data:u}=l;if(Rt(u))for(const h in u){const d=await this.cnvOpLoadResToViewport(c,u[h]);d&&a.push(...d)}else{const h=(e==null?void 0:e.width)??u.width,d=(e==null?void 0:e.height)??u.height,f=gr(e,["width","height","fitSize"]);this.cnvOpCheckSvgHasText(l,f),f.width||(f.width=h),f.height||(f.height=d),Object.assign(u,{width:h,height:d});const{viewportWidth:p,viewportHeight:g}=X.canvasState();let m=!0;if(!o&&tt.appType===ps.Pad){const v=u.width>p||u.height>g,_=si().getImageFit;v&&_===lE.ASK_ANYTIME?m=await tt.modal.showImageFitSizeDialog():m=_===lE.AUTO_YES}a=await this.cnvOpLoadResToViewport(c,{parseColor:s,...u},{fitToViewPort:m,offsetY:r,offsetX:i,...f,...tt.canvasFactory.imageImportConfig})}}else throw Error()}catch{setTimeout(()=>{tt.modal.showToast({msg:"ipad.editor.open_xcs_file_error",icon:"error",type:"html",linkTips:"canvas.message.learn_more",openCb:()=>{window.open("https://community.xtool.com/#/making/detail/tips/96")}})},500)}finally{console.log(a)}}cnvOpLoadResToViewport(e,t,i){var r;return((r=X.currentCanvas)==null?void 0:r.loadResToViewport(e,t,i))??[]}async cnvOpCheckSvgHasText({name:e,data:t},i){e==="svg"&&(t==null?void 0:t.source)instanceof SVGSVGElement&&(t!=null&&t.source.querySelector("text"))&&(i.beforePlace=async r=>{const{lossFonts:s}=r;(s==null?void 0:s.size)>0&&tt.modal.showLossFontsDialog({useLegacy:!0,lossFonts:s})})}async paste(e){var t,i;try{const r=await N1.pasteContent();if(!wt(r))switch(r.type){case"json":this.pasteClipboardData(e,r.content);break;case"text":if(((t=X.currentCanvas.modeManager.curSubEditMode)==null?void 0:t.name)==="TEXT_EDIT")X.currentCanvas.onPaste(r.content);else{await bd().preloadTextGlyphs({...Dv({style:Ya}),text:r.content});const{x:o,y:a}=X.clientPointToViewportPoint(e)??{x:0,y:0};(i=X.currentCanvas)==null||i.addTextToViewport({offsetX:o,offsetY:a,fitToViewPort:!1},{text:r.content})}break;case"image":const s={type:mc.File,file:r.content,options:{offsetX:0,offsetY:0,cancelSelected:!1}};X.insertElement(s);break;default:break}}catch{}}pasteClipboardData(e,t){var i,r;if(t){const s=t==null?void 0:t.data;if(!wt(s)&&Rt(s))if(e){const{x:o,y:a}=X.clientPointToViewportPoint(e)??{x:0,y:0},l=lde(s);s.forEach(c=>{c.x=c.x-l.minX+o,c.y=c.y-l.minY+a})}else{const{canvasParsedOffsetMap:o}=X.clipboardData??{},a=((i=o==null?void 0:o.get(X.currentId))==null?void 0:i.offsetX)||0,l=((r=o==null?void 0:o.get(X.currentId))==null?void 0:r.offsetY)||0;s.forEach(h=>{h.x+=a,h.y+=l});const c=a+kV,u=a+kV;o==null||o.set(X.currentId,{offsetX:c,offsetY:u})}t.data=s,this.pasteToCanvas(t)}else throw new Error("clipboard data is empty")}pasteToCanvas(e,t){const i=e.data.map(o=>o.type),r=Ja(i),s=X.selectIds.length>=1;t?jt(Zt.buttonClick,{elementId:ki.paste,source:"elementClick",pasteSource:"sameCanvasHotKey",name:r}):wt(e.projectId)||wt(e.canvasId)?jt(Zt.buttonClick,{elementId:ki.paste,source:s?"elementClick":"noElementClick",pasteSource:"external",name:r}):e.projectId!==Gi.getCurrentXcsTempId()?jt(Zt.buttonClick,{elementId:ki.paste,source:s?"elementClick":"noElementClick",pasteSource:"crossProject",name:r}):e.canvasId!==X.currentId?jt(Zt.buttonClick,{elementId:ki.paste,source:s?"elementClick":"noElementClick",pasteSource:"differentCanvas",name:r}):jt(Zt.buttonClick,{elementId:ki.paste,source:s?"elementClick":"noElementClick",pasteSource:"sameCanvasMenu",name:r}),X.currentCanvas.importCopyPasteData(e.data,{groupTags:e.groupTags,pasteGroupMap:e.pasteGroupMap})}copy(e=!1){var i,r,s,o,a;if(((r=(i=X.currentCanvas)==null?void 0:i.modeManager.curSubEditMode)==null?void 0:r.name)==="TEXT_EDIT"){const l=(s=X.currentCanvas)==null?void 0:s.onCopy();return N1.copyContent(l),""}const t=X.exportSelectedJSON(!0);return t&&e&&N1.copyContent({canvasId:X.currentId,projectId:Gi.getCurrentXcsTempId(),data:t,groupTags:(o=X.currentCanvas)==null?void 0:o.getSelectedGroupTags(),pasteGroupMap:(a=X.currentCanvas)==null?void 0:a.getPasteGroupMap()}),t}bitMaskOpt(e){const t=X.currentCanvas;if(t)switch(e){case Am.CREATE:t.selectedBuildAndStartEditMaskAction(),X.updateEditMode(Vt.BITMAP_MASK);break;case Am.MODIFY:t.selectedStartEditMaskAction(),X.updateEditMode(Vt.BITMAP_MASK);break;case Am.RELEASE:t.selectedReleaseMaskAction(),X.updateEditMode(Vt.SELECT);break;case Am.FINISH:t.endEditMaskAction(),X.updateEditMode(Vt.SELECT);break}else throw new Error("canvas is not exist")}async textWeld(){var i,r,s;const e=Vh.UNION,t=(i=X.currentCanvas)==null?void 0:i.getTextWeldInfo(e);if(t){const{info:o,pathJSON:a}=t;if(!a.sourceId)return;let l="";try{l=await No.clipperWorker.boolCalculate({type:e,info:o})}catch(c){console.warn("boolean operation error when text weld:",c)}finally{No.destroyClipperHelper()}if(!l)return;(r=X.currentCanvas)==null||r.removeElements([a.sourceId]),(s=X.currentCanvas)==null||s.drawBoolResult(e,l,a)}}async startSmartFill(e=!1){return Gi.getExtId()==="F1Ultra"?await this.f1UltraSmartFill():await this.smartFill(e)}async smartFill(e){if(e)return this.smartFillNet();const{displaysJSON:t,options:i}=X.currentCanvas.getShapeMatchData(),r=new W4e,s=await r.shapeMatch(t,i);return r.destroy(),X.currentCanvas.addShapeMatchResult(s)}async smartFillNet(){}async f1UltraSmartFill(){}}class m5e{constructor(){E(this,"_selectIds",ee([]));E(this,"_selectLength",ee(0));E(this,"_selectJSON",ee([]));E(this,"_groupJSON",ee(void 0));E(this,"_isGroup",ee(!1));E(this,"_enableCombine",ee(!1));E(this,"_isBoolOperate",ee(!1));E(this,"_isMultiSelectMode",ee(!1));E(this,"_bitmapMask",ee(""))}get isBoolOperateRef(){return this._isBoolOperate}get isBoolOperate(){return this._isBoolOperate.value}set isBoolOperate(e){this._isBoolOperate.value=e}get selectIdsRef(){return this._selectIds}get selectIds(){return this._selectIds.value}set selectIds(e){this._selectIds.value=e}get selectLengthRef(){return this._selectLength}get selectLength(){return this._selectLength.value}set selectLength(e){this._selectLength.value=e}get selectJSONRef(){return this._selectJSON}get selectJSON(){return this._selectJSON.value}set selectJSON(e){this._selectJSON.value=e}get groupJSON(){return this._groupJSON.value}get groupJSONRef(){return this._groupJSON}set groupJSON(e){this._groupJSON.value=e}get isGroup(){return this._isGroup.value}get isGroupRef(){return this._isGroup}set isGroup(e){this._isGroup.value=e}get enableCombineRef(){return this._enableCombine}get enableCombine(){return this._enableCombine.value}set enableCombine(e){e!==void 0&&(this._enableCombine.value=e)}get isMultiSelectModeRef(){return this._isMultiSelectMode}set isMultiSelectMode(e){this._isMultiSelectMode.value=e,X.currentCanvas.isMultiSelectMode=e}get bitmapMask(){return this._bitmapMask}upDataSelectEle(e){try{const{selectedJSON:t=[],selectedLength:i=0,groupJSON:r}=e;this._bitmapMask.value=e.bitmapMask??"",this.selectJSON=t,this.selectLength=i||t.length,this.groupJSON=r,this.selectIds=t.map(s=>s.id),this.isGroup=e.isGroup,this.enableCombine=e.enableCombine,this.isBoolOperate=e.isBoolOperate??!1}catch{}}enterVecEditor(e=!1){var t,i;if(e){(t=X.currentCanvas)==null||t.updateEditMode(Vt.PEN);return}if(this.selectIds.length>=1){(i=X.currentCanvas)==null||i.updateSubEditMode(Xi.VECTOR_EDITOR,{mode:wi.EDITOR,display:this.selectIds[0]});return}throw new Error("must select a display object to enter vector editor")}changeNodeType(e){var t;(t=X.currentCanvas)==null||t.updateAnchorType(e)}changeNodeAlign(e){var t;(t=X.currentCanvas)==null||t.align(e)}getSelectedDisplay(){return{num:this.selectLength,data:Uu(this.selectJSON)}}}class v5e{constructor(){E(this,"_bridgeTreeData",ee([]))}get bridgeTreeData(){return this._bridgeTreeData.value}set bridgeTreeData(e){this._bridgeTreeData.value=e}get bridgeTreeDataRef(){return this._bridgeTreeData}moveEleToLayer(e){var r,s;const t=X.getCanvasDataLayerDataById(X.currentId),i={layerTag:e,layerColor:e,visible:((r=t[e])==null?void 0:r.visible)??!0};(s=X.currentCanvas)==null||s.updateSelectedAttributes(i)}orderLayer(e,t,i){var u;const r=this.findLayerData().layerData||{},s=Array.from(pn(e)),o=pn(r);s.forEach((h,d)=>{h.order=s.length-d});for(let h in o)o[h].order=(u=s.find(d=>d.key===h))==null?void 0:u.order;const a=s.findIndex(h=>h.key===t),l=s.length-i,[c]=s.splice(a,1);return s.splice(l,0,c),s.forEach((h,d)=>{h.order=s.length-d,o[h.key].order=s.length-d}),this.updateLayerData({oldLayerData:r,newLayerData:o,needRecord:!0}),s}updateLayerData(e){var a,l;const t=X.getCanvasDataById(X.currentId),{newLayerData:i=t.layerData,oldLayerData:r,needRecord:s=!1,currentLayer:o}=e;if(t&&i){X.upDateCanvasDataLayerDataById(i);const c={layerData:{...i},updateCanvasDisplay:!1};o&&(c.layerColor=o,c.layerTag=o),(a=X.currentCanvas)==null||a.updateDisplayConfig(c),r&&(X.updateCanvasDataLayerStackById([r,i]),s&&((l=X.currentCanvas)==null||l.recordOuterOperationLog([r,i])))}}renameLayer(e,t){var d,f;const i=X.getCanvasDataLayerDataById(X.currentId),r={...i,[e]:{...i[e],name:t}},s=X.getCanvasDataById(X.currentId);s.layerNames={...s.layerNames,[e]:t},X.editorLayerDataUpdate({newLayerData:r,oldLayerData:i,needRecord:!0});const o=(d=X.currentCanvas)==null?void 0:d.exportCanvasJSON({texture:!1});let a=Fr(o,p=>{const g=p;return g.layerTag||(g.layerTag=ii,g.layerColor=ii),g.layerTag});const l=X.getCanvasDataById(),{treeData:c,newLayerData:u}=dm(a,l);X.bridgeTreeData=Wa(c,"order").reverse();const h=X.getCanvasDataById().currentLayer;h&&!r[h]&&X.currentLayerUpdate({currentLayer:((f=o[0])==null?void 0:f.layerTag)||ii}),X.editorLayerDataUpdate({newLayerData:u})}findLayerData(){const e=X.canvasDataList.map(({id:t,title:i,isHasCloseImg:r,layerData:s})=>({id:t,title:i,isHasCloseImg:r,layerData:s}));return Bo(e,{id:X.currentId})}getLayerData(e,t){if(!e)return{treeData:[],currentLayer:"",hasLayer:!1};const i=e,{treeData:r}=this.createTreeDataByDisplay(i,t);return{treeData:r,hasLayer:r.length>0}}handleLayerAfterDisplayRemoved(e,t){const i=que(e,r=>ehe(t,{id:r.id}));this.handleLayerRecord(i)}handleLayerAfterDisplayAdded(e){this.handleLayerRecord(e)}handleLayerRecord(e){const t=X.getCanvasDataById();if(t!=null&&t.layerData){const i=Fr(e,s=>{const o=s;return o.layerTag||(o.layerTag=ii,o.layerColor=ii),o.layerTag});let{newLayerData:r}=dm(i,t);this.editorLayerStackUpDate([t.layerData,r])}}editorLayerStackUpDate(e){const t=X.getCanvasDataById();t&&e&&(t.layerStack=e)}editorLayerDataUpdate(e){var o,a;const{newLayerData:t,oldLayerData:i,needRecord:r=!0}=e,s=X.getCanvasDataById();s&&t&&(s.layerData=t,console.log("[ newLayerData ] >",s.layerData),(o=X.currentCanvas)==null||o.updateDisplayConfig({layerData:{...t},layerColor:s.currentLayer,layerTag:s.currentLayer,updateCanvasDisplay:!1}),i&&(s.layerStack=[i,t],r&&((a=X.currentCanvas)==null||a.recordOuterOperationLog([i,t]))))}currentLayerUpdate(e){var r;const{currentLayer:t}=e,i=X.getCanvasDataById();i&&i.layerData&&(i.currentLayer=t||ii,i.layerData&&((r=X.currentCanvas)==null||r.updateDisplayConfig({layerColor:i.currentLayer,layerTag:i.currentLayer,layerData:{...i.layerData},updateCanvasDisplay:!1})))}getLayerOrder(){const e=this.findLayerData();return e&&(e!=null&&e.layerData)?Zi(Wa(Zce(e.layerData),([,t])=>t.order),([t])=>t):[]}getLayerBySelectedJSON(e,t,i){if(wt(e))return i;const r=new Set;if(e.forEach(a=>{r.add(a.layerColor)}),r.size===1)return Array.from(r.values())[0];const s=t.filter(a=>{const l=r.has(a.key);return r.delete(a.key),l}).map(a=>a.key);if(r.size>=1)return Array.from(r.values())[0];let o=i;return s.length===1?o=s[0]??i:s.length>0?o=Wa(s,a=>a.order)[0]??i:o=r[0],o!==i&&this.updateLayerData({currentLayer:o,needRecord:!1}),o}onHistoryChange(e,t){const i=Fr(t,o=>{const a=o;return a.layerTag||(a.layerTag=ii,a.layerColor=ii),a.layerTag});for(const o in e)i[o]&&i[o];const{treeData:r,newLayerData:s}=dm(e,X.getCanvasDataById());return{treeData:r,newLayerData:s}}createTreeDataByLayerData(e,t){const i=Fr(t,s=>{const o=s;return o.layerTag||(o.layerTag=ii,o.layerColor=ii),o.layerTag}),r={};for(const s in e)i[s]&&(r[s]=i[s]);return this.renderLayerTree(r)}createTreeDataByDisplay(e,t){const i=Fr(e,r=>{const s=r;return s.layerTag||(s.layerTag=ii,s.layerColor=ii),s.layerTag});return this.renderLayerTree(i,t)}renderLayerTree(e,t){const{treeData:i,newLayerData:r}=dm(e,X.getCanvasDataById()),s=Wa(i,a=>a.order).map(a=>a.key).reverse();s.length===0?t=ii:s.indexOf(t)===-1&&(t=s[0]),this.updateLayerData({newLayerData:r,needRecord:!1,currentLayer:t});const o=X.getCanvasDataById();return o&&r&&(o.layerData=r),{treeData:i,newCurrentLayer:t,newLayerData:r}}currentLayerChildKeys(e){return X.exportCanvasJSON(!1).filter(i=>i.layerColor===e).map(i=>i.id)}}const B1=16,_5e="textCurve",Apt="center",bpt="center";Dhe();const vK=(n,e=0)=>({id:n,title:`{panel}${e+1}`,isHasCloseImg:!1,layerData:{},currentLayer:ii,layerStack:[]});var _K=(n=>(n.Square="square",n.Round="round",n.Miter="miter",n))(_K||{}),yK=(n=>(n.ClosedPolygon="closedPolygon",n.ClosedLine="closedLine",n.OpenButt="openButt",n.OpenSquare="openSquare",n.OpenRound="openRound",n))(yK||{});class y5e{constructor(){E(this,"_cnvIdentities",ee([]));E(this,"_interval");E(this,"_versionProject");E(this,"idMapping",new Map);E(this,"tempXcsffectScope");E(this,"timer")}get version(){return this._versionProject}initMultiWatch(){yt(()=>{var e;return((e=kn().currentTempXcs)==null?void 0:e.tempFileId)??void 0},async e=>{if(e??void 0){const t=this.idMapping;if(!wt(t))try{const i=Array.from(t.keys());for(let r=i.length-1;r>=0;r--){const s=i[r],o=t.get(s),a=await Gi.getMultiCanvasShotImg(o);await Gi.deleteMultiCanvasShotImg(o),await Gi.saveMultiCanvasShotImg(s,a)}}catch{}this.idMapping=new Map,X.getAllCanvasMessageWithImag().then(i=>{X.cnvIdentities=i,X.noticeCanvasCover(X.currentId,!1)}).catch(i=>{console.log("loadCanvasDataList:::getAllCanvasMessageWithImag",i),X.cnvIdentities=X.canvasDataList.map(r=>({id:r.id,title:r.title,img:void 0}))}).finally(()=>{X.projectChange(e.tempFileId)})}},{immediate:!0})}async load(e,t){var a;await bd().loadFontPromise(),this.tempXcsffectScope||(this.tempXcsffectScope=new pT(!0),this.tempXcsffectScope.run(this.initMultiWatch.bind(this))),this._interval&&clearInterval(this._interval),await this.handleFontAndImage(t),this.idMapping=(t==null?void 0:t.idMapping)??{},this._versionProject=t==null?void 0:t.version;const i=(t==null?void 0:t.canvasDataList)??[];i.forEach(l=>{for(let c in l.layerData)X.setLayerName(l.id,c,l.layerData[c].name)}),X.setOperationStackOnProjectChange();const r=tt.canvasFactory.initCanvas(e,t);let s;if(t){const{convertTextToPathsResults:l,hasBetaText:c}=await Gi.checkFontAvailable(t.canvasDataList.filter(u=>u.id===t.canvasId),t.version);c&&(t!=null&&t.version.includes("beta"))&&setTimeout(()=>{tt.modal.showBetaTextNotice()},1e3),s=l,X.loadCanvasDataList(i)}const o=(a=X.changeStack(r.keys().next().value))==null?void 0:a.initOperation;r.forEach((l,c)=>{const u=t==null?void 0:t.canvasDataList.find(h=>h.id===c);if(u){const{id:h,displays:d,layerData:f,groupData:p,currentLayer:g}=u;l==null||l.updateDisplayConfig({layerData:{...f},groupData:p,layerColor:g??ii,layerTag:g??ii,updateCanvasDisplay:!1}),Rt(d)&&(l.importDisplayJSON(d,{createNewID:!1,needRecord:!1,autoSelected:!1,createNewGroupTag:!1,ignoreUpdateZOrder:!0}),this.checkFont(l,h,s))}else l==null||l.updateDisplayConfig({layerData:{},groupData:{},layerColor:ii,layerTag:ii,isHasCloseImg:!1,currentLayer:ii,layerStack:[],updateCanvasDisplay:!1});if(o||l.updateInitLog(),X.setCanvas(l,c),!t){const h=vK(c);X.loadCanvasDataList([h])}}),t?X.currentId=t.canvasId:X.currentId=r.keys().next().value}updateBinderDom(e,t=!0,i=X.currentId){const r=X.canvasMap.get(i);if(console.log(t),r)return tt.canvasFactory.bindCanvas(r,e),r.view}async handleFontAndImage(e,t){let i;const r=new Promise(s=>{i=s});if(!bd().hasFonts&&e6&&await bd().initFont(),e){await $Le(e.canvasDataList,Gi.fontManager(),it),e!=null&&e.version.includes("beta");const s=e==null?void 0:e.canvasDataList.find(o=>o.id===e.canvasId);s&&await Mhe([s],it.BITMAP)}return i("success"),r}stopCanvas(e=X.currentId){var t;(t=X.canvasMap.get(e))==null||t.stop()}destroyAll(){X.canvasMap.forEach(e=>{console.log(e)})}checkFont(e=X.currentCanvas,t=X.currentId,i){if(i){if(i.length<0)return;i.forEach(r=>{const{paths:s,text:o,canvasId:a}=r;let l="g-temp";const c=s.map(u=>(u.groupTag.startsWith("g-")?l=u.groupTag:u.groupTag=l,u));e&&t===a&&(e.removeElements([o.id],!1,!1),e.importDisplayJSON(c,{needRecord:!1,autoSelected:!1,createNewGroupTag:l==="g-temp",groupTags:[l]}))})}}updateUnit(e){if(X.currentCanvas){const t=X.currentCanvas.getPluginByName("guideLine"),{current:i,scale:r,fractionDigits:s}=e,o=X.currentCanvas.getPluginByName("ruler");t&&t.updateConfig({unit:i,pixelPerUnit:i===_C.MM?1:1/r,fractionDigits:s}),o&&o.updateConfig({pixelPerUnit:i===_C.MM?1:1/r})}}updateAutoSnapping(e){if(X.currentCanvas){const t=X.currentCanvas.getPluginByName("guideLine");t&&t.updateConfig({enableAdsorb:e})}}get cnvIdentitiesRef(){return this._cnvIdentities}get cnvIdentities(){return this._cnvIdentities.value}set cnvIdentities(e){this._cnvIdentities.value=e}async noticeCanvasCover(e,t=!0){if(wt(this._cnvIdentities))return;const i=await Promise.all(this._cnvIdentities.value.map(async r=>{if(r.id===e){const s=await X.getDisplayLayerShot({onlyViewportArea:!0,scaleNum:2});return t&&Gi.saveMultiCanvasShotImg(e,s.canvas.toDataURL("image/png")),{id:r.id,title:r.title,img:s}}return new Promise(s=>{s(r)})}));this.cnvIdentities=i}noticeCoverDelay(e=5e3){this.timer||(this.timer=setTimeout(()=>{X.noticeCanvasCover(X.currentId,!0),clearTimeout(this.timer),this.timer=void 0},e))}clearCoverTimer(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)}removeCanvasListener(){var e;(e=X.currentCanvas)==null||e.removeListener(ko.CAN_DO_CHANGE).removeListener(gn.NEW_DISPLAYS_ADDED).removeListener(gn.SELECT_OBJECT).removeListener(gn.DISPLAYS_REMOVED).removeListener(gn.HISTORY_CHANG).removeListener(gn.SELECT_OBJECT_TRANSFORMERED).removeListener(gn.UPDATE_IMAGE_TRACING_VISIBLE).removeListener(gn.UPDATE_IMAGE_PROCESS_VISIBLE).removeListener(gn.BEFORE_HISTORY_CHANGE).removeListener(Gc.CHANGE).removeListener(gn.UPDATE_BACKDROP_RESULT).removeListener(gn.ZOOMED).removeListener(gn.DRAW_DISPLAY_DONE).removeListener(gn.SELECTED_TRANSFORM_COMMIT)}}const A5e=async(n,e,t)=>{var i;if(e!==0){if(n!=null&&n.bitmapData){const{bitmapShot:r}=n.bitmapData,{width:s,canvas:o}=r,a=s/o.width;n.bitmapData.extendPoints=await No.clipperWorker.scaleOffsetPoints({pointsList:n.bitmapData.pathPointsList,options:{joinType:_K.Round,pointScale:sw,offsetScale:a/sw,offset:e}})}if(n!=null&&n.vectorData){const{openPathPointsList:r=[],closePathPointsList:s=[]}=n.vectorData;if(s.length>0){const o=[];for(let a=0;a<s.length;a++)await No.clipperWorker.area({points:s[a]})===0&&(o.push(a),r.push(s[a]));n.vectorData.closePathPointsList=s.filter((a,l)=>!o.includes(l))}r.length>0&&(n.vectorData.shapeExtendPoints=await No.clipperWorker.scaleOffsetPoints({pointsList:n.vectorData.openPathPointsList,options:{endType:yK.OpenRound,pointScale:sw,offsetScale:1/sw,offset:e}}))}No.destroyClipperHelper()}return(i=No.outlineWorker)==null?void 0:i.genOutline(e,t,n)};class b5e{constructor(){E(this,"_hasInitHtml",ee(!1));E(this,"_canvasMap",new Map);E(this,"_isEmptyRef",ee(!0));E(this,"_currentIdRef",ee(""));E(this,"_clipboardData");E(this,"_canvasDataList",ee([]));E(this,"_currentEditorMode",Vt.SELECT);E(this,"_backgroundContext",gc.SHOW);E(this,"_backgroundVisible",ee(!1));E(this,"_hasBackgroundImage",ee(!1));E(this,"_hasCloseImage",ee(!1));E(this,"_onElementRotate",ee(!1));E(this,"_textAttrs",ee({fontFamily:"",fontSource:""}));E(this,"_onGraffiti",ee(!1))}get hasInitHtmlRef(){return this._hasInitHtml}set hasInitHtml(e){this._hasInitHtml.value=e}get isEmptyRef(){return this._isEmptyRef}set isEmptyRef(e){this._isEmptyRef=e}get onRotateRef(){return this._onElementRotate}set onElementRotate(e){this._onElementRotate.value=e}initStateManager(){this._canvasMap=new Map,this._isEmptyRef.value=!0,this._currentIdRef.value="",this._clipboardData=void 0,this._canvasDataList.value=[],this._currentEditorMode=Vt.SELECT}get textAttrs(){return this._textAttrs}set textAttrsValue(e){this._textAttrs.value=e}get canvasMap(){return this._canvasMap}get isEmpty(){return this._isEmptyRef}get currentId(){return this._currentIdRef.value}set currentId(e){this._currentIdRef.value=e,X.changeActiveCanvasBack(e)}get currentIdRef(){return this._currentIdRef}get clipboardData(){return this._clipboardData}set clipboardData(e){this._clipboardData=e}get canvasDataListRef(){return this._canvasDataList}get canvasDataList(){return this._canvasDataList.value}set canvasDataList(e){this._canvasDataList.value=e;const t=[];this._canvasDataList.value.forEach(i=>{const r=X.cnvIdentities.findIndex(o=>o.id===i.id),s=r>-1?X.cnvIdentities[r].img:void 0;t.push({id:i.id,title:i.title,img:s})}),X.cnvIdentities=t}loadCanvasDataList(e){this._canvasDataList.value=e.map(t=>{var i,r;return t.currentLayer?t:{...t,currentLayer:(i=t.displays)!=null&&i.length?(r=t.displays[t.displays.length-1])==null?void 0:r.layerTag:ii}})}get currentEditorMode(){return this._currentEditorMode}set currentEditorMode(e){this._currentEditorMode=e}get backgroundContext(){return this._backgroundContext}set backgroundContext(e){this._backgroundContext=e}get backgroundVisible(){return this._backgroundVisible.value}set backgroundVisible(e){this._backgroundVisible.value=e}get backgroundVisibleRef(){return this._backgroundVisible}get hasBackgroundImage(){return this._hasBackgroundImage.value}set hasBackgroundImage(e){this._hasBackgroundImage.value=e}get hasBackgroundImageRef(){return this._hasBackgroundImage}get hasCloseImageRef(){return this._hasCloseImage}set hasCloseImage(e){this._hasCloseImage.value=e}getCanvasDataById(e=this.currentId){return this.canvasDataList.find(i=>i.id===e)||void 0}updateCanvasDataLayerStackById(e,t=this.currentId){this.canvasDataList.forEach((i,r)=>{i.id===t&&(this.canvasDataList[r].layerStack=e)})}upDateCanvasDataLayerDataById(e,t=this.currentId){this.canvasDataList.forEach((i,r)=>{i.id===t&&(this.canvasDataList[r].layerData=e)})}getCanvasDataLayerDataById(e=this.currentId){var t;return((t=this.getCanvasDataById(e))==null?void 0:t.layerData)??{}}getCanvas(e=X.currentId){return this._canvasMap.get(e)}get currentCanvas(){return this.canvasMap.get(this.currentId)}clearState(){this.initStateManager()}setCanvas(e,t){this.canvasMap.clear(),this.canvasMap.set(t,e),this.isEmpty.value=!1}canvasState(e=X.currentId){var t;return((t=X.canvasMap.get(e))==null?void 0:t.currentState)??void 0}updateEditMode(e){this.currentEditorMode=e}redo(e=this.currentId){var t;return(t=X.canvasMap.get(e))==null?void 0:t.redo()}undo(e=this.currentId){var t;return(t=X.canvasMap.get(e))==null?void 0:t.undo()}async changeSingleCanvas(e){var s,o,a;if(X.setOperationStack(X.currentId,X.currentCanvas.operationStack),e===this.currentId)return new Promise(l=>{l(this.currentId)});(s=X.currentCanvas)==null||s.emit(gn.SELECT_OBJECT,void 0),X.setOperationStack(X.currentId,X.currentCanvas.operationStack),await this.updateCanvasDataListById(this.currentId);const t=X.getCanvasDataById(e),i=(o=X.changeStack(e))==null?void 0:o.initOperation,r=X.currentCanvas;if(t&&r){const{convertTextToPathsResults:l,hasBetaText:c}=await Gi.checkFontAvailable([t],X._versionProject);c&&((a=X.version)!=null&&a.includes("beta"))&&tt.modal.showBetaTextNotice(),r.updateEditMode(Vt.SELECT),r.removeElements("all",!1,!1);const{displays:u,layerData:h,groupData:d,currentLayer:f}=t;r==null||r.updateDisplayConfig({layerData:{...h},groupData:d,layerColor:f??ii,layerTag:f??ii,updateCanvasDisplay:!1}),Rt(u)&&r.importDisplayJSON(u,{createNewID:!1,needRecord:!1,autoSelected:!1,createNewGroupTag:!1,ignoreOperation:!0}),this.canvasMap.clear(),this.setCanvas(r,e),this.currentId=e,X.checkFont(r,e,l)}return!i&&r&&r.updateInitLog(),this.canvasMap.has(e)&&(this.currentId=e),this.currentId}clearAllElement(){var t;const e=X.currentCanvas;e&&((t=X.currentCanvas)==null||t.emit(gn.SELECT_OBJECT,void 0),X.removeCanvasListener(),e.updateEditMode(Vt.SELECT),e.selectAll(),e.removeElements("all",!1,!1))}async updateCanvasDataListById(e=this.currentId){var i;await((i=this.currentCanvas)==null?void 0:i.getCanvasData({clearSelected:!1}))&&this.canvasDataList.forEach((r,s)=>{r.id===e&&(this.canvasDataList[s].displays=this.canvasDisplayJsonById())})}canvasDisplayJsonById(){var e;return((e=X.currentCanvas)==null?void 0:e.exportCanvasJSON())??void 0}deleteSelectedElement(e=this.currentId){var t;(t=this.canvasMap.get(e))==null||t.removeSelected()}lockElement(e=this.currentId){var t;(t=this.canvasMap.get(e))==null||t.updateLockAspectRatio()}resetEditorMode(){switch(this.currentEditorMode){case Vt.BITMAP_MASK:X.bitMaskOpt(Am.FINISH);break}this.currentEditorMode!==Vt.SELECT&&this.updateEditMode(Vt.SELECT)}async getLiveCanvasData(e){return this.currentCanvas?await this.currentCanvas.getCanvasData(e):Promise.reject("canvas is not exist")}async extractContours(e){var s,o;const i=e&&e.length>0?(s=this.currentCanvas)==null?void 0:s.getSpecifiedOutlineEleInfo:(o=this.currentCanvas)==null?void 0:o.getAllOutlineEleInfo,r=await(i==null?void 0:i.bind(this.currentCanvas)(.1,e));return r?await A5e(r,.1,{addBitmapInner:!1}):""}handlerDeviceChange(){this.resetIsFill()}resetIsFill(){}realTimeCanvasData(){return this.updateCanvasDataListById(this.currentId),this.canvasDataList}addCanvas(){const e=Gp(),t=Array.from(this.canvasDataList);return t.push(vK(e,t.length)),this.canvasDataList=t,e}zoom(e){if(X.currentCanvas){const t=X.currentCanvas.viewportScaled;let i=.25;t>=10&&e&&(i=2),t>10&&!e&&(i=2),X.currentCanvas.setZoom(t+(e?i:-i))}}isSelectMode(){return X.currentCanvas?X.currentCanvas.modeManager.curMode==="SELECT"&&!X.currentCanvas.modeManager.curSubEditMode:!1}get onGraffiti(){return this._onGraffiti}setOnGraffiti(e){this._onGraffiti.value=e}sortCanvas(e,t){const[i]=X.canvasDataList.splice(e,1);X.canvasDataList.splice(t,0,i);const r=Array.from(X.cnvIdentities),[s]=r.splice(e,1);r.splice(t,0,s),X.cnvIdentities=r}}const rN=new Map,bk=()=>{rN.clear()},w5e=(n,e)=>{bk(),rN.set(n,e)};class x5e{constructor(){E(this,"_toolCanvas");E(this,"_toolCanvasOnBusy",ee(!1))}get toolCanvas(){return this._toolCanvas||(this._toolCanvas=tt.canvasFactory.createToolCanvas(),this._toolCanvas.app.stop()),this._toolCanvas}terminateImageTracing(){rN.forEach(e=>{e()}),bk()}async generatorImageTracing(e){var a,l,c,u,h;const t="#00befe",i=(a=this.toolCanvas)==null?void 0:a.getTracingDisplayImageData(),r=await this.convertToSvgPath(i,e,w5e);if(bk(),r==="cancel")return(l=this.toolCanvas)==null||l.clearTracingPath(),{failToFillSvg:!0,hardToFillSvg:!1,cancel:!0};console.timeEnd("Generating path"),console.time("display path");const[s,o]=this.enableToFillSvg(r);if((c=this.toolCanvas)==null||c.clearTracingPath(),o)return{failToFillSvg:!0,hardToFillSvg:s,cancel:!1};if(Array.isArray(r))r.forEach(d=>{var f;Array.isArray(d.path)?d.path.forEach(p=>{var g;(g=this.toolCanvas)==null||g.addPathToContainer(p,t,`rgb(${d.color})`)}):(f=this.toolCanvas)==null||f.addPathToContainer(d.path,t,`rgb(${d.color})`)});else{const d=(u=this.toolCanvas)==null?void 0:u.getTracingOriginDisplay();(h=this.toolCanvas)==null||h.addPathToContainer(r,t,d==null?void 0:d.layerColor)}setTimeout(()=>{var p;const d=(p=this.toolCanvas)==null?void 0:p.getTraceDisplay();return!d||d.length===0?{failToFillSvg:!1,hardToFillSvg:!1,cancel:!1}:{failToFillSvg:!1,hardToFillSvg:this.displayPointsOverSize(d),cancel:!1}},50)}displayPointsOverSize(e){return!e||e.length===0?!1:e.some(t=>t.points.length>15e5)}async convertToSvgPath(e,t,i){var s;return await((s=No.potraceWorker)==null?void 0:s.convertToSvgPath(e,t,i))}enableToFillSvg(e){const t=i=>{const r=/[Cc]/g,s=i.match(r),o=i.length>2e6||s&&s.length>7e4,a=i.length>6e6||s&&s.length>1e5;return[!!o,!!a]};if(Array.isArray(e)){let i=!1;const r=e.reduce((o,a)=>o+a.path.length,0);console.log("path count..",r),r>2e3&&(i=!0);const s=e.reduce((o,a)=>{let l=!1,c=!1;return Array.isArray(a.path)?[l,c]=a.path.reduce((u,h)=>{const[d,f]=t(h);return[d||u[0],f||u[1]]},[!1,!1]):[l,c]=t(a.path),[l||o[0],c||o[1]]},[!1,!1]);return[s[0],s[1]||i]}else return t(e)}cancelImageTracing(){var e;(e=this.toolCanvas)==null||e.closeImageTracing()}saveImageTracing(){var r;let e;const t=new Promise(s=>{e=s}),i=(r=this.toolCanvas)==null?void 0:r.getTraceDisplay();return!i||i.length===0?(this.cancelImageTracing(),setTimeout(()=>{e==null||e()}),t):(setTimeout(()=>{var a;const s=(a=this.toolCanvas)==null?void 0:a.confirmImageTracing();if(this.toolCanvas.selected=[],!s||s.length===0)return;s.forEach(l=>{l&&(l.parseJSON({layerColor:l.layerTag,enableFill:!0}),X.currentCanvas.beforeAddDisplayToViewport(l),X.currentCanvas.addDisplayToViewport(l))}),this.pathLoading=!1;const o=X.currentCanvas.createGroupByZOrder(s);X.currentCanvas.executeSelect(s,[o]),X.currentCanvas.recordOperationLog(...s),e==null||e()},300),t)}get toolCanvasOnBusy(){return this._toolCanvasOnBusy}setToolCanvasOnBusy(e){this._toolCanvasOnBusy.value=e}}class C5e{constructor(){E(this,"operationStack",new Map);E(this,"projectId","")}getOperationStack(e){return this.operationStack.has(this.projectId)||this.operationStack.set(this.projectId,new Map),this.operationStack.get(this.projectId).has(e)||this.operationStack.get(this.projectId).set(e,new aI),this.operationStack.get(this.projectId).get(e)}removeProjectStack(e){this.operationStack.delete(e)}removeOperationStack(e){var t;(t=this.operationStack.get(this.projectId))==null||t.delete(e)}setOperationStack(e,t){this.operationStack.has(this.projectId)||this.operationStack.set(this.projectId,new Map),this.operationStack.get(this.projectId).set(e,t)}setOperationStackOnProjectChange(){X.currentCanvas&&(this.setOperationStack(X.currentId,X.currentCanvas.operationStack),X.currentCanvas.getOtherData=()=>[])}changeStack(e){if(X.currentCanvas){const t=this.getOperationStack(e);return X.currentCanvas.operationStack=t,t}}clearAllStack(){this.operationStack.clear()}}class E5e{constructor(){E(this,"layerNameMap",new Map)}setLayerName(e,t,i){this.layerNameMap.has(e)||this.layerNameMap.set(e,new Map),this.layerNameMap.get(e).set(t,i)}getLayerName(e,t){var i;return((i=this.layerNameMap.get(e))==null?void 0:i.get(t))||void 0}removeLayerName(e){this.layerNameMap.delete(e)}clearAllLayerName(){this.layerNameMap.clear()}}class T5e{constructor(){E(this,"projects",new Map)}projectChange(e){if(wt(e)){X.projects.forEach((i,r)=>{X.projectRemove(r)});return}const t=X.canvasDataList.map(i=>i.id);X.projects.set(e,t)}addCanvasId(e){const t=kn().getCurrentTempXcsFileId();X.projects.has(t)||X.projects.set(t,[]),X.projects.get(t).includes(e)||X.projects.get(t).push(e)}deleteCanvasId(e){var i;const t=kn().getCurrentTempXcsFileId();X.projects.has(t)&&((i=X.projects.get(t))==null||i.map((r,s)=>{var o;r===e&&((o=X.projects.get(t))==null||o.splice(s,1))}),X.removeOperationStack(e),X.removeLayerName(e),X.removeBackgroundStatus(e))}projectRemove(e){var t;(t=X.projects.get(e))==null||t.forEach(i=>{X.removeOperationStack(i),X.removeLayerName(i),X.removeBackgroundStatus(i)}),!kn().getCurrentTempXcsFileId()&&X.currentCanvas&&(X.currentCanvas.operationStack=new aI),X.projects.delete(e)}}class I5e{constructor(){E(this,"canvasBgImageMap",new Map);E(this,"canvasBackgroundStatusMap",new Map);E(this,"localCanvasBgImageMap",new Map)}setBackgroundStatus(e,t){var i,r,s,o;wt(e)||(this.canvasBackgroundStatusMap.set(e,t),this.canvasBgImageMap.set(e,[t.option,t.img]),(i=X.currentCanvas)==null||i.destroyBackdrop(),(r=X.currentCanvas)==null||r.updateBackdrop(t.option,t.img),X.hasBackgroundImage=!0,X.backgroundVisible=t.showBackground,t.showBackground?(s=X.currentCanvas)==null||s.showBackground():(o=X.currentCanvas)==null||o.hideBackground(),X.backgroundContext=t.showBackground?gc.SHOW:gc.HIDE)}setLocalCanvasBackgroundStatus(e,t){var r,s;const i=X.getCanvasDataById();t.img&&t.option?((r=X.currentCanvas)==null||r.setLocalBackdrop(t.img,t.option),this.localCanvasBgImageMap.set(e,t)):((s=X.currentCanvas)==null||s.setLocalBackdrop(null,null),this.localCanvasBgImageMap.delete(e)),i&&(i.isHasCloseImg=!wt(t.img),X.hasCloseImage=i.isHasCloseImg)}getBackgroundStatus(e){var t;return((t=this.canvasBackgroundStatusMap.get(e))==null?void 0:t.showBackground)??!0}removeBackgroundStatus(e){this.canvasBackgroundStatusMap.delete(e),this.canvasBgImageMap.delete(e)}changeActiveCanvasBack(e){var r,s,o,a;const t=this.canvasBackgroundStatusMap.get(e);wt(t)?((o=X.currentCanvas)==null||o.destroyBackdrop(),X.backgroundVisible=!0,X.backgroundContext=gc.SHOW,(a=X.currentCanvas)==null||a.showBackground()):(t.showBackground?(r=X.currentCanvas)==null||r.showBackground():(s=X.currentCanvas)==null||s.hideBackground(),X.backgroundContext=t.showBackground?gc.SHOW:gc.HIDE,X.backgroundVisible=t.showBackground);const i=this.localCanvasBgImageMap.get(e);wt(i)?this.setLocalCanvasBackgroundStatus(e,{}):this.setLocalCanvasBackgroundStatus(e,{img:i.img,option:i.option})}updateBackgroundVisibility(e,t=X.currentId){var r,s;e?((r=X.currentCanvas)==null||r.showBackground(),X.backgroundContext=gc.HIDE):((s=X.currentCanvas)==null||s.hideBackground(),X.backgroundContext=gc.SHOW);const i=this.canvasBackgroundStatusMap.get(t);i&&(i.showBackground=e,this.canvasBackgroundStatusMap.set(t,i)),X.backgroundVisible=e}cleanCanvasBackdrop(e=X.currentId,t=!1){var i;t&&X.removeBackgroundStatus(e),(i=X.currentCanvas)==null||i.destroyBackdrop(),X.hasBackgroundImage=!1}clearProjectCanvasBgImageMap(){var e;(e=X.currentCanvas)==null||e.destroyBackdrop(),X.hasBackgroundImage=!1,X.backgroundVisible=!0,X.backgroundContext=gc.SHOW,this.setLocalCanvasBackgroundStatus(X.currentId,{}),X.canvasDataList.forEach(t=>{this.canvasBackgroundStatusMap.delete((t==null?void 0:t.id)??""),this.canvasBgImageMap.delete((t==null?void 0:t.id)??""),this.localCanvasBgImageMap.delete((t==null?void 0:t.id)??"")})}}class S5e extends zD(b5e,y5e,g5e,v5e,m5e,x5e,C5e,T5e,E5e,I5e){clear(){this.destroyAll(),this.clearState()}clearAllElement(){var e;(e=X.currentCanvas)==null||e.removeElements("all",!1,!1)}constructor(){super(),window.mCanvasManager=this}async getDisplayLayerShot(e){if(this.currentCanvas)return this.currentCanvas.getDisplayLayerShot(e??{scaleNum:2});throw new Error("canvas is not exist")}getAllCanvasMessage(){const e=[];for(const t of this.canvasDataList){const i=(t==null?void 0:t.title)??`{panel}${e.length}1`;e.push({id:t.id,title:i,img:void 0})}return e}async getAllCanvasMessageWithImag(){const e=[];for(const t of this.canvasDataList){const i=(t==null?void 0:t.title)??`{panel}${e.length}1`,r=await Gi.getMultiCanvasShotImg(t.id);if(r)try{const s=await new Promise((l,c)=>{const u=new Image;u.onload=()=>{l(u)},u.onerror=()=>{c()},u.src=r}),o=document.createElement("canvas");o.width=s.width,o.height=s.height;const a=o.getContext("2d");a==null||a.drawImage(s,0,0),e.push({id:t.id,title:i,img:{canvas:o,scaleNum:2}})}catch{e.push({id:t.id,title:i,img:void 0})}else e.push({id:t.id,title:i,img:void 0})}return e}exportSelectedJSON(e=!0,t=this.currentId){var i;return(i=this.canvasMap.get(t))==null?void 0:i.exportSelectedJSON({texture:e})}exportCanvasJSON(e=!0){return X.currentCanvas.exportCanvasJSON({texture:e})}importDisplayJSON(e,t,i=this.currentId){var r;(r=this.canvasMap.get(i))==null||r.importDisplayJSON(e,t)}get canvas(){return this.currentCanvas??tt.canvasFactory.getTempCanvas()}get canvasList(){return this.canvasMap}clientPointToViewportPoint(e,t){var i;return(i=this.canvasMap.get(this.currentId))==null?void 0:i.clientPointToViewportPoint(e,t)}async combine(e){var l,c,u;const t=(l=this.currentCanvas)==null?void 0:l.getBoolEleInfo(e);let i="";try{i=await No.clipperWorker.boolCalculate({type:e,info:t})}catch(h){console.error("combine error=======>",h);return}finally{No.destroyClipperHelper()}t!=null&&t.selectedIds&&((c=this.currentCanvas)==null||c.removeElements(t==null?void 0:t.selectedIds));const{isFill:r,layerColor:s,layerTag:o,visible:a}=t||{};(u=this.currentCanvas)==null||u.drawBoolResult(e,i,{isFill:r,layerColor:s,layerTag:o,visible:a})}eleNumsLegal(e){var r;const t=(r=this.currentCanvas)==null?void 0:r.currentState;return((t.selectedLength||t.selectedJSON.length)??0)>=e}canvasDisplays(e=this.currentId){var r;const t=((r=this.canvasMap.get(e))==null?void 0:r.exportCanvasJSON())??[],i=[];return t.forEach(({type:s,isFill:o,id:a})=>{i.push({id:a,type:s,isFill:o,processIgnore:!1,processingType:o?cn.FILL_VECTOR_ENGRAVING:cn.VECTOR_ENGRAVING})}),{id:e,displays:i}}updateCanvasBackDrop(e,t,i=X.currentId){X.setBackgroundStatus(i,{showBackground:X.getBackgroundStatus(X.currentId),option:e,img:t})}updateCanvasArea(e){const{width:t,height:i,angle:r,offsetX:s,offsetY:o,gridOption:a={cellSize2:Ohe},scaleMode:l=Ua.AUTO,bgMaskSize:c}=e.option,u=this.getCanvas(e.canvasId);u==null||u.resizeViewport({viewportWidth:t,viewportHeight:i,angle:r,scaleMode:l,gridOption:a}),u==null||u.updateBackdrop({angle:r||0,offsetX:s,offsetY:o,bgMaskSize:c})}async toJson(){var a,l,c,u;await X.updateCanvasDataListById();const e=Gi.getExt(),t=[];X.canvasDataList.forEach(h=>{t.push({id:h.id,title:h.title,layerData:h.layerData,currentLayer:h.currentLayer,groupData:h.groupData,displays:h.displays})});const i={id:(e==null?void 0:e.id)||"",power:((a=e==null?void 0:e.deviceInfo)==null?void 0:a.power)??0,data:((l=e==null?void 0:e.dataSource)==null?void 0:l.projectData)||new Map,materialList:[],materialTypeList:[]};if(i&&i.data instanceof Map){const h=ude(),d=[],f=[];i.data.forEach((p,g)=>{const m=t.find(({id:w})=>w===g);if(!m){i.data.delete(g);return}const v=p.data[p.mode].material,_=h.find(w=>w.id===v);_&&v&&!d.some(w=>w.id===_.id)&&d.push(_);let y=[];p.displays.forEach((w,b)=>{var x;if(!((x=m.displays)==null?void 0:x.find(({id:T})=>T===b))&&X.currentId===g){p.displays.delete(b);return}const I=w.data;Object.keys(I).forEach(T=>{const O=I[T].materialType;!["customize","official"].includes(O)&&!y.includes(O)&&y.push(O)})}),y=Ja(y);let A=JSON.parse(localStorage.getItem("MY_PROCESSING_TYPE_DATA")||"[]");Rt(A)||(A=[]),A.forEach(w=>{y.includes(w.id)&&f.push(w)})}),console.log(["=> 保存的自定义参数",f]),i.materialTypeList=f,i.materialList=d,console.log("保存项目的材料: ",d)}const r=+new Date,s=await this.getDisplayLayerShot(),o={canvasId:this.currentId,canvas:t,extId:(e==null?void 0:e.id)||"",device:i,version:((c=window.MeApi)==null?void 0:c.version)??"0.0.0.0",created:+new Date,modify:r,ua:navigator.userAgent,meta:[],cover:(u=s.canvas)==null?void 0:u.toDataURL()};return console.log(["=> save project data",o]),o}}const X=new S5e,AK="viewportListener";class P5e{constructor(e,t,i){E(this,"name",AK);E(this,"notice");E(this,"onTransform");E(this,"onViewport");E(this,"el");E(this,"timeListener");this.notice=e,this.onTransform=t,this.onViewport=i}refreshListener(e,t,i){this.notice=e,this.onTransform=t,this.onViewport=i}init(e){return!0}onViewportPointerDown(e,t){this.onViewport(!0)}onViewportPointerUp(e,t){this.onViewport(!1),console.log("--------onViewportPointerUp")}onViewportPointerMove(e,t){e.target!==t&&mCanvasManager.currentCanvas.modeManager.curSubEditModeName==="VECTOR_EDITOR"&&this.onTransform(!0)}onViewportPointerCancel(e,t){this.clearTimeListener(),this.onTransform(!1)}clearTimeListener(){this.timeListener&&(clearTimeout(this.timeListener),this.timeListener=void 0)}onTransformerPointerDown(e){const t=e.data.originalEvent;t instanceof TouchEvent?t.touches.length===1&&(this.timeListener=setTimeout(()=>{this.onTransform(!0)},500)):(this.clearTimeListener(),this.onTransform(!1))}onViewportPointerupoutside(e,t){this.onViewport(!1)}onTransformerPointerUp(e){this.clearTimeListener(),this.onTransform(!1)}onTransformerPointerMove(e){this.clearTimeListener(),this.onTransform(!0)}onViewportMove(e){this.onTransform(!1),this.clearTimeListener(),this.notice(e.scale.x,e.x,e.y)}onViewportScale(e){this.onTransform(!1),this.clearTimeListener(),this.notice(e.scale.x,e.x,e.y)}}var Po,Wr;class M5e{constructor(e,t){ke(this,Po,void 0);ke(this,Wr,void 0);E(this,"debounceUpdateBorderGcode",Fc(e=>{var t,i;S(this,Wr).uiState.opMode===Vt.SELECT&&Gi.isConnect()&&[nt.F1,nt.F1Ultra].includes(Gi.getExtId())&&((i=(t=bt().ext.appContext).onCanvasSelected)==null||i.call(t,e))},150));E(this,"debounceLayerChange",Fc(()=>{var a,l;const e=(a=X.currentCanvas)==null?void 0:a.exportCanvasJSON({texture:!1});let t=Fr(e,c=>{const u=c;return u.layerTag||(u.layerTag=ii,u.layerColor=ii),u.layerTag});const i=X.getCanvasDataById(),{treeData:r,newLayerData:s}=dm(t,i);S(this,Wr).setTreeData(r);const o=X.getCanvasDataById().currentLayer;if(o&&!s[o]){const c=((l=e[0])==null?void 0:l.layerTag)||ii;X.currentLayerUpdate({currentLayer:c}),this.updateState({currentLayer:c})}else o&&this.updateState({currentLayer:o});X.editorLayerDataUpdate({newLayerData:s})},100));Qe(this,Po,e),Qe(this,Wr,t),X.removeCanvasListener()}onCanDoChange(e,t){S(this,Po)===X.currentId&&this.updateState({enableUndo:e,enableRedo:t})}onEleAdd(e){S(this,Po)===X.currentId&&(X.noticeCoverDelay(),this.sendEffect({displayAdded:{id:X.currentId,data:e}}),X.handleLayerAfterDisplayAdded([e,...S(this,Wr).uiState.allLayerData]),this.handleDisplayLayerChange(),wt(e)||Gi.setDisplays({sourceCanvasId:X.currentId,targetCanvasId:X.currentId,displayJSONs:e.map(t=>({id:t.id,type:t.type,isFill:t.isFill,sourceId:t.sourceId}))}),S(this,Wr).actionPos(),X.currentCanvas.exportCanvasJSONTree({texture:!1}))}onBeforeHistoryChange(e,t){if(t!=null&&t.otherData){const i=e==="undo"?t.otherData[0]:t.otherData[1];X.editorLayerDataUpdate({newLayerData:i})}}onEleRemove(e){S(this,Po)===X.currentId&&(X.noticeCoverDelay(),X.handleLayerAfterDisplayRemoved(S(this,Wr).uiState.allLayerData,e),this.handleDisplayLayerChange())}onHistoryChange(e,t){S(this,Po)===X.currentId&&X.noticeCoverDelay()}onEleSelect(e,t){var i,r;if(S(this,Po)===X.currentId){let s=((i=e==null?void 0:e.getData)==null?void 0:i.call(e))??e;this.debounceUpdateBorderGcode(s),s||(s={selectedJSON:[],selectedLength:0,groupJSON:{id:"",x:null,y:null,width:null,height:null,angle:null,fill:!1,type:""}});const{selectedJSON:o=[],selectedLength:a,groupJSON:l}=s;if(X.upDataSelectEle(s),!wt(o)){let d=o[0].layerColor,f=X.getCanvasDataById().layerData,p=((r=f[d])==null?void 0:r.order)??0;o.forEach(({layerColor:g})=>{g&&f[g]&&f[g].order>p&&(p=f[g].order,d=g)}),d&&(this.updateState({currentLayer:d}),X.currentLayerUpdate({currentLayer:d}))}if(t&&Ds(t,"layerTag")||Ds(t,"visible")||t==="all"){o.map(f=>{f.layerTag=t.layerTag,f.layerColor=t.layerColor,f.visible=t.visible});const d=X.currentCanvas.exportCanvasJSON({texture:!1});X.handleLayerRecord(d||[]),this.handleDisplayLayerChange()}else if(t){const d=X.getCanvasDataLayerDataById(X.currentId);X.editorLayerStackUpDate([d,d])}const c=Rt(o)&&!wt(o);let{fontFamily:u,fontSource:h}={fontFamily:"",fontSource:""};if((l==null?void 0:l.type)===it.TEXT)u=l.style.fontFamily,h=l.style.fontSource;else{const d=[],f=[];for(let m=0;m<o.length&&o[m].type===it.TEXT;m++)f.push(o[m].style.fontSource),d.push(o[m].style.fontFamily);const p=Ja(d),g=Ja(f);p.length===1&&g.length===1&&(u=p[0],h=g[0])}X.textAttrsValue={fontFamily:u,fontSource:h},this.updateState({eleSelected:c,showAction:this.checkShowAction()&&c,selected:{num:a||o.length,data:o},isGroup:s.isGroup,enableCombine:s.enableCombine,bitmapMask:s.bitmapMask??"",selectedAttrs:l,imageSelected:(l==null?void 0:l.type)===it.BITMAP&&c,textSelected:(l==null?void 0:l.type)===it.TEXT&&c,currentFontFamily:{fontFamily:u,fontSource:h}}),S(this,Wr).actionPos()}}checkShowAction(){return!S(this,Wr).uiState.subMode&&!S(this,Wr).uiState.onImageTracing&&!S(this,Wr).uiState.onImageEditor&&!S(this,Wr).uiState.isTouching}updateMode(e,t,i){S(this,Po)===X.currentId&&(this.updateState({opMode:e,subMode:t,showAction:S(this,Wr).checkShowAction()}),this.updateState({showAction:S(this,Wr).checkShowAction()}),e===Vt.PEN?this.updateState({actionPosition:{x:0,y:0}}):S(this,Wr).actionPos())}onImageEditor(e){S(this,Po)===X.currentId&&this.updateState({onImageEditor:e})}onImageTracing(e){S(this,Po)===X.currentId&&this.updateState({onImageTracing:e})}hasBackground(e){X.hasBackgroundImage||(X.backgroundVisible=!0),X.hasBackgroundImage=e}updateState(e){S(this,Po)===X.currentId&&S(this,Wr).pubUpdateState(e)}sendEffect(e){S(this,Po)===X.currentId&&S(this,Wr).pubSendEffect(e)}getNewLayerData(e){const t=Fr(e,s=>{const o=s;return o.layerTag||(o.layerTag=ii,o.layerColor=ii),o.layerTag}),i=X.getCanvasDataById(X.currentId),{newLayerData:r}=dm(t,i);return r}handleDisplayLayerChange(){this.debounceLayerChange()}}Po=new WeakMap,Wr=new WeakMap;var bK={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(n){(function(e,t,i,r){var s=["","webkit","Moz","MS","ms","o"],o=t.createElement("div"),a="function",l=Math.round,c=Math.abs,u=Date.now;function h(Z,ie,me){return setTimeout(y(Z,me),ie)}function d(Z,ie,me){return Array.isArray(Z)?(f(Z,me[ie],me),!0):!1}function f(Z,ie,me){var Ze;if(Z)if(Z.forEach)Z.forEach(ie,me);else if(Z.length!==r)for(Ze=0;Ze<Z.length;)ie.call(me,Z[Ze],Ze,Z),Ze++;else for(Ze in Z)Z.hasOwnProperty(Ze)&&ie.call(me,Z[Ze],Ze,Z)}function p(Z,ie,me){var Ze="DEPRECATED METHOD: "+ie+`
`+me+` AT 
`;return function(){var pt=new Error("get-stack-trace"),kt=pt&&pt.stack?pt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Dn=e.console&&(e.console.warn||e.console.log);return Dn&&Dn.call(e.console,Ze,kt),Z.apply(this,arguments)}}var g;typeof Object.assign!="function"?g=function(ie){if(ie===r||ie===null)throw new TypeError("Cannot convert undefined or null to object");for(var me=Object(ie),Ze=1;Ze<arguments.length;Ze++){var pt=arguments[Ze];if(pt!==r&&pt!==null)for(var kt in pt)pt.hasOwnProperty(kt)&&(me[kt]=pt[kt])}return me}:g=Object.assign;var m=p(function(ie,me,Ze){for(var pt=Object.keys(me),kt=0;kt<pt.length;)(!Ze||Ze&&ie[pt[kt]]===r)&&(ie[pt[kt]]=me[pt[kt]]),kt++;return ie},"extend","Use `assign`."),v=p(function(ie,me){return m(ie,me,!0)},"merge","Use `assign`.");function _(Z,ie,me){var Ze=ie.prototype,pt;pt=Z.prototype=Object.create(Ze),pt.constructor=Z,pt._super=Ze,me&&g(pt,me)}function y(Z,ie){return function(){return Z.apply(ie,arguments)}}function A(Z,ie){return typeof Z==a?Z.apply(ie&&ie[0]||r,ie):Z}function w(Z,ie){return Z===r?ie:Z}function b(Z,ie,me){f(T(ie),function(Ze){Z.addEventListener(Ze,me,!1)})}function C(Z,ie,me){f(T(ie),function(Ze){Z.removeEventListener(Ze,me,!1)})}function I(Z,ie){for(;Z;){if(Z==ie)return!0;Z=Z.parentNode}return!1}function x(Z,ie){return Z.indexOf(ie)>-1}function T(Z){return Z.trim().split(/\s+/g)}function O(Z,ie,me){if(Z.indexOf&&!me)return Z.indexOf(ie);for(var Ze=0;Ze<Z.length;){if(me&&Z[Ze][me]==ie||!me&&Z[Ze]===ie)return Ze;Ze++}return-1}function F(Z){return Array.prototype.slice.call(Z,0)}function G(Z,ie,me){for(var Ze=[],pt=[],kt=0;kt<Z.length;){var Dn=ie?Z[kt][ie]:Z[kt];O(pt,Dn)<0&&Ze.push(Z[kt]),pt[kt]=Dn,kt++}return me&&(ie?Ze=Ze.sort(function(bs,oo){return bs[ie]>oo[ie]}):Ze=Ze.sort()),Ze}function B(Z,ie){for(var me,Ze,pt=ie[0].toUpperCase()+ie.slice(1),kt=0;kt<s.length;){if(me=s[kt],Ze=me?me+pt:ie,Ze in Z)return Ze;kt++}return r}var R=1;function P(){return R++}function k(Z){var ie=Z.ownerDocument||Z;return ie.defaultView||ie.parentWindow||e}var L=/mobile|tablet|ip(ad|hone|od)|android/i,H="ontouchstart"in e,U=B(e,"PointerEvent")!==r,$=H&&L.test(navigator.userAgent),j="touch",Q="pen",ne="mouse",ve="kinect",Pe=25,De=1,Xe=2,Ne=4,et=8,ze=1,de=2,lt=4,he=8,Ce=16,se=de|lt,Re=he|Ce,He=se|Re,Y=["x","y"],W=["clientX","clientY"];function ge(Z,ie){var me=this;this.manager=Z,this.callback=ie,this.element=Z.element,this.target=Z.options.inputTarget,this.domHandler=function(Ze){A(Z.options.enable,[Z])&&me.handler(Ze)},this.init()}ge.prototype={handler:function(){},init:function(){this.evEl&&b(this.element,this.evEl,this.domHandler),this.evTarget&&b(this.target,this.evTarget,this.domHandler),this.evWin&&b(k(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(k(this.element),this.evWin,this.domHandler)}};function Le(Z){var ie,me=Z.options.inputClass;return me?ie=me:U?ie=Se:$?ie=ti:H?ie=ni:ie=K,new ie(Z,Ve)}function Ve(Z,ie,me){var Ze=me.pointers.length,pt=me.changedPointers.length,kt=ie&De&&Ze-pt===0,Dn=ie&(Ne|et)&&Ze-pt===0;me.isFirst=!!kt,me.isFinal=!!Dn,kt&&(Z.session={}),me.eventType=ie,pe(Z,me),Z.emit("hammer.input",me),Z.recognize(me),Z.session.prevInput=me}function pe(Z,ie){var me=Z.session,Ze=ie.pointers,pt=Ze.length;me.firstInput||(me.firstInput=oe(ie)),pt>1&&!me.firstMultiple?me.firstMultiple=oe(ie):pt===1&&(me.firstMultiple=!1);var kt=me.firstInput,Dn=me.firstMultiple,es=Dn?Dn.center:kt.center,bs=ie.center=Me(Ze);ie.timeStamp=u(),ie.deltaTime=ie.timeStamp-kt.timeStamp,ie.angle=q(es,bs),ie.distance=Ye(es,bs),fe(me,ie),ie.offsetDirection=_e(ie.deltaX,ie.deltaY);var oo=je(ie.deltaTime,ie.deltaX,ie.deltaY);ie.overallVelocityX=oo.x,ie.overallVelocityY=oo.y,ie.overallVelocity=c(oo.x)>c(oo.y)?oo.x:oo.y,ie.scale=Dn?M(Dn.pointers,Ze):1,ie.rotation=Dn?we(Dn.pointers,Ze):0,ie.maxPointers=me.prevInput?ie.pointers.length>me.prevInput.maxPointers?ie.pointers.length:me.prevInput.maxPointers:ie.pointers.length,Ee(me,ie);var ac=Z.element;I(ie.srcEvent.target,ac)&&(ac=ie.srcEvent.target),ie.target=ac}function fe(Z,ie){var me=ie.center,Ze=Z.offsetDelta||{},pt=Z.prevDelta||{},kt=Z.prevInput||{};(ie.eventType===De||kt.eventType===Ne)&&(pt=Z.prevDelta={x:kt.deltaX||0,y:kt.deltaY||0},Ze=Z.offsetDelta={x:me.x,y:me.y}),ie.deltaX=pt.x+(me.x-Ze.x),ie.deltaY=pt.y+(me.y-Ze.y)}function Ee(Z,ie){var me=Z.lastInterval||ie,Ze=ie.timeStamp-me.timeStamp,pt,kt,Dn,es;if(ie.eventType!=et&&(Ze>Pe||me.velocity===r)){var bs=ie.deltaX-me.deltaX,oo=ie.deltaY-me.deltaY,ac=je(Ze,bs,oo);kt=ac.x,Dn=ac.y,pt=c(ac.x)>c(ac.y)?ac.x:ac.y,es=_e(bs,oo),Z.lastInterval=ie}else pt=me.velocity,kt=me.velocityX,Dn=me.velocityY,es=me.direction;ie.velocity=pt,ie.velocityX=kt,ie.velocityY=Dn,ie.direction=es}function oe(Z){for(var ie=[],me=0;me<Z.pointers.length;)ie[me]={clientX:l(Z.pointers[me].clientX),clientY:l(Z.pointers[me].clientY)},me++;return{timeStamp:u(),pointers:ie,center:Me(ie),deltaX:Z.deltaX,deltaY:Z.deltaY}}function Me(Z){var ie=Z.length;if(ie===1)return{x:l(Z[0].clientX),y:l(Z[0].clientY)};for(var me=0,Ze=0,pt=0;pt<ie;)me+=Z[pt].clientX,Ze+=Z[pt].clientY,pt++;return{x:l(me/ie),y:l(Ze/ie)}}function je(Z,ie,me){return{x:ie/Z||0,y:me/Z||0}}function _e(Z,ie){return Z===ie?ze:c(Z)>=c(ie)?Z<0?de:lt:ie<0?he:Ce}function Ye(Z,ie,me){me||(me=Y);var Ze=ie[me[0]]-Z[me[0]],pt=ie[me[1]]-Z[me[1]];return Math.sqrt(Ze*Ze+pt*pt)}function q(Z,ie,me){me||(me=Y);var Ze=ie[me[0]]-Z[me[0]],pt=ie[me[1]]-Z[me[1]];return Math.atan2(pt,Ze)*180/Math.PI}function we(Z,ie){return q(ie[1],ie[0],W)+q(Z[1],Z[0],W)}function M(Z,ie){return Ye(ie[0],ie[1],W)/Ye(Z[0],Z[1],W)}var N={mousedown:De,mousemove:Xe,mouseup:Ne},D="mousedown",z="mousemove mouseup";function K(){this.evEl=D,this.evWin=z,this.pressed=!1,ge.apply(this,arguments)}_(K,ge,{handler:function(ie){var me=N[ie.type];me&De&&ie.button===0&&(this.pressed=!0),me&Xe&&ie.which!==1&&(me=Ne),this.pressed&&(me&Ne&&(this.pressed=!1),this.callback(this.manager,me,{pointers:[ie],changedPointers:[ie],pointerType:ne,srcEvent:ie}))}});var ce={pointerdown:De,pointermove:Xe,pointerup:Ne,pointercancel:et,pointerout:et},ae={2:j,3:Q,4:ne,5:ve},J="pointerdown",xe="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(J="MSPointerDown",xe="MSPointerMove MSPointerUp MSPointerCancel");function Se(){this.evEl=J,this.evWin=xe,ge.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}_(Se,ge,{handler:function(ie){var me=this.store,Ze=!1,pt=ie.type.toLowerCase().replace("ms",""),kt=ce[pt],Dn=ae[ie.pointerType]||ie.pointerType,es=Dn==j,bs=O(me,ie.pointerId,"pointerId");kt&De&&(ie.button===0||es)?bs<0&&(me.push(ie),bs=me.length-1):kt&(Ne|et)&&(Ze=!0),!(bs<0)&&(me[bs]=ie,this.callback(this.manager,kt,{pointers:me,changedPointers:[ie],pointerType:Dn,srcEvent:ie}),Ze&&me.splice(bs,1))}});var rt={touchstart:De,touchmove:Xe,touchend:Ne,touchcancel:et},ot="touchstart",gt="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=ot,this.evWin=gt,this.started=!1,ge.apply(this,arguments)}_(ut,ge,{handler:function(ie){var me=rt[ie.type];if(me===De&&(this.started=!0),!!this.started){var Ze=ct.call(this,ie,me);me&(Ne|et)&&Ze[0].length-Ze[1].length===0&&(this.started=!1),this.callback(this.manager,me,{pointers:Ze[0],changedPointers:Ze[1],pointerType:j,srcEvent:ie})}}});function ct(Z,ie){var me=F(Z.touches),Ze=F(Z.changedTouches);return ie&(Ne|et)&&(me=G(me.concat(Ze),"identifier",!0)),[me,Ze]}var Ct={touchstart:De,touchmove:Xe,touchend:Ne,touchcancel:et},vn="touchstart touchmove touchend touchcancel";function ti(){this.evTarget=vn,this.targetIds={},ge.apply(this,arguments)}_(ti,ge,{handler:function(ie){var me=Ct[ie.type],Ze=fr.call(this,ie,me);Ze&&this.callback(this.manager,me,{pointers:Ze[0],changedPointers:Ze[1],pointerType:j,srcEvent:ie})}});function fr(Z,ie){var me=F(Z.touches),Ze=this.targetIds;if(ie&(De|Xe)&&me.length===1)return Ze[me[0].identifier]=!0,[me,me];var pt,kt,Dn=F(Z.changedTouches),es=[],bs=this.target;if(kt=me.filter(function(oo){return I(oo.target,bs)}),ie===De)for(pt=0;pt<kt.length;)Ze[kt[pt].identifier]=!0,pt++;for(pt=0;pt<Dn.length;)Ze[Dn[pt].identifier]&&es.push(Dn[pt]),ie&(Ne|et)&&delete Ze[Dn[pt].identifier],pt++;if(es.length)return[G(kt.concat(es),"identifier",!0),es]}var Ao=2500,_r=25;function ni(){ge.apply(this,arguments);var Z=y(this.handler,this);this.touch=new ti(this.manager,Z),this.mouse=new K(this.manager,Z),this.primaryTouch=null,this.lastTouches=[]}_(ni,ge,{handler:function(ie,me,Ze){var pt=Ze.pointerType==j,kt=Ze.pointerType==ne;if(!(kt&&Ze.sourceCapabilities&&Ze.sourceCapabilities.firesTouchEvents)){if(pt)mi.call(this,me,Ze);else if(kt&&Mr.call(this,Ze))return;this.callback(ie,me,Ze)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function mi(Z,ie){Z&De?(this.primaryTouch=ie.changedPointers[0].identifier,li.call(this,ie)):Z&(Ne|et)&&li.call(this,ie)}function li(Z){var ie=Z.changedPointers[0];if(ie.identifier===this.primaryTouch){var me={x:ie.clientX,y:ie.clientY};this.lastTouches.push(me);var Ze=this.lastTouches,pt=function(){var kt=Ze.indexOf(me);kt>-1&&Ze.splice(kt,1)};setTimeout(pt,Ao)}}function Mr(Z){for(var ie=Z.srcEvent.clientX,me=Z.srcEvent.clientY,Ze=0;Ze<this.lastTouches.length;Ze++){var pt=this.lastTouches[Ze],kt=Math.abs(ie-pt.x),Dn=Math.abs(me-pt.y);if(kt<=_r&&Dn<=_r)return!0}return!1}var Ei=B(o.style,"touchAction"),Ti=Ei!==r,so="compute",Zo="auto",re="manipulation",Ge="none",Ke="pan-x",Je="pan-y",qe=Nt();function Et(Z,ie){this.manager=Z,this.set(ie)}Et.prototype={set:function(Z){Z==so&&(Z=this.compute()),Ti&&this.manager.element.style&&qe[Z]&&(this.manager.element.style[Ei]=Z),this.actions=Z.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Z=[];return f(this.manager.recognizers,function(ie){A(ie.options.enable,[ie])&&(Z=Z.concat(ie.getTouchAction()))}),Bt(Z.join(" "))},preventDefaults:function(Z){var ie=Z.srcEvent,me=Z.offsetDirection;if(this.manager.session.prevented){ie.preventDefault();return}var Ze=this.actions,pt=x(Ze,Ge)&&!qe[Ge],kt=x(Ze,Je)&&!qe[Je],Dn=x(Ze,Ke)&&!qe[Ke];if(pt){var es=Z.pointers.length===1,bs=Z.distance<2,oo=Z.deltaTime<250;if(es&&bs&&oo)return}if(!(Dn&&kt)&&(pt||kt&&me&se||Dn&&me&Re))return this.preventSrc(ie)},preventSrc:function(Z){this.manager.session.prevented=!0,Z.preventDefault()}};function Bt(Z){if(x(Z,Ge))return Ge;var ie=x(Z,Ke),me=x(Z,Je);return ie&&me?Ge:ie||me?ie?Ke:Je:x(Z,re)?re:Zo}function Nt(){if(!Ti)return!1;var Z={},ie=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(me){Z[me]=ie?e.CSS.supports("touch-action",me):!0}),Z}var Qt=1,en=2,on=4,sn=8,qn=sn,Hr=16,ci=32;function Vr(Z){this.options=g({},this.defaults,Z||{}),this.id=P(),this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=Qt,this.simultaneous={},this.requireFail=[]}Vr.prototype={defaults:{},set:function(Z){return g(this.options,Z),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Z){if(d(Z,"recognizeWith",this))return this;var ie=this.simultaneous;return Z=_h(Z,this),ie[Z.id]||(ie[Z.id]=Z,Z.recognizeWith(this)),this},dropRecognizeWith:function(Z){return d(Z,"dropRecognizeWith",this)?this:(Z=_h(Z,this),delete this.simultaneous[Z.id],this)},requireFailure:function(Z){if(d(Z,"requireFailure",this))return this;var ie=this.requireFail;return Z=_h(Z,this),O(ie,Z)===-1&&(ie.push(Z),Z.requireFailure(this)),this},dropRequireFailure:function(Z){if(d(Z,"dropRequireFailure",this))return this;Z=_h(Z,this);var ie=O(this.requireFail,Z);return ie>-1&&this.requireFail.splice(ie,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Z){return!!this.simultaneous[Z.id]},emit:function(Z){var ie=this,me=this.state;function Ze(pt){ie.manager.emit(pt,Z)}me<sn&&Ze(ie.options.event+Li(me)),Ze(ie.options.event),Z.additionalEvent&&Ze(Z.additionalEvent),me>=sn&&Ze(ie.options.event+Li(me))},tryEmit:function(Z){if(this.canEmit())return this.emit(Z);this.state=ci},canEmit:function(){for(var Z=0;Z<this.requireFail.length;){if(!(this.requireFail[Z].state&(ci|Qt)))return!1;Z++}return!0},recognize:function(Z){var ie=g({},Z);if(!A(this.options.enable,[this,ie])){this.reset(),this.state=ci;return}this.state&(qn|Hr|ci)&&(this.state=Qt),this.state=this.process(ie),this.state&(en|on|sn|Hr)&&this.tryEmit(ie)},process:function(Z){},getTouchAction:function(){},reset:function(){}};function Li(Z){return Z&Hr?"cancel":Z&sn?"end":Z&on?"move":Z&en?"start":""}function Cn(Z){return Z==Ce?"down":Z==he?"up":Z==de?"left":Z==lt?"right":""}function _h(Z,ie){var me=ie.manager;return me?me.get(Z):Z}function Vn(){Vr.apply(this,arguments)}_(Vn,Vr,{defaults:{pointers:1},attrTest:function(Z){var ie=this.options.pointers;return ie===0||Z.pointers.length===ie},process:function(Z){var ie=this.state,me=Z.eventType,Ze=ie&(en|on),pt=this.attrTest(Z);return Ze&&(me&et||!pt)?ie|Hr:Ze||pt?me&Ne?ie|sn:ie&en?ie|on:en:ci}});function xa(){Vn.apply(this,arguments),this.pX=null,this.pY=null}_(xa,Vn,{defaults:{event:"pan",threshold:10,pointers:1,direction:He},getTouchAction:function(){var Z=this.options.direction,ie=[];return Z&se&&ie.push(Je),Z&Re&&ie.push(Ke),ie},directionTest:function(Z){var ie=this.options,me=!0,Ze=Z.distance,pt=Z.direction,kt=Z.deltaX,Dn=Z.deltaY;return pt&ie.direction||(ie.direction&se?(pt=kt===0?ze:kt<0?de:lt,me=kt!=this.pX,Ze=Math.abs(Z.deltaX)):(pt=Dn===0?ze:Dn<0?he:Ce,me=Dn!=this.pY,Ze=Math.abs(Z.deltaY))),Z.direction=pt,me&&Ze>ie.threshold&&pt&ie.direction},attrTest:function(Z){return Vn.prototype.attrTest.call(this,Z)&&(this.state&en||!(this.state&en)&&this.directionTest(Z))},emit:function(Z){this.pX=Z.deltaX,this.pY=Z.deltaY;var ie=Cn(Z.direction);ie&&(Z.additionalEvent=this.options.event+ie),this._super.emit.call(this,Z)}});function wg(){Vn.apply(this,arguments)}_(wg,Vn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ge]},attrTest:function(Z){return this._super.attrTest.call(this,Z)&&(Math.abs(Z.scale-1)>this.options.threshold||this.state&en)},emit:function(Z){if(Z.scale!==1){var ie=Z.scale<1?"in":"out";Z.additionalEvent=this.options.event+ie}this._super.emit.call(this,Z)}});function Kc(){Vr.apply(this,arguments),this._timer=null,this._input=null}_(Kc,Vr,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Zo]},process:function(Z){var ie=this.options,me=Z.pointers.length===ie.pointers,Ze=Z.distance<ie.threshold,pt=Z.deltaTime>ie.time;if(this._input=Z,!Ze||!me||Z.eventType&(Ne|et)&&!pt)this.reset();else if(Z.eventType&De)this.reset(),this._timer=h(function(){this.state=qn,this.tryEmit()},ie.time,this);else if(Z.eventType&Ne)return qn;return ci},reset:function(){clearTimeout(this._timer)},emit:function(Z){this.state===qn&&(Z&&Z.eventType&Ne?this.manager.emit(this.options.event+"up",Z):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function zd(){Vn.apply(this,arguments)}_(zd,Vn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ge]},attrTest:function(Z){return this._super.attrTest.call(this,Z)&&(Math.abs(Z.rotation)>this.options.threshold||this.state&en)}});function Rr(){Vn.apply(this,arguments)}_(Rr,Vn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:se|Re,pointers:1},getTouchAction:function(){return xa.prototype.getTouchAction.call(this)},attrTest:function(Z){var ie=this.options.direction,me;return ie&(se|Re)?me=Z.overallVelocity:ie&se?me=Z.overallVelocityX:ie&Re&&(me=Z.overallVelocityY),this._super.attrTest.call(this,Z)&&ie&Z.offsetDirection&&Z.distance>this.options.threshold&&Z.maxPointers==this.options.pointers&&c(me)>this.options.velocity&&Z.eventType&Ne},emit:function(Z){var ie=Cn(Z.offsetDirection);ie&&this.manager.emit(this.options.event+ie,Z),this.manager.emit(this.options.event,Z)}});function Ca(){Vr.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}_(Ca,Vr,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[re]},process:function(Z){var ie=this.options,me=Z.pointers.length===ie.pointers,Ze=Z.distance<ie.threshold,pt=Z.deltaTime<ie.time;if(this.reset(),Z.eventType&De&&this.count===0)return this.failTimeout();if(Ze&&pt&&me){if(Z.eventType!=Ne)return this.failTimeout();var kt=this.pTime?Z.timeStamp-this.pTime<ie.interval:!0,Dn=!this.pCenter||Ye(this.pCenter,Z.center)<ie.posThreshold;this.pTime=Z.timeStamp,this.pCenter=Z.center,!Dn||!kt?this.count=1:this.count+=1,this._input=Z;var es=this.count%ie.taps;if(es===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=qn,this.tryEmit()},ie.interval,this),en):qn}return ci},failTimeout:function(){return this._timer=h(function(){this.state=ci},this.options.interval,this),ci},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==qn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ea(Z,ie){return ie=ie||{},ie.recognizers=w(ie.recognizers,ea.defaults.preset),new b_(Z,ie)}ea.VERSION="2.0.7",ea.defaults={domEvents:!1,touchAction:so,enable:!0,inputTarget:null,inputClass:null,preset:[[zd,{enable:!1}],[wg,{enable:!1},["rotate"]],[Rr,{direction:se}],[xa,{direction:se},["swipe"]],[Ca],[Ca,{event:"doubletap",taps:2},["tap"]],[Kc]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var bo=1,xg=2;function b_(Z,ie){this.options=g({},ea.defaults,ie||{}),this.options.inputTarget=this.options.inputTarget||Z,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Z,this.input=Le(this),this.touchAction=new Et(this,this.options.touchAction),w_(this,!0),f(this.options.recognizers,function(me){var Ze=this.add(new me[0](me[1]));me[2]&&Ze.recognizeWith(me[2]),me[3]&&Ze.requireFailure(me[3])},this)}b_.prototype={set:function(Z){return g(this.options,Z),Z.touchAction&&this.touchAction.update(),Z.inputTarget&&(this.input.destroy(),this.input.target=Z.inputTarget,this.input.init()),this},stop:function(Z){this.session.stopped=Z?xg:bo},recognize:function(Z){var ie=this.session;if(!ie.stopped){this.touchAction.preventDefaults(Z);var me,Ze=this.recognizers,pt=ie.curRecognizer;(!pt||pt&&pt.state&qn)&&(pt=ie.curRecognizer=null);for(var kt=0;kt<Ze.length;)me=Ze[kt],ie.stopped!==xg&&(!pt||me==pt||me.canRecognizeWith(pt))?me.recognize(Z):me.reset(),!pt&&me.state&(en|on|sn)&&(pt=ie.curRecognizer=me),kt++}},get:function(Z){if(Z instanceof Vr)return Z;for(var ie=this.recognizers,me=0;me<ie.length;me++)if(ie[me].options.event==Z)return ie[me];return null},add:function(Z){if(d(Z,"add",this))return this;var ie=this.get(Z.options.event);return ie&&this.remove(ie),this.recognizers.push(Z),Z.manager=this,this.touchAction.update(),Z},remove:function(Z){if(d(Z,"remove",this))return this;if(Z=this.get(Z),Z){var ie=this.recognizers,me=O(ie,Z);me!==-1&&(ie.splice(me,1),this.touchAction.update())}return this},on:function(Z,ie){if(Z!==r&&ie!==r){var me=this.handlers;return f(T(Z),function(Ze){me[Ze]=me[Ze]||[],me[Ze].push(ie)}),this}},off:function(Z,ie){if(Z!==r){var me=this.handlers;return f(T(Z),function(Ze){ie?me[Ze]&&me[Ze].splice(O(me[Ze],ie),1):delete me[Ze]}),this}},emit:function(Z,ie){this.options.domEvents&&Bee(Z,ie);var me=this.handlers[Z]&&this.handlers[Z].slice();if(!(!me||!me.length)){ie.type=Z,ie.preventDefault=function(){ie.srcEvent.preventDefault()};for(var Ze=0;Ze<me.length;)me[Ze](ie),Ze++}},destroy:function(){this.element&&w_(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function w_(Z,ie){var me=Z.element;if(me.style){var Ze;f(Z.options.cssProps,function(pt,kt){Ze=B(me.style,kt),ie?(Z.oldCssProps[Ze]=me.style[Ze],me.style[Ze]=pt):me.style[Ze]=Z.oldCssProps[Ze]||""}),ie||(Z.oldCssProps={})}}function Bee(Z,ie){var me=t.createEvent("Event");me.initEvent(Z,!0,!0),me.gesture=ie,ie.target.dispatchEvent(me)}g(ea,{INPUT_START:De,INPUT_MOVE:Xe,INPUT_END:Ne,INPUT_CANCEL:et,STATE_POSSIBLE:Qt,STATE_BEGAN:en,STATE_CHANGED:on,STATE_ENDED:sn,STATE_RECOGNIZED:qn,STATE_CANCELLED:Hr,STATE_FAILED:ci,DIRECTION_NONE:ze,DIRECTION_LEFT:de,DIRECTION_RIGHT:lt,DIRECTION_UP:he,DIRECTION_DOWN:Ce,DIRECTION_HORIZONTAL:se,DIRECTION_VERTICAL:Re,DIRECTION_ALL:He,Manager:b_,Input:ge,TouchAction:Et,TouchInput:ti,MouseInput:K,PointerEventInput:Se,TouchMouseInput:ni,SingleTouchInput:ut,Recognizer:Vr,AttrRecognizer:Vn,Tap:Ca,Pan:xa,Swipe:Rr,Pinch:wg,Rotate:zd,Press:Kc,on:b,off:C,each:f,merge:v,extend:m,assign:g,inherit:_,bindFn:y,prefixed:B});var Fee=typeof e<"u"?e:typeof self<"u"?self:{};Fee.Hammer=ea,typeof r=="function"&&r.amd?r(function(){return ea}):n.exports?n.exports=ea:e[i]=ea})(window,document,"Hammer")})(bK);var R5e=bK.exports;const OV=Ld(R5e),$_={appConfig:{width:800,height:600,backgroundColor:15856113},viewportConfig:{worldWidth:400,worldHeight:300,outlineColor:7633530,outlineAlpha:.3,offsetX:20,offsetY:20,offsetBottom:25,fitOffsetRatio:.08,maxScale:khe,grid:{lineColor:7633530,lineColor2:7633530,lineAlpha:.1,lineAlpha2:.3}},selectorConfig:{fillColor:50965,fillAlpha:.16},displayConfig:{hoverColor:3014400,enableFill:!0,layerData:{}}},D5e="AUTO_FILL_SVG",wK={[fd.BEST]:{maxLength:10,minSegments:50,maxSegments:2048},[fd.HIGH]:{maxLength:10,minSegments:30,maxSegments:2048},[fd.MEDIUM]:{maxLength:10,minSegments:20,maxSegments:2048}},fn=ba("canvas_center_module",{getters:{isEmpty(){return X.isEmpty.value},canvasId(){return X.currentIdRef.value},canvasManager(){return X},textAttrs(){return X.textAttrs.value},backgroundVisible(){return X.backgroundVisibleRef.value},hasBackgroundImage(){return X.hasBackgroundImageRef.value},hasCloseImg(){return X.hasCloseImageRef.value},getSelectedDisplay(){return X.getSelectedDisplay()},canvasBgImageMap(){return X.canvasBgImageMap}},actions:{async createCanvas(n){await X.load(n)},unRegisterPluginByType(n){var e;(e=X.currentCanvas)==null||e.unRegisterPluginByType(n)},getProjectShot(n){return X.getDisplayLayerShot(n)},async loadCanvas(n){return await X.load(void 0,n)},clear(){X.clear()},cvnMsgList(){return X.getAllCanvasMessage()},canvasDisplays(n){return X.canvasDisplays(n)},updateCanvasArea(n){X.updateCanvasArea(n)},cleanCanvasBackdrop(n,e=!1){X.cleanCanvasBackdrop(n,e)},updateCanvasBackdrop(n,e,t){X.updateCanvasBackDrop(n,e,t)},switchBackgroundVisible(n){X.updateBackgroundVisibility(n)},clearProjectCanvasBgImageMap(){X.clearProjectCanvasBgImageMap()},updateLocalImg(n,e){X.setLocalCanvasBackgroundStatus(X.currentId,{img:n,option:e})},hasLocalImg(){var n;return((n=X.getCanvasDataById())==null?void 0:n.isHasCloseImg)??!1},getLayerOrder(){return X.getLayerOrder()},getCanvasData(n){return X.getLiveCanvasData(n)},extractContours(n){return X.extractContours(n)},toJson(){return X.toJson()},async loadResToCanvas(n){X.isEmpty.value&&await X.load();const e={type:mc.File,file:n.file,options:{offsetX:0,offsetY:0,parseColor:n.parseColor??void 0,width:n.width,height:n.height,cancelSelected:n.cancelSelected??!1}};await X.insertElement(e)},isAutoFillSvg(n){bv().set(D5e,n)},realTimeCanvasData(){return X.realTimeCanvasData()},clearCanvasSelected(){var n;(n=X.currentCanvas)==null||n.clearSelected()},selectSpecDisplays(n){var e;(e=X.currentCanvas)==null||e.selectSpecDisplays(n)},projectChange(n){X.projectChange(n)},projectRemove(n){X.projectRemove(n)},updateUnit(n){X.updateUnit(n)},markClearFn(n){var e;return(e=X.currentCanvas)==null?void 0:e.setupAssistantEle(n)},getSelected(){return X.currentCanvas.selected},setSelected(n){const e=X.currentCanvas;e.selected=n},canvasEventOn(n,e,t=!1){t?X.currentCanvas.once(n,e):X.currentCanvas.on(n,e)},canvasEventOff(n,e){X.currentCanvas.off(n,e)},switchDragMode(n){X.currentCanvas.isDragMode=n},isSelectMode(){return X.isSelectMode()},allCurrentIds(){return X.canvasDataList.map(n=>n.id)},disabledImportToCanvas(){return X.toolCanvasOnBusy.value||X.onGraffiti.value},clearAllElement(){X.clearAllElement()},exportCanvasJSONTree(){var n;return((n=X.currentCanvas)==null?void 0:n.exportCanvasJSONTree())??[]},getSpecifiedDisplaysShotById(n){var e;return(e=X.currentCanvas)==null?void 0:e.getSpecifiedDisplaysShotById(n)},clearCanvasShot(){X.clearCoverTimer()},noticeCanvasCover(){X.currentCanvas&&!wt(X.currentId)&&X.noticeCanvasCover(X.currentId,!0)}}});var xf=(n=>(n.LOCK="bottomLeft",n.COPY="topRight",n.DELETE="topLeft",n.SCALE="bottomRight",n.ROTATE="rotator",n))(xf||{});class k5e{constructor(){E(this,"useCanvasStore",fn());E(this,"staticOptions");E(this,"_imageConfig");E(this,"config",$_);E(this,"displayConfig");E(this,"rulerConfig",{positions:[fs.TOP,fs.LEFT],pixelPerUnit:1,backgroundColor:15856113,scaleColor:14014423,scaleAlpha:1,borderColor:14014423,fontColor:7633530,markColor:51200,markAlpha:.1});E(this,"buttonConfig",{});E(this,"imageImportConfig",{});E(this,"guideLineConfig");E(this,"tempCanvas");E(this,"buttons",{})}setButtons(e){return this.buttonConfig={attrs:this.buttonAttrs(),map:e},this}get imageConfig(){return this._imageConfig??{}}seTimageConfig(e){return this._imageConfig=e,this}initCanvas(e,t){const i=X.canvasMap.size===0,r=new Map;if(!i){if(X.clearAllElement(),t)r.set(t.canvasId,X.currentCanvas);else{const s=Gp();r.set(s,X.currentCanvas)}return r}if(this.initCanvasStaticConfig(this.staticOptions??{}),t)return this.initCanvasWithCanvasData(t);{const s=this.createCanvas(e),o=Gp();return r.set(o,s),r}}initConfig(e=!1){this.staticOption().setConfig(e).setTextCurveConfig().setCursorConfig().setImageProcessorConfig().setTransformerConfig(e).setRulerConfig().setDisplayConfig()}staticOption(){return Mo.selectionFillStyle={color:2653430,alpha:.3},Za.color=37768,this}setConfig(e=!1){return this}setDisplayConfig(){return this}setRulerConfig(){return this}setTextCurveConfig(){return this}setCursorConfig(){return this}setImageProcessorConfig(){return this}setTransformerConfig(e=!1){return this}createToolCanvas(){return this.initCanvasStaticConfig(this.staticOptions??{}),this.initConfig(!0),new x1($_)}getTempCanvas(){return this.initCanvasStaticConfig(this.staticOptions??{}),this.initConfig(!1),this.tempCanvas||(this.tempCanvas=new x1($_)),this.tempCanvas}createCanvas(e){this.initCanvasStaticConfig(this.staticOptions??{}),this.initConfig(),$_.hitAreaConfig={enabled:Gi.preciseVectorPathSelection(),expansion:{padding:3}};const t=new x1($_);if(PA(wK[Gi.quality()]),this.displayConfig&&t.updateDisplayConfig(this.displayConfig),e)this.bindCanvas(t,e);else{const i=document.createElement("div");i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",document.body.appendChild(i),i.appendChild(t.view)}return t}bindCanvas(e,t){e==null||e.start();const i=new yOe(t.getBoundingClientRect(),this.rulerConfig);e.registerPlugin(i);const{current:r,fractionDigits:s,scale:o}=Gi.unit(),a=new _Oe({unit:r,pixelPerUnit:r===_C.MM?1:1/o,fractionDigits:s,enableAdsorb:!0});e.registerPlugin(a),t.appendChild(e.view),e.resizeCanvasTo(t),e.render()}initCanvasStaticConfig(e){k9.maxSize=e.maxSize??4096,hu.enabledDoubleClickInteraction=this.enabledMask(),Ya.curveX=e.curveX??56,Vu.showAuxiliaryGraphic=!1,Vu.circleAnchorConf.hitArea=20,Vu.rectAnchorConf.hitAreaW=20,Vu.rectAnchorConf.hitAreaH=20,kd.converToLayerColor=t=>{const{r:i,g:r,b:s}=ho(t).toRgb();let o=t,a;return Lhe.forEach(l=>{const{r:c,g:u,b:h}=ho(l).toRgb(),d=Math.sqrt((i-c)*(i-c)+(r-u)*(r-u)+(s-h)*(s-h));a===void 0&&(a=d,o=l),d<a&&(o=l,a=d)}),o},kd.convertFillColor=t=>t}clearImageProcessDic(){window.MeApi&&window.MeApi.fileHelper.deleteDictory("temporary","/imageProcess/")}setGraphicQuality(e){console.log(e.getGraphicsCurves(),"<= 矢量图形质量......")}createButtons(e){var i;const t={};(i=e==null?void 0:e.map)==null||i.forEach((r,s)=>{const o=s!=="rotator"?{x:-22.6,y:-22.6,strokeAlpha:0,padding:0,iconSize:44,fill:16777215,fillAlpha:0,fillActive:16777215}:{x:-12.6,y:-12.6,stroke:37768,strokeWidth:1.5,strokeAlpha:1,iconSize:20,padding:2,fill:16777215,fillAlpha:1,fillActive:16777215},a={...o,shape:"ellipse",icon:r.icon,iconHover:r.iconHover,x:r.x??o.x,y:r.y??o.y},l=(u,h)=>{for(let d in t)d!==h&&(t[d].component.alpha=u?0:1)},c=new iE(a);c.on("pointerdown",()=>{c.isHover=!0,s==="rotator"&&(X.onElementRotate=!0,this.buttons.rotator.component.alpha=1),l(!0,s)}),c.on("pointercancel",()=>{c.isHover=!1,X.onElementRotate=!1,l(!1,"")}),c.on("pointerupoutside",()=>{c.isHover=!1,X.onElementRotate=!1,l(!1,"")}),c.on("pointerup",()=>{c.isHover=!1,X.onElementRotate=!1,l(!1,"")}),t[s]={component:c,stopEvent:!1}});for(let r in t)this.buttons[r]=t[r];return t}hideRotateButton(e){this.buttons.rotator&&!X.onRotateRef.value&&(this.buttons.rotator.component.alpha=e?0:1)}}QY("DoubleTap",{maxDistance:20});class O5e extends k5e{constructor(){super(...arguments);E(this,"insertConfig",{offsetX:"center",offsetY:"center",parseColor:!1,cancelSelected:!0,fitSize:{width:40}});E(this,"imageImportConfig",{fitViewportRatio:.8,fitToViewPort:!0,offsetX:"center",offsetY:"center"});E(this,"qrCodeSize",{width:30,height:30});E(this,"barCodeSize",{width:80,height:24})}initCanvasWithCanvasData(t){const i=new Map;let r;const s=X.currentCanvas;return s?(r=s,r==null||r.stop()):r=this.createCanvas(),i.set(t.canvasId,r),i}staticOption(){return this.staticOptions={maxSize:4096,enabledDoubleClickInteraction:!1,curveX:46},super.staticOption()}setConfig(t=!1){return this.config=Ln(this.config,{appConfig:{width:800,height:600,backgroundColor:14935268},viewportConfig:{worldWidth:400,worldHeight:300,wheelOnView:!0,align:t?Ua.AUTO:Ua.TOP_LEFT,fitOffsetRatio:0,offsetX:t?0:20,offsetY:t?0:20,grid:{lineColor:7633530,lineColor2:7633530,lineAlpha:.12,lineAlpha2:.3}}}),super.staticOption()}setTextCurveConfig(){return this.config=Ln(this.config,{textCurveConfig:{styleOpts:{minSize:14,outlineColor:I_,shape:"component",shapeAttrs:{[_5e]:{component:new iE({icon:this.imageConfig.textCurve,shape:"ellipse",iconSize:18,x:-B1/2,y:-B1/2,fill:16777215,fillAlpha:1,stroke:37768,strokeWidth:1.5,padding:3,strokeAlpha:1})}}},handlePathStyle:{color:I_},autoAdjustViewPadding:this.getAutoAdjustViewPadding(),zIndex:2,lifecycle:{onDragStart(){},onDragEnd(){}}}}),super.staticOption()}setCursorConfig(){return this.config=Ln(this.config,{cursorConfig:[{name:"pen",url:this.imageConfig.pen,style:"2 2,auto"},{name:"cutter",url:this.imageConfig.cutter,style:"5 5,auto"},{name:"magicWand",url:this.imageConfig.magicWand,style:"6 6,auto"},{name:"vectorPointAdd",url:"images/vectorPointAdd.svg",style:"6 6,auto"},{name:"vectorMove",url:"images/v-move.svg",style:"6 6,auto"},{name:"vectorDraw",url:"images/vector-draw.svg",style:"6 6,auto"},{name:"drawPoint",url:"images/draw-point.svg",style:"6 6,auto"},{name:"cursor-rotate-up",url:"images/cursor-rotate-up.svg",style:"6 6,auto"}]}),super.setCursorConfig()}enabledMask(){return!1}setImageProcessorConfig(){var t,i,r,s;return this.config=Ln(this.config,{imageProcessConfig:{backdrop:this.imageConfig.imgEditorBaseDrop,cutter:{groupConfig:{space:0,margin:10,align:Om.center},showDefaultArea:!1,confirm:{icon:(t=this.imageConfig.cutterSava)==null?void 0:t.icon,iconHover:(i=this.imageConfig.cutterSava)==null?void 0:i.iconHover},cancel:{icon:(r=this.imageConfig.cutterCancel)==null?void 0:r.icon,iconHover:(s=this.imageConfig.cutterCancel)==null?void 0:s.iconHover}},asyncMode:{enabled:!0,async saveImageData(o){if(Mb.MeApi){const{width:a,height:l}=o,{filePath:c}=await Mb.MeApi.fileHelper.saveFileWithFetch("temporary","/imageProcess/",o.data);return{filePath:c,width:a,height:l}}},async loadImageData(o){if(Mb.MeApi){const{filePath:a,width:l,height:c}=o,u=await Mb.MeApi.fileHelper.read2Buffer(a);return new ImageData(Uint8ClampedArray.from(u),l,c)}}},lifecycle:{onOpen(){},onClose(){},onSave(){}}},vectorEditorConfig:{enable:!1,lifeCycleConfig:{onStart(){},onAnchorTypeChange(o){console.log(o)},onAnchorAdd(){},onFusionNode(){},onExitVectorDraw(){}}}}),super.setCursorConfig()}transformAttrConfig(){var r;const t={shape:"ellipse",x:-10,y:0,strokeActiveAlpha:0,strokeAlpha:1,stroke:I_,strokeWidth:1,padding:2,radius:0,iconSize:16},i=new iE({icon:(r=this.buttonConfig.map)==null?void 0:r.get(xf.ROTATE).icon,...t});return i.cursor="cursor-rotate-up",{rotator:{component:i}}}setTransformerConfig(t=!1){return this.config=Ln(this.config,{transformerConfig:{boundingBoxes:"all",defaultHandleMode:t?_R.pixi:_R.custom,handleModes:{custom:{handleStyle:{shape:"component",shapeAttrs:this.createButtons(this.buttonConfig),hitAreaPadding:2,minSize:0,outlineColor:I_,keepHandles:["rotator"]}},lock:{handleStyle:{shape:"component",shapeAttrs:{},hitAreaPadding:2,minSize:0,keepHandles:[],rotatorDistance:0}},pixi:{handleStyle:{outlineColor:I_,radius:8,shapeAttrs:this.transformAttrConfig()}}},wireframeStyle:{color:37768,thickness:1}}}),super.setTransformerConfig()}setDisplayConfig(){return this.displayConfig={layerTag:ii,layerColor:ii,visible:!0,layerData:{},updateCanvasDisplay:!1},super.setDisplayConfig()}setRulerConfig(){return this.rulerConfig={positions:[fs.TOP,fs.LEFT],backgroundColor:15856113,scaleColor:14014423,scaleAlpha:1,borderColor:14014423,fontColor:7633530,markColor:51200,markAlpha:.1},super.setRulerConfig()}getAutoAdjustViewPadding(){const o=B1/2;return{top:20+o,left:20+o,right:160+o,bottom:25+o}}buttonAttrs(){return{shape:"ellipse",x:-18.6,y:-18.6,stroke:9610137,strokeAlpha:.3,padding:8,fill:16777215,fillActive:16777215}}codeSize(t){return t?this.qrCodeSize:this.barCodeSize}}QY("DoubleTap",{maxDistance:20});const L5e=()=>({id:"",x:null,y:null,width:null,height:null,angle:null,fill:!1,type:"",lockRatio:!1,filterList:[],sharpness:50,grayValue:[0,255],style:{}}),LV={opMode:Vt.SELECT,subMode:void 0,currentId:"",canvasView:void 0,enableUndo:!1,enableRedo:!1,bitmapMask:"",eleSelected:!1,isGroup:!1,enableCombine:!1,selected:{num:0,data:[]},layerShot:void 0,selectedAttrs:L5e(),imageSelected:!1,textSelected:!1,allLayerData:[],currentCanvasData:void 0,treeData:[],currentLayer:ii,hasLayer:!1,currentFontFamily:{fontFamily:"",fontSource:""},actionPosition:{x:void 0,y:void 0},canvasScale:1,canvasOffset:{x:0,y:0},showAction:!1,onImageTracing:!1,onImageEditor:!1,isTouching:!1,isZooming:!1,isTransformTouch:!1,menuPosition:{x:0,y:0},hasBackground:!1,hasShowBackground:!1};class N5e extends Yc{constructor(){super(...arguments);E(this,"timerListener");E(this,"firstInit",!0);E(this,"currentHeight",0)}createState(){return{...LV}}initWatch(){yt(()=>si().unit,t=>{X.updateUnit(t)},{immediate:!0}),yt(()=>si().autoSnapping,t=>{X.updateAutoSnapping(t)},{immediate:!0}),yt(()=>si().quality,t=>{X.currentCanvas&&PA(wK[t])},{immediate:!0}),yt(()=>X.currentIdRef.value,(t,i)=>{var s;X.currentCanvas&&(this.updateState({...LV}),this.initCanvasListener(X.currentId),setTimeout(()=>{var a;const o=(a=X.getCanvasDataById())==null?void 0:a.currentLayer;if(o){const l=X.exportCanvasJSON(!1);this.updateState({currentLayer:o,allLayerData:l})}},200)),t&&wt(i)&&this.updateCanvasState(),this.updateState({menuPosition:{x:0,y:0}});const r=(s=X.currentCanvas)==null?void 0:s.operationStack;r&&(this.updateState({enableUndo:r.canUndo,enableRedo:r.canRedo}),r.on(ko.CAN_DO_CHANGE,(o,a)=>{this.updateState({enableUndo:o,enableRedo:a})}))},{immediate:!0}),yt(()=>X.bridgeTreeDataRef.value,t=>{t&&this.updateState({treeData:t,hasLayer:t.length>0})},{immediate:!0}),yt([()=>X.hasBackgroundImageRef.value,()=>X.backgroundVisibleRef.value],([t,i])=>{this.updateState({hasBackground:t,hasShowBackground:i})},{immediate:!0})}setEventHandler(){this.registerEventHandler(_ze,this.initCanvas),this.registerEventHandler(yze,this.binderCanvas),this.registerEventHandler(xze,this.stopCanvas),this.registerEventHandler(Cze,this.deserializeDisplayJSON),this.registerEventHandler(bze,this.undo),this.registerEventHandler(wze,this.redo),this.registerEventHandler(Aze,this.clear),this.registerEventHandler(Eze,this.zoom),this.registerEventHandler(Ize,this.setZoom),this.registerEventHandler(Tze,this.switchBackgroundVisible)}async initCanvas(t){await X.load(t.data.ele),this.sendEffect({canvasCreated:{value:!0}})}binderCanvas(t){t.data.ele.addEventListener("touchstart",o=>{var l;this.sendEffect({onCanvasTouch:{type:"touchstart",e:o}});const a=[];for(let c=0;c<o.touches.length;c++){const u=o.touches[c].target;u instanceof HTMLElement&&((l=u.parentElement)==null?void 0:l.id)==="editor-canvas"&&a.push(o.touches[c])}this.timerListener&&(clearTimeout(this.timerListener),this.timerListener=void 0),this.updateState({isTouching:a.length>0,showAction:this.checkShowAction(a.length>0),menuPosition:{x:0,y:0}}),a.length==2?this.timerListener=setTimeout(()=>{this.updateState({isZooming:!0})},500):a.length==1&&(this.timerListener=setTimeout(()=>{this.updateState({isTransformTouch:!0})},500))});const i=new OV.Manager(t.data.ele),r=new OV.Tap({pointers:2,event:"tap"});window.document.addEventListener("click",o=>{this.updateState({menuPosition:{x:0,y:0}})}),i.add(r),i.on("tap",o=>{this.uiState.subMode!=="VECTOR_EDITOR"&&(this.updateState({menuPosition:{x:o.center.x,y:o.center.y}}),this.uiState.eleSelected?jt(Zt.doubleFingersClick,{elementId:ki.elementClick}):jt(Zt.doubleFingersClick,{elementId:ki.noElementClick}))}),t.data.ele.addEventListener("touchmove",o=>{this.sendEffect({onCanvasTouch:{type:"touchmove",e:o}})}),t.data.ele.addEventListener("touchend",o=>{this.canvasTouchCancel(o)}),t.data.ele.addEventListener("touchcancel",o=>{this.canvasTouchCancel(o)});const s=X.updateBinderDom(t.data.ele,t.data.isResize);if(X.hasInitHtml=!0,s)this.updateState({canvasView:s});else throw new Error("canvas is not init");X.updateAutoSnapping(si().autoSnapping),X.updateUnit(si().unit)}canvasTouchCancel(t){var r;this.sendEffect({onCanvasTouch:{type:"touchend",e:t}}),this.timerListener&&(clearTimeout(this.timerListener),this.timerListener=void 0);const i=[];for(let s=0;s<t.touches.length;s++){const o=t.touches[s].target;o instanceof HTMLElement&&((r=o.parentElement)==null?void 0:r.id)==="editor-canvas"&&i.push(t.touches[s])}this.updateState({isTouching:i.length>0,isZooming:i.length===2,showAction:this.checkShowAction(i.length>0),isTransformTouch:i.length===1}),this.actionPos()}updateViewport(t,i,r){this.updateState({canvasOffset:{x:i,y:r},canvasScale:t})}isTransformTouch(t){this.updateState({isTransformTouch:t})}initCanvasListener(t){const i=X.currentCanvas;if(X.updateUnit(Gi.unit()),this.updateState({allLayerData:[],treeData:[]}),X.removeCanvasListener(),!i)throw new Error("canvas is not init");const r=i.getPluginByName(AK);if(r)r.refreshListener(this.updateViewport.bind(this),this.isTransformTouch.bind(this),a=>{});else{const a=new P5e(this.updateViewport.bind(this),this.isTransformTouch.bind(this),l=>{});i.registerPlugin(a)}i.getOtherData=()=>{const{layerStack:a}=X.getCanvasDataById()??{};return a||[]};const s=new M5e(t,this);this.updateState({canvasOffset:{x:i.viewport.x,y:i.viewport.y},canvasScale:i.viewport.scale.x}),i.on(ko.CAN_DO_CHANGE,s.onCanDoChange.bind(s)).on(gn.NEW_DISPLAYS_ADDED,s.onEleAdd.bind(s)).on(gn.SELECT_OBJECT,s.onEleSelect.bind(s)).on(gn.DISPLAYS_REMOVED,s.onEleRemove.bind(s)).on(gn.HISTORY_CHANG,s.onHistoryChange.bind(s)).on(gn.SELECT_OBJECT_TRANSFORMERED,s.onEleSelect.bind(s)).on(gn.UPDATE_IMAGE_TRACING_VISIBLE,s.onImageTracing.bind(s)).on(gn.UPDATE_IMAGE_PROCESS_VISIBLE,s.onImageEditor.bind(s)).on(gn.BEFORE_HISTORY_CHANG,s.onBeforeHistoryChange.bind(s)).on(Gc.CHANGE,s.updateMode.bind(s)).on(gn.UPDATE_BACKDROP_RESULT,s.hasBackground.bind(s)).on(gn.ZOOMED,a=>{this.updateState({canvasScale:a,isZooming:this.uiState.isTouching})}).on(gn.DRAW_DISPLAY_DONE,()=>{console.log("--绘制完成")}).on(gn.SELECTED_TRANSFORM_COMMIT,a=>{var c;const l=((c=a==null?void 0:a.getData)==null?void 0:c.call(a))??a;X.upDataSelectEle(l),X.noticeCoverDelay(),this.updateCanvasState()}),i.updateEditMode(Vt.SELECT);const{layerStack:o}=X.getCanvasDataById()??{};if(wt(o)||this.firstInit){const a=i.exportCanvasJSON({texture:!0});s.onEleAdd(a)}this.firstInit=!1}updateCanvasState(){const t=X.currentId;if(wt(t))return;const i=X.canvasState();if(X.groupJSON=i.groupJSON,i){const r=Rt(i.selectedJSON)&&!wt(i.selectedJSON),s=X.exportCanvasJSON(!1);let{fontFamily:o,fontSource:a}={fontFamily:"",fontSource:""};if(i.groupJSON.type===it.TEXT)o=i.groupJSON.style.fontFamily,a=i.groupJSON.style.fontSource;else{let l=[],c=[];for(let d=0;d<i.selectedJSON.length&&i.selectedJSON[d].type===it.TEXT;d++)c.push(i.selectedJSON[d].style.fontSource),l.push(i.selectedJSON[d].style.fontFamily);const u=Ja(l),h=Ja(c);u.length===1&&h.length===1&&(o=u[0],a=h[0])}X.textAttrsValue={fontFamily:o,fontSource:a},this.updateState({currentId:t,enableUndo:i.enableUndo,enableRedo:i.enableRedo,eleSelected:r,enableCombine:i.enableCombine,isGroup:i.isGroup,selected:{num:i.selectedLength||i.selectedJSON.length,data:i.selectedJSON},showAction:this.checkShowAction(),selectedAttrs:i.groupJSON,imageSelected:i.groupJSON.type===it.BITMAP,textSelected:i.groupJSON.type===it.TEXT,allLayerData:s,currentCanvasData:X.getCanvasDataById(),currentFontFamily:{fontFamily:o,fontSource:a},menuPosition:{x:0,y:0}})}this.actionPos(),X.getDisplayLayerShot().then(r=>{this.updateState({layerShot:r})})}noticeIsTouchTransform(t){this.timerListener&&(clearTimeout(this.timerListener),this.timerListener=void 0),this.updateState({isTransformTouch:t})}checkShowAction(t=this.uiState.isTouching){const i=this.uiState.eleSelected&&!this.uiState.subMode&&!this.uiState.onImageTracing&&!X.toolCanvasOnBusy.value&&!t;return X.toolCanvasOnBusy.value||tt.canvasFactory.hideRotateButton(!i),i}actionPos(){var p;this.noticeIsTouchTransform(this.uiState.isTouching);const{x:t=0,y:i=0,scale:r={x:1,y:1}}=((p=X.currentCanvas)==null?void 0:p.viewport)??{},s=this.uiState.selectedAttrs.x*r.x+t,o=this.uiState.selectedAttrs.y*r.y+i,{width:a,height:l,angle:c=0}=this.uiState.selectedAttrs,u=s+a*r.x/2,h=o+l*r.y/2;let d=0,f=0;if(c===0)this.currentHeight=l*r.y/2,d=u,f=o+l*r.y;else{const g=this.currentHeight*Math.sin(c*(Math.PI/180)),m=this.currentHeight*Math.cos(c*(Math.PI/180));d=u-g,f=h+m}this.updateState({actionPosition:{x:d,y:f}})}undo(){if(this.uiState.enableUndo)X.undo(),this.updateState({actionPosition:{x:0,y:0}});else throw new Error("undo is not enable")}redo(){if(this.uiState.enableRedo)X.redo(),this.updateState({actionPosition:{x:0,y:0}});else throw new Error("redo is not enable")}deserializeDisplayJSON(t){const i=t.data.canvasDataList.filter(s=>s.id===t.data.currentId),{displays:r}=i[0];Rt(r)&&X.importDisplayJSON(r,{createNewID:!1,needRecord:!1,autoSelected:!1})}setTreeData(t){X.bridgeTreeData=Wa(t,"order").reverse()}stopCanvas(){var t,i;(t=X.currentCanvas)==null||t.finishCurMode(),(i=X.currentCanvas)==null||i.clearSelected(),X.stopCanvas()}clear(){X.clear()}pubUpdateState(t){this.updateState(t)}pubSendEffect(t){this.sendEffect(t)}zoom(t){t.positive?jt(Zt.buttonClick,{elementId:ki.enlarge}):jt(Zt.buttonClick,{elementId:ki.shrink}),X.zoom(t.positive)}setZoom(t){t.scale===-1?X.currentCanvas.setViewportToFit():X.currentCanvas.setZoom(t.scale)}switchBackgroundVisible(t){X.updateBackgroundVisibility(t.show)}onDestroy(){super.onDestroy(),X.hasInitHtml=!1}}const B5e=(n,e)=>{let i=n;if(e=Math.floor(Math.abs(e)),e>6&&(e=6),n.toString().indexOf("e")!==-1){const s=n.toString().split("e"),o=Number(s[1]);s[1]=(o+(o>=0?e:-e)).toString(),i=s.join("e")}else i=`${n}e${e}`;return Math.round(i)/Math.pow(10,e)},NV=(n,e)=>Number(B5e(n,e).toFixed(e)),F5e=[it.LINE.toString(),it.RECT.toString(),it.CIRCLE.toString(),it.POLYGON.toString(),it.PATH.toString()];class wpt extends Yc{setEventHandler(){this.registerEventHandler(Sze,this.enterVecEditor),this.registerEventHandler(Pze,this.deleteNode),this.registerEventHandler(Mze,this.finishVecEditor),this.registerEventHandler(Rze,this.changeNodeType),this.registerEventHandler(Dze,this.changeNodeAlign)}createState(){return{curAnchorType:[],selectedNum:0,isAddMode:!1,enable:!1,x:[],y:[]}}initWatch(){yt([()=>X.selectJSONRef.value,()=>X.groupJSONRef.value],([e,t])=>{const i=Gi.unit().fractionDigits,r=Ja((e==null?void 0:e.map(a=>NV((a==null?void 0:a.x)||0,i)))||[]),s=Ja((e==null?void 0:e.map(a=>NV((a==null?void 0:a.y)||0,i)))||[]),o=Ja((e==null?void 0:e.map(a=>(a==null?void 0:a.cpType)??""))||[]);this.updateState({enable:e.length===1&&F5e.includes(t==null?void 0:t.type),selectedNum:e.length,x:r,y:s,curAnchorType:o})},{immediate:!0})}enterVecEditor(e){jt(Zt.edit,{name:"nodeEdit",type:"nodeEditButton"}),this.updateState({isAddMode:e.isPenMode}),X.enterVecEditor(e.isPenMode)}finishVecEditor(){var e;jt(Zt.edit,{name:"vectorDrawExit"}),(e=X.currentCanvas)==null||e.finishCurMode(),this.updateState({isAddMode:!1})}changeNodeType(e){e.type===di.STRAIGHT?jt(Zt.buttonClick,{elementId:ki.straightPoint}):e.type===di.NO_MIRRORING?jt(Zt.buttonClick,{elementId:ki.symmetricalPoint}):e.type===di.MIRROR_ANGLE?jt(Zt.buttonClick,{elementId:ki.asymmetricalPoint}):e.type===di.MIRROR_ANGLE_AND_LENGTH&&jt(Zt.buttonClick,{elementId:ki.anchorSymmetricalPoint}),X.changeNodeType(e.type)}changeNodeAlign(e){X.changeNodeAlign(e.type)}deleteNode(){X.deleteSelectedElement()}}class U5e{constructor(){E(this,"ignoreGlobalShowKeys",[]);E(this,"messageCallbackMap",new Map);E(this,"messageInstanceMap",new Map)}addIgnoreGlobalShowKeys(...e){this.ignoreGlobalShowKeys.push(...e)}addMessageCallback(e,t){this.messageCallbackMap.set(e,t)}removeMessageCallback(e){this.messageCallbackMap.delete(e)}showGlobalMessage(e){var i;if(e.key&&this.ignoreGlobalShowKeys.includes(e.key)){(i=this.messageCallbackMap.get(e.key))==null||i({message:e});return}const t=tt.modal.showMessage(e);e.key&&this.messageInstanceMap.set(e.key,t)}destroyMessage(e){var i,r;const{key:t}=e;if(this.messageCallbackMap.has(t)){(i=this.messageCallbackMap.get(t))==null||i({isDestroy:!0});return}this.messageInstanceMap.has(t)&&((r=this.messageInstanceMap.get(t))==null||r.close(),this.messageInstanceMap.delete(t))}}const HA=new U5e;window.ME.messageManager=HA;class G5e{constructor(){this.axios=fi.create({timeout:3e4,transformRequest:[e=>JSON.stringify(e)],transformResponse:[e=>JSON.parse(e)]}),this.interceptors()}interceptors(){this.axios.interceptors.request.use(e=>(e.headers["Content-Type"]="application/json;charset=UTF-8",Promise.resolve(e)),e=>Promise.reject(e)),this.axios.interceptors.response.use(e=>{const{status:t,data:i}=e;return t===200&&i.code===0?Promise.resolve(i.data):Promise.reject(i)},e=>Promise.reject(e))}apis(e){const t=this,i=Object.keys(e),r={};return i.forEach(s=>{const o=e[s].split(" ");let[a,l="GET"]=o;l=l.toLowerCase(),Object.defineProperty(r,s,{value(...c){const u=l.toUpperCase();if(u==="GET")return t.axios.get(a,...c);if(u==="POST")return t.axios.post(a,...c);if(u==="PUT")return t.axios.put(a,...c);if(u==="PATCH")return t.axios.patch(a,...c);if(u==="DELETE")return t.axios.delete(a,...c);const h={url:a,method:l,...c};return t.axios(h)}})}),r}}const H5e=new G5e;function BV(n,e,t){const i=new Date;i.setTime(i.getTime()+t*24*60*60*1e3);const r=`expires=${i.toUTCString()}`;document.cookie=`${n}=${e}; ${r}; path=/`}function V5e(n){const e=`${n}=`,t=document.cookie.split(";");for(let i=0;i<t.length;i++){const r=t[i].trim();if(r.indexOf(e)===0)return r.substring(e.length,r.length)}return""}let z5e=class{getExt(){return bt().ext}cancelAllDownloadAndUploadTask(){return kn().cancelAllDownloadAndUploadTask()}};const FV=new z5e,{client:wp,domain:UV}=nl();wp.token=ST();wp.platform=xr.XTOOL_PLATFORM.XCS;wp.showSocialLogin=!0;window.MeApi.app.getAppVersion().then(n=>{wp.appVersion=n});class $5e{constructor(){E(this,"env",localStorage.getItem("testEnv")||"");E(this,"uToken",ee(null));E(this,"userInfo",ee(null))}get mClient(){wp.system=tt.appType===ps.App?xr.SYSTEM_TYPE.MOBILE:xr.SYSTEM_TYPE.PAD;const e=localStorage.getItem("LANG_KEY");return e&&(wp.lang=e==="zh-CN"?"zh":"en"),wp}close(){sC.closeLoginModal(),window.openApi.onBackPressed=()=>!1}login(){window.addEventListener("message",e=>{console.log("event",e.data.action)},!1),this.mClient.openModal(e=>{this.updateUToken(e.token),this.requestUserInfo()})}requestUserInfo(){if(!this.getUToken().value){localStorage.setItem("userInfo","");return}this.mClient.userInfo().then(e=>{var i,r;this.updateUserInfo(e),console.log(e);const t=((r=(i=FV.getExt())==null?void 0:i.deviceInfo)==null?void 0:r.snCode)||"";XYe(e.uid,t),jt(Zt.loginResult,{result:"success"})}).catch(e=>{console.log(e),(e==null?void 0:e.code)===20101&&(this.logout(),this.mClient.token=null,this.userInfo.value=null)})}logout(){this.mClient.logout(),this.userInfo.value=null,this.uToken.value=null,BV("utoken","",1),localStorage.setItem("userInfo",""),FV.cancelAllDownloadAndUploadTask(),this.clearCookie(),YYe()}closeLoginModal(){sC.closeLoginModal()}gotoPointsHistory(){const e=`${UV.projects}/rewards`;window.MeApi.openNative.openWebInApp(e)}openSetting(){const e=this.mClient.getUrl("profile/settings");window.MeApi.openNative.openWebInApp(e)}openSafeRule(){const e=this.mClient.getUrl("profile/training");window.MeApi.openNative.openWebInApp(e)}updateUToken(e){this.uToken.value=e,BV("utoken",e,7)}getUToken(){return this.uToken.value=V5e("utoken")??"",Oie(this.uToken.value),this.uToken}updateUserInfo(e){this.userInfo.value=e,localStorage.setItem("userInfo",JSON.stringify(e))}getUserInfo(){if(!this.userInfo.value){const e=localStorage.getItem("userInfo");e&&(this.userInfo.value=JSON.parse(e))}return this.userInfo}clearCookie(){var i,r;let e=window.updateToken,t={};e?t=JSON.stringify({token:"",url:""}):(e=(r=(i=window.webkit)==null?void 0:i.messageHandlers)==null?void 0:r.updateToken,t={token:"",url:""}),e==null||e.postMessage(t)}renameUserName(e){const t=`${UV.passport}/v1/user/name`;H5e.axios.patch(t,{userName:e},{headers:{utoken:this.uToken.value?this.uToken.value:""}}).then(i=>{console.log("==>handleRenameUserNameEvent success",i),this.requestUserInfo()}).catch(i=>{console.log("==>handleRenameUserNameEvent error ",i)})}}const hm=new $5e;window.ME.userCenterManager=hm;const xp=ba("user_center_module",{getters:{uToken(){return hm.uToken.value},userInfo(){return hm.userInfo.value}},actions:{closeLoginModal(){return hm.closeLoginModal()},requestUserInfo(){return hm.requestUserInfo()},openLoginModal(){return hm.login()}}});let W5e=class{getExt(){return bt().ext}hasConnected(){return bt().hasConnected}connected(){return bt().connected}getInfo(){return bt().info}isFrameMode(){return bt().isFrameMode}isInProcessing(){return bt().isInProcessing}isDeviceConnected(){return bt().connected}getCurrentInstanceId(){return bt().currentInstanceId}isDeviceErrorVisible(){return bt().isShowDeviceErrorModal}isShowWalkBorderTipModal(){return bt().isShowWalkBorderTipModal}hideWalkBorderTipModal(){bt().hideWalkBorderTipModal()}async getProjectShot(e){return await fn().getProjectShot(e)}async getSpecifiedDisplaysShotById(e){return await fn().getSpecifiedDisplaysShotById(e)}async extractContours(e){return await fn().extractContours(e)}async getCanvasData(e){return await fn().getCanvasData(e)}getLayerOrder(){return fn().getLayerOrder()}async openProject(e){await kn().openMultiProjectFromFile(e.file)}getCurrentExt(e){return e?bt().getExt(e):bt().ext}async reConnectExt(e){return await bt().reconnectDevice(e)}deviceData(){return bt().deviceData}currentMode(){return Hc().currentMode}getUToken(){return xp().uToken}};const Di=new W5e,j5e=n=>{const e=ee(0),t=ee(0);let i=!1,r=null,s=!1;const o=()=>{const m=e.value,v=Date.now(),_=Math.round(v-t.value);e.value=s?e.value-_:e.value+_,t.value=v,n&&m!==e.value&&n(e.value)},{pause:a,resume:l}=cre(()=>{o()},{immediate:!1}),c=()=>{i&&(i=!1,o(),r=e.value),a()},u=()=>{i||(t.value=Date.now(),r!==null&&(e.value=r,r=null)),i=!0,l()};return{timeUse:e,setStart:(m,v)=>{m>0&&(e.value=(m-v)*1e3,r!==null&&(r=r-v*1e3))},start:()=>{s=!1,u()},pause:c,reset:()=>{i=!1,s=!1,t.value=0,e.value=0,a()},startCountdown:m=>{e.value===0&&(s=!0,e.value=m*1e3),u()},setTimeUse:m=>{e.value=m*1e3}}};class xK{constructor(e){E(this,"instanceId");E(this,"taskId","");E(this,"hasGenerateTotalTime",-1);E(this,"hasCountTotalTime",!1);E(this,"timer",null);E(this,"processingMode",zt.LASER_PLANE);E(this,"isIgnoreFinishProcessState",!1);E(this,"isIgnoreCancelProcessState",!1);E(this,"hasReStartTimer",!1);E(this,"hasCalculateGCode",!1);E(this,"canvasSnapshotImg");E(this,"pauseTimeUse");E(this,"processStartPoint",ee(""));E(this,"totalTime",ee(-1));E(this,"timeUse",ee(0));E(this,"stepName",ee(xl.PREVIEW));E(this,"pauseProcessingLoading",ee(!1));E(this,"cancelProcessingLoading",ee(!1));E(this,"showReadyPop",ee(!1));E(this,"pressHeatingVisible",ee(!1));E(this,"isDeviceInProcessing",ee(!1));E(this,"isProcessingPaused",ee(!1));E(this,"isProcessingFinished",ee(!1));E(this,"isProcessingCanceled",ee(!1));E(this,"currentProcessStatus",ee());E(this,"deviceSupType",ee(dM.DEVICE_ONE));E(this,"isShowEstimateTime",ee(!0));E(this,"isShowCountTime",ee(!0));E(this,"isConnected",ee(!0));E(this,"canUpdatePage",ee(!1));E(this,"isRepeatProcess",ee(!1));E(this,"isFinishLeanFourDevice",ee(!1));E(this,"shouldBackToOrigin",ee(!1));E(this,"uploadChecking",ee(!1));E(this,"lastEffectScope");var t;this.instanceId=e,this.deviceSupType.value=(t=this.ext)==null?void 0:t.subType}get ext(){return Di.getCurrentExt(this.instanceId)}async calculateGCode(){var l,c;this.setIsRepeatProcess(!1);const e=performance.now(),t=(l=this.ext)==null?void 0:l.dataSource;if(!this.ext||!t)return;this.processingMode=t.currentDeviceData.mode,this.isShowEstimateTime.value=this.checkShowEstimateTime(),this.isShowCountTime.value=this.checkShowCountTime(),this.ext.taskDeviceInfo={processingMode:this.processingMode};const i=await this.ext.buildProcessGcode(this.processingMode),s={timeUse:(performance.now()-e)/1e3,gcodeSize:0};await this.getCanvasSnapshotImg();const o=(c=window.MeApi)==null?void 0:c.fileHelper,a=i.gcode||i.outputFile;return o&&a&&(s.gcodeSize=await o.getFileSize(a)),kte(s),this.hasCalculateGCode=!0,{code:a}}async getCanvasSnapshotImg(){var e,t,i;try{const r=[],s=(i=(t=(e=this.ext)==null?void 0:e.dataSource)==null?void 0:t.currentDeviceData)==null?void 0:i.displays;(await Di.getCanvasData({vectorScaleNum:30,imageData:!1,path:!1})).forEach(l=>{s.get(l.id).processIgnore||r.push(l.id)});const a=await Di.getSpecifiedDisplaysShotById({displayIds:r,scaleNum:2});this.canvasSnapshotImg=(a==null?void 0:a.canvas.toDataURL("image/png",.8))||"",console.log("MultiProcess","getCanvasSnapshotImg",this.canvasSnapshotImg)}catch(r){console.log("MultiProcess","getCanvasSnapshotImg",r)}}setCanvasSnapshotImg(){this.canvasSnapshotImg&&(this.ext.taskDeviceInfo={canvasSnapshotImg:this.canvasSnapshotImg})}async estimatedTime(){var e;return await((e=this.ext)==null?void 0:e.estimatedTime())}async uploadGCode(e,t){if(!this.ext)return;let i="";this.ext.ip&&Op.ignorePing(!0,this.ext.id,this.ext.ip),this.uploadChecking.value=!0;try{await Promise.race([await this.ext.uploadGCode(async r=>{var s,o,a,l;try{this.setCanUpdatePage(!0),this.handleSpecialProcessStatus(),this.resetProcessStatus(),this.isRepeatProcess.value||(this.taskId=""),await this.getProcessStartPoint(),this.updateBackToOriginState(),this.currentProcessStatus.value="Sending",this.uploadChecking.value=!1,this.updateStepName(xl.UPLOAD),await this.ext.genTaskId(this.taskId);const c=this.ext.taskManager.getTask(this.ext.deviceInfo.snCode);console.log("MultiProcess","uploadGCode","task",c);const u=Nr.tempTask;this.taskId?(u.id=this.taskId,await((s=window.MeApi)==null?void 0:s.fileHelper.exists(u.borderPath))&&(await((o=window.MeApi)==null?void 0:o.fileHelper.copy(u.borderPath,c.borderPath)),await this.checkF1BorderExists(c),console.log("MultiProcess","uploadGCode","走边框GCode复用")),await this.copyDHeadAndTailCode(u,c)):await Hl.checkProcess(this.instanceId,!0)||(await this.walkBorder(!1,void 0,!0),await((a=window.MeApi)==null?void 0:a.fileHelper.exists(u.borderPath))&&(await((l=window.MeApi)==null?void 0:l.fileHelper.copy(u.borderPath,c.borderPath)),await this.checkF1BorderExists(c),console.log("MultiProcess","uploadGCode","走边框GCode生成"))),this.ext.builder.gcode=()=>c.gcode,await r(),this.setupProcessingEvent(),this.taskId=c.id,this.ext.deviceInfo={taskId:this.taskId},this.ext.hasUploadGcode=!0,t&&this.updateTotalTime(t),this.setIsRepeatProcess(!1),this.setCanvasSnapshotImg()}catch(c){return this.ext.hasUploadGcode=!1,Promise.reject(c)}},r=>{i=r,console.log("MultiProcess","uploadGCode",r)},{processStartPoint:this.processStartPoint.value,onProgress:r=>{e(r)}}),new Promise((r,s)=>{this.ext.on("disconnect",()=>{s("disConnect")})})])}catch(r){throw console.log("MultiProcess","uploadGCode",r),this.destroyProcessingEvent(),this.ext.hasUploadGcode=!1,this.updateStepName(xl.PREVIEW),i=(r==null?void 0:r.message)||r,new Error("upload gcode error")}finally{this.uploadChecking.value=!1;const{processingModeData:r,processingParams:s}=this.ext.dataParser||{};r&&s&&jt(Zt.uploadGCode,{...r,processingParams:s,gCodeSize:this.ext.gcodeSize,status:i===""?"success":"fail",message:i}),this.ext.ip&&Op.ignorePing(!1,this.ext.id,this.ext.ip);const o=i==="";mt(this.ext.afterWriteFile)&&o&&(console.log("MultiProcess","uploadGCode","退出上传模式"),this.ext.afterWriteFile(!0,!o))}}async checkF1BorderExists(e){var t,i,r,s;if([nt.F1,nt.F1Ultra].includes(this.ext.id)&&!this.ext.walkBorderGcode)try{const o=await((i=(t=window.MeApi)==null?void 0:t.fileHelper)==null?void 0:i.read2String(e.borderPath));(s=(r=this.ext).updateWalkBorderGcode)==null||s.call(r,o),console.log("MultiProcess","uploadGCode","FBorder",o)}catch(o){console.log("MultiProcess","checkF1BorderExists",o)}}async copyDHeadAndTailCode(e,t){var i,r,s,o;if([nt.D1,nt.D1Pro,nt.D1Pro2].includes(this.ext.id))try{await((i=window.MeApi)==null?void 0:i.fileHelper.exists(e.headCodePath))&&await((r=window.MeApi)==null?void 0:r.fileHelper.copy(e.headCodePath,t.headCodePath)),await((s=window.MeApi)==null?void 0:s.fileHelper.exists(e.tailCodePath))&&await((o=window.MeApi)==null?void 0:o.fileHelper.copy(e.tailCodePath,t.tailCodePath))}catch(a){console.log("MultiProcess","copyDHeadAndTailCode",a)}}async cancelUploadGCode(){try{Di.isInProcessing()?await this.cancelProcess():await Hl.withTimeout(this.ext.cancelUploadGCode(),3e3)}catch(e){console.log("MultiProcess","cancelUploadGCode",e)}finally{this.updateStepName(xl.PREVIEW)}}async pauseProcess(){this.pauseProcessingLoading.value=!0;try{await this.ext.pauseProcessing(async e=>{await e()},e=>{console.log("MultiProcess","pauseProcessing",e)})}catch(e){console.log("MultiProcess","pauseProcessing",e.toString())}finally{this.pauseProcessingLoading.value=!1}}async restartProcess(){await this.ext.restartProcessing(()=>{this.updateReadyPopState(!0)})}async repeatProcess(){this.setIsRepeatProcess(!0),this.resetProcessStatus(),this.getProcessStartPoint(),this.totalTime.value!==-1&&(this.ext.taskDeviceInfo={totalTime:this.totalTime.value})}setIsRepeatProcess(e){this.isRepeatProcess.value=e,this.ext.againProcess=e,e?this.ext.againProcessStartPoint=this.processStartPoint.value:this.ext.againProcessStartPoint=""}async cancelProcess(){try{await Hl.withTimeout(this.ext.cancelProcessing(async e=>{this.cancelProcessingLoading.value=!0,await e()},e=>{console.log("MultiProcess","cancelProcess",e)}),3e3)}catch(e){console.log("MultiProcess","cancelProcess",e)}finally{this.cancelProcessingLoading.value=!1,this.currentProcessStatus.value!==It.CANCEL_PROCESS&&this.handleDeviceEvents(It.CANCEL_PROCESS)}}updateTotalTime(e){this.totalTime.value=e,this.hasGenerateTotalTime=e,this.checkShowCountTime()&&(this.timeUse.value=e*1e3)}getTotalTime(){return this.totalTime.value}updateStepName(e){e===xl.PREVIEW&&this.resetProcessStatus(),this.stepName.value=e}updateReadyPopState(e){this.showReadyPop.value=e}toggleTimer(e){var s;if(!this.ext)return;const{processingStateMap:t={}}=(s=this.ext.config)==null?void 0:s.process;let i="";wt(t)||e===It.DISCONNECT?i=e:i=t[e],console.log("MultiProcess","toggleTimer","currentStatus",e,"processStatus",i);const r={[It.START_PROCESS]:()=>{console.log("MultiProcess","toggleTimer","开始加工"),this.startTimer()},[It.PAUSE_PROCESS]:()=>{console.log("MultiProcess","toggleTimer","暂停加工"),this.pauseTimer()},[It.CANCEL_PROCESS]:()=>{console.log("MultiProcess","toggleTimer","取消加工"),this.pauseTimer()},[It.FINISH_PROCESS]:()=>{console.log("MultiProcess","toggleTimer","完成加工"),this.pauseTimer()},[It.DISCONNECT]:()=>{console.log("MultiProcess","toggleTimer","设备断连"),this.pauseTimer()}};r[i]&&r[i]()}async startTimer(e,t){var o;let i=0;if(!this.hasCalculateGCode&&this.totalTime.value===-1&&e&&window.VITE_PHONE){this.taskId=e,this.isDeviceInProcessing.value=!0,this.updateStepName(xl.PROCESSING);const a=await hs.getTaskById(e);a&&(this.currentProcessStatus.value=Hl.getCurrentProcessStatus(this.instanceId)||a.currentStatus,this.handleDeviceEvents(a.currentStatus),this.totalTime.value=a.totalTime??-1,this.processingMode=a.processingMode,this.isShowEstimateTime.value=this.checkShowEstimateTime(),this.isShowCountTime.value=this.checkShowCountTime()),console.log("MultiProcess","startTimer","totalTime",this.totalTime.value)}const r=Hl.getCurrentProcessStatus(this.instanceId);if(r&&r!==It.START_PROCESS){r===It.PAUSE_PROCESS&&this.totalTime.value>0&&t&&t>0&&(this.timeUse.value=(this.totalTime.value-t)*1e3,this.hasGenerateTotalTime=this.totalTime.value,this.updateTaskInfo(this.timeUse.value),this.pauseTimeUse=t);return}const s=this.hasGenerateTotalTime===-1?this.totalTime.value:this.hasGenerateTotalTime;if(!this.timer){const a=l=>{if(l<0)return;const c=Date.now();c-i>=100&&(this.updateTaskInfo(l),i=c)};this.timer=j5e(a),(!this.lastEffectScope||!this.lastEffectScope.active)&&this.setupProcessingEvent(),(o=this.lastEffectScope)==null||o.run(()=>{yt(()=>{var l;return(l=this.timer)==null?void 0:l.timeUse.value},l=>{l&&(this.timeUse.value=l<0?0:l)})})}if(this.checkShowCountTime()){if(s>0){console.log("MultiProcess","setStartTimer","进行倒计时");const a=this.hasGenerateTotalTime===-1?this.totalTime.value:this.hasGenerateTotalTime;this.hasCountTotalTime=!0,this.hasGenerateTotalTime=a,this.timer.startCountdown(a),this.pauseTimeUse&&(this.timer.setStart(s,this.pauseTimeUse),this.pauseTimeUse=void 0)}}else this.timer.start()}pauseTimer(){this.timer&&this.timer.pause()}resetTimeUse(){this.hasCountTotalTime=!1,this.timer=null}resetTimer(){this.timer&&this.timer.reset()}async setStartTime(e,t){var i;this.hasReStartTimer=!0,await this.startTimer(t,e),this.isShowCountTime.value&&((i=this.timer)==null||i.setStart(this.hasGenerateTotalTime,e))}updateTaskInfo(e){hs.updateProcessInfo({id:this.taskId,timeUse:e,totalTime:this.hasGenerateTotalTime,countTime:this.checkShowCountTime(),processStartPoint:this.processStartPoint.value})}callProcessPage(e){var o;const{currentStatus:t}=this.ext.deviceInfo,{processingStateMap:i={}}=this.ext.config.process;let r;wt(i)?r=t:r=i[t],[It.PAUSE_PROCESS,It.BEFORE_START,It.START_PROCESS].includes(r)&&(this.taskId!==e&&(this.taskId=e,console.log("MultiProcess","updateTaskId",e)),this.updateStepName(xl.PROCESSING),(o=this.lastEffectScope)!=null&&o.active||(this.setupProcessingEvent(),console.log("MultiProcess","callProcessPage","setupProcessingEvent")))}setupProcessingEvent(){var e;this.destroyProcessingEvent(),this.lastEffectScope=new pT(!0),(e=this.lastEffectScope)==null||e.run(()=>{yt(()=>Di.deviceData(),t=>{var s,o;this.updateBackToOriginState(t);let i=(s=t[this.instanceId])==null?void 0:s.currentStatus;if(console.log("multiProcess","setupProcessingEvent","currentProcessingStatus",i),!this.ext)return;this.isConnected.value=((o=t[this.instanceId])==null?void 0:o.connected)||!1;const{processingStateMap:r={}}=this.ext.config.process;!wt(r)&&i!==It.DISCONNECT&&(i=r[i]??this.currentProcessStatus.value),i==="S21"?(console.log("Wi-Fi模组与主控通讯异常"),this.handleDeviceEvents(It.CANCEL_PROCESS)):this.handleDeviceEvents(i)},{deep:!0,immediate:!0})})}destroyProcessingEvent(){var e;(e=this.lastEffectScope)==null||e.stop(),console.log("MultiProcess","destroyProcessingEvent")}resumeProcessingEvent(){var e;(e=this.lastEffectScope)!=null&&e.active||(this.setupProcessingEvent(),console.log("MultiProcess","resumeProcessingEvent","setupProcessingEvent"))}handleDeviceEvents(e){var t;switch(e){case It.BEFORE_START:console.log("multiProcess","handleDeviceEvents","准备加工"),this.currentProcessStatus.value=e,this.isIgnoreFinishProcessState=!1,this.isIgnoreCancelProcessState=!1,this.stepName.value===xl.UPLOAD&&(this.pauseTimer(),this.resetTimer(),this.resetTimeUse(),this.updateStepName(xl.PROCESSING),this.updateReadyPopState(!0));break;case It.HEAT_STARTED:console.log("multiProcess","handleDeviceEvents","加工预热"),this.currentProcessStatus.value=e,this.updateReadyPopState(!1),this.pressHeatingVisible.value=!0;break;case It.START_PROCESS:console.log("multiProcess","handleDeviceEvents","开始加工"),this.currentProcessStatus.value=e,this.updateReadyPopState(!1),this.pressHeatingVisible.value=!1,this.isDeviceInProcessing.value=!0,this.isProcessingPaused.value=!1,this.isProcessingFinished.value=!1,this.isProcessingCanceled.value=!1,(t=this.ext.taskDeviceInfo)!=null&&t.canvasSnapshotImg||this.setCanvasSnapshotImg();break;case It.PAUSE_PROCESS:console.log("multiProcess","handleDeviceEvents","暂停加工"),this.currentProcessStatus.value=e,this.isProcessingPaused.value=!0,this.updateReadyPopState(!1);break;case It.DRAIN:console.log("multiProcess","handleDeviceEvents","排气"),this.currentProcessStatus.value=e;break;case It.FINISH_PROCESS:if(console.log("multiProcess","handleDeviceEvents","完成加工"),this.isIgnoreFinishProcessState)return;this.currentProcessStatus.value=e,this.isProcessingFinished.value=!0,this.isDeviceInProcessing.value=!1,this.updateStepName(xl.FINISH),this.destroyProcessingEvent(),this.setFinishTimeUse();break;case It.CANCEL_PROCESS:if(console.log("multiProcess","handleDeviceEvents","取消加工"),this.isIgnoreCancelProcessState)return;this.currentProcessStatus.value=e,this.isProcessingCanceled.value=!0,this.updateReadyPopState(!1),this.destroyProcessingEvent(),this.setFinishTimeUse();break;case It.IDLE:if(console.log("multiProcess","handleDeviceEvents","空闲"),this.isIgnoreCancelProcessState)return;this.currentProcessStatus.value=e;break;case It.DISCONNECT:console.log("multiProcess","handleDeviceEvents","设备断连"),this.currentProcessStatus.value=e,this.hasReStartTimer=!1;break}}setFinishTimeUse(){var t;const e=(t=this.timer)==null?void 0:t.timeUse.value;e&&(this.timeUse.value=e<0?0:e)}handleSpecialProcessStatus(){this.isIgnoreFinishProcessState=!0,this.isIgnoreCancelProcessState=!0}updateBackToOriginState(e){var t;[nt.D1Pro,nt.D1Pro2].includes(this.ext.id)&&(e?this.shouldBackToOrigin.value=(t=e[this.instanceId])==null?void 0:t.backToOrigin:this.shouldBackToOrigin.value=this.processStartPoint.value===Hy.ABSOLUTE)}async getProcessStartPoint(){var e,t;if([nt.D1Pro,nt.D1Pro2].includes(this.ext.id)&&(this.processStartPoint.value=await hs.getValueByTaskId(this.taskId,"processStartPoint"),console.log("MultiProcess","getProcessStartPoint","task",this.processStartPoint.value),!this.processStartPoint.value)){const i=(e=this.ext.dataSource)==null?void 0:e.currentDeviceData,{mode:r,data:s}=i;this.processStartPoint.value=(t=s[r])==null?void 0:t.processStartPoint,this.ext.taskDeviceInfo={processStartPoint:this.processStartPoint.value},console.log("MultiProcess","getProcessStartPoint","currentDeviceData",this.processStartPoint.value)}}async walkBorder(e,t,i=!1){var w,b,C;console.log("MultiProcess","walkBorder","taskId",t);const r=this.ext;let s=this.getWalkBorderData();r.mapPower&&(s=r.mapPower(s));let o="";e&&((w=r==null?void 0:r.genProcessParams)==null||w.call(r,{isWalkBorder:!0}),this.isRepeatProcess.value&&(o=this.processStartPoint.value));const a={running:Di.isFrameMode(),inPreview:e,...s,processStartPoint:o},{running:l,mode:c,power:u,speed:h}=a;if(l)return r.stopWalkBorder();if(!r.dataParser)return;const{boundingRect:{left:d,top:f,width:p,height:g},activeElementIds:m=[]}=r.dataParser;let v=Ipe({x:d,y:f,width:p,height:g});if(c===$O.OUTLINE&&(v=await fn().extractContours(m)||v),await r.dataParser.createBorderElements(v,{power:u,mode:c,speed:h}),r.previewDataSettings&&(r.previewDataSettings.isWalkBorder=!0),r.dataParser.isWalkBorder=!0,r.genProcessElements({isWalkBorder:!0}),r.generalGcodeHeadAndTail({isWalkBorder:!0}),(await r.dataParser.setup()).code===-1)return;try{const I=r.taskManager.tempTask.borderPath;yr.unlinkSync(I),console.log(`${I} File deleted!`)}catch(I){console.error(I)}const y=r.taskManager.tempTask;if(t)y.id=t;else if(await(ca==null?void 0:ca.genGCode({inputDir:y.originalData,outputFile:y.border})),i)return;const A=await((C=(b=window==null?void 0:window.MeApi)==null?void 0:b.fileHelper)==null?void 0:C.readGcode(y.border));console.log(["=> walk-border-gcode-path--",y.border]),console.log(["=> walk-border-gcode--",A]),await Promise.race([new Promise((I,x)=>r.startWalkBorder(A,a).then(I).catch(x)),new Promise((I,x)=>{r.on("disconnect",()=>{x("disConnect")})})])}async stopWalkBorder(){return this.ext.stopWalkBorder()}getWalkBorderData(){const{walkBorderParams:e}=this.ext;return wt(e)?this.ext.walkBorderParams??{mode:"rect",power:3,speed:20}:e}checkShowEstimateTime(){var r;const{showEstimateTime:e=!0,countTimeModes:t=[]}=(r=this.ext)==null?void 0:r.config;let i=e;return t.length>0&&(i=t.includes(this.processingMode)),i}checkShowCountTime(){var r;if(!this.ext)return!1;const{countTime:e=!1,countTimeModes:t=[]}=(r=this.ext)==null?void 0:r.config;let i=e;return t.length>0&&(i=t.includes(this.processingMode)),i}setCanUpdatePage(e){this.canUpdatePage.value=e}async requestLeanStatus(){if(this.deviceSupType.value!==dM.DEVICE_FOUR)this.isFinishLeanFourDevice.value=!0;else if(Di.getUToken())try{const{isFinish:t}=await qie();localStorage.setItem("learningStatus",JSON.stringify(t)),this.isFinishLeanFourDevice.value=t}catch{this.isFinishLeanFourDevice.value=!!zB("learningStatus")}else this.isFinishLeanFourDevice.value=!!zB("learningStatus")}resetProcessStatus(){this.currentProcessStatus.value="",this.timeUse.value=0,this.updateReadyPopState(!1),this.cancelProcessingLoading.value=!1,console.log("MultiProcess","resetProcessStatus")}shouldReserveProcess(){return(t=>Object.values(It).includes(t))(this.currentProcessStatus.value)&&[It.PAUSE_PROCESS,It.BEFORE_START,It.START_PROCESS,It.DISCONNECT].includes(this.currentProcessStatus.value)}destroy(){var e;this.destroyProcessingEvent(),(e=this.timer)==null||e.reset()}}const mu=class mu{constructor(){E(this,"_processes",QP(new Map));if(mu._instance)throw new Error("Cannot instantiate more than one MultiProcessManager")}static get instance(){return mu._instance||(mu._instance=new mu,window.ME.multiProcessManager=mu._instance),mu._instance}addProcess(e){let t=this.getProcess(e);return t||(t=new xK(e),this._processes.set(e,t),console.log("MultiProcessManager","addProcess",e)),t}removeProcess(e){var t;(t=this._processes.get(e))==null||t.destroy(),this._processes.delete(e),console.log("MultiProcessManager","removeProcess",e)}getProcess(e){return this._processes.get(e)}getProcesses(){return Array.from(this._processes.values())}isAnyProcessStarted(){for(const e of this._processes.values())if(e.currentProcessStatus.value===It.START_PROCESS)return!0;return!1}isAnyProcessCanCelled(){for(const e of this._processes.values())if(e.currentProcessStatus.value===It.CANCEL_PROCESS)return!0;return!1}watchProcessState(e,t,i=void 0){const r=new pT(!0),s=(o,a)=>{r.run(()=>{const l=te(()=>{var c,u;return i?((u=(c=this.getProcess(i))==null?void 0:c[o])==null?void 0:u.value)||void 0:this.getProcesses().map(h=>h?h[o].value:void 0)});yt(()=>l.value,c=>{if(i)t({[a]:{[i]:c}});else{let u={};c.forEach((h,d)=>{const f=this.getProcesses()[d];u={...u,[f.instanceId]:h}}),t({[a]:u})}},{immediate:!0})})};for(const[o,a]of Object.entries(e))s(o,a);return r}};E(mu,"_instance");let ir=mu;class Q5e{constructor(){E(this,"_canvasAvailableIdsMap",new Map);E(this,"intervalId",null);E(this,"configDataExportFunc",()=>{var e;if((e=window.MeApi)!=null&&e.fileHelper){const t="temporary",i="/canvasSource/";return window.MeApi.fileHelper.deleteDictory(t,i),async r=>{const{filePath:s}=await window.MeApi.fileHelper.saveFileWithFetch(t,i,r);return s}}})}get canvasAvailableIdsMap(){return this._canvasAvailableIdsMap}async checkProcess(e,t=!1,i=!1){var d;this._canvasAvailableIdsMap.clear();const r=Di.getCurrentExt(e),s=fo.dataSource;if(r===null||s===null)return;const o=Di.getLayerOrder(),a=s==null?void 0:s.currentDeviceData.mode;console.log("processingMode-fillPlanning",s==null?void 0:s.currentModeData.fillPlanning);const{processPath:l=Yu.AUTO}=s.currentModeData;console.log("processingMode-processPath",l);const c=await Di.getCanvasData({vectorScaleNum:30,excludeOutSide:!0,exportVectorPathWhenFill:!0,dataImageExport:this.configDataExportFunc(),...r.getCanvasDataConfig(a)}),u=c==null?void 0:c.map(f=>f.id),h=(d=r.dataSource)==null?void 0:d.canvasId;return this._canvasAvailableIdsMap.set(h,u),r.checkProcessData({canvasData:c,centralAxisPosition:r.centralAxis?r.centralAxis.centralAxisPosition:null,dataSource:s,isWalkBorder:t,isExportGcode:i,layerOrder:pn(o),processPath:l})}getCurrentProcessStatus(e){var s,o;const t=Di.getCurrentExt(e);let i=(s=t==null?void 0:t.info)==null?void 0:s.currentStatus;const{processingStateMap:r={}}=((o=t==null?void 0:t.config)==null?void 0:o.process)||{};return!wt(r)&&i!==It.DISCONNECT&&(i=r[i]),i}isInProcessing(e){return[It.PAUSE_PROCESS,It.BEFORE_START,It.START_PROCESS].includes(this.getCurrentProcessStatus(e))}isSupportTaskId(e){var t;return[nt.F1,nt.F1Ultra,nt.S1,nt.P2].includes((t=Di.getCurrentExt(e))==null?void 0:t.id)}shouldResumeProcessing(e){var o,a,l;const t=hs.taskList.value.processingTasks,i=ir.instance.getProcess(e);let r=(a=(o=Di.getCurrentExt(e))==null?void 0:o.info)==null?void 0:a.taskId;this.isSupportTaskId(e)&&r||(r=i==null?void 0:i.taskId);let s=t.find(c=>c.id===r)!==void 0;return(i==null?void 0:i.currentProcessStatus.value)===It.BEFORE_START&&this.getCurrentProcessStatus(e)===It.BEFORE_START&&(s=!0),r&&Di.getCurrentExt(e).id===nt.P1&&(i!=null&&i.showReadyPop.value)&&(i==null?void 0:i.currentProcessStatus.value)===It.DISCONNECT&&this.getCurrentProcessStatus(e)===It.DISCONNECT&&(l=Di.deviceData()[e])!=null&&l.connected&&(setTimeout(()=>{i==null||i.handleDeviceEvents(It.BEFORE_START)},100),s=!0),{taskId:r,shouldResume:s&&this.isInProcessing(e)}}withTimeout(e,t){const i=new Promise((r,s)=>{const o=setTimeout(()=>{clearTimeout(o),s(new Error("Timed out"))},t)});return Promise.race([e,i])}checkIsOfflineProcessing(e,t){var s,o,a;const i=ir.instance.getProcess(e),r=(o=(s=Di.getCurrentExt(e))==null?void 0:s.info)==null?void 0:o.taskId;this.isSupportTaskId(e)&&(this.intervalId&&!t&&(clearInterval(intervalId),this.intervalId=null),!r&&(i!=null&&i.taskId)&&this.isInProcessing(e)&&t&&((a=ir.instance.getProcess(e))==null||a.destroyProcessingEvent(),console.log("离线加工移除监听"),this.intervalId===null&&(this.intervalId=setInterval(()=>{var c,u,h;((u=(c=Di.getCurrentExt(e))==null?void 0:c.info)==null?void 0:u.taskId)&&(clearInterval(intervalId),this.intervalId=null,(h=ir.instance.getProcess(e))==null||h.resumeProcessingEvent(),console.log("离线加工恢复监听"))},500),setTimeout(()=>{this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null,console.log("离线加工定时器移除"))},5e3))))}}const Hl=new Q5e,ha=ba("process_center_module",{getters:{isAnyProcessStarted(){return ir.instance.isAnyProcessStarted()},isAnyProcessCanCelled(){return ir.instance.isAnyProcessCanCelled()},isMinimized(){return hs.isMinimized},isHideMinimizedWindow(){return hs.hideMinimizedWindow}},actions:{async checkProcess(n,e=!1,t=!1){return await Hl.checkProcess(n,e,t)},canvasAvailableIdsMap(){return Hl.canvasAvailableIdsMap},async exportGCodeFile(n,e){try{const t=await new xK(n).calculateGCode();e==null||e();const{code:i=""}=t||{},r=await Di.getCurrentExt().exportGcode(i,!0);return console.log("exportResult",r),r===!0?"success":""}catch(t){return console.info(t),"fail"}finally{e==null||e()}},getProcess(n){return ir.instance.getProcess(n)},addProcess(n){return ir.instance.addProcess(n)},removeProcess(n){var e;(e=ir.instance.getProcess(n))!=null&&e.shouldReserveProcess()||ir.instance.removeProcess(n)},updateProcessInfo(n){hs.updateProcessInfo(n)},toggleTimer(n,e){var t;return(t=ir.instance.getProcess(n))==null?void 0:t.toggleTimer(e)},getTaskId(n){var e;return(e=ir.instance.getProcess(n))==null?void 0:e.taskId},isShowCountTime(n){var e;return(e=ir.instance.getProcess(n))==null?void 0:e.checkShowCountTime()},pauseTimer(n){var e;(e=ir.instance.getProcess(n))==null||e.pauseTimer()},setStartTime(n,e,t){var i;(i=ir.instance.getProcess(n))==null||i.setStartTime(e,t)},isProcessAlive(n){const e=ir.instance.getProcess(n);return e?e.taskId!=="":!1},requestLeanStatus(n){var e;(e=ir.instance.getProcess(n))==null||e.requestLeanStatus()},shouldResumeProcessing(n){return Hl.shouldResumeProcessing(n)},updateTaskList(n,e){return hs.updateTaskList(n,e)},hideMinimizedWindow(n){hs.hideMinimizedWindow=n}}});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const sN="160",xu={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Gh={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},X5e=0,GV=1,Y5e=2,CK=1,q5e=2,du=3,Od=0,Vo=1,Bu=2,wd=0,Lm=1,HV=2,VV=3,zV=4,K5e=5,Cf=100,J5e=101,Z5e=102,$V=103,WV=104,e$e=200,t$e=201,n$e=202,i$e=203,wk=204,xk=205,r$e=206,s$e=207,o$e=208,a$e=209,l$e=210,c$e=211,u$e=212,h$e=213,d$e=214,f$e=0,p$e=1,g$e=2,cE=3,m$e=4,v$e=5,_$e=6,y$e=7,EK=0,A$e=1,b$e=2,xd=0,w$e=1,x$e=2,C$e=3,E$e=4,T$e=5,I$e=6,TK=300,Ov=301,Lv=302,Ck=303,Ek=304,PI=306,Tk=1e3,Vl=1001,Ik=1002,go=1003,jV=1004,F1=1005,Ga=1006,S$e=1007,VA=1008,Cd=1009,P$e=1010,M$e=1011,oN=1012,IK=1013,cd=1014,ud=1015,zA=1016,SK=1017,PK=1018,Cp=1020,R$e=1021,zl=1023,D$e=1024,k$e=1025,Ep=1026,Nv=1027,O$e=1028,MK=1029,L$e=1030,RK=1031,DK=1033,U1=33776,G1=33777,H1=33778,V1=33779,QV=35840,XV=35841,YV=35842,qV=35843,kK=36196,KV=37492,JV=37496,ZV=37808,ez=37809,tz=37810,nz=37811,iz=37812,rz=37813,sz=37814,oz=37815,az=37816,lz=37817,cz=37818,uz=37819,hz=37820,dz=37821,z1=36492,fz=36494,pz=36495,N$e=36283,gz=36284,mz=36285,vz=36286,OK=3e3,Tp=3001,B$e=3200,F$e=3201,U$e=0,G$e=1,$a="",Os="srgb",oh="srgb-linear",aN="display-p3",MI="display-p3-linear",uE="linear",zi="srgb",hE="rec709",dE="p3",Ug=7680,_z=519,H$e=512,V$e=513,z$e=514,LK=515,$$e=516,W$e=517,j$e=518,Q$e=519,Sk=35044,yz="300 es",Pk=1035,zu=2e3,fE=2001;class gg{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Vs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Az=1234567;const By=Math.PI/180,$A=180/Math.PI;function Ju(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Vs[n&255]+Vs[n>>8&255]+Vs[n>>16&255]+Vs[n>>24&255]+"-"+Vs[e&255]+Vs[e>>8&255]+"-"+Vs[e>>16&15|64]+Vs[e>>24&255]+"-"+Vs[t&63|128]+Vs[t>>8&255]+"-"+Vs[t>>16&255]+Vs[t>>24&255]+Vs[i&255]+Vs[i>>8&255]+Vs[i>>16&255]+Vs[i>>24&255]).toLowerCase()}function Bs(n,e,t){return Math.max(e,Math.min(t,n))}function lN(n,e){return(n%e+e)%e}function X$e(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function Y$e(n,e,t){return n!==e?(t-n)/(e-n):0}function Fy(n,e,t){return(1-t)*n+t*e}function q$e(n,e,t,i){return Fy(n,e,1-Math.exp(-t*i))}function K$e(n,e=1){return e-Math.abs(lN(n,e*2)-e)}function J$e(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function Z$e(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function eWe(n,e){return n+Math.floor(Math.random()*(e-n+1))}function tWe(n,e){return n+Math.random()*(e-n)}function nWe(n){return n*(.5-Math.random())}function iWe(n){n!==void 0&&(Az=n);let e=Az+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function rWe(n){return n*By}function sWe(n){return n*$A}function Mk(n){return(n&n-1)===0&&n!==0}function oWe(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function pE(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function aWe(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),u=o((e+i)/2),h=s((e-i)/2),d=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":n.set(a*u,l*h,l*d,a*c);break;case"YZY":n.set(l*d,a*u,l*h,a*c);break;case"ZXZ":n.set(l*h,l*d,a*u,a*c);break;case"XZX":n.set(a*u,l*p,l*f,a*c);break;case"YXY":n.set(l*f,a*u,l*p,a*c);break;case"ZYZ":n.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Sc(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ai(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const cN={DEG2RAD:By,RAD2DEG:$A,generateUUID:Ju,clamp:Bs,euclideanModulo:lN,mapLinear:X$e,inverseLerp:Y$e,lerp:Fy,damp:q$e,pingpong:K$e,smoothstep:J$e,smootherstep:Z$e,randInt:eWe,randFloat:tWe,randFloatSpread:nWe,seededRandom:iWe,degToRad:rWe,radToDeg:sWe,isPowerOfTwo:Mk,ceilPowerOfTwo:oWe,floorPowerOfTwo:pE,setQuaternionFromProperEuler:aWe,normalize:Ai,denormalize:Sc};class wn{constructor(e=0,t=0){wn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Bs(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Mn{constructor(e,t,i,r,s,o,a,l,c){Mn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],g=r[0],m=r[3],v=r[6],_=r[1],y=r[4],A=r[7],w=r[2],b=r[5],C=r[8];return s[0]=o*g+a*_+l*w,s[3]=o*m+a*y+l*b,s[6]=o*v+a*A+l*C,s[1]=c*g+u*_+h*w,s[4]=c*m+u*y+h*b,s[7]=c*v+u*A+h*C,s[2]=d*g+f*_+p*w,s[5]=d*m+f*y+p*b,s[8]=d*v+f*A+p*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,p=t*h+i*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=h*g,e[1]=(r*c-u*i)*g,e[2]=(a*i-r*o)*g,e[3]=d*g,e[4]=(u*t-r*l)*g,e[5]=(r*s-a*t)*g,e[6]=f*g,e[7]=(i*l-c*t)*g,e[8]=(o*t-i*s)*g,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply($1.makeScale(e,t)),this}rotate(e){return this.premultiply($1.makeRotation(-e)),this}translate(e,t){return this.premultiply($1.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const $1=new Mn;function NK(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function gE(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function lWe(){const n=gE("canvas");return n.style.display="block",n}const bz={};function Uy(n){n in bz||(bz[n]=!0,console.warn(n))}const wz=new Mn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),xz=new Mn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Mw={[oh]:{transfer:uE,primaries:hE,toReference:n=>n,fromReference:n=>n},[Os]:{transfer:zi,primaries:hE,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[MI]:{transfer:uE,primaries:dE,toReference:n=>n.applyMatrix3(xz),fromReference:n=>n.applyMatrix3(wz)},[aN]:{transfer:zi,primaries:dE,toReference:n=>n.convertSRGBToLinear().applyMatrix3(xz),fromReference:n=>n.applyMatrix3(wz).convertLinearToSRGB()}},cWe=new Set([oh,MI]),bi={enabled:!0,_workingColorSpace:oh,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!cWe.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=Mw[e].toReference,r=Mw[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Mw[n].primaries},getTransfer:function(n){return n===$a?uE:Mw[n].transfer}};function Nm(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function W1(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Gg;class BK{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Gg===void 0&&(Gg=gE("canvas")),Gg.width=e.width,Gg.height=e.height;const i=Gg.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Gg}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=gE("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Nm(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Nm(t[i]/255)*255):t[i]=Nm(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let uWe=0;class FK{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:uWe++}),this.uuid=Ju(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(j1(r[o].image)):s.push(j1(r[o]))}else s=j1(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function j1(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?BK.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let hWe=0;class _a extends gg{constructor(e=_a.DEFAULT_IMAGE,t=_a.DEFAULT_MAPPING,i=Vl,r=Vl,s=Ga,o=VA,a=zl,l=Cd,c=_a.DEFAULT_ANISOTROPY,u=$a){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:hWe++}),this.uuid=Ju(),this.name="",this.source=new FK(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new wn(0,0),this.repeat=new wn(1,1),this.center=new wn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Mn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(Uy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Tp?Os:$a),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==TK)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Tk:e.x=e.x-Math.floor(e.x);break;case Vl:e.x=e.x<0?0:1;break;case Ik:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Tk:e.y=e.y-Math.floor(e.y);break;case Vl:e.y=e.y<0?0:1;break;case Ik:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Uy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Os?Tp:OK}set encoding(e){Uy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Tp?Os:$a}}_a.DEFAULT_IMAGE=null;_a.DEFAULT_MAPPING=TK;_a.DEFAULT_ANISOTROPY=1;class Sr{constructor(e=0,t=0,i=0,r=1){Sr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],f=l[5],p=l[9],g=l[2],m=l[6],v=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-g)<.01&&Math.abs(p-m)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+g)<.1&&Math.abs(p+m)<.1&&Math.abs(c+f+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,A=(f+1)/2,w=(v+1)/2,b=(u+d)/4,C=(h+g)/4,I=(p+m)/4;return y>A&&y>w?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=b/i,s=C/i):A>w?A<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(A),i=b/r,s=I/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=C/s,r=I/s),this.set(i,r,s,t),this}let _=Math.sqrt((m-p)*(m-p)+(h-g)*(h-g)+(d-u)*(d-u));return Math.abs(_)<.001&&(_=1),this.x=(m-p)/_,this.y=(h-g)/_,this.z=(d-u)/_,this.w=Math.acos((c+f+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class dWe extends gg{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Sr(0,0,e,t),this.scissorTest=!1,this.viewport=new Sr(0,0,e,t);const r={width:e,height:t,depth:1};i.encoding!==void 0&&(Uy("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Tp?Os:$a),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ga,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new _a(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new FK(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Kp extends dWe{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class UK extends _a{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=go,this.minFilter=go,this.wrapR=Vl,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class fWe extends _a{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=go,this.minFilter=go,this.wrapR=Vl,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Jp{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],h=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],g=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h;return}if(a===1){e[t+0]=d,e[t+1]=f,e[t+2]=p,e[t+3]=g;return}if(h!==g||l!==d||c!==f||u!==p){let m=1-a;const v=l*d+c*f+u*p+h*g,_=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){const w=Math.sqrt(y),b=Math.atan2(w,v*_);m=Math.sin(m*b)/w,a=Math.sin(a*b)/w}const A=a*_;if(l=l*m+d*A,c=c*m+f*A,u=u*m+p*A,h=h*m+g*A,m===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=w,c*=w,u*=w,h*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+l*f-c*d,e[t+1]=l*p+u*d+c*h-a*f,e[t+2]=c*p+u*f+a*d-l*h,e[t+3]=u*p-a*h-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),h=a(s/2),d=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"YZX":this._x=d*u*h+c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h-d*f*p;break;case"XZY":this._x=d*u*h-c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=i+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>h){const f=2*Math.sqrt(1+i-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>h){const f=2*Math.sqrt(1+a-i-h);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+h-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Bs(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Oe{constructor(e=0,t=0,i=0){Oe.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Cz.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Cz.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*i),u=2*(a*t-s*r),h=2*(s*i-o*t);return this.x=t+l*c+o*h-a*u,this.y=i+l*u+a*c-s*h,this.z=r+l*h+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Q1.copy(this).projectOnVector(e),this.sub(Q1)}reflect(e){return this.sub(Q1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Bs(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Q1=new Oe,Cz=new Jp;class vh{constructor(e=new Oe(1/0,1/0,1/0),t=new Oe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Al.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Al.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Al.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Al):Al.fromBufferAttribute(s,o),Al.applyMatrix4(e.matrixWorld),this.expandByPoint(Al);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Rw.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Rw.copy(i.boundingBox)),Rw.applyMatrix4(e.matrixWorld),this.union(Rw)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Al),Al.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(W_),Dw.subVectors(this.max,W_),Hg.subVectors(e.a,W_),Vg.subVectors(e.b,W_),zg.subVectors(e.c,W_),Ih.subVectors(Vg,Hg),Sh.subVectors(zg,Vg),Yd.subVectors(Hg,zg);let t=[0,-Ih.z,Ih.y,0,-Sh.z,Sh.y,0,-Yd.z,Yd.y,Ih.z,0,-Ih.x,Sh.z,0,-Sh.x,Yd.z,0,-Yd.x,-Ih.y,Ih.x,0,-Sh.y,Sh.x,0,-Yd.y,Yd.x,0];return!X1(t,Hg,Vg,zg,Dw)||(t=[1,0,0,0,1,0,0,0,1],!X1(t,Hg,Vg,zg,Dw))?!1:(kw.crossVectors(Ih,Sh),t=[kw.x,kw.y,kw.z],X1(t,Hg,Vg,zg,Dw))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Al).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Al).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ru[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ru[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ru[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ru[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ru[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ru[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ru[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ru[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ru),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ru=[new Oe,new Oe,new Oe,new Oe,new Oe,new Oe,new Oe,new Oe],Al=new Oe,Rw=new vh,Hg=new Oe,Vg=new Oe,zg=new Oe,Ih=new Oe,Sh=new Oe,Yd=new Oe,W_=new Oe,Dw=new Oe,kw=new Oe,qd=new Oe;function X1(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){qd.fromArray(n,s);const a=r.x*Math.abs(qd.x)+r.y*Math.abs(qd.y)+r.z*Math.abs(qd.z),l=e.dot(qd),c=t.dot(qd),u=i.dot(qd);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const pWe=new vh,j_=new Oe,Y1=new Oe;class mg{constructor(e=new Oe,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):pWe.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;j_.subVectors(e,this.center);const t=j_.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(j_,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Y1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(j_.copy(e.center).add(Y1)),this.expandByPoint(j_.copy(e.center).sub(Y1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const su=new Oe,q1=new Oe,Ow=new Oe,Ph=new Oe,K1=new Oe,Lw=new Oe,J1=new Oe;class RI{constructor(e=new Oe,t=new Oe(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,su)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=su.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(su.copy(this.origin).addScaledVector(this.direction,t),su.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){q1.copy(e).add(t).multiplyScalar(.5),Ow.copy(t).sub(e).normalize(),Ph.copy(this.origin).sub(q1);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Ow),a=Ph.dot(this.direction),l=-Ph.dot(Ow),c=Ph.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*l-a,d=o*a-l,p=s*u,h>=0)if(d>=-p)if(d<=p){const g=1/u;h*=g,d*=g,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(q1).addScaledVector(Ow,d),f}intersectSphere(e,t){su.subVectors(e.center,this.origin);const i=su.dot(this.direction),r=su.dot(su)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(i=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(i=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,su)!==null}intersectTriangle(e,t,i,r,s){K1.subVectors(t,e),Lw.subVectors(i,e),J1.crossVectors(K1,Lw);let o=this.direction.dot(J1),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ph.subVectors(this.origin,e);const l=a*this.direction.dot(Lw.crossVectors(Ph,Lw));if(l<0)return null;const c=a*this.direction.dot(K1.cross(Ph));if(c<0||l+c>o)return null;const u=-a*Ph.dot(J1);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class mr{constructor(e,t,i,r,s,o,a,l,c,u,h,d,f,p,g,m){mr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c,u,h,d,f,p,g,m)}set(e,t,i,r,s,o,a,l,c,u,h,d,f,p,g,m){const v=this.elements;return v[0]=e,v[4]=t,v[8]=i,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=c,v[6]=u,v[10]=h,v[14]=d,v[3]=f,v[7]=p,v[11]=g,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new mr().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/$g.setFromMatrixColumn(e,0).length(),s=1/$g.setFromMatrixColumn(e,1).length(),o=1/$g.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=o*u,f=o*h,p=a*u,g=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=f+p*c,t[5]=d-g*c,t[9]=-a*l,t[2]=g-d*c,t[6]=p+f*c,t[10]=o*l}else if(e.order==="YXZ"){const d=l*u,f=l*h,p=c*u,g=c*h;t[0]=d+g*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=g+d*a,t[10]=o*l}else if(e.order==="ZXY"){const d=l*u,f=l*h,p=c*u,g=c*h;t[0]=d-g*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=g-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const d=o*u,f=o*h,p=a*u,g=a*h;t[0]=l*u,t[4]=p*c-f,t[8]=d*c+g,t[1]=l*h,t[5]=g*c+d,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const d=o*l,f=o*c,p=a*l,g=a*c;t[0]=l*u,t[4]=g-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*h+p,t[10]=d-g*h}else if(e.order==="XZY"){const d=o*l,f=o*c,p=a*l,g=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=d*h+g,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=g*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(gWe,e,mWe)}lookAt(e,t,i){const r=this.elements;return ta.subVectors(e,t),ta.lengthSq()===0&&(ta.z=1),ta.normalize(),Mh.crossVectors(i,ta),Mh.lengthSq()===0&&(Math.abs(i.z)===1?ta.x+=1e-4:ta.z+=1e-4,ta.normalize(),Mh.crossVectors(i,ta)),Mh.normalize(),Nw.crossVectors(ta,Mh),r[0]=Mh.x,r[4]=Nw.x,r[8]=ta.x,r[1]=Mh.y,r[5]=Nw.y,r[9]=ta.y,r[2]=Mh.z,r[6]=Nw.z,r[10]=ta.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],h=i[5],d=i[9],f=i[13],p=i[2],g=i[6],m=i[10],v=i[14],_=i[3],y=i[7],A=i[11],w=i[15],b=r[0],C=r[4],I=r[8],x=r[12],T=r[1],O=r[5],F=r[9],G=r[13],B=r[2],R=r[6],P=r[10],k=r[14],L=r[3],H=r[7],U=r[11],$=r[15];return s[0]=o*b+a*T+l*B+c*L,s[4]=o*C+a*O+l*R+c*H,s[8]=o*I+a*F+l*P+c*U,s[12]=o*x+a*G+l*k+c*$,s[1]=u*b+h*T+d*B+f*L,s[5]=u*C+h*O+d*R+f*H,s[9]=u*I+h*F+d*P+f*U,s[13]=u*x+h*G+d*k+f*$,s[2]=p*b+g*T+m*B+v*L,s[6]=p*C+g*O+m*R+v*H,s[10]=p*I+g*F+m*P+v*U,s[14]=p*x+g*G+m*k+v*$,s[3]=_*b+y*T+A*B+w*L,s[7]=_*C+y*O+A*R+w*H,s[11]=_*I+y*F+A*P+w*U,s[15]=_*x+y*G+A*k+w*$,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],f=e[14],p=e[3],g=e[7],m=e[11],v=e[15];return p*(+s*l*h-r*c*h-s*a*d+i*c*d+r*a*f-i*l*f)+g*(+t*l*f-t*c*d+s*o*d-r*o*f+r*c*u-s*l*u)+m*(+t*c*h-t*a*f-s*o*h+i*o*f+s*a*u-i*c*u)+v*(-r*a*u-t*l*h+t*a*d+r*o*h-i*o*d+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],m=e[14],v=e[15],_=h*m*c-g*d*c+g*l*f-a*m*f-h*l*v+a*d*v,y=p*d*c-u*m*c-p*l*f+o*m*f+u*l*v-o*d*v,A=u*g*c-p*h*c+p*a*f-o*g*f-u*a*v+o*h*v,w=p*h*l-u*g*l-p*a*d+o*g*d+u*a*m-o*h*m,b=t*_+i*y+r*A+s*w;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/b;return e[0]=_*C,e[1]=(g*d*s-h*m*s-g*r*f+i*m*f+h*r*v-i*d*v)*C,e[2]=(a*m*s-g*l*s+g*r*c-i*m*c-a*r*v+i*l*v)*C,e[3]=(h*l*s-a*d*s-h*r*c+i*d*c+a*r*f-i*l*f)*C,e[4]=y*C,e[5]=(u*m*s-p*d*s+p*r*f-t*m*f-u*r*v+t*d*v)*C,e[6]=(p*l*s-o*m*s-p*r*c+t*m*c+o*r*v-t*l*v)*C,e[7]=(o*d*s-u*l*s+u*r*c-t*d*c-o*r*f+t*l*f)*C,e[8]=A*C,e[9]=(p*h*s-u*g*s-p*i*f+t*g*f+u*i*v-t*h*v)*C,e[10]=(o*g*s-p*a*s+p*i*c-t*g*c-o*i*v+t*a*v)*C,e[11]=(u*a*s-o*h*s-u*i*c+t*h*c+o*i*f-t*a*f)*C,e[12]=w*C,e[13]=(u*g*r-p*h*r+p*i*d-t*g*d-u*i*m+t*h*m)*C,e[14]=(p*a*r-o*g*r-p*i*l+t*g*l+o*i*m-t*a*m)*C,e[15]=(o*h*r-u*a*r+u*i*l-t*h*l-o*i*d+t*a*d)*C,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,p=s*h,g=o*u,m=o*h,v=a*h,_=l*c,y=l*u,A=l*h,w=i.x,b=i.y,C=i.z;return r[0]=(1-(g+v))*w,r[1]=(f+A)*w,r[2]=(p-y)*w,r[3]=0,r[4]=(f-A)*b,r[5]=(1-(d+v))*b,r[6]=(m+_)*b,r[7]=0,r[8]=(p+y)*C,r[9]=(m-_)*C,r[10]=(1-(d+g))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=$g.set(r[0],r[1],r[2]).length();const o=$g.set(r[4],r[5],r[6]).length(),a=$g.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],bl.copy(this);const c=1/s,u=1/o,h=1/a;return bl.elements[0]*=c,bl.elements[1]*=c,bl.elements[2]*=c,bl.elements[4]*=u,bl.elements[5]*=u,bl.elements[6]*=u,bl.elements[8]*=h,bl.elements[9]*=h,bl.elements[10]*=h,t.setFromRotationMatrix(bl),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=zu){const l=this.elements,c=2*s/(t-e),u=2*s/(i-r),h=(t+e)/(t-e),d=(i+r)/(i-r);let f,p;if(a===zu)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===fE)f=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=zu){const l=this.elements,c=1/(t-e),u=1/(i-r),h=1/(o-s),d=(t+e)*c,f=(i+r)*u;let p,g;if(a===zu)p=(o+s)*h,g=-2*h;else if(a===fE)p=s*h,g=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=g,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const $g=new Oe,bl=new mr,gWe=new Oe(0,0,0),mWe=new Oe(1,1,1),Mh=new Oe,Nw=new Oe,ta=new Oe,Ez=new mr,Tz=new Jp;class DI{constructor(e=0,t=0,i=0,r=DI.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],h=r[2],d=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(Bs(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Bs(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Bs(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Bs(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Bs(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-Bs(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return Ez.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ez,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Tz.setFromEuler(this),this.setFromQuaternion(Tz,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}DI.DEFAULT_ORDER="XYZ";class GK{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let vWe=0;const Iz=new Oe,Wg=new Jp,ou=new mr,Bw=new Oe,Q_=new Oe,_We=new Oe,yWe=new Jp,Sz=new Oe(1,0,0),Pz=new Oe(0,1,0),Mz=new Oe(0,0,1),AWe={type:"added"},bWe={type:"removed"};class no extends gg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:vWe++}),this.uuid=Ju(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=no.DEFAULT_UP.clone();const e=new Oe,t=new DI,i=new Jp,r=new Oe(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new mr},normalMatrix:{value:new Mn}}),this.matrix=new mr,this.matrixWorld=new mr,this.matrixAutoUpdate=no.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=no.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new GK,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Wg.setFromAxisAngle(e,t),this.quaternion.multiply(Wg),this}rotateOnWorldAxis(e,t){return Wg.setFromAxisAngle(e,t),this.quaternion.premultiply(Wg),this}rotateX(e){return this.rotateOnAxis(Sz,e)}rotateY(e){return this.rotateOnAxis(Pz,e)}rotateZ(e){return this.rotateOnAxis(Mz,e)}translateOnAxis(e,t){return Iz.copy(e).applyQuaternion(this.quaternion),this.position.add(Iz.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Sz,e)}translateY(e){return this.translateOnAxis(Pz,e)}translateZ(e){return this.translateOnAxis(Mz,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ou.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Bw.copy(e):Bw.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Q_.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ou.lookAt(Q_,Bw,this.up):ou.lookAt(Bw,Q_,this.up),this.quaternion.setFromRotationMatrix(ou),r&&(ou.extractRotation(r.matrixWorld),Wg.setFromRotationMatrix(ou),this.quaternion.premultiply(Wg.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(AWe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(bWe)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ou.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ou.multiply(e.parent.matrixWorld)),e.applyMatrix4(ou),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Q_,e,_We),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Q_,yWe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const h=l[c];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),h=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),h.length>0&&(i.shapes=h),d.length>0&&(i.skeletons=d),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}no.DEFAULT_UP=new Oe(0,1,0);no.DEFAULT_MATRIX_AUTO_UPDATE=!0;no.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const wl=new Oe,au=new Oe,Z1=new Oe,lu=new Oe,jg=new Oe,Qg=new Oe,Rz=new Oe,eP=new Oe,tP=new Oe,nP=new Oe;let Fw=!1;class Nl{constructor(e=new Oe,t=new Oe,i=new Oe){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),wl.subVectors(e,t),r.cross(wl);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){wl.subVectors(r,t),au.subVectors(i,t),Z1.subVectors(e,t);const o=wl.dot(wl),a=wl.dot(au),l=wl.dot(Z1),c=au.dot(au),u=au.dot(Z1),h=o*c-a*a;if(h===0)return s.set(0,0,0),null;const d=1/h,f=(c*l-a*u)*d,p=(o*u-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,lu)===null?!1:lu.x>=0&&lu.y>=0&&lu.x+lu.y<=1}static getUV(e,t,i,r,s,o,a,l){return Fw===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Fw=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,lu)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,lu.x),l.addScaledVector(o,lu.y),l.addScaledVector(a,lu.z),l)}static isFrontFacing(e,t,i,r){return wl.subVectors(i,t),au.subVectors(e,t),wl.cross(au).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return wl.subVectors(this.c,this.b),au.subVectors(this.a,this.b),wl.cross(au).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Nl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Nl.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return Fw===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Fw=!0),Nl.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Nl.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Nl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Nl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;jg.subVectors(r,i),Qg.subVectors(s,i),eP.subVectors(e,i);const l=jg.dot(eP),c=Qg.dot(eP);if(l<=0&&c<=0)return t.copy(i);tP.subVectors(e,r);const u=jg.dot(tP),h=Qg.dot(tP);if(u>=0&&h<=u)return t.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(jg,o);nP.subVectors(e,s);const f=jg.dot(nP),p=Qg.dot(nP);if(p>=0&&f<=p)return t.copy(s);const g=f*c-l*p;if(g<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(Qg,a);const m=u*p-f*h;if(m<=0&&h-u>=0&&f-p>=0)return Rz.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(Rz,a);const v=1/(m+g+d);return o=g*v,a=d*v,t.copy(i).addScaledVector(jg,o).addScaledVector(Qg,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const HK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Rh={h:0,s:0,l:0},Uw={h:0,s:0,l:0};function iP(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class $n{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Os){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,bi.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=bi.workingColorSpace){return this.r=e,this.g=t,this.b=i,bi.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=bi.workingColorSpace){if(e=lN(e,1),t=Bs(t,0,1),i=Bs(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=iP(o,s,e+1/3),this.g=iP(o,s,e),this.b=iP(o,s,e-1/3)}return bi.toWorkingColorSpace(this,r),this}setStyle(e,t=Os){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Os){const i=HK[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Nm(e.r),this.g=Nm(e.g),this.b=Nm(e.b),this}copyLinearToSRGB(e){return this.r=W1(e.r),this.g=W1(e.g),this.b=W1(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Os){return bi.fromWorkingColorSpace(zs.copy(this),e),Math.round(Bs(zs.r*255,0,255))*65536+Math.round(Bs(zs.g*255,0,255))*256+Math.round(Bs(zs.b*255,0,255))}getHexString(e=Os){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=bi.workingColorSpace){bi.fromWorkingColorSpace(zs.copy(this),t);const i=zs.r,r=zs.g,s=zs.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const h=o-a;switch(c=u<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=bi.workingColorSpace){return bi.fromWorkingColorSpace(zs.copy(this),t),e.r=zs.r,e.g=zs.g,e.b=zs.b,e}getStyle(e=Os){bi.fromWorkingColorSpace(zs.copy(this),e);const t=zs.r,i=zs.g,r=zs.b;return e!==Os?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(Rh),this.setHSL(Rh.h+e,Rh.s+t,Rh.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Rh),e.getHSL(Uw);const i=Fy(Rh.h,Uw.h,t),r=Fy(Rh.s,Uw.s,t),s=Fy(Rh.l,Uw.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const zs=new $n;$n.NAMES=HK;let wWe=0;class p_ extends gg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:wWe++}),this.uuid=Ju(),this.name="",this.type="Material",this.blending=Lm,this.side=Od,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=wk,this.blendDst=xk,this.blendEquation=Cf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new $n(0,0,0),this.blendAlpha=0,this.depthFunc=cE,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=_z,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ug,this.stencilZFail=Ug,this.stencilZPass=Ug,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Lm&&(i.blending=this.blending),this.side!==Od&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==wk&&(i.blendSrc=this.blendSrc),this.blendDst!==xk&&(i.blendDst=this.blendDst),this.blendEquation!==Cf&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==cE&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==_z&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Ug&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Ug&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Ug&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class VK extends p_{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new $n(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=EK,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const kr=new Oe,Gw=new wn;class Jl{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Sk,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ud,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Gw.fromBufferAttribute(this,t),Gw.applyMatrix3(e),this.setXY(t,Gw.x,Gw.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)kr.fromBufferAttribute(this,t),kr.applyMatrix3(e),this.setXYZ(t,kr.x,kr.y,kr.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)kr.fromBufferAttribute(this,t),kr.applyMatrix4(e),this.setXYZ(t,kr.x,kr.y,kr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)kr.fromBufferAttribute(this,t),kr.applyNormalMatrix(e),this.setXYZ(t,kr.x,kr.y,kr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)kr.fromBufferAttribute(this,t),kr.transformDirection(e),this.setXYZ(t,kr.x,kr.y,kr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Sc(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Ai(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Sc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Sc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Sc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Sc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),i=Ai(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),i=Ai(i,this.array),r=Ai(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),i=Ai(i,this.array),r=Ai(r,this.array),s=Ai(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Sk&&(e.usage=this.usage),e}}class zK extends Jl{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class $K extends Jl{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class gs extends Jl{constructor(e,t,i){super(new Float32Array(e),t,i)}}let xWe=0;const Ta=new mr,rP=new no,Xg=new Oe,na=new vh,X_=new vh,ts=new Oe;class wa extends gg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:xWe++}),this.uuid=Ju(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(NK(e)?$K:zK)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Mn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ta.makeRotationFromQuaternion(e),this.applyMatrix4(Ta),this}rotateX(e){return Ta.makeRotationX(e),this.applyMatrix4(Ta),this}rotateY(e){return Ta.makeRotationY(e),this.applyMatrix4(Ta),this}rotateZ(e){return Ta.makeRotationZ(e),this.applyMatrix4(Ta),this}translate(e,t,i){return Ta.makeTranslation(e,t,i),this.applyMatrix4(Ta),this}scale(e,t,i){return Ta.makeScale(e,t,i),this.applyMatrix4(Ta),this}lookAt(e){return rP.lookAt(e),rP.updateMatrix(),this.applyMatrix4(rP.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xg).negate(),this.translate(Xg.x,Xg.y,Xg.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new gs(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vh);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Oe(-1/0,-1/0,-1/0),new Oe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];na.setFromBufferAttribute(s),this.morphTargetsRelative?(ts.addVectors(this.boundingBox.min,na.min),this.boundingBox.expandByPoint(ts),ts.addVectors(this.boundingBox.max,na.max),this.boundingBox.expandByPoint(ts)):(this.boundingBox.expandByPoint(na.min),this.boundingBox.expandByPoint(na.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new mg);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Oe,1/0);return}if(e){const i=this.boundingSphere.center;if(na.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];X_.setFromBufferAttribute(a),this.morphTargetsRelative?(ts.addVectors(na.min,X_.min),na.expandByPoint(ts),ts.addVectors(na.max,X_.max),na.expandByPoint(ts)):(na.expandByPoint(X_.min),na.expandByPoint(X_.max))}na.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)ts.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(ts));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)ts.fromBufferAttribute(a,c),l&&(Xg.fromBufferAttribute(e,c),ts.add(Xg)),r=Math.max(r,i.distanceToSquared(ts))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Jl(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let T=0;T<a;T++)c[T]=new Oe,u[T]=new Oe;const h=new Oe,d=new Oe,f=new Oe,p=new wn,g=new wn,m=new wn,v=new Oe,_=new Oe;function y(T,O,F){h.fromArray(r,T*3),d.fromArray(r,O*3),f.fromArray(r,F*3),p.fromArray(o,T*2),g.fromArray(o,O*2),m.fromArray(o,F*2),d.sub(h),f.sub(h),g.sub(p),m.sub(p);const G=1/(g.x*m.y-m.x*g.y);isFinite(G)&&(v.copy(d).multiplyScalar(m.y).addScaledVector(f,-g.y).multiplyScalar(G),_.copy(f).multiplyScalar(g.x).addScaledVector(d,-m.x).multiplyScalar(G),c[T].add(v),c[O].add(v),c[F].add(v),u[T].add(_),u[O].add(_),u[F].add(_))}let A=this.groups;A.length===0&&(A=[{start:0,count:i.length}]);for(let T=0,O=A.length;T<O;++T){const F=A[T],G=F.start,B=F.count;for(let R=G,P=G+B;R<P;R+=3)y(i[R+0],i[R+1],i[R+2])}const w=new Oe,b=new Oe,C=new Oe,I=new Oe;function x(T){C.fromArray(s,T*3),I.copy(C);const O=c[T];w.copy(O),w.sub(C.multiplyScalar(C.dot(O))).normalize(),b.crossVectors(I,O);const G=b.dot(u[T])<0?-1:1;l[T*4]=w.x,l[T*4+1]=w.y,l[T*4+2]=w.z,l[T*4+3]=G}for(let T=0,O=A.length;T<O;++T){const F=A[T],G=F.start,B=F.count;for(let R=G,P=G+B;R<P;R+=3)x(i[R+0]),x(i[R+1]),x(i[R+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Jl(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new Oe,s=new Oe,o=new Oe,a=new Oe,l=new Oe,c=new Oe,u=new Oe,h=new Oe;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),g=e.getX(d+1),m=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,g),o.fromBufferAttribute(t,m),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,g),c.fromBufferAttribute(i,m),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(g,l.x,l.y,l.z),i.setXYZ(m,c.x,c.y,c.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)ts.fromBufferAttribute(e,t),ts.normalize(),e.setXYZ(t,ts.x,ts.y,ts.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u);let f=0,p=0;for(let g=0,m=l.length;g<m;g++){a.isInterleavedBufferAttribute?f=l[g]*a.data.stride+a.offset:f=l[g]*u;for(let v=0;v<u;v++)d[p++]=c[f++]}return new Jl(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new wa,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const d=c[u],f=e(d,i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++){const f=c[h];u.push(f.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Dz=new mr,Kd=new RI,Hw=new mg,kz=new Oe,Yg=new Oe,qg=new Oe,Kg=new Oe,sP=new Oe,Vw=new Oe,zw=new wn,$w=new wn,Ww=new wn,Oz=new Oe,Lz=new Oe,Nz=new Oe,jw=new Oe,Qw=new Oe;class $u extends no{constructor(e=new wa,t=new VK){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Vw.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],h=s[l];u!==0&&(sP.fromBufferAttribute(h,e),o?Vw.addScaledVector(sP,u):Vw.addScaledVector(sP.sub(t),u))}t.add(Vw)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Hw.copy(i.boundingSphere),Hw.applyMatrix4(s),Kd.copy(e.ray).recast(e.near),!(Hw.containsPoint(Kd.origin)===!1&&(Kd.intersectSphere(Hw,kz)===null||Kd.origin.distanceToSquared(kz)>(e.far-e.near)**2))&&(Dz.copy(s).invert(),Kd.copy(e.ray).applyMatrix4(Dz),!(i.boundingBox!==null&&Kd.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Kd)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,g=d.length;p<g;p++){const m=d[p],v=o[m.materialIndex],_=Math.max(m.start,f.start),y=Math.min(a.count,Math.min(m.start+m.count,f.start+f.count));for(let A=_,w=y;A<w;A+=3){const b=a.getX(A),C=a.getX(A+1),I=a.getX(A+2);r=Xw(this,v,e,i,c,u,h,b,C,I),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{const p=Math.max(0,f.start),g=Math.min(a.count,f.start+f.count);for(let m=p,v=g;m<v;m+=3){const _=a.getX(m),y=a.getX(m+1),A=a.getX(m+2);r=Xw(this,o,e,i,c,u,h,_,y,A),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,g=d.length;p<g;p++){const m=d[p],v=o[m.materialIndex],_=Math.max(m.start,f.start),y=Math.min(l.count,Math.min(m.start+m.count,f.start+f.count));for(let A=_,w=y;A<w;A+=3){const b=A,C=A+1,I=A+2;r=Xw(this,v,e,i,c,u,h,b,C,I),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{const p=Math.max(0,f.start),g=Math.min(l.count,f.start+f.count);for(let m=p,v=g;m<v;m+=3){const _=m,y=m+1,A=m+2;r=Xw(this,o,e,i,c,u,h,_,y,A),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}}}function CWe(n,e,t,i,r,s,o,a){let l;if(e.side===Vo?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Od,a),l===null)return null;Qw.copy(a),Qw.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(Qw);return c<t.near||c>t.far?null:{distance:c,point:Qw.clone(),object:n}}function Xw(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,Yg),n.getVertexPosition(l,qg),n.getVertexPosition(c,Kg);const u=CWe(n,e,t,i,Yg,qg,Kg,jw);if(u){r&&(zw.fromBufferAttribute(r,a),$w.fromBufferAttribute(r,l),Ww.fromBufferAttribute(r,c),u.uv=Nl.getInterpolation(jw,Yg,qg,Kg,zw,$w,Ww,new wn)),s&&(zw.fromBufferAttribute(s,a),$w.fromBufferAttribute(s,l),Ww.fromBufferAttribute(s,c),u.uv1=Nl.getInterpolation(jw,Yg,qg,Kg,zw,$w,Ww,new wn),u.uv2=u.uv1),o&&(Oz.fromBufferAttribute(o,a),Lz.fromBufferAttribute(o,l),Nz.fromBufferAttribute(o,c),u.normal=Nl.getInterpolation(jw,Yg,qg,Kg,Oz,Lz,Nz,new Oe),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new Oe,materialIndex:0};Nl.getNormal(Yg,qg,Kg,h.normal),u.face=h}return u}class mb extends wa{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let d=0,f=0;p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new gs(c,3)),this.setAttribute("normal",new gs(u,3)),this.setAttribute("uv",new gs(h,2));function p(g,m,v,_,y,A,w,b,C,I,x){const T=A/C,O=w/I,F=A/2,G=w/2,B=b/2,R=C+1,P=I+1;let k=0,L=0;const H=new Oe;for(let U=0;U<P;U++){const $=U*O-G;for(let j=0;j<R;j++){const Q=j*T-F;H[g]=Q*_,H[m]=$*y,H[v]=B,c.push(H.x,H.y,H.z),H[g]=0,H[m]=0,H[v]=b>0?1:-1,u.push(H.x,H.y,H.z),h.push(j/C),h.push(1-U/I),k+=1}}for(let U=0;U<I;U++)for(let $=0;$<C;$++){const j=d+$+R*U,Q=d+$+R*(U+1),ne=d+($+1)+R*(U+1),ve=d+($+1)+R*U;l.push(j,Q,ve),l.push(Q,ne,ve),L+=6}a.addGroup(f,L,x),f+=L,d+=k}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mb(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Bv(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function lo(n){const e={};for(let t=0;t<n.length;t++){const i=Bv(n[t]);for(const r in i)e[r]=i[r]}return e}function EWe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function WK(n){return n.getRenderTarget()===null?n.outputColorSpace:bi.workingColorSpace}const vb={clone:Bv,merge:lo};var TWe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,IWe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class tc extends p_{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=TWe,this.fragmentShader=IWe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Bv(e.uniforms),this.uniformsGroups=EWe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class jK extends no{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new mr,this.projectionMatrix=new mr,this.projectionMatrixInverse=new mr,this.coordinateSystem=zu}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Ha extends jK{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=$A*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(By*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return $A*2*Math.atan(Math.tan(By*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(By*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Jg=-90,Zg=1;class SWe extends no{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Ha(Jg,Zg,e,t);r.layers=this.layers,this.add(r);const s=new Ha(Jg,Zg,e,t);s.layers=this.layers,this.add(s);const o=new Ha(Jg,Zg,e,t);o.layers=this.layers,this.add(o);const a=new Ha(Jg,Zg,e,t);a.layers=this.layers,this.add(a);const l=new Ha(Jg,Zg,e,t);l.layers=this.layers,this.add(l);const c=new Ha(Jg,Zg,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===zu)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===fE)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=g,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(h,d,f),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class QK extends _a{constructor(e,t,i,r,s,o,a,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:Ov,super(e,t,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class PWe extends Kp{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(Uy("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Tp?Os:$a),this.texture=new QK(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ga}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new mb(5,5,5),s=new tc({name:"CubemapFromEquirect",uniforms:Bv(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Vo,blending:wd});s.uniforms.tEquirect.value=t;const o=new $u(r,s),a=t.minFilter;return t.minFilter===VA&&(t.minFilter=Ga),new SWe(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const oP=new Oe,MWe=new Oe,RWe=new Mn;class Hh{constructor(e=new Oe(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=oP.subVectors(i,t).cross(MWe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(oP),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||RWe.getNormalMatrix(e),r=this.coplanarPoint(oP).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Jd=new mg,Yw=new Oe;class XK{constructor(e=new Hh,t=new Hh,i=new Hh,r=new Hh,s=new Hh,o=new Hh){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=zu){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],h=r[6],d=r[7],f=r[8],p=r[9],g=r[10],m=r[11],v=r[12],_=r[13],y=r[14],A=r[15];if(i[0].setComponents(l-s,d-c,m-f,A-v).normalize(),i[1].setComponents(l+s,d+c,m+f,A+v).normalize(),i[2].setComponents(l+o,d+u,m+p,A+_).normalize(),i[3].setComponents(l-o,d-u,m-p,A-_).normalize(),i[4].setComponents(l-a,d-h,m-g,A-y).normalize(),t===zu)i[5].setComponents(l+a,d+h,m+g,A+y).normalize();else if(t===fE)i[5].setComponents(a,h,g,y).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Jd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Jd.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Jd)}intersectsSprite(e){return Jd.center.set(0,0,0),Jd.radius=.7071067811865476,Jd.applyMatrix4(e.matrixWorld),this.intersectsSphere(Jd)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Yw.x=r.normal.x>0?e.max.x:e.min.x,Yw.y=r.normal.y>0?e.max.y:e.min.y,Yw.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Yw)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function YK(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function DWe(n,e){const t=e.isWebGL2,i=new WeakMap;function r(c,u){const h=c.array,d=c.usage,f=h.byteLength,p=n.createBuffer();n.bindBuffer(u,p),n.bufferData(u,h,d),c.onUploadCallback();let g;if(h instanceof Float32Array)g=n.FLOAT;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)g=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else g=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)g=n.SHORT;else if(h instanceof Uint32Array)g=n.UNSIGNED_INT;else if(h instanceof Int32Array)g=n.INT;else if(h instanceof Int8Array)g=n.BYTE;else if(h instanceof Uint8Array)g=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)g=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:p,type:g,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version,size:f}}function s(c,u,h){const d=u.array,f=u._updateRange,p=u.updateRanges;if(n.bindBuffer(h,c),f.count===-1&&p.length===0&&n.bufferSubData(h,0,d),p.length!==0){for(let g=0,m=p.length;g<m;g++){const v=p[g];t?n.bufferSubData(h,v.start*d.BYTES_PER_ELEMENT,d,v.start,v.count):n.bufferSubData(h,v.start*d.BYTES_PER_ELEMENT,d.subarray(v.start,v.start+v.count))}u.clearUpdateRanges()}f.count!==-1&&(t?n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);if(h===void 0)i.set(c,r(c,u));else if(h.version<c.version){if(h.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(h.buffer,c,u),h.version=c.version}}return{get:o,remove:a,update:l}}class uN extends wa{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,h=e/a,d=t/l,f=[],p=[],g=[],m=[];for(let v=0;v<u;v++){const _=v*d-o;for(let y=0;y<c;y++){const A=y*h-s;p.push(A,-_,0),g.push(0,0,1),m.push(y/a),m.push(1-v/l)}}for(let v=0;v<l;v++)for(let _=0;_<a;_++){const y=_+c*v,A=_+c*(v+1),w=_+1+c*(v+1),b=_+1+c*v;f.push(y,A,b),f.push(A,w,b)}this.setIndex(f),this.setAttribute("position",new gs(p,3)),this.setAttribute("normal",new gs(g,3)),this.setAttribute("uv",new gs(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uN(e.width,e.height,e.widthSegments,e.heightSegments)}}var kWe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,OWe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,LWe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,NWe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,BWe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,FWe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,UWe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,GWe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,HWe=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,VWe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,zWe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,$We=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,WWe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,jWe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,QWe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,XWe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,YWe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,qWe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,KWe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,JWe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,ZWe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,e6e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,t6e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,n6e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,i6e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,r6e=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,s6e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,o6e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,a6e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,l6e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,c6e="gl_FragColor = linearToOutputTexel( gl_FragColor );",u6e=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,h6e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,d6e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,f6e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,p6e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,g6e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,m6e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,v6e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,_6e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,y6e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,A6e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,b6e=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,w6e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,x6e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,C6e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,E6e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,T6e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,I6e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,S6e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,P6e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,M6e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,R6e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,D6e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,k6e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,O6e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,L6e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,N6e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,B6e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,F6e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,U6e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,G6e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,H6e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,V6e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,z6e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,$6e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,W6e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,j6e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Q6e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,X6e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Y6e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,q6e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,K6e=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,J6e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Z6e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,e8e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,t8e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,n8e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,i8e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,r8e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,s8e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,o8e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,a8e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,l8e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,c8e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,u8e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,h8e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,d8e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,f8e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,p8e=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,g8e=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,m8e=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,v8e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,_8e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,y8e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,A8e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,b8e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,w8e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,x8e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,C8e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,E8e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,T8e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,I8e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,S8e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,P8e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,M8e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,R8e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const D8e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,k8e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,O8e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,L8e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,N8e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,B8e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,F8e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,U8e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,G8e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,H8e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,V8e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,z8e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,$8e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,W8e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,j8e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Q8e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,X8e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Y8e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,q8e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,K8e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,J8e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Z8e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,eje=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,tje=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nje=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,ije=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rje=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sje=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oje=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,aje=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,lje=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cje=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,uje=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hje=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Tn={alphahash_fragment:kWe,alphahash_pars_fragment:OWe,alphamap_fragment:LWe,alphamap_pars_fragment:NWe,alphatest_fragment:BWe,alphatest_pars_fragment:FWe,aomap_fragment:UWe,aomap_pars_fragment:GWe,batching_pars_vertex:HWe,batching_vertex:VWe,begin_vertex:zWe,beginnormal_vertex:$We,bsdfs:WWe,iridescence_fragment:jWe,bumpmap_pars_fragment:QWe,clipping_planes_fragment:XWe,clipping_planes_pars_fragment:YWe,clipping_planes_pars_vertex:qWe,clipping_planes_vertex:KWe,color_fragment:JWe,color_pars_fragment:ZWe,color_pars_vertex:e6e,color_vertex:t6e,common:n6e,cube_uv_reflection_fragment:i6e,defaultnormal_vertex:r6e,displacementmap_pars_vertex:s6e,displacementmap_vertex:o6e,emissivemap_fragment:a6e,emissivemap_pars_fragment:l6e,colorspace_fragment:c6e,colorspace_pars_fragment:u6e,envmap_fragment:h6e,envmap_common_pars_fragment:d6e,envmap_pars_fragment:f6e,envmap_pars_vertex:p6e,envmap_physical_pars_fragment:T6e,envmap_vertex:g6e,fog_vertex:m6e,fog_pars_vertex:v6e,fog_fragment:_6e,fog_pars_fragment:y6e,gradientmap_pars_fragment:A6e,lightmap_fragment:b6e,lightmap_pars_fragment:w6e,lights_lambert_fragment:x6e,lights_lambert_pars_fragment:C6e,lights_pars_begin:E6e,lights_toon_fragment:I6e,lights_toon_pars_fragment:S6e,lights_phong_fragment:P6e,lights_phong_pars_fragment:M6e,lights_physical_fragment:R6e,lights_physical_pars_fragment:D6e,lights_fragment_begin:k6e,lights_fragment_maps:O6e,lights_fragment_end:L6e,logdepthbuf_fragment:N6e,logdepthbuf_pars_fragment:B6e,logdepthbuf_pars_vertex:F6e,logdepthbuf_vertex:U6e,map_fragment:G6e,map_pars_fragment:H6e,map_particle_fragment:V6e,map_particle_pars_fragment:z6e,metalnessmap_fragment:$6e,metalnessmap_pars_fragment:W6e,morphcolor_vertex:j6e,morphnormal_vertex:Q6e,morphtarget_pars_vertex:X6e,morphtarget_vertex:Y6e,normal_fragment_begin:q6e,normal_fragment_maps:K6e,normal_pars_fragment:J6e,normal_pars_vertex:Z6e,normal_vertex:e8e,normalmap_pars_fragment:t8e,clearcoat_normal_fragment_begin:n8e,clearcoat_normal_fragment_maps:i8e,clearcoat_pars_fragment:r8e,iridescence_pars_fragment:s8e,opaque_fragment:o8e,packing:a8e,premultiplied_alpha_fragment:l8e,project_vertex:c8e,dithering_fragment:u8e,dithering_pars_fragment:h8e,roughnessmap_fragment:d8e,roughnessmap_pars_fragment:f8e,shadowmap_pars_fragment:p8e,shadowmap_pars_vertex:g8e,shadowmap_vertex:m8e,shadowmask_pars_fragment:v8e,skinbase_vertex:_8e,skinning_pars_vertex:y8e,skinning_vertex:A8e,skinnormal_vertex:b8e,specularmap_fragment:w8e,specularmap_pars_fragment:x8e,tonemapping_fragment:C8e,tonemapping_pars_fragment:E8e,transmission_fragment:T8e,transmission_pars_fragment:I8e,uv_pars_fragment:S8e,uv_pars_vertex:P8e,uv_vertex:M8e,worldpos_vertex:R8e,background_vert:D8e,background_frag:k8e,backgroundCube_vert:O8e,backgroundCube_frag:L8e,cube_vert:N8e,cube_frag:B8e,depth_vert:F8e,depth_frag:U8e,distanceRGBA_vert:G8e,distanceRGBA_frag:H8e,equirect_vert:V8e,equirect_frag:z8e,linedashed_vert:$8e,linedashed_frag:W8e,meshbasic_vert:j8e,meshbasic_frag:Q8e,meshlambert_vert:X8e,meshlambert_frag:Y8e,meshmatcap_vert:q8e,meshmatcap_frag:K8e,meshnormal_vert:J8e,meshnormal_frag:Z8e,meshphong_vert:eje,meshphong_frag:tje,meshphysical_vert:nje,meshphysical_frag:ije,meshtoon_vert:rje,meshtoon_frag:sje,points_vert:oje,points_frag:aje,shadow_vert:lje,shadow_frag:cje,sprite_vert:uje,sprite_frag:hje},_t={common:{diffuse:{value:new $n(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Mn},alphaMap:{value:null},alphaMapTransform:{value:new Mn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Mn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Mn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Mn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Mn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Mn},normalScale:{value:new wn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Mn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Mn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Mn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Mn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new $n(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new $n(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Mn},alphaTest:{value:0},uvTransform:{value:new Mn}},sprite:{diffuse:{value:new $n(16777215)},opacity:{value:1},center:{value:new wn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Mn},alphaMap:{value:null},alphaMapTransform:{value:new Mn},alphaTest:{value:0}}},ds={basic:{uniforms:lo([_t.common,_t.specularmap,_t.envmap,_t.aomap,_t.lightmap,_t.fog]),vertexShader:Tn.meshbasic_vert,fragmentShader:Tn.meshbasic_frag},lambert:{uniforms:lo([_t.common,_t.specularmap,_t.envmap,_t.aomap,_t.lightmap,_t.emissivemap,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.fog,_t.lights,{emissive:{value:new $n(0)}}]),vertexShader:Tn.meshlambert_vert,fragmentShader:Tn.meshlambert_frag},phong:{uniforms:lo([_t.common,_t.specularmap,_t.envmap,_t.aomap,_t.lightmap,_t.emissivemap,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.fog,_t.lights,{emissive:{value:new $n(0)},specular:{value:new $n(1118481)},shininess:{value:30}}]),vertexShader:Tn.meshphong_vert,fragmentShader:Tn.meshphong_frag},standard:{uniforms:lo([_t.common,_t.envmap,_t.aomap,_t.lightmap,_t.emissivemap,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.roughnessmap,_t.metalnessmap,_t.fog,_t.lights,{emissive:{value:new $n(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Tn.meshphysical_vert,fragmentShader:Tn.meshphysical_frag},toon:{uniforms:lo([_t.common,_t.aomap,_t.lightmap,_t.emissivemap,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.gradientmap,_t.fog,_t.lights,{emissive:{value:new $n(0)}}]),vertexShader:Tn.meshtoon_vert,fragmentShader:Tn.meshtoon_frag},matcap:{uniforms:lo([_t.common,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.fog,{matcap:{value:null}}]),vertexShader:Tn.meshmatcap_vert,fragmentShader:Tn.meshmatcap_frag},points:{uniforms:lo([_t.points,_t.fog]),vertexShader:Tn.points_vert,fragmentShader:Tn.points_frag},dashed:{uniforms:lo([_t.common,_t.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Tn.linedashed_vert,fragmentShader:Tn.linedashed_frag},depth:{uniforms:lo([_t.common,_t.displacementmap]),vertexShader:Tn.depth_vert,fragmentShader:Tn.depth_frag},normal:{uniforms:lo([_t.common,_t.bumpmap,_t.normalmap,_t.displacementmap,{opacity:{value:1}}]),vertexShader:Tn.meshnormal_vert,fragmentShader:Tn.meshnormal_frag},sprite:{uniforms:lo([_t.sprite,_t.fog]),vertexShader:Tn.sprite_vert,fragmentShader:Tn.sprite_frag},background:{uniforms:{uvTransform:{value:new Mn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Tn.background_vert,fragmentShader:Tn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Tn.backgroundCube_vert,fragmentShader:Tn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Tn.cube_vert,fragmentShader:Tn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Tn.equirect_vert,fragmentShader:Tn.equirect_frag},distanceRGBA:{uniforms:lo([_t.common,_t.displacementmap,{referencePosition:{value:new Oe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Tn.distanceRGBA_vert,fragmentShader:Tn.distanceRGBA_frag},shadow:{uniforms:lo([_t.lights,_t.fog,{color:{value:new $n(0)},opacity:{value:1}}]),vertexShader:Tn.shadow_vert,fragmentShader:Tn.shadow_frag}};ds.physical={uniforms:lo([ds.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Mn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Mn},clearcoatNormalScale:{value:new wn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Mn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Mn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Mn},sheen:{value:0},sheenColor:{value:new $n(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Mn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Mn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Mn},transmissionSamplerSize:{value:new wn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Mn},attenuationDistance:{value:0},attenuationColor:{value:new $n(0)},specularColor:{value:new $n(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Mn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Mn},anisotropyVector:{value:new wn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Mn}}]),vertexShader:Tn.meshphysical_vert,fragmentShader:Tn.meshphysical_frag};const qw={r:0,b:0,g:0};function dje(n,e,t,i,r,s,o){const a=new $n(0);let l=s===!0?0:1,c,u,h=null,d=0,f=null;function p(m,v){let _=!1,y=v.isScene===!0?v.background:null;y&&y.isTexture&&(y=(v.backgroundBlurriness>0?t:e).get(y)),y===null?g(a,l):y&&y.isColor&&(g(y,1),_=!0);const A=n.xr.getEnvironmentBlendMode();A==="additive"?i.buffers.color.setClear(0,0,0,1,o):A==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||_)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===PI)?(u===void 0&&(u=new $u(new mb(1,1,1),new tc({name:"BackgroundCubeMaterial",uniforms:Bv(ds.backgroundCube.uniforms),vertexShader:ds.backgroundCube.vertexShader,fragmentShader:ds.backgroundCube.fragmentShader,side:Vo,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(w,b,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=bi.getTransfer(y.colorSpace)!==zi,(h!==y||d!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(c===void 0&&(c=new $u(new uN(2,2),new tc({name:"BackgroundMaterial",uniforms:Bv(ds.background.uniforms),vertexShader:ds.background.vertexShader,fragmentShader:ds.background.fragmentShader,side:Od,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=y,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=bi.getTransfer(y.colorSpace)!==zi,y.matrixAutoUpdate===!0&&y.updateMatrix(),c.material.uniforms.uvTransform.value.copy(y.matrix),(h!==y||d!==y.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function g(m,v){m.getRGB(qw,WK(n)),i.buffers.color.setClear(qw.r,qw.g,qw.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(m,v=1){a.set(m),l=v,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,g(a,l)},render:p}}function fje(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=m(null);let c=l,u=!1;function h(B,R,P,k,L){let H=!1;if(o){const U=g(k,P,R);c!==U&&(c=U,f(c.object)),H=v(B,k,P,L),H&&_(B,k,P,L)}else{const U=R.wireframe===!0;(c.geometry!==k.id||c.program!==P.id||c.wireframe!==U)&&(c.geometry=k.id,c.program=P.id,c.wireframe=U,H=!0)}L!==null&&t.update(L,n.ELEMENT_ARRAY_BUFFER),(H||u)&&(u=!1,I(B,R,P,k),L!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(L).buffer))}function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function f(B){return i.isWebGL2?n.bindVertexArray(B):s.bindVertexArrayOES(B)}function p(B){return i.isWebGL2?n.deleteVertexArray(B):s.deleteVertexArrayOES(B)}function g(B,R,P){const k=P.wireframe===!0;let L=a[B.id];L===void 0&&(L={},a[B.id]=L);let H=L[R.id];H===void 0&&(H={},L[R.id]=H);let U=H[k];return U===void 0&&(U=m(d()),H[k]=U),U}function m(B){const R=[],P=[],k=[];for(let L=0;L<r;L++)R[L]=0,P[L]=0,k[L]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:R,enabledAttributes:P,attributeDivisors:k,object:B,attributes:{},index:null}}function v(B,R,P,k){const L=c.attributes,H=R.attributes;let U=0;const $=P.getAttributes();for(const j in $)if($[j].location>=0){const ne=L[j];let ve=H[j];if(ve===void 0&&(j==="instanceMatrix"&&B.instanceMatrix&&(ve=B.instanceMatrix),j==="instanceColor"&&B.instanceColor&&(ve=B.instanceColor)),ne===void 0||ne.attribute!==ve||ve&&ne.data!==ve.data)return!0;U++}return c.attributesNum!==U||c.index!==k}function _(B,R,P,k){const L={},H=R.attributes;let U=0;const $=P.getAttributes();for(const j in $)if($[j].location>=0){let ne=H[j];ne===void 0&&(j==="instanceMatrix"&&B.instanceMatrix&&(ne=B.instanceMatrix),j==="instanceColor"&&B.instanceColor&&(ne=B.instanceColor));const ve={};ve.attribute=ne,ne&&ne.data&&(ve.data=ne.data),L[j]=ve,U++}c.attributes=L,c.attributesNum=U,c.index=k}function y(){const B=c.newAttributes;for(let R=0,P=B.length;R<P;R++)B[R]=0}function A(B){w(B,0)}function w(B,R){const P=c.newAttributes,k=c.enabledAttributes,L=c.attributeDivisors;P[B]=1,k[B]===0&&(n.enableVertexAttribArray(B),k[B]=1),L[B]!==R&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](B,R),L[B]=R)}function b(){const B=c.newAttributes,R=c.enabledAttributes;for(let P=0,k=R.length;P<k;P++)R[P]!==B[P]&&(n.disableVertexAttribArray(P),R[P]=0)}function C(B,R,P,k,L,H,U){U===!0?n.vertexAttribIPointer(B,R,P,L,H):n.vertexAttribPointer(B,R,P,k,L,H)}function I(B,R,P,k){if(i.isWebGL2===!1&&(B.isInstancedMesh||k.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;y();const L=k.attributes,H=P.getAttributes(),U=R.defaultAttributeValues;for(const $ in H){const j=H[$];if(j.location>=0){let Q=L[$];if(Q===void 0&&($==="instanceMatrix"&&B.instanceMatrix&&(Q=B.instanceMatrix),$==="instanceColor"&&B.instanceColor&&(Q=B.instanceColor)),Q!==void 0){const ne=Q.normalized,ve=Q.itemSize,Pe=t.get(Q);if(Pe===void 0)continue;const De=Pe.buffer,Xe=Pe.type,Ne=Pe.bytesPerElement,et=i.isWebGL2===!0&&(Xe===n.INT||Xe===n.UNSIGNED_INT||Q.gpuType===IK);if(Q.isInterleavedBufferAttribute){const ze=Q.data,de=ze.stride,lt=Q.offset;if(ze.isInstancedInterleavedBuffer){for(let he=0;he<j.locationSize;he++)w(j.location+he,ze.meshPerAttribute);B.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=ze.meshPerAttribute*ze.count)}else for(let he=0;he<j.locationSize;he++)A(j.location+he);n.bindBuffer(n.ARRAY_BUFFER,De);for(let he=0;he<j.locationSize;he++)C(j.location+he,ve/j.locationSize,Xe,ne,de*Ne,(lt+ve/j.locationSize*he)*Ne,et)}else{if(Q.isInstancedBufferAttribute){for(let ze=0;ze<j.locationSize;ze++)w(j.location+ze,Q.meshPerAttribute);B.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let ze=0;ze<j.locationSize;ze++)A(j.location+ze);n.bindBuffer(n.ARRAY_BUFFER,De);for(let ze=0;ze<j.locationSize;ze++)C(j.location+ze,ve/j.locationSize,Xe,ne,ve*Ne,ve/j.locationSize*ze*Ne,et)}}else if(U!==void 0){const ne=U[$];if(ne!==void 0)switch(ne.length){case 2:n.vertexAttrib2fv(j.location,ne);break;case 3:n.vertexAttrib3fv(j.location,ne);break;case 4:n.vertexAttrib4fv(j.location,ne);break;default:n.vertexAttrib1fv(j.location,ne)}}}}b()}function x(){F();for(const B in a){const R=a[B];for(const P in R){const k=R[P];for(const L in k)p(k[L].object),delete k[L];delete R[P]}delete a[B]}}function T(B){if(a[B.id]===void 0)return;const R=a[B.id];for(const P in R){const k=R[P];for(const L in k)p(k[L].object),delete k[L];delete R[P]}delete a[B.id]}function O(B){for(const R in a){const P=a[R];if(P[B.id]===void 0)continue;const k=P[B.id];for(const L in k)p(k[L].object),delete k[L];delete P[B.id]}}function F(){G(),u=!0,c!==l&&(c=l,f(c.object))}function G(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:F,resetDefaultState:G,dispose:x,releaseStatesOfGeometry:T,releaseStatesOfProgram:O,initAttributes:y,enableAttribute:A,disableUnusedAttributes:b}}function pje(n,e,t,i){const r=i.isWebGL2;let s;function o(u){s=u}function a(u,h){n.drawArrays(s,u,h),t.update(h,s,1)}function l(u,h,d){if(d===0)return;let f,p;if(r)f=n,p="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[p](s,u,h,d),t.update(h,s,d)}function c(u,h,d){if(d===0)return;const f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<d;p++)this.render(u[p],h[p]);else{f.multiDrawArraysWEBGL(s,u,0,h,0,d);let p=0;for(let g=0;g<d;g++)p+=h[g];t.update(p,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=c}function gje(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(C){if(C==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return C==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),d=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),g=n.getParameter(n.MAX_VERTEX_ATTRIBS),m=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),v=n.getParameter(n.MAX_VARYING_VECTORS),_=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,A=o||e.has("OES_texture_float"),w=y&&A,b=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:g,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:_,vertexTextures:y,floatFragmentTextures:A,floatVertexTextures:w,maxSamples:b}}function mje(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Hh,a=new Mn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=h.length!==0||d||i!==0||r;return r=d,i=h.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=u(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,g=h.clipIntersection,m=h.clipShadows,v=n.get(h);if(!r||p===null||p.length===0||s&&!m)s?u(null):c();else{const _=s?0:i,y=_*4;let A=v.clippingState||null;l.value=A,A=u(p,d,y,f);for(let w=0;w!==y;++w)A[w]=t[w];v.clippingState=A,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=_}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(h,d,f,p){const g=h!==null?h.length:0;let m=null;if(g!==0){if(m=l.value,p!==!0||m===null){const v=f+g*4,_=d.matrixWorldInverse;a.getNormalMatrix(_),(m===null||m.length<v)&&(m=new Float32Array(v));for(let y=0,A=f;y!==g;++y,A+=4)o.copy(h[y]).applyMatrix4(_,a),o.normal.toArray(m,A),m[A+3]=o.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,m}}function vje(n){let e=new WeakMap;function t(o,a){return a===Ck?o.mapping=Ov:a===Ek&&(o.mapping=Lv),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===Ck||a===Ek)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new PWe(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class _je extends jK{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const bm=4,Bz=[.125,.215,.35,.446,.526,.582],Ef=20,aP=new _je,Fz=new $n;let lP=null,cP=0,uP=0;const mf=(1+Math.sqrt(5))/2,em=1/mf,Uz=[new Oe(1,1,1),new Oe(-1,1,1),new Oe(1,1,-1),new Oe(-1,1,-1),new Oe(0,mf,em),new Oe(0,mf,-em),new Oe(em,0,mf),new Oe(-em,0,mf),new Oe(mf,em,0),new Oe(-mf,em,0)];class Gz{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){lP=this._renderer.getRenderTarget(),cP=this._renderer.getActiveCubeFace(),uP=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=zz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Vz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(lP,cP,uP),e.scissorTest=!1,Kw(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ov||e.mapping===Lv?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),lP=this._renderer.getRenderTarget(),cP=this._renderer.getActiveCubeFace(),uP=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Ga,minFilter:Ga,generateMipmaps:!1,type:zA,format:zl,colorSpace:oh,depthBuffer:!1},r=Hz(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Hz(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=yje(s)),this._blurMaterial=Aje(s,e,t)}return r}_compileMaterial(e){const t=new $u(this._lodPlanes[0],e);this._renderer.compile(t,aP)}_sceneToCubeUV(e,t,i,r){const a=new Ha(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(Fz),u.toneMapping=xd,u.autoClear=!1;const f=new VK({name:"PMREM.Background",side:Vo,depthWrite:!1,depthTest:!1}),p=new $u(new mb,f);let g=!1;const m=e.background;m?m.isColor&&(f.color.copy(m),e.background=null,g=!0):(f.color.copy(Fz),g=!0);for(let v=0;v<6;v++){const _=v%3;_===0?(a.up.set(0,l[v],0),a.lookAt(c[v],0,0)):_===1?(a.up.set(0,0,l[v]),a.lookAt(0,c[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,c[v]));const y=this._cubeSize;Kw(r,_*y,v>2?y:0,y,y),u.setRenderTarget(r),g&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=m}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Ov||e.mapping===Lv;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=zz()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Vz());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new $u(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Kw(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,aP)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=Uz[(r-1)%Uz.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new $u(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Ef-1),g=s/p,m=isFinite(s)?1+Math.floor(u*g):Ef;m>Ef&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Ef}`);const v=[];let _=0;for(let C=0;C<Ef;++C){const I=C/g,x=Math.exp(-I*I/2);v.push(x),C===0?_+=x:C<m&&(_+=2*x)}for(let C=0;C<v.length;C++)v[C]=v[C]/_;d.envMap.value=e.texture,d.samples.value=m,d.weights.value=v,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-i;const A=this._sizeLods[r],w=3*A*(r>y-bm?r-y+bm:0),b=4*(this._cubeSize-A);Kw(t,w,b,3*A,2*A),l.setRenderTarget(t),l.render(h,aP)}}function yje(n){const e=[],t=[],i=[];let r=n;const s=n-bm+1+Bz.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-bm?l=Bz[o-n+bm-1]:o===0&&(l=0),i.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,g=3,m=2,v=1,_=new Float32Array(g*p*f),y=new Float32Array(m*p*f),A=new Float32Array(v*p*f);for(let b=0;b<f;b++){const C=b%3*2/3-1,I=b>2?0:-1,x=[C,I,0,C+2/3,I,0,C+2/3,I+1,0,C,I,0,C+2/3,I+1,0,C,I+1,0];_.set(x,g*p*b),y.set(d,m*p*b);const T=[b,b,b,b,b,b];A.set(T,v*p*b)}const w=new wa;w.setAttribute("position",new Jl(_,g)),w.setAttribute("uv",new Jl(y,m)),w.setAttribute("faceIndex",new Jl(A,v)),e.push(w),r>bm&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function Hz(n,e,t){const i=new Kp(n,e,t);return i.texture.mapping=PI,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Kw(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Aje(n,e,t){const i=new Float32Array(Ef),r=new Oe(0,1,0);return new tc({name:"SphericalGaussianBlur",defines:{n:Ef,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:hN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:wd,depthTest:!1,depthWrite:!1})}function Vz(){return new tc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:hN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:wd,depthTest:!1,depthWrite:!1})}function zz(){return new tc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:hN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:wd,depthTest:!1,depthWrite:!1})}function hN(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function bje(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===Ck||l===Ek,u=l===Ov||l===Lv;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return t===null&&(t=new Gz(n)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||u&&h&&r(h)){t===null&&(t=new Gz(n));const d=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function wje(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function xje(n,e,t,i){const r={},s=new WeakMap;function o(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);for(const p in d.morphAttributes){const g=d.morphAttributes[p];for(let m=0,v=g.length;m<v;m++)e.remove(g[m])}d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function a(h,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d}function l(h){const d=h.attributes;for(const p in d)e.update(d[p],n.ARRAY_BUFFER);const f=h.morphAttributes;for(const p in f){const g=f[p];for(let m=0,v=g.length;m<v;m++)e.update(g[m],n.ARRAY_BUFFER)}}function c(h){const d=[],f=h.index,p=h.attributes.position;let g=0;if(f!==null){const _=f.array;g=f.version;for(let y=0,A=_.length;y<A;y+=3){const w=_[y+0],b=_[y+1],C=_[y+2];d.push(w,b,b,C,C,w)}}else if(p!==void 0){const _=p.array;g=p.version;for(let y=0,A=_.length/3-1;y<A;y+=3){const w=y+0,b=y+1,C=y+2;d.push(w,b,b,C,C,w)}}else return;const m=new(NK(d)?$K:zK)(d,1);m.version=g;const v=s.get(h);v&&e.remove(v),s.set(h,m)}function u(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&c(h)}else c(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:u}}function Cje(n,e,t,i){const r=i.isWebGL2;let s;function o(f){s=f}let a,l;function c(f){a=f.type,l=f.bytesPerElement}function u(f,p){n.drawElements(s,p,a,f*l),t.update(p,s,1)}function h(f,p,g){if(g===0)return;let m,v;if(r)m=n,v="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[v](s,p,a,f*l,g),t.update(p,s,g)}function d(f,p,g){if(g===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let v=0;v<g;v++)this.render(f[v]/l,p[v]);else{m.multiDrawElementsWEBGL(s,p,0,a,f,0,g);let v=0;for(let _=0;_<g;_++)v+=p[_];t.update(v,s,1)}}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=h,this.renderMultiDraw=d}function Eje(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function Tje(n,e){return n[0]-e[0]}function Ije(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Sje(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Sr,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,h){const d=c.morphTargetInfluences;if(e.isWebGL2===!0){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=f!==void 0?f.length:0;let g=s.get(u);if(g===void 0||g.count!==p){let B=function(){F.dispose(),s.delete(u),u.removeEventListener("dispose",B)};g!==void 0&&g.texture.dispose();const _=u.morphAttributes.position!==void 0,y=u.morphAttributes.normal!==void 0,A=u.morphAttributes.color!==void 0,w=u.morphAttributes.position||[],b=u.morphAttributes.normal||[],C=u.morphAttributes.color||[];let I=0;_===!0&&(I=1),y===!0&&(I=2),A===!0&&(I=3);let x=u.attributes.position.count*I,T=1;x>e.maxTextureSize&&(T=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const O=new Float32Array(x*T*4*p),F=new UK(O,x,T,p);F.type=ud,F.needsUpdate=!0;const G=I*4;for(let R=0;R<p;R++){const P=w[R],k=b[R],L=C[R],H=x*T*4*R;for(let U=0;U<P.count;U++){const $=U*G;_===!0&&(o.fromBufferAttribute(P,U),O[H+$+0]=o.x,O[H+$+1]=o.y,O[H+$+2]=o.z,O[H+$+3]=0),y===!0&&(o.fromBufferAttribute(k,U),O[H+$+4]=o.x,O[H+$+5]=o.y,O[H+$+6]=o.z,O[H+$+7]=0),A===!0&&(o.fromBufferAttribute(L,U),O[H+$+8]=o.x,O[H+$+9]=o.y,O[H+$+10]=o.z,O[H+$+11]=L.itemSize===4?o.w:1)}}g={count:p,texture:F,size:new wn(x,T)},s.set(u,g),u.addEventListener("dispose",B)}let m=0;for(let _=0;_<d.length;_++)m+=d[_];const v=u.morphTargetsRelative?1:1-m;h.getUniforms().setValue(n,"morphTargetBaseInfluence",v),h.getUniforms().setValue(n,"morphTargetInfluences",d),h.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{const f=d===void 0?0:d.length;let p=i[u.id];if(p===void 0||p.length!==f){p=[];for(let y=0;y<f;y++)p[y]=[y,0];i[u.id]=p}for(let y=0;y<f;y++){const A=p[y];A[0]=y,A[1]=d[y]}p.sort(Ije);for(let y=0;y<8;y++)y<f&&p[y][1]?(a[y][0]=p[y][0],a[y][1]=p[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(Tje);const g=u.morphAttributes.position,m=u.morphAttributes.normal;let v=0;for(let y=0;y<8;y++){const A=a[y],w=A[0],b=A[1];w!==Number.MAX_SAFE_INTEGER&&b?(g&&u.getAttribute("morphTarget"+y)!==g[w]&&u.setAttribute("morphTarget"+y,g[w]),m&&u.getAttribute("morphNormal"+y)!==m[w]&&u.setAttribute("morphNormal"+y,m[w]),r[y]=b,v+=b):(g&&u.hasAttribute("morphTarget"+y)===!0&&u.deleteAttribute("morphTarget"+y),m&&u.hasAttribute("morphNormal"+y)===!0&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const _=u.morphTargetsRelative?1:1-v;h.getUniforms().setValue(n,"morphTargetBaseInfluence",_),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function Pje(n,e,t,i){let r=new WeakMap;function s(l){const c=i.render.frame,u=l.geometry,h=e.get(l,u);if(r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const d=l.skeleton;r.get(d)!==c&&(d.update(),r.set(d,c))}return h}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}class qK extends _a{constructor(e,t,i,r,s,o,a,l,c,u){if(u=u!==void 0?u:Ep,u!==Ep&&u!==Nv)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&u===Ep&&(i=cd),i===void 0&&u===Nv&&(i=Cp),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:go,this.minFilter=l!==void 0?l:go,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const KK=new _a,JK=new qK(1,1);JK.compareFunction=LK;const ZK=new UK,eJ=new fWe,tJ=new QK,$z=[],Wz=[],jz=new Float32Array(16),Qz=new Float32Array(9),Xz=new Float32Array(4);function g_(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=$z[r];if(s===void 0&&(s=new Float32Array(r),$z[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Kr(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Jr(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function kI(n,e){let t=Wz[e];t===void 0&&(t=new Int32Array(e),Wz[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Mje(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Rje(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Kr(t,e))return;n.uniform2fv(this.addr,e),Jr(t,e)}}function Dje(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Kr(t,e))return;n.uniform3fv(this.addr,e),Jr(t,e)}}function kje(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Kr(t,e))return;n.uniform4fv(this.addr,e),Jr(t,e)}}function Oje(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Kr(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Jr(t,e)}else{if(Kr(t,i))return;Xz.set(i),n.uniformMatrix2fv(this.addr,!1,Xz),Jr(t,i)}}function Lje(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Kr(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Jr(t,e)}else{if(Kr(t,i))return;Qz.set(i),n.uniformMatrix3fv(this.addr,!1,Qz),Jr(t,i)}}function Nje(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Kr(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Jr(t,e)}else{if(Kr(t,i))return;jz.set(i),n.uniformMatrix4fv(this.addr,!1,jz),Jr(t,i)}}function Bje(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function Fje(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Kr(t,e))return;n.uniform2iv(this.addr,e),Jr(t,e)}}function Uje(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Kr(t,e))return;n.uniform3iv(this.addr,e),Jr(t,e)}}function Gje(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Kr(t,e))return;n.uniform4iv(this.addr,e),Jr(t,e)}}function Hje(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Vje(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Kr(t,e))return;n.uniform2uiv(this.addr,e),Jr(t,e)}}function zje(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Kr(t,e))return;n.uniform3uiv(this.addr,e),Jr(t,e)}}function $je(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Kr(t,e))return;n.uniform4uiv(this.addr,e),Jr(t,e)}}function Wje(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);const s=this.type===n.SAMPLER_2D_SHADOW?JK:KK;t.setTexture2D(e||s,r)}function jje(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||eJ,r)}function Qje(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||tJ,r)}function Xje(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||ZK,r)}function Yje(n){switch(n){case 5126:return Mje;case 35664:return Rje;case 35665:return Dje;case 35666:return kje;case 35674:return Oje;case 35675:return Lje;case 35676:return Nje;case 5124:case 35670:return Bje;case 35667:case 35671:return Fje;case 35668:case 35672:return Uje;case 35669:case 35673:return Gje;case 5125:return Hje;case 36294:return Vje;case 36295:return zje;case 36296:return $je;case 35678:case 36198:case 36298:case 36306:case 35682:return Wje;case 35679:case 36299:case 36307:return jje;case 35680:case 36300:case 36308:case 36293:return Qje;case 36289:case 36303:case 36311:case 36292:return Xje}}function qje(n,e){n.uniform1fv(this.addr,e)}function Kje(n,e){const t=g_(e,this.size,2);n.uniform2fv(this.addr,t)}function Jje(n,e){const t=g_(e,this.size,3);n.uniform3fv(this.addr,t)}function Zje(n,e){const t=g_(e,this.size,4);n.uniform4fv(this.addr,t)}function eQe(n,e){const t=g_(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function tQe(n,e){const t=g_(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function nQe(n,e){const t=g_(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function iQe(n,e){n.uniform1iv(this.addr,e)}function rQe(n,e){n.uniform2iv(this.addr,e)}function sQe(n,e){n.uniform3iv(this.addr,e)}function oQe(n,e){n.uniform4iv(this.addr,e)}function aQe(n,e){n.uniform1uiv(this.addr,e)}function lQe(n,e){n.uniform2uiv(this.addr,e)}function cQe(n,e){n.uniform3uiv(this.addr,e)}function uQe(n,e){n.uniform4uiv(this.addr,e)}function hQe(n,e,t){const i=this.cache,r=e.length,s=kI(t,r);Kr(i,s)||(n.uniform1iv(this.addr,s),Jr(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||KK,s[o])}function dQe(n,e,t){const i=this.cache,r=e.length,s=kI(t,r);Kr(i,s)||(n.uniform1iv(this.addr,s),Jr(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||eJ,s[o])}function fQe(n,e,t){const i=this.cache,r=e.length,s=kI(t,r);Kr(i,s)||(n.uniform1iv(this.addr,s),Jr(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||tJ,s[o])}function pQe(n,e,t){const i=this.cache,r=e.length,s=kI(t,r);Kr(i,s)||(n.uniform1iv(this.addr,s),Jr(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||ZK,s[o])}function gQe(n){switch(n){case 5126:return qje;case 35664:return Kje;case 35665:return Jje;case 35666:return Zje;case 35674:return eQe;case 35675:return tQe;case 35676:return nQe;case 5124:case 35670:return iQe;case 35667:case 35671:return rQe;case 35668:case 35672:return sQe;case 35669:case 35673:return oQe;case 5125:return aQe;case 36294:return lQe;case 36295:return cQe;case 36296:return uQe;case 35678:case 36198:case 36298:case 36306:case 35682:return hQe;case 35679:case 36299:case 36307:return dQe;case 35680:case 36300:case 36308:case 36293:return fQe;case 36289:case 36303:case 36311:case 36292:return pQe}}class mQe{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=Yje(t.type)}}class vQe{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=gQe(t.type)}}class _Qe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const hP=/(\w+)(\])?(\[|\.)?/g;function Yz(n,e){n.seq.push(e),n.map[e.id]=e}function yQe(n,e,t){const i=n.name,r=i.length;for(hP.lastIndex=0;;){const s=hP.exec(i),o=hP.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){Yz(t,c===void 0?new mQe(a,n,e):new vQe(a,n,e));break}else{let h=t.map[a];h===void 0&&(h=new _Qe(a),Yz(t,h)),t=h}}}class Kx{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);yQe(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function qz(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const AQe=37297;let bQe=0;function wQe(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function xQe(n){const e=bi.getPrimaries(bi.workingColorSpace),t=bi.getPrimaries(n);let i;switch(e===t?i="":e===dE&&t===hE?i="LinearDisplayP3ToLinearSRGB":e===hE&&t===dE&&(i="LinearSRGBToLinearDisplayP3"),n){case oh:case MI:return[i,"LinearTransferOETF"];case Os:case aN:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function Kz(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+wQe(n.getShaderSource(e),o)}else return r}function CQe(n,e){const t=xQe(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function EQe(n,e){let t;switch(e){case w$e:t="Linear";break;case x$e:t="Reinhard";break;case C$e:t="OptimizedCineon";break;case E$e:t="ACESFilmic";break;case I$e:t="AgX";break;case T$e:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function TQe(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(wm).join(`
`)}function IQe(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(wm).join(`
`)}function SQe(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function PQe(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function wm(n){return n!==""}function Jz(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Zz(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const MQe=/^[ \t]*#include +<([\w\d./]+)>/gm;function Rk(n){return n.replace(MQe,DQe)}const RQe=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function DQe(n,e){let t=Tn[e];if(t===void 0){const i=RQe.get(e);if(i!==void 0)t=Tn[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Rk(t)}const kQe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function e5(n){return n.replace(kQe,OQe)}function OQe(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function t5(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function LQe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===CK?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===q5e?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===du&&(e="SHADOWMAP_TYPE_VSM"),e}function NQe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ov:case Lv:e="ENVMAP_TYPE_CUBE";break;case PI:e="ENVMAP_TYPE_CUBE_UV";break}return e}function BQe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Lv:e="ENVMAP_MODE_REFRACTION";break}return e}function FQe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case EK:e="ENVMAP_BLENDING_MULTIPLY";break;case A$e:e="ENVMAP_BLENDING_MIX";break;case b$e:e="ENVMAP_BLENDING_ADD";break}return e}function UQe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function GQe(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=LQe(t),c=NQe(t),u=BQe(t),h=FQe(t),d=UQe(t),f=t.isWebGL2?"":TQe(t),p=IQe(t),g=SQe(s),m=r.createProgram();let v,_,y=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(wm).join(`
`),v.length>0&&(v+=`
`),_=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(wm).join(`
`),_.length>0&&(_+=`
`)):(v=[t5(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(wm).join(`
`),_=[f,t5(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==xd?"#define TONE_MAPPING":"",t.toneMapping!==xd?Tn.tonemapping_pars_fragment:"",t.toneMapping!==xd?EQe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Tn.colorspace_pars_fragment,CQe("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(wm).join(`
`)),o=Rk(o),o=Jz(o,t),o=Zz(o,t),a=Rk(a),a=Jz(a,t),a=Zz(a,t),o=e5(o),a=e5(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,v=[p,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,_=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===yz?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===yz?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);const A=y+v+o,w=y+_+a,b=qz(r,r.VERTEX_SHADER,A),C=qz(r,r.FRAGMENT_SHADER,w);r.attachShader(m,b),r.attachShader(m,C),t.index0AttributeName!==void 0?r.bindAttribLocation(m,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m);function I(F){if(n.debug.checkShaderErrors){const G=r.getProgramInfoLog(m).trim(),B=r.getShaderInfoLog(b).trim(),R=r.getShaderInfoLog(C).trim();let P=!0,k=!0;if(r.getProgramParameter(m,r.LINK_STATUS)===!1)if(P=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,m,b,C);else{const L=Kz(r,b,"vertex"),H=Kz(r,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+`

Program Info Log: `+G+`
`+L+`
`+H)}else G!==""?console.warn("THREE.WebGLProgram: Program Info Log:",G):(B===""||R==="")&&(k=!1);k&&(F.diagnostics={runnable:P,programLog:G,vertexShader:{log:B,prefix:v},fragmentShader:{log:R,prefix:_}})}r.deleteShader(b),r.deleteShader(C),x=new Kx(r,m),T=PQe(r,m)}let x;this.getUniforms=function(){return x===void 0&&I(this),x};let T;this.getAttributes=function(){return T===void 0&&I(this),T};let O=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=r.getProgramParameter(m,AQe)),O},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=bQe++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=C,this}let HQe=0;class VQe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new zQe(e),t.set(e,i)),i}}class zQe{constructor(e){this.id=HQe++,this.code=e,this.usedTimes=0}}function $Qe(n,e,t,i,r,s,o){const a=new GK,l=new VQe,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(x){return x===0?"uv":`uv${x}`}function m(x,T,O,F,G){const B=F.fog,R=G.geometry,P=x.isMeshStandardMaterial?F.environment:null,k=(x.isMeshStandardMaterial?t:e).get(x.envMap||P),L=k&&k.mapping===PI?k.image.height:null,H=p[x.type];x.precision!==null&&(f=r.getMaxPrecision(x.precision),f!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead."));const U=R.morphAttributes.position||R.morphAttributes.normal||R.morphAttributes.color,$=U!==void 0?U.length:0;let j=0;R.morphAttributes.position!==void 0&&(j=1),R.morphAttributes.normal!==void 0&&(j=2),R.morphAttributes.color!==void 0&&(j=3);let Q,ne,ve,Pe;if(H){const Ct=ds[H];Q=Ct.vertexShader,ne=Ct.fragmentShader}else Q=x.vertexShader,ne=x.fragmentShader,l.update(x),ve=l.getVertexShaderID(x),Pe=l.getFragmentShaderID(x);const De=n.getRenderTarget(),Xe=G.isInstancedMesh===!0,Ne=G.isBatchedMesh===!0,et=!!x.map,ze=!!x.matcap,de=!!k,lt=!!x.aoMap,he=!!x.lightMap,Ce=!!x.bumpMap,se=!!x.normalMap,Re=!!x.displacementMap,He=!!x.emissiveMap,Y=!!x.metalnessMap,W=!!x.roughnessMap,ge=x.anisotropy>0,Le=x.clearcoat>0,Ve=x.iridescence>0,pe=x.sheen>0,fe=x.transmission>0,Ee=ge&&!!x.anisotropyMap,oe=Le&&!!x.clearcoatMap,Me=Le&&!!x.clearcoatNormalMap,je=Le&&!!x.clearcoatRoughnessMap,_e=Ve&&!!x.iridescenceMap,Ye=Ve&&!!x.iridescenceThicknessMap,q=pe&&!!x.sheenColorMap,we=pe&&!!x.sheenRoughnessMap,M=!!x.specularMap,N=!!x.specularColorMap,D=!!x.specularIntensityMap,z=fe&&!!x.transmissionMap,K=fe&&!!x.thicknessMap,ce=!!x.gradientMap,ae=!!x.alphaMap,J=x.alphaTest>0,xe=!!x.alphaHash,Se=!!x.extensions,rt=!!R.attributes.uv1,ot=!!R.attributes.uv2,gt=!!R.attributes.uv3;let ut=xd;return x.toneMapped&&(De===null||De.isXRRenderTarget===!0)&&(ut=n.toneMapping),{isWebGL2:u,shaderID:H,shaderType:x.type,shaderName:x.name,vertexShader:Q,fragmentShader:ne,defines:x.defines,customVertexShaderID:ve,customFragmentShaderID:Pe,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:f,batching:Ne,instancing:Xe,instancingColor:Xe&&G.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:De===null?n.outputColorSpace:De.isXRRenderTarget===!0?De.texture.colorSpace:oh,map:et,matcap:ze,envMap:de,envMapMode:de&&k.mapping,envMapCubeUVHeight:L,aoMap:lt,lightMap:he,bumpMap:Ce,normalMap:se,displacementMap:d&&Re,emissiveMap:He,normalMapObjectSpace:se&&x.normalMapType===G$e,normalMapTangentSpace:se&&x.normalMapType===U$e,metalnessMap:Y,roughnessMap:W,anisotropy:ge,anisotropyMap:Ee,clearcoat:Le,clearcoatMap:oe,clearcoatNormalMap:Me,clearcoatRoughnessMap:je,iridescence:Ve,iridescenceMap:_e,iridescenceThicknessMap:Ye,sheen:pe,sheenColorMap:q,sheenRoughnessMap:we,specularMap:M,specularColorMap:N,specularIntensityMap:D,transmission:fe,transmissionMap:z,thicknessMap:K,gradientMap:ce,opaque:x.transparent===!1&&x.blending===Lm,alphaMap:ae,alphaTest:J,alphaHash:xe,combine:x.combine,mapUv:et&&g(x.map.channel),aoMapUv:lt&&g(x.aoMap.channel),lightMapUv:he&&g(x.lightMap.channel),bumpMapUv:Ce&&g(x.bumpMap.channel),normalMapUv:se&&g(x.normalMap.channel),displacementMapUv:Re&&g(x.displacementMap.channel),emissiveMapUv:He&&g(x.emissiveMap.channel),metalnessMapUv:Y&&g(x.metalnessMap.channel),roughnessMapUv:W&&g(x.roughnessMap.channel),anisotropyMapUv:Ee&&g(x.anisotropyMap.channel),clearcoatMapUv:oe&&g(x.clearcoatMap.channel),clearcoatNormalMapUv:Me&&g(x.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:je&&g(x.clearcoatRoughnessMap.channel),iridescenceMapUv:_e&&g(x.iridescenceMap.channel),iridescenceThicknessMapUv:Ye&&g(x.iridescenceThicknessMap.channel),sheenColorMapUv:q&&g(x.sheenColorMap.channel),sheenRoughnessMapUv:we&&g(x.sheenRoughnessMap.channel),specularMapUv:M&&g(x.specularMap.channel),specularColorMapUv:N&&g(x.specularColorMap.channel),specularIntensityMapUv:D&&g(x.specularIntensityMap.channel),transmissionMapUv:z&&g(x.transmissionMap.channel),thicknessMapUv:K&&g(x.thicknessMap.channel),alphaMapUv:ae&&g(x.alphaMap.channel),vertexTangents:!!R.attributes.tangent&&(se||ge),vertexColors:x.vertexColors,vertexAlphas:x.vertexColors===!0&&!!R.attributes.color&&R.attributes.color.itemSize===4,vertexUv1s:rt,vertexUv2s:ot,vertexUv3s:gt,pointsUvs:G.isPoints===!0&&!!R.attributes.uv&&(et||ae),fog:!!B,useFog:x.fog===!0,fogExp2:B&&B.isFogExp2,flatShading:x.flatShading===!0,sizeAttenuation:x.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:G.isSkinnedMesh===!0,morphTargets:R.morphAttributes.position!==void 0,morphNormals:R.morphAttributes.normal!==void 0,morphColors:R.morphAttributes.color!==void 0,morphTargetsCount:$,morphTextureStride:j,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numLightProbes:T.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:n.shadowMap.enabled&&O.length>0,shadowMapType:n.shadowMap.type,toneMapping:ut,useLegacyLights:n._useLegacyLights,decodeVideoTexture:et&&x.map.isVideoTexture===!0&&bi.getTransfer(x.map.colorSpace)===zi,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===Bu,flipSided:x.side===Vo,useDepthPacking:x.depthPacking>=0,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:Se&&x.extensions.derivatives===!0,extensionFragDepth:Se&&x.extensions.fragDepth===!0,extensionDrawBuffers:Se&&x.extensions.drawBuffers===!0,extensionShaderTextureLOD:Se&&x.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Se&&x.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:x.customProgramCacheKey()}}function v(x){const T=[];if(x.shaderID?T.push(x.shaderID):(T.push(x.customVertexShaderID),T.push(x.customFragmentShaderID)),x.defines!==void 0)for(const O in x.defines)T.push(O),T.push(x.defines[O]);return x.isRawShaderMaterial===!1&&(_(T,x),y(T,x),T.push(n.outputColorSpace)),T.push(x.customProgramCacheKey),T.join()}function _(x,T){x.push(T.precision),x.push(T.outputColorSpace),x.push(T.envMapMode),x.push(T.envMapCubeUVHeight),x.push(T.mapUv),x.push(T.alphaMapUv),x.push(T.lightMapUv),x.push(T.aoMapUv),x.push(T.bumpMapUv),x.push(T.normalMapUv),x.push(T.displacementMapUv),x.push(T.emissiveMapUv),x.push(T.metalnessMapUv),x.push(T.roughnessMapUv),x.push(T.anisotropyMapUv),x.push(T.clearcoatMapUv),x.push(T.clearcoatNormalMapUv),x.push(T.clearcoatRoughnessMapUv),x.push(T.iridescenceMapUv),x.push(T.iridescenceThicknessMapUv),x.push(T.sheenColorMapUv),x.push(T.sheenRoughnessMapUv),x.push(T.specularMapUv),x.push(T.specularColorMapUv),x.push(T.specularIntensityMapUv),x.push(T.transmissionMapUv),x.push(T.thicknessMapUv),x.push(T.combine),x.push(T.fogExp2),x.push(T.sizeAttenuation),x.push(T.morphTargetsCount),x.push(T.morphAttributeCount),x.push(T.numDirLights),x.push(T.numPointLights),x.push(T.numSpotLights),x.push(T.numSpotLightMaps),x.push(T.numHemiLights),x.push(T.numRectAreaLights),x.push(T.numDirLightShadows),x.push(T.numPointLightShadows),x.push(T.numSpotLightShadows),x.push(T.numSpotLightShadowsWithMaps),x.push(T.numLightProbes),x.push(T.shadowMapType),x.push(T.toneMapping),x.push(T.numClippingPlanes),x.push(T.numClipIntersection),x.push(T.depthPacking)}function y(x,T){a.disableAll(),T.isWebGL2&&a.enable(0),T.supportsVertexTextures&&a.enable(1),T.instancing&&a.enable(2),T.instancingColor&&a.enable(3),T.matcap&&a.enable(4),T.envMap&&a.enable(5),T.normalMapObjectSpace&&a.enable(6),T.normalMapTangentSpace&&a.enable(7),T.clearcoat&&a.enable(8),T.iridescence&&a.enable(9),T.alphaTest&&a.enable(10),T.vertexColors&&a.enable(11),T.vertexAlphas&&a.enable(12),T.vertexUv1s&&a.enable(13),T.vertexUv2s&&a.enable(14),T.vertexUv3s&&a.enable(15),T.vertexTangents&&a.enable(16),T.anisotropy&&a.enable(17),T.alphaHash&&a.enable(18),T.batching&&a.enable(19),x.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.skinning&&a.enable(4),T.morphTargets&&a.enable(5),T.morphNormals&&a.enable(6),T.morphColors&&a.enable(7),T.premultipliedAlpha&&a.enable(8),T.shadowMapEnabled&&a.enable(9),T.useLegacyLights&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.transmission&&a.enable(15),T.sheen&&a.enable(16),T.opaque&&a.enable(17),T.pointsUvs&&a.enable(18),T.decodeVideoTexture&&a.enable(19),x.push(a.mask)}function A(x){const T=p[x.type];let O;if(T){const F=ds[T];O=vb.clone(F.uniforms)}else O=x.uniforms;return O}function w(x,T){let O;for(let F=0,G=c.length;F<G;F++){const B=c[F];if(B.cacheKey===T){O=B,++O.usedTimes;break}}return O===void 0&&(O=new GQe(n,T,x,s),c.push(O)),O}function b(x){if(--x.usedTimes===0){const T=c.indexOf(x);c[T]=c[c.length-1],c.pop(),x.destroy()}}function C(x){l.remove(x)}function I(){l.dispose()}return{getParameters:m,getProgramCacheKey:v,getUniforms:A,acquireProgram:w,releaseProgram:b,releaseShaderCache:C,programs:c,dispose:I}}function WQe(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function jQe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function n5(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function i5(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(h,d,f,p,g,m){let v=n[e];return v===void 0?(v={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:g,group:m},n[e]=v):(v.id=h.id,v.object=h,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=h.renderOrder,v.z=g,v.group=m),e++,v}function a(h,d,f,p,g,m){const v=o(h,d,f,p,g,m);f.transmission>0?i.push(v):f.transparent===!0?r.push(v):t.push(v)}function l(h,d,f,p,g,m){const v=o(h,d,f,p,g,m);f.transmission>0?i.unshift(v):f.transparent===!0?r.unshift(v):t.unshift(v)}function c(h,d){t.length>1&&t.sort(h||jQe),i.length>1&&i.sort(d||n5),r.length>1&&r.sort(d||n5)}function u(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function QQe(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new i5,n.set(i,[o])):r>=s.length?(o=new i5,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function XQe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Oe,color:new $n};break;case"SpotLight":t={position:new Oe,direction:new Oe,color:new $n,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Oe,color:new $n,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Oe,skyColor:new $n,groundColor:new $n};break;case"RectAreaLight":t={color:new $n,position:new Oe,halfWidth:new Oe,halfHeight:new Oe};break}return n[e.id]=t,t}}}function YQe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new wn};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new wn};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new wn,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let qQe=0;function KQe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function JQe(n,e){const t=new XQe,i=YQe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new Oe);const s=new Oe,o=new mr,a=new mr;function l(u,h){let d=0,f=0,p=0;for(let F=0;F<9;F++)r.probe[F].set(0,0,0);let g=0,m=0,v=0,_=0,y=0,A=0,w=0,b=0,C=0,I=0,x=0;u.sort(KQe);const T=h===!0?Math.PI:1;for(let F=0,G=u.length;F<G;F++){const B=u[F],R=B.color,P=B.intensity,k=B.distance,L=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)d+=R.r*P*T,f+=R.g*P*T,p+=R.b*P*T;else if(B.isLightProbe){for(let H=0;H<9;H++)r.probe[H].addScaledVector(B.sh.coefficients[H],P);x++}else if(B.isDirectionalLight){const H=t.get(B);if(H.color.copy(B.color).multiplyScalar(B.intensity*T),B.castShadow){const U=B.shadow,$=i.get(B);$.shadowBias=U.bias,$.shadowNormalBias=U.normalBias,$.shadowRadius=U.radius,$.shadowMapSize=U.mapSize,r.directionalShadow[g]=$,r.directionalShadowMap[g]=L,r.directionalShadowMatrix[g]=B.shadow.matrix,A++}r.directional[g]=H,g++}else if(B.isSpotLight){const H=t.get(B);H.position.setFromMatrixPosition(B.matrixWorld),H.color.copy(R).multiplyScalar(P*T),H.distance=k,H.coneCos=Math.cos(B.angle),H.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),H.decay=B.decay,r.spot[v]=H;const U=B.shadow;if(B.map&&(r.spotLightMap[C]=B.map,C++,U.updateMatrices(B),B.castShadow&&I++),r.spotLightMatrix[v]=U.matrix,B.castShadow){const $=i.get(B);$.shadowBias=U.bias,$.shadowNormalBias=U.normalBias,$.shadowRadius=U.radius,$.shadowMapSize=U.mapSize,r.spotShadow[v]=$,r.spotShadowMap[v]=L,b++}v++}else if(B.isRectAreaLight){const H=t.get(B);H.color.copy(R).multiplyScalar(P),H.halfWidth.set(B.width*.5,0,0),H.halfHeight.set(0,B.height*.5,0),r.rectArea[_]=H,_++}else if(B.isPointLight){const H=t.get(B);if(H.color.copy(B.color).multiplyScalar(B.intensity*T),H.distance=B.distance,H.decay=B.decay,B.castShadow){const U=B.shadow,$=i.get(B);$.shadowBias=U.bias,$.shadowNormalBias=U.normalBias,$.shadowRadius=U.radius,$.shadowMapSize=U.mapSize,$.shadowCameraNear=U.camera.near,$.shadowCameraFar=U.camera.far,r.pointShadow[m]=$,r.pointShadowMap[m]=L,r.pointShadowMatrix[m]=B.shadow.matrix,w++}r.point[m]=H,m++}else if(B.isHemisphereLight){const H=t.get(B);H.skyColor.copy(B.color).multiplyScalar(P*T),H.groundColor.copy(B.groundColor).multiplyScalar(P*T),r.hemi[y]=H,y++}}_>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=_t.LTC_FLOAT_1,r.rectAreaLTC2=_t.LTC_FLOAT_2):(r.rectAreaLTC1=_t.LTC_HALF_1,r.rectAreaLTC2=_t.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=_t.LTC_FLOAT_1,r.rectAreaLTC2=_t.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=_t.LTC_HALF_1,r.rectAreaLTC2=_t.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const O=r.hash;(O.directionalLength!==g||O.pointLength!==m||O.spotLength!==v||O.rectAreaLength!==_||O.hemiLength!==y||O.numDirectionalShadows!==A||O.numPointShadows!==w||O.numSpotShadows!==b||O.numSpotMaps!==C||O.numLightProbes!==x)&&(r.directional.length=g,r.spot.length=v,r.rectArea.length=_,r.point.length=m,r.hemi.length=y,r.directionalShadow.length=A,r.directionalShadowMap.length=A,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=b,r.spotShadowMap.length=b,r.directionalShadowMatrix.length=A,r.pointShadowMatrix.length=w,r.spotLightMatrix.length=b+C-I,r.spotLightMap.length=C,r.numSpotLightShadowsWithMaps=I,r.numLightProbes=x,O.directionalLength=g,O.pointLength=m,O.spotLength=v,O.rectAreaLength=_,O.hemiLength=y,O.numDirectionalShadows=A,O.numPointShadows=w,O.numSpotShadows=b,O.numSpotMaps=C,O.numLightProbes=x,r.version=qQe++)}function c(u,h){let d=0,f=0,p=0,g=0,m=0;const v=h.matrixWorldInverse;for(let _=0,y=u.length;_<y;_++){const A=u[_];if(A.isDirectionalLight){const w=r.directional[d];w.direction.setFromMatrixPosition(A.matrixWorld),s.setFromMatrixPosition(A.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(v),d++}else if(A.isSpotLight){const w=r.spot[p];w.position.setFromMatrixPosition(A.matrixWorld),w.position.applyMatrix4(v),w.direction.setFromMatrixPosition(A.matrixWorld),s.setFromMatrixPosition(A.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(v),p++}else if(A.isRectAreaLight){const w=r.rectArea[g];w.position.setFromMatrixPosition(A.matrixWorld),w.position.applyMatrix4(v),a.identity(),o.copy(A.matrixWorld),o.premultiply(v),a.extractRotation(o),w.halfWidth.set(A.width*.5,0,0),w.halfHeight.set(0,A.height*.5,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),g++}else if(A.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(A.matrixWorld),w.position.applyMatrix4(v),f++}else if(A.isHemisphereLight){const w=r.hemi[m];w.direction.setFromMatrixPosition(A.matrixWorld),w.direction.transformDirection(v),m++}}}return{setup:l,setupView:c,state:r}}function r5(n,e){const t=new JQe(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(h){i.push(h)}function a(h){r.push(h)}function l(h){t.setup(i,h)}function c(h){t.setupView(i,h)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function ZQe(n,e){let t=new WeakMap;function i(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new r5(n,e),t.set(s,[l])):o>=a.length?(l=new r5(n,e),a.push(l)):l=a[o],l}function r(){t=new WeakMap}return{get:i,dispose:r}}class eXe extends p_{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=B$e,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class tXe extends p_{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const nXe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,iXe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function rXe(n,e,t){let i=new XK;const r=new wn,s=new wn,o=new Sr,a=new eXe({depthPacking:F$e}),l=new tXe,c={},u=t.maxTextureSize,h={[Od]:Vo,[Vo]:Od,[Bu]:Bu},d=new tc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new wn},radius:{value:4}},vertexShader:nXe,fragmentShader:iXe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new wa;p.setAttribute("position",new Jl(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new $u(p,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=CK;let v=this.type;this.render=function(b,C,I){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||b.length===0)return;const x=n.getRenderTarget(),T=n.getActiveCubeFace(),O=n.getActiveMipmapLevel(),F=n.state;F.setBlending(wd),F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);const G=v!==du&&this.type===du,B=v===du&&this.type!==du;for(let R=0,P=b.length;R<P;R++){const k=b[R],L=k.shadow;if(L===void 0){console.warn("THREE.WebGLShadowMap:",k,"has no shadow.");continue}if(L.autoUpdate===!1&&L.needsUpdate===!1)continue;r.copy(L.mapSize);const H=L.getFrameExtents();if(r.multiply(H),s.copy(L.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/H.x),r.x=s.x*H.x,L.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/H.y),r.y=s.y*H.y,L.mapSize.y=s.y)),L.map===null||G===!0||B===!0){const $=this.type!==du?{minFilter:go,magFilter:go}:{};L.map!==null&&L.map.dispose(),L.map=new Kp(r.x,r.y,$),L.map.texture.name=k.name+".shadowMap",L.camera.updateProjectionMatrix()}n.setRenderTarget(L.map),n.clear();const U=L.getViewportCount();for(let $=0;$<U;$++){const j=L.getViewport($);o.set(s.x*j.x,s.y*j.y,s.x*j.z,s.y*j.w),F.viewport(o),L.updateMatrices(k,$),i=L.getFrustum(),A(C,I,L.camera,k,this.type)}L.isPointLightShadow!==!0&&this.type===du&&_(L,I),L.needsUpdate=!1}v=this.type,m.needsUpdate=!1,n.setRenderTarget(x,T,O)};function _(b,C){const I=e.update(g);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new Kp(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(C,null,I,d,g,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(C,null,I,f,g,null)}function y(b,C,I,x){let T=null;const O=I.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(O!==void 0)T=O;else if(T=I.isPointLight===!0?l:a,n.localClippingEnabled&&C.clipShadows===!0&&Array.isArray(C.clippingPlanes)&&C.clippingPlanes.length!==0||C.displacementMap&&C.displacementScale!==0||C.alphaMap&&C.alphaTest>0||C.map&&C.alphaTest>0){const F=T.uuid,G=C.uuid;let B=c[F];B===void 0&&(B={},c[F]=B);let R=B[G];R===void 0&&(R=T.clone(),B[G]=R,C.addEventListener("dispose",w)),T=R}if(T.visible=C.visible,T.wireframe=C.wireframe,x===du?T.side=C.shadowSide!==null?C.shadowSide:C.side:T.side=C.shadowSide!==null?C.shadowSide:h[C.side],T.alphaMap=C.alphaMap,T.alphaTest=C.alphaTest,T.map=C.map,T.clipShadows=C.clipShadows,T.clippingPlanes=C.clippingPlanes,T.clipIntersection=C.clipIntersection,T.displacementMap=C.displacementMap,T.displacementScale=C.displacementScale,T.displacementBias=C.displacementBias,T.wireframeLinewidth=C.wireframeLinewidth,T.linewidth=C.linewidth,I.isPointLight===!0&&T.isMeshDistanceMaterial===!0){const F=n.properties.get(T);F.light=I}return T}function A(b,C,I,x,T){if(b.visible===!1)return;if(b.layers.test(C.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&T===du)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(I.matrixWorldInverse,b.matrixWorld);const G=e.update(b),B=b.material;if(Array.isArray(B)){const R=G.groups;for(let P=0,k=R.length;P<k;P++){const L=R[P],H=B[L.materialIndex];if(H&&H.visible){const U=y(b,H,x,T);b.onBeforeShadow(n,b,C,I,G,U,L),n.renderBufferDirect(I,null,G,U,b,L),b.onAfterShadow(n,b,C,I,G,U,L)}}}else if(B.visible){const R=y(b,B,x,T);b.onBeforeShadow(n,b,C,I,G,R,null),n.renderBufferDirect(I,null,G,R,b,null),b.onAfterShadow(n,b,C,I,G,R,null)}}const F=b.children;for(let G=0,B=F.length;G<B;G++)A(F[G],C,I,x,T)}function w(b){b.target.removeEventListener("dispose",w);for(const I in c){const x=c[I],T=b.target.uuid;T in x&&(x[T].dispose(),delete x[T])}}}function sXe(n,e,t){const i=t.isWebGL2;function r(){let J=!1;const xe=new Sr;let Se=null;const rt=new Sr(0,0,0,0);return{setMask:function(ot){Se!==ot&&!J&&(n.colorMask(ot,ot,ot,ot),Se=ot)},setLocked:function(ot){J=ot},setClear:function(ot,gt,ut,ct,Ct){Ct===!0&&(ot*=ct,gt*=ct,ut*=ct),xe.set(ot,gt,ut,ct),rt.equals(xe)===!1&&(n.clearColor(ot,gt,ut,ct),rt.copy(xe))},reset:function(){J=!1,Se=null,rt.set(-1,0,0,0)}}}function s(){let J=!1,xe=null,Se=null,rt=null;return{setTest:function(ot){ot?Ne(n.DEPTH_TEST):et(n.DEPTH_TEST)},setMask:function(ot){xe!==ot&&!J&&(n.depthMask(ot),xe=ot)},setFunc:function(ot){if(Se!==ot){switch(ot){case f$e:n.depthFunc(n.NEVER);break;case p$e:n.depthFunc(n.ALWAYS);break;case g$e:n.depthFunc(n.LESS);break;case cE:n.depthFunc(n.LEQUAL);break;case m$e:n.depthFunc(n.EQUAL);break;case v$e:n.depthFunc(n.GEQUAL);break;case _$e:n.depthFunc(n.GREATER);break;case y$e:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Se=ot}},setLocked:function(ot){J=ot},setClear:function(ot){rt!==ot&&(n.clearDepth(ot),rt=ot)},reset:function(){J=!1,xe=null,Se=null,rt=null}}}function o(){let J=!1,xe=null,Se=null,rt=null,ot=null,gt=null,ut=null,ct=null,Ct=null;return{setTest:function(vn){J||(vn?Ne(n.STENCIL_TEST):et(n.STENCIL_TEST))},setMask:function(vn){xe!==vn&&!J&&(n.stencilMask(vn),xe=vn)},setFunc:function(vn,ti,fr){(Se!==vn||rt!==ti||ot!==fr)&&(n.stencilFunc(vn,ti,fr),Se=vn,rt=ti,ot=fr)},setOp:function(vn,ti,fr){(gt!==vn||ut!==ti||ct!==fr)&&(n.stencilOp(vn,ti,fr),gt=vn,ut=ti,ct=fr)},setLocked:function(vn){J=vn},setClear:function(vn){Ct!==vn&&(n.clearStencil(vn),Ct=vn)},reset:function(){J=!1,xe=null,Se=null,rt=null,ot=null,gt=null,ut=null,ct=null,Ct=null}}}const a=new r,l=new s,c=new o,u=new WeakMap,h=new WeakMap;let d={},f={},p=new WeakMap,g=[],m=null,v=!1,_=null,y=null,A=null,w=null,b=null,C=null,I=null,x=new $n(0,0,0),T=0,O=!1,F=null,G=null,B=null,R=null,P=null;const k=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let L=!1,H=0;const U=n.getParameter(n.VERSION);U.indexOf("WebGL")!==-1?(H=parseFloat(/^WebGL (\d)/.exec(U)[1]),L=H>=1):U.indexOf("OpenGL ES")!==-1&&(H=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),L=H>=2);let $=null,j={};const Q=n.getParameter(n.SCISSOR_BOX),ne=n.getParameter(n.VIEWPORT),ve=new Sr().fromArray(Q),Pe=new Sr().fromArray(ne);function De(J,xe,Se,rt){const ot=new Uint8Array(4),gt=n.createTexture();n.bindTexture(J,gt),n.texParameteri(J,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(J,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let ut=0;ut<Se;ut++)i&&(J===n.TEXTURE_3D||J===n.TEXTURE_2D_ARRAY)?n.texImage3D(xe,0,n.RGBA,1,1,rt,0,n.RGBA,n.UNSIGNED_BYTE,ot):n.texImage2D(xe+ut,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ot);return gt}const Xe={};Xe[n.TEXTURE_2D]=De(n.TEXTURE_2D,n.TEXTURE_2D,1),Xe[n.TEXTURE_CUBE_MAP]=De(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Xe[n.TEXTURE_2D_ARRAY]=De(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Xe[n.TEXTURE_3D]=De(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Ne(n.DEPTH_TEST),l.setFunc(cE),He(!1),Y(GV),Ne(n.CULL_FACE),se(wd);function Ne(J){d[J]!==!0&&(n.enable(J),d[J]=!0)}function et(J){d[J]!==!1&&(n.disable(J),d[J]=!1)}function ze(J,xe){return f[J]!==xe?(n.bindFramebuffer(J,xe),f[J]=xe,i&&(J===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=xe),J===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=xe)),!0):!1}function de(J,xe){let Se=g,rt=!1;if(J)if(Se=p.get(xe),Se===void 0&&(Se=[],p.set(xe,Se)),J.isWebGLMultipleRenderTargets){const ot=J.texture;if(Se.length!==ot.length||Se[0]!==n.COLOR_ATTACHMENT0){for(let gt=0,ut=ot.length;gt<ut;gt++)Se[gt]=n.COLOR_ATTACHMENT0+gt;Se.length=ot.length,rt=!0}}else Se[0]!==n.COLOR_ATTACHMENT0&&(Se[0]=n.COLOR_ATTACHMENT0,rt=!0);else Se[0]!==n.BACK&&(Se[0]=n.BACK,rt=!0);rt&&(t.isWebGL2?n.drawBuffers(Se):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Se))}function lt(J){return m!==J?(n.useProgram(J),m=J,!0):!1}const he={[Cf]:n.FUNC_ADD,[J5e]:n.FUNC_SUBTRACT,[Z5e]:n.FUNC_REVERSE_SUBTRACT};if(i)he[$V]=n.MIN,he[WV]=n.MAX;else{const J=e.get("EXT_blend_minmax");J!==null&&(he[$V]=J.MIN_EXT,he[WV]=J.MAX_EXT)}const Ce={[e$e]:n.ZERO,[t$e]:n.ONE,[n$e]:n.SRC_COLOR,[wk]:n.SRC_ALPHA,[l$e]:n.SRC_ALPHA_SATURATE,[o$e]:n.DST_COLOR,[r$e]:n.DST_ALPHA,[i$e]:n.ONE_MINUS_SRC_COLOR,[xk]:n.ONE_MINUS_SRC_ALPHA,[a$e]:n.ONE_MINUS_DST_COLOR,[s$e]:n.ONE_MINUS_DST_ALPHA,[c$e]:n.CONSTANT_COLOR,[u$e]:n.ONE_MINUS_CONSTANT_COLOR,[h$e]:n.CONSTANT_ALPHA,[d$e]:n.ONE_MINUS_CONSTANT_ALPHA};function se(J,xe,Se,rt,ot,gt,ut,ct,Ct,vn){if(J===wd){v===!0&&(et(n.BLEND),v=!1);return}if(v===!1&&(Ne(n.BLEND),v=!0),J!==K5e){if(J!==_||vn!==O){if((y!==Cf||b!==Cf)&&(n.blendEquation(n.FUNC_ADD),y=Cf,b=Cf),vn)switch(J){case Lm:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case HV:n.blendFunc(n.ONE,n.ONE);break;case VV:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case zV:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}else switch(J){case Lm:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case HV:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case VV:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case zV:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}A=null,w=null,C=null,I=null,x.set(0,0,0),T=0,_=J,O=vn}return}ot=ot||xe,gt=gt||Se,ut=ut||rt,(xe!==y||ot!==b)&&(n.blendEquationSeparate(he[xe],he[ot]),y=xe,b=ot),(Se!==A||rt!==w||gt!==C||ut!==I)&&(n.blendFuncSeparate(Ce[Se],Ce[rt],Ce[gt],Ce[ut]),A=Se,w=rt,C=gt,I=ut),(ct.equals(x)===!1||Ct!==T)&&(n.blendColor(ct.r,ct.g,ct.b,Ct),x.copy(ct),T=Ct),_=J,O=!1}function Re(J,xe){J.side===Bu?et(n.CULL_FACE):Ne(n.CULL_FACE);let Se=J.side===Vo;xe&&(Se=!Se),He(Se),J.blending===Lm&&J.transparent===!1?se(wd):se(J.blending,J.blendEquation,J.blendSrc,J.blendDst,J.blendEquationAlpha,J.blendSrcAlpha,J.blendDstAlpha,J.blendColor,J.blendAlpha,J.premultipliedAlpha),l.setFunc(J.depthFunc),l.setTest(J.depthTest),l.setMask(J.depthWrite),a.setMask(J.colorWrite);const rt=J.stencilWrite;c.setTest(rt),rt&&(c.setMask(J.stencilWriteMask),c.setFunc(J.stencilFunc,J.stencilRef,J.stencilFuncMask),c.setOp(J.stencilFail,J.stencilZFail,J.stencilZPass)),ge(J.polygonOffset,J.polygonOffsetFactor,J.polygonOffsetUnits),J.alphaToCoverage===!0?Ne(n.SAMPLE_ALPHA_TO_COVERAGE):et(n.SAMPLE_ALPHA_TO_COVERAGE)}function He(J){F!==J&&(J?n.frontFace(n.CW):n.frontFace(n.CCW),F=J)}function Y(J){J!==X5e?(Ne(n.CULL_FACE),J!==G&&(J===GV?n.cullFace(n.BACK):J===Y5e?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):et(n.CULL_FACE),G=J}function W(J){J!==B&&(L&&n.lineWidth(J),B=J)}function ge(J,xe,Se){J?(Ne(n.POLYGON_OFFSET_FILL),(R!==xe||P!==Se)&&(n.polygonOffset(xe,Se),R=xe,P=Se)):et(n.POLYGON_OFFSET_FILL)}function Le(J){J?Ne(n.SCISSOR_TEST):et(n.SCISSOR_TEST)}function Ve(J){J===void 0&&(J=n.TEXTURE0+k-1),$!==J&&(n.activeTexture(J),$=J)}function pe(J,xe,Se){Se===void 0&&($===null?Se=n.TEXTURE0+k-1:Se=$);let rt=j[Se];rt===void 0&&(rt={type:void 0,texture:void 0},j[Se]=rt),(rt.type!==J||rt.texture!==xe)&&($!==Se&&(n.activeTexture(Se),$=Se),n.bindTexture(J,xe||Xe[J]),rt.type=J,rt.texture=xe)}function fe(){const J=j[$];J!==void 0&&J.type!==void 0&&(n.bindTexture(J.type,null),J.type=void 0,J.texture=void 0)}function Ee(){try{n.compressedTexImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function oe(){try{n.compressedTexImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Me(){try{n.texSubImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function je(){try{n.texSubImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function _e(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ye(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function q(){try{n.texStorage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function we(){try{n.texStorage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function M(){try{n.texImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function N(){try{n.texImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function D(J){ve.equals(J)===!1&&(n.scissor(J.x,J.y,J.z,J.w),ve.copy(J))}function z(J){Pe.equals(J)===!1&&(n.viewport(J.x,J.y,J.z,J.w),Pe.copy(J))}function K(J,xe){let Se=h.get(xe);Se===void 0&&(Se=new WeakMap,h.set(xe,Se));let rt=Se.get(J);rt===void 0&&(rt=n.getUniformBlockIndex(xe,J.name),Se.set(J,rt))}function ce(J,xe){const rt=h.get(xe).get(J);u.get(xe)!==rt&&(n.uniformBlockBinding(xe,rt,J.__bindingPointIndex),u.set(xe,rt))}function ae(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},$=null,j={},f={},p=new WeakMap,g=[],m=null,v=!1,_=null,y=null,A=null,w=null,b=null,C=null,I=null,x=new $n(0,0,0),T=0,O=!1,F=null,G=null,B=null,R=null,P=null,ve.set(0,0,n.canvas.width,n.canvas.height),Pe.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:Ne,disable:et,bindFramebuffer:ze,drawBuffers:de,useProgram:lt,setBlending:se,setMaterial:Re,setFlipSided:He,setCullFace:Y,setLineWidth:W,setPolygonOffset:ge,setScissorTest:Le,activeTexture:Ve,bindTexture:pe,unbindTexture:fe,compressedTexImage2D:Ee,compressedTexImage3D:oe,texImage2D:M,texImage3D:N,updateUBOMapping:K,uniformBlockBinding:ce,texStorage2D:q,texStorage3D:we,texSubImage2D:Me,texSubImage3D:je,compressedTexSubImage2D:_e,compressedTexSubImage3D:Ye,scissor:D,viewport:z,reset:ae}}function oXe(n,e,t,i,r,s,o){const a=r.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(Y,W){return f?new OffscreenCanvas(Y,W):gE("canvas")}function g(Y,W,ge,Le){let Ve=1;if((Y.width>Le||Y.height>Le)&&(Ve=Le/Math.max(Y.width,Y.height)),Ve<1||W===!0)if(typeof HTMLImageElement<"u"&&Y instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Y instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Y instanceof ImageBitmap){const pe=W?pE:Math.floor,fe=pe(Ve*Y.width),Ee=pe(Ve*Y.height);h===void 0&&(h=p(fe,Ee));const oe=ge?p(fe,Ee):h;return oe.width=fe,oe.height=Ee,oe.getContext("2d").drawImage(Y,0,0,fe,Ee),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Y.width+"x"+Y.height+") to ("+fe+"x"+Ee+")."),oe}else return"data"in Y&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Y.width+"x"+Y.height+")."),Y;return Y}function m(Y){return Mk(Y.width)&&Mk(Y.height)}function v(Y){return a?!1:Y.wrapS!==Vl||Y.wrapT!==Vl||Y.minFilter!==go&&Y.minFilter!==Ga}function _(Y,W){return Y.generateMipmaps&&W&&Y.minFilter!==go&&Y.minFilter!==Ga}function y(Y){n.generateMipmap(Y)}function A(Y,W,ge,Le,Ve=!1){if(a===!1)return W;if(Y!==null){if(n[Y]!==void 0)return n[Y];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Y+"'")}let pe=W;if(W===n.RED&&(ge===n.FLOAT&&(pe=n.R32F),ge===n.HALF_FLOAT&&(pe=n.R16F),ge===n.UNSIGNED_BYTE&&(pe=n.R8)),W===n.RED_INTEGER&&(ge===n.UNSIGNED_BYTE&&(pe=n.R8UI),ge===n.UNSIGNED_SHORT&&(pe=n.R16UI),ge===n.UNSIGNED_INT&&(pe=n.R32UI),ge===n.BYTE&&(pe=n.R8I),ge===n.SHORT&&(pe=n.R16I),ge===n.INT&&(pe=n.R32I)),W===n.RG&&(ge===n.FLOAT&&(pe=n.RG32F),ge===n.HALF_FLOAT&&(pe=n.RG16F),ge===n.UNSIGNED_BYTE&&(pe=n.RG8)),W===n.RGBA){const fe=Ve?uE:bi.getTransfer(Le);ge===n.FLOAT&&(pe=n.RGBA32F),ge===n.HALF_FLOAT&&(pe=n.RGBA16F),ge===n.UNSIGNED_BYTE&&(pe=fe===zi?n.SRGB8_ALPHA8:n.RGBA8),ge===n.UNSIGNED_SHORT_4_4_4_4&&(pe=n.RGBA4),ge===n.UNSIGNED_SHORT_5_5_5_1&&(pe=n.RGB5_A1)}return(pe===n.R16F||pe===n.R32F||pe===n.RG16F||pe===n.RG32F||pe===n.RGBA16F||pe===n.RGBA32F)&&e.get("EXT_color_buffer_float"),pe}function w(Y,W,ge){return _(Y,ge)===!0||Y.isFramebufferTexture&&Y.minFilter!==go&&Y.minFilter!==Ga?Math.log2(Math.max(W.width,W.height))+1:Y.mipmaps!==void 0&&Y.mipmaps.length>0?Y.mipmaps.length:Y.isCompressedTexture&&Array.isArray(Y.image)?W.mipmaps.length:1}function b(Y){return Y===go||Y===jV||Y===F1?n.NEAREST:n.LINEAR}function C(Y){const W=Y.target;W.removeEventListener("dispose",C),x(W),W.isVideoTexture&&u.delete(W)}function I(Y){const W=Y.target;W.removeEventListener("dispose",I),O(W)}function x(Y){const W=i.get(Y);if(W.__webglInit===void 0)return;const ge=Y.source,Le=d.get(ge);if(Le){const Ve=Le[W.__cacheKey];Ve.usedTimes--,Ve.usedTimes===0&&T(Y),Object.keys(Le).length===0&&d.delete(ge)}i.remove(Y)}function T(Y){const W=i.get(Y);n.deleteTexture(W.__webglTexture);const ge=Y.source,Le=d.get(ge);delete Le[W.__cacheKey],o.memory.textures--}function O(Y){const W=Y.texture,ge=i.get(Y),Le=i.get(W);if(Le.__webglTexture!==void 0&&(n.deleteTexture(Le.__webglTexture),o.memory.textures--),Y.depthTexture&&Y.depthTexture.dispose(),Y.isWebGLCubeRenderTarget)for(let Ve=0;Ve<6;Ve++){if(Array.isArray(ge.__webglFramebuffer[Ve]))for(let pe=0;pe<ge.__webglFramebuffer[Ve].length;pe++)n.deleteFramebuffer(ge.__webglFramebuffer[Ve][pe]);else n.deleteFramebuffer(ge.__webglFramebuffer[Ve]);ge.__webglDepthbuffer&&n.deleteRenderbuffer(ge.__webglDepthbuffer[Ve])}else{if(Array.isArray(ge.__webglFramebuffer))for(let Ve=0;Ve<ge.__webglFramebuffer.length;Ve++)n.deleteFramebuffer(ge.__webglFramebuffer[Ve]);else n.deleteFramebuffer(ge.__webglFramebuffer);if(ge.__webglDepthbuffer&&n.deleteRenderbuffer(ge.__webglDepthbuffer),ge.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ge.__webglMultisampledFramebuffer),ge.__webglColorRenderbuffer)for(let Ve=0;Ve<ge.__webglColorRenderbuffer.length;Ve++)ge.__webglColorRenderbuffer[Ve]&&n.deleteRenderbuffer(ge.__webglColorRenderbuffer[Ve]);ge.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ge.__webglDepthRenderbuffer)}if(Y.isWebGLMultipleRenderTargets)for(let Ve=0,pe=W.length;Ve<pe;Ve++){const fe=i.get(W[Ve]);fe.__webglTexture&&(n.deleteTexture(fe.__webglTexture),o.memory.textures--),i.remove(W[Ve])}i.remove(W),i.remove(Y)}let F=0;function G(){F=0}function B(){const Y=F;return Y>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Y+" texture units while this GPU supports only "+r.maxTextures),F+=1,Y}function R(Y){const W=[];return W.push(Y.wrapS),W.push(Y.wrapT),W.push(Y.wrapR||0),W.push(Y.magFilter),W.push(Y.minFilter),W.push(Y.anisotropy),W.push(Y.internalFormat),W.push(Y.format),W.push(Y.type),W.push(Y.generateMipmaps),W.push(Y.premultiplyAlpha),W.push(Y.flipY),W.push(Y.unpackAlignment),W.push(Y.colorSpace),W.join()}function P(Y,W){const ge=i.get(Y);if(Y.isVideoTexture&&Re(Y),Y.isRenderTargetTexture===!1&&Y.version>0&&ge.__version!==Y.version){const Le=Y.image;if(Le===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Le.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ve(ge,Y,W);return}}t.bindTexture(n.TEXTURE_2D,ge.__webglTexture,n.TEXTURE0+W)}function k(Y,W){const ge=i.get(Y);if(Y.version>0&&ge.__version!==Y.version){ve(ge,Y,W);return}t.bindTexture(n.TEXTURE_2D_ARRAY,ge.__webglTexture,n.TEXTURE0+W)}function L(Y,W){const ge=i.get(Y);if(Y.version>0&&ge.__version!==Y.version){ve(ge,Y,W);return}t.bindTexture(n.TEXTURE_3D,ge.__webglTexture,n.TEXTURE0+W)}function H(Y,W){const ge=i.get(Y);if(Y.version>0&&ge.__version!==Y.version){Pe(ge,Y,W);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ge.__webglTexture,n.TEXTURE0+W)}const U={[Tk]:n.REPEAT,[Vl]:n.CLAMP_TO_EDGE,[Ik]:n.MIRRORED_REPEAT},$={[go]:n.NEAREST,[jV]:n.NEAREST_MIPMAP_NEAREST,[F1]:n.NEAREST_MIPMAP_LINEAR,[Ga]:n.LINEAR,[S$e]:n.LINEAR_MIPMAP_NEAREST,[VA]:n.LINEAR_MIPMAP_LINEAR},j={[H$e]:n.NEVER,[Q$e]:n.ALWAYS,[V$e]:n.LESS,[LK]:n.LEQUAL,[z$e]:n.EQUAL,[j$e]:n.GEQUAL,[$$e]:n.GREATER,[W$e]:n.NOTEQUAL};function Q(Y,W,ge){if(ge?(n.texParameteri(Y,n.TEXTURE_WRAP_S,U[W.wrapS]),n.texParameteri(Y,n.TEXTURE_WRAP_T,U[W.wrapT]),(Y===n.TEXTURE_3D||Y===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Y,n.TEXTURE_WRAP_R,U[W.wrapR]),n.texParameteri(Y,n.TEXTURE_MAG_FILTER,$[W.magFilter]),n.texParameteri(Y,n.TEXTURE_MIN_FILTER,$[W.minFilter])):(n.texParameteri(Y,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(Y,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(Y===n.TEXTURE_3D||Y===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Y,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(W.wrapS!==Vl||W.wrapT!==Vl)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(Y,n.TEXTURE_MAG_FILTER,b(W.magFilter)),n.texParameteri(Y,n.TEXTURE_MIN_FILTER,b(W.minFilter)),W.minFilter!==go&&W.minFilter!==Ga&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),W.compareFunction&&(n.texParameteri(Y,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Y,n.TEXTURE_COMPARE_FUNC,j[W.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Le=e.get("EXT_texture_filter_anisotropic");if(W.magFilter===go||W.minFilter!==F1&&W.minFilter!==VA||W.type===ud&&e.has("OES_texture_float_linear")===!1||a===!1&&W.type===zA&&e.has("OES_texture_half_float_linear")===!1)return;(W.anisotropy>1||i.get(W).__currentAnisotropy)&&(n.texParameterf(Y,Le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(W.anisotropy,r.getMaxAnisotropy())),i.get(W).__currentAnisotropy=W.anisotropy)}}function ne(Y,W){let ge=!1;Y.__webglInit===void 0&&(Y.__webglInit=!0,W.addEventListener("dispose",C));const Le=W.source;let Ve=d.get(Le);Ve===void 0&&(Ve={},d.set(Le,Ve));const pe=R(W);if(pe!==Y.__cacheKey){Ve[pe]===void 0&&(Ve[pe]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ge=!0),Ve[pe].usedTimes++;const fe=Ve[Y.__cacheKey];fe!==void 0&&(Ve[Y.__cacheKey].usedTimes--,fe.usedTimes===0&&T(W)),Y.__cacheKey=pe,Y.__webglTexture=Ve[pe].texture}return ge}function ve(Y,W,ge){let Le=n.TEXTURE_2D;(W.isDataArrayTexture||W.isCompressedArrayTexture)&&(Le=n.TEXTURE_2D_ARRAY),W.isData3DTexture&&(Le=n.TEXTURE_3D);const Ve=ne(Y,W),pe=W.source;t.bindTexture(Le,Y.__webglTexture,n.TEXTURE0+ge);const fe=i.get(pe);if(pe.version!==fe.__version||Ve===!0){t.activeTexture(n.TEXTURE0+ge);const Ee=bi.getPrimaries(bi.workingColorSpace),oe=W.colorSpace===$a?null:bi.getPrimaries(W.colorSpace),Me=W.colorSpace===$a||Ee===oe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,W.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,W.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Me);const je=v(W)&&m(W.image)===!1;let _e=g(W.image,je,!1,r.maxTextureSize);_e=He(W,_e);const Ye=m(_e)||a,q=s.convert(W.format,W.colorSpace);let we=s.convert(W.type),M=A(W.internalFormat,q,we,W.colorSpace,W.isVideoTexture);Q(Le,W,Ye);let N;const D=W.mipmaps,z=a&&W.isVideoTexture!==!0&&M!==kK,K=fe.__version===void 0||Ve===!0,ce=w(W,_e,Ye);if(W.isDepthTexture)M=n.DEPTH_COMPONENT,a?W.type===ud?M=n.DEPTH_COMPONENT32F:W.type===cd?M=n.DEPTH_COMPONENT24:W.type===Cp?M=n.DEPTH24_STENCIL8:M=n.DEPTH_COMPONENT16:W.type===ud&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),W.format===Ep&&M===n.DEPTH_COMPONENT&&W.type!==oN&&W.type!==cd&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),W.type=cd,we=s.convert(W.type)),W.format===Nv&&M===n.DEPTH_COMPONENT&&(M=n.DEPTH_STENCIL,W.type!==Cp&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),W.type=Cp,we=s.convert(W.type))),K&&(z?t.texStorage2D(n.TEXTURE_2D,1,M,_e.width,_e.height):t.texImage2D(n.TEXTURE_2D,0,M,_e.width,_e.height,0,q,we,null));else if(W.isDataTexture)if(D.length>0&&Ye){z&&K&&t.texStorage2D(n.TEXTURE_2D,ce,M,D[0].width,D[0].height);for(let ae=0,J=D.length;ae<J;ae++)N=D[ae],z?t.texSubImage2D(n.TEXTURE_2D,ae,0,0,N.width,N.height,q,we,N.data):t.texImage2D(n.TEXTURE_2D,ae,M,N.width,N.height,0,q,we,N.data);W.generateMipmaps=!1}else z?(K&&t.texStorage2D(n.TEXTURE_2D,ce,M,_e.width,_e.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,_e.width,_e.height,q,we,_e.data)):t.texImage2D(n.TEXTURE_2D,0,M,_e.width,_e.height,0,q,we,_e.data);else if(W.isCompressedTexture)if(W.isCompressedArrayTexture){z&&K&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ce,M,D[0].width,D[0].height,_e.depth);for(let ae=0,J=D.length;ae<J;ae++)N=D[ae],W.format!==zl?q!==null?z?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ae,0,0,0,N.width,N.height,_e.depth,q,N.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,ae,M,N.width,N.height,_e.depth,0,N.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):z?t.texSubImage3D(n.TEXTURE_2D_ARRAY,ae,0,0,0,N.width,N.height,_e.depth,q,we,N.data):t.texImage3D(n.TEXTURE_2D_ARRAY,ae,M,N.width,N.height,_e.depth,0,q,we,N.data)}else{z&&K&&t.texStorage2D(n.TEXTURE_2D,ce,M,D[0].width,D[0].height);for(let ae=0,J=D.length;ae<J;ae++)N=D[ae],W.format!==zl?q!==null?z?t.compressedTexSubImage2D(n.TEXTURE_2D,ae,0,0,N.width,N.height,q,N.data):t.compressedTexImage2D(n.TEXTURE_2D,ae,M,N.width,N.height,0,N.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):z?t.texSubImage2D(n.TEXTURE_2D,ae,0,0,N.width,N.height,q,we,N.data):t.texImage2D(n.TEXTURE_2D,ae,M,N.width,N.height,0,q,we,N.data)}else if(W.isDataArrayTexture)z?(K&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ce,M,_e.width,_e.height,_e.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,_e.width,_e.height,_e.depth,q,we,_e.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,M,_e.width,_e.height,_e.depth,0,q,we,_e.data);else if(W.isData3DTexture)z?(K&&t.texStorage3D(n.TEXTURE_3D,ce,M,_e.width,_e.height,_e.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,_e.width,_e.height,_e.depth,q,we,_e.data)):t.texImage3D(n.TEXTURE_3D,0,M,_e.width,_e.height,_e.depth,0,q,we,_e.data);else if(W.isFramebufferTexture){if(K)if(z)t.texStorage2D(n.TEXTURE_2D,ce,M,_e.width,_e.height);else{let ae=_e.width,J=_e.height;for(let xe=0;xe<ce;xe++)t.texImage2D(n.TEXTURE_2D,xe,M,ae,J,0,q,we,null),ae>>=1,J>>=1}}else if(D.length>0&&Ye){z&&K&&t.texStorage2D(n.TEXTURE_2D,ce,M,D[0].width,D[0].height);for(let ae=0,J=D.length;ae<J;ae++)N=D[ae],z?t.texSubImage2D(n.TEXTURE_2D,ae,0,0,q,we,N):t.texImage2D(n.TEXTURE_2D,ae,M,q,we,N);W.generateMipmaps=!1}else z?(K&&t.texStorage2D(n.TEXTURE_2D,ce,M,_e.width,_e.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,q,we,_e)):t.texImage2D(n.TEXTURE_2D,0,M,q,we,_e);_(W,Ye)&&y(Le),fe.__version=pe.version,W.onUpdate&&W.onUpdate(W)}Y.__version=W.version}function Pe(Y,W,ge){if(W.image.length!==6)return;const Le=ne(Y,W),Ve=W.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Y.__webglTexture,n.TEXTURE0+ge);const pe=i.get(Ve);if(Ve.version!==pe.__version||Le===!0){t.activeTexture(n.TEXTURE0+ge);const fe=bi.getPrimaries(bi.workingColorSpace),Ee=W.colorSpace===$a?null:bi.getPrimaries(W.colorSpace),oe=W.colorSpace===$a||fe===Ee?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,W.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,W.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,oe);const Me=W.isCompressedTexture||W.image[0].isCompressedTexture,je=W.image[0]&&W.image[0].isDataTexture,_e=[];for(let ae=0;ae<6;ae++)!Me&&!je?_e[ae]=g(W.image[ae],!1,!0,r.maxCubemapSize):_e[ae]=je?W.image[ae].image:W.image[ae],_e[ae]=He(W,_e[ae]);const Ye=_e[0],q=m(Ye)||a,we=s.convert(W.format,W.colorSpace),M=s.convert(W.type),N=A(W.internalFormat,we,M,W.colorSpace),D=a&&W.isVideoTexture!==!0,z=pe.__version===void 0||Le===!0;let K=w(W,Ye,q);Q(n.TEXTURE_CUBE_MAP,W,q);let ce;if(Me){D&&z&&t.texStorage2D(n.TEXTURE_CUBE_MAP,K,N,Ye.width,Ye.height);for(let ae=0;ae<6;ae++){ce=_e[ae].mipmaps;for(let J=0;J<ce.length;J++){const xe=ce[J];W.format!==zl?we!==null?D?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,J,0,0,xe.width,xe.height,we,xe.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,J,N,xe.width,xe.height,0,xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):D?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,J,0,0,xe.width,xe.height,we,M,xe.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,J,N,xe.width,xe.height,0,we,M,xe.data)}}}else{ce=W.mipmaps,D&&z&&(ce.length>0&&K++,t.texStorage2D(n.TEXTURE_CUBE_MAP,K,N,_e[0].width,_e[0].height));for(let ae=0;ae<6;ae++)if(je){D?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0,0,0,_e[ae].width,_e[ae].height,we,M,_e[ae].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0,N,_e[ae].width,_e[ae].height,0,we,M,_e[ae].data);for(let J=0;J<ce.length;J++){const Se=ce[J].image[ae].image;D?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,J+1,0,0,Se.width,Se.height,we,M,Se.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,J+1,N,Se.width,Se.height,0,we,M,Se.data)}}else{D?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0,0,0,we,M,_e[ae]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0,N,we,M,_e[ae]);for(let J=0;J<ce.length;J++){const xe=ce[J];D?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,J+1,0,0,we,M,xe.image[ae]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ae,J+1,N,we,M,xe.image[ae])}}}_(W,q)&&y(n.TEXTURE_CUBE_MAP),pe.__version=Ve.version,W.onUpdate&&W.onUpdate(W)}Y.__version=W.version}function De(Y,W,ge,Le,Ve,pe){const fe=s.convert(ge.format,ge.colorSpace),Ee=s.convert(ge.type),oe=A(ge.internalFormat,fe,Ee,ge.colorSpace);if(!i.get(W).__hasExternalTextures){const je=Math.max(1,W.width>>pe),_e=Math.max(1,W.height>>pe);Ve===n.TEXTURE_3D||Ve===n.TEXTURE_2D_ARRAY?t.texImage3D(Ve,pe,oe,je,_e,W.depth,0,fe,Ee,null):t.texImage2D(Ve,pe,oe,je,_e,0,fe,Ee,null)}t.bindFramebuffer(n.FRAMEBUFFER,Y),se(W)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Le,Ve,i.get(ge).__webglTexture,0,Ce(W)):(Ve===n.TEXTURE_2D||Ve>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Ve<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Le,Ve,i.get(ge).__webglTexture,pe),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Xe(Y,W,ge){if(n.bindRenderbuffer(n.RENDERBUFFER,Y),W.depthBuffer&&!W.stencilBuffer){let Le=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ge||se(W)){const Ve=W.depthTexture;Ve&&Ve.isDepthTexture&&(Ve.type===ud?Le=n.DEPTH_COMPONENT32F:Ve.type===cd&&(Le=n.DEPTH_COMPONENT24));const pe=Ce(W);se(W)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,pe,Le,W.width,W.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,pe,Le,W.width,W.height)}else n.renderbufferStorage(n.RENDERBUFFER,Le,W.width,W.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,Y)}else if(W.depthBuffer&&W.stencilBuffer){const Le=Ce(W);ge&&se(W)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Le,n.DEPTH24_STENCIL8,W.width,W.height):se(W)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Le,n.DEPTH24_STENCIL8,W.width,W.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,W.width,W.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,Y)}else{const Le=W.isWebGLMultipleRenderTargets===!0?W.texture:[W.texture];for(let Ve=0;Ve<Le.length;Ve++){const pe=Le[Ve],fe=s.convert(pe.format,pe.colorSpace),Ee=s.convert(pe.type),oe=A(pe.internalFormat,fe,Ee,pe.colorSpace),Me=Ce(W);ge&&se(W)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Me,oe,W.width,W.height):se(W)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Me,oe,W.width,W.height):n.renderbufferStorage(n.RENDERBUFFER,oe,W.width,W.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Ne(Y,W){if(W&&W.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Y),!(W.depthTexture&&W.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(W.depthTexture).__webglTexture||W.depthTexture.image.width!==W.width||W.depthTexture.image.height!==W.height)&&(W.depthTexture.image.width=W.width,W.depthTexture.image.height=W.height,W.depthTexture.needsUpdate=!0),P(W.depthTexture,0);const Le=i.get(W.depthTexture).__webglTexture,Ve=Ce(W);if(W.depthTexture.format===Ep)se(W)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Le,0,Ve):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Le,0);else if(W.depthTexture.format===Nv)se(W)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Le,0,Ve):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Le,0);else throw new Error("Unknown depthTexture format")}function et(Y){const W=i.get(Y),ge=Y.isWebGLCubeRenderTarget===!0;if(Y.depthTexture&&!W.__autoAllocateDepthBuffer){if(ge)throw new Error("target.depthTexture not supported in Cube render targets");Ne(W.__webglFramebuffer,Y)}else if(ge){W.__webglDepthbuffer=[];for(let Le=0;Le<6;Le++)t.bindFramebuffer(n.FRAMEBUFFER,W.__webglFramebuffer[Le]),W.__webglDepthbuffer[Le]=n.createRenderbuffer(),Xe(W.__webglDepthbuffer[Le],Y,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,W.__webglFramebuffer),W.__webglDepthbuffer=n.createRenderbuffer(),Xe(W.__webglDepthbuffer,Y,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function ze(Y,W,ge){const Le=i.get(Y);W!==void 0&&De(Le.__webglFramebuffer,Y,Y.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ge!==void 0&&et(Y)}function de(Y){const W=Y.texture,ge=i.get(Y),Le=i.get(W);Y.addEventListener("dispose",I),Y.isWebGLMultipleRenderTargets!==!0&&(Le.__webglTexture===void 0&&(Le.__webglTexture=n.createTexture()),Le.__version=W.version,o.memory.textures++);const Ve=Y.isWebGLCubeRenderTarget===!0,pe=Y.isWebGLMultipleRenderTargets===!0,fe=m(Y)||a;if(Ve){ge.__webglFramebuffer=[];for(let Ee=0;Ee<6;Ee++)if(a&&W.mipmaps&&W.mipmaps.length>0){ge.__webglFramebuffer[Ee]=[];for(let oe=0;oe<W.mipmaps.length;oe++)ge.__webglFramebuffer[Ee][oe]=n.createFramebuffer()}else ge.__webglFramebuffer[Ee]=n.createFramebuffer()}else{if(a&&W.mipmaps&&W.mipmaps.length>0){ge.__webglFramebuffer=[];for(let Ee=0;Ee<W.mipmaps.length;Ee++)ge.__webglFramebuffer[Ee]=n.createFramebuffer()}else ge.__webglFramebuffer=n.createFramebuffer();if(pe)if(r.drawBuffers){const Ee=Y.texture;for(let oe=0,Me=Ee.length;oe<Me;oe++){const je=i.get(Ee[oe]);je.__webglTexture===void 0&&(je.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&Y.samples>0&&se(Y)===!1){const Ee=pe?W:[W];ge.__webglMultisampledFramebuffer=n.createFramebuffer(),ge.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ge.__webglMultisampledFramebuffer);for(let oe=0;oe<Ee.length;oe++){const Me=Ee[oe];ge.__webglColorRenderbuffer[oe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ge.__webglColorRenderbuffer[oe]);const je=s.convert(Me.format,Me.colorSpace),_e=s.convert(Me.type),Ye=A(Me.internalFormat,je,_e,Me.colorSpace,Y.isXRRenderTarget===!0),q=Ce(Y);n.renderbufferStorageMultisample(n.RENDERBUFFER,q,Ye,Y.width,Y.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+oe,n.RENDERBUFFER,ge.__webglColorRenderbuffer[oe])}n.bindRenderbuffer(n.RENDERBUFFER,null),Y.depthBuffer&&(ge.__webglDepthRenderbuffer=n.createRenderbuffer(),Xe(ge.__webglDepthRenderbuffer,Y,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Ve){t.bindTexture(n.TEXTURE_CUBE_MAP,Le.__webglTexture),Q(n.TEXTURE_CUBE_MAP,W,fe);for(let Ee=0;Ee<6;Ee++)if(a&&W.mipmaps&&W.mipmaps.length>0)for(let oe=0;oe<W.mipmaps.length;oe++)De(ge.__webglFramebuffer[Ee][oe],Y,W,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,oe);else De(ge.__webglFramebuffer[Ee],Y,W,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0);_(W,fe)&&y(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(pe){const Ee=Y.texture;for(let oe=0,Me=Ee.length;oe<Me;oe++){const je=Ee[oe],_e=i.get(je);t.bindTexture(n.TEXTURE_2D,_e.__webglTexture),Q(n.TEXTURE_2D,je,fe),De(ge.__webglFramebuffer,Y,je,n.COLOR_ATTACHMENT0+oe,n.TEXTURE_2D,0),_(je,fe)&&y(n.TEXTURE_2D)}t.unbindTexture()}else{let Ee=n.TEXTURE_2D;if((Y.isWebGL3DRenderTarget||Y.isWebGLArrayRenderTarget)&&(a?Ee=Y.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ee,Le.__webglTexture),Q(Ee,W,fe),a&&W.mipmaps&&W.mipmaps.length>0)for(let oe=0;oe<W.mipmaps.length;oe++)De(ge.__webglFramebuffer[oe],Y,W,n.COLOR_ATTACHMENT0,Ee,oe);else De(ge.__webglFramebuffer,Y,W,n.COLOR_ATTACHMENT0,Ee,0);_(W,fe)&&y(Ee),t.unbindTexture()}Y.depthBuffer&&et(Y)}function lt(Y){const W=m(Y)||a,ge=Y.isWebGLMultipleRenderTargets===!0?Y.texture:[Y.texture];for(let Le=0,Ve=ge.length;Le<Ve;Le++){const pe=ge[Le];if(_(pe,W)){const fe=Y.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ee=i.get(pe).__webglTexture;t.bindTexture(fe,Ee),y(fe),t.unbindTexture()}}}function he(Y){if(a&&Y.samples>0&&se(Y)===!1){const W=Y.isWebGLMultipleRenderTargets?Y.texture:[Y.texture],ge=Y.width,Le=Y.height;let Ve=n.COLOR_BUFFER_BIT;const pe=[],fe=Y.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ee=i.get(Y),oe=Y.isWebGLMultipleRenderTargets===!0;if(oe)for(let Me=0;Me<W.length;Me++)t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Me,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Me,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ee.__webglFramebuffer);for(let Me=0;Me<W.length;Me++){pe.push(n.COLOR_ATTACHMENT0+Me),Y.depthBuffer&&pe.push(fe);const je=Ee.__ignoreDepthValues!==void 0?Ee.__ignoreDepthValues:!1;if(je===!1&&(Y.depthBuffer&&(Ve|=n.DEPTH_BUFFER_BIT),Y.stencilBuffer&&(Ve|=n.STENCIL_BUFFER_BIT)),oe&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ee.__webglColorRenderbuffer[Me]),je===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[fe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[fe])),oe){const _e=i.get(W[Me]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,_e,0)}n.blitFramebuffer(0,0,ge,Le,0,0,ge,Le,Ve,n.NEAREST),c&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,pe)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),oe)for(let Me=0;Me<W.length;Me++){t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Me,n.RENDERBUFFER,Ee.__webglColorRenderbuffer[Me]);const je=i.get(W[Me]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ee.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Me,n.TEXTURE_2D,je,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ee.__webglMultisampledFramebuffer)}}function Ce(Y){return Math.min(r.maxSamples,Y.samples)}function se(Y){const W=i.get(Y);return a&&Y.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&W.__useRenderToTexture!==!1}function Re(Y){const W=o.render.frame;u.get(Y)!==W&&(u.set(Y,W),Y.update())}function He(Y,W){const ge=Y.colorSpace,Le=Y.format,Ve=Y.type;return Y.isCompressedTexture===!0||Y.isVideoTexture===!0||Y.format===Pk||ge!==oh&&ge!==$a&&(bi.getTransfer(ge)===zi?a===!1?e.has("EXT_sRGB")===!0&&Le===zl?(Y.format=Pk,Y.minFilter=Ga,Y.generateMipmaps=!1):W=BK.sRGBToLinear(W):(Le!==zl||Ve!==Cd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ge)),W}this.allocateTextureUnit=B,this.resetTextureUnits=G,this.setTexture2D=P,this.setTexture2DArray=k,this.setTexture3D=L,this.setTextureCube=H,this.rebindTextures=ze,this.setupRenderTarget=de,this.updateRenderTargetMipmap=lt,this.updateMultisampleRenderTarget=he,this.setupDepthRenderbuffer=et,this.setupFrameBufferTexture=De,this.useMultisampledRTT=se}function aXe(n,e,t){const i=t.isWebGL2;function r(s,o=$a){let a;const l=bi.getTransfer(o);if(s===Cd)return n.UNSIGNED_BYTE;if(s===SK)return n.UNSIGNED_SHORT_4_4_4_4;if(s===PK)return n.UNSIGNED_SHORT_5_5_5_1;if(s===P$e)return n.BYTE;if(s===M$e)return n.SHORT;if(s===oN)return n.UNSIGNED_SHORT;if(s===IK)return n.INT;if(s===cd)return n.UNSIGNED_INT;if(s===ud)return n.FLOAT;if(s===zA)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===R$e)return n.ALPHA;if(s===zl)return n.RGBA;if(s===D$e)return n.LUMINANCE;if(s===k$e)return n.LUMINANCE_ALPHA;if(s===Ep)return n.DEPTH_COMPONENT;if(s===Nv)return n.DEPTH_STENCIL;if(s===Pk)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===O$e)return n.RED;if(s===MK)return n.RED_INTEGER;if(s===L$e)return n.RG;if(s===RK)return n.RG_INTEGER;if(s===DK)return n.RGBA_INTEGER;if(s===U1||s===G1||s===H1||s===V1)if(l===zi)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===U1)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===G1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===H1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===V1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===U1)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===G1)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===H1)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===V1)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===QV||s===XV||s===YV||s===qV)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===QV)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===XV)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===YV)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===qV)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===kK)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===KV||s===JV)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===KV)return l===zi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===JV)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===ZV||s===ez||s===tz||s===nz||s===iz||s===rz||s===sz||s===oz||s===az||s===lz||s===cz||s===uz||s===hz||s===dz)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===ZV)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===ez)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===tz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===nz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===iz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===rz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===sz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===oz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===az)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===lz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===cz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===uz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===hz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===dz)return l===zi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===z1||s===fz||s===pz)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===z1)return l===zi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===fz)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===pz)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===N$e||s===gz||s===mz||s===vz)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===z1)return a.COMPRESSED_RED_RGTC1_EXT;if(s===gz)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===mz)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===vz)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Cp?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class lXe extends Ha{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Jw extends no{constructor(){super(),this.isGroup=!0,this.type="Group"}}const cXe={type:"move"};class dP{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Jw,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Jw,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Oe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Oe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Jw,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Oe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Oe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const g of e.hand.values()){const m=t.getJointPose(g,i),v=this._getHandJoint(c,g);m!==null&&(v.matrix.fromArray(m.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=m.radius),v.visible=m!==null}const u=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],d=u.position.distanceTo(h.position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(cXe)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Jw;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class uXe extends gg{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,h=null,d=null,f=null,p=null;const g=t.getContextAttributes();let m=null,v=null;const _=[],y=[],A=new wn;let w=null;const b=new Ha;b.layers.enable(1),b.viewport=new Sr;const C=new Ha;C.layers.enable(2),C.viewport=new Sr;const I=[b,C],x=new lXe;x.layers.enable(1),x.layers.enable(2);let T=null,O=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Q){let ne=_[Q];return ne===void 0&&(ne=new dP,_[Q]=ne),ne.getTargetRaySpace()},this.getControllerGrip=function(Q){let ne=_[Q];return ne===void 0&&(ne=new dP,_[Q]=ne),ne.getGripSpace()},this.getHand=function(Q){let ne=_[Q];return ne===void 0&&(ne=new dP,_[Q]=ne),ne.getHandSpace()};function F(Q){const ne=y.indexOf(Q.inputSource);if(ne===-1)return;const ve=_[ne];ve!==void 0&&(ve.update(Q.inputSource,Q.frame,c||o),ve.dispatchEvent({type:Q.type,data:Q.inputSource}))}function G(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",G),r.removeEventListener("inputsourceschange",B);for(let Q=0;Q<_.length;Q++){const ne=y[Q];ne!==null&&(y[Q]=null,_[Q].disconnect(ne))}T=null,O=null,e.setRenderTarget(m),f=null,d=null,h=null,r=null,v=null,j.stop(),i.isPresenting=!1,e.setPixelRatio(w),e.setSize(A.width,A.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Q){s=Q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Q){a=Q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(Q){c=Q},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(Q){if(r=Q,r!==null){if(m=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",G),r.addEventListener("inputsourceschange",B),g.xrCompatible!==!0&&await t.makeXRCompatible(),w=e.getPixelRatio(),e.getSize(A),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ne={antialias:r.renderState.layers===void 0?g.antialias:!0,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,t,ne),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),v=new Kp(f.framebufferWidth,f.framebufferHeight,{format:zl,type:Cd,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil})}else{let ne=null,ve=null,Pe=null;g.depth&&(Pe=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ne=g.stencil?Nv:Ep,ve=g.stencil?Cp:cd);const De={colorFormat:t.RGBA8,depthFormat:Pe,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(De),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),v=new Kp(d.textureWidth,d.textureHeight,{format:zl,type:Cd,depthTexture:new qK(d.textureWidth,d.textureHeight,ve,void 0,void 0,void 0,void 0,void 0,void 0,ne),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0});const Xe=e.properties.get(v);Xe.__ignoreDepthValues=d.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),j.setContext(r),j.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function B(Q){for(let ne=0;ne<Q.removed.length;ne++){const ve=Q.removed[ne],Pe=y.indexOf(ve);Pe>=0&&(y[Pe]=null,_[Pe].disconnect(ve))}for(let ne=0;ne<Q.added.length;ne++){const ve=Q.added[ne];let Pe=y.indexOf(ve);if(Pe===-1){for(let Xe=0;Xe<_.length;Xe++)if(Xe>=y.length){y.push(ve),Pe=Xe;break}else if(y[Xe]===null){y[Xe]=ve,Pe=Xe;break}if(Pe===-1)break}const De=_[Pe];De&&De.connect(ve)}}const R=new Oe,P=new Oe;function k(Q,ne,ve){R.setFromMatrixPosition(ne.matrixWorld),P.setFromMatrixPosition(ve.matrixWorld);const Pe=R.distanceTo(P),De=ne.projectionMatrix.elements,Xe=ve.projectionMatrix.elements,Ne=De[14]/(De[10]-1),et=De[14]/(De[10]+1),ze=(De[9]+1)/De[5],de=(De[9]-1)/De[5],lt=(De[8]-1)/De[0],he=(Xe[8]+1)/Xe[0],Ce=Ne*lt,se=Ne*he,Re=Pe/(-lt+he),He=Re*-lt;ne.matrixWorld.decompose(Q.position,Q.quaternion,Q.scale),Q.translateX(He),Q.translateZ(Re),Q.matrixWorld.compose(Q.position,Q.quaternion,Q.scale),Q.matrixWorldInverse.copy(Q.matrixWorld).invert();const Y=Ne+Re,W=et+Re,ge=Ce-He,Le=se+(Pe-He),Ve=ze*et/W*Y,pe=de*et/W*Y;Q.projectionMatrix.makePerspective(ge,Le,Ve,pe,Y,W),Q.projectionMatrixInverse.copy(Q.projectionMatrix).invert()}function L(Q,ne){ne===null?Q.matrixWorld.copy(Q.matrix):Q.matrixWorld.multiplyMatrices(ne.matrixWorld,Q.matrix),Q.matrixWorldInverse.copy(Q.matrixWorld).invert()}this.updateCamera=function(Q){if(r===null)return;x.near=C.near=b.near=Q.near,x.far=C.far=b.far=Q.far,(T!==x.near||O!==x.far)&&(r.updateRenderState({depthNear:x.near,depthFar:x.far}),T=x.near,O=x.far);const ne=Q.parent,ve=x.cameras;L(x,ne);for(let Pe=0;Pe<ve.length;Pe++)L(ve[Pe],ne);ve.length===2?k(x,b,C):x.projectionMatrix.copy(b.projectionMatrix),H(Q,x,ne)};function H(Q,ne,ve){ve===null?Q.matrix.copy(ne.matrixWorld):(Q.matrix.copy(ve.matrixWorld),Q.matrix.invert(),Q.matrix.multiply(ne.matrixWorld)),Q.matrix.decompose(Q.position,Q.quaternion,Q.scale),Q.updateMatrixWorld(!0),Q.projectionMatrix.copy(ne.projectionMatrix),Q.projectionMatrixInverse.copy(ne.projectionMatrixInverse),Q.isPerspectiveCamera&&(Q.fov=$A*2*Math.atan(1/Q.projectionMatrix.elements[5]),Q.zoom=1)}this.getCamera=function(){return x},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(Q){l=Q,d!==null&&(d.fixedFoveation=Q),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=Q)};let U=null;function $(Q,ne){if(u=ne.getViewerPose(c||o),p=ne,u!==null){const ve=u.views;f!==null&&(e.setRenderTargetFramebuffer(v,f.framebuffer),e.setRenderTarget(v));let Pe=!1;ve.length!==x.cameras.length&&(x.cameras.length=0,Pe=!0);for(let De=0;De<ve.length;De++){const Xe=ve[De];let Ne=null;if(f!==null)Ne=f.getViewport(Xe);else{const ze=h.getViewSubImage(d,Xe);Ne=ze.viewport,De===0&&(e.setRenderTargetTextures(v,ze.colorTexture,d.ignoreDepthValues?void 0:ze.depthStencilTexture),e.setRenderTarget(v))}let et=I[De];et===void 0&&(et=new Ha,et.layers.enable(De),et.viewport=new Sr,I[De]=et),et.matrix.fromArray(Xe.transform.matrix),et.matrix.decompose(et.position,et.quaternion,et.scale),et.projectionMatrix.fromArray(Xe.projectionMatrix),et.projectionMatrixInverse.copy(et.projectionMatrix).invert(),et.viewport.set(Ne.x,Ne.y,Ne.width,Ne.height),De===0&&(x.matrix.copy(et.matrix),x.matrix.decompose(x.position,x.quaternion,x.scale)),Pe===!0&&x.cameras.push(et)}}for(let ve=0;ve<_.length;ve++){const Pe=y[ve],De=_[ve];Pe!==null&&De!==void 0&&De.update(Pe,ne,c||o)}U&&U(Q,ne),ne.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ne}),p=null}const j=new YK;j.setAnimationLoop($),this.setAnimationLoop=function(Q){U=Q},this.dispose=function(){}}}function hXe(n,e){function t(m,v){m.matrixAutoUpdate===!0&&m.updateMatrix(),v.value.copy(m.matrix)}function i(m,v){v.color.getRGB(m.fogColor.value,WK(n)),v.isFog?(m.fogNear.value=v.near,m.fogFar.value=v.far):v.isFogExp2&&(m.fogDensity.value=v.density)}function r(m,v,_,y,A){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(m,v):v.isMeshToonMaterial?(s(m,v),h(m,v)):v.isMeshPhongMaterial?(s(m,v),u(m,v)):v.isMeshStandardMaterial?(s(m,v),d(m,v),v.isMeshPhysicalMaterial&&f(m,v,A)):v.isMeshMatcapMaterial?(s(m,v),p(m,v)):v.isMeshDepthMaterial?s(m,v):v.isMeshDistanceMaterial?(s(m,v),g(m,v)):v.isMeshNormalMaterial?s(m,v):v.isLineBasicMaterial?(o(m,v),v.isLineDashedMaterial&&a(m,v)):v.isPointsMaterial?l(m,v,_,y):v.isSpriteMaterial?c(m,v):v.isShadowMaterial?(m.color.value.copy(v.color),m.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(m,v){m.opacity.value=v.opacity,v.color&&m.diffuse.value.copy(v.color),v.emissive&&m.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(m.map.value=v.map,t(v.map,m.mapTransform)),v.alphaMap&&(m.alphaMap.value=v.alphaMap,t(v.alphaMap,m.alphaMapTransform)),v.bumpMap&&(m.bumpMap.value=v.bumpMap,t(v.bumpMap,m.bumpMapTransform),m.bumpScale.value=v.bumpScale,v.side===Vo&&(m.bumpScale.value*=-1)),v.normalMap&&(m.normalMap.value=v.normalMap,t(v.normalMap,m.normalMapTransform),m.normalScale.value.copy(v.normalScale),v.side===Vo&&m.normalScale.value.negate()),v.displacementMap&&(m.displacementMap.value=v.displacementMap,t(v.displacementMap,m.displacementMapTransform),m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias),v.emissiveMap&&(m.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,m.emissiveMapTransform)),v.specularMap&&(m.specularMap.value=v.specularMap,t(v.specularMap,m.specularMapTransform)),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest);const _=e.get(v).envMap;if(_&&(m.envMap.value=_,m.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=v.reflectivity,m.ior.value=v.ior,m.refractionRatio.value=v.refractionRatio),v.lightMap){m.lightMap.value=v.lightMap;const y=n._useLegacyLights===!0?Math.PI:1;m.lightMapIntensity.value=v.lightMapIntensity*y,t(v.lightMap,m.lightMapTransform)}v.aoMap&&(m.aoMap.value=v.aoMap,m.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,m.aoMapTransform))}function o(m,v){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,v.map&&(m.map.value=v.map,t(v.map,m.mapTransform))}function a(m,v){m.dashSize.value=v.dashSize,m.totalSize.value=v.dashSize+v.gapSize,m.scale.value=v.scale}function l(m,v,_,y){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,m.size.value=v.size*_,m.scale.value=y*.5,v.map&&(m.map.value=v.map,t(v.map,m.uvTransform)),v.alphaMap&&(m.alphaMap.value=v.alphaMap,t(v.alphaMap,m.alphaMapTransform)),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest)}function c(m,v){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,m.rotation.value=v.rotation,v.map&&(m.map.value=v.map,t(v.map,m.mapTransform)),v.alphaMap&&(m.alphaMap.value=v.alphaMap,t(v.alphaMap,m.alphaMapTransform)),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest)}function u(m,v){m.specular.value.copy(v.specular),m.shininess.value=Math.max(v.shininess,1e-4)}function h(m,v){v.gradientMap&&(m.gradientMap.value=v.gradientMap)}function d(m,v){m.metalness.value=v.metalness,v.metalnessMap&&(m.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,m.metalnessMapTransform)),m.roughness.value=v.roughness,v.roughnessMap&&(m.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,m.roughnessMapTransform)),e.get(v).envMap&&(m.envMapIntensity.value=v.envMapIntensity)}function f(m,v,_){m.ior.value=v.ior,v.sheen>0&&(m.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),m.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(m.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,m.sheenColorMapTransform)),v.sheenRoughnessMap&&(m.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,m.sheenRoughnessMapTransform))),v.clearcoat>0&&(m.clearcoat.value=v.clearcoat,m.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(m.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,m.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(m.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Vo&&m.clearcoatNormalScale.value.negate())),v.iridescence>0&&(m.iridescence.value=v.iridescence,m.iridescenceIOR.value=v.iridescenceIOR,m.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(m.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,m.iridescenceMapTransform)),v.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),v.transmission>0&&(m.transmission.value=v.transmission,m.transmissionSamplerMap.value=_.texture,m.transmissionSamplerSize.value.set(_.width,_.height),v.transmissionMap&&(m.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,m.transmissionMapTransform)),m.thickness.value=v.thickness,v.thicknessMap&&(m.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=v.attenuationDistance,m.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(m.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(m.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=v.specularIntensity,m.specularColor.value.copy(v.specularColor),v.specularColorMap&&(m.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,m.specularColorMapTransform)),v.specularIntensityMap&&(m.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,m.specularIntensityMapTransform))}function p(m,v){v.matcap&&(m.matcap.value=v.matcap)}function g(m,v){const _=e.get(v).light;m.referencePosition.value.setFromMatrixPosition(_.matrixWorld),m.nearDistance.value=_.shadow.camera.near,m.farDistance.value=_.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function dXe(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(_,y){const A=y.program;i.uniformBlockBinding(_,A)}function c(_,y){let A=r[_.id];A===void 0&&(p(_),A=u(_),r[_.id]=A,_.addEventListener("dispose",m));const w=y.program;i.updateUBOMapping(_,w);const b=e.render.frame;s[_.id]!==b&&(d(_),s[_.id]=b)}function u(_){const y=h();_.__bindingPointIndex=y;const A=n.createBuffer(),w=_.__size,b=_.usage;return n.bindBuffer(n.UNIFORM_BUFFER,A),n.bufferData(n.UNIFORM_BUFFER,w,b),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,y,A),A}function h(){for(let _=0;_<a;_++)if(o.indexOf(_)===-1)return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(_){const y=r[_.id],A=_.uniforms,w=_.__cache;n.bindBuffer(n.UNIFORM_BUFFER,y);for(let b=0,C=A.length;b<C;b++){const I=Array.isArray(A[b])?A[b]:[A[b]];for(let x=0,T=I.length;x<T;x++){const O=I[x];if(f(O,b,x,w)===!0){const F=O.__offset,G=Array.isArray(O.value)?O.value:[O.value];let B=0;for(let R=0;R<G.length;R++){const P=G[R],k=g(P);typeof P=="number"||typeof P=="boolean"?(O.__data[0]=P,n.bufferSubData(n.UNIFORM_BUFFER,F+B,O.__data)):P.isMatrix3?(O.__data[0]=P.elements[0],O.__data[1]=P.elements[1],O.__data[2]=P.elements[2],O.__data[3]=0,O.__data[4]=P.elements[3],O.__data[5]=P.elements[4],O.__data[6]=P.elements[5],O.__data[7]=0,O.__data[8]=P.elements[6],O.__data[9]=P.elements[7],O.__data[10]=P.elements[8],O.__data[11]=0):(P.toArray(O.__data,B),B+=k.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,F,O.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function f(_,y,A,w){const b=_.value,C=y+"_"+A;if(w[C]===void 0)return typeof b=="number"||typeof b=="boolean"?w[C]=b:w[C]=b.clone(),!0;{const I=w[C];if(typeof b=="number"||typeof b=="boolean"){if(I!==b)return w[C]=b,!0}else if(I.equals(b)===!1)return I.copy(b),!0}return!1}function p(_){const y=_.uniforms;let A=0;const w=16;for(let C=0,I=y.length;C<I;C++){const x=Array.isArray(y[C])?y[C]:[y[C]];for(let T=0,O=x.length;T<O;T++){const F=x[T],G=Array.isArray(F.value)?F.value:[F.value];for(let B=0,R=G.length;B<R;B++){const P=G[B],k=g(P),L=A%w;L!==0&&w-L<k.boundary&&(A+=w-L),F.__data=new Float32Array(k.storage/Float32Array.BYTES_PER_ELEMENT),F.__offset=A,A+=k.storage}}}const b=A%w;return b>0&&(A+=w-b),_.__size=A,_.__cache={},this}function g(_){const y={boundary:0,storage:0};return typeof _=="number"||typeof _=="boolean"?(y.boundary=4,y.storage=4):_.isVector2?(y.boundary=8,y.storage=8):_.isVector3||_.isColor?(y.boundary=16,y.storage=12):_.isVector4?(y.boundary=16,y.storage=16):_.isMatrix3?(y.boundary=48,y.storage=48):_.isMatrix4?(y.boundary=64,y.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),y}function m(_){const y=_.target;y.removeEventListener("dispose",m);const A=o.indexOf(y.__bindingPointIndex);o.splice(A,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}function v(){for(const _ in r)n.deleteBuffer(r[_]);o=[],r={},s={}}return{bind:l,update:c,dispose:v}}class nJ{constructor(e={}){const{canvas:t=lWe(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let d;i!==null?d=i.getContextAttributes().alpha:d=o;const f=new Uint32Array(4),p=new Int32Array(4);let g=null,m=null;const v=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Os,this._useLegacyLights=!1,this.toneMapping=xd,this.toneMappingExposure=1;const y=this;let A=!1,w=0,b=0,C=null,I=-1,x=null;const T=new Sr,O=new Sr;let F=null;const G=new $n(0);let B=0,R=t.width,P=t.height,k=1,L=null,H=null;const U=new Sr(0,0,R,P),$=new Sr(0,0,R,P);let j=!1;const Q=new XK;let ne=!1,ve=!1,Pe=null;const De=new mr,Xe=new wn,Ne=new Oe,et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ze(){return C===null?k:1}let de=i;function lt(re,Ge){for(let Ke=0;Ke<re.length;Ke++){const Je=re[Ke],qe=t.getContext(Je,Ge);if(qe!==null)return qe}return null}try{const re={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${sN}`),t.addEventListener("webglcontextlost",ae,!1),t.addEventListener("webglcontextrestored",J,!1),t.addEventListener("webglcontextcreationerror",xe,!1),de===null){const Ge=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&Ge.shift(),de=lt(Ge,re),de===null)throw lt(Ge)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&de instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),de.getShaderPrecisionFormat===void 0&&(de.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(re){throw console.error("THREE.WebGLRenderer: "+re.message),re}let he,Ce,se,Re,He,Y,W,ge,Le,Ve,pe,fe,Ee,oe,Me,je,_e,Ye,q,we,M,N,D,z;function K(){he=new wje(de),Ce=new gje(de,he,e),he.init(Ce),N=new aXe(de,he,Ce),se=new sXe(de,he,Ce),Re=new Eje(de),He=new WQe,Y=new oXe(de,he,se,He,Ce,N,Re),W=new vje(y),ge=new bje(y),Le=new DWe(de,Ce),D=new fje(de,he,Le,Ce),Ve=new xje(de,Le,Re,D),pe=new Pje(de,Ve,Le,Re),q=new Sje(de,Ce,Y),je=new mje(He),fe=new $Qe(y,W,ge,he,Ce,D,je),Ee=new hXe(y,He),oe=new QQe,Me=new ZQe(he,Ce),Ye=new dje(y,W,ge,se,pe,d,l),_e=new rXe(y,pe,Ce),z=new dXe(de,Re,Ce,se),we=new pje(de,he,Re,Ce),M=new Cje(de,he,Re,Ce),Re.programs=fe.programs,y.capabilities=Ce,y.extensions=he,y.properties=He,y.renderLists=oe,y.shadowMap=_e,y.state=se,y.info=Re}K();const ce=new uXe(y,de);this.xr=ce,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){const re=he.get("WEBGL_lose_context");re&&re.loseContext()},this.forceContextRestore=function(){const re=he.get("WEBGL_lose_context");re&&re.restoreContext()},this.getPixelRatio=function(){return k},this.setPixelRatio=function(re){re!==void 0&&(k=re,this.setSize(R,P,!1))},this.getSize=function(re){return re.set(R,P)},this.setSize=function(re,Ge,Ke=!0){if(ce.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}R=re,P=Ge,t.width=Math.floor(re*k),t.height=Math.floor(Ge*k),Ke===!0&&(t.style.width=re+"px",t.style.height=Ge+"px"),this.setViewport(0,0,re,Ge)},this.getDrawingBufferSize=function(re){return re.set(R*k,P*k).floor()},this.setDrawingBufferSize=function(re,Ge,Ke){R=re,P=Ge,k=Ke,t.width=Math.floor(re*Ke),t.height=Math.floor(Ge*Ke),this.setViewport(0,0,re,Ge)},this.getCurrentViewport=function(re){return re.copy(T)},this.getViewport=function(re){return re.copy(U)},this.setViewport=function(re,Ge,Ke,Je){re.isVector4?U.set(re.x,re.y,re.z,re.w):U.set(re,Ge,Ke,Je),se.viewport(T.copy(U).multiplyScalar(k).floor())},this.getScissor=function(re){return re.copy($)},this.setScissor=function(re,Ge,Ke,Je){re.isVector4?$.set(re.x,re.y,re.z,re.w):$.set(re,Ge,Ke,Je),se.scissor(O.copy($).multiplyScalar(k).floor())},this.getScissorTest=function(){return j},this.setScissorTest=function(re){se.setScissorTest(j=re)},this.setOpaqueSort=function(re){L=re},this.setTransparentSort=function(re){H=re},this.getClearColor=function(re){return re.copy(Ye.getClearColor())},this.setClearColor=function(){Ye.setClearColor.apply(Ye,arguments)},this.getClearAlpha=function(){return Ye.getClearAlpha()},this.setClearAlpha=function(){Ye.setClearAlpha.apply(Ye,arguments)},this.clear=function(re=!0,Ge=!0,Ke=!0){let Je=0;if(re){let qe=!1;if(C!==null){const Et=C.texture.format;qe=Et===DK||Et===RK||Et===MK}if(qe){const Et=C.texture.type,Bt=Et===Cd||Et===cd||Et===oN||Et===Cp||Et===SK||Et===PK,Nt=Ye.getClearColor(),Qt=Ye.getClearAlpha(),en=Nt.r,on=Nt.g,sn=Nt.b;Bt?(f[0]=en,f[1]=on,f[2]=sn,f[3]=Qt,de.clearBufferuiv(de.COLOR,0,f)):(p[0]=en,p[1]=on,p[2]=sn,p[3]=Qt,de.clearBufferiv(de.COLOR,0,p))}else Je|=de.COLOR_BUFFER_BIT}Ge&&(Je|=de.DEPTH_BUFFER_BIT),Ke&&(Je|=de.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),de.clear(Je)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ae,!1),t.removeEventListener("webglcontextrestored",J,!1),t.removeEventListener("webglcontextcreationerror",xe,!1),oe.dispose(),Me.dispose(),He.dispose(),W.dispose(),ge.dispose(),pe.dispose(),D.dispose(),z.dispose(),fe.dispose(),ce.dispose(),ce.removeEventListener("sessionstart",Ct),ce.removeEventListener("sessionend",vn),Pe&&(Pe.dispose(),Pe=null),ti.stop()};function ae(re){re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),A=!0}function J(){console.log("THREE.WebGLRenderer: Context Restored."),A=!1;const re=Re.autoReset,Ge=_e.enabled,Ke=_e.autoUpdate,Je=_e.needsUpdate,qe=_e.type;K(),Re.autoReset=re,_e.enabled=Ge,_e.autoUpdate=Ke,_e.needsUpdate=Je,_e.type=qe}function xe(re){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",re.statusMessage)}function Se(re){const Ge=re.target;Ge.removeEventListener("dispose",Se),rt(Ge)}function rt(re){ot(re),He.remove(re)}function ot(re){const Ge=He.get(re).programs;Ge!==void 0&&(Ge.forEach(function(Ke){fe.releaseProgram(Ke)}),re.isShaderMaterial&&fe.releaseShaderCache(re))}this.renderBufferDirect=function(re,Ge,Ke,Je,qe,Et){Ge===null&&(Ge=et);const Bt=qe.isMesh&&qe.matrixWorld.determinant()<0,Nt=Ti(re,Ge,Ke,Je,qe);se.setMaterial(Je,Bt);let Qt=Ke.index,en=1;if(Je.wireframe===!0){if(Qt=Ve.getWireframeAttribute(Ke),Qt===void 0)return;en=2}const on=Ke.drawRange,sn=Ke.attributes.position;let qn=on.start*en,Hr=(on.start+on.count)*en;Et!==null&&(qn=Math.max(qn,Et.start*en),Hr=Math.min(Hr,(Et.start+Et.count)*en)),Qt!==null?(qn=Math.max(qn,0),Hr=Math.min(Hr,Qt.count)):sn!=null&&(qn=Math.max(qn,0),Hr=Math.min(Hr,sn.count));const ci=Hr-qn;if(ci<0||ci===1/0)return;D.setup(qe,Je,Nt,Ke,Qt);let Vr,Li=we;if(Qt!==null&&(Vr=Le.get(Qt),Li=M,Li.setIndex(Vr)),qe.isMesh)Je.wireframe===!0?(se.setLineWidth(Je.wireframeLinewidth*ze()),Li.setMode(de.LINES)):Li.setMode(de.TRIANGLES);else if(qe.isLine){let Cn=Je.linewidth;Cn===void 0&&(Cn=1),se.setLineWidth(Cn*ze()),qe.isLineSegments?Li.setMode(de.LINES):qe.isLineLoop?Li.setMode(de.LINE_LOOP):Li.setMode(de.LINE_STRIP)}else qe.isPoints?Li.setMode(de.POINTS):qe.isSprite&&Li.setMode(de.TRIANGLES);if(qe.isBatchedMesh)Li.renderMultiDraw(qe._multiDrawStarts,qe._multiDrawCounts,qe._multiDrawCount);else if(qe.isInstancedMesh)Li.renderInstances(qn,ci,qe.count);else if(Ke.isInstancedBufferGeometry){const Cn=Ke._maxInstanceCount!==void 0?Ke._maxInstanceCount:1/0,_h=Math.min(Ke.instanceCount,Cn);Li.renderInstances(qn,ci,_h)}else Li.render(qn,ci)};function gt(re,Ge,Ke){re.transparent===!0&&re.side===Bu&&re.forceSinglePass===!1?(re.side=Vo,re.needsUpdate=!0,li(re,Ge,Ke),re.side=Od,re.needsUpdate=!0,li(re,Ge,Ke),re.side=Bu):li(re,Ge,Ke)}this.compile=function(re,Ge,Ke=null){Ke===null&&(Ke=re),m=Me.get(Ke),m.init(),_.push(m),Ke.traverseVisible(function(qe){qe.isLight&&qe.layers.test(Ge.layers)&&(m.pushLight(qe),qe.castShadow&&m.pushShadow(qe))}),re!==Ke&&re.traverseVisible(function(qe){qe.isLight&&qe.layers.test(Ge.layers)&&(m.pushLight(qe),qe.castShadow&&m.pushShadow(qe))}),m.setupLights(y._useLegacyLights);const Je=new Set;return re.traverse(function(qe){const Et=qe.material;if(Et)if(Array.isArray(Et))for(let Bt=0;Bt<Et.length;Bt++){const Nt=Et[Bt];gt(Nt,Ke,qe),Je.add(Nt)}else gt(Et,Ke,qe),Je.add(Et)}),_.pop(),m=null,Je},this.compileAsync=function(re,Ge,Ke=null){const Je=this.compile(re,Ge,Ke);return new Promise(qe=>{function Et(){if(Je.forEach(function(Bt){He.get(Bt).currentProgram.isReady()&&Je.delete(Bt)}),Je.size===0){qe(re);return}setTimeout(Et,10)}he.get("KHR_parallel_shader_compile")!==null?Et():setTimeout(Et,10)})};let ut=null;function ct(re){ut&&ut(re)}function Ct(){ti.stop()}function vn(){ti.start()}const ti=new YK;ti.setAnimationLoop(ct),typeof self<"u"&&ti.setContext(self),this.setAnimationLoop=function(re){ut=re,ce.setAnimationLoop(re),re===null?ti.stop():ti.start()},ce.addEventListener("sessionstart",Ct),ce.addEventListener("sessionend",vn),this.render=function(re,Ge){if(Ge!==void 0&&Ge.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(A===!0)return;re.matrixWorldAutoUpdate===!0&&re.updateMatrixWorld(),Ge.parent===null&&Ge.matrixWorldAutoUpdate===!0&&Ge.updateMatrixWorld(),ce.enabled===!0&&ce.isPresenting===!0&&(ce.cameraAutoUpdate===!0&&ce.updateCamera(Ge),Ge=ce.getCamera()),re.isScene===!0&&re.onBeforeRender(y,re,Ge,C),m=Me.get(re,_.length),m.init(),_.push(m),De.multiplyMatrices(Ge.projectionMatrix,Ge.matrixWorldInverse),Q.setFromProjectionMatrix(De),ve=this.localClippingEnabled,ne=je.init(this.clippingPlanes,ve),g=oe.get(re,v.length),g.init(),v.push(g),fr(re,Ge,0,y.sortObjects),g.finish(),y.sortObjects===!0&&g.sort(L,H),this.info.render.frame++,ne===!0&&je.beginShadows();const Ke=m.state.shadowsArray;if(_e.render(Ke,re,Ge),ne===!0&&je.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ye.render(g,re),m.setupLights(y._useLegacyLights),Ge.isArrayCamera){const Je=Ge.cameras;for(let qe=0,Et=Je.length;qe<Et;qe++){const Bt=Je[qe];Ao(g,re,Bt,Bt.viewport)}}else Ao(g,re,Ge);C!==null&&(Y.updateMultisampleRenderTarget(C),Y.updateRenderTargetMipmap(C)),re.isScene===!0&&re.onAfterRender(y,re,Ge),D.resetDefaultState(),I=-1,x=null,_.pop(),_.length>0?m=_[_.length-1]:m=null,v.pop(),v.length>0?g=v[v.length-1]:g=null};function fr(re,Ge,Ke,Je){if(re.visible===!1)return;if(re.layers.test(Ge.layers)){if(re.isGroup)Ke=re.renderOrder;else if(re.isLOD)re.autoUpdate===!0&&re.update(Ge);else if(re.isLight)m.pushLight(re),re.castShadow&&m.pushShadow(re);else if(re.isSprite){if(!re.frustumCulled||Q.intersectsSprite(re)){Je&&Ne.setFromMatrixPosition(re.matrixWorld).applyMatrix4(De);const Bt=pe.update(re),Nt=re.material;Nt.visible&&g.push(re,Bt,Nt,Ke,Ne.z,null)}}else if((re.isMesh||re.isLine||re.isPoints)&&(!re.frustumCulled||Q.intersectsObject(re))){const Bt=pe.update(re),Nt=re.material;if(Je&&(re.boundingSphere!==void 0?(re.boundingSphere===null&&re.computeBoundingSphere(),Ne.copy(re.boundingSphere.center)):(Bt.boundingSphere===null&&Bt.computeBoundingSphere(),Ne.copy(Bt.boundingSphere.center)),Ne.applyMatrix4(re.matrixWorld).applyMatrix4(De)),Array.isArray(Nt)){const Qt=Bt.groups;for(let en=0,on=Qt.length;en<on;en++){const sn=Qt[en],qn=Nt[sn.materialIndex];qn&&qn.visible&&g.push(re,Bt,qn,Ke,Ne.z,sn)}}else Nt.visible&&g.push(re,Bt,Nt,Ke,Ne.z,null)}}const Et=re.children;for(let Bt=0,Nt=Et.length;Bt<Nt;Bt++)fr(Et[Bt],Ge,Ke,Je)}function Ao(re,Ge,Ke,Je){const qe=re.opaque,Et=re.transmissive,Bt=re.transparent;m.setupLightsView(Ke),ne===!0&&je.setGlobalState(y.clippingPlanes,Ke),Et.length>0&&_r(qe,Et,Ge,Ke),Je&&se.viewport(T.copy(Je)),qe.length>0&&ni(qe,Ge,Ke),Et.length>0&&ni(Et,Ge,Ke),Bt.length>0&&ni(Bt,Ge,Ke),se.buffers.depth.setTest(!0),se.buffers.depth.setMask(!0),se.buffers.color.setMask(!0),se.setPolygonOffset(!1)}function _r(re,Ge,Ke,Je){if((Ke.isScene===!0?Ke.overrideMaterial:null)!==null)return;const Et=Ce.isWebGL2;Pe===null&&(Pe=new Kp(1,1,{generateMipmaps:!0,type:he.has("EXT_color_buffer_half_float")?zA:Cd,minFilter:VA,samples:Et?4:0})),y.getDrawingBufferSize(Xe),Et?Pe.setSize(Xe.x,Xe.y):Pe.setSize(pE(Xe.x),pE(Xe.y));const Bt=y.getRenderTarget();y.setRenderTarget(Pe),y.getClearColor(G),B=y.getClearAlpha(),B<1&&y.setClearColor(16777215,.5),y.clear();const Nt=y.toneMapping;y.toneMapping=xd,ni(re,Ke,Je),Y.updateMultisampleRenderTarget(Pe),Y.updateRenderTargetMipmap(Pe);let Qt=!1;for(let en=0,on=Ge.length;en<on;en++){const sn=Ge[en],qn=sn.object,Hr=sn.geometry,ci=sn.material,Vr=sn.group;if(ci.side===Bu&&qn.layers.test(Je.layers)){const Li=ci.side;ci.side=Vo,ci.needsUpdate=!0,mi(qn,Ke,Je,Hr,ci,Vr),ci.side=Li,ci.needsUpdate=!0,Qt=!0}}Qt===!0&&(Y.updateMultisampleRenderTarget(Pe),Y.updateRenderTargetMipmap(Pe)),y.setRenderTarget(Bt),y.setClearColor(G,B),y.toneMapping=Nt}function ni(re,Ge,Ke){const Je=Ge.isScene===!0?Ge.overrideMaterial:null;for(let qe=0,Et=re.length;qe<Et;qe++){const Bt=re[qe],Nt=Bt.object,Qt=Bt.geometry,en=Je===null?Bt.material:Je,on=Bt.group;Nt.layers.test(Ke.layers)&&mi(Nt,Ge,Ke,Qt,en,on)}}function mi(re,Ge,Ke,Je,qe,Et){re.onBeforeRender(y,Ge,Ke,Je,qe,Et),re.modelViewMatrix.multiplyMatrices(Ke.matrixWorldInverse,re.matrixWorld),re.normalMatrix.getNormalMatrix(re.modelViewMatrix),qe.onBeforeRender(y,Ge,Ke,Je,re,Et),qe.transparent===!0&&qe.side===Bu&&qe.forceSinglePass===!1?(qe.side=Vo,qe.needsUpdate=!0,y.renderBufferDirect(Ke,Ge,Je,qe,re,Et),qe.side=Od,qe.needsUpdate=!0,y.renderBufferDirect(Ke,Ge,Je,qe,re,Et),qe.side=Bu):y.renderBufferDirect(Ke,Ge,Je,qe,re,Et),re.onAfterRender(y,Ge,Ke,Je,qe,Et)}function li(re,Ge,Ke){Ge.isScene!==!0&&(Ge=et);const Je=He.get(re),qe=m.state.lights,Et=m.state.shadowsArray,Bt=qe.state.version,Nt=fe.getParameters(re,qe.state,Et,Ge,Ke),Qt=fe.getProgramCacheKey(Nt);let en=Je.programs;Je.environment=re.isMeshStandardMaterial?Ge.environment:null,Je.fog=Ge.fog,Je.envMap=(re.isMeshStandardMaterial?ge:W).get(re.envMap||Je.environment),en===void 0&&(re.addEventListener("dispose",Se),en=new Map,Je.programs=en);let on=en.get(Qt);if(on!==void 0){if(Je.currentProgram===on&&Je.lightsStateVersion===Bt)return Ei(re,Nt),on}else Nt.uniforms=fe.getUniforms(re),re.onBuild(Ke,Nt,y),re.onBeforeCompile(Nt,y),on=fe.acquireProgram(Nt,Qt),en.set(Qt,on),Je.uniforms=Nt.uniforms;const sn=Je.uniforms;return(!re.isShaderMaterial&&!re.isRawShaderMaterial||re.clipping===!0)&&(sn.clippingPlanes=je.uniform),Ei(re,Nt),Je.needsLights=Zo(re),Je.lightsStateVersion=Bt,Je.needsLights&&(sn.ambientLightColor.value=qe.state.ambient,sn.lightProbe.value=qe.state.probe,sn.directionalLights.value=qe.state.directional,sn.directionalLightShadows.value=qe.state.directionalShadow,sn.spotLights.value=qe.state.spot,sn.spotLightShadows.value=qe.state.spotShadow,sn.rectAreaLights.value=qe.state.rectArea,sn.ltc_1.value=qe.state.rectAreaLTC1,sn.ltc_2.value=qe.state.rectAreaLTC2,sn.pointLights.value=qe.state.point,sn.pointLightShadows.value=qe.state.pointShadow,sn.hemisphereLights.value=qe.state.hemi,sn.directionalShadowMap.value=qe.state.directionalShadowMap,sn.directionalShadowMatrix.value=qe.state.directionalShadowMatrix,sn.spotShadowMap.value=qe.state.spotShadowMap,sn.spotLightMatrix.value=qe.state.spotLightMatrix,sn.spotLightMap.value=qe.state.spotLightMap,sn.pointShadowMap.value=qe.state.pointShadowMap,sn.pointShadowMatrix.value=qe.state.pointShadowMatrix),Je.currentProgram=on,Je.uniformsList=null,on}function Mr(re){if(re.uniformsList===null){const Ge=re.currentProgram.getUniforms();re.uniformsList=Kx.seqWithValue(Ge.seq,re.uniforms)}return re.uniformsList}function Ei(re,Ge){const Ke=He.get(re);Ke.outputColorSpace=Ge.outputColorSpace,Ke.batching=Ge.batching,Ke.instancing=Ge.instancing,Ke.instancingColor=Ge.instancingColor,Ke.skinning=Ge.skinning,Ke.morphTargets=Ge.morphTargets,Ke.morphNormals=Ge.morphNormals,Ke.morphColors=Ge.morphColors,Ke.morphTargetsCount=Ge.morphTargetsCount,Ke.numClippingPlanes=Ge.numClippingPlanes,Ke.numIntersection=Ge.numClipIntersection,Ke.vertexAlphas=Ge.vertexAlphas,Ke.vertexTangents=Ge.vertexTangents,Ke.toneMapping=Ge.toneMapping}function Ti(re,Ge,Ke,Je,qe){Ge.isScene!==!0&&(Ge=et),Y.resetTextureUnits();const Et=Ge.fog,Bt=Je.isMeshStandardMaterial?Ge.environment:null,Nt=C===null?y.outputColorSpace:C.isXRRenderTarget===!0?C.texture.colorSpace:oh,Qt=(Je.isMeshStandardMaterial?ge:W).get(Je.envMap||Bt),en=Je.vertexColors===!0&&!!Ke.attributes.color&&Ke.attributes.color.itemSize===4,on=!!Ke.attributes.tangent&&(!!Je.normalMap||Je.anisotropy>0),sn=!!Ke.morphAttributes.position,qn=!!Ke.morphAttributes.normal,Hr=!!Ke.morphAttributes.color;let ci=xd;Je.toneMapped&&(C===null||C.isXRRenderTarget===!0)&&(ci=y.toneMapping);const Vr=Ke.morphAttributes.position||Ke.morphAttributes.normal||Ke.morphAttributes.color,Li=Vr!==void 0?Vr.length:0,Cn=He.get(Je),_h=m.state.lights;if(ne===!0&&(ve===!0||re!==x)){const bo=re===x&&Je.id===I;je.setState(Je,re,bo)}let Vn=!1;Je.version===Cn.__version?(Cn.needsLights&&Cn.lightsStateVersion!==_h.state.version||Cn.outputColorSpace!==Nt||qe.isBatchedMesh&&Cn.batching===!1||!qe.isBatchedMesh&&Cn.batching===!0||qe.isInstancedMesh&&Cn.instancing===!1||!qe.isInstancedMesh&&Cn.instancing===!0||qe.isSkinnedMesh&&Cn.skinning===!1||!qe.isSkinnedMesh&&Cn.skinning===!0||qe.isInstancedMesh&&Cn.instancingColor===!0&&qe.instanceColor===null||qe.isInstancedMesh&&Cn.instancingColor===!1&&qe.instanceColor!==null||Cn.envMap!==Qt||Je.fog===!0&&Cn.fog!==Et||Cn.numClippingPlanes!==void 0&&(Cn.numClippingPlanes!==je.numPlanes||Cn.numIntersection!==je.numIntersection)||Cn.vertexAlphas!==en||Cn.vertexTangents!==on||Cn.morphTargets!==sn||Cn.morphNormals!==qn||Cn.morphColors!==Hr||Cn.toneMapping!==ci||Ce.isWebGL2===!0&&Cn.morphTargetsCount!==Li)&&(Vn=!0):(Vn=!0,Cn.__version=Je.version);let xa=Cn.currentProgram;Vn===!0&&(xa=li(Je,Ge,qe));let wg=!1,Kc=!1,zd=!1;const Rr=xa.getUniforms(),Ca=Cn.uniforms;if(se.useProgram(xa.program)&&(wg=!0,Kc=!0,zd=!0),Je.id!==I&&(I=Je.id,Kc=!0),wg||x!==re){Rr.setValue(de,"projectionMatrix",re.projectionMatrix),Rr.setValue(de,"viewMatrix",re.matrixWorldInverse);const bo=Rr.map.cameraPosition;bo!==void 0&&bo.setValue(de,Ne.setFromMatrixPosition(re.matrixWorld)),Ce.logarithmicDepthBuffer&&Rr.setValue(de,"logDepthBufFC",2/(Math.log(re.far+1)/Math.LN2)),(Je.isMeshPhongMaterial||Je.isMeshToonMaterial||Je.isMeshLambertMaterial||Je.isMeshBasicMaterial||Je.isMeshStandardMaterial||Je.isShaderMaterial)&&Rr.setValue(de,"isOrthographic",re.isOrthographicCamera===!0),x!==re&&(x=re,Kc=!0,zd=!0)}if(qe.isSkinnedMesh){Rr.setOptional(de,qe,"bindMatrix"),Rr.setOptional(de,qe,"bindMatrixInverse");const bo=qe.skeleton;bo&&(Ce.floatVertexTextures?(bo.boneTexture===null&&bo.computeBoneTexture(),Rr.setValue(de,"boneTexture",bo.boneTexture,Y)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}qe.isBatchedMesh&&(Rr.setOptional(de,qe,"batchingTexture"),Rr.setValue(de,"batchingTexture",qe._matricesTexture,Y));const ea=Ke.morphAttributes;if((ea.position!==void 0||ea.normal!==void 0||ea.color!==void 0&&Ce.isWebGL2===!0)&&q.update(qe,Ke,xa),(Kc||Cn.receiveShadow!==qe.receiveShadow)&&(Cn.receiveShadow=qe.receiveShadow,Rr.setValue(de,"receiveShadow",qe.receiveShadow)),Je.isMeshGouraudMaterial&&Je.envMap!==null&&(Ca.envMap.value=Qt,Ca.flipEnvMap.value=Qt.isCubeTexture&&Qt.isRenderTargetTexture===!1?-1:1),Kc&&(Rr.setValue(de,"toneMappingExposure",y.toneMappingExposure),Cn.needsLights&&so(Ca,zd),Et&&Je.fog===!0&&Ee.refreshFogUniforms(Ca,Et),Ee.refreshMaterialUniforms(Ca,Je,k,P,Pe),Kx.upload(de,Mr(Cn),Ca,Y)),Je.isShaderMaterial&&Je.uniformsNeedUpdate===!0&&(Kx.upload(de,Mr(Cn),Ca,Y),Je.uniformsNeedUpdate=!1),Je.isSpriteMaterial&&Rr.setValue(de,"center",qe.center),Rr.setValue(de,"modelViewMatrix",qe.modelViewMatrix),Rr.setValue(de,"normalMatrix",qe.normalMatrix),Rr.setValue(de,"modelMatrix",qe.matrixWorld),Je.isShaderMaterial||Je.isRawShaderMaterial){const bo=Je.uniformsGroups;for(let xg=0,b_=bo.length;xg<b_;xg++)if(Ce.isWebGL2){const w_=bo[xg];z.update(w_,xa),z.bind(w_,xa)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return xa}function so(re,Ge){re.ambientLightColor.needsUpdate=Ge,re.lightProbe.needsUpdate=Ge,re.directionalLights.needsUpdate=Ge,re.directionalLightShadows.needsUpdate=Ge,re.pointLights.needsUpdate=Ge,re.pointLightShadows.needsUpdate=Ge,re.spotLights.needsUpdate=Ge,re.spotLightShadows.needsUpdate=Ge,re.rectAreaLights.needsUpdate=Ge,re.hemisphereLights.needsUpdate=Ge}function Zo(re){return re.isMeshLambertMaterial||re.isMeshToonMaterial||re.isMeshPhongMaterial||re.isMeshStandardMaterial||re.isShadowMaterial||re.isShaderMaterial&&re.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return C},this.setRenderTargetTextures=function(re,Ge,Ke){He.get(re.texture).__webglTexture=Ge,He.get(re.depthTexture).__webglTexture=Ke;const Je=He.get(re);Je.__hasExternalTextures=!0,Je.__hasExternalTextures&&(Je.__autoAllocateDepthBuffer=Ke===void 0,Je.__autoAllocateDepthBuffer||he.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Je.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(re,Ge){const Ke=He.get(re);Ke.__webglFramebuffer=Ge,Ke.__useDefaultFramebuffer=Ge===void 0},this.setRenderTarget=function(re,Ge=0,Ke=0){C=re,w=Ge,b=Ke;let Je=!0,qe=null,Et=!1,Bt=!1;if(re){const Qt=He.get(re);Qt.__useDefaultFramebuffer!==void 0?(se.bindFramebuffer(de.FRAMEBUFFER,null),Je=!1):Qt.__webglFramebuffer===void 0?Y.setupRenderTarget(re):Qt.__hasExternalTextures&&Y.rebindTextures(re,He.get(re.texture).__webglTexture,He.get(re.depthTexture).__webglTexture);const en=re.texture;(en.isData3DTexture||en.isDataArrayTexture||en.isCompressedArrayTexture)&&(Bt=!0);const on=He.get(re).__webglFramebuffer;re.isWebGLCubeRenderTarget?(Array.isArray(on[Ge])?qe=on[Ge][Ke]:qe=on[Ge],Et=!0):Ce.isWebGL2&&re.samples>0&&Y.useMultisampledRTT(re)===!1?qe=He.get(re).__webglMultisampledFramebuffer:Array.isArray(on)?qe=on[Ke]:qe=on,T.copy(re.viewport),O.copy(re.scissor),F=re.scissorTest}else T.copy(U).multiplyScalar(k).floor(),O.copy($).multiplyScalar(k).floor(),F=j;if(se.bindFramebuffer(de.FRAMEBUFFER,qe)&&Ce.drawBuffers&&Je&&se.drawBuffers(re,qe),se.viewport(T),se.scissor(O),se.setScissorTest(F),Et){const Qt=He.get(re.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Qt.__webglTexture,Ke)}else if(Bt){const Qt=He.get(re.texture),en=Ge||0;de.framebufferTextureLayer(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,Qt.__webglTexture,Ke||0,en)}I=-1},this.readRenderTargetPixels=function(re,Ge,Ke,Je,qe,Et,Bt){if(!(re&&re.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Nt=He.get(re).__webglFramebuffer;if(re.isWebGLCubeRenderTarget&&Bt!==void 0&&(Nt=Nt[Bt]),Nt){se.bindFramebuffer(de.FRAMEBUFFER,Nt);try{const Qt=re.texture,en=Qt.format,on=Qt.type;if(en!==zl&&N.convert(en)!==de.getParameter(de.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const sn=on===zA&&(he.has("EXT_color_buffer_half_float")||Ce.isWebGL2&&he.has("EXT_color_buffer_float"));if(on!==Cd&&N.convert(on)!==de.getParameter(de.IMPLEMENTATION_COLOR_READ_TYPE)&&!(on===ud&&(Ce.isWebGL2||he.has("OES_texture_float")||he.has("WEBGL_color_buffer_float")))&&!sn){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ge>=0&&Ge<=re.width-Je&&Ke>=0&&Ke<=re.height-qe&&de.readPixels(Ge,Ke,Je,qe,N.convert(en),N.convert(on),Et)}finally{const Qt=C!==null?He.get(C).__webglFramebuffer:null;se.bindFramebuffer(de.FRAMEBUFFER,Qt)}}},this.copyFramebufferToTexture=function(re,Ge,Ke=0){const Je=Math.pow(2,-Ke),qe=Math.floor(Ge.image.width*Je),Et=Math.floor(Ge.image.height*Je);Y.setTexture2D(Ge,0),de.copyTexSubImage2D(de.TEXTURE_2D,Ke,0,0,re.x,re.y,qe,Et),se.unbindTexture()},this.copyTextureToTexture=function(re,Ge,Ke,Je=0){const qe=Ge.image.width,Et=Ge.image.height,Bt=N.convert(Ke.format),Nt=N.convert(Ke.type);Y.setTexture2D(Ke,0),de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,Ke.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ke.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,Ke.unpackAlignment),Ge.isDataTexture?de.texSubImage2D(de.TEXTURE_2D,Je,re.x,re.y,qe,Et,Bt,Nt,Ge.image.data):Ge.isCompressedTexture?de.compressedTexSubImage2D(de.TEXTURE_2D,Je,re.x,re.y,Ge.mipmaps[0].width,Ge.mipmaps[0].height,Bt,Ge.mipmaps[0].data):de.texSubImage2D(de.TEXTURE_2D,Je,re.x,re.y,Bt,Nt,Ge.image),Je===0&&Ke.generateMipmaps&&de.generateMipmap(de.TEXTURE_2D),se.unbindTexture()},this.copyTextureToTexture3D=function(re,Ge,Ke,Je,qe=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Et=re.max.x-re.min.x+1,Bt=re.max.y-re.min.y+1,Nt=re.max.z-re.min.z+1,Qt=N.convert(Je.format),en=N.convert(Je.type);let on;if(Je.isData3DTexture)Y.setTexture3D(Je,0),on=de.TEXTURE_3D;else if(Je.isDataArrayTexture||Je.isCompressedArrayTexture)Y.setTexture2DArray(Je,0),on=de.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,Je.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Je.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,Je.unpackAlignment);const sn=de.getParameter(de.UNPACK_ROW_LENGTH),qn=de.getParameter(de.UNPACK_IMAGE_HEIGHT),Hr=de.getParameter(de.UNPACK_SKIP_PIXELS),ci=de.getParameter(de.UNPACK_SKIP_ROWS),Vr=de.getParameter(de.UNPACK_SKIP_IMAGES),Li=Ke.isCompressedTexture?Ke.mipmaps[qe]:Ke.image;de.pixelStorei(de.UNPACK_ROW_LENGTH,Li.width),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,Li.height),de.pixelStorei(de.UNPACK_SKIP_PIXELS,re.min.x),de.pixelStorei(de.UNPACK_SKIP_ROWS,re.min.y),de.pixelStorei(de.UNPACK_SKIP_IMAGES,re.min.z),Ke.isDataTexture||Ke.isData3DTexture?de.texSubImage3D(on,qe,Ge.x,Ge.y,Ge.z,Et,Bt,Nt,Qt,en,Li.data):Ke.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),de.compressedTexSubImage3D(on,qe,Ge.x,Ge.y,Ge.z,Et,Bt,Nt,Qt,Li.data)):de.texSubImage3D(on,qe,Ge.x,Ge.y,Ge.z,Et,Bt,Nt,Qt,en,Li),de.pixelStorei(de.UNPACK_ROW_LENGTH,sn),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,qn),de.pixelStorei(de.UNPACK_SKIP_PIXELS,Hr),de.pixelStorei(de.UNPACK_SKIP_ROWS,ci),de.pixelStorei(de.UNPACK_SKIP_IMAGES,Vr),qe===0&&Je.generateMipmaps&&de.generateMipmap(on),se.unbindTexture()},this.initTexture=function(re){re.isCubeTexture?Y.setTextureCube(re,0):re.isData3DTexture?Y.setTexture3D(re,0):re.isDataArrayTexture||re.isCompressedArrayTexture?Y.setTexture2DArray(re,0):Y.setTexture2D(re,0),se.unbindTexture()},this.resetState=function(){w=0,b=0,C=null,se.reset(),D.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return zu}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===aN?"display-p3":"srgb",t.unpackColorSpace=bi.workingColorSpace===MI?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Os?Tp:OK}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Tp?Os:oh}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class fXe extends nJ{}fXe.prototype.isWebGL1Renderer=!0;class pXe extends no{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class gXe{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Sk,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Ju()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ju()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ju()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ao=new Oe;class Oo{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ao.fromBufferAttribute(this,t),ao.applyMatrix4(e),this.setXYZ(t,ao.x,ao.y,ao.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ao.fromBufferAttribute(this,t),ao.applyNormalMatrix(e),this.setXYZ(t,ao.x,ao.y,ao.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ao.fromBufferAttribute(this,t),ao.transformDirection(e),this.setXYZ(t,ao.x,ao.y,ao.z);return this}setX(e,t){return this.normalized&&(t=Ai(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Sc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Sc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Sc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Sc(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ai(t,this.array),i=Ai(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ai(t,this.array),i=Ai(i,this.array),r=Ai(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ai(t,this.array),i=Ai(i,this.array),r=Ai(r,this.array),s=Ai(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Jl(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Oo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class iJ extends p_{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new $n(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const s5=new Oe,o5=new Oe,a5=new mr,fP=new RI,Zw=new mg;class rJ extends no{constructor(e=new wa,t=new iJ){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)s5.fromBufferAttribute(t,r-1),o5.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=s5.distanceTo(o5);e.setAttribute("lineDistance",new gs(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Zw.copy(i.boundingSphere),Zw.applyMatrix4(r),Zw.radius+=s,e.ray.intersectsSphere(Zw)===!1)return;a5.copy(r).invert(),fP.copy(e.ray).applyMatrix4(a5);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new Oe,u=new Oe,h=new Oe,d=new Oe,f=this.isLineSegments?2:1,p=i.index,m=i.attributes.position;if(p!==null){const v=Math.max(0,o.start),_=Math.min(p.count,o.start+o.count);for(let y=v,A=_-1;y<A;y+=f){const w=p.getX(y),b=p.getX(y+1);if(c.fromBufferAttribute(m,w),u.fromBufferAttribute(m,b),fP.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(d);I<e.near||I>e.far||t.push({distance:I,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),_=Math.min(m.count,o.start+o.count);for(let y=v,A=_-1;y<A;y+=f){if(c.fromBufferAttribute(m,y),u.fromBufferAttribute(m,y+1),fP.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(d);b<e.near||b>e.far||t.push({distance:b,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const l5=new Oe,c5=new Oe;class mXe extends rJ{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)l5.fromBufferAttribute(t,r),c5.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+l5.distanceTo(c5);e.setAttribute("lineDistance",new gs(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class vXe extends p_{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new $n(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const u5=new mr,Dk=new RI,ex=new mg,tx=new Oe;class _Xe extends no{constructor(e=new wa,t=new vXe){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),ex.copy(i.boundingSphere),ex.applyMatrix4(r),ex.radius+=s,e.ray.intersectsSphere(ex)===!1)return;u5.copy(r).invert(),Dk.copy(e.ray).applyMatrix4(u5);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,h=i.attributes.position;if(c!==null){const d=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=d,g=f;p<g;p++){const m=c.getX(p);tx.fromBufferAttribute(h,m),h5(tx,m,l,r,e,t,this)}}else{const d=Math.max(0,o.start),f=Math.min(h.count,o.start+o.count);for(let p=d,g=f;p<g;p++)tx.fromBufferAttribute(h,p),h5(tx,p,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function h5(n,e,t,i,r,s,o){const a=Dk.distanceSqToPoint(n);if(a<t){const l=new Oe;Dk.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class yXe extends wa{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new Oe,s=new Oe;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const h=l[c],d=h.start,f=h.count;for(let p=d,g=d+f;p<g;p+=3)for(let m=0;m<3;m++){const v=a.getX(p+m),_=a.getX(p+(m+1)%3);r.fromBufferAttribute(o,v),s.fromBufferAttribute(o,_),d5(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,h=3*a+(c+1)%3;r.fromBufferAttribute(o,u),s.fromBufferAttribute(o,h),d5(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new gs(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function d5(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}class AXe extends wa{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Bm extends gXe{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class f5{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Bs(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const p5=new Oe,nx=new Oe;class bXe{constructor(e=new Oe,t=new Oe){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){p5.subVectors(e,this.start),nx.subVectors(this.end,this.start);const i=nx.dot(nx);let s=nx.dot(p5)/i;return t&&(s=Bs(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class wXe extends mXe{constructor(e=10,t=10,i=4473924,r=8947848){i=new $n(i),r=new $n(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=t;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const g=d===s?i:r;g.toArray(c,f),f+=3,g.toArray(c,f),f+=3,g.toArray(c,f),f+=3,g.toArray(c,f),f+=3}const u=new wa;u.setAttribute("position",new gs(l,3)),u.setAttribute("color",new gs(c,3));const h=new iJ({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:sN}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=sN);const g5={type:"change"},pP={type:"start"},m5={type:"end"},ix=new RI,v5=new Hh,xXe=Math.cos(70*cN.DEG2RAD);class CXe extends gg{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Oe,this.cursor=new Oe,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:xu.ROTATE,MIDDLE:xu.DOLLY,RIGHT:xu.PAN},this.touches={ONE:Gh.ROTATE,TWO:Gh.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(q){q.addEventListener("keydown",pe),this._domElementKeyEvents=q},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",pe),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(g5),i.update(),s=r.NONE},this.update=function(){const q=new Oe,we=new Jp().setFromUnitVectors(e.up,new Oe(0,1,0)),M=we.clone().invert(),N=new Oe,D=new Jp,z=new Oe,K=2*Math.PI;return function(ae=null){const J=i.object.position;q.copy(J).sub(i.target),q.applyQuaternion(we),a.setFromVector3(q),i.autoRotate&&s===r.NONE&&O(x(ae)),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let xe=i.minAzimuthAngle,Se=i.maxAzimuthAngle;isFinite(xe)&&isFinite(Se)&&(xe<-Math.PI?xe+=K:xe>Math.PI&&(xe-=K),Se<-Math.PI?Se+=K:Se>Math.PI&&(Se-=K),xe<=Se?a.theta=Math.max(xe,Math.min(Se,a.theta)):a.theta=a.theta>(xe+Se)/2?Math.max(xe,a.theta):Math.min(Se,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor),i.zoomToCursor&&b||i.object.isOrthographicCamera?a.radius=H(a.radius):a.radius=H(a.radius*c),q.setFromSpherical(a),q.applyQuaternion(M),J.copy(i.target).add(q),i.object.lookAt(i.target),i.enableDamping===!0?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0));let rt=!1;if(i.zoomToCursor&&b){let ot=null;if(i.object.isPerspectiveCamera){const gt=q.length();ot=H(gt*c);const ut=gt-ot;i.object.position.addScaledVector(A,ut),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const gt=new Oe(w.x,w.y,0);gt.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),rt=!0;const ut=new Oe(w.x,w.y,0);ut.unproject(i.object),i.object.position.sub(ut).add(gt),i.object.updateMatrixWorld(),ot=q.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;ot!==null&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(ot).add(i.object.position):(ix.origin.copy(i.object.position),ix.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(ix.direction))<xXe?e.lookAt(i.target):(v5.setFromNormalAndCoplanarPoint(i.object.up,i.target),ix.intersectPlane(v5,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),rt=!0);return c=1,b=!1,rt||N.distanceToSquared(i.object.position)>o||8*(1-D.dot(i.object.quaternion))>o||z.distanceToSquared(i.target)>0?(i.dispatchEvent(g5),N.copy(i.object.position),D.copy(i.object.quaternion),z.copy(i.target),!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",oe),i.domElement.removeEventListener("pointerdown",He),i.domElement.removeEventListener("pointercancel",W),i.domElement.removeEventListener("wheel",Ve),i.domElement.removeEventListener("pointermove",Y),i.domElement.removeEventListener("pointerup",W),i._domElementKeyEvents!==null&&(i._domElementKeyEvents.removeEventListener("keydown",pe),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new f5,l=new f5;let c=1;const u=new Oe,h=new wn,d=new wn,f=new wn,p=new wn,g=new wn,m=new wn,v=new wn,_=new wn,y=new wn,A=new Oe,w=new wn;let b=!1;const C=[],I={};function x(q){return q!==null?2*Math.PI/60*i.autoRotateSpeed*q:2*Math.PI/60/60*i.autoRotateSpeed}function T(q){const we=Math.abs(q)/(100*(window.devicePixelRatio|0));return Math.pow(.95,i.zoomSpeed*we)}function O(q){l.theta-=q}function F(q){l.phi-=q}const G=function(){const q=new Oe;return function(M,N){q.setFromMatrixColumn(N,0),q.multiplyScalar(-M),u.add(q)}}(),B=function(){const q=new Oe;return function(M,N){i.screenSpacePanning===!0?q.setFromMatrixColumn(N,1):(q.setFromMatrixColumn(N,0),q.crossVectors(i.object.up,q)),q.multiplyScalar(M),u.add(q)}}(),R=function(){const q=new Oe;return function(M,N){const D=i.domElement;if(i.object.isPerspectiveCamera){const z=i.object.position;q.copy(z).sub(i.target);let K=q.length();K*=Math.tan(i.object.fov/2*Math.PI/180),G(2*M*K/D.clientHeight,i.object.matrix),B(2*N*K/D.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(G(M*(i.object.right-i.object.left)/i.object.zoom/D.clientWidth,i.object.matrix),B(N*(i.object.top-i.object.bottom)/i.object.zoom/D.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function P(q){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c/=q:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function k(q){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c*=q:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function L(q,we){if(!i.zoomToCursor)return;b=!0;const M=i.domElement.getBoundingClientRect(),N=q-M.left,D=we-M.top,z=M.width,K=M.height;w.x=N/z*2-1,w.y=-(D/K)*2+1,A.set(w.x,w.y,1).unproject(i.object).sub(i.object.position).normalize()}function H(q){return Math.max(i.minDistance,Math.min(i.maxDistance,q))}function U(q){h.set(q.clientX,q.clientY)}function $(q){L(q.clientX,q.clientX),v.set(q.clientX,q.clientY)}function j(q){p.set(q.clientX,q.clientY)}function Q(q){d.set(q.clientX,q.clientY),f.subVectors(d,h).multiplyScalar(i.rotateSpeed);const we=i.domElement;O(2*Math.PI*f.x/we.clientHeight),F(2*Math.PI*f.y/we.clientHeight),h.copy(d),i.update()}function ne(q){_.set(q.clientX,q.clientY),y.subVectors(_,v),y.y>0?P(T(y.y)):y.y<0&&k(T(y.y)),v.copy(_),i.update()}function ve(q){g.set(q.clientX,q.clientY),m.subVectors(g,p).multiplyScalar(i.panSpeed),R(m.x,m.y),p.copy(g),i.update()}function Pe(q){L(q.clientX,q.clientY),q.deltaY<0?k(T(q.deltaY)):q.deltaY>0&&P(T(q.deltaY)),i.update()}function De(q){let we=!1;switch(q.code){case i.keys.UP:q.ctrlKey||q.metaKey||q.shiftKey?F(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):R(0,i.keyPanSpeed),we=!0;break;case i.keys.BOTTOM:q.ctrlKey||q.metaKey||q.shiftKey?F(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):R(0,-i.keyPanSpeed),we=!0;break;case i.keys.LEFT:q.ctrlKey||q.metaKey||q.shiftKey?O(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):R(i.keyPanSpeed,0),we=!0;break;case i.keys.RIGHT:q.ctrlKey||q.metaKey||q.shiftKey?O(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):R(-i.keyPanSpeed,0),we=!0;break}we&&(q.preventDefault(),i.update())}function Xe(q){if(C.length===1)h.set(q.pageX,q.pageY);else{const we=Ye(q),M=.5*(q.pageX+we.x),N=.5*(q.pageY+we.y);h.set(M,N)}}function Ne(q){if(C.length===1)p.set(q.pageX,q.pageY);else{const we=Ye(q),M=.5*(q.pageX+we.x),N=.5*(q.pageY+we.y);p.set(M,N)}}function et(q){const we=Ye(q),M=q.pageX-we.x,N=q.pageY-we.y,D=Math.sqrt(M*M+N*N);v.set(0,D)}function ze(q){i.enableZoom&&et(q),i.enablePan&&Ne(q)}function de(q){i.enableZoom&&et(q),i.enableRotate&&Xe(q)}function lt(q){if(C.length==1)d.set(q.pageX,q.pageY);else{const M=Ye(q),N=.5*(q.pageX+M.x),D=.5*(q.pageY+M.y);d.set(N,D)}f.subVectors(d,h).multiplyScalar(i.rotateSpeed);const we=i.domElement;O(2*Math.PI*f.x/we.clientHeight),F(2*Math.PI*f.y/we.clientHeight),h.copy(d)}function he(q){if(C.length===1)g.set(q.pageX,q.pageY);else{const we=Ye(q),M=.5*(q.pageX+we.x),N=.5*(q.pageY+we.y);g.set(M,N)}m.subVectors(g,p).multiplyScalar(i.panSpeed),R(m.x,m.y),p.copy(g)}function Ce(q){const we=Ye(q),M=q.pageX-we.x,N=q.pageY-we.y,D=Math.sqrt(M*M+N*N);_.set(0,D),y.set(0,Math.pow(_.y/v.y,i.zoomSpeed)),P(y.y),v.copy(_);const z=(q.pageX+we.x)*.5,K=(q.pageY+we.y)*.5;L(z,K)}function se(q){i.enableZoom&&Ce(q),i.enablePan&&he(q)}function Re(q){i.enableZoom&&Ce(q),i.enableRotate&&lt(q)}function He(q){i.enabled!==!1&&(C.length===0&&(i.domElement.setPointerCapture(q.pointerId),i.domElement.addEventListener("pointermove",Y),i.domElement.addEventListener("pointerup",W)),Me(q),q.pointerType==="touch"?fe(q):ge(q))}function Y(q){i.enabled!==!1&&(q.pointerType==="touch"?Ee(q):Le(q))}function W(q){je(q),C.length===0&&(i.domElement.releasePointerCapture(q.pointerId),i.domElement.removeEventListener("pointermove",Y),i.domElement.removeEventListener("pointerup",W)),i.dispatchEvent(m5),s=r.NONE}function ge(q){let we;switch(q.button){case 0:we=i.mouseButtons.LEFT;break;case 1:we=i.mouseButtons.MIDDLE;break;case 2:we=i.mouseButtons.RIGHT;break;default:we=-1}switch(we){case xu.DOLLY:if(i.enableZoom===!1)return;$(q),s=r.DOLLY;break;case xu.ROTATE:if(q.ctrlKey||q.metaKey||q.shiftKey){if(i.enablePan===!1)return;j(q),s=r.PAN}else{if(i.enableRotate===!1)return;U(q),s=r.ROTATE}break;case xu.PAN:if(q.ctrlKey||q.metaKey||q.shiftKey){if(i.enableRotate===!1)return;U(q),s=r.ROTATE}else{if(i.enablePan===!1)return;j(q),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(pP)}function Le(q){switch(s){case r.ROTATE:if(i.enableRotate===!1)return;Q(q);break;case r.DOLLY:if(i.enableZoom===!1)return;ne(q);break;case r.PAN:if(i.enablePan===!1)return;ve(q);break}}function Ve(q){i.enabled===!1||i.enableZoom===!1||s!==r.NONE||(q.preventDefault(),i.dispatchEvent(pP),Pe(q),i.dispatchEvent(m5))}function pe(q){i.enabled===!1||i.enablePan===!1||De(q)}function fe(q){switch(_e(q),C.length){case 1:switch(i.touches.ONE){case Gh.ROTATE:if(i.enableRotate===!1)return;Xe(q),s=r.TOUCH_ROTATE;break;case Gh.PAN:if(i.enablePan===!1)return;Ne(q),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case Gh.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;ze(q),s=r.TOUCH_DOLLY_PAN;break;case Gh.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;de(q),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(pP)}function Ee(q){switch(_e(q),s){case r.TOUCH_ROTATE:if(i.enableRotate===!1)return;lt(q),i.update();break;case r.TOUCH_PAN:if(i.enablePan===!1)return;he(q),i.update();break;case r.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;se(q),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Re(q),i.update();break;default:s=r.NONE}}function oe(q){i.enabled!==!1&&q.preventDefault()}function Me(q){C.push(q.pointerId)}function je(q){delete I[q.pointerId];for(let we=0;we<C.length;we++)if(C[we]==q.pointerId){C.splice(we,1);return}}function _e(q){let we=I[q.pointerId];we===void 0&&(we=new wn,I[q.pointerId]=we),we.set(q.pageX,q.pageY)}function Ye(q){const we=q.pointerId===C[0]?C[1]:C[0];return I[we]}i.domElement.addEventListener("contextmenu",oe),i.domElement.addEventListener("pointerdown",He),i.domElement.addEventListener("pointercancel",W),i.domElement.addEventListener("wheel",Ve,{passive:!1}),this.update()}}const _5=new vh,rx=new Oe;class sJ extends AXe{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i),this.setAttribute("position",new gs(e,3)),this.setAttribute("uv",new gs(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),i.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new Bm(t,6,1);return this.setAttribute("instanceStart",new Oo(i,3,0)),this.setAttribute("instanceEnd",new Oo(i,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new Bm(t,6,1);return this.setAttribute("instanceColorStart",new Oo(i,3,0)),this.setAttribute("instanceColorEnd",new Oo(i,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new yXe(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vh);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),_5.setFromBufferAttribute(t),this.boundingBox.union(_5))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new mg),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)rx.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(rx)),rx.fromBufferAttribute(t,s),r=Math.max(r,i.distanceToSquared(rx));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}_t.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new wn(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};ds.line={uniforms:vb.merge([_t.common,_t.fog,_t.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class oJ extends tc{constructor(e){super({type:"LineMaterial",uniforms:vb.clone(ds.line.uniforms),vertexShader:ds.line.vertexShader,fragmentShader:ds.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1))}}const y5=new Oe,A5=new Oe,ws=new Sr,xs=new Sr,hc=new Sr,gP=new Oe,mP=new mr,Rs=new bXe,b5=new Oe,sx=new vh,ox=new mg,dc=new Sr;let Pc,Ip;function w5(n,e,t){return dc.set(0,0,-e,1).applyMatrix4(n.projectionMatrix),dc.multiplyScalar(1/dc.w),dc.x=Ip/t.width,dc.y=Ip/t.height,dc.applyMatrix4(n.projectionMatrixInverse),dc.multiplyScalar(1/dc.w),Math.abs(Math.max(dc.x,dc.y))}function EXe(n,e){const t=n.matrixWorld,i=n.geometry,r=i.attributes.instanceStart,s=i.attributes.instanceEnd,o=Math.min(i.instanceCount,r.count);for(let a=0,l=o;a<l;a++){Rs.start.fromBufferAttribute(r,a),Rs.end.fromBufferAttribute(s,a),Rs.applyMatrix4(t);const c=new Oe,u=new Oe;Pc.distanceSqToSegment(Rs.start,Rs.end,u,c),u.distanceTo(c)<Ip*.5&&e.push({point:u,pointOnLine:c,distance:Pc.origin.distanceTo(u),object:n,face:null,faceIndex:a,uv:null,uv1:null})}}function TXe(n,e,t){const i=e.projectionMatrix,s=n.material.resolution,o=n.matrixWorld,a=n.geometry,l=a.attributes.instanceStart,c=a.attributes.instanceEnd,u=Math.min(a.instanceCount,l.count),h=-e.near;Pc.at(1,hc),hc.w=1,hc.applyMatrix4(e.matrixWorldInverse),hc.applyMatrix4(i),hc.multiplyScalar(1/hc.w),hc.x*=s.x/2,hc.y*=s.y/2,hc.z=0,gP.copy(hc),mP.multiplyMatrices(e.matrixWorldInverse,o);for(let d=0,f=u;d<f;d++){if(ws.fromBufferAttribute(l,d),xs.fromBufferAttribute(c,d),ws.w=1,xs.w=1,ws.applyMatrix4(mP),xs.applyMatrix4(mP),ws.z>h&&xs.z>h)continue;if(ws.z>h){const y=ws.z-xs.z,A=(ws.z-h)/y;ws.lerp(xs,A)}else if(xs.z>h){const y=xs.z-ws.z,A=(xs.z-h)/y;xs.lerp(ws,A)}ws.applyMatrix4(i),xs.applyMatrix4(i),ws.multiplyScalar(1/ws.w),xs.multiplyScalar(1/xs.w),ws.x*=s.x/2,ws.y*=s.y/2,xs.x*=s.x/2,xs.y*=s.y/2,Rs.start.copy(ws),Rs.start.z=0,Rs.end.copy(xs),Rs.end.z=0;const g=Rs.closestPointToPointParameter(gP,!0);Rs.at(g,b5);const m=cN.lerp(ws.z,xs.z,g),v=m>=-1&&m<=1,_=gP.distanceTo(b5)<Ip*.5;if(v&&_){Rs.start.fromBufferAttribute(l,d),Rs.end.fromBufferAttribute(c,d),Rs.start.applyMatrix4(o),Rs.end.applyMatrix4(o);const y=new Oe,A=new Oe;Pc.distanceSqToSegment(Rs.start,Rs.end,A,y),t.push({point:A,pointOnLine:y,distance:Pc.origin.distanceTo(A),object:n,face:null,faceIndex:d,uv:null,uv1:null})}}}class IXe extends $u{constructor(e=new sJ,t=new oJ({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,i=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)y5.fromBufferAttribute(t,o),A5.fromBufferAttribute(i,o),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+y5.distanceTo(A5);const s=new Bm(r,2,1);return e.setAttribute("instanceDistanceStart",new Oo(s,1,0)),e.setAttribute("instanceDistanceEnd",new Oo(s,1,1)),this}raycast(e,t){const i=this.material.worldUnits,r=e.camera;r===null&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Pc=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;Ip=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),ox.copy(a.boundingSphere).applyMatrix4(o);let c;if(i)c=Ip*.5;else{const h=Math.max(r.near,ox.distanceToPoint(Pc.origin));c=w5(r,h,l.resolution)}if(ox.radius+=c,Pc.intersectsSphere(ox)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),sx.copy(a.boundingBox).applyMatrix4(o);let u;if(i)u=Ip*.5;else{const h=Math.max(r.near,sx.distanceToPoint(Pc.origin));u=w5(r,h,l.resolution)}sx.expandByScalar(u),Pc.intersectsBox(sx)!==!1&&(i?EXe(this,t):TXe(this,r,t))}}class aJ extends sJ{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setPositions(i),this}setColors(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setColors(i),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class SXe extends IXe{constructor(e=new aJ,t=new oJ({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}class Ept extends no{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new wn(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const tm=new Oe,x5=new mr,C5=new mr,E5=new Oe,T5=new Oe;class PXe{constructor(e={}){const t=this;let i,r,s,o;const a={objects:new WeakMap},l=e.element!==void 0?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:i,height:r}},this.render=function(f,p){f.matrixWorldAutoUpdate===!0&&f.updateMatrixWorld(),p.parent===null&&p.matrixWorldAutoUpdate===!0&&p.updateMatrixWorld(),x5.copy(p.matrixWorldInverse),C5.multiplyMatrices(p.projectionMatrix,x5),c(f,f,p),d(f)},this.setSize=function(f,p){i=f,r=p,s=i/2,o=r/2,l.style.width=f+"px",l.style.height=p+"px"};function c(f,p,g){if(f.isCSS2DObject){tm.setFromMatrixPosition(f.matrixWorld),tm.applyMatrix4(C5);const m=f.visible===!0&&tm.z>=-1&&tm.z<=1&&f.layers.test(g.layers)===!0;if(f.element.style.display=m===!0?"":"none",m===!0){f.onBeforeRender(t,p,g);const _=f.element;_.style.transform="translate("+-100*f.center.x+"%,"+-100*f.center.y+"%)translate("+(tm.x*s+s)+"px,"+(-tm.y*o+o)+"px)",_.parentNode!==l&&l.appendChild(_),f.onAfterRender(t,p,g)}const v={distanceToCameraSquared:u(g,f)};a.objects.set(f,v)}for(let m=0,v=f.children.length;m<v;m++)c(f.children[m],p,g)}function u(f,p){return E5.setFromMatrixPosition(f.matrixWorld),T5.setFromMatrixPosition(p.matrixWorld),E5.distanceToSquared(T5)}function h(f){const p=[];return f.traverse(function(g){g.isCSS2DObject&&p.push(g)}),p}function d(f){const p=h(f).sort(function(m,v){if(m.renderOrder!==v.renderOrder)return v.renderOrder-m.renderOrder;const _=a.objects.get(m).distanceToCameraSquared,y=a.objects.get(v).distanceToCameraSquared;return _-y}),g=p.length;for(let m=0,v=p.length;m<v;m++)p[m].element.style.zIndex=g-m}}}const Tpt=16711680,Ipt=2,Spt=1,I5=16777215,Ppt=16777215,MXe=45,RXe=.1,DXe=200,zo={showRedLine:!0,maxDistance:300,clipDistance:0,attributeKeys:{distance:"aCustomDistance",distanceForLine2:"aCustomDistance2"}};var kk=(n=>(n[n.LINE=0]="LINE",n[n.POINT=1]="POINT",n[n.BITMAP=2]="BITMAP",n[n.LINE2=3]="LINE2",n))(kk||{});const{distance:S5,distanceForLine2:P5}=zo.attributeKeys;_t.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new wn(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1},showRedLine:{value:!0},clipDistance:{value:0}};ds.line={uniforms:vb.merge([_t.common,_t.fog,_t.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

        attribute float power;
        attribute float gcmd;
        attribute float ${S5};
        attribute float ${P5};
        uniform bool showRedLine;
        varying float vCustomDistance;
        varying vec4 vCustomColor;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif
		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif
            float opacity = (gcmd == 1. && power == 0.) ? 0. : (gcmd == 0. ? .3 : 1.);
            if(gcmd == 1. || gcmd == 25.) {
              float r, g, b;
              // POWER 大于 1000 时，表示 POWER 的值为 RGB 的 HEX 值，
              // HEX 值会默认会加上 1001
              if(power > 1000.0) {
                float colorHex = power - 1001.0;
				if (isinf(colorHex)) {
					colorHex = 1000.0;
				}
                r = floor(colorHex / 65536.0) / 255.0;
                g = floor(mod(colorHex, 65536.0) / 256.0) / 255.0;
                b = mod(colorHex, 256.0) / 255.0;
              } else {
                float modifiedPower = clamp(power, 0.0, 1000.0);
                r = g = b = floor((1. - modifiedPower / 1000.0) * 255.0) / 255.0;
              }
            //   vCustomColor = vec4(r, g, b, opacity);
			   vCustomColor = vec4(r, g, b, opacity);
            } else {
				vCustomColor = showRedLine ? vec4(1., 0., 0., opacity) : vec4(0.0, 0.0, 0.0, 0.0);
            }
            vCustomDistance = ( position.y < 0.5 ) ? ${S5} : ${P5};
			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

        varying vec4 vCustomColor;
        varying float vCustomDistance;
        uniform float clipDistance;
		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

            if(vCustomDistance <= clipDistance && vCustomColor.a > 0.0) {
                gl_FragColor = vCustomColor;
				// gl_FragColor = vec4( diffuseColor.rgb, alpha );
            } else {
				discard;
            }

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class kXe extends tc{constructor(e){super({type:"LineMaterial",uniforms:vb.clone(ds.line.uniforms),vertexShader:ds.line.vertexShader,fragmentShader:ds.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1))}}const OXe=`precision highp float;
varying vec4 vColor;
varying float vDistance;
uniform float clipDistance;
void main() {
  if(vDistance < clipDistance) {
    gl_FragColor = vColor;
  } else {
    discard;
  }
}
`,LXe=`attribute float power;
attribute float gcmd;
attribute float aCustomDistance;
uniform bool showRedLine;
uniform float maxDistance;
varying vec4 vColor;
varying float vDistance;
void main() {
  float opacity = (gcmd == 1. && power == 0.) ? 0. : (gcmd == 0. ? .3 : 1.);
  if(gcmd == 1. || gcmd == 25.) {
    float r, g, b;
    // POWER 大于 1000 时，表示 POWER 的值为 RGB 的 HEX 值，
    // HEX 值会默认会加上 1001
    if(power > 1000.) {
      float colorHex = power - 1001.;
      r = floor(colorHex / 65536.) / 255.;
      g = floor(mod(colorHex, 65536.) / 256.) / 255.;
      b = mod(colorHex, 256.) / 255.;
    } else {
      float modifiedPower = clamp(power, 0., 1000.);
      r = g = b = floor((1. - modifiedPower / 1000.) * 255.) / 255.;
    }
    vColor = vec4(r, g, b, opacity);
  } else {
    vColor = showRedLine ? vec4(1., 0., 0., opacity) : vec4(0., 0., 0., 0.);
  }
  vDistance = aCustomDistance;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);
}
`,NXe=`precision highp float;
varying vec4 vColor;
varying float vDistance;
uniform float clipDistance;
void main() {
  if(vDistance < clipDistance) {
    gl_FragColor = vColor;
  } else {
    discard;
  }
}
`,BXe=`attribute float power;
attribute float gcmd;
attribute float aCustomDistance;
uniform bool showRedLine;
uniform float maxDistance;
varying vec4 vColor;
varying float vDistance;
void main() {
  float opacity = (gcmd == 1. && power == 0.) ? 0. : (gcmd == 0. ? .3 : 1.);
  float modifiedPower = clamp(power, 0., 1000.);
  modifiedPower = floor((1. - modifiedPower / 1000.) * 255.) / 255.;
  if(gcmd == 1. || gcmd == 25.) {
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.);
    vec4 powerColor = vec4(modifiedPower, modifiedPower, modifiedPower, 1.);
    powerColor.a = powerColor.a * exp(-abs(mvPosition.z) / maxDistance * max(1., (maxDistance / 200.)));
    vColor = powerColor;
  } else {
    vColor = showRedLine ? vec4(1., 0., 0., opacity) : vec4(0., 0., 0., 0.);
  }
  vDistance = aCustomDistance;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);
  gl_PointSize = 1.;
}
`,lJ={line:{transparent:!0,vertexShader:LXe,fragmentShader:OXe},point:{transparent:!0,vertexShader:BXe,fragmentShader:NXe}},FXe=new tc({uniforms:{showRedLine:{value:zo.showRedLine},maxDistance:{value:zo.maxDistance},clipDistance:{value:zo.clipDistance}},...lJ.point}),UXe=new tc({uniforms:{showRedLine:{value:zo.showRedLine},maxDistance:{value:zo.maxDistance},clipDistance:{value:zo.clipDistance}},...lJ.line}),GXe=new kXe({color:0,linewidth:.5,dashed:!1,worldUnits:!0,side:1}),cJ=(n,e)=>{const t=new wa;let i=0;return t.setAttribute("position",new gs(n.slice(i,i+e*3),3)),i+=e*3,t.setAttribute(zo.attributeKeys.distance,new gs(n.slice(i,i+e),1)),i+=e,t.setAttribute("power",new gs(n.slice(i,i+e),1)),i+=e,t.setAttribute("gcmd",new gs(n.slice(i,i+e),1)),t},HXe=(n,e)=>new rJ(cJ(n,e),UXe),VXe=(n,e)=>new _Xe(cJ(n,e),FXe),zXe=(n,e)=>{let t=0;const i=new aJ;i.instanceCount=e,i.setPositions(n.slice(t,t+e*3));function r(c){const u=c.length,h=[];for(let d=0;d<u-1;d++)h[2*d]=c[d],h[2*d+1]=c[d+1];return h}t+=e*3;const s=new Bm(new Float32Array(r(Array.from(n.slice(t,t+e)))),2,1);i.setAttribute(zo.attributeKeys.distance,new Oo(s,1,0)),i.setAttribute(zo.attributeKeys.distanceForLine2,new Oo(s,1,1)),t+=e;const o=new Bm(new Float32Array(r(Array.from(n.slice(t,t+e)))),2,1);i.setAttribute("power",new Oo(o,1,0)),i.setAttribute("power",new Oo(o,1,1)),t+=e;const a=new Bm(new Float32Array(r(Array.from(n.slice(t,t+e)))),2,1);i.setAttribute("gcmd",new Oo(a,1,0)),i.setAttribute("gcmd",new Oo(a,1,1));const l=new SXe(i,GXe);return console.log(["=> line2",l]),l},$Xe=async n=>{let e;try{return e=await fetch(`${hv.gLinkFetchHost}${n}`,{headers:{"Access-Control-Allow-Origin":"*",mode:"cros",Expires:"0","Cache-Control":"no-cache",Pragma:"no-cache"}}),new Float32Array(await e.arrayBuffer())}catch(t){return Promise.reject(`Network error: ${t.message}`)}};async function Mpt(n){var e,t;return await((t=(e=window.MeApi)==null?void 0:e.wasmKit)==null?void 0:t.genGcodeToPoints(n))}async function Rpt(n,e){let t=0,i=5e4;const r=[];for(let s=0;s<e;s++){const o=await $Xe(`${n}${s}`);!o||o.length<7||(i=(o.length-1)/6,t=Math.round(o[o.length-1]),t===kk.LINE?r.push(HXe(o,i)):t===kk.LINE2?r.push(zXe(o,i)):r.push(VXe(o,i)))}return{objects:r,lineMode:t}}function WXe(n){const{showRedLine:e,maxDistance:t,clipDistance:i}=n.material.uniforms??{};e&&(n.material.uniforms.showRedLine.value=zo.showRedLine),t&&(n.material.uniforms.maxDistance.value=zo.maxDistance),i&&(n.material.uniforms.clipDistance.value=zo.clipDistance)}let vP;var ap,lp,xc,Oa,Ps,La,sv,S0;const hT=class hT{constructor(e,t){ke(this,ap,{width:0,height:0});ke(this,lp,void 0);ke(this,xc,void 0);ke(this,Oa,void 0);ke(this,Ps,void 0);ke(this,La,void 0);ke(this,sv,void 0);ke(this,S0,0);E(this,"_bgColor",I5);E(this,"box",new vh);E(this,"sizeVector",new Oe);E(this,"centerVector",new Oe);E(this,"directionVector",new Oe);const{size:i,bgColor:r=I5}=t;Qe(this,ap,i),this._bgColor=r,Qe(this,lp,this.createCssRenderer()),vP||(vP=this.createRenderer()),Qe(this,xc,vP),Qe(this,Ps,this.createCamera()),Qe(this,La,this.createControls(S(this,Ps),S(this,xc).domElement)),Qe(this,Oa,this.createScene());const s=document.getElementById("canvas_preview");s.innerHTML="",e.appendChild(S(this,xc).domElement),e.appendChild(S(this,lp).domElement)}createCssRenderer(){const{width:e,height:t}=S(this,ap),i=new PXe;return i.setSize(e,t),i.domElement.style.position="absolute",i.domElement.style.top="0",i.domElement.style.pointerEvents="none",i}createRenderer(){const{width:e,height:t}=S(this,ap),i=new nJ({antialias:!0});return i.setSize(e,t),i.setPixelRatio(window.devicePixelRatio),i.autoClear=!0,i}createCamera(){const{width:e,height:t}=S(this,ap),i=new Ha(MXe,e/t);return i.position.z=400,i.lookAt(new Oe(0,0,0)),i}createScene(){const e=new pXe;return e.scale.y=-1,e.background=new $n(this._bgColor),e}createGrid(){return new wXe(500,10)}createControls(e,t){const i=new CXe(e,t);return i.minDistance=RXe,i.maxDistance=DXe,i.enableRotate=!1,i.mouseButtons={LEFT:xu.PAN,MIDDLE:xu.DOLLY,RIGHT:xu.ROTATE},i.touches={ONE:Gh.PAN,TWO:Gh.DOLLY_PAN},i.addEventListener("change",()=>{console.log("distance",i.getDistance()),S(this,sv)&&S(this,sv).call(this,i.getDistance()),this.render()}),i}watchControlsDistance(e){Qe(this,sv,e)}getCenterControlsDistance(){return S(this,S0)}render(){S(this,lp).render(S(this,Oa),S(this,Ps)),S(this,xc).render(S(this,Oa),S(this,Ps))}resize(e){const{width:t,height:i}=e;S(this,lp).setSize(t,i),S(this,xc).setSize(t,i),S(this,Ps).aspect=t/i,S(this,Ps).updateProjectionMatrix(),this.render()}fitToCenter(e,t=2){typeof e=="string"&&(e=S(this,Oa).getObjectByName(e)),this.box.setFromObject(e??S(this,Oa));const i=this.box.getSize(this.sizeVector),r=Math.max(i.x,i.y),s=this.box.getCenter(this.centerVector),o=cN.degToRad(S(this,Ps).fov),a=r*t/Math.tan(o);Qe(this,S0,a),this.directionVector.subVectors(S(this,Ps).position,s).multiply(hT.Z_AXIS).normalize(),S(this,Ps).position.copy(this.directionVector.multiplyScalar(a).add(s)),S(this,Ps).near=.1,S(this,Ps).far=1e4,S(this,Ps).updateProjectionMatrix(),this.box.setFromObject(S(this,Oa)),S(this,La).maxDistance=a*2,zo.maxDistance=a*2,e==null||e.children.forEach(l=>{WXe(l)}),S(this,La).target.copy(s),S(this,La).update(),this.render()}zoom(e=1){let t=S(this,Ps).position.z*e;t>S(this,La).maxDistance&&(t=S(this,La).maxDistance),t<S(this,La).minDistance&&(t=S(this,La).minDistance),S(this,Ps).position.z=t,S(this,La).update()}zoomIn(e=.9){this.zoom(e)}zoomOut(e=1.1){this.zoom(e)}addToScene(...e){S(this,Oa).add(...e)}emptyScene(){S(this,Oa).traverse(t=>{if(t.geometry){for(const i in t.geometry.attributes)t.geometry.deleteAttribute(i);t.geometry.dispose()}t.material&&t.material.dispose()}),S(this,Oa).children=[],S(this,xc).clear();const e=document.getElementById("canvas_preview");e==null||e.appendChild(S(this,xc).domElement)}};ap=new WeakMap,lp=new WeakMap,xc=new WeakMap,Oa=new WeakMap,Ps=new WeakMap,La=new WeakMap,sv=new WeakMap,S0=new WeakMap,E(hT,"Z_AXIS",new Oe(0,0,1));let M5=hT;class jXe{constructor(e){this.taskId=e}}class QXe{constructor(e){this.instanceId=e}}class XXe{constructor(e){this.instanceId=e}}class YXe{constructor(e){this.instanceId=e}}class qXe{constructor(e,t){this.instanceId=e,this.reConnectKey=t}}class KXe{constructor(e,t){this.instanceId=e,this.taskId=t}}class JXe{constructor(e){this.fileInfo=e}}class uJ{constructor(e){this.instanceId=e}}class ZXe extends Yc{constructor(){super();E(this,"lastEffectScope",null);this.watchProcessState()}initWatch(){super.initWatch(),yt(()=>hs.taskList.value,t=>{this.updateState({processingTasks:t.processingTasks,historyTasks:t.historyTasks}),this.shouldDisplayMinimizedWindow()},{immediate:!0}),yt(()=>Di.hasConnected(),()=>{this.shouldDisplayMinimizedWindow(),this.checkCorrectionProcessingTime()}),yt(()=>[Di.getInfo(),hs.hideMinimizedWindow],()=>{this.shouldDisplayMinimizedWindow()})}createState(){return{processingTasks:hs.taskList.value.processingTasks,historyTasks:hs.taskList.value.historyTasks,reConnectLoadingState:{},cancelProcessingLoadingState:{},pauseProcessingLoadingState:{},showMinimizedWindow:!1,currentProcessTaskData:null,currentProcessState:{},isShowCountTime:!1}}setEventHandler(){this.registerEventHandler(jXe,this.moveTaskToHistory),this.registerEventHandler(JXe,this.openProject),this.registerEventHandler(QXe,this.pauseProcess),this.registerEventHandler(YXe,this.restartProcess),this.registerEventHandler(XXe,this.cancelProcess),this.registerEventHandler(qXe,this.reConnectExt),this.registerEventHandler(KXe,this.callProcessPage),this.registerEventHandler(uJ,this.removeProcess)}watchProcessState(){this.lastEffectScope=ir.instance.watchProcessState({pauseProcessingLoading:"pauseProcessingLoadingState",cancelProcessingLoading:"cancelProcessingLoadingState",currentProcessStatus:"currentProcessState",isShowCountTime:"isShowCountTime"},t=>this.updateState(t))}getProcess(t){return ir.instance.addProcess(t)}async moveTaskToHistory(t){await hs.moveTaskToHistory(t.taskId)}async openProject(t){await Di.openProject(t.fileInfo)}async pauseProcess(t){await this.getProcess(t.instanceId).pauseProcess()}async restartProcess(t){await this.getProcess(t.instanceId).restartProcess()}async cancelProcess(t){await this.getProcess(t.instanceId).cancelProcess(),ir.instance.removeProcess(t.instanceId)}async reConnectExt(t){this.updateState({reConnectLoadingState:{[t.instanceId+t.reConnectKey]:!0}});try{const i=await Di.reConnectExt(t.instanceId);this.updateState({reConnectLoadingState:{[t.instanceId+t.reConnectKey]:!1}}),this.sendEffect({reConnectExt:{instanceId:t.instanceId+t.reConnectKey,connectResult:i}})}catch(i){console.log(i),this.updateState({reConnectLoadingState:{[t.instanceId+t.reConnectKey]:!1}}),this.sendEffect({reConnectExt:{instanceId:t.instanceId+t.reConnectKey,connectResult:!1}})}}async callProcessPage(t){this.getProcess(t.instanceId).callProcessPage(t.taskId)}removeProcess(t){ir.instance.removeProcess(t.instanceId)}shouldDisplayMinimizedWindow(){var u,h,d,f,p;const t=this.uiState.processingTasks,i=Di.getCurrentInstanceId(),r=Di.getCurrentExt(i),s=(u=Di.deviceData()[i])==null?void 0:u.connected;let o="";Hl.isSupportTaskId(i)?(o=(h=r==null?void 0:r.info)==null?void 0:h.taskId,o||(o=(d=this.getProcess(i))==null?void 0:d.taskId)):o=(f=this.getProcess(i))==null?void 0:f.taskId;const a=t.find(g=>g.id===o&&s);if(o){const g={...a};this.updateState({currentProcessTaskData:g})}const l=Hl.isInProcessing(i);l&&!((p=this.getProcess(i))!=null&&p.hasReStartTimer)&&(this.getProcess(i).hasReStartTimer=!0,this.checkCorrectionProcessingTime());const c=a!==void 0&&l&&!hs.hideMinimizedWindow;hs.isMinimized=c,this.updateState({showMinimizedWindow:c})}async checkCorrectionProcessingTime(){var l;const t=Di.getCurrentInstanceId(),i=Di.getCurrentExt(t),r=ha(),s=Hl.shouldResumeProcessing(t);if(!s)return;const{taskId:o,shouldResume:a}=s;if(a){if(!o)return;if(i.deviceInfo={taskId:o},r.isShowCountTime(t)){const c=await((l=i.correctionProcessingTime)==null?void 0:l.call(i))??{time:0};c.time!==0&&(r.setStartTime(t,c.time,o),console.log("checkCorrectionProcessingTime","倒计时",c.time,o))}else r.setStartTime(t,0,o),console.log("checkCorrectionProcessingTime","正计时",0,o)}}onDestroy(){var t;super.onDestroy(),(t=this.lastEffectScope)==null||t.stop()}}const ax=n=>(console.log("createDialogHandle",n),t=>{t.name===pk.fireWarning&&jt(Zt.dialogShow,{name:pk.fireWarning}),tt.modal.showTipModal({haveIcon:!1,iconName:void 0,title:t.title,content:t.content,hasCancel:t.hasCancel??!0,hasClose:t.closable,confirmTxt:t.positiveText,cancelTxt:t.negativeText,onConfirm:t.onPositiveClick,onCancel:t.onNegativeClick})});var ov;class eYe{constructor(){E(this,"dialog",{error:ax("error"),info:ax("info"),success:ax("success"),warning:ax("warning")});E(this,"toast",aO);E(this,"message",{info:e=>{this.showMsgToast({msg:e,icon:"info"})},success:e=>{this.showMsgToast({msg:e,icon:"success"})},warning:e=>{this.showMsgToast({msg:e,icon:"warning"})},error:e=>{this.showMsgToast({msg:e,icon:"error"})},loading:e=>{this.showMsgToast({msg:e,icon:"loading"})}});ke(this,ov,void 0);E(this,"transformNumber",e=>Vy(e))}showMsgToast(e){this.showMessage({key:e.msg,contentI18nKey:e.msg,type:e.icon})}set canvasSelectedChanged(e){Qe(this,ov,e)}get version(){return""}get formatMsg(){var e;return(e=za.i18n)==null?void 0:e.global.t}get instanceId(){var t;return(t=bt().ext)==null?void 0:t.instanceId}getConnectorInfo(){return bt().info}showMessage(e){const{key:t,args:i,contentI18nKey:r="",type:s="info",options:o={},render:a}=e;HA.showGlobalMessage({type:s,key:t,contentI18nKey:r,options:o,contentI18nArgs:i,render:a})}destroyMessage(e,t){HA.destroyMessage({key:e,immediateClose:t})}updateBackImg(e,t=!1,i){if(i&&i!==this.instanceId)return;let r={};vs(e)&&"img"in e?r=e:r.img=e;const{img:s=null,targetWidth:o,targetHeight:a}=r,l=bt().ext;let c={};const u=bt().dataSource.currentDeviceData;if(u){const{mode:h}=u,{current:{angle:d,offsetX:f,offsetY:p,bgMaskSize:g}}=l.getCurrentArea(h),{width:m,height:v}=l.config.processingArea.base;c={angle:d,width:o||m,height:a||v,offsetX:f,offsetY:p,bgMaskSize:g}}fn().updateCanvasBackdrop(c,s),t&&this.updateBackVisible(!0)}updateBackVisible(e){fn().switchBackgroundVisible(e)}updateLocalImg(e,t,i){i&&i!==this.instanceId||fn().updateLocalImg(e,t)}resetProcessingState(){}changeProcessState(e,t){console.log(e,t)}selectCanvasAllElement(){}moveSelectElement(e){console.log(e)}updateBuildParams(e){console.log(e)}onCanvasSelected(e){mt(S(this,ov))&&S(this,ov).call(this,e)}get canvasSelectedData(){return fn().getSelectedDisplay}get isBackgroundDisplay(){return fn().hasBackgroundImage&&fn().backgroundVisible}checkProcess(e){const t=ha().checkProcess(this.instanceId,!1,e);return console.log(e),t}get generateTotalTime(){const e=localStorage.getItem("process_estimated_time");return console.log("======totalTime",e),e}sensorsTrack(e,t){jt(e,t)}showNumberKeyboard(e){tt.modal.showNumberKeyboard(e)}getUnit(){const e=si().unit;return console.log("========getUnit",e),e}}ov=new WeakMap;const _P="firmwareRemind";var Ou;const vu=class vu{static get devices(){return S(vu,Ou)}static add(e){S(vu,Ou).find(i=>i.id===e.id)&&localStorage.setItem(_P,JSON.stringify(S(vu,Ou))),S(vu,Ou).unshift({...e,time:+new Date}),localStorage.setItem(_P,JSON.stringify(S(vu,Ou)))}static has(e){const t=S(vu,Ou).find(i=>i.id===e.id);return t?+new Date-t.time<=2592e5:!1}};Ou=new WeakMap,ke(vu,Ou,(()=>{const e=localStorage.getItem(_P);return e?JSON.parse(e):[]})());let mE=vu;var Ed=(n=>(n.AppVar="mockAppVersion",n.DeviceId="mockUpdateDeviceId",n.FirmwareVer="mockFirmwareVersion",n))(Ed||{});const Sp=(n,e)=>{const t=localStorage.getItem(n);return t||e||""},{domain:hJ}=nl(),tYe=`${hJ.commonApi}/efficacy/v1/package/version/latest`,nYe=`${hJ.commonApi}/efficacy/v1/packages/version/latest`,vE=n=>{var e;if(!(!pi(n)||wt(n)))return(e=n.match(/\d+/g))==null?void 0:e.slice(0,4).map((t,i)=>Number(i===3?t.toString().substring(0,2):t))},Ok=(n,e)=>{const t=vE(n);if(!t)return!1;const i=vE(e);if(!i)return!1;const[r,s,o,a]=t,[l,c,u,h]=i;return l>r||l===r&&c>s||l===r&&c===s&&u>o||l===r&&c===s&&u===o&&h>a},iYe=async(n,e,t,i="",r,s=1e3)=>(s>0&&await fC(s),Rt(n)?sYe(n,e,i):rYe(n,e,i,r,t)),rYe=async(n,e,t,i,r)=>{try{r?n=Sp(Ed.AppVar,n):n=Sp(Ed.FirmwareVer,n);const s=vE(n);if(gi(s))return Promise.reject(`[xcs error] can't parse version '${n}'`);const o=s==null?void 0:s.join("."),a={...e,contentVersion:o},l=Sp(Ed.DeviceId);l&&(a.deviceId=l);const c=15e3,u={method:"post",headers:{"content-type":"application/json;charset=UTF-8"},body:JSON.stringify(a)},h=new Promise((A,w)=>setTimeout(()=>w(new Error("Request timed out")),c)),d=fetch(tYe,u).then(A=>A.json()),f=await Promise.race([d,h]),{code:p,data:g}=f;if(p!==0)return Promise.reject(new Error(`[xcs error] request error, error code: '${p}'.`));const{version:m="",advice:v,extra:_={}}=g||{},y=Ok(n,m)||mt(i)&&i(_);if(y&&!wt(g==null?void 0:g.contents)){let A=!1;const{minAppVersion:w,...b}=_;w&&(A=Ok(t,w)),console.log("[是否软件版本过低]=>",A);const C=g.contents.map(x=>x.url),I=g.contents.map(x=>x.md5);return{shouldUpdate:y,latestVersion:m,downloadUrl:C,subVersions:b,changeLog:g.description,forceUpdate:v===1,appVersionLow:A,md5List:I}}return null}catch(s){return Promise.reject(s)}},sYe=async(n,e,t)=>{var i;try{const r={...e,packages:n},s=JSON.parse(JSON.stringify(r));(i=s.packages)==null||i.forEach(g=>{var v;const m=Sp(Ed.FirmwareVer,(v=vE(g.contentVersion))==null?void 0:v.join("."));g.contentVersion=m});const o=Sp(Ed.DeviceId);o&&(s.deviceId=o);const a=15e3,l={method:"post",headers:{"content-type":"application/json;charset=UTF-8"},body:JSON.stringify(s)},c=new Promise((g,m)=>setTimeout(()=>m(new Error("Request timed out")),a)),u=fetch(nYe,l).then(g=>g.json()),h=await Promise.race([u,c]),{code:d,data:f}=h;if(d!==0)return Promise.reject(new Error(`[xcs error] request error, error code: '${d}'.`));const p=f.length>0;if(p){const g=Zi(f,"version").join(","),m=Zi(f,"description").flat(),v={zh:Zi(m,"zh").join(`
`),en:Zi(m,"en").join(`
`)},_=Zi(f,"advice"),y=Zi(f,"extra.minAppVersion");let A=!1;y.length>0&&(A=y.map(x=>x?Ok(t,x):0).includes(!0)),console.log("[是否软件版本过低]=>",A);const w={},b={};f.forEach(I=>{const{id:x,contents:T}=I;w[x]=Zi(T,"url")[0],b[x]=Zi(T,"md5")[0]});const C={};return console.log({version:g,urlList:w,advices:_,changeLog:v,minAppVersions:y}),{shouldUpdate:p,latestVersion:g,downloadUrl:w,subVersions:C,changeLog:v,forceUpdate:_.includes(1),appVersionLow:A,md5List:b}}return null}catch(r){return Promise.reject(r)}};class oYe{constructor(){E(this,"lastCheckResult",null);E(this,"isFirmwareUpdating",!1);E(this,"ext",null)}async checkUpdateFirmware(e){if(!ft.connected)return null;const t={domain:"xcs",region:"en",contentId:e.contentId},{deviceInfo:i={}}=e,r=i.version,s=mt(e.checkFirmwareVersion)&&e.checkFirmwareVersion(),o=await window.MeApi.app.getAppVersion(),a=Sp(Ed.AppVar,o),l=await iYe(r,t,!1,a,s);return l?(this.lastCheckResult=l,this.ext=e,l):null}}const Fu=new oYe,R5=ba("firmware-update",{getters:{lastCheckResult(){return Fu.lastCheckResult}},actions:{async checkUpdateFirmware(n,e=!1){const t=await Fu.checkUpdateFirmware(n),{shouldUpdate:i,latestVersion:r}=t||{},s=bt().extId,o=mE.has({id:s,version:r});return console.log("checkUpdateFirmware laterRemind",t,o),i&&(e||!o)&&tt.modal.showNewFirmwareDialog(t),t},lastCheckResultData(){return Fu.lastCheckResult},isFirmwareUpdating(){return Fu.isFirmwareUpdating}}});let aYe=class{getExt(){return bt().ext}getCurrentPower(){return bt().currentPower}};const cy=new aYe;class lYe{constructor(){E(this,"_localMaterial",ee([]));E(this,"selectedPower",10);E(this,"material",null);E(this,"materialData",[]);E(this,"laserSource","blue");E(this,"_selectOnlineMaterialHandler");localStorage.removeItem(nl().LOCAL_MATERIALS),this.updateLocalMaterial()}get localMaterial(){return this._localMaterial.value}set localMaterial(e){this._localMaterial.value=e}set selectOnlineMaterialHandler(e){this._selectOnlineMaterialHandler=e}getMaterialList(){const e=cy.getExt(),t=cy.getCurrentPower(),i=e==null?void 0:e.config.productID,r=hde({identifier:i,power:t,deviceMode:(ld==null?void 0:ld.mode)||"",materialList:this.localMaterial.slice(0),laserSource:this.laserSource});return r.unshift(cde),console.log(["=> materialList",`${t}`,i,r]),r.slice(0)}isDangerousMaterial(){var e;return(e=this.localMaterial.find(t=>t.id===ld.material))==null?void 0:e.isDangerous}async getUpdateMaterial(e){try{return await jie(e)}catch(t){return console.log(t),!1}}selectOnlineMaterial(e){const t=this.localMaterial.slice(0),i=t.findIndex(r=>r.id===e.id);if(i>=0?t[i]=e:t.unshift(e),this.localMaterial=t,this.setLocalMaterialToNative(t),e.id&&e.id){const r=this.getMaterialList().find(s=>s.id===e.id);r&&this._selectOnlineMaterialHandler&&this._selectOnlineMaterialHandler("material",r)}}async getMaterialCategoryList(){try{return(await Qie()).map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}}updateLocalMaterialList(e){this.localMaterial=e,this.setLocalMaterialToNative(e)}async getLocalMaterialFromNative(){try{const e=this.getLocalMaterialPath(),t=await window.MeApi.fileHelper.read2Str(e);return JSON.parse(t||"[]")}catch(e){return console.error("getLocalMaterialFromNative =====>",e),[]}}async setLocalMaterialToNative(e){try{const t=this.getLocalMaterialPath();await window.MeApi.fileHelper.writeData(t,JSON.stringify(e)||"[]")}catch(t){return console.error("setLocalMaterialToNative =====>",t),[]}}getLocalMaterialPath(){const e=nl().LOCAL_MATERIALS;return window.MeApi.fileHelper.getPath(`/material/${e}.json`)}async updateLocalMaterial(){var r,s,o;await((s=(r=window.MeApi)==null?void 0:r.fileHelper)==null?void 0:s.getAPPHomePath()),this.localMaterial=await this.getLocalMaterialFromNative();const e=this.localMaterial.slice(0);(!this.materialData||((o=this.materialData)==null?void 0:o.length)===0)&&(this.materialData=(await Pi(()=>import("./material-c0O1_QoA.js"),__vite__mapDeps([]),import.meta.url)).default),this.materialData.forEach(a=>{const l=e.findIndex(c=>c.id===a.id);l>=0?a.updatedAt>e[l].updatedAt&&(e[l]=a):e.push(a)}),this.localMaterial=e,this.setLocalMaterialToNative(e);const t=e.map(({id:a,updatedAt:l})=>({id:a,updatedAt:l})),i=await this.getUpdateMaterial(t);Rt(i)&&i.forEach(a=>{const l=e.findIndex(c=>c.id===a.id);l>=0&&(e[l]=a)}),this.localMaterial=e,this.setLocalMaterialToNative(e)}sortLocalMaterial(e){const t=this.localMaterial.slice(0),r=dC(t,s=>s.id===e).concat(t);this.localMaterial=r,this.setLocalMaterialToNative(r)}importProjectMaterial(e){if(console.log("导入项目的材料: ",e),!wt(e)){const t=this.localMaterial.slice(0);e.forEach(i=>{t.some(r=>r.id===i.id)||t.unshift(i)}),this.localMaterial=t,this.setLocalMaterialToNative(t)}}async getOnlineMaterialList(e){try{return await Wie(e)}catch(t){console.log(t)}}async getMaterialDetail(e){try{return await Xie(e)}catch(t){return console.log(t),!1}}async webCommandSelectMaterial(e){var f;const{payload:{deviceProductId:t,power:i,materialId:r,processingType:s,matrix:o,laserSource:a="blue"}}=e;console.log(["=> webCommandSelectMaterial",e]),window.postMessage({action:"popMoreMaterial"});const l=cy.getCurrentPower();let c=!1;Rt(l)?c=l.includes(i):c=l===i;const u=cy.getExt(),h=((f=u==null?void 0:u.config)==null?void 0:f.productID)||"";if(!c||h!==t){tt.modal.showToast({msg:"device.parameter_panel.used_fail",icon:"error",duration:3e3});return}const d=await this.getMaterialDetail(r);if(d){const p=this.localMaterial.find(m=>m.id===r);p?(Object.assign(p,d),this.sortLocalMaterial(r)):(this.localMaterial.unshift(d),this.setLocalMaterialToNative(this.localMaterial.slice(0)));const g=this.laserSource;["MF1","GS002"].includes(h)&&(this.laserSource=a==="red"?"red":"blue"),window.postMessage({action:"SelectMaterial",id:r,processingType:s,matrix:o,power:i,laserSource:a,productID:h,originLaserSource:g},location.origin)}}}const ia=new lYe,el=ba("material_module",{getters:{getMaterialList(){return ia._localMaterial.value,cy.getExt(),ia.getMaterialList()},laserSource(){return ia.laserSource}},actions:{importProjectMaterial(n){ia.importProjectMaterial(n)},getOnlineMaterialList(n){return ia.getOnlineMaterialList(n)},getMaterialCategoryList(){return ia.getMaterialCategoryList()},selectOnlineMaterial(n){return ia.selectOnlineMaterial(n)},sortLocalMaterial(n){return ia.sortLocalMaterial(n)},setLocalMaterial(n){ia.material=n},setMaterialPower(n){ia.selectedPower=n},setLaserSource(n){ia.laserSource=n},getLocalMaterial(){return ia.material},webCommandSelectMaterial(n){ia.webCommandSelectMaterial(n)}}});let cYe=class{checkUpdateFirmware(e){R5().checkUpdateFirmware(e)}isFirmwareUpdating(){return R5().isFirmwareUpdating()}getCanvasManager(){return fn().canvasManager}unRegisterPluginByType(e){fn().unRegisterPluginByType(e)}getCanvasDisplays(){return fn().canvasDisplays()}updateCanvasArea(e){fn().updateCanvasArea(e)}cleanCanvasBackdrop(){fn().cleanCanvasBackdrop()}updateCanvasBackdrop(e,t,i){fn().updateCanvasBackdrop(e,t,i)}getCurrentMode(){return Hc().currentMode}get canvasId(){return fn().canvasId}get backgroundVisible(){return fn().backgroundVisible}get hasBackgroundImage(){return fn().hasBackgroundImage}switchBackgroundVisible(e){fn().switchBackgroundVisible(e)}addProcess(e){return ha().addProcess(e)}removeProcess(e){ha().removeProcess(e)}toggleTimer(e,t){ha().toggleTimer(e,t)}isShowCountTime(e){return ha().isShowCountTime(e)}setStartTime(e,t){ha().setStartTime(e,t)}pauseTimer(e){ha().pauseTimer(e)}setMaterialPower(e){el().setMaterialPower(e)}setLaserSource(e){el().setLaserSource(e)}getSelected(){return fn().getSelected()}setSelect(e){return fn().setSelected(e)}isAutoUpdateDeviceExt(){return si().isAutoUpdateDeviceExt()}canvasEventOn(e,t,i=!1){fn().canvasEventOn(e,t,i)}canvasEventOff(e,t){fn().canvasEventOff(e,t)}markClearFn(e){return fn().markClearFn(e)}get canvasBgImageMap(){return fn().canvasBgImageMap}shouldResumeProcessing(e){return ha().shouldResumeProcessing(e)}};const bn=new cYe;var av;class uYe{constructor(){E(this,"listener",e=>{});ke(this,av,!1);E(this,"type","extId");E(this,"handler",{confirm:()=>{},cancel:()=>{}})}set visible(e){S(this,av)!==e&&(Qe(this,av,e),e&&tt.modal.showSwitchDeviceModal({type:this.type,onConfirm:()=>{this.handler.confirm()},onCancel:()=>{this.handler.cancel()}}),this.listener(e))}get visible(){return S(this,av)}}av=new WeakMap;const Y_=new uYe;var ua=(n=>(n.ETH="ETH",n.WIFI="WIFI",n.SERIAL="SERIAL",n.USB="USB",n))(ua||{}),WA=(n=>(n.CONNECTED="CONNECTED",n.CLOSED="CLOSED",n.ERROR="ERROR",n.RECEIVE="RECEIVE",n))(WA||{});const hYe=n=>`ws://${n}:8081`;class dYe extends uh.EventEmitter{constructor(t){super();E(this,"ip");E(this,"_isOpen",!1);E(this,"webRequest",!0);E(this,"callbacks");E(this,"socketWorker");E(this,"heartbeatTimeout",8e3);E(this,"heartbeatTimeoutFn");E(this,"isHeartbeat",!1);E(this,"msgCallback",()=>{});E(this,"disconnectCallback",()=>{});E(this,"closePing",()=>{});this.ip=t,this.callbacks={onClose(){},onReceive(){},onError(){}},this.heartbeatTimeoutFn=Yj(()=>{console.warn("=> socket heartbeat timeout"),this.heartbeatTimeoutFn.stop(),this.close()},this.heartbeatTimeout)}get isOpen(){return this._isOpen}set isOpen(t){this._isOpen=t,t||setTimeout(()=>{ft.checkDeviceConnectStatus(this.ip)},1e3)}get socketUrl(){return hYe(this.ip)}get connectIdentify(){return this.ip}async setup(t,i=!1){this.isHeartbeat=i,Tt.info(["=> setup NetServer",this.ip,{useSocket:t}]),t&&await this.setupSocket(),i||await this.checkIpOnline(),this.isOpen=!0}async setupSocket(){return Tt.info(["=> setupSocket",this.ip]),new Promise((t,i)=>{this.socketWorker=new pQ;const r={open:()=>{console.log(["opened",this.ip]),t(!0),this.isOpen=!0},message:s=>{this.msgCallback(s)},close:()=>{Tt.info(["=> service message socket closed.",this.ip]),this.socketWorker.destroy(),i(),this.isOpen=!1},error:s=>{Tt.error(["=> service message socket error",this.ip,s]),i(s),this.isOpen=!1},heartbeat:()=>{this.heartbeatTimeoutFn.stop(),this.heartbeatTimeoutFn.start(!0),t(!0)}};this.socketWorker.on("message",({type:s,data:o})=>{const a=r[s];mt(a)&&a(o)}),this.socketWorker.on("error",s=>{i(s)}),this.socketWorker.create(this.socketUrl,this.isHeartbeat).catch(i)})}onReceive(t){const i=r=>{console.log({chunk:r}),mt(t)&&t(r)};return this.on(WA.RECEIVE,i),()=>{this.off(WA.RECEIVE,i)}}setCallbacks(t){Tt.debug(["=> socket setCallback"]),this.callbacks=Object.assign(this.callbacks,t)}hasOpen(){return this.isOpen}apiParser(t){return Tj(t,this.ip)}apiParserNext(t){const i=(r,s,o)=>{const a=async(h,d)=>await this.socketWorker.request({type:"execCmd",data:{cmd:h,args:s,...d}});mt(r)&&(r=r(s));const{dataTransform:l,...c}=o.options||{};let u;if(Rt(r)){const h=[];r.forEach(d=>{h.push(a(d,{...c,type:o.type}))}),u=Promise.all(h)}else u=a(r,{...c,type:o.type});return u.then(h=>(console.log(["=> customRequest result",h]),mt(l)?l(h):h))};return VT(t,this.ip,i.bind(this))}async checkIpOnline(){var i,r,s;if(!((i=window.MeApi)!=null&&i.ping))return!1;const t=await((r=window.MeApi)==null?void 0:r.ping.pingOnceCheck(this.ip));if(!t)return this.isOpen=!1,Promise.reject(`device is online ${t}`);this.isOpen=!0,this.closePing=(s=window.MeApi)==null?void 0:s.ping.pingHeartCheck(this.ip,()=>{this.close()},{maxCount:5,timeout:2})}close(){this.closeSocket(),this.dispose()}closeSocket(){var t;return(t=this.socketWorker)==null?void 0:t.close()}dispose(){var t;(t=this.socketWorker)==null||t.destroy(),this.heartbeatTimeoutFn.stop(),this.isOpen=!1,mt(this.closePing)&&this.closePing(this.ip),this.closePing=()=>{},this.disconnectCallback(),this.callbacks={onClose(){},onReceive(){},onError(){}},this.removeAllListeners()}destroyWorker(){var t;(t=this.socketWorker)==null||t.destroy(),this.heartbeatTimeoutFn.stop(),this.isOpen=!1,mt(this.closePing)&&this.closePing(this.ip),this.closePing=()=>{},this.callbacks={onClose(){},onReceive(){},onError(){}},this.removeAllListeners()}setMsgCallback(t){this.msgCallback=t}setDisconnectCallback(t){this.disconnectCallback=t}}const Lk=["201.234.3.1","201.234.4.1"],fYe="169.254.2.1",pYe=[{name:"version",timeout:3e3,list:[{url:"/system",params:{action:"version"},transformResult(n){return We(n,"version")}},{url:"/system",params:{action:"version_v2"},transformResult(n){return We(n,"package_version",n)}}]},{name:"info",timeout:3e3,list:[{url:"/system",params:{action:"get_dev_name"},transformResult(n){return We(n,"name",n)}},{url:"/system",params:{action:"mac"},transformResult(n){return We(n,"mac",pj(n,`
`))}},{url:"/system",params:{action:"version_v2"},transformResult(n){return We(n,"machine_type")}}]}],dN=async(n,e,t)=>{const i=VT(pYe,n);try{const s=(await i.version({signal:t})).find(h=>pi(h));if(!s)return null;const o=await i.info({signal:t}),[a,l,c]=o.map(h=>pi(h)||tn(h)?h:""),u={ip:n,version:s,name:a,mac:l,snCode:c};return console.log(["=> data",u,n]),mt(e)&&e(u),u}catch(r){Tt.error(r)}return null},gYe=50;var td,nd;const Eo=class Eo{static get q(){return S(Eo,td)||Qe(Eo,td,vQ((e,t)=>{e().finally(()=>{t()})},gYe)),S(Eo,td)}static get signal(){return S(Eo,nd)||Qe(Eo,nd,pM()),S(Eo,nd)}static async dispose(){var t,i;if((t=S(Eo,td))==null||t.kill(),Qe(Eo,td,null),(i=S(Eo,nd))==null||i.cancel(),Qe(Eo,nd,null),!window.MeApi)return;const{discovery:e}=window.MeApi;e&&await e.dispose()}};td=new WeakMap,nd=new WeakMap,ke(Eo,td,void 0),ke(Eo,nd,void 0);let Cu=Eo;const dJ=(n,e=[])=>{console.log(["=> sameGatewayIps",n]);const t=[];if(Rt(n))return n.forEach(a=>{t.push(...dJ(a,e))}),t;const[i,r,s,o]=n.split(".");for(let a=1;a<255;a++){if(Number(o)===a)continue;const l=[i,r,s,a].join(".");e.includes(l)||t.push(l)}return t},mYe=async n=>{try{const{discovery:e}=window.MeApi,t=[];if(e){await Cu.dispose();const i=[],r=u=>{t.some(d=>d.ip===u.ip)||(t.push(u),mt(n.onDiscover)&&n.onDiscover(u))},{signal:s}=Cu.signal,o=await e.ip(),a=u=>()=>dN(u,r,s),l=async()=>{e.on("receiver",async u=>{const{ip:h,name:d,version:f}=u;h&&(Lk.includes(h)||(i.push(h),h&&f?r({ip:h,name:d,version:f}):Cu.q.pushAsync(a(h))))}),await e.list(),await e.dispose()};Cu.q.pushAsync(l);let c=Ja(dJ(o,[...i,...Lk]));return c.length>100&&(c=c.slice(99).concat(c.slice(0,99))),c.forEach(u=>{Cu.q.pushAsync(a(u))}),await Cu.q.drain(),console.log(["=> 队列执行完成"]),t}return[]}catch(e){return Tt.error(e),[]}},vYe=()=>Cu.dispose(),_Ye=n=>dN(n),yYe=n=>new dYe(n);class AYe extends j0{constructor(t){super();E(this,"options");E(this,"port");this.options=t}get connectIdentify(){var t;return(t=this.port)==null?void 0:t.connectIdentify}async init(){var t,i,r,s;return(i=(t=window.MeApi)==null?void 0:t.serial)!=null&&i.open?(this.port=await((s=(r=window.MeApi)==null?void 0:r.serial)==null?void 0:s.open(this.options)),Tt.info("串口初始化",this.port.connectIdentify),this.port.on("data",o=>{this.emit(WA.RECEIVE,o)}),this.port.on("close",()=>{Tt.info("检测到设备端口关闭",this.port.connectIdentify),this.emit(WA.CLOSED)}),this):Promise.reject()}hasOpen(){var t;return(t=this.port)==null?void 0:t.hasOpen()}write(t,i,r){var s;return(s=this.port)==null?void 0:s.write.bind(this.port)(t,i,r)}onReceive(t){var i;return(i=this.port)==null?void 0:i.onReceive.bind(this.port)(t)}setCallbacks(t){var i;(i=this.port)==null||i.setCallbacks.bind(this.port)(t)}apiParser(t){var r;const i=(r=this.port)==null?void 0:r.apiParser.bind(this.port)(t);return i.uploadGcode=(...s)=>{var o;return(o=this.port)==null?void 0:o.uploadFile(...s)},i.updateFirmware=s=>{var o,a;return(a=(o=window.MeApi)==null?void 0:o.serial)==null?void 0:a.updateFirmware({...s,baud:115200,port:this.connectIdentify})},i.downloadFirmware=(...s)=>{var o,a;return(a=(o=window.MeApi)==null?void 0:o.serial)==null?void 0:a.downloadFirmware(...s)},i}getData(t,i,r=1e3){var s;return(s=this.port)==null?void 0:s.getData.bind(this.port)(t,i,r)}setData(t,i=[]){var r;return(r=this.port)==null?void 0:r.setData.bind(this.port)(t,i)}stopReadGcodeFile(){var t;return(t=this.port)==null?void 0:t.closeReadFile()}close(){var t;return(t=this.port)==null?void 0:t.close()}dispose(){this.removeAllListeners()}}const bYe=n=>{var e,t,i;return(e=window.MeApi)!=null&&e.serial?(i=(t=window.MeApi)==null?void 0:t.serial)==null?void 0:i.list(n):Promise.reject()},wYe=n=>new AYe(n).init(),xYe=n=>n?Promise.all([n.getData("M99",void 0,1500),n.getData("M100",void 0,1500)]):Promise.reject(new Error("get device version error. port is unknown.")),uy=n=>{var i,r;if(!pi(n))return;if(new RegExp("[v|V]1\\.[0-9]+.[0-9]+ [b|B][0-9]+").test(n))return(i=gd.find(s=>s.versionId==="30"))==null?void 0:i.extId;const[,t]=n.match(/\d+/g)??[];return(r=gd.find(s=>s.versionId===t))==null?void 0:r.extId},fJ="MY_APP_INDEXED_DB",pJ="$IDB_STORE",gJ="$_ID",CYe=[{storeName:pJ}],mJ=()=>{if(!window.indexedDB)throw new Error("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.");return window.indexedDB},D5=n=>{const e=n;return e.update=t=>EYe(n,t),e.getStore=(t,i)=>PYe(n,t,i),e.createStore=t=>e.update(i=>_J(i,t)),e.deleteStore=t=>e.update(i=>SYe(i,t)),e},vJ=(n=>{let e,t;return i=>new Promise((r,s)=>{const o={...n,...i||{}},{name:a,version:l,onUpdate:c,timeout:u}=o,h=mJ();e||(e=h.open(a,l));const d=()=>{e==null||e.removeEventListener("success",f),e==null||e.removeEventListener("error",p),e==null||e.removeEventListener("upgradeneeded",g),e=null,n=o},f=m=>{const v=m.currentTarget.result;t=D5(v),d(),r(t)};e.addEventListener("success",f);const p=m=>{d(),s(m.target.error)};e.addEventListener("error",p);const g=m=>{const v=m.currentTarget.result,_=D5(v);d(),c==null||c(_),setTimeout(()=>{r(_)},500)};e.addEventListener("upgradeneeded",g),setTimeout(()=>{d(),s("Request IndexedDB Timeout!")},u)})})({name:fJ,timeout:3e3}),EYe=(n,e)=>new Promise((t,i)=>{let r;if(n.objectStoreNames.length===0){const s=n.name;n.close(),TYe(s)}else r=n.version+1,n.close();setTimeout(()=>{vJ({version:r,onUpdate:e}).then(t).catch(i)})}),k5=(()=>{let n;const e=t=>{t.onerror=i=>console.error(i.target),t.onversionchange=()=>{t.close(),n=null},t.onabort=i=>{n=null},t.onclose=i=>{n=null}};return async t=>n?(t&&console.warn("Open indexedDB Options is invalid because the db is already opened!"),n):await vJ({onUpdate:i=>IYe(i,[...CYe,...(t==null?void 0:t.stores)||[]]),...t||{}}).then(i=>(e(i),window.onbeforeunload=()=>i.close(),i))})(),TYe=(n=fJ)=>{mJ().deleteDatabase(n)},_J=(n,{storeName:e,keyPathOptions:{keyPath:t=gJ,autoIncrement:i}={},indexList:r})=>{if(n.objectStoreNames.contains(e))return!1;const s=n.createObjectStore(e,{keyPath:t,autoIncrement:i});return r==null||r.forEach(({name:o,options:a})=>{s.createIndex(o,o,a)}),s},IYe=(n,e)=>{e.forEach(t=>_J(n,t))},SYe=(n,e)=>n.objectStoreNames.contains(e)?(n.deleteObjectStore(e),console.info(`[indexedDB] Store ${e} is deleted!`),!0):!1,PYe=(n,e,t)=>{let i;try{i=n.transaction(e,t)}catch{throw new Error(`[IndexDB] Store named '${e}' cannot be found in the database`)}return i.objectStore(e)},MYe=(n,e)=>new Promise((t,i)=>{const r=n.put(e);r.onsuccess=t,r.onerror=i}),RYe=(n,e)=>new Promise((t,i)=>{const r=e?n.get(e):n.getAll();r.onsuccess=s=>{t(s.target.result)},r.onerror=i}),DYe=(n,e)=>new Promise((t,i)=>{const r=n.delete(e);r.onsuccess=s=>{t(s.target.result)},r.onerror=i});function kYe(n,e){const{storeName:t=pJ,keyPathOptions:i={}}=e||{},{keyPath:r=gJ}=i,s=(()=>{let u;return async(h="readonly")=>await k5().then(async d=>d.objectStoreNames.contains(t)||!e||u?d.getStore(t,h):(u=!0,await d.createStore(e).then(f=>(u=!1,f.getStore(t,h)))))})();async function o(){return e?await k5().then(async u=>await u.deleteStore(t)):!1}async function a(){return await s().then(async u=>{const h=await RYe(u,n);return h&&delete h[r],h})}async function l(u){return await s("readwrite").then(async h=>await MYe(h,{...u,[r]:n}))}async function c(){return await s("readwrite").then(async u=>await DYe(u,n))}return{getData:a,setData:l,removeData:c,del:o}}class OYe{constructor(){E(this,"dbKey","DeviceConnectHistory");E(this,"store",kYe(this.dbKey))}async addDevice(e){const{instanceId:t}=e,i=await this.store.getData()||{},r=t.split(":").shift();if(!r)return console.log("更新设备使用记录时，未获取到有效ID"),i;if(r===t){for(const s of Object.keys(i))if(s.startsWith(`${r}:`))return i;i[t]={...i[t],...e}}else i[t]={...i[r],...i[t],...e},delete i[r];return await this.store.setData(i),i}async removeDevice(e){const t=await this.store.getData()||{};return delete t[e],await this.store.setData({}),await this.store.setData(t),t}updateDevice(e){return this.addDevice(e)}async getUsedDevices(){return await this.store.getData()||{}}}const Jx=new OYe;window.ME.connectDb=Jx;class LYe{constructor(e){this.device=e}}class NYe{constructor(e){this.device=e}}class BYe{constructor(e){this.instanceId=e}}class FYe{constructor(e){this.device=e}}const dn=class dn{static getInstanceIds(){const e=[];for(const t of dn.exts)e.push(t.instanceId);return e}static getCountByInstanceId(e){let t=0;for(const i of dn.exts)i.instanceId===e&&(t=t+1);return t}static async load(e,t){try{const i=await dn.getExtFileById(e);if(i){const r=await i(),{DeviceExt:s}=r,o=s(Lve),a=new o(t);return dn.exts.add(a),Tt.info("加载扩展版本号为",a.version),dn.$ev.emit(dn.EVENTS.CREATED,a),gi(dn.updateInfo[e])&&(dn.updateInfo[e]={shouldUpdate:!1,hasUpdate:!1}),a}return Promise.reject(`can't found '${e}'.`)}catch(i){return Tt.error(i),Promise.reject(`load ext '${e}' error. ${i}`)}}static async addExtFile(e){Tt.info("通过拖拽的方式添加扩展");const t=Sd(new Date,"yyyy_MM_dd_HH_mm_ss"),i=e.lastIndexOf("/"),r=e.slice(i+1,e.length),s=r.match(/^(.*?)-/),o=s&&s[1],a=r.match(/-V(.*?)\.ext/),l=a&&a[1];if(!o||!l)return Promise.reject("扩展名称不合法");Tt.info(`添加扩展名称${o},版本号${l}`);const c=await dn.getCurrentVersionExtPath(),u=`${c}/${t}.ext`,h=`${c}/${t}`;Tt.info("扩展临时存储目录",u);const d=`${c}/${o}-V${l}`;return Tt.info("扩展存储目录",d),await Ri.copyFile(e,u),Tt.info(`复制扩展包 ${e}==> `),await Ri.unzipFile(u,h),Tt.info(`解压扩展包到临时目录,${u}`),await Ri.copy(h,d,{overwrite:!0}),Tt.info(`将解压后的扩展包从临时目录移动到正式目录${d}`),await dn.updateManifest({extName:o,extVersion:l,createAt:t,createBy:XO.DRAG_DROP}),o}static async updateManifest(e){const{extName:t,extVersion:i,createAt:r,createBy:s}=e,o=`${await dn.getCurrentVersionExtPath()}/manifest.json`,a=await Ri.read2JSON(o),l=pd(a[t]||[],{version:i}),c=pd(a[t]||[],{active:!0});if(c===-1)throw new Error(`manifest 文件中未找到 ${t} 对应的激活扩展`);delete a[t][c].active;const u={version:i,createAt:r,createBy:s,active:!0};l===-1?a[t].push({...u}):(console.info("manifest 文件中已经有相同版本的扩展"),a[t][l]={...u}),console.info("写入manifest内容",a),await Ri.writeJSON(o,JSON.stringify(a))}static async getExtFiles(){const e=[],t=await dn.getCurrentVersionExtPath(),i=await Ri.read2JSON(`${t}/manifest.json`);for(const r in i){const s=i[r],o=pd(i[r]||[],{active:!0});if(o===-1)return Promise.reject(`manifest 文件中未找到 ${r} 对应的激活扩展`);const a=s[o].version;e.push({extId:r,path:`${t}/${r}-V${a}/index.js`})}return Tt.info("从本地文件中获取到的扩展列表",e),e}static ext(e){for(const t of dn.exts)if(t.instanceId===e)return t;return null}static async checkShouldUpdate(e){var l;const{instanceId:t,platformVersion:i,platform:r}=e,s=dn.ext(t);if(!s)return Tt.error("检测设备扩展更新时，传入扩展ID不合法"),!1;Tt.info(`检测 ${s.id} 是否需要更新`),dn.updaterManager.getUpdater(s.config.extContentId)||dn.updaterManager.addUpdater(s.updater);const o=[{key:`${r}Version`,op:"<=",values:xj(i)},{key:"platform",op:"include",values:[r]}];Tt.info({extraFilter:o});const a=await dn.updaterManager.checkShouldUpdate(s.updater.checkOption.resId,s.version,o);return dn.updateInfo[s.id].shouldUpdate=a,(l=dn.subject)==null||l.next(dn.updateInfo[s.id]),a}static downloadExt(e){const t=dn.ext(e);return dn.updaterManager.download(t.updater.checkOption.resId,{useTimestamp:!0})}static unloadExt(e){const t=dn.ext(e);t&&(dn.exts.delete(t),t.dispose()),console.log(["=> unloadExt",dn.exts])}static unZipExt(e){const t=e.lastIndexOf("."),i=e.slice(0,t);return Ri.unzipFile(e,i)}static async updateExt(e,t,i){var r,s,o;try{const a=dn.ext(t),l=dn.updaterManager.getUpdater(a.config.extContentId),c=(r=l==null?void 0:l.checkResult)==null?void 0:r.latestVersion,u=`${await dn.getCurrentVersionExtPath()}/${a.id}-V${c}`,h=await dn.downloadExt(t);console.info("扩展下载",h);const d=await Ri.calculateMd5(h);console.info("扩展MD5",d);const f=((s=l==null?void 0:l.checkResult)==null?void 0:s.md5List)[0];if(d!==f)return Promise.reject(`检测到服务器返回的MD5${f}与计算得出的MD5${d}不一致`);const p=await dn.unZipExt(h);console.info("扩展解压",p),await Ri.copy(p,u),console.info("将扩展从临时目录复制到正式目录",p,u);const g=new Date().toUTCString();await dn.updateManifest({extName:e,extVersion:c,createAt:g,createBy:i}),console.info(`通过 ${i} 方式更新扩展成功`),dn.updateInfo[e].hasUpdate=!0}finally{(o=dn.subject)==null||o.next(dn.updateInfo[e])}}};E(dn,"$ev",new uh.EventEmitter),E(dn,"updaterManager",new Jge),E(dn,"subject",new oA),E(dn,"updateInfo",{}),E(dn,"getCurrentVersionExtPath",async()=>{let e=window.MeApi.version;return e||(e=await window.MeApi.app.getAppVersion()),`${window.MeApi.appDataPath}/exts/${e}`}),E(dn,"getExtFileById",async e=>{const t=await dn.getExtFiles();for(const i of t)if(i.extId===e){let r=i.path;const s=await window.MeApi.app.url2InterceptorUrl(r);return()=>Pi(()=>import(s),__vite__mapDeps([]),import.meta.url)}}),E(dn,"EVENTS",{CREATED:"created"}),E(dn,"exts",new Set);let Mi=dn;window.ExtManager=Mi;class UYe extends Yc{constructor(){super();E(this,"effectScope",rO(!0));this.effectScope.run(()=>{yt(()=>[ft._listenerDataChange.value,ft._currentInstanceId.value,ft._usedDevices.value],()=>{this.updateState({currentData:ft.currentData,switchDevice:ft.switchDevice})}),yt(()=>ft._usedDevices.value,()=>{this.updateState({switchDevice:ft.switchDevice})})})}createState(){return{currentData:ft.currentData,switchDevice:ft.switchDevice||[],showSwitchDeviceLoading:!1,showConnectDeviceLoading:!1}}setEventHandler(){this.registerEventHandler(LYe,this.handleSwitchDevice),this.registerEventHandler(NYe,this.handleConnectDevice),this.registerEventHandler(BYe,this.handleDisConnectDevice),this.registerEventHandler(FYe,this.handleDeleteDevice)}async handleSwitchDevice(t){this.updateState({showSwitchDeviceLoading:!0});const{instanceId:i}=t.device;try{tt.modal.cleanKeepAliveMessage();const r=await ft.loadExt(i,t.device);CJ(r.deviceInfo.snCode),this.updateState({showSwitchDeviceLoading:!1}),await ft.updateCurrentInstanceId(r)}catch(r){console.log(r)}this.updateState({showSwitchDeviceLoading:!1})}async handleConnectDevice(t){this.updateState({showConnectDeviceLoading:!0});let{instanceId:i}=Uu(t.device),r=Mi.ext(i);try{if(!r){const[o,a,l]=i.split(":");(l||l!=null)&&(i=`${o}:${a}`),r=Mi.ext(i)}const s=await ft.connectExt(r,t.device);if(!s){this.sendEffect({connectFail:{}});return}await ft.updateCurrentInstanceId(s)}catch(s){console.log(s),this.sendEffect({connectFail:{}})}finally{}this.updateState({showConnectDeviceLoading:!1})}async handleDisConnectDevice(t){let i=t.instanceId||ft.currentInstanceId;if(!Mi.ext(i)){const[s,o,a]=i.split(":");(a||a!=null)&&(i=`${s}:${o}`)}ft.updateCurrentData({instanceId:i,shouldTryConnect:!1}),ft.closeConnect(i)}async handleDeleteDevice(t){let{instanceId:i}=Uu(t.device);const[r,s,o]=i.split(":");(o||o!=null)&&(i=`${r}:${s}`);const a=await $r.removeDevice(i);t.device.instanceId&&ft.removeExt(t.device.instanceId),ft.usedDevices=a,this.updateState({switchDevice:ft.switchDevice})}onDestroy(){super.onDestroy(),this.effectScope.stop()}}var nt=(n=>(n.D1="D1",n.D1Pro="D1Pro",n.D1Pro2="D1Pro 2.0",n.S1="S1",n.M1="M1",n.M2="M2",n.P1="P1",n.P2="P2",n.F1="F1",n.F1Ultra="F1Ultra",n))(nt||{});const GYe=[{id:382,createdAt:1711538961,createdBy:0,updatedAt:1713941137,updatedBy:0,deletedAt:null,type:21,code:"S1",name:"S1",sno:1,status:"enabled",associated:{},extra:{},domain:"xcs",associatedItems:null},{id:383,createdAt:1711538972,createdBy:0,updatedAt:1713941137,updatedBy:0,deletedAt:null,type:21,code:"F1",name:"F1",sno:2,status:"enabled",associated:{},extra:{},domain:"xcs",associatedItems:null},{id:384,createdAt:1711538983,createdBy:0,updatedAt:1713941137,updatedBy:0,deletedAt:null,type:21,code:"P2",name:"P2",sno:3,status:"enabled",associated:{},extra:{},domain:"xcs",associatedItems:null},{id:385,createdAt:1711538997,createdBy:0,updatedAt:1713941137,updatedBy:0,deletedAt:null,type:21,code:"D1Pro 2.0",name:"D1Pro2",sno:4,status:"enabled",associated:{},extra:{},domain:"xcs",associatedItems:null},{id:386,createdAt:1711539009,createdBy:0,updatedAt:1713941137,updatedBy:0,deletedAt:null,type:21,code:"D1Pro",name:"D1Pro",sno:5,status:"enabled",associated:{},extra:{},domain:"xcs",associatedItems:null},{id:388,createdAt:1711539030,createdBy:0,updatedAt:1713941137,updatedBy:0,deletedAt:null,type:21,code:"D1",name:"D1",sno:6,status:"enabled",associated:{},extra:{},domain:"xcs",associatedItems:null},{id:387,createdAt:1711539019,createdBy:0,updatedAt:1713941137,updatedBy:0,deletedAt:null,type:21,code:"M1",name:"M1",sno:7,status:"enabled",associated:{},extra:{},domain:"xcs",associatedItems:null},{id:406,createdAt:1713941108,createdBy:0,updatedAt:1713941137,updatedBy:0,deletedAt:null,type:21,code:"P1",name:"P1",sno:8,status:"enabled",associated:{},extra:{},domain:"xcs",associatedItems:null}],yJ="remoteDeviceConfigKey",AJ={open:wYe,list:bYe,version:xYe},Eu={ethList:_Ye,wifiList:mYe,open:yYe,info:dN,stopList:vYe},HYe=["1a86","28e9"],VYe=["7523","018a"],zYe=230400,Zd={[ua.SERIAL]:{...AJ,detect(n){return uy(n)}},[ua.ETH]:{list:Eu.ethList,open:Eu.open,detect(n){return uy(n)}},[ua.WIFI]:{list:Eu.wifiList,open:Eu.open,detect(n){return uy(n)}},[ua.USB]:{list:Eu.ethList,open:Eu.open,detect(n){return uy(n)}}};var id,P0,Nk,cp,hy,M0,Bk,dT,bJ,fT,wJ;class $Ye{constructor(){ke(this,P0);ke(this,cp);ke(this,M0);ke(this,dT);ke(this,fT);ke(this,id,new Map)}getDevice(e){return S(this,id).get(e)}async ethList(){const e=[];try{const t=await Zd[ua.ETH].list(fYe),i=Ht(this,cp,hy).call(this,t,ua.ETH);e.push(i)}catch(t){Tt.error(t)}return e}async usbList(e){const t=await Ht(this,dT,bJ).call(this,e),i=[];for(const r of Lk){if(e.includes(r))continue;const s=await Zd[ua.USB].list(r);if(!s)continue;const o=Ht(this,cp,hy).call(this,s,ua.USB);i.push(o)}return t.concat(i)}async wifiList(e){const t=[];return await Zd.WIFI.list({...e,onDiscover:i=>{var s;const r=Ht(this,cp,hy).call(this,i,ua.WIFI);r&&((s=e==null?void 0:e.onDiscover)==null||s.call(e,r),t.push(r))}}),t}stopWifiList(){return Eu.stopList()}async ipDirectly(e,t=ua.WIFI){const i=await Eu.info(e);return i?Ht(this,cp,hy).call(this,i,t):null}async serialDirectly(e){return Ht(this,M0,Bk).call(this,e)}ports(e=[]){return Zd.SERIAL.list(t=>{const{vendorId:i,productId:r}=t;return!i&&!r||e.includes(t.path)?!1:HYe.includes(i.toLocaleLowerCase())&&VYe.includes(r.toLocaleLowerCase())})}closeConnect(e){S(this,id).forEach((t,i)=>{t&&t.hasOpen()&&mt(t.close)&&i!==e&&(t.close(),S(this,id).delete(i))})}async getUsedDevices(){return await Jx.getUsedDevices()||{}}async addDevice(e){return Jx.addDevice(e)}async getById(e,t,i=!0){let r=this.getDevice(e);if(r&&r.destroyWorker(),await this.ipDirectly(e),r=this.getDevice(e),r){let s;if(r.apiParserNext?s=r.apiParserNext(t):s=r.apiParser(t),r.apis=s,r.connectIdentity=e,!r.hasOpen()){const o=[nt.F1,nt.F1Ultra,nt.P1,nt.P2,nt.M1,nt.M2].includes(r.productData.extId);o&&e&&Op.ignorePing(!0,r.extId,e),await r.setup(i,o)}}return r}removeDevice(e){return Jx.removeDevice(e)}async getInfoByIp(e){try{const t=await Eu.info(e);if(t)return Ht(this,fT,wJ).call(this,t)}catch(t){Tt.info("getInfoByIp error",t)}}closeConnectByIp(e){const t=S(this,id).get(e);t.hasOpen()&&t.close()}}id=new WeakMap,P0=new WeakSet,Nk=function(e,t){S(this,id).set(e,t)},cp=new WeakSet,hy=function(e,t){const{version:i,ip:r,name:s}=e,o=Zd[t],a=o.detect(i);if(!a)return null;const l=o.open(r);Ht(this,P0,Nk).call(this,r,l);const u={...Bo(gd,{extId:a})||{},id:r,ip:r,connectIdentity:r,name:s,product:a,type:t,version:i};return l.productData=u,u},M0=new WeakSet,Bk=async function(e){const t=await Zd.SERIAL.open({path:e,baudRate:zYe}),i=mt(t.hasOpen)&&t.hasOpen();if(Tt.info(["=> port isOpen",i]),!i)return Promise.reject("port is not open");const[r,s]=await AJ.version(t),o=Zd.SERIAL.detect(r);if(!o)return;const a=Bo(gd,{extId:o})||{},l={id:e,port:e,name:s,product:o,version:r,type:ua.SERIAL};return Ht(this,P0,Nk).call(this,e,t),Object.assign(a,l)},dT=new WeakSet,bJ=async function(e){const t=await this.ports(e);console.log(t);const i=[];for(const r of t){const{path:s}=r,o=await Ht(this,M0,Bk).call(this,s);o&&i.push(o)}return i},fT=new WeakSet,wJ=function(e){const{ip:t,version:i,mac:r,name:s,snCode:o}=e,a=uy(i);if(!a)return;const l=Bo(pn(gd),{extId:a})||{};return Object.assign(l,{connectIdentity:t,ip:t,id:t,name:s,product:a,type:ua.WIFI,version:i,mac:r,snCode:o})};const $r=new $Ye;ME.deviceService=$r;const yP="firmwareRemind";var Lu;const _u=class _u{static get devices(){return S(_u,Lu)}static add(e){S(_u,Lu).find(i=>i.id===e.id)&&localStorage.setItem(yP,JSON.stringify(S(_u,Lu))),S(_u,Lu).push({...e,time:+new Date}),localStorage.setItem(yP,JSON.stringify(S(_u,Lu)))}static has(e){const t=S(_u,Lu).find(i=>i.id===e.id);return t?+new Date-t.time<=2592e5:!1}};Lu=new WeakMap,ke(_u,Lu,(()=>{const e=localStorage.getItem(yP);return e?JSON.parse(e):[]})());let Fk=_u;class jA{static get data(){const e=localStorage.getItem(this.KEY);if(!e)return{items:[]};try{return JSON.parse(e)}catch{return{items:[]}}}static add(e,t){const{items:i}=this.data,r=i.findIndex(s=>e.extId===s.extId);return r<0?i.push(e):Object.assign(i[r],e),localStorage.setItem(this.KEY,JSON.stringify({items:i,identity:e.id})),this.info=t,i}static get latest(){const{items:e,identity:t}=this.data;return e.find(i=>i.id===t)}static set info(e){localStorage.setItem(this.INFO_KEY,JSON.stringify(e))}static get info(){try{const e=localStorage.getItem(this.INFO_KEY);return e?JSON.parse(e):{}}catch{return{}}}static clearData(){localStorage.removeItem(this.KEY)}static checkHasConnected(e){const{items:t}=this.data;return pd(t,{product:e})!==-1}}E(jA,"KEY","CONNECTED_DEVICES"),E(jA,"INFO_KEY","LATEST_CONNECTED_DEVICE_INFO");class WYe{constructor(){E(this,"wifiDevices",new Array);E(this,"initDeviceInfoTimeout",12e3);E(this,"connectVisible",!1);E(this,"autoFocusRemainModalVisible",ee(!1));E(this,"walkBorderTipModalVisible",ee(!1));E(this,"_extChange",ee(0));E(this,"_currentInstanceId",ee(""));E(this,"_data",ee({}));E(this,"_listenerDataChange",ee(0));E(this,"_usedDevices",ee({}))}get currentInstanceId(){return this._currentInstanceId.value}set currentInstanceId(e){this._currentInstanceId.value=e}get data(){return this._data.value}set data(e){this._data.value=e}get usedDevices(){return this._usedDevices.value}set usedDevices(e){this._usedDevices.value=e}get hasProcessing(){for(const e in this.data)if(this.data[e].connected&&this.data[e].hasUploadGcode&&this.data[e].isInProcessing)return!0;return!1}get hasConnected(){for(const e in this.data)if(this.data[e].connected)return!0;return!1}get isProcessing(){var e;return((e=this.currentData)==null?void 0:e.isInProcessing)&&this.connected}get isFraming(){var i;const e=this.switchProcessStatus((i=this.currentData)==null?void 0:i.currentStatus);return[It.FRAME_READY,It.FRAME_WORKING].includes(e)&&this.connected}get switchDevice(){var t,i;const e=[];for(const r in this.usedDevices){const s=pn(this.usedDevices[r]);let o=s.power;Array.isArray(o)&&(o=o.sort((d,f)=>f-d));const a=o?`${s.instanceId}:${o.toString()}`:s.instanceId;if(!a)continue;s.instanceId=a;const[l,c]=a.split(":"),[u,h]=this.currentInstanceId.split(":");h===c&&l===u||(s.updateTime=qB(s.updateTime,"yyyy_MM_dd_HH_mm_ss",new Date).getTime(),s.connected=((t=this.data[a])==null?void 0:t.connected)||!1,s.isInProcessing=((i=this.data[a])==null?void 0:i.isInProcessing)||!1,e.push(s))}return e.sort((r,s)=>s.updateTime-r.updateTime)}get extId(){var e;return(e=this.ext)==null?void 0:e.id}get currentData(){var e,t;if(this.currentInstanceId){const i=Mi.ext(this.currentInstanceId);return{...this.data[this.currentInstanceId],guideUrl:(t=(e=i==null?void 0:i.config)==null?void 0:e.supportUrls)==null?void 0:t.guide,extId:i==null?void 0:i.id}}else return}get connectIdentity(){var e;return(e=this.currentData)==null?void 0:e.connectIdentity}get connectIdentityList(){const e=[];for(const t in this.data){const i=this.data[t];i.connected&&e.push(i.connectIdentity)}return e}get isEmptyDevice(){return Object.keys(this.data).length===0}get deviceFirmware(){var e;return((e=this.currentData)==null?void 0:e.deviceFirmware)||{}}get dataSource(){return this.currentInstanceId?fo.dataSource:null}get connected(){var e;return((e=this.currentData)==null?void 0:e.connected)||!1}get deviceInfo(){return this.currentData||{}}get ext(){return Mi.ext(this.currentInstanceId)}get showUpdateFirmware(){var o;if(!this.ext)return!1;const{show:e,shouldUpdate:t,manualCheckUpdate:i,latestVersion:r}=((o=this.currentData)==null?void 0:o.deviceFirmware)||{},s=Fk.has({id:this.extId,version:r});return!!(e&&t&&(i||s===!1))}get currentPower(){var t,i;return this.deviceInfo.power||((i=(t=this.ext)==null?void 0:t.config)==null?void 0:i.defaultPower)}getExt(e){return Mi.ext(e)}async updateUsedDevices(){const e=await($r==null?void 0:$r.getUsedDevices());this.usedDevices=e}setLastDisplayData(e){var i;const t=[];wt(e)?t.push(bn.getCanvasDisplays()):e.forEach((r,s)=>{const o=[];r.displays.forEach(({type:a,isFill:l,processingType:c,processIgnore:u},h)=>{o.push({id:h,type:a,isFill:l,processingType:c,processIgnore:u})}),t.push({id:s,mode:r.mode,displays:o,data:r.data[r.mode]||{}})}),this.dataSource&&((i=this.dataSource)==null||i.resetData(t))}async addDevice(e={},t){var s;const i=t||this.ext;if(!i)return;const r={instanceId:i.instanceId,guideUrl:i.config.supportUrls.guide,productID:i.config.productID,extId:i.id,cover:i.deviceInfo.cover,snCode:i.deviceInfo.snCode,...e};if(i.connected){const{name:o,power:a,snCode:l}=i.deviceInfo;Object.assign(r,{name:Uu(o),power:Uu(a),type:i.connectType,snCode:Uu(l),connectIdentity:(s=i.device)==null?void 0:s.connectIdentity})}if(r.instanceId.includes(":")){const[o,a]=r.instanceId.split(":");r.instanceId=`${o}:${a}`}return this.usedDevices=await $r.addDevice(Uu(r)),console.log(["=> 更新设备使用记录",r,this.usedDevices]),jA.add(r),this.usedDevices}async actionAfterActive(e,t=!0){var i;try{let r=e||this.ext;try{await this.addDevice({updateTime:Sd(new Date,"yyyy_MM_dd_HH_mm_ss")},r)}catch(o){console.log(o)}if(!r.connected&&t){const o=this.data[r.instanceId];if(!(o&&o.shouldTryConnect===!1))try{const a=r.instanceId,l=(i=this.ext)==null?void 0:i.deviceInfo;r=await this.connectExt(r,o),r.instanceId!==a&&await this.updateCurrentInstanceId(r,()=>{},()=>{this.updateCurrentData({shouldTryConnect:!1}),this.updateCurrentData({instanceId:r.instanceId,shouldTryConnect:!1}),this.closeConnect(r.instanceId),r.deviceInfo=l},!0,tt.appType===ps.Pad)}catch(a){throw console.log(a),console.log("触发重连"),this.tryToConnectExt(r),new Error(a)}}const{shouldCheckFirmware:s=!0}=(r==null?void 0:r.config)||{};r.connected&&(s&&(Tt.info("自动检测固件更新 isFirmwareUpdating",bn.isFirmwareUpdating()),!bn.isFirmwareUpdating()&&!r.hasCheckFrimwareUpdate&&(await bn.checkUpdateFirmware(r),r.hasCheckFrimwareUpdate=!0)),this.currentInstanceId===r.instanceId&&r.refreshBg&&r.refreshBg(),r.deviceInfo.power||r.appContext.showMessage({type:"info",options:{keepAliveOnHover:!0,duration:5e3,uniqueId:"unrecognizedPower"},render:{textI18nKey:"device.list.unrecognized_power",link:{labelI18nKey:"device.process.how_to_resolve",href:"https://s.xtool.com/doc/device/connect-fail",onClick:()=>{window.MeApi.openNative.openWebInApp("https://s.xtool.com/doc/device/connect-fail")}}}})),Ro.clearErrorIgnoreList(),await this.addDevice({updateTime:Sd(new Date,"yyyy_MM_dd_HH_mm_ss")},r)}catch(r){console.error("actionAfterActive",r)}}async wifiList(e){this.wifiDevices=new Array;try{await this.stopWifiList(),await $r.wifiList({useGateway:!0,onDiscover:t=>{!this.wifiDevices.some(i=>i.ip===t.ip)&&t.product&&(console.log("[通过wifi搜索到的设备]=>",t),this.wifiDevices.push(t),e(this.wifiDevices,t))}})}catch(t){console.log(["=> findDeviceByWifi"],t)}finally{}return this.wifiDevices}stopWifiList(){return this.wifiDevices=new Array,$r.stopWifiList()}isAutoUpdateDeviceExt(){return bn.isAutoUpdateDeviceExt()}async updateCurrentInstanceId(e,t=()=>{},i=()=>{},r=!0,s=!0,o=!0){var m,v;if(!e)return;const a=e==null?void 0:e.instanceId,{extId:l,power:c}=((m=this.data)==null?void 0:m[a])||{},{extId:u,power:h}=((v=this.data)==null?void 0:v[this.currentInstanceId])||{},d=u!==l&&!!u,f=Rt(c)?Fl(Wa(c),Wa(h)):c===h||h===0,p=u&&!f&&!d,g=async()=>{var y,A;console.log("=> confirm"),(A=(y=bn.getCanvasManager().canvas)==null?void 0:y.clearSelected)==null||A.call(y),bn.setMaterialPower(10),Rt(c)&&bn.setLaserSource("blue");const{projectData:_}=fo.dataSource??{};if(fo.dataSource?fo.update(e):fo.init(e,bn.getCanvasManager()),_&&(d||p)&&this.setLastDisplayData(_),Y_.visible=!1,bn.cleanCanvasBackdrop(),d||!u)try{const w=this.isAutoUpdateDeviceExt();let b="";try{b=await window.MeApi.app.getAppVersion()}catch(C){console.log(C)}Mi.checkShouldUpdate({instanceId:a,platformVersion:b,platform:vM()}).then(C=>{const I=this.data[a].extId,x=Mi.updateInfo[I];w&&C&&!(x!=null&&x.hasUpdate)&&this.updateExt(I,a,XO.AUTO)})}catch(w){console.error("检测是否需要更新扩展出错",w)}(d||p)&&bn.unRegisterPluginByType(qge),this.currentInstanceId=a,!u&&r===!0&&this.setLastDisplayData(_),e.taskManager.currentInstanceId=a,bn.addProcess(a),YP({...e==null?void 0:e.deviceInfo}),this.actionAfterActive(e,o)};if((d||p)&&s){Y_.type=d?"extId":"power";let _,y;Y_.handler={confirm:async()=>{t(),_(),await g()},cancel:async()=>{var w;if(i(),Y_.visible=!1,y(),!this.getExt(this.currentInstanceId)){const b=((w=this.data)==null?void 0:w[this.currentInstanceId])||{};await this.loadExt(this.currentInstanceId,b),this.data[this.currentInstanceId]&&(this.data[this.currentInstanceId].shouldTryConnect=!1)}}},Y_.visible=!0,await new Promise((A,w)=>{_=A,y=w})}else await g(),t()}updateTabInfo(e){console.log(e)}async tryToConnectExt(e){const t=e.instanceId,[i,r]=t.split(":"),s=(this.usedDevices||{})[`${i}:${r}`];console.log(["=> tryToConnectExt",s]);const{type:o,connectIdentity:a}=s||{};if(o&&a){const l=()=>{var h,d;const u=e.connected||t!==this.currentInstanceId||this.connectVisible===!0||this.showUpdateFirmware||((h=this.data[e.instanceId])==null?void 0:h.shouldTryConnect)===!1;return console.log(["=> tryToConnectExt until",{instanceId:t,curr:this.currentInstanceId,connectVisible:this.connectVisible,connected:e.connected,shouldTryConnect:(d=this.data[e.instanceId])==null?void 0:d.shouldTryConnect}]),u};await bge(async()=>{var f;if(await l()||!await Op.requestNetPermission())return;const d=e.instanceId===this.currentInstanceId;try{const p=(f=this.ext)==null?void 0:f.deviceInfo,g=await this.connectExt(e,{type:o,connectIdentity:a});e=g,d&&this.updateCurrentInstanceId(g,()=>{},()=>{this.updateCurrentData({shouldTryConnect:!1}),this.updateCurrentData({instanceId:e.instanceId,shouldTryConnect:!1}),this.closeConnect(e.instanceId),e.deviceInfo=p},!0,tt.appType==ps.Pad),g.instanceId===e.instanceId&&await this.actionAfterActive(g)}catch(p){console.error(["=> retry connectExt error",p])}},{maxTry:11,delay:6e3,until:l})}}async updateExt(e,t,i,r){try{await Mi.updateExt(e,t,i),tt.modal.showHasNewExtDialog(e)}catch(s){const{name:o,message:a}=s||{};console.error(`更新扩展出现错误 ${a}`);const l=o===gy.NETWORK_DISCONNECT?"common.msg.driver_download_fail":"device.setting.upload_ext_fail";console.error(`${i}更新插件失败`,a),tt.modal.showToast({msg:l,icon:"error"})}finally{r&&mt(r)&&r()}}updateCurrentData(e){var g,m,v;const t=e.instanceId||this.currentInstanceId,i=Mi.ext(t);if(!t||!i){Tt.info("updateCurrentData",e,this.currentInstanceId);return}const r=i.instanceId,s=this.data[r],{currentStatus:o}=s??{};e.isInProcessing=i==null?void 0:i.isInProcessing,e.hasUploadGcode=i.hasUploadGcode,i.deviceInfo.snCode&&this.data[i.id]&&delete this.data[i.id];const{name:a,snCode:l,power:c,currentStatus:u}=e;if(u!=It.DISCONNECT&&(l&&l.indexOf("AxiosError")>=0||a&&a.indexOf("AxiosError")>=0)){$r.closeConnectByIp(e.connectIdentity),this.setDeviceDataDisconnect(e.connectIdentity),!this.ext&&e.instanceId&&(this.currentInstanceId=e.instanceId);return}const h=e.name;h&&h.indexOf("AxiosError")>=0&&(e.name=(m=(g=this.ext)==null?void 0:g.appContext)==null?void 0:m.formatMsg("device.list.unknown")),s?i.id==="M2"?this.data[r]=Object.assign(s,e):this.data[r]=Ln(s,e):this.data[r]=e;let d=e.currentStatus;const{processingStateMap:f={}}=(v=i.config)==null?void 0:v.process;wt(f)||(d=f[d]||d);const p=bn.shouldResumeProcessing(t);if(p){const{shouldResume:_}=p;_&&(i.hasUploadGcode=!0)}o!==e.currentStatus&&i.hasUploadGcode&&(i!=null&&i.handleProcessingTaskStatus&&(d=i==null?void 0:i.handleProcessingTaskStatus(d)),i==null||i.generateProcessingTask(d).then(()=>{[It.CANCEL_PROCESS,It.FINISH_PROCESS].includes(d)&&(i.hasUploadGcode=!1)}),i==null||i.pushProcessingStatusToMessageCenter(d)),i.hasUploadGcode&&bn.toggleTimer(t,e.currentStatus),this.notifyDataChange()}notifyDataChange(){this._listenerDataChange.value++,this._listenerDataChange.value>6500&&(this._listenerDataChange.value=0)}async loadExt(e,t={}){if(t=eb(t,"shouldTryConnect","connected","updateTime","isInProcessing","cover"),Mi.ext(e))return Mi.ext(e);const i=e.split(":").shift(),r=new eYe,s=await Mi.load(i,r);return s.deviceInfo=t,s.on("connected",async()=>{aS==null||aS({action:"messageCenterTopicDevice",payload:{id:s.id,productID:s.config.productID,snCode:s.deviceInfo.snCode}}),await this.addDevice({},s)}),s.on("disconnect",async()=>{var o;console.log("disconnect=========>",s.instanceId),s.instanceId===this.currentInstanceId&&((o=this.currentData)!=null&&o.connected)&&tt.modal.showDisconnectTip(),this.updateCurrentData({instanceId:s.instanceId,connected:!1,wifiConnect:!1,isInProcessing:!1,currentStatus:It.DISCONNECT}),bn.pauseTimer(e),await this.tryToConnectExt(s)}),s.on("error",o=>{if(s.instanceId===this.currentInstanceId){const a=pn(o);Ro.insertDeviceError(a)}console.log("收到错误消息",o)}),this.updateCurrentData({extId:s.id,connectIdentity:"",...s.deviceInfo,connected:!1,wifiConnect:!1,shouldTryConnect:!0,guideUrl:s.config.supportUrls.guide,instanceId:s.instanceId}),fo.dataSource?fo.update(s):fo.init(s,bn.getCanvasManager()),s.canvasId=bn.canvasId,s.uiAppRenderKey=new Date().getTime(),bn.addProcess(s.instanceId),s}removeExt(e){Mi.unloadExt(e),bn.removeProcess(e),Reflect.deleteProperty(this.data,e)}async loadExtByInfo(e){const{connectIdentity:t,type:i}=e,r=await this.loadExt(e.extId);return this.connectExt(r,{connectIdentity:t,type:i})}notifyExtChange(){this._extChange.value++,this._extChange.value>=1e3&&(this._extChange.value=1)}async connectExt(e,t,i=!1){var s,o,a;let r;try{e.deviceInfo={version:t.version};let l=!0;e.deviceInfo.version&&e.useSocket===!1&&(l=!1);let{type:c,connectIdentity:u}=t;if(c||(c=ja.WIFI),!u)return e;const h=(s=e.deviceInfo)==null?void 0:s.snCode;if(r=await($r==null?void 0:$r.getById(u,e.getProtocolConfig(c),l)),!e||!r)throw new Error("ext or device is not load");const{extId:d}=r.productData||{},f=e.deviceInfo.power;i&&(e=await this.loadExt(d)),this.bindDeviceToExt(r,e),d!==e.id&&(console.log("连接扩展ID不同",d,e.id,"=> 连接扩展ID不同"),r=await($r==null?void 0:$r.getById(u,e.getProtocolConfig(c),l)),this.bindDeviceToExt(r,e));const p=pn(e.deviceInfo);let g=await gk.waitUntilAsync(()=>e.init(r,c),this.initDeviceInfoTimeout)??{};if(((a=(o=g.info)==null?void 0:o.power)==null?void 0:a.toString())!==(f==null?void 0:f.toString())&&(e.deviceInfo=p,console.log("连接扩展功率不同",d,g.info,"=> 连接扩展功率不同"),g=await gk.waitUntilAsync(()=>e.init(r,c),this.initDeviceInfoTimeout)),Mi.getCountByInstanceId(e.instanceId)>1){console.log("已经存在同硬件设备实例，删除之前的实例",e.instanceId);for(const y of Mi.exts){const A=y.deviceInfo.connectIdentity,w=y.instanceId;(A===e.deviceInfo.connectIdentity||w===e.instanceId)&&y.id===e.id&&y!==e&&(Mi.exts.delete(y),y.removeAllListeners(),y.dispose())}}else bn.addProcess(e.instanceId);const m={...t,...e.info,...g.info,extId:e.id,currentStatus:e.info.currentStatus,ip:u};this.bindDeviceToExt(r,e);const{name:v,snCode:_}=e.deviceInfo;if(console.log(`name =${v}&snCode =${_}`),!v||v&&v.indexOf("AxiosError")>=0)throw new Error("Name get Error");if(!_||_&&_.indexOf("AxiosError")>=0)throw new Error("Name get Error");if(_&&h&&h!==_&&!(h&&h.indexOf("AxiosError")>=0))throw e.deviceInfo.snCode=h,new Error("Sncode is change");return this.updateCurrentData({...m,type:t.type,instanceId:e.instanceId,connectIdentity:r.connectIdentity,connected:!0,extId:e.id,shouldTryConnect:!0,wifiConnect:!0}),e.connected=!0,e.emit(e.LIFECYCLE.CONNECTED,e),jt(Zt.connectDevice,{result:"success",extId:e.id,connectType:_E.getInstance().connectType}),CJ(e.deviceInfo.snCode),this.notifyExtChange(),console.log(e.deviceInfo),e}catch(l){throw console.log(l),jt(Zt.connectDevice,{result:"fail",failReason:l.toString(),extId:e.id,connectType:_E.getInstance().connectType}),r==null||r.destroyWorker(),this.notifyDataChange(),new Error(`connectExt error ${l}`)}}bindDeviceToExt(e,t){console.log("bindDeviceToExt=",t==null?void 0:t.instanceId),e.removeAllListeners(),e.setMsgCallback(t.deviceCmdParsing.bind(t)),e.setDisconnectCallback(()=>{t.emit("disconnect"),console.log("监听到设备断连",e.connectIdentity)})}closeConnect(e){var r,s,o,a;if(!e||!this.data[e])return;this.updateCurrentData({instanceId:e,shouldTryConnect:!1});const t=this.data[e].connectIdentity,i=this.data[e].connected;if(console.log("closeConnect=========>",e,t,i),t&&i)(s=(r=Mi.ext(e))==null?void 0:r.device)==null||s.close();else{const l=Mi.ext(e);(((o=l==null?void 0:l.device)==null?void 0:o.hasOpen())||!1)&&((a=l==null?void 0:l.device)==null||a.close())}this.checkDeviceConnectStatus(t)}async closeAndRemoveDevice(e){var o,a;let t=e;if(!t)return;const[i,r,s]=t.split(":");if((s||s!==void 0)&&(t=`${i}:${r}`),this.updateCurrentData({instanceId:e,shouldTryConnect:!1}),this.closeConnect(e),this.usedDevices=await $r.removeDevice(t),this.removeExt(e),tt.appType==ps.App){const l=((a=(o=this.getExt(e))==null?void 0:o.deviceInfo)==null?void 0:a.ip)||void 0;l&&$r.closeConnect(l)}}async openLocalExt(e){try{const t=await Mi.addExtFile(e);Mi.unloadExt(t),await this.loadExt(t),tt.modal.showToast({icon:"success",msg:"device.common.ext_updated_tip",params:{deviceName:t},duration:3e3})}catch(t){console.log(t),tt.modal.showToast({msg:"device.setting.upload_ext_fail",icon:"error"})}}async loadOpenProjectExt(e,t){if(!e)return{ext:this.ext,isPowerChange:!1};const i=this.usedDevices,r=[];for(const l in i){const c=i[l],[u]=l.split(":");u===e&&c.snCode&&r.push({...i[l],updateTime:qB(c.updateTime,"yyyy_MM_dd_HH_mm_ss",new Date).getTime()})}let s=!1;r.sort((l,c)=>c.updateTime-l.updateTime);const o=pn(r[0]);if(t&&o&&t!=o.power&&(s=!0,o.power=t),o!=null&&o.instanceId){Array.isArray(t)&&(t=t.sort((u,h)=>h-u));const l=t?`${o.instanceId}:${t.toString()}`:o.instanceId,c=this.getExt(l);if(c)return{ext:c,isPowerChange:s}}return{ext:await this.loadExt(e,o),isPowerChange:s}}async loadOpenProjectExtByExtId(e){return e?e===this.extId?{ext:this.ext,isPowerChange:!1}:{ext:await this.loadExt(e),isPowerChange:!1}:{ext:this.ext,isPowerChange:!1}}async changeDevice(e){const t=await this.loadExt(e);await this.updateCurrentInstanceId(t)}async reconnectDevice(e,t=!1){let i=Mi.ext(e);const r=this.data[e];return r.connected||(i=await this.connectExt(i,r,t),i&&i.instanceId===this.currentInstanceId&&this.actionAfterActive(i,!1)),i}async checkCloseOneDeviceConnect(e,t){const i=e.instanceId;if(tt.appType===ps.App&&i&&e.id!==t.id){this.updateCurrentData({instanceId:i,shouldTryConnect:!1}),this.closeConnect(i);const[s,o,a]=i.split(":");let l=i;(a||a!==void 0)&&(l=`${s}:${o}`),this.usedDevices=await $r.removeDevice(l),this.removeExt(i)}}getConnectDevice(e){for(const t in this.data){const i=this.data[t];if(i.connectIdentity===e&&i.connected)return this.getExt(i.instanceId)}return null}checkDeviceConnectStatus(e){var t,i;for(const r in this.data){const s=this.data[r];if(s.connectIdentity===e){const o=this.getExt(s.instanceId);if(!s.connected)continue;o&&!((i=(t=o==null?void 0:o.device)==null?void 0:t.hasOpen)!=null&&i.call(t))&&s.connected&&(o==null||o.emit("disconnect"))}}this.notifyDataChange()}switchProcessStatus(e){var r,s;if(!e)return It.IDLE;const{processingStateMap:t={}}=((s=(r=this.ext)==null?void 0:r.config)==null?void 0:s.process)||{};let i=It.IDLE;return wt(t)||e===It.DISCONNECT?i=e:i=t[e],i}getConnectedProductId(){const e=[],t=jA.data;if(!t||!t.items)return e;for(const i of t.items){const r=i;r.snCode&&r.productID&&e.push(r.productID)}return e}setDeviceDataDisconnect(e){for(const t in this.data){const i=this.data[t];i.connectIdentity===e&&(i.connected=!1,i.currentStatus=It.IDLE)}this.notifyDataChange()}}const ft=new WYe;window.ME.deviceManager=ft;var Zt=(n=>(n.application="application",n.buttonClick="buttonClick",n.addProjectClick="addProjectClick",n.dialogShow="dialogShow",n.slideAdjust="slideAdjust",n.filter="filter",n.loginResult="loginResult",n.softwareStart="softwareStart",n.softwareQuit="softwareQuit",n.imageEditResult="imageEditResult",n.imageFilterResult="imageFilterResult",n.imageAdjustResult="imageAdjustResult",n.imageTraceResult="imageTraceResult",n.imageOutlineResult="imageOutlineResult",n.layerAction="layerAction",n.paste="paste",n.booleanOperation="booleanOperation",n.getOsDetailInfo="getOsDetailInfo",n.bannerExposure="bannerExposure",n.bannerClick="bannerClick",n.caseExposure="caseExposure",n.caseClick="caseClick",n.switch="switch",n.input="input",n.adjustSetting="adjustSetting",n.helpClick="helpClick",n.editorFunctionUsed="editorFunctionUsed",n.bottomToolClick="bottomToolClick",n.doubleFingersClick="doubleFingersClick",n.inputBox="inputBox",n.paramScheme="paramScheme",n.maskAdjust="maskAdjust",n.textEdit="textEdit",n.weldFont="weldFont",n.textPositionEdit="textPositionEdit",n.edit="edit",n.enterCloud="enterCloud",n.popCloud="popCloud",n.uploadCloud="uploadCloud",n.downloadCloud="downloadCloud",n.renameCloud="renameCloud",n.deleteCloud="deleteCloud",n.clickFileCloud="clickFileCloud",n.importProject="importProject",n.importFile="importFile",n.saveProject="saveProject",n.setSnapping="setSnapping",n.getContextInfo="getContextInfo",n.taskList="taskList",n.getFireLevel="getFireLevel",n.connectDevice="connectDevice",n.drawBorder="drawBorder",n.startProcess="startProcess",n.uploadGCode="uploadGCode",n.deviceException="deviceException",n.processingResult="processingResult",n.processAreaAxis="processAreaAxis",n.changeFlameAlarm="changeFlameAlarm",n.setFire="setFire",n.setFireLevel="setFireLevel",n.changePositionMode="changePositionMode",n.exportGCode="exportGCode",n.importGCode="importGCode",n.setMoveStop="setMoveStop",n.setLimitSwitch="setLimitSwitch",n.canvasRename="canvasRename",n.canvasAction="canvasAction",n.layerSelected="layerSelected",n.connectNetwork="connectNetwork",n.inputEdit="inputEdit",n))(Zt||{});const jt=(n,e)=>{var i,r,s,o,a;const t=JSON.stringify(e);console.log("sensorsTrack",n,t),console.log("deviceManager.currentData",ft.currentData),(i=ft.currentData)!=null&&i.connected&&((s=(r=ft.currentData)==null?void 0:r.info)==null?void 0:s.ip)===u7e?(o=window.MeApi)==null||o.database.insertSensorEventInfo({id:Gp(),eventName:n,jsonData:t}):(a=window.sensors)==null||a.track(n,e)},jYe=async()=>{var t,i,r;qYe();const n=await((t=window.MeApi)==null?void 0:t.openNative.isNetConnection()),e=await((i=window.MeApi)==null?void 0:i.database.getAllSensorEventInfo());console.log("有网络没：%s，本地缓存的所有神策事件%s",n,JSON.stringify(e)),e&&n&&(e.forEach(s=>{setTimeout(()=>{var o;(o=window.sensors)==null||o.track(s.eventName,JSON.parse(s.jsonData))},200)}),await((r=window.MeApi)==null?void 0:r.database.deleteAllSensorEventInfo()))},QYe="$identity_login_id",xJ="identity_SN",XYe=(n,e)=>{var t,i;(t=window==null?void 0:window.sensors)==null||t.loginWithKey(QYe,n),e&&((i=window==null?void 0:window.sensors)==null||i.bind(xJ,e))},YYe=()=>{var n;(n=window.sensors)==null||n.logout()},CJ=n=>{var e;(e=window.sensors)==null||e.bind(xJ,n)},qYe=async()=>{var e;const n=await((e=window.MeApi)==null?void 0:e.getOsPlatform());jt(Zt.getOsDetailInfo,{OS:n})};var ki=(n=>(n.guideFirst="guideFirst",n.skipGuide="skipGuide",n.confirm="confirm",n.complete="complete",n.brush="brush",n.brushSize="brushSize",n.eraser="eraser",n.eraserSize="eraserSize",n.play="play",n.processPreviewPlayButton="processPreviewPlayButton",n.gear="gear",n.postion="postion",n.home="home",n.mySpace="my-space",n.xToolProjects="xToolProjects",n.setting="setting",n.smb="SMB",n.addProject="addProject",n.newProject="newProject",n.camera="camera",n.image="image",n.file="file",n.xcsFile="xcsFile",n.seeMore="seeMore",n.helpCenter="helpCenter",n.newbieGuide="newbieGuide",n.canvasName="canvasName",n.layerEntrance="layerEntrance",n.xMenu="x-Menu",n.newConstruction="newConstruction",n.openProject="openProject",n.renameProject="renameProject",n.open="open",n.remove="remove",n.save="save",n.viewGestureGuidelines="viewGestureGuidelines",n.elementClick="element-Click",n.copy="copy",n.paste="paste",n.delete="delete",n.cut="cut",n.lockUnlock="lockUnlock",n.showHide="showHide",n.moveTo="moveTo",n.noElementClick="noElement-Click",n.selectAll="selectAll",n.enlarge="enlarge",n.shrink="shrink",n.topLevel="topLevel",n.nextFloor="nextFloor",n.upperFloor="upperFloor",n.underFloor="underFloor",n.group="group",n.unGroup="unGroup",n.alignment="alignment",n.leftAlignment="leftAlignment",n.rightAlignment="rightAlignment",n.centerAlignment="centerAlignment",n.horizonCenter="horizonCenter",n.verticalCenter="verticalCenter",n.topAlignment="topAlignment",n.bottomAlignment="bottomAlignment",n.horizonDistribution="horizonDistribution",n.verticalDistribution="verticalDistribution",n.horizonFlip="horizonFlip",n.verticalFlip="verticalFlip",n.imageEdit="imageEdit",n.filter="filter",n.imageAdjust="imageAdjust",n.imageTrace="imageTrace",n.imageOutline="imageOutline",n.createMask="createMask",n.releaseMask="releaseMask",n.straightPoint="straightPoint",n.symmetricalPoint="symmetricalPoint",n.asymmetricalPoint="asymmetricalPoint",n.anchorSymmetricalPoint="anchorSymmetricalPoint",n.done="done",n.plusMore="plusMore",n.parameterPanel="parameterPanel",n.recommend="recommend",n.paramMatrix="paramMatrix",n.referDiagram="referDiagram",n.liner="liner",n.radial="radial",n.param="param",n.qrCode="qrCode",n.extract="extract",n.share="share",n.uploadToSpace="uploadToSpace",n.quickCopy="quickCopy",n.rename="rename",n.account="account",n.points="points",n.safety="safety",n.shop="shop",n.localFiles="localFiles",n.myHomePage="myHomePage",n.photoAlignment="photoAlignment",n.text="text",n.shapeList="shapeList",n.graffiti="graffiti",n.layer="layer",n.arrange="arrange",n.canvas="canvas",n.align="align",n.flip="flip",n.layerMove="layerMove",n.position="position",n.size="size",n.angle="angle",n.font="font",n.fontWeld="fontWeld",n.switching="switching",n.return="return",n.wifi="wifi",n.hotspot="hotspot",n.deviceNotFound="deviceNotFound",n.configWifi="configWifi",n.refresh="refresh",n.notYet="notYet",n.gotoSetting="gotoSetting",n.next="next",n.addDeviceNext="addDeviceNext",n.addDeviceConfirm="addDeviceConfirm",n.hotspotNext="hotspotNext",n.gps="gps",n.locationAccess="locationAccess",n.precisePositioning="precisePositioning",n.supportDevice="supportDevice",n.setWifi="setWifi",n.cancel="cancel",n.retry="retry",n.restart="restart",n.targetGotIt="targetGotIt",n.gotIt="gotIt",n.hotspotGotIt="hotspotGotIt",n.gotoConnect="gotoConnect",n.switch="switch",n.deviceRename="deviceRename",n.checkUpdate="checkUpdate",n.instruction="instruction",n.lightBright="lightBright",n.fanOperation="fanOperation",n.airPurifierOperation="airPurifierOperation",n.minimumLightPower="minimumLightPower",n.processingExhaustTime="processingExhaustTime",n.airPumpEngrave="airPumpEngrave",n.airPumpCut="airPumpCut",n.minimumOutputPower="minimumOutputPower",n))(ki||{});const Sf=class Sf{constructor(){E(this,"_connectType",eK.wifi)}static getInstance(){return Sf.instance||(Sf.instance=new Sf),Sf.instance}get connectType(){return this._connectType}set connectType(e){this._connectType=e}};E(Sf,"instance");let _E=Sf,KYe=class{getCanvasJson(){return fn().toJson()}getExt(){return bt().ext}async loadOpenProjectExtByExtId(e,t){return bt().loadOpenProjectExtByExtId(e,t)}async loadOpenProjectExtByInstanceId(e){return bt().loadOpenProjectExtByInstanceId(e)}async loadCanvas(e){return fn().loadCanvas(e)}async loadResToCanvas(e){return fn().loadResToCanvas({file:e})}getMaterialList(){return el().getMaterialList}importProjectMaterial(e){el().importProjectMaterial(e)}extId(){var e;return((e=bt().ext)==null?void 0:e.id)||""}currentInstanceId(){return bt().currentInstanceId||""}getCurrentCanvasId(){return fn().canvasId}updateDasourceCanvasId(e){const t=bt().dataSource;t&&(t.canvasId=e)}isSelectModel(){return fn().isSelectMode()}projectRemove(e){return fn().projectRemove(e)}clearAllElement(){fn().clearAllElement()}getAllCanvasIdList(){return fn().allCurrentIds()}updateTaskList(e,t){return ha().updateTaskList(e,t)}getCurrentDevicePower(){const e=bt().currentPower;if(!e)return"";const t=this.extId();return`${t}`.startsWith("F")||`${t}`.startsWith("P")||e<=0?"":`${bt().currentPower}`}getProcessingParamList(){return Hc().getProcessingParamList()}};const _n=new KYe;class JYe{constructor(e){this.selfOptions=e||{},this.pipes={}}options(e){return e&&(this.selfOptions=e),this.selfOptions}pipe(e,t){let i=t;if(typeof e=="string"){if(typeof i>"u")return this.pipes[e];this.pipes[e]=i}if(e&&e.name){if(i=e,i.processor===this)return i;this.pipes[i.name]=i}return i.processor=this,i}process(e,t){let i=e;i.options=this.options();let r=t||e.pipe||"default",s;for(;r;)typeof i.nextAfterChildren<"u"&&(i.next=i.nextAfterChildren,i.nextAfterChildren=null),typeof r=="string"&&(r=this.pipe(r)),r.process(i),s=r,r=null,i&&i.next&&(i=i.next,r=i.pipe||s);return i.hasResult?i.result:void 0}}class AP{constructor(e){this.name=e,this.filters=[]}process(e){if(!this.processor)throw new Error("add this pipe to a processor before using it");const t=this.debug,i=this.filters.length,r=e;for(let s=0;s<i;s++){const o=this.filters[s];if(t&&this.log(`filter: ${o.filterName}`),o(r),typeof r=="object"&&r.exiting){r.exiting=!1;break}}!r.next&&this.resultCheck&&this.resultCheck(r)}log(e){console.log(`[jsondiffpatch] ${this.name} pipe, ${e}`)}append(...e){return this.filters.push(...e),this}prepend(...e){return this.filters.unshift(...e),this}indexOf(e){if(!e)throw new Error("a filter name is required");for(let t=0;t<this.filters.length;t++)if(this.filters[t].filterName===e)return t;throw new Error(`filter not found: ${e}`)}list(){return this.filters.map(e=>e.filterName)}after(e,...t){const i=this.indexOf(e);return this.filters.splice(i+1,0,...t),this}before(e,...t){const i=this.indexOf(e);return this.filters.splice(i,0,...t),this}replace(e,...t){const i=this.indexOf(e);return this.filters.splice(i,1,...t),this}remove(e){const t=this.indexOf(e);return this.filters.splice(t,1),this}clear(){return this.filters.length=0,this}shouldHaveResult(e){if(e===!1){this.resultCheck=null;return}if(!this.resultCheck)return this.resultCheck=t=>{if(!t.hasResult){console.log(t);const i=new Error(`${this.name} failed`);throw i.noResult=!0,i}},this}}class fN{setResult(e){return this.result=e,this.hasResult=!0,this}exit(){return this.exiting=!0,this}push(e,t){return e.parent=this,typeof t<"u"&&(e.childName=t),e.root=this.root||this,e.options=e.options||this.options,this.children?(this.children[this.children.length-1].next=e,this.children.push(e)):(this.children=[e],this.nextAfterChildren=this.next||null,this.next=e),e.next=this,this}}function ZYe(n){const e=/^\/(.*)\/([gimyu]*)$/.exec(n.toString());return new RegExp(e[1],e[2])}function yE(n){if(typeof n!="object")return n;if(n===null)return null;if(Array.isArray(n))return n.map(yE);if(n instanceof Date)return new Date(n.getTime());if(n instanceof RegExp)return ZYe(n);const e={};for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=yE(n[t]));return e}class Of extends fN{constructor(e,t){super(),this.left=e,this.right=t,this.pipe="diff"}setResult(e){if(this.options.cloneDiffValues&&typeof e=="object"){const t=typeof this.options.cloneDiffValues=="function"?this.options.cloneDiffValues:yE;typeof e[0]=="object"&&(e[0]=t(e[0])),typeof e[1]=="object"&&(e[1]=t(e[1]))}return super.setResult(e)}}class pN extends fN{constructor(e,t){super(),this.left=e,this.delta=t,this.pipe="patch"}}class gN extends fN{constructor(e){super(),this.delta=e,this.pipe="reverse"}}const EJ=function(e){if(e.left===e.right){e.setResult(void 0).exit();return}if(typeof e.left>"u"){if(typeof e.right=="function")throw new Error("functions are not supported");e.setResult([e.right]).exit();return}if(typeof e.right>"u"){e.setResult([e.left,0,0]).exit();return}if(typeof e.left=="function"||typeof e.right=="function")throw new Error("functions are not supported");if(e.leftType=e.left===null?"null":typeof e.left,e.rightType=e.right===null?"null":typeof e.right,e.leftType!==e.rightType){e.setResult([e.left,e.right]).exit();return}if(e.leftType==="boolean"||e.leftType==="number"){e.setResult([e.left,e.right]).exit();return}if(e.leftType==="object"&&(e.leftIsArray=Array.isArray(e.left)),e.rightType==="object"&&(e.rightIsArray=Array.isArray(e.right)),e.leftIsArray!==e.rightIsArray){e.setResult([e.left,e.right]).exit();return}e.left instanceof RegExp&&(e.right instanceof RegExp?e.setResult([e.left.toString(),e.right.toString()]).exit():e.setResult([e.left,e.right]).exit())};EJ.filterName="trivial";const TJ=function(e){if(typeof e.delta>"u"){e.setResult(e.left).exit();return}if(e.nested=!Array.isArray(e.delta),e.nested)return;const t=e.delta;if(t.length===1){e.setResult(t[0]).exit();return}if(t.length===2){if(e.left instanceof RegExp){const i=/^\/(.*)\/([gimyu]+)$/.exec(t[1]);if(i){e.setResult(new RegExp(i[1],i[2])).exit();return}}e.setResult(t[1]).exit();return}t.length===3&&t[2]===0&&e.setResult(void 0).exit()};TJ.filterName="trivial";const IJ=function(e){if(typeof e.delta>"u"){e.setResult(e.delta).exit();return}if(e.nested=!Array.isArray(e.delta),e.nested)return;const t=e.delta;if(t.length===1){e.setResult([t[0],0,0]).exit();return}if(t.length===2){e.setResult([t[1],t[0]]).exit();return}t.length===3&&t[2]===0&&e.setResult([t[0]]).exit()};IJ.filterName="trivial";const SJ=n=>{if(!n||!n.children)return;const e=n.children.length;let t,i=n.result;for(let r=0;r<e;r++)t=n.children[r],!(typeof t.result>"u")&&(i=i||{},i[t.childName]=t.result);i&&n.leftIsArray&&(i._t="a"),n.setResult(i).exit()};SJ.filterName="collectChildren";const PJ=n=>{if(n.leftIsArray||n.leftType!=="object")return;const e=n.left,t=n.right;let i,r;const s=n.options.propertyFilter;for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s&&!s(i,n)||(r=new Of(e[i],t[i]),n.push(r,i)));for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s&&!s(i,n)||typeof e[i]>"u"&&(r=new Of(void 0,t[i]),n.push(r,i)));if(!n.children||n.children.length===0){n.setResult(void 0).exit();return}n.exit()};PJ.filterName="objects";const MJ=function(e){if(!e.nested)return;const t=e.delta;if(t._t)return;const i=t;let r,s;for(r in i)s=new pN(e.left[r],i[r]),e.push(s,r);e.exit()};MJ.filterName="objects";const RJ=function(e){if(!e||!e.children||e.delta._t)return;const i=e.left,r=e.children.length;let s;for(let o=0;o<r;o++){s=e.children[o];const a=s.childName;Object.prototype.hasOwnProperty.call(e.left,a)&&s.result===void 0?delete i[a]:i[a]!==s.result&&(i[a]=s.result)}e.setResult(i).exit()};RJ.filterName="collectChildren";const DJ=function(e){if(!e.nested||e.delta._t)return;const i=e.delta;let r,s;for(r in i)s=new gN(i[r]),e.push(s,r);e.exit()};DJ.filterName="objects";const kJ=n=>{if(!n||!n.children||n.delta._t)return;const t=n.children.length;let i;const r={};for(let s=0;s<t;s++){i=n.children[s];const o=i.childName;r[o]!==i.result&&(r[o]=i.result)}n.setResult(r).exit()};kJ.filterName="collectChildren";const e9e=function(n,e,t,i){return n[t]===e[i]},t9e=function(n,e,t,i){const r=n.length,s=e.length;let o,a;const l=new Array(r+1);for(o=0;o<r+1;o++)for(l[o]=new Array(s+1),a=0;a<s+1;a++)l[o][a]=0;for(l.match=t,o=1;o<r+1;o++)for(a=1;a<s+1;a++)t(n,e,o-1,a-1,i)?l[o][a]=l[o-1][a-1]+1:l[o][a]=Math.max(l[o-1][a],l[o][a-1]);return l},n9e=function(n,e,t,i){let r=e.length,s=t.length;const o={sequence:[],indices1:[],indices2:[]};for(;r!==0&&s!==0;)if(n.match(e,t,r-1,s-1,i))o.sequence.unshift(e[r-1]),o.indices1.unshift(r-1),o.indices2.unshift(s-1),--r,--s;else{const l=n[r][s-1],c=n[r-1][s];l>c?--s:--r}return o},i9e=function(n,e,t,i){const r=i||{},s=t9e(n,e,t||e9e,r);return n9e(s,n,e,r)},r9e={get:i9e},Fv=3;function s9e(n,e,t,i){for(let r=0;r<t;r++){const s=n[r];for(let o=0;o<i;o++){const a=e[o];if(r!==o&&s===a)return!0}}}function lx(n,e,t,i,r){const s=n[t],o=e[i];if(s===o)return!0;if(typeof s!="object"||typeof o!="object")return!1;const a=r.objectHash;if(!a)return r.matchByPosition&&t===i;r.hashCache1=r.hashCache1||[];let l=r.hashCache1[t];if(typeof l>"u"&&(r.hashCache1[t]=l=a(s,t)),typeof l>"u")return!1;r.hashCache2=r.hashCache2||[];let c=r.hashCache2[i];return typeof c>"u"&&(r.hashCache2[i]=c=a(o,i)),typeof c>"u"?!1:l===c}const OJ=function(e){if(!e.leftIsArray)return;const t={objectHash:e.options&&e.options.objectHash,matchByPosition:e.options&&e.options.matchByPosition};let i=0,r=0,s,o,a;const l=e.left,c=e.right,u=l.length,h=c.length;let d;for(u>0&&h>0&&!t.objectHash&&typeof t.matchByPosition!="boolean"&&(t.matchByPosition=!s9e(l,c,u,h));i<u&&i<h&&lx(l,c,i,i,t);)s=i,d=new Of(l[s],c[s]),e.push(d,s),i++;for(;r+i<u&&r+i<h&&lx(l,c,u-1-r,h-1-r,t);)o=u-1-r,a=h-1-r,d=new Of(l[o],c[a]),e.push(d,a),r++;let f;if(i+r===u){if(u===h){e.setResult(void 0).exit();return}for(f=f||{_t:"a"},s=i;s<h-r;s++)f[s]=[c[s]];e.setResult(f).exit();return}if(i+r===h){for(f=f||{_t:"a"},s=i;s<u-r;s++)f[`_${s}`]=[l[s],0,0];e.setResult(f).exit();return}delete t.hashCache1,delete t.hashCache2;const p=l.slice(i,u-r),g=c.slice(i,h-r),m=r9e.get(p,g,lx,t),v=[];for(f=f||{_t:"a"},s=i;s<u-r;s++)m.indices1.indexOf(s-i)<0&&(f[`_${s}`]=[l[s],0,0],v.push(s));let _=!0;e.options&&e.options.arrays&&e.options.arrays.detectMove===!1&&(_=!1);let y=!1;e.options&&e.options.arrays&&e.options.arrays.includeValueOnMove&&(y=!0);const A=v.length;for(s=i;s<h-r;s++){const w=m.indices2.indexOf(s-i);if(w<0){let b=!1;if(_&&A>0){for(let C=0;C<A;C++)if(o=v[C],lx(p,g,o-i,s-i,t)){f[`_${o}`].splice(1,2,s,Fv),y||(f[`_${o}`][0]=""),a=s,d=new Of(l[o],c[a]),e.push(d,a),v.splice(C,1),b=!0;break}}b||(f[s]=[c[s]])}else o=m.indices1[w]+i,a=m.indices2[w]+i,d=new Of(l[o],c[a]),e.push(d,a)}e.setResult(f).exit()};OJ.filterName="arrays";const O5={numerically(n,e){return n-e},numericallyBy(n){return(e,t)=>e[n]-t[n]}},LJ=function(e){if(!e.nested)return;const t=e.delta;if(t._t!=="a")return;let i,r;const s=t,o=e.left;let a=[],l=[];const c=[];for(i in s)if(i!=="_t")if(i[0]==="_"){const f=i;if(s[f][2]===0||s[f][2]===Fv)a.push(parseInt(i.slice(1),10));else throw new Error(`only removal or move can be applied at original array indices, invalid diff type: ${s[f][2]}`)}else{const f=i;s[f].length===1?l.push({index:parseInt(f,10),value:s[f][0]}):c.push({index:parseInt(f,10),delta:s[f]})}for(a=a.sort(O5.numerically),i=a.length-1;i>=0;i--){r=a[i];const f=s[`_${r}`],p=o.splice(r,1)[0];f[2]===Fv&&l.push({index:f[1],value:p})}l=l.sort(O5.numericallyBy("index"));const u=l.length;for(i=0;i<u;i++){const f=l[i];o.splice(f.index,0,f.value)}const h=c.length;let d;if(h>0)for(i=0;i<h;i++){const f=c[i];d=new pN(o[f.index],f.delta),e.push(d,f.index)}if(!e.children){e.setResult(o).exit();return}e.exit()};LJ.filterName="arrays";const NJ=function(e){if(!e||!e.children||e.delta._t!=="a")return;const i=e.left,r=e.children.length;let s;for(let o=0;o<r;o++){s=e.children[o];const a=s.childName;i[a]=s.result}e.setResult(i).exit()};NJ.filterName="arraysCollectChildren";const BJ=function(e){if(!e.nested){const o=e.delta;if(o[2]===Fv){const a=o;e.newName=`_${a[1]}`,e.setResult([a[0],parseInt(e.childName.substring(1),10),Fv]).exit()}return}const t=e.delta;if(t._t!=="a")return;const i=t;let r,s;for(r in i)r!=="_t"&&(s=new gN(i[r]),e.push(s,r));e.exit()};BJ.filterName="arrays";const o9e=(n,e,t)=>{if(typeof e=="string"&&e[0]==="_")return parseInt(e.substring(1),10);if(Array.isArray(t)&&t[2]===0)return`_${e}`;let i=+e;for(const r in n){const s=n[r];if(Array.isArray(s))if(s[2]===Fv){const o=parseInt(r.substring(1),10),a=s[1];if(a===+e)return o;o<=i&&a>i?i++:o>=i&&a<i&&i--}else s[2]===0?parseInt(r.substring(1),10)<=i&&i++:s.length===1&&parseInt(r,10)<=i&&i--}return i},FJ=n=>{if(!n||!n.children)return;const e=n.delta;if(e._t!=="a")return;const t=e,i=n.children.length;let r;const s={_t:"a"};for(let o=0;o<i;o++){r=n.children[o];let a=r.newName;typeof a>"u"&&(a=o9e(t,r.childName,r.result)),s[a]!==r.result&&(s[a]=r.result)}n.setResult(s).exit()};FJ.filterName="arraysCollectChildren";const UJ=function(e){e.left instanceof Date?(e.right instanceof Date?e.left.getTime()!==e.right.getTime()?e.setResult([e.left,e.right]):e.setResult(void 0):e.setResult([e.left,e.right]),e.exit()):e.right instanceof Date&&e.setResult([e.left,e.right]).exit()};UJ.filterName="dates";const AE=2,a9e=60;let bP=null;function GJ(n,e){var t;if(!bP){let i;if(!((t=n==null?void 0:n.textDiff)===null||t===void 0)&&t.diffMatchPatch)i=new n.textDiff.diffMatchPatch;else{if(!e)return null;const r=new Error("The diff-match-patch library was not provided. Pass the library in through the options or use the `jsondiffpatch/with-text-diffs` entry-point.");throw r.diff_match_patch_not_found=!0,r}bP={diff:function(r,s){return i.patch_toText(i.patch_make(r,s))},patch:function(r,s){const o=i.patch_apply(i.patch_fromText(s),r);for(let a=0;a<o[1].length;a++)if(!o[1][a]){const l=new Error("text patch failed");l.textPatchFailed=!0}return o[0]}}}return bP}const HJ=function(e){if(e.leftType!=="string")return;const t=e.left,i=e.right,r=e.options&&e.options.textDiff&&e.options.textDiff.minLength||a9e;if(t.length<r||i.length<r){e.setResult([t,i]).exit();return}const s=GJ(e.options);if(!s){e.setResult([t,i]).exit();return}const o=s.diff;e.setResult([o(t,i),0,AE]).exit()};HJ.filterName="texts";const VJ=function(e){if(e.nested)return;const t=e.delta;if(t[2]!==AE)return;const i=t,r=GJ(e.options,!0).patch;e.setResult(r(e.left,i[0])).exit()};VJ.filterName="texts";const l9e=function(n){let e,t,i,r,s=null;const o=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;let a;const l=n.split(`
`);for(e=0,t=l.length;e<t;e++){i=l[e];const c=i.slice(0,1);c==="@"?(s=o.exec(i),a=e,l[a]="@@ -"+s[3]+","+s[4]+" +"+s[1]+","+s[2]+" @@"):c==="+"?(l[e]="-"+l[e].slice(1),l[e-1].slice(0,1)==="+"&&(r=l[e],l[e]=l[e-1],l[e-1]=r)):c==="-"&&(l[e]="+"+l[e].slice(1))}return l.join(`
`)},zJ=function(e){if(e.nested)return;const t=e.delta;if(t[2]!==AE)return;const i=t;e.setResult([l9e(i[0]),0,AE]).exit()};zJ.filterName="texts";class c9e{constructor(e){this.processor=new JYe(e),this.processor.pipe(new AP("diff").append(SJ,EJ,UJ,HJ,PJ,OJ).shouldHaveResult()),this.processor.pipe(new AP("patch").append(RJ,NJ,TJ,VJ,MJ,LJ).shouldHaveResult()),this.processor.pipe(new AP("reverse").append(kJ,FJ,IJ,zJ,DJ,BJ).shouldHaveResult())}options(e){return this.processor.options(e)}diff(e,t){return this.processor.process(new Of(e,t))}patch(e,t){return this.processor.process(new pN(e,t))}reverse(e){return this.processor.process(new gN(e))}unpatch(e,t){return this.patch(e,this.reverse(t))}clone(e){return yE(e)}}function u9e(n){return new c9e(n)}const h9e=["xcs"],d9e=".xcs",Gy="Untitled",xm="-1",cx="-1";var R0,D0,k0,O0,lv;const Qn=class Qn{static get date(){return+new Date}static get created(){return S(Qn,R0)??Qn.date}static set created(e){Qe(Qn,R0,e)}static get meta(){return S(Qn,D0)}static set meta(e){Qe(Qn,D0,e)}static get latestJson(){return S(Qn,O0)}static set latestJson(e){if(Qe(Qn,O0,pn(e)),!S(Qn,k0))if(e===null)Qn.meta=null,Qn.created=null,Qe(Qn,k0,!1);else{const{version:t,created:i,modify:r,ua:s=navigator.userAgent,meta:o}=e;Qn.created=i;let a=o??[];Rt(a)||(a=[a]),Qn.meta=a.concat({version:t,date:r??Qn.date,ua:s})}}static get tempFile(){return S(Qn,lv)}static set tempFile(e){Qe(Qn,lv,e)}static cleanTempFile(){Qe(Qn,lv,void 0)}static save(e){const{projectData:t,fileName:i,fileId:r,shotImg:s,saveAs:o,extId:a}=e,l=o?"":r,c=V5(t);return dde(i||Gy,c,l,s,a).then(u=>(Qn.latestJson=e.projectData,u))}static saveTempXcs(e){var h;const{projectData:t,fileName:i,fileId:r,shotImg:s,extId:o,extInstanceId:a,tempFileId:l,power:c}=e,u=V5(t);return(h=window.MeApi)==null?void 0:h.fileHelper.saveTempXCS(i||Gy,u,r,s,o,a,l,c).then(d=>d)}static async open(e){e||(e=await Dj(h9e));let t="",i="";return pi(e)?(t=e,i=sde(e)):(t=e.path??"",i=e.name),{path:t,name:i,file:e}}static async parse(e){var t;try{const i=await ede(e),r=i.canvas.length;for(let s=0;s<r;s++){const o=i.canvas[s],a=((t=o.displays)==null?void 0:t.length)||0;for(let l=0;l<a;l++){if(!o.displays)continue;const c=o.displays[l];if(Qn.isBitmapJSON(c)){const u=c.base64;if(u.indexOf("data:image/png;base64")<0){const h=await zT(u).catch(d=>{console.log(d)});c.base64=h??""}}}}return Qn.latestJson=i,i}catch(i){return Promise.reject(i)}}static isBitmapJSON(e){return e.base64!==void 0}static rename(e,t){const i=ide(e,t);return i||`${t}${d9e}`}static mapToObject(e){const t={};return e.forEach((i,r)=>{t[r]=i}),t}static async hasChanged(e){var l;if(e)return!0;const t=Qn.latestJson,i=await _n.getCanvasJson(),r=i.canvas.length<=1&&wt((l=i.canvas[0])==null?void 0:l.displays);if((gi(t)||cr(t))&&r)return!1;console.time("=> diff");const s=u9e({propertyFilter:c=>!f9e.includes(c)}),o=c=>{if(typeof c.left=="number"&&typeof c.right=="number")p9e(c.left,c.right)&&c.setResult(void 0).exit();else if(c.left instanceof Map&&c.right instanceof Map){const u=s.diff(Qn.mapToObject(c.left),Qn.mapToObject(c.right));wt(u)||c.setResult(["map don't match"]).exit()}};o.filterName="floatAndMap",s.processor.pipes.diff.before("trivial",o);const a=s.diff(t,i);return console.log(["=> delta",a]),console.timeEnd("=> diff"),!wt(a)}static reset(){Qn.latestJson=null,Qn.cleanTempFile()}};R0=new WeakMap,D0=new WeakMap,k0=new WeakMap,O0=new WeakMap,lv=new WeakMap,ke(Qn,R0,void 0),ke(Qn,D0,null),ke(Qn,k0,!1),ke(Qn,O0,void 0),ke(Qn,lv,void 0);let Bl=Qn;const f9e=["version","ua","created","modify","meta","materialList","materialTypeList","sourceId","groupTag","base64","dPath","charJSONs","cover"],p9e=(n,e,t=1e-4)=>Math.abs(n-e)<t;let g9e=class{fetchCloudFileInfo(e,t){return Vie({current:e,pageSize:t})}getUToken(){return xp().uToken}async renameCloudFile(e,t){return zie(e,{name:t})}async deleteCloudFile(e){return $ie(e)}getXCSStorageBaseUrl(){return kie()}getDomain(){return nl()}getUserInfo(){return xp().userInfo}selectFileByType(e){return v7e().selectFileByType(e)}openLoginModal(){return xp().openLoginModal()}};const Qr=new g9e,ux=DT(),nr="cloud_proejct_uniqueId";class m9e{constructor(){E(this,"uploadProgressValue",ee(0));E(this,"uploadXcsFromSystemProgressValue",ee(0));E(this,"downloadProgressValue",ee(0));E(this,"currentDownloadFileId",ee(void 0));E(this,"currentUploadFileId",ee(void 0));E(this,"downloadCaller");E(this,"uploadProgress",e=>{this.uploadProgressValue.value=e,(e<0||e>=1)&&(this.currentUploadFileId.value=void 0,e>=1?tt.modal.showToast({msg:"mobile.projects.project_upload_success",icon:"success",uniqueId:nr}):e===-3?tt.modal.showToast({msg:"mobile.projects.project_upload_cancle",icon:"warning",uniqueId:nr}):e<0&&tt.modal.showToast({msg:"mobile.projects.project_upload_fail",icon:"error",uniqueId:nr}),setTimeout(()=>{this.uploadProgressValue.value=0},0))});E(this,"uploadXcsFromSystemProgress",e=>{this.uploadXcsFromSystemProgressValue.value=e,(e<0||e>=1)&&(this.currentUploadFileId.value=void 0,e>=1?tt.modal.showToast({msg:"mobile.projects.project_upload_success",icon:"success",uniqueId:nr}):e===-3?tt.modal.showToast({msg:"mobile.projects.project_upload_cancle",icon:"warning",uniqueId:nr}):e<0&&tt.modal.showToast({msg:"mobile.projects.project_upload_fail",icon:"error",uniqueId:nr}),setTimeout(()=>{this.uploadXcsFromSystemProgressValue.value=0},0))});E(this,"downloadProgress",e=>{if(this.downloadProgressValue.value=e,e<0||e>=1){if(this.currentDownloadFileId.value=void 0,e>=1)tt.modal.showToast({msg:"ipad.cloud_file.file_download_succeeded",icon:"success",uniqueId:nr});else if(e===-3)tt.modal.showToast({msg:"ipad.cloud_file.file_download_cancel",icon:"warning",uniqueId:nr});else if(e<0){const t=this.downloadCaller==="OPEN"?"ipad.common.failed_to_open_file":"ipad.cloud_file.file_download_failed";tt.modal.showToast({msg:t,icon:"error",uniqueId:nr})}setTimeout(()=>{this.downloadProgressValue.value=0},0)}})}async upload(e,t){if(!ux.isOnline.value){tt.modal.showToast({msg:"ipad.home.recommended.bad_network",icon:"error",uniqueId:nr});return}const i=Qr.getUserInfo(),r=i==null?void 0:i.uid;if(!i||!r)throw Qr.openLoginModal(),new Error("云空间======> 未登录");if(this.currentUploadFileId.value){const s=this.currentUploadFileId.value===e?"ipad.cloud_file.upload_this":"ipad.cloud_file.upload_other";tt.modal.showToast({msg:s,icon:"info",uniqueId:nr});return}try{this.currentUploadFileId.value=e;const{domain:s}=Qr.getDomain(),o=Qr.getUToken(),a=await Qr.fetchCloudFileInfo(1,1);if(a.code===0&&a.data.list){const u=a.data.limit||10;if(a.data.pagination.total>=u)throw tt.modal.showTipModal({title:"ipad.cloud_file.upload_limit_title",content:"ipad.cloud_file.upload_limit",hasCancel:!1,hasClose:!1,confirmTxt:"common.dialog.confirm_title",onConfirm:()=>{}}),this.currentUploadFileId.value=void 0,new Error("upload_limit")}const l=Qr.getXCSStorageBaseUrl(),c=s.url;await window.MeApi.fileHelper.uploadXcs(l,c,e,o,r,this.uploadProgress),jt(Zt.uploadCloud,{size:t,result:"success"})}catch(s){throw console.error("upload error ======> ",s),jt(Zt.uploadCloud,{size:t,result:"fail",type:s instanceof Error?s.message:""}),this.currentUploadFileId.value=void 0,this.uploadProgressValue.value=0,s}}async uploadXcsFromSystem(e,t){if(!ux.isOnline.value){tt.modal.showToast({msg:"ipad.home.recommended.bad_network",icon:"error",uniqueId:nr});return}const i=Qr.getUserInfo(),r=i==null?void 0:i.uid;if(!i||!r)throw Qr.openLoginModal(),new Error("云空间======> 未登录");if(this.currentUploadFileId.value)throw tt.modal.showToast({msg:"ipad.cloud_file.upload_other",icon:"info",uniqueId:nr}),new Error("云空间======> 有文件在上传");try{this.currentUploadFileId.value="-1";const{domain:s}=Qr.getDomain(),o=Qr.getUToken(),a=await Promise.race([Qr.fetchCloudFileInfo(1,1),new Promise((u,h)=>{window.onoffline=()=>{h("network error")}})]);if(a.code===0&&a.data.list){const u=a.data.limit||10;if(a.data.pagination.total>=u)throw tt.modal.showTipModal({title:"ipad.cloud_file.upload_limit_title",content:"ipad.cloud_file.upload_limit",hasCancel:!1,hasClose:!1,confirmTxt:"common.dialog.confirm_title",onConfirm:()=>{}}),this.currentUploadFileId.value=void 0,new Error("upload_limit")}const l=Qr.getXCSStorageBaseUrl(),c=s.url;await window.MeApi.fileHelper.uploadXcsFromSystem(l,c,e,o,r,this.uploadXcsFromSystemProgress),jt(Zt.uploadCloud,{size:t,result:"success"})}catch(s){throw console.error("upload error ======> ",s),jt(Zt.uploadCloud,{size:t,result:"fail",type:s instanceof Error?s.message:""}),this.currentUploadFileId.value=void 0,this.uploadXcsFromSystemProgressValue.value=0,s}}async cancelUploadXcsFromSystem(){return this.currentUploadFileId.value=void 0,this.uploadXcsFromSystemProgressValue.value=0,window.MeApi.fileHelper.cancelUploadXcsFromSystem()}async download(e){if(!ux.isOnline.value){tt.modal.showToast({msg:"ipad.home.recommended.bad_network",icon:"error",uniqueId:nr});return}const{cover:t,url:i,name:r,deviceExtID:s,id:o}=e;if(this.currentDownloadFileId.value){const a=this.currentDownloadFileId.value===`${o}`?"ipad.cloud_file.download_this":"ipad.cloud_file.download_other";tt.modal.showToast({msg:a,icon:"info",uniqueId:nr});return}return this.currentDownloadFileId.value=`${o}`,this.downloadCaller="PURE",window.MeApi.fileHelper.downloadXcs(t,i,r,s,this.downloadProgress).catch(a=>{throw console.error("===========>",a),this.currentDownloadFileId.value=void 0,this.downloadProgressValue.value=0,new Error(a)})}async cancelDownloadXcs(){return this.currentDownloadFileId.value=void 0,this.downloadProgressValue.value=0,window.MeApi.fileHelper.cancelDownloadXcs()}async cancelUploadXcs(){return this.currentUploadFileId.value=void 0,this.uploadProgressValue.value=0,window.MeApi.fileHelper.cancelUploadXcs()}async cancelAllDownloadAndUploadTask(){this.cancelDownloadXcs(),this.cancelUploadXcsFromSystem(),this.cancelUploadXcs()}async openCloudProject(e){if(!ux.isOnline.value)throw tt.modal.showToast({msg:"ipad.home.recommended.bad_network",icon:"error",uniqueId:nr}),new Error("===>无网络");const{url:t,id:i}=e;if(this.currentDownloadFileId.value){const r=this.currentDownloadFileId.value===`${i}`?"ipad.cloud_file.download_this":"ipad.cloud_file.download_other";throw tt.modal.showToast({msg:r,icon:"info",uniqueId:nr}),new Error("===>有任务在下载")}this.currentDownloadFileId.value=`${i}`;try{return this.downloadCaller="OPEN",await window.MeApi.fileHelper.openCloudXcs(t,this.downloadProgress)}finally{this.currentDownloadFileId.value=void 0,this.downloadProgressValue.value=0}}}const Or=new m9e;class v9e{constructor(){E(this,"isFirstLoad",!0);E(this,"haveOpenProject",!1);E(this,"isShowingReopenConfirm",!1);E(this,"allTempXcs",ee([]));E(this,"currentTempXcs",ee(void 0));E(this,"isLoadingXcs",!1);E(this,"isShowPopToast",!1)}async getAllTempXcs(){var e;return this.allTempXcs.value=await((e=window.MeApi)==null?void 0:e.fileHelper.getAllTempXcsFile()),this.allTempXcs.value}deleteAllTempXcsFile(){var e;return this.currentTempXcs.value=void 0,(e=window.MeApi)==null?void 0:e.fileHelper.deleteAllTempXcsFile()}async switchTempXcs(e){var t;if(e===((t=this.currentTempXcs.value)==null?void 0:t.tempFileId)){const i=await this.getTempXcsWithTempFileId(e);this.currentTempXcs.value=i;return}try{this.isLoadingXcs=!0,await this._saveCurrentTempXcs();const i=await this.getTempXcsWithTempFileId(e);if(console.log("openProject:  切换的项目是=========>",i),i){const{fileId:r,path:s,name:o,extInstanceId:a}=i;await this.openProject({filePath:s,fileId:r,fileName:o,extInstanceId:a}),this.currentTempXcs.value=i}}catch(i){throw console.error("openProject:  switchTempXcs error ========>",i),i}finally{this.isLoadingXcs=!1}}async createNewTempXcs(e,t){var i;try{this.isLoadingXcs=!0,await this._saveCurrentTempXcs();const r=(i=window.MeApi)==null?void 0:i.fileHelper;if(!r)throw new Error("fileHelper is not defined!");if(wt(e)){await this.createNewProject();const s=await _n.getCanvasJson(),{cover:o}=s;if(!o)throw new Error("shotImg is null!");const a=_n.extId(),l=_n.currentInstanceId(),c=_n.getCurrentDevicePower(),{tempFileId:u}=await Bl.saveTempXcs({projectData:s,fileName:Gy,fileId:xm,shotImg:o,extId:a,extInstanceId:l,tempFileId:cx,power:c});this.currentTempXcs.value=await this.getTempXcsWithTempFileId(u)}else if(e&&Qce(e,".xcs")){const s=await(r==null?void 0:r.copyFileToTemporaryPath(e));console.log("openProject:  createNewTempXcs filePath===>",e,s);const o=t||fde(s);await this.openProject({filePath:s,fileName:o,isOpenFromFile:!0});const a=_n.extId(),l=_n.currentInstanceId(),c=_n.getCurrentDevicePower(),{tempFileId:u}=await r.saveTempXcsFromPath(o,s,xm,"",a,l,cx,c);this.currentTempXcs.value=await this.getTempXcsWithTempFileId(u)}else if(e){if(console.log("openProject:  filePath===>",e),this.haveOpenProject){await _n.loadResToCanvas(e),this.isLoadingXcs=!1;return}await this.createNewProject();const s=_n.getCurrentCanvasId();_n.updateDasourceCanvasId(s),await _n.loadResToCanvas(e);const o=await _n.getCanvasJson(),{cover:a}=o;if(!a)throw new Error("shotImg is null!");const l=_n.extId(),c=_n.currentInstanceId(),u=cx,h=Gy,d=xm,f=_n.getCurrentDevicePower(),p=await Bl.saveTempXcs({projectData:o,fileName:h,fileId:d,shotImg:a,extId:l,extInstanceId:c,tempFileId:u,power:f}),{tempFileId:g}=p;this.currentTempXcs.value=await this.getTempXcsWithTempFileId(g)}}finally{this.isLoadingXcs=!1}}async openTempXcs(e){var t,i,r;try{this.isLoadingXcs=!0;const{name:s=Gy,shot:o="",path:a,extId:l}=await((t=window.MeApi)==null?void 0:t.fileHelper.getXcsFileInfo(e))||{},c=await this.getTempXcsWithFileId(e);if(c)return await this.switchTempXcs(c.tempFileId);await this._saveCurrentTempXcs(),await this.openProject({filePath:a,fileId:e,fileName:s});const u=(i=window.MeApi)==null?void 0:i.fileHelper,h=await(u==null?void 0:u.copyFileToTemporaryPath(a));let d="";try{d=await(u==null?void 0:u.copyFileToTemporaryPath(o))}catch(m){console.log("openProject:  openTempXcs copy shotTempPath to temp error===>",m)}const f=_n.currentInstanceId(),p=_n.getCurrentDevicePower(),g=await((r=window.MeApi)==null?void 0:r.fileHelper.saveTempXcsFromPath(s,h,e,d,l||_n.extId(),f,cx,p));this.currentTempXcs.value=await this.getTempXcsWithTempFileId(g.tempFileId)}finally{this.isLoadingXcs=!1}}async waitAsync(e=40){return new Promise(t=>{setTimeout(()=>{t()},e)})}async saveCurrentTempXcsIfEnable(){if(_n.isSelectModel())return this.saveCurrentTempXcs()}async saveCurrentTempXcs(){return this.isLoadingXcs?{result:!1}:this._saveCurrentTempXcs()}async _saveCurrentTempXcs(){if(!this.currentTempXcs.value)return{result:!1};await this.waitAsync();const e=await _n.getCanvasJson(),{cover:t}=e;if(!t)throw new Error("shotImg is null!");const i=_n.extId(),r=_n.currentInstanceId(),s=this.currentTempXcs.value.tempFileId,o=this.currentTempXcs.value.name,a=this.currentTempXcs.value.fileId,l=_n.getCurrentDevicePower(),{tempFileId:c}=await Bl.saveTempXcs({projectData:e,fileName:o,fileId:a,shotImg:t,extId:i,extInstanceId:r,tempFileId:s,power:l});return this.currentTempXcs.value=await this.getTempXcsWithTempFileId(c),{result:!0,tempFileId:c}}async deleteTempXcs(e){var t,i;try{this.isLoadingXcs=!0;const r=this.allTempXcs.value.findIndex(c=>c.tempFileId===e),s=this.allTempXcs.value[r-1],o=this.allTempXcs.value[r+1],a=await((i=(t=window.MeApi)==null?void 0:t.fileHelper)==null?void 0:i.deleteTempXCS(e));await this.getAllTempXcs();const l=this.currentTempXcs.value;if(l&&l.tempFileId===e){const c=o||s;if(c){const{fileId:u,path:h,name:d,extInstanceId:f}=c;await this.openProject({filePath:h,fileId:u,fileName:d,extInstanceId:f})}this.currentTempXcs.value=c}return a}catch(r){throw console.error("deleteTempXcs =======>",r),r}finally{this.isLoadingXcs=!1}}async updateCurrentTempXcsDeviceInfo(){const e=this.currentTempXcs.value;if(!e||this.isLoadingXcs){console.log("openProject:  ========> current temp xcs is empty or isLoading");return}const{tempFileId:t}=e,i=_n.extId(),r=_n.currentInstanceId(),s=_n.getCurrentDevicePower();await this.updateTempXcsInfo({tempFileId:t,extId:i,extInstanceId:r,power:s}),this.currentTempXcs.value=await this.getTempXcsWithTempFileId(t),console.log("openProject:  updateCurrentTempXcsDeviceInfo success===>",this.currentTempXcs.value,i,r,s)}async updateTempXcsInfo(e){var l,c;const{tempFileId:t,fileId:i,fileName:r,extId:s,extInstanceId:o,power:a}=e;if(!t){console.log("openProject:  =======>tempFileId is required!");return}if(i||r||s||o||a){const u=await this.getTempXcsWithTempFileId(t);if(!u)throw new Error("tempXcs is not exist!");const h=r||u.name,d=i||u.fileId,f=s||u.extId,p=o||u.extInstanceId,g=a===void 0?u.power:a;return(c=(l=window.MeApi)==null?void 0:l.fileHelper)==null?void 0:c.updateTempXcsInfo(t,d,h,f,p,g)}console.log("openProject:  =======>update info is required!")}async saveXcsToLocal(e){var g,m,v;let t;const i=e&&e!==((g=this.currentTempXcs.value)==null?void 0:g.tempFileId);if(i?t=await this.getTempXcsWithTempFileId(e):(await this._saveCurrentTempXcs(),t=this.currentTempXcs.value),!t)throw new Error("项目为空，无法保存！");const{tempFileId:r,fileId:s,name:o,path:a,shot:l,extId:c}=t,{fileId:u=xm}=await((m=window.MeApi)==null?void 0:m.fileHelper.getXcsFileInfo(s))||{},h=(v=window.MeApi)==null?void 0:v.fileHelper,d=await(h==null?void 0:h.copyFileToTemporaryPath(a));let f="";try{f=await(h==null?void 0:h.copyFileToTemporaryPath(l))}catch(_){console.log("openProject:  saveXcsTolocal copy shotTempPath to temp error===>",_)}console.log("openProject:  saveXcsTolocal fileTempPath===>1",d,f);const{fileId:p}=await(h==null?void 0:h.saveXcsFromPath(o,d,u,f,c,r));return u!==p&&(await this.updateTempXcsInfo({tempFileId:r,fileId:p}),_n.updateTaskList(r,p),i||(this.currentTempXcs.value=await this.getTempXcsWithTempFileId(r))),!0}async renameCurrentTempXcs(e){const t=this.currentTempXcs.value;if(!t)throw new Error("current temp xcs is empty!");return this.renameTempXcs(t.tempFileId,e)}async renameTempXcs(e,t){const i=await this.updateTempXcsInfo({tempFileId:e,fileName:t});return this.currentTempXcs.value=await this.getTempXcsWithTempFileId(e),i}async renameTempXcsWithFileId(e,t){const i=await this.getTempXcsWithFileId(e);if(!i)throw new Error("====>tempXcs is not exist!");return this.renameTempXcs(i.tempFileId,t)}async saveMultiCanvasShotImg(e,t){var r,s,o;const i=(r=this.currentTempXcs.value)==null?void 0:r.tempFileId;if(i)try{return await((o=(s=window.MeApi)==null?void 0:s.fileHelper)==null?void 0:o.saveMultiCanvasShotImg(i,e,t))}catch(a){console.info("openProject:  saveMultiCanvasShotImg error===>",a);return}}async getMultiCanvasShotImg(e){var i,r,s,o,a;const t=(i=this.currentTempXcs.value)==null?void 0:i.tempFileId;if(!t){console.info("openProject:  getMultiCanvasShotImg error ===>tempFileId is empty",t);return}try{const l=await((s=(r=window.MeApi)==null?void 0:r.fileHelper)==null?void 0:s.getMultiCanvasShotImgPath(t,e));return await((a=(o=window.MeApi)==null?void 0:o.fileHelper)==null?void 0:a.read2Str(l))}catch(l){console.info("openProject:  getMultiCanvasShotImg error===>",l);return}}async deleteMultiCanvasShotImg(e){var i,r,s;const t=(i=this.currentTempXcs.value)==null?void 0:i.tempFileId;if(t)try{return await((s=(r=window.MeApi)==null?void 0:r.fileHelper)==null?void 0:s.deleteMultiCanvasShotImg(t,e))}catch(o){console.log("deleteMultiCanvasShotImg error===>",o);return}}async openProject(e){const{filePath:t,fileId:i,fileName:r,extInstanceId:s,isOpenFromFile:o}=e;return L5.openProject({file:t,fileId:i,fileName:r,instanceId:s,isOpenFromFile:o})}async createNewProject(){return L5.openProject({file:"",isNewProject:!0})}async getTempXcsWithTempFileId(e){return(await this.getAllTempXcs()).find(r=>r.tempFileId===e)||void 0}async getTempXcsWithFileId(e){return(await this.getAllTempXcs()).find(r=>r.fileId===e)||void 0}getCurrentXcsFileId(){var e;return((e=this.currentTempXcs.value)==null?void 0:e.fileId)||""}getCurrentTempXcsFileId(){var e;return((e=this.currentTempXcs.value)==null?void 0:e.tempFileId)||""}getCurrentProjectFileName(){var e;return((e=this.currentTempXcs.value)==null?void 0:e.name)||""}}const Jt=new v9e,kn=ba("project_module",{state(){return{openSource:""}},getters:{currentTempXcs(){return Jt.currentTempXcs.value}},actions:{async SaveCurrentXcsThenDeleteAll(){await Jt.saveXcsToLocal(),await Jt.deleteAllTempXcsFile()},async openMultiProjectFromFile(n){return Jt.createNewTempXcs(n)},async saveCurrentTempXcs(){return Jt.saveCurrentTempXcs()},async saveCurrentTempXcsIfEnable(){return Jt.saveCurrentTempXcsIfEnable()},async saveMultiCanvasShotImg(n,e){return Jt.saveMultiCanvasShotImg(n,e)},async getMultiCanvasShotImg(n){return Jt.getMultiCanvasShotImg(n)},async deleteMultiCanvasShotImg(n){return Jt.deleteMultiCanvasShotImg(n)},getCurrentXcsFileId(){return Jt.getCurrentXcsFileId()},getCurrentTempXcsFileId(){return Jt.getCurrentTempXcsFileId()},getCurrentProjectFileName(){return Jt.getCurrentProjectFileName()},isShowingReopenConfirm(){return Jt.isShowingReopenConfirm},isLoadingProject(){return Jt.isLoadingXcs},cancelAllDownloadAndUploadTask(){return Or.cancelAllDownloadAndUploadTask()},isNewProject(){var n,e;return((n=Jt.currentTempXcs.value)==null?void 0:n.fileId)===xm||((e=Jt.currentTempXcs.value)==null?void 0:e.fileId)===""},renameCurrentTempXcs(n){return Jt.renameCurrentTempXcs(n)},haveOpenProject(){return Jt.haveOpenProject},isShowPopToast(){return Jt.isShowPopToast}}});class _9e{constructor(){E(this,"isOpenFromOut",!1)}async refreshBackgroundImage(){var t;const e=_n.getExt();mt((t=e==null?void 0:e.appContext)==null?void 0:t.takeing)&&e.appContext.takeing()}async isHaveChangeProject(){return Bl.hasChanged(!1)}async openNewProject(){Bl.reset(),await _n.loadCanvas()}async openProject(e){var d,f;const{file:t,isNewProject:i,isOpenFromFile:r,fileId:s=xm,instanceId:o=""}=e||{};if(i){console.log("openProject:  start create new project ========>"),await this.openNewProject();return}console.log("openProject:  start load project ========>",s);const a=Date.now();let l=!0,c="";const u=(d=_n.getExt())==null?void 0:d.instanceId;let h;try{console.log(["openProject:  => start load project."]);const p=await Bl.open(t||Bl.tempFile),g=await Bl.parse(p.file);let{canvas:m,canvasId:v,device:_,version:y}=g;const A=new Map;(r||_n.getAllCanvasIdList().includes(v))&&m.forEach(C=>{var O;const I=Gp(),x=C.id;v===C.id&&(v=I),A.set(I,x),C.id=I;const T=((O=_==null?void 0:_.data)==null?void 0:O.get(x))??void 0;T&&(delete _.data[x],_.data.set(I,T))});let w=g.extId;w==="D2"?w="S1":(w==="D1Pro2"||w==="D1Pro2.0")&&(w="D1Pro 2.0");const{power:b}=_||{};if(console.log(["openProject:  => load ext",w]),o&&(h=await _n.loadOpenProjectExtByInstanceId(o)||h),!h&&w&&(h=await _n.loadOpenProjectExtByExtId(w,b)||h),h||(h=_n.getExt()),m&&v){if(h){console.log("openProject:  => curExt",h),(f=h.handleProjectOpened)==null||f.call(h);const C=fo.dataSource;if(C)if(_&&!wt(_.data)){const I=_n.getProcessingParamList();C.setProjectData(_.data,m,I,h.id);const x=_n.getMaterialList();C.batchUpdateOfficialMaterial(x),C.batchUpdateCustomProcessData((_==null?void 0:_.materialTypeList)||[]),_n.importProjectMaterial((_==null?void 0:_.materialList)||[])}else{const I=[];m.forEach(x=>{var O;const T=[];(O=x.displays)==null||O.forEach(({type:F,isFill:G,id:B})=>{T.push({id:B,type:F,isFill:G})}),I.push({id:x.id,displays:T})}),console.log("openProject:  空设备===========>",I),C.resetData(I)}}console.log(["openProject:  =>设置设备数据、加载画布 load canvas",m]),await _n.loadCanvas({canvasDataList:m,idMapping:A,canvasId:v,version:y})}else throw new Error(`open file is empty. [${t}]`);return}catch(p){return l=!1,c=p.message,console.error("openProject:  打开工程报错 ==========>",p),Promise.reject(`open file error. [${p}]`)}finally{const g=(Date.now()-a)/1e3;jt(Zt.importProject,{timeUsed:g,result:l?"success":"fail",message:c,source:kn().openSource}),console.log(["openProject:  => finish load project."]),u!==(h==null?void 0:h.instanceId)&&this.refreshBackgroundImage(),Bl.cleanTempFile()}}}const L5=new _9e;class y9e{}class A9e{}class b9e{constructor(e){this.tempFileId=e}}class w9e{constructor(e,t){this.tempFileId=e,this.source=t}}class x9e{constructor(e,t){this.fileId=e,this.source=t}}class C9e{constructor(e,t,i){this.filePath=e,this.fileName=t,this.source=i}}class E9e{}class T9e{constructor(e){this.tempFileId=e}}class I9e{constructor(e){this.isAuto=e}}class S9e{constructor(e){this.newName=e}}class P9e{constructor(e,t){this.fileId=e,this.newName=t}}class M9e{constructor(e){this.url=e}}class R9e{}class D9e{constructor(e){this.haveOpenProject=e}}class k9e{}class O9e{constructor(e){this.isShowPopToast=e}}class L9e extends Yc{constructor(){super(...arguments);E(this,"lastOpenTempXcsFileId","last_open_tempXcs_fileId")}createState(){return{allTempXcs:[],isLoading:!1,currentTempXcs:Jt.currentTempXcs.value??null,operateLoading:!1,saveLoading:!1,isShowPopToast:!1}}initWatch(){yt(()=>Jt.allTempXcs.value,t=>{this.updateState({allTempXcs:t})},{immediate:!0}),yt(()=>Jt.currentTempXcs.value,(t,i)=>{console.log("openProject:  currentTempXcs=====",t);const r=(t==null?void 0:t.tempFileId)??"";localStorage.setItem(this.lastOpenTempXcsFileId,r),!t&&i&&this.sendEffect({closeEditor:{}}),this.updateState({currentTempXcs:t})},{immediate:!0}),yt(()=>_n.getExt(),()=>{console.log("openProject:  update currentTempXcs deviceInfo ====="),Jt.updateCurrentTempXcsDeviceInfo()},{immediate:!0})}setEventHandler(){this.registerEventHandler(y9e,this.getAllTempXcs),this.registerEventHandler(A9e,this.deleteAllTempXcsFile),this.registerEventHandler(b9e,this.deleteTempXcs),this.registerEventHandler(w9e,this.switchToTempXcs),this.registerEventHandler(x9e,this.openTempXcsEvent),this.registerEventHandler(C9e,this.createNewTempXcs),this.registerEventHandler(E9e,this.saveCurrentXcsToLocal),this.registerEventHandler(T9e,this.saveXcsToLocal),this.registerEventHandler(I9e,this.saveCurrentTempXcs),this.registerEventHandler(S9e,this.renameCurrentTempXcs),this.registerEventHandler(P9e,this.renameTempXcsWithFileId),this.registerEventHandler(R9e,this.checkNeedReopenTempXcs),this.registerEventHandler(M9e,this.openTargetTempXcs),this.registerEventHandler(D9e,this.haveOpenProject),this.registerEventHandler(k9e,this.SaveCurrentXcsThenDeleteAll),this.registerEventHandler(O9e,this.setIsShowPopToast)}async switchToTempXcs(t){try{const{tempFileId:i,source:r}=t;kn().openSource=r;const s=Jt.getCurrentTempXcsFileId();if(i===s){await Jt.switchTempXcs(i);return}this.updateState({isLoading:!0}),await Jt.switchTempXcs(i),this.updateState({isLoading:!1})}catch(i){console.error("openProject:  switchToTempXcs error===>",i),this.updateState({isLoading:!1})}}async saveCurrentXcsToLocal(){if(!this.uiState.saveLoading)try{this.updateState({saveLoading:!0}),await Jt.saveXcsToLocal(),this.updateState({saveLoading:!1}),this.sendEffect({saveXcsResult:{isSuccess:!0,msg:"openProject:  ====> save success"}})}catch(t){console.error("openProject:  saveCurrentXcsToLocal error===>",t),this.updateState({saveLoading:!1}),this.sendEffect({saveXcsResult:{isSuccess:!1,msg:"openProject:  ====> save fail"}})}}async saveXcsToLocal(t){try{const{tempFileId:i}=t;return this.updateState({saveLoading:!0}),await Jt.saveXcsToLocal(i),this.updateState({saveLoading:!1}),this.sendEffect({saveXcsResult:{isSuccess:!0,msg:"openProject:  ====> save success"}}),!0}catch(i){throw this.updateState({saveLoading:!1}),this.sendEffect({saveXcsResult:{isSuccess:!1,msg:"openProject:  ====> save fail"}}),new Error(`saveXcsToLocal error===>${i}`)}}async renameCurrentTempXcs(t){try{const{newName:i}=t;await Jt.renameCurrentTempXcs(i)}catch(i){console.error("openProject:  renameCurrentTempXcs error===>",i)}}async renameTempXcsWithFileId(t){try{const{fileId:i,newName:r}=t;this.updateState({operateLoading:!0}),await Jt.renameTempXcsWithFileId(i,r),this.updateState({operateLoading:!1})}catch(i){console.error("openProject:  renameTempXcsWithFileId error===>",i),this.updateState({operateLoading:!1})}}async saveCurrentTempXcs(t){if(!(!_n.isSelectModel()&&t.isAuto))try{await Jt.saveCurrentTempXcs()}catch(i){console.error("openProject:  saveCurrentTempXcs error===>",i)}}async getAllTempXcs(){try{const t=await Jt.getAllTempXcs();this.updateState({allTempXcs:t})}catch(t){console.error("openProject:  getAllTempXcs error===>",t)}}async deleteAllTempXcsFile(){try{await Jt.deleteAllTempXcsFile(),tt.appType===ps.App&&_n.clearAllElement()}catch(t){console.error("openProject:  deleteAllTempXcsFile error===>",t)}}async deleteTempXcs(t){try{const{tempFileId:i}=t;await Jt.deleteTempXcs(i),_n.projectRemove(i)}catch(i){console.error("openProject:  deleteTempXcs error===>",i)}}async openTempXcsEvent(t){try{const{fileId:i,source:r}=t;return kn().openSource=r,this.updateState({isLoading:!0}),await Jt.openTempXcs(i),this.updateState({isLoading:!1}),this.sendEffect({openTempXcsResult:{isSuccess:!0,msg:"打开项目成功"}}),!0}catch(i){return console.error("openProject:  openTempXcsEvent error===>",i),this.updateState({isLoading:!1}),this.sendEffect({openTempXcsResult:{isSuccess:!1,msg:"打开项目失败"}}),await Jt.createNewTempXcs(),!1}}async createNewTempXcs(t){try{const{filePath:i,fileName:r,source:s}=t;kn().openSource=s,this.updateState({isLoading:!0}),await Jt.createNewTempXcs(i,r),this.updateState({isLoading:!1})}catch(i){console.error("openProject:  createNewTempXcs error===>",i),this.updateState({isLoading:!1}),this.sendEffect({openTempXcsResult:{isSuccess:!1,msg:"打开项目失败"}}),Jt.createNewTempXcs()}}async checkNeedReopenTempXcs(){try{if(!Jt.isFirstLoad){this.sendEffect({checkNeedReopenResult:{isNeedReopen:!1}});return}Jt.isFirstLoad=!1;const t=await Jt.getAllTempXcs();if(t.length<=0){this.sendEffect({checkNeedReopenResult:{isNeedReopen:!1}});return}Jt.isShowingReopenConfirm=!0,tt.modal.showTipModal({title:"mobile.projects.unsave_project",content:"mobile.projects.cache_notice",confirmTxt:"mobile.projects.continue_cache",cancelTxt:"mobile.projects.abandon_cache",hasClose:!1,onConfirm:async()=>{if(!Jt.isShowingReopenConfirm)return;Jt.isShowingReopenConfirm=!1,this.updateState({isLoading:!0,allTempXcs:t});const i=localStorage.getItem(this.lastOpenTempXcsFileId),s=t.find(o=>o.tempFileId===i)||t[0];this.sendEffect({checkNeedReopenResult:{isNeedReopen:!0,tempXcsFileId:s.tempFileId}}),this.updateState({isLoading:!1})},onCancel:async()=>{if(!Jt.isShowingReopenConfirm)return;Jt.isShowingReopenConfirm=!1,await Jt.deleteAllTempXcsFile();const i=await Jt.getAllTempXcs();this.updateState({allTempsXcs:i}),localStorage.removeItem(this.lastOpenTempXcsFileId),this.sendEffect({checkNeedReopenResult:{isNeedReopen:!1}})}})}catch(t){console.error("openProject:  checkNeedReopenTempXcs error===>",t)}}async SaveCurrentXcsThenDeleteAll(){try{this.updateState({saveLoading:!0}),await Jt.saveXcsToLocal(),await Jt.deleteAllTempXcsFile(),_n.clearAllElement(),this.updateState({saveLoading:!1}),this.sendEffect({saveXcsResult:{isSuccess:!0,msg:"openProject:  ====>single save success"}})}catch(t){console.error("openProject:  SaveThenDeleteCurrentXcs error===>",t),this.updateState({saveLoading:!1}),this.sendEffect({saveXcsResult:{isSuccess:!1,msg:"====>single save fail"}})}}setIsShowPopToast(t){Jt.isShowPopToast=t.isShowPopToast,this.updateState({isShowPopToast:t.isShowPopToast})}haveOpenProject(t){Jt.haveOpenProject=t.haveOpenProject}async openTargetTempXcs(t){var i;try{const{url:r}=t,[s,o]=r.split("_");if(await Jt.getTempXcsWithTempFileId(s))this.sendEffect({openEditor:{tempFileId:s}});else{const l=await((i=window.MeApi)==null?void 0:i.fileHelper.getXcsFileInfo(o));l!=null&&l.fileId?this.sendEffect({openEditor:{fileId:o}}):tt.modal.showToast({type:"fail",icon:"error",msg:"ipad.tasks.file_not_exist"})}}catch(r){console.error("openProject:  openTargetTempXcs error===>",r),tt.modal.showToast({type:"fail",icon:"error",msg:"ipad.tasks.file_not_exist"})}}}class N9e{constructor(e=!0){this.needShowRefresh=e}}class B9e{}class F9e{constructor(e){this.id=e}}class U9e{constructor(e,t){this.id=e,this.newName=t}}class G9e{constructor(e,t){this.fileId=e,this.fileSize=t}}class H9e{constructor(e){this.fileItem=e}}class V9e{constructor(e){this.fileItem=e}}class z9e{}class $9e{}class W9e{}class j9e{}const hx=DT(),qy=class qy extends Yc{constructor(){super(...arguments);E(this,"current",1);E(this,"pageSize",10);E(this,"projectList",[])}initWatch(){Lo(()=>Or.uploadProgressValue.value,t=>{console.log("上传uploadProgressValue======>",t),this.updateState({uploadProgress:t}),(t<0||t>=1)&&(this.updateState({isUploading:!1}),t>=1?this.sendEffect({uploadProjectResult:{isSuccess:!0}}):this.sendEffect({uploadProjectResult:{isSuccess:!1,msg:"====>upload fail"}}))}),Lo(()=>Or.uploadXcsFromSystemProgressValue.value,t=>{console.log("上传 uploadXcsFromSystemProgress======>",t),this.updateState({uploadXcsFromSystemProgress:t}),(t<0||t>=1)&&(this.updateState({isUploadingFromSystem:!1}),t>=1?(this.sendEffect({uploadXcsFromSystemResult:{isSuccess:!0}}),this.refreshProjectEvent({needShowRefresh:!1})):this.sendEffect({uploadXcsFromSystemResult:{isSuccess:!1,msg:"====>upload fail"}}))}),Lo(()=>Or.downloadProgressValue.value,t=>{console.log("下载downloadProgress======>",t),this.updateState({downloadProgress:t}),(t<0||t>=1)&&this.updateState({isDownloading:!1})}),Lo(()=>Or.currentUploadFileId.value,t=>{this.updateState({currentUploadFileId:t})}),Lo(()=>Or.currentDownloadFileId.value,t=>{this.updateState({currentDownloadFileId:t})})}createState(){return{isLoading:!1,isRefreshLoading:!1,isLoadingMoreData:!1,limitCount:qy.defaultLimitCount,freeCountUsed:0,projectList:[],uploadProgress:Or.uploadProgressValue.value,downloadProgress:Or.downloadProgressValue.value,isDownloading:!1,isUploading:!1,isUploadingFromSystem:!1,uploadXcsFromSystemProgress:Or.uploadXcsFromSystemProgressValue.value,currentDownloadFileId:void 0,currentUploadFileId:void 0,operateLoading:!1,openCloudFileLoading:!1}}setEventHandler(){this.registerEventHandler(N9e,this.refreshProjectEvent),this.registerEventHandler(B9e,this.loadMoreProjectEvent),this.registerEventHandler(U9e,this.renameCloudProjectEvent),this.registerEventHandler(F9e,this.deleteCloudProjectEvent),this.registerEventHandler(G9e,this.uploadProjectEvent),this.registerEventHandler(H9e,this.downloadProjectEvent),this.registerEventHandler(V9e,this.openCloudProejct),this.registerEventHandler(z9e,this.uploadXcsFromSystem),this.registerEventHandler($9e,this.cancelDownloadXcsTask),this.registerEventHandler(W9e,this.cancelUploadXcsTask),this.registerEventHandler(j9e,this.cancelUploadXcsFromSystem)}cancelDownloadXcsTask(){this.updateState({openCloudFileLoading:!1}),this.updateState({isDownloading:!1}),Or.cancelDownloadXcs()}cancelUploadXcsTask(){this.updateState({isUploading:!1}),Or.cancelUploadXcs()}cancelUploadXcsFromSystem(){this.updateState({isUploadingFromSystem:!1}),Or.cancelUploadXcsFromSystem()}async refreshProjectEvent(t){const{needShowRefresh:i=!0}=t||{},r=Qr.getUToken();if(wt(r)){this.updateState({isLoading:!1,isRefreshLoading:!1});return}i&&this.updateState({isRefreshLoading:!0}),this.projectList.length<=0&&this.updateState({isLoading:!0});try{const s=await Qr.fetchCloudFileInfo(1,this.pageSize);if(s.code!==0){this.sendEffect({loadProjectResult:{isSuccess:!1,msg:"request error"}}),this.updateState({isLoading:!1,isRefreshLoading:!1});return}if(!s.data.list){this.sendEffect({loadProjectResult:{isSuccess:!0}}),this.updateState({isLoading:!1,isRefreshLoading:!1});return}this.updateState({isLoading:!1,isRefreshLoading:!1}),this.current=1;const o=s.data.limit||qy.defaultLimitCount,a=s.data.pagination.total;this.projectList=s.data.list.map(l=>{const c=this.formatDate(l.createdAt),u=this.getFileSizeString(l.fileSize);return{...l,createdAtString:c,fileSizeString:u}}),this.sendEffect({loadProjectResult:{isSuccess:!0}}),this.updateState({limitCount:o,freeCountUsed:a,projectList:this.projectList,isLoading:!1,isRefreshLoading:!1})}catch(s){console.log("refresh Project error ======> ",s),this.sendEffect({loadProjectResult:{isSuccess:!1,msg:"refresh Project error"}}),this.updateState({isLoading:!1,isRefreshLoading:!1})}}async loadMoreProjectEvent(){const t=Qr.getUToken();if(!wt(t)){this.updateState({isLoadingMoreData:!0});try{const i=this.current+1,r=await Qr.fetchCloudFileInfo(i,this.pageSize);if(this.updateState({isLoadingMoreData:!1}),r.code!==0){this.sendEffect({loadProjectResult:{isSuccess:!1,msg:"====> request error"}});return}if(!r.data.list){this.sendEffect({loadProjectError:{msg:"data is empty"}});return}this.current=i;const s=r.data.list.map(o=>{const a=this.formatDate(o.createdAt),l=this.getFileSizeString(o.fileSize);return{...o,createdAtString:a,fileSizeString:l}});this.projectList=this.uiState.projectList.concat(s),this.updateState({projectList:this.projectList})}catch(i){console.log("loadMoreProject ======> error",i),this.sendEffect({loadProjectResult:{isSuccess:!1,msg:"load more Project error"}}),this.updateState({isLoadingMoreData:!1})}}}async renameCloudProjectEvent(t){try{const{id:i,newName:r}=t;this.updateState({operateLoading:!0}),await Qr.renameCloudFile(i,r),this.projectList=this.projectList.map(s=>s.id===i?{...s,name:r}:s),this.updateState({projectList:this.projectList,operateLoading:!1}),jt(Zt.renameCloud,{result:"success"})}catch(i){jt(Zt.renameCloud,{result:"fail",type:i instanceof Error?i.message:""}),this.updateState({operateLoading:!1}),console.log("rename fail ======>",i)}}async deleteCloudProjectEvent(t){try{const{id:i}=t;this.updateState({operateLoading:!0}),await Qr.deleteCloudFile(i),this.projectList=this.projectList.filter(r=>r.id!==i),this.updateState({freeCountUsed:this.projectList.length,projectList:this.projectList,operateLoading:!1}),jt(Zt.deleteCloud,{result:"success"})}catch(i){console.log("delete fail ======>",i),jt(Zt.deleteCloud,{result:"fail",type:i instanceof Error?i.message:""}),this.updateState({operateLoading:!1})}}async openCloudProejct(t){if(!hx.isOnline.value){tt.modal.showToast({msg:"ipad.home.recommended.bad_network",icon:"error",uniqueId:nr});return}const{fileItem:i}=t;if(Or.currentDownloadFileId.value){const s=Or.currentDownloadFileId.value===`${i.id}`?"ipad.cloud_file.download_this":"ipad.cloud_file.download_other";tt.modal.showToast({msg:s,icon:"info",uniqueId:nr});return}const r=tt.appType===ps.Pad;try{r?this.updateState({isDownloading:!0}):this.updateState({openCloudFileLoading:!0});const s=await Or.openCloudProject(i);return this.sendEffect({openCloundProjectResult:{filePath:s,cloundFileId:i.id,fileName:i.name}}),s}catch{this.sendEffect({openCloundProjectResult:{cloundFileId:i.id}})}finally{r?this.updateState({isDownloading:!1}):this.updateState({openCloudFileLoading:!1})}}async downloadProjectEvent(t){if(!hx.isOnline.value){tt.modal.showToast({msg:"ipad.home.recommended.bad_network",icon:"error",uniqueId:nr});return}try{const{fileItem:i}=t;return jt(Zt.downloadCloud,{size:i.fileSize}),this.updateState({isDownloading:!0}),await Or.download(i)}catch(i){throw console.log("download fail ======>",i),this.updateState({isDownloading:!1}),new Error(`download fail ======${i}`)}}async uploadProjectEvent(t){const{fileId:i,fileSize:r}=t;if(!hx.isOnline.value){tt.modal.showToast({msg:"ipad.home.recommended.bad_network",icon:"error",uniqueId:nr});return}try{Or.currentUploadFileId.value||this.updateState({isUploading:!0}),await Or.upload(i,r)}catch(s){console.log("upload fail ======>",s),this.updateState({isUploading:!1}),this.sendEffect({uploadProjectResult:{isSuccess:!1,msg:`upload fail======>${s}`}})}}async uploadXcsFromSystem(){try{if(this.uiState.freeCountUsed>=this.uiState.limitCount){tt.modal.showTipModal({title:"ipad.cloud_file.upload_limit_title",content:"ipad.cloud_file.upload_limit",hasCancel:!1,hasClose:!1,confirmTxt:"common.dialog.confirm_title",onConfirm:()=>{}});return}const t=await Qr.selectFileByType(3);if(!hx.isOnline.value){tt.modal.showToast({msg:"ipad.home.recommended.bad_network",icon:"error",uniqueId:nr});return}if(t){if(!t.endsWith(".xcs")){tt.modal.showToast({msg:"mobile.projects.not_support_import_file",uniqueId:nr});return}Or.currentUploadFileId.value||this.updateState({isUploadingFromSystem:!0}),await Or.uploadXcsFromSystem(t,0)}}catch(t){console.log("upload fail ======>",t),this.updateState({isUploadingFromSystem:!1}),this.sendEffect({uploadXcsFromSystemResult:{isSuccess:!1,msg:`uploadXcsFromSystem fail======>${t}`}})}}getFileSizeString(t){let i;return t/1048576>1?i=`${this.checkDecimal(t/1048576,1)}M`:i=`${this.checkDecimal(t/1024,1)}KB`,i}checkDecimal(t,i){const r=parseFloat(t.toFixed(i));return r%1===0?Math.floor(r):r}formatDate(t){const i=new Date(t*1e3);return Sd(i,"MM-dd HH:mm:ss")}};E(qy,"defaultLimitCount",10);let N5=qy;class Q9e{constructor(){E(this,"_iModal",null);E(this,"_iEvent",null);E(this,"_canvasFactory",null);E(this,"_appType",ps.App);E(this,"isShowOptionSelect",!1)}setModal(e){return this._iModal=e,this}get modal(){if(this._iModal===null)throw new Error("modal not init");return this._iModal}setEvent(e){return this._iEvent=e,this}get event(){if(this._iEvent===null)throw new Error("event not init");return this._iEvent}get canvasFactory(){if(this._canvasFactory===null)throw new Error("canvasFactory not init");return this._canvasFactory}setCanvasFactory(e){return this._canvasFactory=e,this}get appType(){return this._appType}setAppType(e){return this._appType=e,this}async onPageLoad(){this.listenerWindowMessage()}listenerWindowMessage(){window.MeApi.setPostMessageToMainHook(async(e,t)=>{var i;if(e){const r=e.indexOf(r8);r>0&&(e=e.slice(r+1))}if(e===up.showLearningGuide){const{client:r}=nl();if(window.VITE_PAD){const s=B0();tt.modal.showToast({icon:"warning",type:"html",linkTips:"ipad.safety.click_to_learning",msg:"ipad.safety.safety_training_tip",duration:0,order:-1,topDistance:s&&((i=s.currentRoute.value)==null?void 0:i.name)==="home"?86:106,closeable:!0,openCb:()=>{window.MeApi.openNative.openWebInApp(r.getUrl("profile/training"))}})}else tt.modal.showTipModal({title:"ipad.safety.safety_title",content:"ipad.safety.safety_training_tip",confirmTxt:"ipad.safety.training",cancelTxt:"device.common.cancel",hasClose:!1,onConfirm:async()=>{window.MeApi.openNative.openWebInApp(r.getUrl("profile/training"))},onCancel:async()=>{}})}else if(e===up.GetProcessTaskInfo)hs.updateProcessInfo(t);else if(e===up.GetTabInfo){const r=kn().getCurrentTempXcsFileId(),s=kn().getCurrentXcsFileId();return{url:`${r}_${s}`,fileName:kn().getCurrentProjectFileName()}}else e==="closeConnect"&&bt().closeConnectByIp(t)})}}const tt=new Q9e;class X9e{constructor(){E(this,"errorModalList",[]);E(this,"errorIgnoreList",[]);E(this,"newDeviceError",ee({msg:"",code:""}));E(this,"isShowDeviceErrorModal",ee(!1));E(this,"haveNewError",ee({}))}insertErrorModalList(e){const t=this.errorModalList.findIndex(i=>i.code===e.code);if(t!==-1){const i=this.errorModalList.splice(t,1)[0];this.errorModalList.unshift(i)}else this.errorModalList.unshift(e);this.haveNewError.value={}}insertDeviceError(e){const{code:t=""}=e;wt(t)||(this.newDeviceError.value=e,!this.errorIgnoreList.includes(t)&&(this.insertErrorModalList(e),!this.isShowDeviceErrorModal.value&&(window.MeApi.openNative.deviceWarning(!0),this.openDeviceErrorModal(),tt.modal.showDeviceErrorModal())))}removeFirstDeviceError(){this.errorModalList.shift()}firstDeviceError(){return this.errorModalList[0]}hasError(){return this.errorModalList.length>0}clearErrorIgnoreList(){this.errorIgnoreList=[]}addErrorIgnoreList(e){!this.errorIgnoreList.includes(e)&&!wt(e)&&this.errorIgnoreList.push(e)}openDeviceErrorModal(){this.isShowDeviceErrorModal.value=!0}closeDeviceErrorModal(){window.MeApi.openNative.deviceWarning(!1),this.isShowDeviceErrorModal.value=!1}}const Ro=new X9e;window.ME.deviceErrorManager=Ro;class $J{}class WJ{}class jJ{}class QJ{}class Y9e extends Yc{createState(){const e=Ro.firstDeviceError();return{errorInfo:e,isShowIgnore:this.isShowIgnore(e),isShowClose:this.isShowCloseBtn(e),headerMsg:this.adapterHeaderMsg(e),contentMsg:this.adapterContentMsg(e)}}initWatch(){yt(()=>Ro.haveNewError.value,()=>{const e=Ro.firstDeviceError();e&&this.updateState({errorInfo:e,isShowIgnore:this.isShowIgnore(e),isShowClose:this.isShowCloseBtn(e),headerMsg:this.adapterHeaderMsg(e),contentMsg:this.adapterContentMsg(e)})})}get currentErrorInfo(){return this.uiState.errorInfo}setEventHandler(){this.registerEventHandler(jJ,this.handleConfirmEvent),this.registerEventHandler($J,this.handleHowResolveEvent),this.registerEventHandler(WJ,this.handleIgnoreEvent),this.registerEventHandler(QJ,this.handleCloseEvent)}handleConfirmEvent(){var e,t;(t=(e=this.currentErrorInfo).confirmAction)==null||t.call(e),this.checkHasError()}handleHowResolveEvent(){var t,i,r;const e=this.currentErrorInfo.faqUrl??((r=(i=(t=this.getExt())==null?void 0:t.config)==null?void 0:i.supportUrls)==null?void 0:r.faqUrl);console.log("[固件异常报警，如何解决]=>",e),mN(e)}handleIgnoreEvent(){Ro.addErrorIgnoreList(this.currentErrorInfo.code),this.checkHasError()}handleCloseEvent(){this.checkHasError()}getExt(){return ft.ext}isShowIgnore(e){return gi(e.canBeIgnored)?ft.ext.id!==nt.S1:e.canBeIgnored}isShowCloseBtn(e){return e.code==="M363 S3"&&this.getExt().id===nt.S1}adapterHeaderMsg(e){return this.getExt().id===nt.S1?`${e.msg}.title`:`device.error.${e.msg}.title`}adapterContentMsg(e){return this.getExt().id===nt.S1?`${e.msg}.content`:`device.error.${e.msg}.content`}checkHasError(){if(Ro.removeFirstDeviceError(),Ro.hasError()){const e=Ro.firstDeviceError();this.updateState({errorInfo:e,headerMsg:this.adapterHeaderMsg(e),contentMsg:this.adapterContentMsg(e),isShowIgnore:this.isShowIgnore(e),isShowClose:this.isShowCloseBtn(e)})}else Ro.closeDeviceErrorModal(),this.sendEffect({close:{}})}onDestroy(){super.onDestroy(),Ro.closeDeviceErrorModal()}}const q9e=n=>{n.on(QO.UPDATE_PROCESSING_AREA,t=>{console.log(["=> UI_EVENT.UPDATE_PROCESSING_AREA"],t),bn.updateCanvasArea(t)}),n.on(ss.UPDATE_DEVICE_INFO,t=>{ft==null||ft.updateCurrentData({...t})}),n.on(ss.CLEAN_CANVAS_BACK_DROP,()=>{bn.cleanCanvasBackdrop()}),n.on(ss.SET_KEEP_ALIVE_MESSAGE,t=>{if(console.log("====keepAlive:",t),!t||!t.content){tt.modal.cleanKeepAliveMessage();return}t!=null&&t.scene&&t.scene===1?tt.modal.showToast({icon:"info",msg:(t==null?void 0:t.content)||"",duration:0,forbidClick:!1,scene:1,confirmCb:()=>{e==null||e(!0)},closeCb:()=>{e==null||e(!1)}}):window.VITE_PHONE?tt.modal.showKeepAliveMessage({...t,type:"html",bckWhiteColor:!0}):tt.modal.showKeepAliveMessage(t)}),n.on(ss.UPDATE_AUTO_FOCUS_REMAIN_MODAL_VISIBLE,async t=>{var i;t&&(ft.autoFocusRemainModalVisible.value=t,await tt.modal.showConfirmDialog({title:"device.auto_focus.auto_focus_remain_modal_head",msg:"mobile.auto_focus.auto_focus_remain_tip",confirmButtonText:"common.msg.ok"})&&((i=n.goToZCoord)==null||i.call(n)))});let e;n.on(ss.MARK_POSITION,t=>{const i=bn.getSelected();bn.setSelect([]);let r=bn.markClearFn(t);const s=l=>{console.log("捕获坐标：",l),n.emit(ss.MARK_POSITION_DONE,l),r&&r(),r=void 0,bn.setSelect(i),a()},o=l=>{console.log("===>取消"),r&&r(l),r=void 0,n.emit(ss.MARK_POSITION_DONE,{isCancel:!0}),bn.setSelect(i),a()};e=o;const a=()=>{e=void 0,bn.canvasEventOff(Wp.GET_POSITION,s),bn.canvasEventOff(ss.MARK_POSITION_CANCEL,o),n.off(ss.MARK_POSITION_CANCEL,o)};bn.canvasEventOn(Wp.GET_POSITION,s,!0),n.once(ss.MARK_POSITION_CANCEL,o),n.on("disconnect",()=>{o()})}),n.on(ss.UPDATE_WALK_BORDER_PARAMS,t=>{n.walkBorderParams=t}),n.on(ss.UPDATE_WALK_BORDER_TIP_MODAL_VISIBLE,t=>{ft.walkBorderTipModalVisible.value=t}),n.on(ss.UPDATE_CANVAS_BACK_DROP,t=>{const{img:i,forceShow:r,instanceId:s}=t;ft.ext.appContext.updateBackImg({img:i},r,s)})};Mi.$ev.on(Mi.EVENTS.CREATED,n=>{q9e(n),n.emit(n.LIFECYCLE.LOAD)});let B5=!1,F5=!1;async function XJ(n,e=!1){if(!(B5&&!e)&&(B5=!0,!ft.currentInstanceId))try{await ft.updateUsedDevices();const t=ft.switchDevice;if(t.length){const i=t[0],{extId:r}=i,s=await ft.loadExt(r,i);await ft.updateCurrentInstanceId(s,()=>{},()=>{},!0,!1,!1),n&&await YJ()}}catch(t){console.log(t)}}async function YJ(){var n;if(!F5&&(F5=!0,ft.currentInstanceId||(console.log("再次加载历史设备"),await XJ(!1,!0)),ft.currentInstanceId)){const e=(n=ft.ext)==null?void 0:n.deviceInfo,t=await ft.reconnectDevice(ft.currentInstanceId);t&&t.connected&&t.id==ft.extId?ft.updateCurrentInstanceId(t,()=>{},()=>{this.updateCurrentData({shouldTryConnect:!1}),ft.closeConnect(t.instanceId),t.deviceInfo=e},!0,tt.appType==ps.Pad):t.connected&&ft.closeConnect(t.instanceId)}}const bt=ba("ext_center_module",{getters:{extId(){return ft._currentInstanceId.value,ft.extId},ext(){return ft._extChange.value,ft._currentInstanceId.value,ft.ext},currentInstanceId(){return ft._currentInstanceId.value},connected(){return ft._currentInstanceId.value,ft._listenerDataChange.value,ft.connected},hasConnected(){return ft._currentInstanceId.value,ft._listenerDataChange.value,ft.hasConnected},info(){return ft._currentInstanceId.value,ft._listenerDataChange.value,ft.deviceInfo},deviceData(){return ft._currentInstanceId.value,ft._listenerDataChange.value,ft._data.value},dataSource(){return ft.dataSource},isFrameMode(){return ft._data.value,ft._listenerDataChange.value,ft.isFraming},isInProcessing(){return ft._data.value,ft._listenerDataChange.value,!!ft.isProcessing},newDeviceError(){return Ro.newDeviceError.value},isShowDeviceErrorModal(){return Ro.isShowDeviceErrorModal.value},isShowWalkBorderTipModal(){return ft.walkBorderTipModalVisible.value},isShowAutoFocusRemainModal(){return ft.autoFocusRemainModalVisible.value},currentPower(){return ft.currentPower},currentData(){return ft.currentData}},actions:{getExt(n){return ft.getExt(n)},async loadOpenProjectExtByExtId(n,e){const t=ft.ext,{ext:i,isPowerChange:r,matchInstanceId:s}=(tt.appType===ps.Pad?await ft.loadOpenProjectExt(n,e):await ft.loadOpenProjectExtByExtId(n))||{ext:null,isPowerChange:!1};if(!i)return i;try{if(await ft.updateCurrentInstanceId(i,()=>{},()=>{},!1,!1,!(r&&tt.appType===ps.Pad)),r&&tt.appType===ps.Pad){const o=await ft.reconnectDevice(i.instanceId,!0);await ft.updateCurrentInstanceId(o,()=>{},()=>{},!1,!0)}await ft.checkCloseOneDeviceConnect(t,i)}catch(o){console.log(o)}return i},async loadOpenProjectExtByInstanceId(n){const e=ft.getExt(n);if(e&&e.instanceId!==ft.currentInstanceId)try{await ft.updateCurrentInstanceId(e,()=>{},()=>{},!1,!1)}catch(t){console.log(t)}else e&&!(e!=null&&e.connected)&&ft.reconnectDevice(n);return e},clearConnectHistoryData(){jA.clearData()},async updateDeviceInfo(){var n;await((n=this.ext)==null?void 0:n.initDeviceInfo())},hideWalkBorderTipModal(){ft.walkBorderTipModalVisible.value=!1},isAutoUpdateDeviceExt(){return ft.isAutoUpdateDeviceExt()},updateDeviceSettingInfo(n){ft.updateCurrentData(n)},async uploadExt(n){await ft.updateExt(n.extId,n.instanceId,n.createBy,n.callback)},async openLocalExt(n){await ft.openLocalExt(n)},async changeDevice(n){await ft.changeDevice(n)},async reconnectDevice(n){return ft.reconnectDevice(n)},async loadLastDevice(n){return XJ(n)},async connectLastDevice(){return YJ()},closeConnect(){ft.closeConnect(ft.currentInstanceId)},checkDeviceIsIdle(){return da(this.info.currentStatus.toUpperCase(),"IDLE")||da(this.info.currentStatus.toUpperCase(),"M222 S3")},closeConnectByIp(n){$r.closeConnectByIp(n)},getConnectedProductId(){return ft.getConnectedProductId()}}});window.ME.useExtCenterStore=bt;class K9e{}class J9e{constructor(e){this.action=e}}class Z9e{}class e7e{}class t7e{}class n7e{}class i7e{}class r7e{}class s7e{}class o7e{}class a7e{}class l7e{constructor(e){this.isBackgroundVisible=e}}class c7e{}var dy=(n=>(n[n.take_picture=1]="take_picture",n[n.togglePic=2]="togglePic",n[n.sticker=3]="sticker",n[n.refresh_bg=4]="refresh_bg",n))(dy||{}),Hy=(n=>(n.ABSOLUTE="absolute",n.RELATIVE="relative",n))(Hy||{});const U5="not_show_camera_tip",G5=[nt.P1,nt.P2,nt.M1,nt.F1Ultra],H5=[nt.S1,nt.D1Pro,nt.D1Pro2,nt.M2];class Npt extends Yc{constructor(){super(...arguments);E(this,"showCaptureGroupGuide",()=>{const t=localStorage.getItem("hideCaptureGroupGuide")!=="true";if(t){const i=this.ext;i.appContext.dialog.info({title:"device.modal.tip",content:"device.gs002.positioning_photo_tip",positiveText:"device.gs002.continue_take_phone",hasCancel:!1,closable:!0,maskClosable:!1,onPositiveClick:async()=>{await i.setBackGroundImg(),localStorage.setItem("hideCaptureGroupGuide","true")}})}return t});E(this,"undoStack",[]);E(this,"addPosition",t=>{const i=[...this.uiState.posData],r=i.length;if(console.log("handleReceiveStickerPoint addPosition",t,i),r===4)return;if(r>0){const u=i[r-1];if(t.x===u.x&&t.y===u.y){console.log("editor.sticker.location_repeat_error"),this.sendEffect({showToast:{msgKey:"editor.sticker.location_repeat_error"}});return}}const s=r,[o,a,l,c]=i;switch(console.log("items.value",[o,a,l,c],s),s){case 0:break;case 1:if(t.x<=o.x){this.sendEffect({showToast:{msgKey:"editor.sticker.calibration_order_error"}});return}break;case 2:if(t.y<=Math.min(o.y,a.y)||t.x>=a.x){this.sendEffect({showToast:{msgKey:"editor.sticker.calibration_order_error"}});return}break;case 3:if(t.y<=Math.min(o.y,a.y)||t.x<=Math.max(o.x,l.x)){this.sendEffect({showToast:{msgKey:"editor.sticker.calibration_order_error"}});return}break}this.undoStack=[],i.push(t),this.updateState({posData:i}),this.updateUndoRedoState()});E(this,"handleDeviceStatusChange",t=>{t===It.IDLE&&(console.log("handleDeviceStatusChange 机器恢复到了idle状态",t),this.closeStickerStepDialog())})}createState(){return{isShowCameraLocation:!1,isShowRefreshBg:!1,messageData:{},isShowCameraTipDialog:!1,isEnableToggleBackground:!1,isBackgroundVisible:!0,isShowStickerAction:!1,stickerStep:null,measureDistanceLoading:!1,posData:[],isEnableUndoPos:!1,isEnableRedoPos:!1,isEnableCompleteSticker:!1,isRefreshingBg:!1}}setEventHandler(){this.registerEventHandler(K9e,this.refreshState),this.registerEventHandler(J9e,this.clickActionHandle),this.registerEventHandler(Z9e,this.stickerTipNextHandle),this.registerEventHandler(e7e,this.stickerStep1NextHandle),this.registerEventHandler(t7e,this.stickerStep1DismissHandle),this.registerEventHandler(n7e,this.completeStickerHandle),this.registerEventHandler(i7e,this.stickerStep2DismissHandle),this.registerEventHandler(r7e,this.undoHandle),this.registerEventHandler(s7e,this.redoHandle),this.registerEventHandler(o7e,this.cameraTipIKnowHandle),this.registerEventHandler(a7e,this.cameraTipNeverRemindHandle),this.registerEventHandler(l7e,this.loadCorrectPicture),this.registerEventHandler(c7e,this.updateBgImage)}refreshState(){let t=!1;tt.appType===ps.App?H5.includes(this.extId)&&[zt.LASER_PLANE].includes(this.currentMode)&&(t=!0):[nt.S1,nt.M2].includes(this.extId)&&[zt.LASER_PLANE].includes(this.currentMode)&&(t=!0);let i=!1;tt.appType===ps.App&&G5.includes(this.extId)&&(i=!0);const r=bn.hasBackgroundImage,s=bn.backgroundVisible,o=this.isSupportSticker&&this.isCompleteSticker;console.log(`=====refreshState isShowCameraLocation=${t} isShowRefreshBg=${i} isEnableToggleBackground=${r} isBackgroundVisible=${s} isShowStickerAction=${o}`),this.updateState({isShowCameraLocation:t,isShowRefreshBg:i,isEnableToggleBackground:r,isBackgroundVisible:s,isShowStickerAction:o})}get isSupportSticker(){const t=bt().extId;return[nt.S1].includes(t)}async clickActionHandle(t){const{action:i}=t;i.id===dy.take_picture?this.clickCameraActionHandle():i.id===dy.togglePic?this.updateBackgroundVisibility(!fn().backgroundVisible):i.id===dy.sticker?this.updateState({stickerStep:0}):i.id===dy.refresh_bg&&this.refreshBg()}clickCameraActionHandle(){const{deviceDataHandler:t}=qx();this.buttonClick({buttonName:"photoAlignment",pageName:"edit"}),this.isSupportSticker?this.isCompleteSticker?(this.gotoCamera(),t("processStartPoint",Hy.ABSOLUTE)):this.updateState({stickerStep:0}):(localStorage.getItem(U5)??"0")==="1"?this.gotoCamera():this.updateState({isShowCameraTipDialog:!0}),this.gtmPhotoClick()}getSnCode(){var i;const t=(i=bt().currentData)==null?void 0:i.snCode;return console.log("getSnCode",t),t??""}getStickerPosKey(){return`sticker_positions_${this.getSnCode()}`}get isCompleteSticker(){return!!localStorage.getItem(this.getStickerPosKey())}async checkCameraPermission(){var i;const t=await((i=window.MeApi)==null?void 0:i.permission.grantCameraPermission());return t!==void 0&&!t&&this.sendEffect({showConfirmDialog:{titleKey:"mobile.toast.camera_not_authorized",messageKey:"mobile.toast.camera_not_authorized_text",confirmButtonTextKey:"mobile.common.go_to_setting",cancelButtonTextKey:"mobile.common.not_yet",confirmHandle:()=>{var r;return(r=window.MeApi)==null?void 0:r.permission.openAppPermissionPage()}}}),t==="undefined"?!1:t}async gotoCamera(t=void 0){if(this.isSupportSticker){if(t)localStorage.setItem(this.getStickerPosKey(),JSON.stringify(t)),this.updateState({isShowStickerAction:!0});else{const r=localStorage.getItem(this.getStickerPosKey());r&&(t=JSON.parse(r))}console.log("gotoCamera positions",t)}const i=await this.checkCameraPermission();if(console.log("isGrantedPermission",i),i){this.takePicture(t);try{const{deviceDataHandler:r}=qx();r("processStartPoint",Hy.ABSOLUTE)}catch(r){console.log("deviceDataHandler gotoCamera",r)}}}async takePicture(t){var i;try{localStorage.setItem("location_position","1");const{current:r}=this.ext.getCurrentArea(this.currentMode),s={width:424,height:348},o=t,a=this.getSnCode();console.log("takePicture snCode points",a,o);const l=await window.MeApi.openNative.takePicture(r.width,r.height,this.extId,s.width,s.height,o,a),c=await window.MeApi.fileHelper.read2Blob(l),u=await GB(c);(i=this.ext)==null||i.appContext.updateBackImg(u),bn.updateCanvasBackdrop(this.backdropOption(),u,fn().canvasId),bn.switchBackgroundVisible(!0),this.refreshState()}catch(r){console.log("==> takepicture ",r)}}backdropOption(t=!0){var g,m;const i=this.currentMode,{current:{angle:r,offsetX:s,offsetY:o,bgMaskSize:a,width:l,height:c}}=(g=this.ext)==null?void 0:g.getCurrentArea(i),{width:u,height:h}=(m=this.ext)==null?void 0:m.config.processingArea.base;return{angle:r,width:t?l:u,height:t?c:h,offsetX:s,offsetY:o,bgMaskSize:a,align:zh.TOP_LEFT}}async refreshBg(){if(!bt().connected){this.sendEffect({showToast:{msgKey:"device.process.device_is_offline"}});return}if(this.uiState.isRefreshingBg)return;this.updateState({isRefreshingBg:!0});const t=this.ext;try{this.extId===nt.F1Ultra?this.showCaptureGroupGuide()===!1&&await(t==null?void 0:t.setBackGroundImg()):await t.refreshBg(),this.refreshState()}catch(i){console.log(i),this.extId===nt.M1&&(t==null||t.appContext.showMessage({contentI18nKey:"device.status.take_picture_fail",type:"error"}))}finally{this.updateState({isRefreshingBg:!1})}}updateBackgroundVisibility(t){bn.switchBackgroundVisible(t),this.updateState({isBackgroundVisible:t})}stickerTipNextHandle(){this.updateState({stickerStep:1}),this.gtmDialogOperation("goAligned","photoAlignment")}async stickerStep1NextHandle(){if(!bt().connected){this.sendEffect({showToast:{msgKey:"device.process.device_is_offline"}});return}if(ft.isProcessing||ft.isFraming){this.sendEffect({showToast:{msgKey:"device.setting.setting_error_in_processing"}});return}await this.measureDistance()}stickerStep1DismissHandle(){this.closeStickerStepDialog(),this.gtmDialogOperation("close-1","photoAlignment")}async measureDistance(){console.log("============= xcs measureDistance");const t=2;try{this.updateState({measureDistanceLoading:!0});const i=this.ext,[r,s]=await(i==null?void 0:i.measureDistance());if(r===!1)return;const{z:o,laserPosition:a,valid:l}=s;if(l){const c=o+t;console.log(["measureDistance focalLength=>",c]),await(i==null?void 0:i.afterMeasure({x:a.x,y:a.y})),await(i==null?void 0:i.moveLaserToPoint({x:a.x,y:a.y,z:o})),console.log("ext?.moveLaser",a.x,a.y,o),await(i==null?void 0:i.updateLaserHeadRedCross(c-o)),this.uiState.stickerStep===1&&(this.updateState({stickerStep:2}),await this.enterMultiPointMode(),this.gtmDialogOperation("next","photoAlignment"))}}catch(i){return console.error("measureDistance",i),Promise.reject(i)}finally{this.updateState({measureDistanceLoading:!1})}}async enterMultiPointMode(){var t,i,r,s,o,a;try{await((i=(t=this.ext)==null?void 0:t.apis)==null?void 0:i.exitUpgradeMode()),await((s=(r=this.ext)==null?void 0:r.apis)==null?void 0:s.enterMultiPointMode()),(o=this.ext)==null||o.on(ss.DEVICE_STATE_CHANGE,this.handleDeviceStatusChange),this.updateState({posData:[]}),this.undoStack=[],this.updateUndoRedoState(),(a=this.ext)==null||a.on("handleReceiveStickerPoint",this.addPosition)}catch(l){return console.error("enterMultiPointMode",l),Promise.reject(l)}}async leaveMultiPointMode(){var t,i,r,s;await((i=(t=this.ext)==null?void 0:t.apis)==null?void 0:i.exitUpgradeMode()),(r=this.ext)==null||r.off(ss.DEVICE_STATE_CHANGE,this.handleDeviceStatusChange),(s=this.ext)==null||s.off("handleReceiveStickerPoint",this.addPosition)}updateUndoRedoState(){this.updateState({isEnableUndoPos:this.uiState.posData.length>0}),this.updateState({isEnableRedoPos:this.undoStack.length>0}),this.updateState({isEnableCompleteSticker:this.uiState.posData.length===4})}undoHandle(){const t=[...this.uiState.posData],i=t.length;i!==0&&(this.undoStack.push(t[i-1]),t.pop(),this.updateState({posData:t}),this.updateUndoRedoState())}redoHandle(){const t=[...this.uiState.posData],i=t.length;if(this.undoStack.length===0||i>=4)return;const r=this.undoStack.pop();t.push(r),this.updateState({posData:t}),this.updateUndoRedoState()}completeStickerHandle(){this.closeStickerStepDialog();const i=this.uiState.posData.map(s=>[s.x,s.y]);this.gotoCamera(i);const{deviceDataHandler:r}=qx();r("processStartPoint",Hy.ABSOLUTE),this.gtmDialogOperation("finish","photoAlignment")}stickerStep2DismissHandle(){this.closeStickerStepDialog(),this.gtmDialogOperation("close-2","photoAlignment")}closeStickerStepDialog(){this.updateState({stickerStep:null}),this.leaveMultiPointMode()}cameraTipIKnowHandle(){this.updateState({isShowCameraTipDialog:!1}),this.gotoCamera(),this.gtmPhotoKnown()}cameraTipNeverRemindHandle(){this.updateState({isShowCameraTipDialog:!1}),this.gotoCamera(),localStorage.setItem(U5,"1")}async loadCorrectPicture(t){var c;const i=fn().canvasId;if(console.log("loadCorrectPicture",t,i),!i||H5.includes(this.extId)===!1||(bn.cleanCanvasBackdrop(),this.currentMode!==zt.LASER_PLANE))return;let r;if(this.isSupportSticker){const u=localStorage.getItem(this.getStickerPosKey());u&&(r=JSON.parse(u),console.log("loadDPicture positions",r))}const{current:s}=((c=this.ext)==null?void 0:c.getCurrentArea(this.currentMode))||{},o={width:424,height:348},a=r,l=this.getSnCode();try{console.log("====loadDPicture",s,l,this.extId);const u=await window.MeApi.openNative.correctPicture(s.width,s.height,this.extId,o.width,o.height,a,l);if(u){const h=await window.MeApi.fileHelper.read2Blob(u),d=await GB(h);bn.updateCanvasBackdrop(this.backdropOption(),d,fn().canvasId)}}catch(u){console.log("loadDPicture",u)}this.refreshState()}async updateBgImage(){if(G5.includes(this.extId)===!1)return;bn.cleanCanvasBackdrop();const t=bn.canvasId,i=bn.canvasBgImageMap.get(t);i&&bn.updateCanvasBackdrop(...i)}get ext(){return bt().ext}get extId(){return bt().extId}get currentMode(){return bn.getCurrentMode()}buttonClick(t){console.log("buttonClick",t)}dialogShow(t){console.log("dialogShow",t)}gtmPhotoClick(){console.log("gtmPhotoClick")}gtmDialogOperation(t,i){this.dialogOperation({type:t,name:i,msg:""})}dialogOperation(t){console.log("dialogOperation",t)}gtmPhotoKnown(){console.log("gtmPhotoKnown")}}const Bpt=/^xTool_(.*?)_v2_/,u7e="192.168.40.1",Fpt="HOTSPOT_PASSWORD_MAP",V5=n=>{const e=[],t="<<<%base64%>>>",s=JSON.stringify(n,(l,c)=>l==="base64"?(e.push(c),t):c instanceof Map?{dataType:"Map",value:Array.from(c.entries())}:c).split(t),o=s.length,a=[];for(let l=0;l<o;l++)a.push(s[l]),l<e.length&&a.push(e[l]);return a},mN=n=>{var e;if(n)try{(e=window.MeApi)==null||e.openNative.openWebInApp(n)}catch(t){console.log("[ openBrowser error ] > ",t)}},Upt=async()=>{var e;return await((e=window.MeApi)==null?void 0:e.app.getOsPlatform())==="iPhone"},Gpt=n=>n?[zt.PRINTER_KNIFE_CUT.toString(),zt.LASER_CONVEYOR_FEEDER.toString(),zt.CURVE_PROCESS.toString(),zt.SCREEN_PRINT.toString(),zt.CONVEYOR_EXTENSION.toString(),zt.RELIEF_PROCESS.toString(),zt.BATCH_PROCESS.toString()].includes(n):!1,Hpt=(n,e,t)=>{let i="",r=!1,s="device.process.before_process_default_data_tips_content";if(n&&n.processIgnore)return{isPowerChanged:r,content:i,translateKey:""};if(n&&n.data){const o=n.data[n.processingType];if(o){const a=o.parameter.customize;nt.F1===e&&n.processingType===cn.BITMAP_ENGRAVING&&a.power<=10?(r=!0,i="1~10%"):(nt.M1===e||nt.M2===e)&&t===zt.KNIFE_CUT?n.processingType!==cn.BITMAP_ENGRAVING&&a.cutPressure&&a.cutPressure===45&&(r=!0,i="45",s="mobile.process.before_process_default_data_tips_content_m1"):a.power===1&&(r=!0,i="1%")}}return{isPowerChanged:r,content:i,translateKey:s}},Vy=n=>{const{fractionDigits:e,scale:t}=si().unit;return Number((n*t).toFixed(e))},h7e=n=>{const{scale:e}=si().unit;return n/e};class Lh{constructor(e){this.action=e}}var ks=(n=>(n.show="show",n.close="close",n.cancel="cancel",n.laterReminder="laterReminder",n.laterUpdate="laterUpdate",n.updateNow="updateNow",n.retry="retry",n.updateAppNow="updateAppNow",n.changeLogNext="changeLogNext",n))(ks||{}),zy=(n=>(n.DOWNLOAD="download",n.UPDATE="update",n))(zy||{}),as=(n=>(n.changeLog="changeLog",n.changeLogForce="changeLogForce",n.appVersionLow="appVersionLow",n.download="download",n.upload="upload",n.updating="updating",n.success="success",n.failed="failed",n))(as||{});let d7e=class{getExt(){return bt().ext}updateDeviceInfo(){return bt().updateDeviceInfo()}getDeviceInfo(){return bt().info}getCheckSoftVersionInfo(){return si().currentCheckSoftVersionInfo}};const f7e=new d7e;class p7e extends Yc{createState(){return{isShowPopup:!1,currentVersion:"",currentAppVersion:"",currentStep:as.changeLog,lastCheckResult:null,downloading:!1,downloadPercent:0,uploading:!1,updating:!1,uploadPercent:0,isCancel:!1,canClick:!0,failType:null}}setEventHandler(){this.registerEventHandler(Lh,this.handleFirmwareUpdateClickAction)}handleFirmwareUpdateClickAction(e){switch(e.action.id){case ks.show:this.show();break;case ks.close:this.close();break;case ks.cancel:this.cancel();break;case ks.laterReminder:this.laterReminder();break;case ks.laterUpdate:this.laterUpdate();break;case ks.updateNow:this.updateNow();break;case ks.retry:this.retry();break;case ks.updateAppNow:this.updateAppNow();break;case ks.changeLogNext:this.changeLogNext();break}}get ext(){return bt().ext}get extId(){return bt().extId??""}async show(){const{deviceInfo:e={}}=this.ext;let t=e.version;Wv.isArray(t)&&(t=t.map(u=>u.contentVersion).join(","));const i=await window.MeApi.app.getAppVersion(),r=Sp(Ed.AppVar,i);this.updateState({currentVersion:t,currentAppVersion:r,lastCheckResult:Fu.lastCheckResult});const{appVersionLow:s,shouldUpdate:o,forceUpdate:a}=this.uiState.lastCheckResult||{};console.log("appVersionLow: ",s),console.log(this.uiState.lastCheckResult),s?this.goTo(as.appVersionLow):a?this.goTo(as.changeLogForce):this.goTo(as.changeLog);const l=o&&![nt.P1].includes(this.extId);this.updateState({isShowPopup:l})}close(){this.updateState({updating:!1}),this.updateState({isShowPopup:!1}),this.resetState}cancel(){const e=this.ext;e&&(this.updateState({isCancel:!0}),this.uiState.downloading?e.downloadCancelable&&e.downloadCancelable():this.uiState.uploading&&e.uploadCancelable&&e.uploadCancelable(),this.updateState({isShowPopup:!1}),console.log("固件升级过程中点击取消按钮"))}laterReminder(){mE.add({id:this.extId||"",version:this.uiState.lastCheckResult.latestVersion}),this.cancel()}laterUpdate(){console.log("需强制更新固件-暂不更新"),this.updateState({isShowPopup:!1})}async updateNow(){var r;const e=this.ext,t=bt().isInProcessing;if(!bt().connected){this.sendEffect({showToast:{msgKey:"device.firmware.empty_ext"}});return}if(t){this.sendEffect({showToast:{msgKey:"device.firmware.busy_tips"}}),YI({result:"fail",type:"busy",currentVersion:this.uiState.curVersion,latestVersion:this.uiState.latestVersion});return}(r=e==null?void 0:e.downloadCancelable)==null||r.call(e),console.info(["=> 开始更新固件",Fu.lastCheckResult]);const{downloadUrl:i}=Fu.lastCheckResult;if(i)try{Fu.isFirmwareUpdating=!0;let s=null;try{console.log("=> start download",i),this.updateState({canClick:!1});const[o,a,l]=await this.download(i);if(s=l,!o){Tt.log("固件更新前置检测失败",a);return}console.log("=> end download"),this.updateState({canClick:!0})}catch(o){throw this.updateState({canClick:!0}),{error:o,type:zy.DOWNLOAD}}try{console.log("=> start upload"),this.goTo(as.upload);let o=0,a;const l=new Promise((c,u)=>{a=setInterval(()=>{if(bt().connected)o=0;else{if(o+=1,o<=15)return;a&&clearInterval(a),console.log("设备断开连接",o),u("设备断开连接")}},1e3)});await Promise.race([this.upload(s),l]),a&&clearInterval(a),console.log("=> end upload")}catch(o){throw{error:o,type:zy.UPDATE}}console.log("=> start checkUpdated"),this.goTo(as.updating);try{await this.checkUpdated()}catch(o){throw{error:o,type:zy.UPDATE}}console.log("=> end checkUpdated"),this.goTo(as.success),console.log("更新设备信息"),bt().updateDeviceInfo(),YI({result:"success",currentVersion:this.uiState.currentVersion,latestVersion:this.uiState.lastCheckResult.latestVersion})}catch(s){console.error(["=> 固件更新失败",s]),this.updateState({failType:s.type}),YI({result:"fail",type:s.type,currentVersion:this.uiState.currentVersion,latestVersion:this.uiState.lastCheckResult.latestVersion}),this.uiState.isCancel||(this.goTo(as.failed),s instanceof G6&&this.sendEffect({showToast:{msgKey:"common.network_error"}})),e==null||e.removeTag()}finally{Fu.isFirmwareUpdating=!1}}retry(){return this.updateNow()}updateAppNow(){var t,i;const e=((t=f7e.getCheckSoftVersionInfo())==null?void 0:t.downloadUrl[0])??"";console.log("[低版本更新，立即下载]",e),window&&((i=window.MeApi)==null||i.updateAppVersion(e))}goTo(e){this.updateState({currentStep:e})}checkUpdated(){const e=this.ext;if(!e)return;const{latestVersion:t}=this.uiState.lastCheckResult;return this.updateState({updating:!0}),e.checkFirmwareUpdated(t,{onCheckProgress:()=>{this.uiState.uploadPercent<98&&this.updateState({uploadPercent:this.uiState.uploadPercent+2})}},this.uiState.lastCheckResult).finally(()=>{this.updateState({uploadPercent:100}),this.updateState({updating:!1})})}async download(e){this.resetState();const t=this.ext;if(t)return new Promise((i,r)=>{t.downloadFirmware(async s=>{this.updateState({downloading:!0}),this.goTo(as.download);try{const o=await s();i([!0,"",o])}catch(o){console.log(o),r(o)}},s=>{Tt.info("前置检测","downloadFirmware",s),i([!1,s,""])},{url:e,onDownloadProgress:s=>{const{loaded:o,total:a,count:l=1,index:c=0}=s;let u=o/a;l>1&&(u=u/l+c/l),console.log(["=> download",u]),this.updateState({downloadPercent:Math.floor(u*100)})}}).finally(()=>{this.updateState({downloading:!1})})})}async upload(e){console.log("upload data: ",e);const t=this.ext;if(!t)return;this.updateState({uploading:!0});let{md5List:i}=this.uiState.lastCheckResult;return i=JSON.parse(JSON.stringify(i)),console.log("[upload deviceFirmware md5]=>",i),t.updateFirmware({data:e,md5List:i,onUploadProgress:r=>{const{loaded:s,total:o,count:a=1,index:l=0}=r;let c=r.percent||r.percent===0?r.percent:s/o;a>1&&(c=c/a+l/a),console.log(["=> upload",Math.floor(c*100)]),this.updateState({uploadPercent:Math.floor(c*100)})}}).finally(()=>{this.updateState({uploading:!1})})}changeLogNext(){this.updateNow()}resetState(){const e={downloading:!1,downloadPercent:0,uploading:!1,updating:!1,uploadPercent:0,isCancel:!1};this.updateState(e)}}const Uk=new Ste;window.openApi&&(window.openApi.onBackPressed=()=>{const n=Uk.peek();return(n==null?void 0:n())||!1});function vN(n){Zn(()=>{Uk.push(n)}),qo(()=>{Uk.pop()})}function Ia(n=null,e,t={},i=null){var a;let r=i;r||(r=document.createElement("div"));const o=ye(e,{...t,onClose:()=>{var l;kN(null,r),document.body.removeChild(r),(l=t.onClose)==null||l.call(t)}});return o.appContext=n,kN(o,r),document.body.appendChild(r),{exposed:(a=o.component)==null?void 0:a.exposed}}class g7e{async selectFileByType(e){return await Dj("",e)}}const m7e=new g7e,v7e=ba("importFile_module",{getters:{},actions:{selectFileByType(n){return m7e.selectFileByType(n)}}});class _7e{async openLocalExt(e){await bt().openLocalExt(e)}openMultiProjectFromFile(e){return kn().openMultiProjectFromFile(e)}openImageFromFile(e){return fn().loadResToCanvas({file:e})}closeLoginModal(){return xp().closeLoginModal()}isShowingReopenConfirm(){return kn().isShowingReopenConfirm()}}const OI=new _7e;class LI{}class y7e extends LI{async handle(e,t){console.log("FontHandle handle",e,t),e&&tt.modal.showToast({icon:"info",msg:"common.msg.import_font_success",duration:3e3})}getFileExtension(){return["ttf","ttc","otf","otc"]}}class A7e extends LI{async handle(e,t){console.log("ExtHandle handle",e,t),e&&await OI.openLocalExt(e)}getFileExtension(){return["ext"]}}class b7e extends LI{async handle(e,t){if(console.log("XcsHandle handle",e,t),e){if(OI.isShowingReopenConfirm()){window.MeApi.openFile.setFile(e);return}await tt.event.outOpenFileSuccess(e,t)}}getFileExtension(){return["xcs"]}}class w7e extends LI{async handle(e,t){if(console.log("ImageHandle",e,t),e){if(OI.isShowingReopenConfirm()){window.MeApi.openFile.setFile(e);return}await tt.event.outOpenFileSuccess(e,t)}}getFileExtension(){return["jpg","jpeg","png","bmp","gif","webp","svg","dxf"]}}class x7e{constructor(){E(this,"fileHandleArray",new Array);this.fileHandleArray.push(new y7e),this.fileHandleArray.push(new A7e),this.fileHandleArray.push(new b7e),this.fileHandleArray.push(new w7e)}init(){this.setOpenHandleMethod()}setOpenHandleMethod(){if(OI.closeLoginModal(),!window.MeApi)throw new Error("OutOpenManager window.MeApi is not defined");window.MeApi.openFile.setOpenDataHandle(async e=>{if(bv().get("PRIVACY_NEW_KEY",!1))try{let i=atob(e);i=decodeURIComponent(i),tt.event.outOpenData(JSON.parse(i))}catch(i){console.log("Open outside data error====>",i)}}),window.MeApi.openFile.setOpenFileHandle(async e=>{if(!e||!bv().get("PRIVACY_NEW_KEY",!1))return;const i=this.getFileExtension(e),r=this.fileHandleArray.find(o=>i?o.getFileExtension().includes(i):!1);if(!i||!r){tt.modal.showToast({msg:"mobile.projects.not_support_import_file"});return}if(tt.event.outOpenFileStart(e,i))try{await(r==null?void 0:r.handle(e,i))}catch(o){console.log("OutOpenManager =======> error",o)}finally{tt.event.outOpenFileEnd(e,i)}})}getFileExtension(e){const t=e.split(".").pop();return(t==null?void 0:t.toLowerCase())||""}}const C7e=new x7e,E7e=ba("out_open_module",{getters:{},actions:{initOutOpen(){C7e.init()}}}),T7e={name:"mode",label:"device.common.mode",widget:"select",widgetAttrs:{options:[]},labelSuffix:{widget:"popover",widgetAttrs:{triggerSlot:{type:"icon",icon:"infomation"},width:200,content:"device.common.rotary_attachment_type_tip"},visible:n=>n.mode==="LASER_CYLINDER"}},I7e={name:"material",label:"device.common.material",dividerLine:"divider-line",widget:"material",widgetAttrs:{options:[]}},S7e={name:"thickness",label:"device.common.thickness",inline:!0,widget:"unitInput",showOverlay:!0,noBorder:!0,widgetAttrs:{parentEle:".bottom-box",showButton:!1}},P7e={name:"focalLength",label:"device.common.focal_length",inline:!0,widget:"unitInput",showOverlay:!0,noBorder:!0,widgetAttrs:{parentEle:".bottom-box",showButton:!1,noBorder:!0}},M7e=[{label:"device.common.roller",value:"roller"},{label:"device.common.catch",value:"catch"}],R7e={name:"rotaryAttachmentType",labelClassName:"justify-start",class:window.VITE_PAD?"radio-group-bg ml-8 mr-8 mb-4":"radio-group-bg",label:window.VITE_PAD?null:"device.common.rotary_attachment_type",widget:window.VITE_PAD?"radioGroup":"select",labelSuffix:window.VITE_PAD?{widget:"popover",widgetAttrs:{triggerSlot:{type:"icon",icon:"infomation"},width:200,content:"device.common.rotary_attachment_type_tip"}}:{},widgetAttrs:{class:"",options:M7e,defaultValue:"roller"}},qJ={name:"perimeter",label:"device.common.perimeter",widget:"unitInput",showOverlay:!0,labelClassName:"no-padding",widgetAttrs:{parentEle:".bottom-box",allowEmpty:!0,showButton:!1,min:3,max:377}},KJ={name:"diameter",label:"device.common.diameter",widget:"unitInput",showOverlay:!0,widgetAttrs:{parentEle:".bottom-box",allowEmpty:!0,showButton:!1,min:1,max:120}},D7e={name:"lightSourceMode",label:"device.common.light_source_mode",widget:"select",widgetAttrs:{options:[{value:"red",label:"device.common.red_light"},{value:"blue",label:"device.common.blue_light"},{value:"blueRedMix",label:"device.common.blue_red_light"}],defaultValue:"blue"}},k7e={name:"catchMode",label:null,class:"flex-row catch-mode-bg border-t ml-8 mr-8",type:"group",direction:"column",visible:n=>n.rotaryAttachmentType==="catch",childs:[qJ,KJ]},O7e=[zt.LASER_CYLINDER],L7e=[zt.LASER_PLANE,zt.LASER_CYLINDER],JJ={name:"quickMeasurementBtn",icon:"new-device-auto-measure",widget:"button",disabled:n=>!L7e.includes(n.mode),widgetAttrs:{style:{"--n-icon-size":"16px"}}},ZJ={name:"preciseMeasurementBtn",icon:"new-device-measure",widget:"button",disabled:n=>O7e.includes(n.mode),widgetAttrs:{style:{"--n-icon-size":"14px"}}},N7e={name:"thicknessGroup",label:"device.common.thickness",inline:!0,unitExtra:!1,type:"group",childs:[{name:"thickness",widget:"unitInput",showOverlay:!0,noBorder:!0,widgetAttrs:{parentEle:".bottom-box",showButton:!1}},JJ,ZJ]},B7e={name:"focalLengthGroup",label:"device.common.focal_length",unitExtra:!1,type:"group",childs:[{name:"focalLength",widget:"unitInput",showOverlay:!0,widgetAttrs:{parentEle:".bottom-box",showButton:!1,noBorder:!0}},ZJ,JJ]},F7e={name:"processPath",label:"device.common.process_path",widget:"select",widgetAttrs:{placeholder:"",options:[{value:Yu.AUTO,label:"device.common.process_path_by_auto",desc:"device.common.process_path_by_auto_desc"},{value:Yu.LAYER,label:"device.common.process_path_by_layer",desc:"device.common.process_path_by_layer_desc"}],defaultValue:Yu.AUTO}},U7e={name:"isProcessByLayer",label:"device.common.process_path_by_layer",widget:"switch",widgetAttrs:{size:"20px"},labelClassName:"h-8",inline:!0,visible:n=>n.pathPlanning===Zs.CUSTOM},G7e={name:"fillPlanning",label:"device.common.fill_path",widget:"select",titleClass:"title-wrap",visible:n=>n.pathPlanning===Zs.CUSTOM,itemStyle:{width:"100%"},widgetAttrs:{placeholder:"",options:[{value:Dc.GROUP,label:"device.common.all_together"},{value:Dc.SEPARATE,label:"device.common.one_by_one"}]}},H7e={name:"dreedyTsp",label:"device.common.smart_scan",widget:"switch",widgetAttrs:{size:"20px"},inline:!0,visible:n=>!!n.supportDreedyTsp&&n.pathPlanning===Zs.CUSTOM},V7e={name:"pathPlanning",label:"device.common.processing_path",widget:"select",labelClassName:"justify-start",labelSuffix:{widget:"popover",widgetAttrs:{label:"device.common.process_path",triggerSlot:{type:"icon",icon:"infomation"},to:"body",width:"200px",content:{text:"device.processing_attrs.processing_path_tips",button:{style:{marginTop:"8px"},label:"device.processing_attrs.processing_path_know_more",href:"https://s.xtool.com/doc/device/process-path"}}}},widgetAttrs:{options:[{value:Zs.AUTO,label:"device.common.auto_planning"},{value:Zs.CUSTOM,label:"device.common.user_defining"}],style:{}}},z7e={name:"pathPlanningGroup",label:"",type:"group",direction:"column",childs:[V7e,G7e,U7e,H7e]},z5=[{label:"device.common.z_mode",value:"zMode"},{label:"device.common.one_way",value:"oneWay"}],$5=[10,20,30,40,50,60,70,80,90,100,120,140,160,180,200,220,240,260,280,300].map(n=>({label:String(n),value:n})),$7e={name:"processIgnore",label:"device.element_container.output",widget:"switch",inline:!0,itemClass:"process-ignore",labelClassName:"process-ignore-label",widgetAttrs:{size:"small",checkedValue:!1,uncheckedValue:!0}},W7e=window.VITE_PAD?{name:"processingType",widget:"inlineSelect",widgetAttrs:{label:"device.element_container.output_type",options:[]}}:{name:"processingType",label:"device.element_container.output_type",widget:"select",inline:!0,widgetAttrs:{options:[]}},j7e={name:"materialType",widget:"paramSelect",widgetAttrs:{label:"device.element_container.param",labelSuffix:{widget:"popover",widgetAttrs:{triggerSlot:{type:"icon",icon:"infomation"},to:"body",content:{text:"device.processing_attrs.parameter_tips",button:{label:"device.processing_attrs.know_more",href:"https://support.xtool.com/article/1222"}},visible:n=>n.materialType==="official"}},options:[],placeholder:"",to:"body",style:{maxWidth:"100%"}}},Q7e={name:"materialType",label:"device.element_container.param",inline:!0,labelSuffix:{widget:"popover",widgetAttrs:{triggerSlot:{type:"icon",icon:"infomation"},to:"body",content:{text:"device.processing_attrs.parameter_tips",button:{label:"device.processing_attrs.know_more",href:""}},visible:n=>n.materialType==="official"}},widget:"paramSelect",widgetAttrs:{options:[],placeholder:"",to:"body",style:{maxWidth:"100%"}}},X7e=window.VITE_PAD?j7e:Q7e,Y7e={name:"bitmapEngraveMode",label:"device.common.engrave_mode",widget:"radioGroup",widgetAttrs:{options:[{value:"normal",label:"device.common.normal_mode"},{value:"dot",label:"device.common.dot_mode"}]}},q7e={name:"dotDuration",label:"device.common.dot_duration",widget:"slider",unitExtra:"(μs)",widgetAttrs:{size:"small",parentEle:".bottom-box",showInput:!0,min:10,max:3e3,step:10,digits:0,unit:"μs"},itemClass:window.VITE_PAD?"ml-8 mr-8":""},K7e={name:"power",label:"device.common.power",unitExtra:"(%)",unitExtraDesc:!1,widget:"slider",widgetAttrs:{size:"small",parentEle:".bottom-box",showInput:!0,min:1,max:100,digits:0,unit:"%"},itemClass:window.VITE_PAD?"ml-8 mr-8":""},J7e={name:"cutPressure",label:"device.common.cut_pressure",unitExtra:"(g)",unitExtraDesc:!1,widget:"slider",widgetAttrs:{size:"small",parentEle:".bottom-box",showInput:!0,min:45,max:360,digits:0,unit:"g"},itemClass:window.VITE_PAD?"ml-8 mr-8":""},Z7e={name:"speed",label:"device.common.speed",unitExtra:"(mm/s)",unitExtraDesc:!1,widget:"slider",widgetAttrs:{size:"small",parentEle:".bottom-box",showInput:!0,min:1,digits:0,unit:"mm/s"},itemClass:window.VITE_PAD?"ml-8 mr-8":""},eqe={name:"repeat",label:"device.common.pass",widget:"number",widgetAttrs:{size:"small",parentEle:".bottom-box",min:1,max:10,digits:0,allowEmpty:!1},inline:!0,itemClass:window.VITE_PAD?"parameter-panel-inline ml-8 mr-8":"parameter-panel-inline"},tqe=window.VITE_PAD?{name:"density",widget:"inlineSelect",widgetAttrs:{label:"device.common.lines_per_cm",placeholder:"",options:$5,to:!1}}:{name:"density",label:"device.common.lines_per_cm",widget:"select",widgetAttrs:{placeholder:"",options:$5,to:!1},inline:!0},nqe=window.VITE_PAD?{name:"bitmapMode",widget:"inlineSelect",widgetAttrs:{label:"device.common.bitmap_mode",placeholder:"",options:UB,to:!1}}:{name:"bitmapMode",label:"device.common.bitmap_mode",widget:"select",inline:!0,widgetAttrs:{placeholder:"",options:UB,to:!1}},iqe=window.VITE_PAD?{name:"bitmapScanMode",widget:"inlineSelect",widgetAttrs:{label:"device.common.bitmap_scan_mode",placeholder:"",options:z5,to:!1}}:{name:"bitmapScanMode",label:"device.common.bitmap_scan_mode",widget:"select",inline:!0,widgetAttrs:{placeholder:"",options:z5,to:!1}},rqe={name:"enableBreakPoint",widget:window.VITE_PAD?"radioGroup":"switch",label:"device.common.break_point_cut",labelClassName:window.VITE_PAD?"ml-8 mr-8":"",widgetAttrs:{options:[{label:"device.common.on",value:!0},{label:"device.common.off",value:!1}],checkedValue:!1,uncheckedValue:!0}},sqe={name:"breakPointSize",widget:"number",unitExtra:window.VITE_PAD?"(mm)":"mm",unitExtraDesc:!1,label:"device.common.break_point_size",visible:n=>!!n.enableBreakPoint,widgetAttrs:{size:"small",parentEle:".bottom-box",min:.2,max:1,step:.1,digits:1,allowEmpty:!1,unit:"mm"},inline:!0,itemClass:window.VITE_PAD?"parameter-panel-inline ml-8 mr-8":""},oqe={name:"breakPointMode",label:window.VITE_PAD?"":"device.common.break_point_mode",widget:window.VITE_PAD?"inlineSelect":"select",inline:!window.VITE_PAD,placeholder:"",visible:n=>!!n.enableBreakPoint,widgetAttrs:{label:window.VITE_PAD?"device.common.break_point_mode":"",style:{},options:[{value:iA.COUNT,label:"device.common.break_point_by_count"},{value:iA.DISTANCE,label:"device.common.break_point_by_distance"}],to:!1}},aqe={name:"breakPointCount",widget:"slider",label:"device.common.break_point_count",itemClass:window.VITE_PAD?"ml-8 mr-8":"",visible:n=>!!n.enableBreakPoint&&n.breakPointMode===iA.COUNT,widgetAttrs:{size:"small",parentEle:".bottom-box",showInput:!0,min:1,max:50,step:1,digits:0}},lqe={name:"breakPointDistance",label:"device.common.break_point_distance",unitExtra:"mm",unitExtraDesc:!1,widget:"slider",visible:n=>!!n.enableBreakPoint&&n.breakPointMode===iA.DISTANCE,widgetAttrs:{size:"small",parentEle:".bottom-box",showInput:!0,min:10,max:1e3,step:1,digits:0,unit:"mm"}},cqe={name:"dpi",widget:"slider",label:"device.common.dpi",widgetAttrs:{size:"small",parentEle:".bottom-box",showInput:!0,min:1,max:1270,digits:0},itemClass:window.VITE_PAD?"ml-8 mr-8":""},uqe={name:"breakPointPower",widget:"number",unitExtra:window.VITE_PAD?"(%)":"%",unitExtraDesc:!1,label:"device.common.break_point_power",visible:n=>!!n.enableBreakPoint,widgetAttrs:{size:"small",parentEle:".bottom-box",min:0,max:90,step:1,digits:0,unit:"%",allowEmpty:!1,style:{}},inline:!0,itemClass:window.VITE_PAD?"parameter-panel-inline ml-8 mr-8":""},hqe={name:"powerMinMaxRange",widget:"sliderRange",label:"device.common.power_range",unitExtra:"(%)",visible:n=>n.bitmapEngraveMode==="dot"&&n.bitmapMode==="grayscale",inputWrapperStyle:{flexWrap:"wrap"},widgetAttrs:{size:"small",parentEle:".bottom-box",range:!0,showNumber:!0,showText:!0,min:1,max:100,digits:0,unit:"%"},itemClass:window.VITE_PAD?"ml-8 mr-8":""},dqe={name:"frequency",label:"device.common.frequency",unitExtra:"(kHz)",widget:"slider",widgetAttrs:{size:"small",showInput:!0,min:30,max:60,digits:0,showButton:!1,borderLess:!0,unit:"kHz"},visible:n=>n.processingLightSource==="red",itemClass:window.VITE_PAD?"ml-8 mr-8":""},W5={mode:T7e,material:I7e,thickness:S7e,thicknessGroup:N7e,focalLength:P7e,focalLengthGroup:B7e,rotaryAttachmentType:R7e,perimeter:qJ,diameter:KJ,lightSourceMode:D7e,catchMode:k7e,processPath:F7e,pathPlanningGroup:z7e,processIgnore:$7e,processingType:W7e,materialType:X7e,power:K7e,cutPressure:J7e,speed:Z7e,repeat:eqe,density:tqe,bitmapMode:nqe,bitmapScanMode:iqe,enableBreakPoint:rqe,breakPointSize:sqe,breakPointMode:oqe,breakPointCount:aqe,breakPointDistance:lqe,breakPointPower:uqe,bitmapEngraveMode:Y7e,dotDuration:q7e,dpi:cqe,powerRange:hqe,frequency:dqe},fqe=[{path:"/:pathMatch(.*)*",redirect:"/"},{name:"/",path:"/",redirect:"/main"},{name:"main",path:"/main",component:()=>Pi(()=>import("./index-754fNoS4.js"),__vite__mapDeps([9,10,4,5,1,11,6,12,7]),import.meta.url),children:[{path:"home",component:()=>Pi(()=>import("./home-ZBXW98bt.js"),__vite__mapDeps([13,14,15,4,16,1,6,7,5,17,11,12,18]),import.meta.url),meta:{title:"homePage"}},{path:"projects",component:()=>Pi(()=>import("./index-0yD8KSdE.js"),__vite__mapDeps([19,17,4,6,7,1,14,15,16,20,5,18]),import.meta.url)}],redirect:"/main/home"},{name:"connect-device",path:"/connect-device",component:()=>Pi(()=>import("./index-QtrcpKXE.js"),__vite__mapDeps([21,22,1,6,4,5,23,7,14,24,25]),import.meta.url)},{name:"new-device",path:"/new-device",component:()=>Pi(()=>import("./index-atWsQG3N.js"),__vite__mapDeps([26,5,4,6,24,1,25,7,10,23]),import.meta.url)},{name:"editor-setting",path:"/editor-setting",component:()=>Pi(()=>import("./index-k-x69QfE.js"),__vite__mapDeps([27,5,4,28,1,6,7,29,16,30]),import.meta.url),props:n=>({filePath:n.query.filePath})},{name:"editor",path:"/editor",component:()=>Pi(()=>import("./index-EYoMjYy0.js"),__vite__mapDeps([31,4,1,6,7,28,11,16,30,18,25,32,33,5]),import.meta.url),meta:{title:"editPage"}},{name:"process",path:"/process",component:()=>Pi(()=>import("./index-DbmKAz3P.js"),__vite__mapDeps([34,32,1,4,7,6,5,25,20]),import.meta.url)},{name:"material",path:"/material",component:()=>Pi(()=>import("./index-boqBdARU.js"),__vite__mapDeps([35,4,1,5,6,7]),import.meta.url)},{name:"device-setting",path:"/device-setting",component:()=>Pi(()=>import("./index-dUN4QEi_.js"),__vite__mapDeps([36,6,4,1,33,37,5,7]),import.meta.url)},{name:"privacy",path:"/privacy",component:()=>Pi(()=>import("./index-pz0EIdNc.js"),__vite__mapDeps([38,6,4,7,1,5]),import.meta.url)},{name:"system-setting",path:"/system-setting",component:()=>Pi(()=>import("./index-oAR9KX4n.js"),__vite__mapDeps([39,4,1,40,5,6,7]),import.meta.url)},{name:"system-about",path:"/system-about",component:()=>Pi(()=>import("./about-4Rdeb4vP.js"),__vite__mapDeps([41,23,1,4,40,6,5,7]),import.meta.url)},{name:"local-debugg",path:"/local-debugg",component:()=>Pi(()=>import("./index-A54THr5o.js"),__vite__mapDeps([42,5,4,40,1,7,6]),import.meta.url)},{name:"personal-setting",path:"/personal-setting",component:()=>Pi(()=>import("./index-K6PsDQ08.js"),__vite__mapDeps([43,6,4,5,16,15,1,40,7]),import.meta.url)},{name:"set-password",path:"/set-password",component:()=>Pi(()=>import("./index-vRYiIf5g.js"),__vite__mapDeps([44,22,1,6,4,5,37,7]),import.meta.url)},{name:"modifyHotspotPwd",path:"/modifyHotspotPwd",component:()=>Pi(()=>import("./modifyhotspotpwd-PdWsv42Y.js"),__vite__mapDeps([45,4,6,5,1,37,46,7]),import.meta.url),meta:{title:"修改密码"}},{name:"configWifiByHotspot",path:"/configWifiByHotspot",component:()=>Pi(()=>import("./configwifibyhotspot-6AyvAm6O.js"),__vite__mapDeps([47,46,1,37,6,4,5,7]),import.meta.url),meta:{title:"WIFI配置"}},{name:"more-material",path:"/more-material",component:()=>Pi(()=>import("./xcs-app-xcs-app-mobile-src-page-editor-setting-more-material-dnbs2u9g.js"),__vite__mapDeps([48,29,16,30,4,5,6,1,7]),import.meta.url)}],Ls=Zee({history:ete(),routes:fqe});Ls.beforeEach((n,e,t)=>{var r;const i=(r=n==null?void 0:n.meta)==null?void 0:r.title;i&&(document.title=i),n.fullPath==="/main/home"?bv().get("PRIVACY_NEW_KEY",!1)?t():t({path:"/privacy"}):t()});Ls.afterEach(n=>{var t;const e=window.MeApi||((t=window.parent)==null?void 0:t.MeApi);e&&(e.app.pagePathChange(n.fullPath),console.log(n.fullPath),n.fullPath.startsWith("/personal-setting")?e.app.setStatusBar("#1fb53b",!1):e.app.setStatusBar("#1A1A1E",!1))});class pqe{constructor(){E(this,"toast");E(this,"toastUniqueId","global-event-toast-uniqueId");E(this,"lastOpenXcsFilePath","")}outOpenFileStart(e,t){var l;if(console.log("GlobalEvent outOpenFileStart",e,t),kn().isLoadingProject())return!1;if(!bt().ext)return tt.modal.showSelectDeviceDialog(),!1;const i=Ls.currentRoute.value.path,r=fn().disabledImportToCanvas(),s=bt().isFrameMode||bt().isShowWalkBorderTipModal,o=ha().isMinimized,a=kn().isShowPopToast();if(["/process"].includes(i)||r||s||o||a){const c=r||a?"mobile.projects.not_support_open_file":"mobile.projects.processing_open_file_error";return tt.modal.showToast({msg:c,icon:"warning"}),!1}return(l=this.toast)==null||l.close(),this.toast=tt.modal.showToast({msg:"mobile.common.loading",icon:"loading",duration:0,uniqueId:this.toastUniqueId,layout:"vertical"}),!0}async outOpenFileSuccess(e,t){var r,s;console.log("outOpenFileSuccess ======>",e,t);const i=(r=Ls.currentRoute.value.name)==null?void 0:r.toString();if(Ms.isShowProcessingPanel.value=!1,Ms.isShowFramingPane.value=!1,["editor","more-material"].includes(i||"")){i==="more-material"&&Ls.back();try{if(t.toLocaleLowerCase().includes("xcs")){if(this.lastOpenXcsFilePath){this.lastOpenXcsFilePath=e;return}this.lastOpenXcsFilePath=e;const o=await this.showTipModalPromiss(),a=kn().isNewProject();switch(o){case"check":if(a){const l=await this.showRenameModalPromiss();l&&(await kn().renameCurrentTempXcs(l),await kn().SaveCurrentXcsThenDeleteAll(),kn().openSource=um.externalImport,await kn().openMultiProjectFromFile(this.lastOpenXcsFilePath))}else await kn().SaveCurrentXcsThenDeleteAll(),kn().openSource=um.externalImport,await kn().openMultiProjectFromFile(this.lastOpenXcsFilePath);break;case"cancel":kn().openSource=um.externalImport,await kn().openMultiProjectFromFile(this.lastOpenXcsFilePath);break;case"close":break}this.lastOpenXcsFilePath=""}else kn().openSource=um.externalImport,await kn().openMultiProjectFromFile(e)}catch{this.lastOpenXcsFilePath="",tt.modal.showToast({msg:"mobile.projects.open_xcs_file_error",icon:"error",type:"html",linkTips:"canvas.message.learn_more",uniqueId:this.toastUniqueId,order:-1,openCb:()=>{window.open("https://community.xtool.com/#/making/detail/tips/96")},bckWhiteColor:!0,duration:3e3})}}else Ls.push({path:"/editor",query:{filePath:e,source:um.externalImport}});(s=this.toast)==null||s.close()}outOpenFileEnd(e,t){var i;console.log("GlobalEvent outOpenFileEnd",e,t),(i=this.toast)==null||i.close()}outOpenData(e){var i;const{type:t}=e;if(t==="webCommandSelectMaterial"){Ms.isShowProcessingPanel.value=!0,Ms.isShowFramingPane.value=!1;const r=((i=Ls.currentRoute.value.name)==null?void 0:i.toString())||"";r==="more-material"?(Ls.back(),setTimeout(()=>{el().webCommandSelectMaterial(e)},500)):["editor"].includes(r)?el().webCommandSelectMaterial(e):Ls.push({path:"/editor"}).then(()=>{setTimeout(()=>{el().webCommandSelectMaterial(e)},500)})}}async showTipModalPromiss(){return new Promise(e=>{tt.modal.showTipModal({title:"",content:"mobile.common.save_notice_title",confirmTxt:"mobile.common.yes",cancelTxt:"mobile.common.no",popZIndex:4e3,hasClose:!0,onConfirm:()=>{e("check")},onCancel:()=>{e("cancel")},onClose:()=>{e("close")}})})}async showRenameModalPromiss(){var t;const e=((t=kn().currentTempXcs)==null?void 0:t.name)||"";return new Promise(i=>{tt.modal.showRenameModal({name:e,title:"mobile.projects.dialog_rename_project",confirmTxt:"common.msg.ok",maxLength:50,onConfirm:r=>{i(r)},onCancel:()=>{i("")}})})}}const gqe=["xlink:href"],mqe=Fe({__name:"SvgIcon",props:{prefix:{},color:{},size:{},name:{}},setup(n){return(e,t)=>(V(),le("svg",ht({"aria-hidden":"true",class:e.name,style:{"--svg-size":e.size||"24px","--svg-color":e.color}},e.$attrs),[ue("use",{"xlink:href":`#${e.prefix??"icon"}-${e.name}`,fill:"currentColor"},null,8,gqe)],16))}}),dt=(n,e)=>{const t=n.__vccOpts||n;for(const[i,r]of e)t[i]=r;return t},xn=dt(mqe,[["__scopeId","data-v-753551a8"]]),vqe={class:"pop-container"},_qe={class:"pop-header"},yqe={class:"pop-main"},Aqe={class:"pop-main-title"},bqe={class:"pop-main-content current-scroll-none"},wqe={class:"content-detail"},xqe={class:"pop-footer"},Cqe={class:"common-btn-text"},Eqe={class:"common-btn-text"},Tqe={class:"common-btn-text"},Iqe=Fe({__name:"ModalCenterColumn",props:{toShow:{type:Boolean},show:{type:Boolean},img:{},title:{},content:{},cancelTxt:{},confirmTxt:{},closeTxt:{},hasClose:{type:Boolean},confirmDisabled:{type:Boolean}},emits:["update:show","close","confirm","cancel"],setup(n,{emit:e}){const t=n,i=e,r=te({get:()=>t.show,set:c=>i("update:show",c)}),s=()=>{i("close")},o=()=>{i("cancel")},a=()=>{i("confirm")},l=()=>{t.toShow&&(r.value=!0)};return Zn(()=>{l()}),(c,u)=>{const h=xn,d=ng,f=Hi,p=Ko;return V(),Ie(p,{show:r.value,"onUpdate:show":u[0]||(u[0]=g=>r.value=g),round:"","close-on-click-overlay":!1,class:"common-center-modal","overlay-class":"common-popup-filter-overlay"},{default:be(()=>[c.hasClose?(V(),le("div",{key:0,class:"pop-close-right-top",onClick:s},[ye(h,{name:"common-modal-close",class:"f-s-24"})])):$e("",!0),ue("div",vqe,[ue("div",_qe,[Fs(c.$slots,"header",{},()=>[ye(d,{fit:"contain",src:c.img,class:"pop-header-img"},null,8,["src"])],!0)]),ue("div",yqe,[ue("div",Aqe,[Fs(c.$slots,"title",{},()=>[ue("span",null,Te(c.title),1)],!0)]),ue("div",bqe,[Fs(c.$slots,"content",{},()=>[ue("div",wqe,Te(c.content),1)],!0)])]),ue("div",xqe,[Fs(c.$slots,"footer",{},()=>[c.confirmTxt?(V(),Ie(f,{key:0,type:"primary",class:"common-primary-btn common-btn-medium bottom-btn",block:"",disabled:c.confirmDisabled,onClick:a},{default:be(()=>[ue("span",Cqe,Te(c.confirmTxt),1)]),_:1},8,["disabled"])):$e("",!0),c.cancelTxt?(V(),Ie(f,{key:1,type:"default",class:"common-default-btn common-btn-medium bottom-btn",block:"",onClick:o},{default:be(()=>[ue("span",Eqe,Te(c.cancelTxt),1)]),_:1})):$e("",!0),c.closeTxt?(V(),Ie(f,{key:2,type:"default",class:"common-default-btn common-btn-medium bottom-btn",block:"",onClick:s},{default:be(()=>[ue("span",Tqe,Te(c.closeTxt),1)]),_:1})):$e("",!0)],!0)])])]),_:3},8,["show"])}}}),NI=dt(Iqe,[["__scopeId","data-v-b3af063c"]]),Sqe={class:"dialog-title van-multi-ellipsis--l2"},Pqe={class:"dialog-content"},Mqe={key:0},Rqe=["innerHTML"],Dqe={key:0,class:"dialog-more-box"},kqe={class:"dialog-more"},Oqe={key:1,class:"dialog-message"},Lqe={key:0,class:"dialog-more-box"},Nqe={class:"dialog-more"},Bqe={key:2,class:"dialog-more"},Fqe={class:"dialog-button"},Uqe=Fe({__name:"RemindDialog",props:{message:{},title:{},image:{},link:{},linkText:{},linkType:{},linkTextColor:{},linkNoWrap:{type:Boolean},allowHtml:{type:Boolean},defaultBtn:{type:Boolean},confirmButtonText:{},confirmButtonColor:{}},setup(n){const e=n,t=ee(!0),{t:i}=Yt(),r=()=>{t.value=!1},s=()=>{console.log("跳转 props?.link==",e==null?void 0:e.link),e!=null&&e.link&&window.MeApi.openNative.openWebInApp(e==null?void 0:e.link)};return(o,a)=>{const l=ng,c=xn,u=Hi,h=F0;return V(),le("section",null,[ye(h,ht(o.$attrs,{id:"remind-dialog-wrapper",show:t.value,"onUpdate:show":a[0]||(a[0]=d=>t.value=d),"overlay-class":"common-popup-filter-overlay","confirm-button-text":o.confirmButtonText}),Pr({title:be(()=>[o.image?(V(),Ie(l,{key:0,height:"140px",width:"180px",fit:"cover",class:"dialog-image",src:o.image},null,8,["src"])):$e("",!0),ue("div",Sqe,Te(o.title),1)]),default:be(()=>[ue("div",Pqe,[o.allowHtml?(V(),le("div",Mqe,[ue("span",{class:"dialog-message",innerHTML:o.message},null,8,Rqe),o.linkNoWrap?(V(),le("div",Dqe,[ue("div",kqe,[ue("div",{class:"more-link",style:On({color:o.linkTextColor||"#1a1a1a",fontWeight:o.linkTextColor?"400":"500"}),onClick:s},Te(o.linkText||Be(i)("mobile.connect.learn_more")),5),ye(c,{name:"arrow-right-up",size:"16px",class:"f-s-16",style:On({color:o.linkTextColor||"#1a1a1a"})},null,8,["style"])])])):$e("",!0)])):(V(),le("div",Oqe,[ue("span",null,Te(o.message),1),!o.image&&o.link?(V(),le("div",Lqe,[ue("div",Nqe,[ue("div",{class:"more-link",onClick:s},Te(o.linkText||Be(i)("mobile.connect.learn_more")),1),ye(c,{name:"arrow-right-up",size:"16px",class:"f-s-16"})])])):$e("",!0)])),!o.linkNoWrap&&o.image&&o.link?(V(),le("div",Bqe,[ue("div",{class:"more-link",style:On({color:o.linkTextColor||"#1a1a1a",fontWeight:o.linkTextColor?"400":"500"}),onClick:s},Te(o.linkText||Be(i)("mobile.connect.learn_more")),5),ye(c,{name:"arrow-right-up",size:"16px",style:On({color:o.linkTextColor||"#1a1a1a"}),class:"f-s-16"},null,8,["style"])])):$e("",!0)])]),_:2},[o.defaultBtn?void 0:{name:"footer",fn:be(()=>[ue("div",Fqe,[ye(u,{class:"dialog-confirm",block:"",style:On({backgroundColor:o.confirmButtonColor||"#28BE44"}),onClick:r},{default:be(()=>[Gt(Te(o.confirmButtonText||"OK"),1)]),_:1},8,["style"])])]),key:"0"}]),1040,["show","confirm-button-text"])])}}}),Gqe={class:"inner-container"},Hqe=Fe({__name:"ToastTop",props:{icon:{},msg:{},duration:{},cancel:{type:Function}},setup(n){Yt();const e=n,t=ee(!0),{cancel:i}=e,{duration:r}=o6(e),s=()=>{t.value=!1,i==null||i()};return Zn(()=>{setTimeout(()=>{s()},(r==null?void 0:r.value)||2e3)}),(o,a)=>{const l=xn,c=nte;return V(),le("div",null,[ye(c,{show:t.value,"onUpdate:show":a[0]||(a[0]=u=>t.value=u),class:"msg-wrapper",position:"top"},{message:be(()=>[ue("div",Gqe,[o.icon=="loading"?(V(),Ie(l,{key:0,name:"file_upload_loading",class:"loading-anim toast-left",size:"20px"})):o.icon=="success"?(V(),Ie(l,{key:1,name:"file_upload_success",class:"toast-left",size:"20px"})):o.icon=="fail"?(V(),Ie(l,{key:2,name:"file_upload_error",class:"toast-left",size:"20px"})):o.icon=="cancle"?(V(),Ie(l,{key:3,name:"file_upload_cancle",class:"toast-left",size:"20px"})):$e("",!0),ue("div",null,Te(o.msg),1),o.icon=="loading"?(V(),Ie(l,{key:4,name:"file_upload_close",size:"28px",class:"toast-right",onClick:s})):$e("",!0)])]),_:1},8,["show"])])}}}),Vqe=dt(Hqe,[["__scopeId","data-v-636f3cb3"]]),zqe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZgAAACuCAYAAAALbxtRAAAPxUlEQVR4nO3dz3Ib15XH8d9pgBE1m4FqEm8NV1JJU4LKUCWbWRl6AktPIMgjT3kX6glIPgGpnSpSIvoJJD0BmarZZWFkJIutzELwcqKkjM1EdAj0mUWDEi2RBC7+NtDfz8ouNogr2uIP99x7z5XO8Po3v2j89dc/97O+DgDAeaJ5DwAAsJwIGADAVBAwAICpIGAAAFNBwAAApsL+99c/vyGz+gdfcP9YUtPNtk59odmTj/70P62pjxAAsJDK5qpI/vEpX6tKkv3kX27ph//bf/+LJlWmPjoAwMKys77w+je/aLj7XlRvdEq93ieXdnc7sxwYAGCxDbEGY61eaeXR9IcCAFgmAwOmtFK+LaWN13fuNGYxIADAchgYMJfu32+b25a5P/q+2WTdBQAwlKG2Kf/bHx7uSNbulssb0x4QAGA5DH0OJo3srrmvUyoDAAzjzF1kp3l9586mud8q9XrX2FUGADhP0En+cre7I0ndcnl9OsMBACyLoBmMJL2+c6dh7ntpFF376MEDTvIDAE4V3IvsZw8f7ku6F6W+PYXxAACWxEjNLku93qbk1b9/8QWlMgDAqYJLZMf6pbLHpZWVa5fu329PclAAgMU3crv+rFQW7feOurSRAQB8YKz7YEorpbuS1//25RfNSQ0IALAcRi6RHfv7F3fW3XyDjssAgJPGvtGy30am1SuV2FUGAHhrIlcmZx2XdYM2MgCAYxMJmEv377fd7B4dlwEAxyYSMJL0s4cPN03WoeMyAECaYMBIUmqi4zIAQNKEA+ZtGxkXC/4AUHATDRgpayPj8srrO3c2J/29AQCLY+xzMKehjQwAYOIzGOltqexr2sgAQHFNJWCktx2X63RcBoBimlrAZG1jSrfdbOP7r76qTut9AAD5NLWAkaSf/v53TyRrUSoDgOKZasBIx21kvP63//jPG9N+LwBAfkw9YC7dv982ty2pRxsZACiQqQeM9K7jMm1kAKA4ZhIwUlYqM/cmbWQAoBhmFjB0XAaAYplZwEhZx2VJolQGAMtvpgEjSW5229zX//rll/VZvzcAYHZmHjDHHZdLqXM2BgCW2MwDRnrXcZk2MgCwvKbSTXkYdFwGgOU2lxmM1C+VmZ7SRgYAltPcAkaSSt3eOh2XAWA5zTVgLu3udsxty802OBsDAMtlrgEjvWsj0yutUCoDgCUy94CRjjsupw3ayADA8shFwBx3XKaNDAAsj1wEjPS2VNamjQwALIfcBIwkpZHdNfd1SmUAsPhyFTAfPXjQcqNUBgDLIFcBI0nlbndHkrrlMmdjAGCBza1VzHn6bWT20ii69tGDB615jwcAEC53MxjpXcflKPXteY8FADCaXAaMlHVclrxKGxkAWEy5LJEdo+MyACyu3M5gpONSWbRPx2UAWDy5nsFI0vfNZqVXKr2SSrd/+vvfPZn3eABgHNVqvbK62q1LVnXXp2ZpRbKq5NWzX2X9Co63JfsuTa1VLvfaL168yPUmqNwHjCR9/9VX1X/f/6+mpIBT/t1PkiRZuLJaHNc2Nec/ZxxfeZX9D79Mxvs5xXG9KnVfBbxkK0meb476fnmRh/8fF10WKL0bUvqZpMYU/m7tu1vLzJ8myfP9CX/vsZTnPYBhXLp/vx3HtXkPAwCGUq3WKxcvpk339HOp2+9MMrXP8w0zb0haX1u72nFPn0j2dR7CZiECBgAWQRzXGpI2pG7Dffbv7+4VyZqSmnF8pW1mO+7lp0nSmsusMteL/ACwCOK41ojj2p6kPUk56aVoVXftSN1XcXzlUVbmnS0CBgBGlM9gOY01s6CpbcwyaAgYAAhUrdYra2tXt5X7YPnApnS0F8dXm7N4MwIGAALEca2xunr0jbsvaJcRq0r+aBZlMwIGAIYUx7UNSXvLsY3fmtLR3uXLl+vTegcCBgAG6JfEHkta+LNNP2bVNI2+WVu7MpXZGNuUMRYzddx1b97jGOTwcLUz7zFgMcVxverefeyuCX/S97aZtdJU35lZK/u75B2pe2JLcbkqSWZWycIgrZrpUzOrZ1uSJzQSt+04rv1rkjzfmtT3lAgYjMndO0ny7ZJ9qgMy2RrF0Z7Z+CUxM+u4e0uyr6Wj/SE7Hpz5TBzXGmZRXUpvTSj8NuO4pkmGDAEDAKc4DpcJrLfsm0VP37yJdtvt1sRm0v2T+vuSdrKx9jazdjRjjXeiIUPAAMB7qtV6ZQLhsq+sJ93UW7b0T+o3+z3zmpLfGmPsEwsZFvkB4D0XL/YejfoL2sw6Zn43SZ5fn3U/sCRptbMmqyvXs1LcyDbj+MqtccdDwADACXFc23D3GyO+fN+9dO3g4NudiQ4qUBY0z5qS3c5a/Iczs51xtzATMADQ129WOeqmla1s1jKfxpKnSZJnu9LKdTMF3xvjrkqa2uOsXDgaAgYAdLyo7yPenpvezuv9P0nSal+4UB6xZGbVixd7AfcB/RgBAwCSpKON0dZd0ttJ8mJ38uOZnFar1emXzIJDxt3X+zO7YAQMgMLL1hpshAaQ+Q+Xk7KQ0QgbD0ab2REwAAovTe3xCC/bWqRwOba6Wr4ZvvBv1f712UEIGACFlrWuDyuNmdmTvK65DNJqtTpR5DfNFHTo00y/DV3wJ2AAFFwauIjtbffS3emMZTZevHjRStMo6CCluyqrq92gppgEDIDCGmX2IkVbedqKPKqXL/97R4HrMaGzGAIGQIF54Gl1b2dnS5ZG8Czm4sWjoTdDEDAACql/m2Pg9tuwslLenWiYOTR3+3zYZwkYAAV1FLz2smSzl2OhodkY9lwMAQOgqAo9ezk22ixGQ/VqI2AAFE72CTxkcX9pZy+SJDN/GvJ8FGmotSsCBkABhS7uj3L6fXFcuLCyG3Iuxl2VYcpkBAyAIgosj411t0rutVqtjntwx2UCBgBOynaPDV8eM1Nn1heHzUdwiH426AECBkChmPUCL9HyP05nJPmyulp6EvK8mQb+HAkYAAXjoa3nCzB7ycpkIU0w3VUZdOMlAQOgUNz1adjzFnwb5OKKgmZraVoiYADg2DClnZOKsf6SMUuDwtTdCRgAkKR6vV5x19DNGke5y36xRUFNPKPIz90sQcAAKIzDw27Q7MU97M6URedeCpzBnF9uJGAAFIaZBV2Y5a4/T2sseRR6DcGgn2d5vOHkl1l5O46vLNynD3fVzeY9ihBWjeMrr+Y9iijymy9evChYOQOhQspjUnYGZlpjySszdYb9OQ16bmkDJmvGtlC/qSVJixUux0IvbJq8NA37ZIqiOn/N4H1mXriAcfeONPzfpziOq0mSnDrzoUQGAGdwjwoXMGY2sT8zAQMAeCt0Y0MURWfOdggYAAUSWs4d/mR7UaUpAQMAwUJ3neHHCBgAhRG6aB+66ww/RsAAKIyiHZycje6ZZcSl3aa8qLVTs6ji7nxqAjAnXp3UEY8lDpje9bP2ZudZHNc2JW3MexzD6h/KujnvcRweljlkiSFYW/KA58POzSwDM6t4wI/ovN+zSxwwmAV37yTJt4XpNotiKeIaTGAz0HNLjqzBACiMXi+smeOgbsHLJrtOOsi5VSICBkBhlEphi/yhl5Mtvm5QwAzaNEHAACiMJGm1wxpYzr/P3iyZnX+B2PsGdZsmYAAUTdDmn0H3zi+T0BlbFJ2/W5eAAVA0QffOu1tjWgPJGzMLnMHYuWtaBAyAQhn0S/HD54uxDtO/TjooYJLk+bk7SAkYAAVTCtpWb2Y3pjWSPPnhh17oTG3gz5GAAVAooQv97qrEcW3py2Tu6edhzw++TpqAAVA47vY08CVLHzChMzUzPRn0DAEDoIB8N+RpM/12WiPJgzi+2gzrWuDtQesvEgEDoIBWV8stymQn+a3AFwy1jkXAACicVqvVGaFMtjBNaEP028MEhqd9PcxTBAyAggork0lqLOcs5igwOIcrj0kEDICC6v+SDO0EvlSzmGz2Ys2wV0VbQz8ZOiAAWBZmHryb7Je/vLo052LMuo/DXzX8OSICBkBhXbiwshvW/FKKonS7Wq0v/D0x/Z1jgX3WfDdJWkP3ciNgABRWttive2Gvsurq6tH2dEY0G3Fcr5pphD/DytDlMYmAAVBwSfJ8Uzq/K/CHrLm2dmV9OiOahaM9dw+dhW2FzF4kAgYAJNnt0Fe42/Yi7ipbW7u6HX7PjbcPD8s7oe9FwAAovBF3lMlMjxfpvpg4rm24+wgzr2ir3W4FrVVJBAwA9JVvhy74u6viHu0tQshkMxdthr/Sd5PkWeiZIUkEDABIyrosu9vd0Ne5q5Km0Td5XZOpVuuVtbWrj0ebuXg7dGH/JAIGAPqS5NmuWeiusky2JnPlUb/1Si7Eca2xunr0jbuPeHbHbocu7J9EwADACRculDfNFHTr5TvWlI724vhq4On4yerPWrYl7YUv6L+1NWxLmLMQMABwQnY2pnwzfOvyMatK/iiOa3uz3mVWrdYrcVzbuHix92q0kthbW9n27fEQMADwnqwstHJ99JCRlHUo3suCZrozmpPBImlzhDMuJ9jXkwgXSSpP4psAwLJJklY7juvXpaNxykyS1JC8sbZ2dds9fZKm0dMoKrXGWduQpMuXL9fdy43squNuQ5LcfZxvqSxcnk0sDAkYjMXMKnFcm8innWk6PCzvjLKPf3R+K45rn83u/QYzs9bBwbPgXVJhyo/iuDbdtwhkZvcODp4NvN73NBMMGWWzCmtGkTelrn71q1oritTO7ra39vFsKYrSTpqmneyfo0qaRhXJqmZWSVP/2MzrZlZPU69I6ThDem98uvfy5bOJ7oQjYDCW/jWruW9hvrp6uCuFnXEYj1Ul5WY3kTSJT7dDyd3JdncNdTnWWY5Dxqz7OLw55NnMVO9/vxvSu/82aRrpePUifZsfLneXWf/fJv/fcuvly8mUxU5iDQYABkiSVvvg4Pm1Ubcw55WZddLUbk5qzeV9BAwADOng4Pl61rdsrMX/vNh3L137y19GKx8Og4ABgABZ25SV68PeS583ZtYx87tJ8vz6uBsNBiFgACBQkrTaSfKsaWZjnJeZPXfde/Om9MnBwbfBnZFHQcAAwIgODp49SZJvP8l/2cx3pfInL18+X5/lbkp2kQHAmPrdhnezA5V+SznYTWdmHXe/J5WDrjmeJAIGACbkXdDUq2bpDSm9NcmtzYP0Q6WVpnbvn/8s7c/27NeHCBgAmLD+jGFH0k7WXbnXMPPP3b0+7oHN95mplab6o5mevHlTas07VE6yeQ8AAIqkWq1XVle7dbOonqZpNYr0sbsqZqqc1UPMzDqS2u7ekew7ydpR1Gv94x8/aecpUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAg//4f6cvOWCBJqI4AAAAASUVORK5CYII=",$qe={class:"dialog-container"},Wqe={class:"dialog-image"},jqe={class:"preview-tip-text"},Qqe={class:"preview-tip-title"},Xqe={class:"preview-tip-description"},Yqe=Fe({__name:"PreviewPathDialog",setup(n){const{t:e}=Yt(),t=ee(!0),i=ee(e("ipad.dialog.tips")),r=ee(e("ipad.dialog.got_it")),s=qr([{svgColor:"#FA2730",icon:"process-preview-tip-trajectory",title:e("ipad.process.laser_trajectory"),description:e("ipad.process.laser_trajectory_content")},{icon:"process-preview-tip-path",title:e("ipad.process.processing_path"),description:e("ipad.process.processing_path_content")},{icon:"process-preview-tip-position",title:e("ipad.process.laser_position"),description:e("ipad.process.laser_position_content")}]),o=()=>{localStorage.setItem("process-preview-first-tip","1"),t.value=!1};return(a,l)=>{const c=ng,u=xn,h=F0;return V(),le("section",null,[ye(h,{show:t.value,"onUpdate:show":l[0]||(l[0]=d=>t.value=d),class:"preview-dialog-wrapper",title:i.value,"confirm-button-text":r.value,onConfirm:o},{default:be(()=>[ue("div",$qe,[ue("div",Wqe,[ye(c,{height:"120px",fit:"contain",src:Be(zqe)},null,8,["src"])]),(V(!0),le(vt,null,Fn(s,d=>(V(),le("div",{key:d.title,class:"preview-tip-card"},[ye(u,{name:d.icon,class:"preview-tip-icon f-s-52",color:d.svgColor},null,8,["name","color"]),ue("div",jqe,[ue("span",Qqe,Te(d.title),1),ue("span",Xqe,Te(d.description),1)])]))),128))])]),_:1},8,["show","title","confirm-button-text"])])}}}),qqe=""+new URL("../assets/m1-rotate-tips-jyKK_5dl.png",import.meta.url).href,Kqe=""+new URL("../assets/m1-free-plane-tips-bGFGtNX6.png",import.meta.url).href;class Jqe{constructor(){E(this,"reAutomaticMeasurement",ee(!1));E(this,"pageResumeAt",ee(0))}}const dx=new Jqe,_N=ba("global_param_module",{getters:{reAutomaticMeasurement:()=>dx.reAutomaticMeasurement.value,pageResumeAt:()=>dx.pageResumeAt.value},actions:{setReAutomaticMeasurement(n){dx.reAutomaticMeasurement.value=n},onPageResume(){dx.pageResumeAt.value=new Date().getTime()}}});function j5(n,e){const i=/^(?:[-]?(?=\.?\d?)(?:\d+)?(?:\.?\d*)(?:[eE][+-]?\d*)?)$/.test(n);if(e===void 0)return i;const[,r="",s=""]=n.split(/\.|[eE][+]?/);return i&&(r.length<=e||s.length>0)}function Q5(n,{fractionDigits:e,min:t,max:i}={}){let r,s=n;r=parseFloat(n);const o=r;return isNaN(r)||(r=eZ(r,{fractionDigits:e,min:t,max:i}),o!==r&&(s=String(r))),{num:r,value:s}}function eZ(n,{fractionDigits:e,min:t,max:i}){let r=n;if(isNaN(r))return r;const s=e!==void 0&&e>=0;if(s&&(r=tZ(r,e)),t!==void 0&&Number.isFinite(t)){const o=s?k8(t,e):t;r<o&&(r=t)}if(i!==void 0&&Number.isFinite(i)){const o=s?oj(i,e):i;r>o&&(r=o)}return Object.is(r,-0)&&(r=0),r}const Zqe=(n,e)=>{let i=n;if(e=Math.floor(Math.abs(e)),e>6&&(e=6),n.toString().indexOf("e")!==-1){const s=n.toString().split("e"),o=Number(s[1]);s[1]=(o+(o>=0?e:-e)).toString(),i=s.join("e")}else i=`${n}e${e}`;return Math.round(i)/10**e},tZ=(n,e)=>Number(Zqe(n,e).toFixed(e)),nZ=(n,e)=>n*e,eKe=(n,e)=>n/e,tKe=(n,e,t)=>{const i=nZ(n,e);return gi(t)?i:tZ(i,t)},$y=(n,e,t)=>gi(n)||cr(n)||isNaN(n)?n:tKe(n,e,t),nKe=(n,e)=>e?Number(n.toFixed(e)):Math.round(n),iKe=Fe({__name:"InputNumber",props:{id:{default:void 0},prefix:{default:void 0},suffix:{default:void 0},label:{default:""},showLabel:{type:Boolean,default:!0},modelValue:{default:void 0},max:{default:void 0},min:{default:void 0},scale:{default:1},fractionDigits:{default:void 0},placeholder:{default:""},allowNull:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},onBlur:{type:Function,default:void 0},defaultValue:{default:0},domProps:{default:void 0}},emits:["update:model-value","change"],setup(n,{expose:e,emit:t}){const i=n,r=t,s={type:"number",inputMode:""},o=ee(null),a=ee(!1);a.value=!!i.id&&["x","y","width","height"].includes(i.id);const l=ee(""),c=P=>{const k=P.clipboardData||window.clipboardData;l.value=k.getData("text")};Zn(()=>{T(i.domProps),document.addEventListener("paste",c)}),L0(()=>{document.removeEventListener("paste",c)}),yt(()=>i.domProps,()=>{T(i.domProps)});const u=ee(),h=P=>{setTimeout(()=>{var k,L;u.value=(k=P.target)!=null&&k.value?Number((L=P.target)==null?void 0:L.value):Number(l.value)},100)},d=te(()=>$y(i.max,i.scale,i.fractionDigits)),f=te(()=>$y(i.min,i.scale,i.fractionDigits)),p=te(()=>({fractionDigits:i.fractionDigits,max:d.value,min:f.value})),g=ee(C(i.modelValue).value);yt(()=>i.modelValue,()=>{if(i.allowNull&&i.modelValue===null&&g.value==="")return;const{value:P,num:k}=C(i.modelValue);(g.value===""||Number(g.value)!==k)&&(g.value=P)});let m=!1;const v=P=>{if(P.target!==null&&!P.target.composing){const k=P.target.value??"";m=!0,_(k)}},_=Fc(P=>{m&&(b(P,i.scale),m=!1)},0),y=P=>j5(P,i.fractionDigits)?P:g.value;let A=!1;const w=P=>{var k;if(A){A=!1;return}m&&(b(g.value,i.scale),m=!1),g.value=C(i.modelValue).value,(k=i.onBlur)==null||k.call(i,P)};function b(P,k){let L;if(P===""&&i.allowNull)L=null;else{const{value:H,num:U}=Q5(P,p.value);g.value=H,isNaN(U)||(L=eZ(eKe(U,k),{min:i.min,max:i.max}))}if(console.log("paste...",u.value),tn(u.value)&&!isNaN(u.value)){const H=nKe(Number(u.value),i.fractionDigits);g.value=H.toString(),L=H,Yi(()=>{const U=x();if(U){const $=g.value.length;U.setSelectionRange($,$)}u.value=""})}console.log("inputVal:",g.value,L),L!==void 0&&L!==i.modelValue&&(r("update:model-value",L),r("change",L,i.id))}function C(P){return I(P,i.scale,i.allowNull,i.defaultValue)}function I(P,k,L,H){if(P===null){if(L)return{value:"",num:null};P=void 0}P===void 0&&(H===null&&!L||typeof H=="number"&&!isFinite(H)?P=H:P=0);const U=String(nZ(Number(P),k)),{value:$,num:j}=Q5(U,p.value);return i.modelValue===null?{value:"",num:0}:{value:$,num:j}}const x=()=>o.value?o.value.$el.querySelector("input"):null;function T(P){const k=x();if(k){P=Object.assign({},s,P);for(const L in P){const H=P[L];H!==void 0&&(k[L]=H)}}}function O(P,k,L,H){return P.slice(0,L)+k+P.slice(H)}const F=P=>{if(typeof P!="string")throw new TypeError("inserted text must be a string");const k=x();if(!k)return;const L=k.selectionStart??0,H=k.selectionEnd??0,U=k.value,$=!P&&L===H&&L>0?L-1:L,j=O(U,P,$,H);j5(j,i.fractionDigits)&&(g.value=j,m=!0,Yi(()=>{const Q=H+(j.length-U.length);k.setSelectionRange(Q,Q),A=!0,k.blur(),k.focus()}))};function G(){return F("")}function B(){var P;(P=o.value)==null||P.focus(),Yi(()=>{const k=x();if(k){const L=g.value.length;k.setSelectionRange(L,L)}})}function R(){var P;(P=o.value)==null||P.blur()}return e({inputVal:g,insertText:F,deleteText:G,focus:B,blur:R}),(P,k)=>{var H;const L=Jo;return V(),Ie(L,ht({ref_key:"inputField",ref:o,modelValue:g.value,"onUpdate:modelValue":k[0]||(k[0]=U=>g.value=U),class:["input-number process-param-setting",{"gray-bg-cls":a.value&&((H=i==null?void 0:i.domProps)==null?void 0:H.kind)}],formatter:y,label:i.showLabel?i.label:"",placeholder:i.placeholder,"input-align":"right",disabled:P.disabled,type:"number"},P.$attrs,{onBlur:w,onInput:v,onPaste:h}),Pr({_:2},[P.prefix?{name:"left-icon",fn:be(()=>[Gt(Te(P.prefix),1)]),key:"0"}:void 0,P.suffix?{name:"right-icon",fn:be(()=>[Gt(Te(P.suffix),1)]),key:"1"}:void 0]),1040,["modelValue","class","label","placeholder","disabled"])}}}),BI=dt(iKe,[["__scopeId","data-v-b547bec7"]]),rKe={key:0,class:"number-keyboard-valid"},sKe=Fe({__name:"NumberKeyboard",props:{show:{type:Boolean},title:{},inputs:{default:()=>[]},popupAttrs:{default:void 0},focusIndex:{},range:{type:Boolean},showOverlay:{type:Boolean}},emits:["update:show","keyboardConfirm"],setup(n,{emit:e}){const t=N0(),{t:i}=Yt(),r=te(()=>t.name==="editor"),s=te(()=>t.name==="device"),{unit:{fractionDigits:o,scale:a}}={unit:{fractionDigits:1,scale:1}},l=te(()=>(console.log("props.inputs[0]",$y(C.inputs[0].attrs.max,a,o)),$y(C.inputs[0].attrs.max,C.inputs[0].attrs.scale,o))),c=te(()=>$y(C.inputs[0].attrs.min,C.inputs[0].attrs.scale,o)),u=te(()=>{var $;return(($=C.inputs[0].attrs.keyboardAttrs)==null?void 0:$.extraKey)||(C.inputs[0].attrs.fractionDigits?".":"")}),h=te(()=>(console.log("props.inputs[0]",C.inputs[0]),C.inputs[0].attrs.unit==="in"?`${i("mobile.common.input_effective_range")}${c.value}~${l.value}`:`${i("mobile.common.input_effective_range")}${C.inputs[0].attrs.min}~${C.inputs[0].attrs.max}`)),d=$=>{var Q;console.log("handleKeyboardInput",$);const j=G();j&&((Q=j.insertText)==null||Q.call(j,String($)))},f=()=>{var j;console.log("handleKeyboardDelete",B.value);const $=G();$&&((j=$.deleteText)==null||j.call($))},p=()=>{B.value!==""&&(P.value=!1)},g=te(()=>{var $;return(($=C.inputs)==null?void 0:$.length)>1}),m=()=>{var j,Q;for(let ne=0;ne<x.value.length;ne++)((j=x.value[ne])==null?void 0:j.inputVal)!==void 0&&((Q=x.value[ne])==null||Q.blur());let $={};C.range?$=C.inputs.filter(ne=>ne.type==="number").reduce((ne,{value:ve})=>(ne.push(ve),ne),[]):g.value&&($=w(),$=_(y.value,$)),setTimeout(()=>{I("keyboardConfirm",g.value?$:Number(B.value),T.value),P.value=!1},100)},v=($,j)=>tn(Number($))&&tn(Number(j))?Number($).toFixed(o)===Number(j).toFixed(o):Fl($,j),_=($,j)=>Yue($,(Q,ne,ve)=>(v(ne,j[ve])||(Q[ve]=j[ve]),Q),{}),y=ee(),A=()=>{let $={};return C.range||g.value&&($=w()),$},w=()=>C.inputs.filter($=>$.type==="number").reduce(($,{id:j,value:Q})=>($[j]=Q,$),{}),b=()=>{var j;const $=G();$&&((j=$.focus)==null||j.call($))},C=n,I=e,x=ee([]),T=ee(null),O=te(()=>{const $=T.value;return $!==null?C.inputs[$]:null}),F=te(()=>{const $=T.value;return $!==null?x.value[$]:null}),G=()=>{const $=T.value;return $!==null?x.value[$]:null},B=te(()=>F.value?F.value.inputVal:""),R=ee(Math.random()),P=te({get(){return C.show},set($){I("update:show",$)}}),k=qr({"number-keyboard-overlay":!r.value,"number-keyboard-overlay_editor":r.value&&!C.showOverlay,"number-keyboard-overlay_device_detail":s.value});yt(()=>P.value,$=>{R.value=Math.random(),$&&(L(C.focusIndex||0),g.value&&(y.value=A()))});function L($){U($)&&(T.value=$)}const H=$=>{T.value=$};function U($){var Q;const j=(Q=C.inputs)==null?void 0:Q[$];if((j==null?void 0:j.type)==="number")return j}return($,j)=>{const Q=Oi,ne=xn,ve=f6,Pe=Ko;return V(),Ie(Pe,ht({show:P.value,"onUpdate:show":j[1]||(j[1]=De=>P.value=De),position:"bottom",class:{"number-keyboard__popup":r.value},overlay:!0,"close-on-click-overlay":!1,"overlay-class":k,round:"",teleport:"#app"},$.popupAttrs,{onClickOverlay:m,onOpened:b,onClose:p}),{default:be(()=>[ye(Q,{class:"number-keyboard__title",title:C.title},null,8,["title"]),(V(),le("div",{key:R.value+"",class:St(["number-keyboard__content",C.inputs[0].attrs.showValRange?"":"keyboard__flex"])},[ue("div",{class:St(["number-keyboard__input",{"number-keyboard__list":C.inputs.length>1}])},[(V(!0),le(vt,null,Fn(C.inputs,(De,Xe)=>(V(),le(vt,{key:Xe},[De.type==="component"?(V(),Ie(Uo(De.cmp),ht({key:0,ref_for:!0,ref_key:"inputRefs",ref:x},De.attrs),null,16)):De.type==="icon"?(V(),Ie(ne,ht({key:1,ref_for:!0,ref_key:"inputRefs",ref:x,name:De.cmp,class:"f-s-14"},De.attrs),null,16,["name"])):$e("",!0),De.type==="number"?(V(),Ie(Be(BI),ht({key:2,id:De.id,ref_for:!0,ref_key:"inputRefs",ref:x,modelValue:De.value,"onUpdate:modelValue":Ne=>De.value=Ne,class:["number-keyboard__field",{"number-keyboard__field--focus":T.value===Xe}],style:{"--number-keyboard-input-width":De.attrs.valueWidth??"100%",width:De.attrs.valueWidth??"100%"},"dom-props":{type:"text",inputMode:"none"}},{...De.attrs,showLabel:!1},{onFocus:Ne=>H(Xe)}),null,16,["id","modelValue","onUpdate:modelValue","class","style","onFocus"])):$e("",!0)],64))),128))],2),C.inputs[0].attrs.showValRange?(V(),le("div",rKe,Te(h.value),1)):$e("",!0)],2)),T.value!==null?(V(),Ie(ve,ht({key:0,modelValue:B.value,"onUpdate:modelValue":j[0]||(j[0]=De=>B.value=De),class:["number-keyboard__keyboard",{noExtraKey:!u.value}],show:!0,theme:"custom","extra-key":u.value,"close-button-text":Be(i)("mobile.editor.keyboard_confirm")},O.value?O.value.keyboardAttrs:null,{onClose:m,onInput:d,onDelete:f}),null,16,["modelValue","class","extra-key","close-button-text"])):$e("",!0)]),_:1},16,["show","class","overlay-class"])}}}),vg=dt(sKe,[["__scopeId","data-v-a93526a6"]]),oKe={class:"header_title"},aKe={class:"content"},lKe={class:"title"},cKe={class:"footer_confirm_btn"},uKe=Fe({__name:"DistanceModal",emits:["update:modelValue","confirm","cancel"],setup(n){const e=Hc(),t=bt(),i=ee(!0),r=ee(!1),s=te(()=>t.extId===nt.M1),o=qx(),a=_N(),{t:l}=Yt(),c=te(()=>si().unit),{fractionDigits:u,scale:h,step:d,current:f}=c.value,p=ee(0),g=te(()=>f==="in"?1.3:34),m=ee(),v=ee(!1),_=ee(`${l("device.measure_guide.title")}(${f})`),y=ee({id:"focalLength",type:"number",value:m.value,attrs:{showValRange:!0,min:p.value,max:g.value,fractionDigits:u,allowNull:!0,valueWidth:"100px",onChange:O=>{m.value=O}},keyboardAttrs:{extraKey:["."]}}),A=()=>{i.value=!1},w=async()=>{var O;if((O=t.ext)!=null&&O.correct)try{const F=t.ext.dataSource.currentDeviceData,G=t.ext.correct(F),B=await t.ext.correctPicture(G);t.ext.appContext.updateBackImg(B)}catch(F){console.log("updateBackDrop",F)}},b=async()=>{var O,F,G,B;if(m.value){t.connected?(await((O=t.ext)==null?void 0:O.apis.lockedLeaserHead()),await((F=t.ext)==null?void 0:F.apis.resetLeaserHead())):tt.modal.showToast({msg:"device.process.device_is_offline"}),console.log("==>handleConfirm  ",m.value);const R=parseFloat(m.value);o.deviceDataHandler("focalLength",R/h),w(),A()}else try{s.value&&t.connected&&(await((G=t.ext)==null?void 0:G.apis.lockedLeaserHead()),await((B=t.ext)==null?void 0:B.apis.resetLeaserHead()))}catch(R){console.log(R)}finally{A()}},C=async()=>{var O,F;if(r.value=!1,!t.connected){if(m.value!==null){const G=parseFloat(m.value);o.deviceDataHandler("focalLength",G/h)}A();return}if(t.isInProcessing){A();return}try{s.value&&(await((O=t.ext)==null?void 0:O.apis.lockedLeaserHead()),await((F=t.ext)==null?void 0:F.apis.resetLeaserHead())),a.setReAutomaticMeasurement(!0),A()}catch(G){console.log(G)}},I=te(()=>e.currentMode===zt.LASER_CYLINDER),x=te(()=>{var G,B,R,P;const{manualCylinderFaq:O="",manualPlaneFaq:F=""}=(B=(G=t.ext)==null?void 0:G.config)==null?void 0:B.supportUrls;return console.log("==>reactiveData ",(P=(R=t.ext)==null?void 0:R.config)==null?void 0:P.supportUrls),{isCylinder:I.value,manualFaqUrl:I.value?O:F,tipsImg:I.value?qqe:Kqe}}),T=()=>{var F,G;const O=x.value.manualFaqUrl;console.log("m1查看测量教程:",O),(G=(F=window.MeApi)==null?void 0:F.app)==null||G.openBrowser(O)};return(O,F)=>{const G=xn,B=ng,R=Jo,P=Hi,k=Ko;return V(),Ie(k,{show:i.value,"onUpdate:show":F[3]||(F[3]=L=>i.value=L),round:"","close-on-click-overlay":!1,class:"pop_modal",position:"bottom","overlay-class":"common-popup-filter-overlay"},{default:be(()=>[ue("div",null,[ue("div",oKe,[ue("div",null,Te(O.$t("device.measure_guide.title")),1),ye(G,{name:"top-close",class:"fixed-close f-s-30",onClick:b})])]),ue("div",aKe,[ye(B,{src:x.value.tipsImg,fit:"contain",class:"img-box"},null,8,["src"]),ue("div",lKe,Te(O.$t("device.measure_guide.manual_measurement_distance")),1),ye(R,{modelValue:m.value,"onUpdate:modelValue":F[0]||(F[0]=L=>m.value=L),class:"input-box",readonly:"",placeholder:"",onClick:F[1]||(F[1]=()=>v.value=!0)},null,8,["modelValue"]),ye(Be(vg),{show:v.value,"onUpdate:show":F[2]||(F[2]=L=>v.value=L),"focus-index":0,title:_.value,inputs:[y.value]},null,8,["show","title","inputs"])]),ue("div",cKe,[ye(P,{class:"confirm-top-btn",onClick:b},{default:be(()=>[Gt(Te(O.$t("component.button.confirm")),1)]),_:1}),ye(P,{class:"cancel-bottom-btn",loading:r.value,onClick:C},{default:be(()=>[Gt(Te(O.$t("device.measure_guide.re_automatic_measurement")),1)]),_:1},8,["loading"]),ue("div",{class:"bottom-tip",onClick:T},[ue("span",null,Te(O.$t("device.measure_guide.view_detail_tutorial")),1),ye(G,{size:"20px",class:"svg-right f-s-20",name:"arrow-right-up-blue"})])])]),_:1},8,["show"])}}}),hKe=dt(uKe,[["__scopeId","data-v-810a1a31"]]);function fy(n){var e;const t=Ql(n);return(e=t==null?void 0:t.$el)!=null?e:t}const iZ=wO?window:void 0;function Zx(...n){let e,t,i,r;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,i,r]=n,e=iZ):[e,t,i,r]=n,!e)return dd;Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);const s=[],o=()=>{s.forEach(u=>u()),s.length=0},a=(u,h,d,f)=>(u.addEventListener(h,d,f),()=>u.removeEventListener(h,d,f)),l=yt(()=>[fy(e),Ql(r)],([u,h])=>{if(o(),!u)return;const d=t8(h)?{...h}:h;s.push(...t.flatMap(f=>i.map(p=>a(u,f,p,d))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return RT(c),c}let X5=!1;function Y5(n,e,t={}){const{window:i=iZ,ignore:r=[],capture:s=!0,detectIframe:o=!1}=t;if(!i)return dd;tM&&!X5&&(X5=!0,Array.from(i.document.body.children).forEach(d=>d.addEventListener("click",dd)),i.document.documentElement.addEventListener("click",dd));let a=!0;const l=d=>r.some(f=>{if(typeof f=="string")return Array.from(i.document.querySelectorAll(f)).some(p=>p===d.target||d.composedPath().includes(p));{const p=fy(f);return p&&(d.target===p||d.composedPath().includes(p))}}),u=[Zx(i,"click",d=>{const f=fy(n);if(!(!f||f===d.target||d.composedPath().includes(f))){if(d.detail===0&&(a=!l(d)),!a){a=!0;return}e(d)}},{passive:!0,capture:s}),Zx(i,"pointerdown",d=>{const f=fy(n);a=!l(d)&&!!(f&&!d.composedPath().includes(f))},{passive:!0}),o&&Zx(i,"blur",d=>{setTimeout(()=>{var f;const p=fy(n);((f=i.document.activeElement)==null?void 0:f.tagName)==="IFRAME"&&!(p!=null&&p.contains(i.document.activeElement))&&e(d)},0)})].filter(Boolean);return()=>u.forEach(d=>d())}const dKe={[iB.mounted](n,e){const t=!e.modifiers.bubble;if(typeof e.value=="function")n.__onClickOutside_stop=Y5(n,e.value,{capture:t});else{const[i,r]=e.value;n.__onClickOutside_stop=Y5(n,i,Object.assign({capture:t},r))}},[iB.unmounted](n){n.__onClickOutside_stop()}};function wP(n){return typeof Window<"u"&&n instanceof Window?n.document.documentElement:typeof Document<"u"&&n instanceof Document?n.documentElement:n}function rZ(n){const e=window.getComputedStyle(n);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&n.clientWidth<n.scrollWidth||e.overflowY==="auto"&&n.clientHeight<n.scrollHeight)return!0;{const t=n.parentNode;return!t||t.tagName==="BODY"?!1:rZ(t)}}function fKe(n){const e=n||window.event,t=e.target;return rZ(t)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}const fx=new WeakMap;function pKe(n,e=!1){const t=ee(e);let i=null,r;yt(tre(n),a=>{const l=wP(Ql(a));if(l){const c=l;fx.get(c)||fx.set(c,r),t.value&&(c.style.overflow="hidden")}},{immediate:!0});const s=()=>{const a=wP(Ql(n));!a||t.value||(tM&&(i=Zx(a,"touchmove",l=>{fKe(l)},{passive:!1})),a.style.overflow="hidden",t.value=!0)},o=()=>{var a;const l=wP(Ql(n));!l||!t.value||(tM&&(i==null||i()),l.style.overflow=(a=fx.get(l))!=null?a:"",fx.delete(l),t.value=!1)};return RT(o),te({get(){return t.value},set(a){a?s():o()}})}function gKe(){let n=!1;const e=ee(!1);return(t,i)=>{if(e.value=i.value,n)return;n=!0;const r=pKe(t,i.value);yt(e,s=>r.value=s)}}gKe();const mKe={key:0,class:"custom-material-modal-wrapper"},vKe={class:"material-container"},_Ke={class:"material-header"},yKe={class:"img-box"},AKe=["src","alt"],bKe=Fe({__name:"MaterialModal",props:{label:{},imgUrl:{},isDangerous:{type:Boolean}},setup(n){const e=n,t=ee(e.label),i=ee(e.imgUrl),r=ee(e.isDangerous),s=ee(!0),o=pg(N5e);II(()=>o.uiEffect.onCanvasTouch,()=>{s.value=!1});const a=l=>{s.value=!1};return(l,c)=>{const u=xn,h=ite;return s.value?tg((V(),le("div",mKe,[ue("div",vKe,[ue("div",_Ke,[ue("span",null,Te(t.value),1),r.value?(V(),Ie(u,{key:0,size:"20",class:"f-s-20 fire-icon",name:"flammable"})):$e("",!0)]),ue("div",yKe,[i.value?(V(),le("img",{key:0,src:i.value,alt:t.value},null,8,AKe)):(V(),Ie(h,{key:1}))])])])),[[Be(dKe),a]]):$e("",!0)}}}),wKe=dt(bKe,[["__scopeId","data-v-beba738d"]]),xKe=["xlink:href"],CKe=Fe({__name:"SvgIcon",props:{prefix:{},color:{},size:{},name:{}},setup(n){return(e,t)=>(V(),le("svg",ht({"aria-hidden":"true",class:e.name,style:{"--svg-size":e.size||"24px","--svg-color":e.color}},e.$attrs),[ue("use",{"xlink:href":`#${e.prefix??"icon"}-${e.name}`,fill:"currentColor"},null,8,xKe)],16))}}),Nn=dt(CKe,[["__scopeId","data-v-887d332e"]]);function sZ(n,e,t){const i=ee(n),r=ee(!1),s=async a=>{if(!r.value&&mt(e)){const l=gi(a)?i.value:a,c=e(l);if(c instanceof Promise){r.value=!0;try{await c}catch(u){console.error({err:u})}finally{r.value=!1}}}},o=n8(a=>{s(a)},t??300);return{update:s,running:r,valueRef:i,debouncedFn:o}}const FI=25.4,Zu=(n,e,t=1)=>{if(!tn(e))return e;mt(n)&&(e=n(e));const i=10**(t??1);return Math.round(e*i)/i},EKe=n=>n/FI,TKe=n=>n/10,IKe=n=>n*10/FI,SKe=n=>n*10,PKe=n=>n*FI,MKe=n=>n*FI/10,RKe=n=>{const e=Zu(null,n,3),t=Zu(MKe,n),i=Zu(PKe,n);return{inch:e,cm:t,mm:i}},DKe=n=>{const e=Zu(null,n),t=Zu(SKe,n);return{inch:Zu(IKe,n,3),cm:e,mm:t}},oZ=n=>{const e=Zu(null,n),t=Zu(TKe,n);return{inch:Zu(EKe,n,3),cm:t,mm:e}},kKe={in:RKe,cm:DKe,mm:oZ};function OKe(n){const e=si(),t=oZ(n),i=ee(t.mm),r=ee(t.cm),s=ee(t.inch),o=te(()=>{var h;return(h=e.unit)==null?void 0:h.current}),a=te(()=>{var h;return(h=e.unit)==null?void 0:h.scale}),l=te(()=>{const{fractionDigits:h}=e.unit;return h}),c=te(()=>o.value==="in"?s.value:o.value==="cm"?r.value:i.value);return{mm:i,cm:r,inch:s,unit:o,scale:a,digits:l,displayValue:c,updateDisplayValue:(h,d)=>{const f=kKe[d??o.value];if(mt(f)){const p=f(h);s.value=p.inch,r.value=p.cm,i.value=p.mm}}}}const LKe={key:1},NKe=Fe({__name:"WidgetButton",props:{disabled:{type:Boolean},loading:{type:Boolean},name:{},label:{},title:{},icon:{},tag:{},href:{},value:{type:[String,Boolean,Number]},btnClassName:{},handler:{type:Function}},setup(n){const{t:e}=Yt(),t=bt(),i=t.extId,r=_N(),s=n,{valueRef:o,running:a,debouncedFn:l}=sZ(s.value,s.handler),c=te(()=>s.name!=="updateExt"),u=te(()=>s.name==="updateExt"||a.value?"primary":void 0),h=te(()=>s.loading||a.value),d=()=>{if(console.log("[点击事件]=>",s.name),s.tag==="a"){console.log("[外链跳转url]=>",s.href),mN(s.href||"");return}if(!t.connected){tt.modal.showToast({msg:e("device.process.device_is_offline"),wordBreak:"break-word"});return}if(!Wv.includes(["updateExt","autoMeasureBtn"],s.name)&&(t.isInProcessing||t.isFrameMode)){tt.modal.showToast({msg:e("device.process.device_is_working"),wordBreak:"break-word"});return}l(s.name)},f=te(()=>!(i===nt.P2&&s.name==="preciseMeasurementBtn"||i===nt.P2&&s.name==="quickMeasurementBtn"&&t.processingModeChecked==="FREE_PLANE"||i===nt.P1&&s.name==="autoMeasureBtn"));return yt(()=>s.value,(p,g)=>{p!==g&&(o.value=p)}),yt(()=>r.reAutomaticMeasurement,p=>{p&&(r.setReAutomaticMeasurement(!1),nt.M1===i&&s.name==="focalLengthMeasure"&&l(s.name))},{immediate:!0}),(p,g)=>{const m=xn,v=Hi;return f.value?(V(),Ie(v,ht({key:0,type:u.value,plain:c.value,size:"small",loading:h.value},p.$attrs,{disabled:p.disabled,class:p.btnClassName,onClick:dr(d,["stop"])}),{loading:be(()=>[ye(m,{name:"common-loading",class:"loading-anim f-s-20"})]),default:be(()=>[p.icon?(V(),Ie(m,{key:0,name:p.icon,size:"20px",class:"f-s-20"},null,8,["name"])):(V(),le("span",LKe,Te(p.label?Be(e)(p.label??""):Be(e)(p.title??"")),1))]),_:1},16,["type","plain","loading","disabled","class"])):$e("",!0)}}}),BKe=dt(NKe,[["__scopeId","data-v-2ab2daaf"]]),FKe={key:1},UKe=Fe({__name:"WidgetButtonGroups",props:{name:{},label:{},value:{},loading:{type:Boolean},handler:{type:Function},childs:{}},setup(n){const{t:e}=Yt(),t=n,i=r=>{t.handler(r)};return(r,s)=>{const o=xn,a=Hi,l=Oi;return V(),Ie(l,{center:""},{title:be(()=>[ue("span",null,Te(Be(e)(r.label)),1)]),extra:be(()=>[(V(!0),le(vt,null,Fn(r.childs,c=>{var u,h;return V(),le(vt,{key:c.name},[(u=c.widgetAttrs)!=null&&u.disabled?$e("",!0):(V(),Ie(a,{key:0,type:c.widgetAttrs.loading?"primary":"default",plain:"",size:"small",loading:c.widgetAttrs.loading,disabled:(h=c.widgetAttrs)==null?void 0:h.disabled,style:{"margin-left":"10px"},onClick:d=>i(c.name)},{default:be(()=>{var d;return[(d=c.widgetAttrs)!=null&&d.icon?(V(),Ie(o,{key:0,name:c.widgetAttrs.icon,size:"20px",class:"f-s-20"},null,8,["name"])):(V(),le("span",FKe,Te(Be(e)(c.widgetAttrs.label)),1))]}),_:2},1032,["type","loading","disabled","onClick"]))],64)}),128))]),_:1})}}}),GKe=Fe({__name:"WidgetButtonLink",props:{name:{},label:{},handler:{type:Function}},setup(n){const{t:e}=Yt(),t=B0(),i=n,r=()=>{console.log(i.name),t.push("/check-steps")};return(s,o)=>{const a=Hi,l=Oi;return V(),Ie(l,{title:Be(e)(s.label),center:""},{extra:be(()=>[ye(a,{size:"small",type:"primary",plain:"",style:{"min-width":"60px","margin-left":"10px"},onClick:r},{default:be(()=>[ue("span",null,Te(Be(e)("device.laser_extend.calibrate")),1)]),_:1})]),_:1},8,["title"])}}}),HKe=Fe({__name:"WidgetDeviceInfo",props:{name:{},label:{},value:{},handler:{type:Function}},setup(n){const{t:e}=Yt();return(t,i)=>{const r=Oi;return V(),Ie(r,{title:Be(e)(t.label),label:t.value,center:""},null,8,["title","label"])}}}),VKe=Fe({__name:"WidgetDevicePower",props:{name:{},label:{},value:{},suffix:{},handler:{type:Function}},setup(n){const{t:e}=Yt(),t=n,i=te(()=>!!t.value),r=()=>{console.log("LaserFaqHref",t);const s=t.suffix.widgetAttrs.href??"";mN(s)};return(s,o)=>{const a=Oi,l=Hi;return V(),Ie(a,{style:{padding:"0",margin:"0"}},{extra:be(()=>[i.value?(V(),Ie(a,{key:0,center:"",title:Be(e)(s.label),value:s.value},null,8,["title","value"])):(V(),Ie(a,{key:1,center:"",title:Be(e)("device.setting.model"),label:Be(e)("device.setting.unrecognized_laser_model"),onClick:r},{extra:be(()=>[ye(l,{size:"small",plain:"",style:{"margin-left":"10px"}},{default:be(()=>[Gt(Te(Be(e)("device.setting.unrecognized_laser_faq")),1)]),_:1})]),_:1},8,["title","label"]))]),_:1})}}}),zKe=Fe({__name:"WidgetDeviceVersion",props:{name:{},label:{},value:{},suffix:{},handler:{type:Function}},setup(n){const e=bt(),{t}=Yt(),i=n,r=te(()=>i.value instanceof Array?i.value.map(l=>l.contentVersion):[i.value]),s=()=>{if(e.isInProcessing){aO({message:t("device.setting.setting_error_in_processing"),wordBreak:"break-word"});return}i.handler(i.suffix.name,i.suffix.widgetAttrs.value)},o=te(()=>[nt.P1].includes(e.extId));return(a,l)=>{const c=Hi,u=Oi;return V(),Ie(u,{title:Be(t)(a.label),center:""},{extra:be(()=>[o.value?$e("",!0):(V(),Ie(c,{key:0,size:"small",type:"primary",plain:"",loading:a.suffix.loading,style:{"margin-left":"10px"},onClick:s},{default:be(()=>[Gt(Te(Be(t)(a.suffix.label)),1)]),_:1},8,["loading"]))]),label:be(()=>[(V(!0),le(vt,null,Fn(r.value,h=>(V(),le("div",{key:h},Te(h),1))),128))]),_:1},8,["title"])}}}),$Ke={class:"device-name-cell"},WKe=Fe({__name:"WidgetEdit",props:{name:{},label:{},value:{},maxlength:{},handler:{type:Function}},setup(n){const e=n,{t}=Yt(),i=ee(!1),r=ee(e.value),s=ee(),o=()=>{r.value&&e.handler(e.name,r.value)},a=()=>{i.value=!1},l=()=>{r.value=e.value,i.value=!0,Yi().then(()=>{setTimeout(()=>{s.value.focus(),u()},100)})},c=h=>h.replace(/\u2006/g," "),u=()=>{const h=s.value.$el.querySelector("input");if(h){const d=r.value.length;h.setSelectionRange(d,d)}};return(h,d)=>{const f=xn,p=Oi,g=Jo,m=F0;return V(),le("div",$Ke,[ye(p,{border:!1,title:Be(t)(h.label),value:h.value,center:""},{"right-icon":be(()=>[ye(f,{class:"ml-6 f-s-12",name:"editor",size:"12px",onClick:l})]),_:1},8,["title","value"]),ye(m,{show:i.value,"onUpdate:show":d[1]||(d[1]=v=>i.value=v),title:Be(t)(h.label),"class-name":"device-name","show-cancel-button":"","confirm-button-disabled":!r.value,"confirm-button-text":Be(t)("common.msg.ok"),"cancel-button-text":Be(t)("common.msg.cancel"),onCancel:a,onConfirm:o},{default:be(()=>[ue("div",null,[ye(g,{ref_key:"autoFocus",ref:s,modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=v=>r.value=v),modelModifiers:{trim:!0},maxlength:h.maxlength,class:"project-new-name-input",placeholder:Be(t)("device.setting.name_is_empty"),formatter:c},null,8,["modelValue","maxlength","placeholder"])])]),_:1},8,["show","title","confirm-button-disabled","confirm-button-text","cancel-button-text"])])}}}),jKe=dt(WKe,[["__scopeId","data-v-3b5171be"]]),QKe=Fe({__name:"UnitExtra",props:{unitExtra:{type:[String,Boolean]},isUnitWidget:{type:Boolean}},setup(n){const e=si(),t=te(()=>{var i;return`(${(i=e.unit)==null?void 0:i.current})`});return(i,r)=>(V(),le("span",null,[Be(tA)(i.unitExtra)||i.isUnitWidget?(V(),le(vt,{key:0},[Gt(Te(t.value),1)],64)):(V(),le(vt,{key:1},[Gt(Te(i.unitExtra),1)],64))]))}}),XKe={class:"custom-label"},YKe={key:0,class:"label-extra-multi"},qKe=Fe({__name:"ItemLabel",props:{label:{},unitExtra:{},labelExtra:{},unitExtraDesc:{type:Boolean},widget:{},titleClass:{}},setup(n){const{t:e}=Yt(),t=n,i=te(()=>t.labelExtra??"");return(r,s)=>(V(),le("div",XKe,[i.value?(V(),le("div",YKe,Te(Be(e)(i.value)),1)):$e("",!0),ue("span",{class:St(["label-wrap",r.titleClass]),style:{"white-space":"pre-wrap"}},Te(Be(e)(r.label??"")),3),r.unitExtra||["unitInput"].includes(r.widget||"")?(V(),Ie(QKe,{key:1,"unit-extra":r.unitExtra,"is-unit-widget":["unitInput"].includes(r.widget||"")||r.unitExtraDesc||!1},null,8,["unit-extra","is-unit-widget"])):$e("",!0)]))}}),qc=dt(qKe,[["__scopeId","data-v-a32474cc"]]),KKe={class:"ellipse-container"},JKe=Fe({__name:"WidgetEllipse",props:{label:{},labelExtra:{},name:{},value:{type:[String,Number,Boolean]},disabled:{type:Boolean},labelSuffix:{},options:{},handler:{type:Function}},setup(n){const e=ee(!0),t=ee(!1),i=()=>{e.value=!0,t.value=!1},r=()=>{e.value=!1,t.value=!0},{t:s}=Yt();return(o,a)=>{const l=Oi;return V(),Ie(l,{class:"ellipse-wrapper"},{title:be(()=>[ye(qc,{label:o.label,"label-extra":o.labelExtra},null,8,["label","label-extra"])]),label:be(()=>[]),"right-icon":be(()=>[ue("div",KKe,[ue("div",{class:St(["green-ellipse",{active:e.value}]),onClick:i},Te(Be(s)(o.options[0].label)),3),ue("div",{class:St(["gray-ellipse",{active:t.value}]),onClick:r},Te(Be(s)(o.options[1].label)),3)])]),_:1})}}}),ZKe=dt(JKe,[["__scopeId","data-v-b358683e"]]),eJe=Fe({__name:"WidgetInput",props:{min:{},max:{},fractionDigits:{},step:{},name:{},label:{},value:{},disabled:{type:Boolean},allowNull:{type:Boolean},labelSecondary:{},labelSuffix:{},defaultValue:{},handler:{type:Function}},setup(n){const e=n,{t}=Yt(),i=ee(!1),r=ee(e.value),s=te(()=>{let u=t(e.label);return e.labelSecondary&&(u+=`-${t(e.labelSecondary)}`),e.labelSuffix&&(u+=`(${e.labelSuffix})`),u}),o=te(()=>Number(e.min)<0?["-","."]:["."]),a=te(()=>qr({id:e.name,type:"number",value:r.value,attrs:{min:e.min,max:e.max,step:e.step,fractionDigits:e.fractionDigits,showValRange:!0,valueWidth:"100px",allowNull:!!e.allowNull,onChange:h=>{l(h)}},keyboardAttrs:{extraKey:o.value}})),l=u=>{console.log("keyboardConfirmVal",u),r.value=a.value.value,e.handler(e.name,a.value.value)},c=()=>{e.disabled||(a.value.value=r.value,i.value=!0)};return(u,h)=>{const d=BI,f=vg,p=Oi;return V(),Ie(p,{center:""},{title:be(()=>[ue("span",null,Te(s.value),1)]),value:be(()=>[ye(d,{"model-value":r.value,max:u.max,min:u.min,"fraction-digits":u.fractionDigits,step:u.step,disabled:u.disabled,"input-align":"right",style:{padding:"0"},readonly:"",onClick:dr(c,["stop"])},null,8,["model-value","max","min","fraction-digits","step","disabled"]),ye(f,{show:i.value,"onUpdate:show":h[0]||(h[0]=g=>i.value=g),"focus-index":0,title:s.value,inputs:[a.value]},null,8,["show","title","inputs"])]),_:1})}}}),tJe={key:0,class:"multiple-values"},nJe={key:1},iJe=Fe({__name:"WidgetInputNumber",props:{min:{},max:{},fractionDigits:{},step:{},name:{},label:{},value:{},disabled:{type:Boolean},multiState:{type:Boolean},allowNull:{type:Boolean},labelSecondary:{},labelSuffix:{},defaultValue:{},suffix:{},handler:{type:Function}},setup(n){const e=n,{t}=Yt(),i=ee(!1),r=te({get:()=>ee(e.value),set:h=>h}),s=te(()=>e.multiState),o=te(()=>{let h=t(e.label);return e.labelSecondary&&(h+=`-${t(e.labelSecondary)}`),e.labelSuffix&&(h+=`(${e.labelSuffix})`),e.suffix&&(h+=`(${e.suffix})`),h}),a=te(()=>Number(e.min)<0?["-","."]:["."]),l=te(()=>qr({id:e.name,type:"number",value:r.value.value,attrs:{min:e.min,max:e.max,step:e.step,fractionDigits:e.fractionDigits,showValRange:!0,valueWidth:"100px",allowNull:!!e.allowNull,onChange:d=>{c(d)}},keyboardAttrs:{extraKey:a.value}})),c=h=>{console.log("keyboardConfirmVal",h),r.value.value=l.value.value,e.handler(e.name,l.value.value)},u=()=>{e.disabled||(l.value.value=r.value.value,i.value=!0)};return(h,d)=>{const f=BI,p=xn,g=vg,m=Oi;return V(),Ie(m,{center:"",class:"van-cell-100"},{title:be(()=>[ue("span",null,Te(o.value),1)]),value:be(()=>[$e("",!0),ue("div",{class:St(["num_box",{"disabled-color":h.disabled}]),onClick:dr(u,["stop"])},[s.value?(V(),le("span",tJe,Te(h.$t("common.input-multi-state")),1)):(V(),le("span",nJe,Te(r.value.value),1)),ye(p,{name:"slider_right",size:"9px",class:"f-s-9"})],2),ye(g,{show:i.value,"onUpdate:show":d[0]||(d[0]=v=>i.value=v),"focus-index":0,title:o.value,inputs:[l.value]},null,8,["show","title","inputs"])]),_:1})}}}),rJe=dt(iJe,[["__scopeId","data-v-976b223c"]]),sJe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAASCAYAAABSO15qAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFPSURBVHgBnVPLUcMwFFyJ39V04A4IF2a4mQpIB7iEdGDoACrAriAlJBwYfoekBJWQM+CIleRfJJkMvBlb8tN7u6uVBYyE/kDGp8CekKMr30ixxa1+x0qvkPwdQGDipHD8wvw/ANfdXHM7r5jZ6QuyvQAsyjmkHmDRjFNuaxIA6Oc+yWzMvMSyS5xR0bz1pVdwhEcL5JxPEYsDrmm7hZS+FE6Qa8ro+IIFOWqUnvRl0xTGMU6dAt1IrnEfFNW44/pDFOATM9Gxh7HhkxgWcY4NjVsESqhOMnmDeBjWtWnulPihkUr7o/gh6IPk3kUvXVza76VfekiAxFk5kE42NqgI4xPf2YBISTIpryjebGIb5CtJtmondeId465eNfhS4gKlJFtJ5KpLtqbFFbS3UnF+ZSb2PyBI3px1+tvVtccosDbNcY94ifQbpqP9Zt0j+AHphXgvFSDwzgAAAABJRU5ErkJggg==",oJe=Fe({__name:"WidgetMaterial",props:{name:{},label:{},labelExtra:{},value:{},options:{},processTypes:{},handler:{type:Function}},setup(n){const e=B0(),t=n,{t:i,locale:r}=Yt(),s=te({get:()=>{const g=t.value,m=u.value.find(_=>_.id===g);let v;return(m==null?void 0:m.id)===0?v=r.value==="zh-CN"?i(m==null?void 0:m.name.zh):i(m==null?void 0:m.name.en):v=r.value==="zh-CN"?m==null?void 0:m.name.zh:m==null?void 0:m.name.en,v||i("device.common.user_defined_material")},set:g=>g}),o=el(),a=bt(),l=()=>{var g;e.push({path:"/more-material",query:{processTypes:t.processTypes,selectMaterial:(g=c.value)==null?void 0:g.id}})},c=ee(null),u=te(()=>{const g=o.getMaterialList;return Oj(t.processTypes,g)}),h=te(()=>u.value.map(({id:g,name:m})=>{const v=r.value==="zh-CN"?m.zh:m.en;return{id:g,text:g===0?i(v):v}})),d=te({get:()=>{const g=t.value,m=u.value.find(v=>v.id===g);return m==null?void 0:m.isDangerous},set:g=>g});Zn(async()=>{window.addEventListener("message",f),console.log("props.value",o.getLocalMaterial());const g=await o.getLocalMaterial(),m=g===null?t.value:o.getLocalMaterial();if(c.value=h.value.find(v=>v.id===m),g!==null){const v=u.value.find(_=>_.id===m);v&&(t.handler(t.name,v),await o.setLocalMaterial(null))}}),qo(()=>{window.removeEventListener("message",f)});function f(g){const{action:m,id:v,processingType:_="",matrix:y={},power:A,laserSource:w="blue",productID:b}=g.data;if(m==="SelectMaterial")if(p(v)){const I={processingType:_,matrix:y};["MF1","GS002"].includes(b)&&el().setLaserSource(w==="red"?"red":"blue"),Yi(()=>{var x;(x=a.dataSource)==null||x.setMatrixParamFromOutside(I),tt.modal.showToast({msg:"device.parameter_panel.used_success",icon:"success",duration:3e3})})}else tt.modal.showToast({msg:"device.parameter_panel.used_fail",icon:"error",duration:3e3})}const p=g=>{const m=u.value.find(v=>v.id===g);return c.value=h.value.find(v=>v.id===g),m&&t.handler?(t.handler(t.name,m),g>0&&o.sortLocalMaterial(g),!0):!1};return yt(()=>h.value,(g,m)=>{const v=g.map(y=>y.id).join(","),_=(m||[]).map(y=>y.id).join(",");if(v!==_&&(!g.some(A=>A.id===t.value)&&(a!=null&&a.ext)&&(p(0),console.log(["不支持该材料",t.value,g])),t.value)){const A=u.value.find(b=>b.id===t.value),w=a.dataSource.getOfficialMaterial();gi(w)&&A&&(a.dataSource.officialMaterial={id:a.dataSource.canvasId,value:A})}},{immediate:!0}),(g,m)=>{const v=ng,_=xn,y=Oi;return V(),Ie(y,{"is-link":"",title:Be(i)(g.label),value:s.value,onClick:l},{"right-icon":be(()=>[d.value?(V(),Ie(v,{key:0,src:Be(sJe),width:16,height:18,class:"fire"},null,8,["src"])):$e("",!0),ye(_,{name:"arrow_right",size:"22px",class:"f-s-22"})]),_:1},8,["title","value"])}}}),aJe=dt(oJe,[["__scopeId","data-v-e9e24da2"]]),lJe={key:0},cJe={key:1},uJe=Fe({__name:"WidgetParamSelect",props:{name:{},label:{},labelExtra:{},options:{},ignoreTranslate:{type:Boolean},value:{},processingType:{},material:{},disabledOfficial:{type:Boolean},handler:{type:Function}},setup(n){const e=n,t=(g,m)=>{var _;let v=((_=g.filter(y=>y.value===m)[0])==null?void 0:_.label)||"";return["official","customize"].includes(m.toString())||(v=""),v},i=te(()=>{let g=e.value;return["official","customize"].includes(g)||(g=""),g}),{t:r}=Yt(),s=ee(!1),o=te(()=>t(d.value,i.value)),a=te({get:()=>r(o.value??""),set:g=>g}),l=te(()=>{const g=ee([]);return g.value[0]=i.value,g}),c=ee(0),u=()=>{c.value=Math.random(),s.value=!0},h=g=>g.map(({label:m,value:v})=>({text:e.ignoreTranslate?m:r(m),value:v})),d=te(()=>{let g=!1;const m=bt().dataSource;if(m){const y=m.getOfficialMaterial();g=y&&y.processingData&&y.processingData[(e==null?void 0:e.processingType)||""]}const v={label:r("device.processing_attrs.x_tool_parameter_reference"),value:"official"},_=[{label:r("device.processing_attrs.user_defined_parameters"),value:"customize"}];return g&&_.unshift(v),_}),f=g=>{s.value=!1;const m=g.selectedOptions[0].value;if(a.value=g.selectedOptions[0].text,l.value.value[0]=m,e.handler&&m!==i.value){const v={materialType:m,data:{}};e.handler(e.name,v)}},p=()=>{s.value=!1};return(g,m)=>{const v=xn,_=Oi,y=lO,A=Ko;return V(),le(vt,null,[ye(_,{center:"","is-link":"",onClick:u},{title:be(()=>[ye(qc,{label:g.label,"label-extra":g.labelExtra},null,8,["label","label-extra"])]),value:be(()=>[a.value?(V(),le("span",lJe,Te(a.value),1)):(V(),le("span",cJe,Te(Be(r)("common.input-multi-state")),1))]),"right-icon":be(()=>[ye(v,{name:"arrow_right",size:"22px",class:"f-s-22"})]),_:1}),ye(A,{show:s.value,"onUpdate:show":m[0]||(m[0]=w=>s.value=w),position:"bottom",round:"","close-on-click-overlay":!0,"safe-area-inset-bottom":"",teleport:"#app"},{default:be(()=>[(V(),Ie(y,{key:c.value,"model-value":l.value.value,title:Be(r)("device.element_container.param"),columns:h(d.value),onCancel:p,onConfirm:f},{confirm:be(()=>[ue("div",null,[ye(v,{name:"picker-confirm",size:"24px",class:"f-s-24"})])]),cancel:be(()=>[ue("div",null,[ye(v,{name:"picker-close",size:"24px",class:"f-s-24"})])]),_:1},8,["model-value","title","columns"]))]),_:1},8,["show"])],64)}}}),hJe=Fe({__name:"WidgetPopover",props:{label:{},triggerSlot:{},content:{},width:{}},setup(n){const e=n,{t}=Yt(),i=()=>{var l;let r="",s,o,a;if(typeof e.content=="string")r=t(e.content);else if(typeof e.content=="object"){typeof e.content.text=="string"&&(r=t(e.content.text));let c=(l=e.content)==null?void 0:l.button;c&&(s=c.label,o=c.href,a=c.onClick)}tt.modal.showTipModal({title:e.label?t(e.label):t("ipad.dialog.tips"),content:r,hasClose:!1,hasCancel:!1,confirmTxt:t("ipad.dialog.got_it"),hasSupply:!!s,supplyTxt:t(s||""),onSupply:a??(()=>{window.MeApi.openNative.openWebInApp(o||"")}),onConfirm:()=>{}})};return(r,s)=>{const o=Hi,a=xn,l=Gs;return V(),Ie(l,{onClick:dr(i,["stop"])},{default:be(()=>{var c;return[r.triggerSlot.type==="button"?(V(),Ie(o,jo(ht({key:0},r.triggerSlot.props)),{default:be(()=>{var u;return[Gt(Te(r.$t(((u=r.triggerSlot)==null?void 0:u.label)||"")),1)]}),_:1},16)):r.triggerSlot.type==="text"?(V(),le("span",jo(ht({key:1},r.triggerSlot.props)),Te(r.$t(((c=r.triggerSlot)==null?void 0:c.label)||"")),17)):(V(),Ie(a,ht({key:2,class:"fl svg-tip f-s-20",name:"infomation",size:"20px"},r.triggerSlot.props),null,16))]}),_:1})}}}),dJe=dt(hJe,[["__scopeId","data-v-4f08f4ef"]]),Uv=n=>n*Math.min(document.documentElement.clientWidth/375,2),fJe={class:"custom-cell-title"},pJe={class:"fl"},gJe=Fe({__name:"WidgetRadioGroup",props:{label:{},labelExtra:{},name:{},value:{type:[String,Number,Boolean]},disabled:{type:Boolean},labelSuffix:{},options:{},handler:{type:Function},groupClass:{},radioDir:{},titleClass:{}},setup(n){const{t:e}=Yt(),t=n,i=bt(),r=te(()=>ee(t.value));yt(()=>r.value.value,a=>{a!==null&&r.value.value!==t.value&&t.handler(t.name,a)});const s=te(()=>{var a;return((a=t.labelSuffix)==null?void 0:a.widget)==="popover"}),o=ee(0);return yt(()=>i.rerenderKey,a=>{a&&(o.value=Math.random())},{immediate:!0}),(a,l)=>{const c=xn,u=U0,h=vT,d=Oi;return V(),Ie(d,{center:"",class:St(["wrap-radio-group",a.groupClass])},{title:be(()=>{var f;return[ue("div",fJe,[ue("div",pJe,[ye(qc,{label:a.label??"","label-extra":a.labelExtra,"title-class":a.titleClass},null,8,["label","label-extra","title-class"])]),s.value?(V(),Ie(ya,ht({key:0,handler:a.handler},{labelExtra:(f=a.labelSuffix)==null?void 0:f.labelExtra,...a.labelSuffix,...a.$attrs},{class:"right-item"}),null,16,["handler"])):$e("",!0)])]}),"right-icon":be(()=>[(V(),Ie(h,{key:o.value,modelValue:r.value.value,"onUpdate:modelValue":l[0]||(l[0]=f=>r.value.value=f),direction:a.radioDir?a.radioDir:"horizontal"},{default:be(()=>[(V(!0),le(vt,null,Fn(a.options,f=>(V(),Ie(u,{key:f.value,disabled:f==null?void 0:f.disabled,name:f.value,"icon-size":Be(Uv)(18),class:"radio-label"},{icon:be(p=>[ye(c,{name:p.checked?"common-radio-check":"common-radio-uncheck",class:"radio-group-icon"},null,8,["name"])]),default:be(()=>[Gt(Te(Be(e)(f.label))+" ",1)]),_:2},1032,["disabled","name","icon-size"]))),128))]),_:1},8,["modelValue","direction"]))]),_:1},8,["class"])}}}),mJe=dt(gJe,[["__scopeId","data-v-115df844"]]),vJe={class:"custom-cell-title"},_Je={key:1},yJe={key:0,class:"cylinder-tips"},AJe={class:"content-info"},bJe={class:"content"},wJe=Fe({__name:"WidgetSelect",props:{name:{},label:{},value:{},options:{},labelExtra:{},defaultValue:{},disabled:{type:Boolean},multiState:{type:Boolean},titleClass:{},tips:{},ignoreTranslate:{type:Boolean},handler:{type:Function},labelSuffix:{},values:{}},setup(n){const e=n,t=(C,I)=>{var x;return((x=C.filter(T=>T.value===I)[0])==null?void 0:x.label)||""},i=te(()=>{var C;return((C=e.labelSuffix)==null?void 0:C.widget)==="popover"}),s=bt().extId,o=Hc(),a=te(()=>e.name==="mode"&&o.currentMode===zt.LASER_CYLINDER&&[nt.F1,nt.D1,nt.D1Pro,nt.P2,nt.M1,nt.F1Ultra].includes(s)),l=te(()=>{switch(s){case nt.P2:return{content:"device.p2.cylinder_alive_tip",link:"https://s.xtool.com/doc/p2/rotary-attachment-tips"};case nt.M1:return{content:"device.m1.cylinder_alive_tip",link:"https://s.xtool.com/doc/m1/rotary-attachment-tips"};case nt.F1Ultra:return{content:"device.m1.cylinder_alive_tip",link:"https://s.xtool.com/F1Ultra/support/rotary-attachment"};case nt.F1:return{content:"device.f1.cylinder_connected_placed_tip",link:"https://s.xtool.com/doc/f1/rotary-attachment-tips"};case nt.D1:return{content:"device.d1.cylinder_connected_placed_tip",link:"https://s.xtool.com/doc/d-series/rotary-attachment-tips"};case nt.D1Pro:return{content:"device.d1pro.cylinder_connected_placed_tip",showLink:!0,link:"https://s.xtool.com/doc/d-series/rotary-attachment-tips"};default:return{}}}),c=ee(!0);c.value=["density","bitmapMode","bitmapScanMode"].includes(e.name);const{t:u}=Yt(),h=ee(!1),d=te(()=>t(e.options,e.value??e.defaultValue)),f=te({get:()=>u(d.value??""),set:C=>C}),p=te(()=>{const C=ee([]);return C.value[0]=e.value,C}),g=ee(0),m=()=>{e.disabled||(g.value=Math.random(),h.value=!0)},v=C=>{let I=!0;return mt(C)?I=C({[e.name]:e.value}):I=C!==!1,I},_=C=>{const I=C.map(({label:O,value:F,status:G,disabled:B})=>({text:e.ignoreTranslate?O:u(O),value:F,status:G,disabled:B})),x=I.length,T=[];for(let O=0;O<x;O++){const F=I[O];F.status!=="disable"&&T.push(F)}return T},y=C=>{h.value=!1,f.value=C.selectedOptions[0].text,p.value.value[0]=C.selectedOptions[0].value,e.handler(e.name,C.selectedOptions[0].value)},A=()=>{h.value=!1},w=C=>{p6({title:u(e.label),message:C.content,showCancelButton:!1,confirmButtonText:u("common.msg.ok")})},b=C=>{var I,x;(x=(I=window.MeApi)==null?void 0:I.openNative)==null||x.openWebInApp(C)};return(C,I)=>{const x=xn,T=Oi,O=lO,F=Ko;return V(),le(vt,null,[ye(T,{"is-link":!C.disabled,class:"mode-wrapper",center:"",clickable:!1,onClick:m},{title:be(()=>{var G;return[ue("div",vJe,[ue("div",{class:St(["fl",C.titleClass])},[ye(qc,{label:C.label??"","label-extra":C.labelExtra},null,8,["label","label-extra"]),e.tips?(V(),Ie(x,{key:0,class:"fl svg-tip f-s-16",name:"infomation",onClick:I[0]||(I[0]=dr(B=>w(e.tips),["stop"]))})):i.value&&v(C.labelSuffix.visible)?(V(),Ie(ya,ht({key:1,handler:C.handler},{labelExtra:(G=C.labelSuffix)==null?void 0:G.labelExtra,...C.labelSuffix,...C.$attrs},{class:"right-item"}),null,16,["handler"])):$e("",!0)],2)])]}),value:be(()=>[f.value?(V(),le("span",{key:0,style:On(`color: ${C.disabled?"#B0B2B5":"#1A1A1E"}`)},Te(f.value),5)):(V(),le("span",_Je,Te(Be(u)("common.input-multi-state")),1))]),"right-icon":be(()=>[ye(x,{name:"arrow_right",size:"22px",class:"f-s-22"})]),_:1},8,["is-link"]),a.value?(V(),le("div",yJe,[ye(x,{name:"msg_info",class:"msg-info-icon f-s-16"}),ue("div",AJe,[ue("span",bJe,Te(Be(u)(l.value.content??"")),1),ue("span",{class:"learn-more",onClick:I[1]||(I[1]=G=>b(l.value.link??""))},Te(Be(u)("device.common.learn_more")),1),ye(x,{name:"arrow-right-up",size:"16px",class:"f-s-16",style:{"margin-bottom":"-5px"}})])])):$e("",!0),ye(F,{show:h.value,"onUpdate:show":I[2]||(I[2]=G=>h.value=G),position:"bottom",round:"","close-on-click-overlay":!0,"safe-area-inset-bottom":"",teleport:"#app"},{default:be(()=>[(V(),Ie(O,{key:g.value,"model-value":p.value.value,title:Be(u)(C.label??""),columns:_(C.options),onCancel:A,onConfirm:y},{confirm:be(()=>[ue("div",null,[ye(x,{name:"picker-confirm",size:"24px",class:"f-s-24"})])]),cancel:be(()=>[ue("div",null,[ye(x,{name:"picker-close",size:"24px",class:"f-s-24"})])]),_:1},8,["model-value","title","columns"]))]),_:1},8,["show"])],64)}}}),xJe=dt(wJe,[["__scopeId","data-v-663c8f44"]]),CJe={class:"content-wrap"},EJe=Fe({__name:"WidgetSelectMaterialText",props:{name:{},label:{},value:{},handler:{type:Function}},setup(n){const{t:e,locale:t}=Yt(),i=bt(),r=te(()=>{var o;const s=(o=i.dataSource)==null?void 0:o.getOfficialMaterial();return s?t.value==="zh-CN"?e(s.name.zh):e(s.name.en):e("device.common.user_defined_material")});return(s,o)=>{const a=Oi;return V(),Ie(a,{center:""},{title:be(()=>[ue("span",null,Te(Be(e)(s.label)),1)]),value:be(()=>[ue("span",CJe,Te(r.value),1)]),_:1})}}}),TJe=dt(EJe,[["__scopeId","data-v-58242fe1"]]),IJe={key:1,class:"num_tip"},SJe=Fe({__name:"SliderBlock",props:{modelValue:{}},setup(n){const e=ee(!1),t=()=>{e.value=!0},i=()=>{e.value=!1};return(r,s)=>{const o=xn;return V(),le("div",{class:St(["custom-button",e.value?"active":""]),onTouchstart:t,onTouchend:i},[e.value?(V(),Ie(o,{key:0,class:"down_icon",name:"down_slider",size:Be(Uv)(12)},null,8,["size"])):$e("",!0),e.value?(V(),le("div",IJe,Te(Be(Rt)(r.modelValue)?`${parseInt(r.modelValue[0])}~${parseInt(r.modelValue[1])}`:r.modelValue),1)):$e("",!0)],34)}}}),Gk=dt(SJe,[["__scopeId","data-v-aa085fb2"]]),PJe={class:"van-cell-title"},MJe={class:"fl"},RJe={class:"slider-content"},DJe={style:{padding:"36px"}},kJe={style:{display:"flex"}},OJe={key:0,class:"multiple-values"},LJe={key:1},NJe=Fe({__name:"WidgetSlider",props:{step:{},name:{},label:{},labelExtra:{},value:{},defaultValue:{},multiState:{type:Boolean},min:{},max:{},scale:{},fractionDigits:{},unitExtra:{},desc:{},itemClass:{},hideBorder:{type:Boolean},disabled:{type:Boolean},handler:{type:Function}},setup(n){const e=n,{t}=Yt(),i=ee(!1),r=te(()=>e.step||1),s=ee(0);yt(()=>e.value,w=>{s.value=Math.random(),l.value.value=w||e.min,c.value=w});const o=te(()=>e.multiState),a=ee(!1);a.value=["power","speed","repeat","dotDuration","dpi","cutPressure"].includes(e.name);const l=te({get:()=>ee(e.value),set:w=>w}),c=ee(e.value);yt(()=>l.value.value,w=>{e.value?c.value=w:c.value=null},{immediate:!0});const u=ee(!1),h=te(()=>qr({type:"number",value:e.value===null?null:l.value,attrs:{min:e.min,max:e.max,fractionDigits:e.fractionDigits,scale:e.scale,showValRange:!0,disabled:e.disabled,valueWidth:"100px",onChange:b=>{l.value.value=b,c.value=b,u.value=!0}}}));yt(()=>i.value,w=>{w||u.value&&(u.value=!1,d(l.value.value??e.min))});const d=w=>{const b=Number(w)>Number(e.min)?w:e.min;p(b)},f=w=>{c.value=w},p=w=>{let b=Number(w);e.handler(e.name,b),c.value=b},g=()=>{e.disabled||(i.value=!0)},m=ee(!1),v=te(()=>({"--v-tooltip-visible":m.value?"visible":"hidden"})),_=()=>{m.value=!0,window.MeApi.openNative.generateImpactFeedback()},y=()=>{m.value=!1},A=te(()=>{let w="";return e.label&&(w=t(e.label)),e.labelExtra&&(w+=e.labelExtra),e.unitExtra&&(w+=e.unitExtra),w});return(w,b)=>{const C=ig,I=xn,x=vg,T=Oi;return V(),Ie(T,{center:"",class:St(["add-icon-suffix-wrap slder-overflow-visible",w.itemClass]),border:!w.hideBorder},{title:be(()=>[ue("div",PJe,[ue("div",{class:St(["slider-label-wrap",{"multi-wrap":w.labelExtra}])},[ue("div",MJe,[ye(qc,{label:w.label,"unit-extra":w.unitExtra,"label-extra":w.labelExtra||w.desc},null,8,["label","unit-extra","label-extra"])])],2)])]),label:be(()=>[ue("div",RJe,[ye(C,{modelValue:l.value.value,"onUpdate:modelValue":[b[0]||(b[0]=O=>l.value.value=O),f],min:w.min,max:w.max,step:r.value,"bar-height":Be(Uv)(4),class:St(["bar_speed",e.name]),"active-color":"#28BE44","inactive-color":"#D9D9DE",style:On(v.value),disabled:w.disabled,onDragStart:_,onDragEnd:y,onChange:p},{button:be(()=>[ue("div",DJe,[ye(Gk,{"model-value":l.value.value},null,8,["model-value"])])]),_:1},8,["modelValue","min","max","step","bar-height","style","class","disabled"]),ue("div",kJe,[ue("div",{class:St(["num_box",{"disabled-color":w.disabled}]),onClick:dr(g,["stop"])},[o.value?(V(),le("span",OJe,Te(w.$t("common.input-multi-state")),1)):(V(),le("span",LJe,Te(l.value.value),1)),ye(I,{name:"slider_right",class:"f-s-9"})],2),ye(x,{show:i.value,"onUpdate:show":b[1]||(b[1]=O=>i.value=O),"focus-index":0,title:A.value,inputs:[h.value]},null,8,["show","title","inputs"])])])]),_:1},8,["class","border"])}}}),BJe=dt(NJe,[["__scopeId","data-v-1c4a4441"]]),FJe={class:"van-cell-title"},UJe={class:"fl"},GJe={class:"slider-content"},HJe={style:{padding:"36px"}},VJe={style:{padding:"36px"}},zJe={style:{display:"flex"}},$Je={key:0},WJe={key:1},jJe=Fe({__name:"WidgetSliderRange",props:{step:{},name:{},label:{},labelExtra:{},value:{},defaultValue:{},min:{},max:{},scale:{},fractionDigits:{},unitExtra:{},disabled:{type:Boolean},handler:{type:Function}},setup(n){const{t:e}=Yt(),t=ee(!1),i=n,r=te(()=>i.step||1),s=ee(0);yt(()=>i.value,y=>{s.value=Math.random(),o.value.value=[...y],a.value=y});const o=te({get:()=>ee(cr(i.value)?[1,1]:[...i.value]),set:y=>y}),a=ee(i.value);yt(()=>o.value.value,y=>{i.value?a.value=y:a.value=null},{immediate:!0});const l=ee(!1),c=te(()=>{const y=qr({type:"number",value:i.value===null?null:o.value.value[0],attrs:{min:i.min,max:i.max,fractionDigits:i.fractionDigits,scale:i.scale,showValRange:!0,valueWidth:"100px",onChange:w=>{o.value.value[0]=w,p([w,o.value.value[1]])}}}),A=qr({type:"number",value:i.value===null?null:o.value.value[1],attrs:{min:i.min,max:i.max,fractionDigits:i.fractionDigits,scale:i.scale,showValRange:!0,valueWidth:"100px",onChange:w=>{o.value.value[1]=w,p([o.value.value[0],w])}}});return[y,A]});yt(()=>t.value,y=>{y||l.value&&(l.value=!1,u(o.value.value??[1,1]))});const u=y=>{const A=Number(y)>Number(i.min)?y:i.min;p(A)},h=y=>{a.value=y};let d=0,f=0;const p=y=>{const A=y,w=Math.min(A[0],A[1]);let b=Math.max(A[0],A[1]);w===d&&f===b||(d=w,f=b,a.value=y,console.log("set rang value=",w,b),i.handler(i.name,[w,b]))},g=ee(!1),m=te(()=>({"--v-tooltip-visible":g.value?"visible":"hidden"})),v=()=>{g.value=!0,window.MeApi.openNative.generateImpactFeedback()},_=()=>{g.value=!1};return(y,A)=>{const w=ig,b=xn,C=vg,I=Oi;return V(),Ie(I,{center:"",class:"add-icon-suffix-wrap"},{title:be(()=>[ue("div",FJe,[ue("div",{class:St(["slider-label-wrap",{"multi-wrap":y.labelExtra}])},[ue("div",UJe,[ye(qc,{label:y.label,"unit-extra":y.unitExtra,"label-extra":y.labelExtra},null,8,["label","unit-extra","label-extra"])])],2)])]),label:be(()=>[ue("div",GJe,[ye(w,{modelValue:o.value.value,"onUpdate:modelValue":[A[0]||(A[0]=x=>o.value.value=x),h],min:y.min,max:y.max,step:r.value,"bar-height":"4px",class:St(["bar_speed",i.name]),"active-color":"#28BE44",style:On(m.value),range:"",onDragStart:v,onDragEnd:_,onChange:p},{"left-button":be(({value:x})=>[ue("div",HJe,[ye(Gk,{"model-value":x},null,8,["model-value"])])]),"right-button":be(({value:x})=>[ue("div",VJe,[ye(Gk,{"model-value":x},null,8,["model-value"])])]),_:1},8,["modelValue","min","max","step","style","class"]),ue("div",zJe,[ue("div",{class:"num_box",onClick:A[1]||(A[1]=dr(x=>t.value=!0,["stop"]))},[Be(cr)(y.value)?(V(),le("span",$Je,Te(Be(e)("common.input-multi-state")),1)):(V(),le("span",WJe,Te(`${o.value.value[0]},${o.value.value[1]}`),1)),ye(b,{name:"slider_right",size:"9px",class:"f-s-9"})]),ye(C,{show:t.value,"onUpdate:show":A[2]||(A[2]=x=>t.value=x),"focus-index":0,title:Be(e)(y.label),inputs:c.value},null,8,["show","title","inputs"])])])]),_:1})}}}),QJe=dt(jJe,[["__scopeId","data-v-6aaf4636"]]),XJe={class:"custom-cell-title"},YJe={class:"fl"},qJe={class:"switch-container"},KJe=Fe({__name:"WidgetSwitch",props:{name:{},label:{},labelExtra:{},value:{type:Boolean},hideSwitch:{type:Boolean},disabled:{type:Boolean},multiState:{type:Boolean},childs:{},tips:{},labelSuffix:{},handler:{type:Function}},setup(n){const e=n,t=te(()=>e.name==="processIgnore"?!e.value:e.value),i=s=>{const o=e.name==="processIgnore"?!s:s;e.multiState?e.handler(e.name,!1):e.handler(e.name,o)},r=te(()=>{var s,o,a,l,c,u;return((s=e.labelSuffix)==null?void 0:s.widget)==="popover"&&((a=(o=e.labelSuffix)==null?void 0:o.widgetAttrs)!=null&&a.content)?{content:[{text:(u=(c=(l=e.labelSuffix)==null?void 0:l.widgetAttrs)==null?void 0:c.content)==null?void 0:u.text,link:"",style:{link:!1,block:!1}}]}:e.tips});return(s,o)=>{const a=G0,l=Oi;return V(),Ie(l,{center:"",class:"mode-wrapper"},Pr({title:be(()=>[ue("div",XJe,[ue("div",YJe,[ye(qc,{label:s.label,"label-extra":s.labelExtra},null,8,["label","label-extra"])]),r.value?(V(),Ie(ya,ht({key:0,handler:s.handler},{labelExtra:s.labelSuffix.labelExtra,...s.labelSuffix,...s.$attrs},{class:"right-item"}),null,16,["handler"])):$e("",!0)])]),_:2},[e.hideSwitch?void 0:{name:"value",fn:be(()=>[ue("div",qJe,[ye(a,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=c=>t.value=c),disabled:s.disabled,class:St([{"multi-state":s.multiState},"switch"]),size:Be(Uv)(22),onChange:i},null,8,["modelValue","disabled","class","size"])])]),key:"0"}]),1024)}}}),JJe=dt(KJe,[["__scopeId","data-v-61b29dd2"]]),ZJe=Fe({__name:"WidgetSwitchCoord",props:{name:{},label:{},value:{type:Boolean},handler:{type:Function}},setup(n){const{t:e}=Yt(),t=n,i=ee(t.value),r=s=>{i.value=s,t.handler(t.name,s)};return(s,o)=>{const a=G0,l=Oi;return V(),Ie(l,{center:""},{title:be(()=>[ue("span",null,Te(Be(e)(s.label)),1)]),"right-icon":be(()=>[ye(a,{"model-value":i.value,size:"18px","onUpdate:modelValue":r},null,8,["model-value"])]),_:1})}}}),eZe=dt(ZJe,[["__scopeId","data-v-b9cf8960"]]),tZe=Fe({__name:"WidgetText",props:{value:{},textClassName:{},format:{type:Function}},setup(n){const e=n,t=te(()=>mt(e.format)?e.format(e.value??""):e.value);return(i,r)=>(V(),le("div",ht({class:"w-text"},i.$attrs,{class:i.textClassName}),Te(t.value),17))}}),nZe=dt(tZe,[["__scopeId","data-v-cfd7b558"]]),iZe=Fe({__name:"WidgetUnitInput",props:{disabled:{type:Boolean},loading:{type:Boolean},min:{},max:{},name:{},label:{},value:{},labelSuffixStr:{},labelSuffix:{},suffix:{},childrens:{},onBlur:{},allowNull:{type:Boolean},showOverlay:{type:Boolean},handler:{type:Function}},setup(n){const e=n,{t}=Yt(),i=ee(!1),r=si(),s=te(()=>r.unit),o=bt(),a=o.extId,{fractionDigits:l,scale:c,step:u,current:h}=s.value,d=te(()=>`${t(e.label)}${e.labelSuffixStr??""}(${h})`),f=te(()=>a===nt.S1?["perimeter","diameter"].includes(e.name)?{border:!0,class:"unit-input-padding"}:{border:!0,class:""}:a===nt.F1&&["thickness"].includes(e.name)?{border:!0,class:""}:["focalLength","focalLen","thickness"].includes(e.name)?{border:!0,class:""}:["perimeter","diameter"].includes(e.name)?{border:!0,class:"unit-input-padding"}:{border:!0,class:""}),{valueRef:p,running:g,debouncedFn:m}=sZ(e.value,e.handler);yt(()=>e.value,(w,b)=>{w!==b&&(p.value=w)});const v=te(()=>!(a===nt.F1&&["thickness"].includes(e.name))),_=te(()=>qr({id:e.name,type:"number",value:e.value,attrs:{min:e.min,max:e.max,showValRange:!0,unit:h,valueWidth:"100px",step:u,scale:c,fractionDigits:l,allowNull:v.value,onChange:b=>{console.log("onChange",b),p.value=b}},keyboardAttrs:{extraKey:["."]}})),y=w=>{var C;if(console.log("keyboardConfirmVal",w),o.extId===nt.F1&&e.name==="thickness"&&(o.isInProcessing||o.isFrameMode)){tt.modal.showToast({msg:t("device.process.device_is_working"),wordBreak:"break-word"});return}p.value=_.value.value;let b=_.value.value;e.name==="thickness"&&(b=w),e.handler(e.name,b),(C=e.onBlur)==null||C.call(e,{target:{_value:b}})};yt(()=>i.value,w=>{w||y(p.value??e.min)});const A=()=>{_.value.value=p.value,i.value=!0};return yt(()=>o.manualMeasurementVal,w=>{w!==null&&[nt.M1,nt.P2].includes(a)&&e.name==="focalLength"&&(e.handler(e.name,w),o.manualMeasurementVal=null)},{immediate:!0}),(w,b)=>{const C=BI,I=vg;return V(),le("div",{class:St([f.value.class,"unit-content"])},[ye(C,{"model-value":w.value,"allow-null":"",max:w.max,min:w.min,scale:Be(c),"fraction-digits":Be(l),"input-align":"right",style:{padding:"0"},readonly:"",onClick:dr(A,["stop"])},null,8,["model-value","max","min","scale","fraction-digits"]),ye(I,{show:i.value,"onUpdate:show":b[0]||(b[0]=x=>i.value=x),"focus-index":0,title:d.value,inputs:[_.value],"show-overlay":w.showOverlay},null,8,["show","title","inputs","show-overlay"])],2)}}}),rZe=dt(iZe,[["__scopeId","data-v-a7c91380"]]),sZe={style:{margin:"0 3px"}},oZe=Fe({__name:"WidgetUnitNumber",props:{value:{},prefix:{},defaultValue:{},hideUnit:{type:Boolean}},setup(n){const e=n,{displayValue:t,mm:i,unit:r,updateDisplayValue:s}=OKe(e.value);return yt(()=>e.value,o=>{o!==i.value&&s(e.value,"mm")}),(o,a)=>(V(),le("section",jo(ch(o.$attrs)),[ue("span",null,[o.prefix?(V(),le(vt,{key:0},[Gt(Te(o.prefix),1)],64)):$e("",!0),ue("span",sZe,Te(Be(t)??o.defaultValue),1),Be(r)&&!o.hideUnit?(V(),le(vt,{key:1},[Gt(Te(Be(r)),1)],64)):$e("",!0)])],16))}}),aZe={select:xJe,material:aJe,unitInput:rZe,slider:BJe,switch:JJe,text:nZe,radioGroup:mJe,ellipse:ZKe,paramSelect:uJe,selectMaterialText:TJe,sliderRange:QJe,edit:jKe,deviceInfo:HKe,devicePower:VKe,deviceVersion:zKe,switchCoord:eZe,buttonGroups:UKe,input:eJe,button:BKe,buttonLink:GKe,number:rJe,popover:dJe,unitNumber:oZe},ya=Fe({__name:"XFormItem",props:{widget:{},widgetAttrs:{}},setup(n){return(e,t)=>{var i,r;return V(),le(vt,null,[e.widget?(V(),Ie(Uo(Be(aZe)[e.widget]),ht({key:0},{...e.$attrs,...e.widgetAttrs},{value:e.$attrs.value===void 0?((i=e.widgetAttrs)==null?void 0:i.defaultValue)||((r=e.widgetAttrs)==null?void 0:r.value):e.$attrs.value}),null,16,["value"])):$e("",!0),Fs(e.$slots,"default")],64)}}}),aZ=""+new URL("../assets/p2-manual-measurement-LSWW1BAn.png",import.meta.url).href,lZe={class:"custom-cell-title"},cZe={class:"right-content"},uZe=Fe({__name:"WidgetUnitInputCell",props:{item:{},values:{},handler:{type:Function}},setup(n){const{t:e}=Yt(),t=n,i=bt(),r=Hc(),s=d=>{let f=!0;return mt(d)?f=d(t.values):f=d===!0,f},o=d=>{var f;return((f=d.labelSuffix)==null?void 0:f.widget)==="popover"},a=d=>{let f=!0;return mt(d)?f=d(t.values):f=d!==!1,f},l=i.extId,c=te(()=>{var f,p;const d=t.item.label?(f=t.item.label)==null?void 0:f.split("."):"";return!!([nt.M1].includes(l)&&["distance"].includes(d[d.length-1])&&(r.currentMode===zt.LASER_CYLINDER||r.currentMode===zt.PASS_THROUGH)||["thickness","distance"].includes(d[d.length-1])&&[nt.P2].includes(l)&&(r.currentMode==="FREE_PLANE"||r.currentMode==="LASER_PLANE")||[nt.S1].includes(l)&&["popover"].includes((p=t.item.labelSuffix)==null?void 0:p.widget))}),u=()=>{let d="",f="",p="",g="",m="",v=!0,_=!1,y=()=>{};switch(l){case nt.M1:d="device.common.distance",f="device.measure_guide.manual_measurement_auto",g="mobile.common.cancel",m="device.measure_guide.manual_measurement",v=!0,_=!0,y=()=>{try{h()}catch(A){console.log("==>gotoManual  error",A)}};break;case nt.P2:d="device.p2.hand_measure_with_hand_title",f="device.p2.hand_measure_with_hand_tips",g="mobile.common.cancel",m="ipad.dialog.got_it",v=!1,_=!1,y=()=>{};break;case nt.S1:d="device.p2.hand_measure_with_hand_title",f="device.s1.hand_measure_with_hand_tip",p="https://s.xtool.com/doc/s1/manual-measure",g="mobile.common.cancel",m="ipad.dialog.got_it",v=!1,_=!1,y=()=>{};break}console.log("==> showTipsHandle ",l),l==nt.S1?tt.modal.showRemindDialog({title:e(d),message:e(f),image:aZ,link:p,linkTextColor:"#0074FD",linkNoWrap:!0,allowHtml:!0,defaultBtn:!1,confirmButtonText:e("ipad.dialog.got_it")}):tt.modal.showTipModal({title:e(d),content:e(f),hasClose:v,hasCancel:_,cancelTxt:e(g),confirmTxt:e(m),onCancel:()=>{},onConfirm:()=>{y()}})},h=async()=>{var f,p,g,m;if(!i.connected){tt.modal.showToast({message:e("device.process.device_is_offline"),wordBreak:"break-word"});return}let d=!0;if(d=await((p=(f=i.ext)==null?void 0:f.apis)==null?void 0:p.laserHeadIsHoming()),!d||i.isInProcessing){tt.modal.showToast({message:e("device.setting.setting_error_in_processing"),wordBreak:"break-word"});return}(m=(g=i.ext)==null?void 0:g.apis)==null||m.unLockedLeaserHead(),tt.modal.showManualDistanceModal()};return(d,f)=>{const p=xn,g=Oi;return V(),Ie(g,{class:"widget-item-childs",center:""},{title:be(()=>{var m,v;return[ue("div",lZe,[ye(qc,ht({"label-extra":d.item.labelExtra},{...d.item},{label:d.item.label??""}),null,16,["label-extra","label"]),c.value?(V(),Ie(p,{key:0,class:"fl svg-tip f-s-20",name:"infomation",size:"20px",onClick:dr(u,["stop"])})):o(d.item)?(V(),Ie(ya,ht({key:1,handler:d.handler,value:d.values[(m=d.item.labelSuffix)==null?void 0:m.name]},{labelExtra:(v=d.item.labelSuffix)==null?void 0:v.labelExtra,...d.item.labelSuffix,...d.$attrs},{class:"right-item",disabled:s(d.item.disabled)}),null,16,["handler","value","disabled"])):$e("",!0)])]}),value:be(()=>{var m;return[ue("div",cZe,[a(d.item.visible)?(V(),Ie(ya,ht({key:0,handler:d.handler,value:d.values[d.item.name]},{labelExtra:d.item.labelExtra,...d.item,...d.$attrs},{class:"right-item",disabled:s(d.item.disabled)}),null,16,["handler","value","disabled"])):$e("",!0),(m=d.item.suffix)!=null&&m.widget?(V(),Ie(ya,ht({key:1,handler:d.handler},{labelExtra:d.item.suffix.labelExtra,...d.item.suffix,...d.$attrs}),null,16,["handler"])):$e("",!0)])]}),_:1})}}}),q5=dt(uZe,[["__scopeId","data-v-3023248d"]]),hZe={class:"custom-cell-title"},dZe={class:"right-content"},fZe={key:0,class:"auto-focus-tips"},pZe={class:"content"},gZe=Fe({__name:"WidgetButtonCell",props:{item:{},values:{},handler:{type:Function}},setup(n){Yt();const e=n,t=s=>{let o=!0;return mt(s)?o=s(e.values):o=s===!0,o},i=s=>{var o;return((o=s.labelSuffix)==null?void 0:o.widget)==="popover"},r=s=>{let o=!0;return mt(s)?o=s(e.values):o=s!==!1,o};return(s,o)=>{const a=Oi,l=xn;return V(),le(vt,null,[ye(a,{class:St(["widget-item-childs",s.item.itemClass]),center:"",border:!s.item.hideBorder},{title:be(()=>{var c,u;return[ue("div",hZe,[ye(qc,ht({"label-extra":s.item.labelExtra},{...s.item},{label:s.item.label??"","title-class":s.item.titleClass}),null,16,["label-extra","label","title-class"]),i(s.item)?(V(),Ie(ya,ht({key:0,handler:s.handler,value:s.values[(c=s.item.labelSuffix)==null?void 0:c.name]},{labelExtra:(u=s.item.labelSuffix)==null?void 0:u.labelExtra,...s.item.labelSuffix,...s.$attrs},{class:"right-item",disabled:t(s.item.disabled)}),null,16,["handler","value","disabled"])):$e("",!0)])]}),value:be(()=>{var c;return[ue("div",dZe,[r(s.item.visible)&&!s.item.tipVisible?(V(),Ie(ya,ht({key:0,handler:s.handler,value:s.values[s.item.name]},{labelExtra:s.item.labelExtra,...s.item,...s.$attrs},{class:"right-item",disabled:t(s.item.disabled)}),null,16,["handler","value","disabled"])):$e("",!0),(c=s.item.suffix)!=null&&c.widget?(V(),Ie(ya,ht({key:1,handler:s.handler},{labelExtra:s.item.suffix.labelExtra,...s.item.suffix,...s.$attrs}),null,16,["handler"])):$e("",!0)])]}),_:1},8,["border","class"]),s.item.tipVisible?(V(),le("div",fZe,[ye(l,{name:"msg_info",class:"msg-info-icon f-s-16"}),ue("div",null,[ue("span",pZe,Te(s.item.value),1)])])):$e("",!0)],64)}}}),mZe=dt(gZe,[["__scopeId","data-v-8e995e75"]]),vZe={key:0,class:"custom-cell-title"},_Ze={class:"right-content"},yZe=Fe({__name:"WidgetGroupCell",props:{item:{},values:{},handler:{type:Function}},setup(n){const e=n,{t}=Yt(),i=bt(),r=Hc(),s=h=>{let d=!0;return mt(h)?d=h(e.values):d=h===!0,d},o=h=>{var d;return((d=h.labelSuffix)==null?void 0:d.widget)==="popover"},a=te(()=>i.extId),l=te(()=>{var d,f;const h=e.item.label?(d=e.item.label)==null?void 0:d.split("."):"";return!!([nt.M1].includes(a.value)&&["distance"].includes(h[h.length-1])&&(r.currentMode===zt.LASER_CYLINDER||r.currentMode===zt.PASS_THROUGH)||["thickness","distance"].includes(h[h.length-1])&&[nt.P2].includes(a.value)&&(r.currentMode==="FREE_PLANE"||r.currentMode==="LASER_PLANE")||[nt.S1].includes(a.value)&&["popover"].includes((f=e.item.labelSuffix)==null?void 0:f.widget))}),c=h=>{let d="",f="",p="",g="",m=!0,v=!1,_=()=>{};switch(h){case nt.M1:d="device.common.distance",f="device.measure_guide.manual_measurement_auto",p="mobile.common.cancel",g="device.measure_guide.manual_measurement",m=!0,v=!0,_=()=>{try{u()}catch(y){console.log("==>gotoManual  error",y)}};break;case nt.P2:d="device.p2.hand_measure_with_hand_title",f="device.p2.hand_measure_with_hand_tips",p="mobile.common.cancel",g="ipad.dialog.got_it",m=!1,v=!1,_=()=>{};break;case nt.S1:d="device.common.distance",f="device.s1.hand_measure_with_hand_tip",p="mobile.common.cancel",g="ipad.dialog.got_it",m=!1,v=!1,_=()=>{};break}h==nt.P2?tt.modal.showRemindDialog({title:t(d),message:t(f),image:aZ,allowHtml:!0,defaultBtn:!1,confirmButtonText:t("ipad.dialog.got_it")}):tt.modal.showTipModal({title:t(d),content:t(f),hasClose:m,hasCancel:v,cancelTxt:t(p),confirmTxt:t(g),onCancel:()=>{},onConfirm:()=>{_()}})},u=async()=>{var d,f,p,g;if(!i.connected){tt.modal.showToast({msg:t("device.process.device_is_offline"),wordBreak:"break-word"});return}let h=!0;if(h=await((f=(d=i.ext)==null?void 0:d.apis)==null?void 0:f.laserHeadIsHoming()),!h||i.isInProcessing){tt.modal.showToast({msg:t("device.setting.setting_error_in_processing"),wordBreak:"break-word"});return}(g=(p=i.ext)==null?void 0:p.apis)==null||g.unLockedLeaserHead(),tt.modal.showManualDistanceModal()};return(h,d)=>{const f=xn,p=Oi;return V(),Ie(p,{class:"widget-item-childs",center:""},{title:be(()=>{var g,m,v;return[(g=h.item.childs)!=null&&g.length?(V(),le("div",vZe,[ye(qc,ht({"label-extra":h.item.labelExtra},{...h.item},{label:h.item.label??""}),null,16,["label-extra","label"]),l.value?(V(),Ie(f,{key:0,class:"fl svg-tip f-s-20",name:"infomation",size:"20px",onClick:d[0]||(d[0]=dr(_=>c(a.value),["stop"]))})):$e("",!0),o(h.item)?(V(),Ie(ya,ht({key:1,handler:h.handler,value:h.values[(m=h.item.labelSuffix)==null?void 0:m.name]},{labelExtra:(v=h.item.labelSuffix)==null?void 0:v.labelExtra,...h.item.labelSuffix,...h.$attrs},{disabled:s(h.item.disabled)}),null,16,["handler","value","disabled"])):$e("",!0)])):$e("",!0)]}),value:be(()=>[ue("div",_Ze,[(V(!0),le(vt,null,Fn(h.item.childs,g=>(V(),Ie(ya,ht({key:g.name,handler:h.handler,value:h.values[g.name]},{labelExtra:h.item.labelExtra,label:h.item.label,...g,...h.$attrs},{class:"right-item",data:g,disabled:s(g.disabled)}),null,16,["handler","value","data","disabled"]))),128))])]),_:1})}}}),AZe=dt(yZe,[["__scopeId","data-v-e5e125b4"]]),bZe=Fe({__name:"XFormItems",props:{items:{},values:{},handler:{type:Function}},setup(n){const e=n,t=s=>!["curve","multiPoint"].includes(s),i=s=>{let o=!0;return mt(s)?o=s(e.values):o=s!==!1,o},r=s=>{let o=!1;return mt(s)?o=s(e.values):o=s===!0,o};return(s,o)=>(V(!0),le(vt,null,Fn(s.items,a=>(V(),le(vt,{key:a.name},[a.widget==="unitInput"?(V(),Ie(q5,{key:0,item:a,handler:s.handler,values:s.values},null,8,["item","handler","values"])):a.widget==="button"||a.widget==="text"?(V(),Ie(mZe,{key:1,item:a,handler:s.handler,values:s.values},null,8,["item","handler","values"])):a.type==="group"&&a.direction==="column"?(V(!0),le(vt,{key:2},Fn(a.childs,l=>(V(),le(vt,{key:l.name},[l.widget==="unitInput"?(V(),Ie(q5,{key:0,item:l,handler:s.handler,values:s.values},null,8,["item","handler","values"])):i(l.visible)?(V(),Ie(ya,ht({key:1,handler:s.handler,value:s.values[l.name]},{...l,...s.$attrs},{data:l,disabled:r(l.disabled)}),null,16,["handler","value","data","disabled"])):$e("",!0)],64))),128)):i(a.visible)?(V(),Ie(ya,ht({key:3,value:s.values[a.name],handler:s.handler},{...a,...s.$attrs},{disabled:r(a.disabled)}),{default:be(()=>[t(a.name)&&a.childs&&a.childs.length>0?(V(),Ie(AZe,{key:0,item:a,handler:s.handler,values:s.values},null,8,["item","handler","values"])):$e("",!0)]),_:2},1040,["value","handler","disabled"])):$e("",!0)],64))),128))}}),wZe=dt(bZe,[["__scopeId","data-v-4a19f9e6"]]),Gv=Fe({__name:"XForm",props:{title:{},items:{},handler:{},values:{}},setup(n){return(e,t)=>(V(),le("section",ht({class:"x-form-mobile-wrap"},e.$attrs),[Fs(e.$slots,"default"),e.items?(V(),Ie(wZe,{key:0,items:e.items,values:e.values,handler:e.handler},null,8,["items","values","handler"])):$e("",!0)],16))}}),eh=(n,e)=>{if(tn(n)&&tn(e)){const t=10**(e??1);return Math.round(n*t)/t}return n};function Gd(n,e,t){const i=ee(n),r=ee(!1),s=async a=>{if(!r.value&&mt(e)){const l=gi(a)?i.value:a,c=e(l);if(c instanceof Promise){r.value=!0;try{await c}catch(u){console.error(u)}finally{r.value=!1}}}},o=n8(async a=>{await s(a)},t??300);return{update:s,running:r,valueRef:i,debouncedFn:o}}const xZe={key:0},CZe=Fe({__name:"WidgetButton",props:{label:{},title:{},icon:{},name:{},loading:{type:Boolean},noBorder:{type:Boolean},value:{type:[String,Boolean,Number]},popoverContent:{},handler:{type:Function}},setup(n){const e=n,{t}=Yt(),{valueRef:i,running:r,debouncedFn:s}=Gd(e.value,e.handler),o=te(()=>{var l;return(l=e.label)!=null&&l.includes("take_local_pic")?e.loading:e.loading||r.value}),a=async()=>{console.log("[点击事件]=>",e.name);try{e.label==="device.auto_focus.init"?await e.handler(e.name):await s()}catch(l){console.log(l)}finally{r.value=!1}};return yt(()=>e.value,(l,c)=>{l!==c&&(i.value=l)}),(l,c)=>{const u=Hi;return V(),Ie(u,ht({size:"small",plain:""},{...l.$attrs,onClick:void 0},{loading:o.value,class:["x-form-btn",{"no-border":l.noBorder,"only-icon":l.icon&&!l.label}],onClick:a}),Pr({default:be(()=>[l.label?(V(),le("span",xZe,Te(l.label&&l.label.includes(".")?Be(t)(l.label):l.label),1)):$e("",!0)]),_:2},[l.icon?{name:"icon",fn:be(()=>[ye(Nn,{name:l.icon,size:"16px",class:"f-s-16 svg-size-20"},null,8,["name"])]),key:"0"}:void 0]),1040,["loading","class"])}}}),EZe=dt(CZe,[["__scopeId","data-v-3f695e76"]]),TZe=Fe({__name:"WidgetButtonGroup",props:{gap:{},cols:{},useButtonType:{type:Boolean},value:{},debounceTime:{},options:{},handler:{type:Function}},emits:["update:value"],setup(n){const e=n,{valueRef:t,running:i,debouncedFn:r}=Gd(e.value,e.handler,e.debounceTime),s=o=>{t.value=o,r()};return(o,a)=>{const l=Hi;return V(),le("div",ht({style:{width:"100%"}},o.$attrs),[(V(!0),le(vt,null,Fn(o.options,c=>(V(),Ie(l,{key:c.value,disabled:Be(i),style:{flex:"1"},onClick:()=>s(c.value)},{default:be(()=>[Gt(Te(c.label.includes(".")?o.$t(c.label):c.label),1)]),_:2},1032,["disabled","onClick"]))),128))],16)}}});let bE=[];const lZ=new WeakMap;function IZe(){bE.forEach(n=>n(...lZ.get(n))),bE=[]}function cZ(n,...e){lZ.set(n,e),!bE.includes(n)&&bE.push(n)===1&&requestAnimationFrame(IZe)}function wE(n,e){let{target:t}=n;for(;t;){if(t.dataset&&t.dataset[e]!==void 0)return!0;t=t.parentElement}return!1}function QA(n){return n.composedPath()[0]||null}function XA(n){return typeof n=="string"?n.endsWith("px")?Number(n.slice(0,n.length-2)):Number(n):n}function px(n){if(n!=null)return typeof n=="number"?`${n}px`:n.endsWith("px")?n:`${n}px`}function Fm(n,e){const t=n.trim().split(/\s+/g),i={top:t[0]};switch(t.length){case 1:i.right=t[0],i.bottom=t[0],i.left=t[0];break;case 2:i.right=t[1],i.left=t[1],i.bottom=t[0];break;case 3:i.right=t[1],i.bottom=t[2],i.left=t[1];break;case 4:i.right=t[1],i.bottom=t[2],i.left=t[3];break;default:throw new Error("[seemly/getMargin]:"+n+" is not a valid value.")}return e===void 0?i:i[e]}function SZe(n,e){const[t,i]=n.split(" ");return e?e==="row"?t:i:{row:t,col:i||t}}const K5={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"},m_="^\\s*",v_="\\s*$",Lf="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",Nf="([0-9A-Fa-f])",Bf="([0-9A-Fa-f]{2})",PZe=new RegExp(`${m_}rgb\\s*\\(${Lf},${Lf},${Lf}\\)${v_}`),MZe=new RegExp(`${m_}rgba\\s*\\(${Lf},${Lf},${Lf},${Lf}\\)${v_}`),RZe=new RegExp(`${m_}#${Nf}${Nf}${Nf}${v_}`),DZe=new RegExp(`${m_}#${Bf}${Bf}${Bf}${v_}`),kZe=new RegExp(`${m_}#${Nf}${Nf}${Nf}${Nf}${v_}`),OZe=new RegExp(`${m_}#${Bf}${Bf}${Bf}${Bf}${v_}`);function wo(n){return parseInt(n,16)}function Zp(n){try{let e;if(e=DZe.exec(n))return[wo(e[1]),wo(e[2]),wo(e[3]),1];if(e=PZe.exec(n))return[eo(e[1]),eo(e[5]),eo(e[9]),1];if(e=MZe.exec(n))return[eo(e[1]),eo(e[5]),eo(e[9]),Wy(e[13])];if(e=RZe.exec(n))return[wo(e[1]+e[1]),wo(e[2]+e[2]),wo(e[3]+e[3]),1];if(e=OZe.exec(n))return[wo(e[1]),wo(e[2]),wo(e[3]),Wy(wo(e[4])/255)];if(e=kZe.exec(n))return[wo(e[1]+e[1]),wo(e[2]+e[2]),wo(e[3]+e[3]),Wy(wo(e[4]+e[4])/255)];if(n in K5)return Zp(K5[n]);throw new Error(`[seemly/rgba]: Invalid color value ${n}.`)}catch(e){throw e}}function LZe(n){return n>1?1:n<0?0:n}function Hk(n,e,t,i){return`rgba(${eo(n)}, ${eo(e)}, ${eo(t)}, ${LZe(i)})`}function xP(n,e,t,i,r){return eo((n*e*(1-i)+t*i)/r)}function NZe(n,e){Array.isArray(n)||(n=Zp(n)),Array.isArray(e)||(e=Zp(e));const t=n[3],i=e[3],r=Wy(t+i-t*i);return Hk(xP(n[0],t,e[0],i,r),xP(n[1],t,e[1],i,r),xP(n[2],t,e[2],i,r),r)}function Kn(n,e){const[t,i,r,s=1]=Array.isArray(n)?n:Zp(n);return e.alpha?Hk(t,i,r,e.alpha):Hk(t,i,r,s)}function gx(n,e){const[t,i,r,s=1]=Array.isArray(n)?n:Zp(n),{lightness:o=1,alpha:a=1}=e;return BZe([t*o,i*o,r*o,s*a])}function Wy(n){const e=Math.round(Number(n)*100)/100;return e>1?1:e<0?0:e}function eo(n){const e=Math.round(Number(n));return e>255?255:e<0?0:e}function BZe(n){const[e,t,i]=n;return 3 in n?`rgba(${eo(e)}, ${eo(t)}, ${eo(i)}, ${Wy(n[3])})`:`rgba(${eo(e)}, ${eo(t)}, ${eo(i)}, 1)`}function FZe(n=8){return Math.random().toString(16).slice(2,2+n)}function UZe(n,e="default",t=[]){const r=n.$slots[e];return r===void 0?t:r()}function GZe(n,e=[],t){const i={};return e.forEach(r=>{i[r]=n[r]}),Object.assign(i,t)}function xE(n,e=!0,t=[]){return n.forEach(i=>{if(i!==null){if(typeof i!="object"){(typeof i=="string"||typeof i=="number")&&t.push(Gt(String(i)));return}if(Array.isArray(i)){xE(i,e,t);return}if(i.type===vt){if(i.children===null)return;Array.isArray(i.children)&&xE(i.children,e,t)}else{if(i.type===gT&&e)return;t.push(i)}}}),t}function qs(n,...e){if(Array.isArray(n))n.forEach(t=>qs(t,...e));else return n(...e)}const Cm=(n,...e)=>typeof n=="function"?n(...e):typeof n=="string"?Gt(n):typeof n=="number"?Gt(String(n)):null;function J5(n,e){console.error(`[naive/${n}]: ${e}`)}function HZe(n,e){throw new Error(`[naive/${n}]: ${e}`)}function VZe(n){switch(typeof n){case"string":return n||void 0;case"number":return String(n);default:return}}function Z5(n,e="default",t=void 0){const i=n[e];if(!i)return J5("getFirstSlotVNode",`slot[${e}] is empty`),null;const r=xE(i(t));return r.length===1?r[0]:(J5("getFirstSlotVNode",`slot[${e}] should have exactly one child`),null)}function UI(n){return n.some(e=>r6(e)?!(e.type===gT||e.type===vt&&!UI(e.children)):!0)?n:null}function yN(n,e){return n&&UI(n())||e()}function Pp(n,e){const t=n&&UI(n());return e(t||null)}function e$(n){return!(n&&UI(n()))}function CP(n){const e=n.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?e[0]:t=>{n.forEach(i=>{i&&i(t)})}}const Vk=Fe({render(){var n,e;return(e=(n=this.$slots).default)===null||e===void 0?void 0:e.call(n)}}),zZe=/^(\d|\.)+$/,t$=/(\d|\.)+/;function EP(n,{c:e=1,offset:t=0,attachPx:i=!0}={}){if(typeof n=="number"){const r=(n+t)*e;return r===0?"0":`${r}px`}else if(typeof n=="string")if(zZe.test(n)){const r=(Number(n)+t)*e;return i?r===0?"0":`${r}px`:`${r}`}else{const r=t$.exec(n);return r?n.replace(t$,String((Number(r[0])+t)*e)):n}return n}function n$(n){return n.replace(/#|\(|\)|,|\s|\./g,"_")}function $Ze(n){let e=0;for(let t=0;t<n.length;++t)n[t]==="&"&&++e;return e}const uZ=/\s*,(?![^(]*\))\s*/g,WZe=/\s+/g;function jZe(n,e){const t=[];return e.split(uZ).forEach(i=>{let r=$Ze(i);if(r){if(r===1){n.forEach(o=>{t.push(i.replace("&",o))});return}}else{n.forEach(o=>{t.push((o&&o+" ")+i)});return}let s=[i];for(;r--;){const o=[];s.forEach(a=>{n.forEach(l=>{o.push(a.replace("&",l))})}),s=o}s.forEach(o=>t.push(o))}),t}function QZe(n,e){const t=[];return e.split(uZ).forEach(i=>{n.forEach(r=>{t.push((r&&r+" ")+i)})}),t}function XZe(n){let e=[""];return n.forEach(t=>{t=t&&t.trim(),t&&(t.includes("&")?e=jZe(e,t):e=QZe(e,t))}),e.join(", ").replace(WZe," ")}function i$(n){if(!n)return;const e=n.parentElement;e&&e.removeChild(n)}function GI(n){return document.querySelector(`style[cssr-id="${n}"]`)}function YZe(n){const e=document.createElement("style");return e.setAttribute("cssr-id",n),e}function mx(n){return n?/^\s*@(s|m)/.test(n):!1}const qZe=/[A-Z]/g;function hZ(n){return n.replace(qZe,e=>"-"+e.toLowerCase())}function KZe(n,e="  "){return typeof n=="object"&&n!==null?` {
`+Object.entries(n).map(t=>e+`  ${hZ(t[0])}: ${t[1]};`).join(`
`)+`
`+e+"}":`: ${n};`}function JZe(n,e,t){return typeof n=="function"?n({context:e.context,props:t}):n}function r$(n,e,t,i){if(!e)return"";const r=JZe(e,t,i);if(!r)return"";if(typeof r=="string")return`${n} {
${r}
}`;const s=Object.keys(r);if(s.length===0)return t.config.keepEmptyBlock?n+` {
}`:"";const o=n?[n+" {"]:[];return s.forEach(a=>{const l=r[a];if(a==="raw"){o.push(`
`+l+`
`);return}a=hZ(a),l!=null&&o.push(`  ${a}${KZe(l)}`)}),n&&o.push("}"),o.join(`
`)}function zk(n,e,t){n&&n.forEach(i=>{if(Array.isArray(i))zk(i,e,t);else if(typeof i=="function"){const r=i(e);Array.isArray(r)?zk(r,e,t):r&&t(r)}else i&&t(i)})}function dZ(n,e,t,i,r,s){const o=n.$;let a="";if(!o||typeof o=="string")mx(o)?a=o:e.push(o);else if(typeof o=="function"){const u=o({context:i.context,props:r});mx(u)?a=u:e.push(u)}else if(o.before&&o.before(i.context),!o.$||typeof o.$=="string")mx(o.$)?a=o.$:e.push(o.$);else if(o.$){const u=o.$({context:i.context,props:r});mx(u)?a=u:e.push(u)}const l=XZe(e),c=r$(l,n.props,i,r);a?(t.push(`${a} {`),s&&c&&s.insertRule(`${a} {
${c}
}
`)):(s&&c&&s.insertRule(c),!s&&c.length&&t.push(c)),n.children&&zk(n.children,{context:i.context,props:r},u=>{if(typeof u=="string"){const h=r$(l,{raw:u},i,r);s?s.insertRule(h):t.push(h)}else dZ(u,e,t,i,r,s)}),e.pop(),a&&t.push("}"),o&&o.after&&o.after(i.context)}function fZ(n,e,t,i=!1){const r=[];return dZ(n,[],r,e,t,i?n.instance.__styleSheet:void 0),i?"":r.join(`

`)}function $k(n){for(var e=0,t,i=0,r=n.length;r>=4;++i,r-=4)t=n.charCodeAt(i)&255|(n.charCodeAt(++i)&255)<<8|(n.charCodeAt(++i)&255)<<16|(n.charCodeAt(++i)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(r){case 3:e^=(n.charCodeAt(i+2)&255)<<16;case 2:e^=(n.charCodeAt(i+1)&255)<<8;case 1:e^=n.charCodeAt(i)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}typeof window<"u"&&(window.__cssrContext={});function ZZe(n,e,t){const{els:i}=e;if(t===void 0)i.forEach(i$),e.els=[];else{const r=GI(t);r&&i.includes(r)&&(i$(r),e.els=i.filter(s=>s!==r))}}function s$(n,e){n.push(e)}function eet(n,e,t,i,r,s,o,a,l){if(s&&!l){if(t===void 0){console.error("[css-render/mount]: `id` is required in `silent` mode.");return}const d=window.__cssrContext;d[t]||(d[t]=!0,fZ(e,n,i,s));return}let c;if(t===void 0&&(c=e.render(i),t=$k(c)),l){l.adapter(t,c??e.render(i));return}const u=GI(t);if(u!==null&&!o)return u;const h=u??YZe(t);if(c===void 0&&(c=e.render(i)),h.textContent=c,u!==null)return u;if(a){const d=document.head.querySelector(`meta[name="${a}"]`);if(d)return document.head.insertBefore(h,d),s$(e.els,h),h}return r?document.head.insertBefore(h,document.head.querySelector("style, link")):document.head.appendChild(h),s$(e.els,h),h}function tet(n){return fZ(this,this.instance,n)}function net(n={}){const{id:e,ssr:t,props:i,head:r=!1,silent:s=!1,force:o=!1,anchorMetaName:a}=n;return eet(this.instance,this,e,i,r,s,o,a,t)}function iet(n={}){const{id:e}=n;ZZe(this.instance,this,e)}const vx=function(n,e,t,i){return{instance:n,$:e,props:t,children:i,els:[],render:tet,mount:net,unmount:iet}},ret=function(n,e,t,i){return Array.isArray(e)?vx(n,{$:null},null,e):Array.isArray(t)?vx(n,e,null,t):Array.isArray(i)?vx(n,e,t,i):vx(n,e,t,null)};function pZ(n={}){let e=null;const t={c:(...i)=>ret(t,...i),use:(i,...r)=>i.install(t,...r),find:GI,context:{},config:n,get __styleSheet(){if(!e){const i=document.createElement("style");return document.head.appendChild(i),e=document.styleSheets[document.styleSheets.length-1],e}return e}};return t}function set(n,e){if(n===void 0)return!1;if(e){const{context:{ids:t}}=e;return t.has(n)}return GI(n)!==null}function oet(n){let e=".",t="__",i="--",r;if(n){let p=n.blockPrefix;p&&(e=p),p=n.elementPrefix,p&&(t=p),p=n.modifierPrefix,p&&(i=p)}const s={install(p){r=p.c;const g=p.context;g.bem={},g.bem.b=null,g.bem.els=null}};function o(p){let g,m;return{before(v){g=v.bem.b,m=v.bem.els,v.bem.els=null},after(v){v.bem.b=g,v.bem.els=m},$({context:v,props:_}){return p=typeof p=="string"?p:p({context:v,props:_}),v.bem.b=p,`${(_==null?void 0:_.bPrefix)||e}${v.bem.b}`}}}function a(p){let g;return{before(m){g=m.bem.els},after(m){m.bem.els=g},$({context:m,props:v}){return p=typeof p=="string"?p:p({context:m,props:v}),m.bem.els=p.split(",").map(_=>_.trim()),m.bem.els.map(_=>`${(v==null?void 0:v.bPrefix)||e}${m.bem.b}${t}${_}`).join(", ")}}}function l(p){return{$({context:g,props:m}){p=typeof p=="string"?p:p({context:g,props:m});const v=p.split(",").map(A=>A.trim());function _(A){return v.map(w=>`&${(m==null?void 0:m.bPrefix)||e}${g.bem.b}${A!==void 0?`${t}${A}`:""}${i}${w}`).join(", ")}const y=g.bem.els;return y!==null?_(y[0]):_()}}}function c(p){return{$({context:g,props:m}){p=typeof p=="string"?p:p({context:g,props:m});const v=g.bem.els;return`&:not(${(m==null?void 0:m.bPrefix)||e}${g.bem.b}${v!==null&&v.length>0?`${t}${v[0]}`:""}${i}${p})`}}}return Object.assign(s,{cB:(...p)=>r(o(p[0]),p[1],p[2]),cE:(...p)=>r(a(p[0]),p[1],p[2]),cM:(...p)=>r(l(p[0]),p[1],p[2]),cNotM:(...p)=>r(c(p[0]),p[1],p[2])}),s}const aet="n",cet=`.${aet}-`,uet="__",het="--",gZ=pZ(),mZ=oet({blockPrefix:cet,elementPrefix:uet,modifierPrefix:het});gZ.use(mZ);const{c:Ut,find:zpt}=gZ,{cB:nn,cE:ln,cM:Jn,cNotM:jl}=mZ,det=(...n)=>Ut(">",[nn(...n)]);function rr(n,e){return n+(e==="default"?"":e.replace(/^[a-z]/,t=>t.toUpperCase()))}let TP;function fet(){return TP===void 0&&(TP=navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),TP}const pet=typeof document<"u"&&typeof window<"u",get=new WeakSet;function met(n){get.add(n)}function vet(n){const e=ee(!!n.value);if(e.value)return kp(e);const t=yt(n,i=>{i&&(e.value=!0,t())});return kp(e)}function th(n){const e=te(n),t=ee(e.value);return yt(e,i=>{t.value=i}),typeof n=="function"?t:{__v_isRef:!0,get value(){return t.value},set value(i){n.set(i)}}}const _et=typeof window<"u";let Um,jy;const yet=()=>{var n,e;Um=_et?(e=(n=document)===null||n===void 0?void 0:n.fonts)===null||e===void 0?void 0:e.ready:void 0,jy=!1,Um!==void 0?Um.then(()=>{jy=!0}):jy=!0};yet();function Aet(n){if(jy)return;let e=!1;Zn(()=>{jy||Um==null||Um.then(()=>{e||n()})}),qo(()=>{e=!0})}function eC(n){return n.composedPath()[0]}const bet={mousemoveoutside:new WeakMap,clickoutside:new WeakMap};function wet(n,e,t){if(n==="mousemoveoutside"){const i=r=>{e.contains(eC(r))||t(r)};return{mousemove:i,touchstart:i}}else if(n==="clickoutside"){let i=!1;const r=o=>{i=!e.contains(eC(o))},s=o=>{i&&(e.contains(eC(o))||t(o))};return{mousedown:r,mouseup:s,touchstart:r,touchend:s}}return console.error(`[evtd/create-trap-handler]: name \`${n}\` is invalid. This could be a bug of evtd.`),{}}function vZ(n,e,t){const i=bet[n];let r=i.get(e);r===void 0&&i.set(e,r=new WeakMap);let s=r.get(t);return s===void 0&&r.set(t,s=wet(n,e,t)),s}function xet(n,e,t,i){if(n==="mousemoveoutside"||n==="clickoutside"){const r=vZ(n,e,t);return Object.keys(r).forEach(s=>{yo(s,document,r[s],i)}),!0}return!1}function Cet(n,e,t,i){if(n==="mousemoveoutside"||n==="clickoutside"){const r=vZ(n,e,t);return Object.keys(r).forEach(s=>{Yr(s,document,r[s],i)}),!0}return!1}function Eet(){if(typeof window>"u")return{on:()=>{},off:()=>{}};const n=new WeakMap,e=new WeakMap;function t(){n.set(this,!0)}function i(){n.set(this,!0),e.set(this,!0)}function r(C,I,x){const T=C[I];return C[I]=function(){return x.apply(C,arguments),T.apply(C,arguments)},C}function s(C,I){C[I]=Event.prototype[I]}const o=new WeakMap,a=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function l(){var C;return(C=o.get(this))!==null&&C!==void 0?C:null}function c(C,I){a!==void 0&&Object.defineProperty(C,"currentTarget",{configurable:!0,enumerable:!0,get:I??a.get})}const u={bubble:{},capture:{}},h={};function d(){const C=function(I){const{type:x,eventPhase:T,bubbles:O}=I,F=eC(I);if(T===2)return;const G=T===1?"capture":"bubble";let B=F;const R=[];for(;B===null&&(B=window),R.push(B),B!==window;)B=B.parentNode||null;const P=u.capture[x],k=u.bubble[x];if(r(I,"stopPropagation",t),r(I,"stopImmediatePropagation",i),c(I,l),G==="capture"){if(P===void 0)return;for(let L=R.length-1;L>=0&&!n.has(I);--L){const H=R[L],U=P.get(H);if(U!==void 0){o.set(I,H);for(const $ of U){if(e.has(I))break;$(I)}}if(L===0&&!O&&k!==void 0){const $=k.get(H);if($!==void 0)for(const j of $){if(e.has(I))break;j(I)}}}}else if(G==="bubble"){if(k===void 0)return;for(let L=0;L<R.length&&!n.has(I);++L){const H=R[L],U=k.get(H);if(U!==void 0){o.set(I,H);for(const $ of U){if(e.has(I))break;$(I)}}}}s(I,"stopPropagation"),s(I,"stopImmediatePropagation"),c(I)};return C.displayName="evtdUnifiedHandler",C}function f(){const C=function(I){const{type:x,eventPhase:T}=I;if(T!==2)return;const O=h[x];O!==void 0&&O.forEach(F=>F(I))};return C.displayName="evtdUnifiedWindowEventHandler",C}const p=d(),g=f();function m(C,I){const x=u[C];return x[I]===void 0&&(x[I]=new Map,window.addEventListener(I,p,C==="capture")),x[I]}function v(C){return h[C]===void 0&&(h[C]=new Set,window.addEventListener(C,g)),h[C]}function _(C,I){let x=C.get(I);return x===void 0&&C.set(I,x=new Set),x}function y(C,I,x,T){const O=u[I][x];if(O!==void 0){const F=O.get(C);if(F!==void 0&&F.has(T))return!0}return!1}function A(C,I){const x=h[C];return!!(x!==void 0&&x.has(I))}function w(C,I,x,T){let O;if(typeof T=="object"&&T.once===!0?O=P=>{b(C,I,O,T),x(P)}:O=x,xet(C,I,O,T))return;const G=T===!0||typeof T=="object"&&T.capture===!0?"capture":"bubble",B=m(G,C),R=_(B,I);if(R.has(O)||R.add(O),I===window){const P=v(C);P.has(O)||P.add(O)}}function b(C,I,x,T){if(Cet(C,I,x,T))return;const F=T===!0||typeof T=="object"&&T.capture===!0,G=F?"capture":"bubble",B=m(G,C),R=_(B,I);if(I===window&&!y(I,F?"bubble":"capture",C,x)&&A(C,x)){const k=h[C];k.delete(x),k.size===0&&(window.removeEventListener(C,g),h[C]=void 0)}R.has(x)&&R.delete(x),R.size===0&&B.delete(I),B.size===0&&(window.removeEventListener(C,p,G==="capture"),u[G][C]=void 0)}return{on:w,off:b}}const{on:yo,off:Yr}=Eet();function Wk(n,e){return yt(n,t=>{t!==void 0&&(e.value=t)}),te(()=>n.value===void 0?e.value:n.value)}function HI(){const n=ee(!1);return Zn(()=>{n.value=!0}),kp(n)}function _Z(n,e){return te(()=>{for(const t of e)if(n[t]!==void 0)return n[t];return n[e[e.length-1]]})}const Tet=(typeof window>"u"?!1:/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!window.MSStream;function Iet(){return Tet}const AN="n-internal-select-menu",yZ="n-internal-select-menu-body",AZ="n-modal-body",bZ="n-drawer-body",wZ="n-popover-body",xZ="__disabled__";function ah(n){const e=Er(AZ,null),t=Er(bZ,null),i=Er(wZ,null),r=Er(yZ,null),s=ee();if(typeof document<"u"){s.value=document.fullscreenElement;const o=()=>{s.value=document.fullscreenElement};Zn(()=>{yo("fullscreenchange",document,o)}),qo(()=>{Yr("fullscreenchange",document,o)})}return th(()=>{var o;const{to:a}=n;return a!==void 0?a===!1?xZ:a===!0?s.value||"body":a:e!=null&&e.value?(o=e.value.$el)!==null&&o!==void 0?o:e.value:t!=null&&t.value?t.value:i!=null&&i.value?i.value:r!=null&&r.value?r.value:a??(s.value||"body")})}ah.tdkey=xZ;ah.propTo={type:[String,Object,Boolean],default:void 0};function jk(n,e,t="default"){const i=e[t];if(i===void 0)throw new Error(`[vueuc/${n}]: slot[${t}] is empty.`);return i()}function Qk(n,e=!0,t=[]){return n.forEach(i=>{if(i!==null){if(typeof i!="object"){(typeof i=="string"||typeof i=="number")&&t.push(Gt(String(i)));return}if(Array.isArray(i)){Qk(i,e,t);return}if(i.type===vt){if(i.children===null)return;Array.isArray(i.children)&&Qk(i.children,e,t)}else i.type!==gT&&t.push(i)}}),t}function o$(n,e,t="default"){const i=e[t];if(i===void 0)throw new Error(`[vueuc/${n}]: slot[${t}] is empty.`);const r=Qk(i());if(r.length===1)return r[0];throw new Error(`[vueuc/${n}]: slot[${t}] should have exactly one child.`)}let Dh=null;function CZ(){if(Dh===null&&(Dh=document.getElementById("v-binder-view-measurer"),Dh===null)){Dh=document.createElement("div"),Dh.id="v-binder-view-measurer";const{style:n}=Dh;n.position="fixed",n.left="0",n.right="0",n.top="0",n.bottom="0",n.pointerEvents="none",n.visibility="hidden",document.body.appendChild(Dh)}return Dh.getBoundingClientRect()}function Pet(n,e){const t=CZ();return{top:e,left:n,height:0,width:0,right:t.width-n,bottom:t.height-e}}function IP(n){const e=n.getBoundingClientRect(),t=CZ();return{left:e.left-t.left,top:e.top-t.top,bottom:t.height+t.top-e.bottom,right:t.width+t.left-e.right,width:e.width,height:e.height}}function Met(n){return n.nodeType===9?null:n.parentNode}function EZ(n){if(n===null)return null;const e=Met(n);if(e===null)return null;if(e.nodeType===9)return document;if(e.nodeType===1){const{overflow:t,overflowX:i,overflowY:r}=getComputedStyle(e);if(/(auto|scroll|overlay)/.test(t+r+i))return e}return EZ(e)}const Ret=Fe({name:"Binder",props:{syncTargetWithParent:Boolean,syncTarget:{type:Boolean,default:!0}},setup(n){var e;ju("VBinder",(e=jv())===null||e===void 0?void 0:e.proxy);const t=Er("VBinder",null),i=ee(null),r=v=>{i.value=v,t&&n.syncTargetWithParent&&t.setTargetRef(v)};let s=[];const o=()=>{let v=i.value;for(;v=EZ(v),v!==null;)s.push(v);for(const _ of s)yo("scroll",_,h,!0)},a=()=>{for(const v of s)Yr("scroll",v,h,!0);s=[]},l=new Set,c=v=>{l.size===0&&o(),l.has(v)||l.add(v)},u=v=>{l.has(v)&&l.delete(v),l.size===0&&a()},h=()=>{cZ(d)},d=()=>{l.forEach(v=>v())},f=new Set,p=v=>{f.size===0&&yo("resize",window,m),f.has(v)||f.add(v)},g=v=>{f.has(v)&&f.delete(v),f.size===0&&Yr("resize",window,m)},m=()=>{f.forEach(v=>v())};return qo(()=>{Yr("resize",window,m),a()}),{targetRef:i,setTargetRef:r,addScrollListener:c,removeScrollListener:u,addResizeListener:p,removeResizeListener:g}},render(){return jk("binder",this.$slots)}}),TZ=Ret,IZ=Fe({name:"Target",setup(){const{setTargetRef:n,syncTarget:e}=Er("VBinder");return{syncTarget:e,setTargetDirective:{mounted:n,updated:n}}},render(){const{syncTarget:n,setTargetDirective:e}=this;return n?tg(o$("follower",this.$slots),[[e]]):o$("follower",this.$slots)}}),nm="@@mmoContext",Det={mounted(n,{value:e}){n[nm]={handler:void 0},typeof e=="function"&&(n[nm].handler=e,yo("mousemoveoutside",n,e))},updated(n,{value:e}){const t=n[nm];typeof e=="function"?t.handler?t.handler!==e&&(Yr("mousemoveoutside",n,t.handler),t.handler=e,yo("mousemoveoutside",n,e)):(n[nm].handler=e,yo("mousemoveoutside",n,e)):t.handler&&(Yr("mousemoveoutside",n,t.handler),t.handler=void 0)},unmounted(n){const{handler:e}=n[nm];e&&Yr("mousemoveoutside",n,e),n[nm].handler=void 0}},ket=Det,im="@@coContext",Oet={mounted(n,{value:e,modifiers:t}){n[im]={handler:void 0},typeof e=="function"&&(n[im].handler=e,yo("clickoutside",n,e,{capture:t.capture}))},updated(n,{value:e,modifiers:t}){const i=n[im];typeof e=="function"?i.handler?i.handler!==e&&(Yr("clickoutside",n,i.handler,{capture:t.capture}),i.handler=e,yo("clickoutside",n,e,{capture:t.capture})):(n[im].handler=e,yo("clickoutside",n,e,{capture:t.capture})):i.handler&&(Yr("clickoutside",n,i.handler,{capture:t.capture}),i.handler=void 0)},unmounted(n,{modifiers:e}){const{handler:t}=n[im];t&&Yr("clickoutside",n,t,{capture:e.capture}),n[im].handler=void 0}},CE=Oet;function Let(n,e){console.error(`[vdirs/${n}]: ${e}`)}class Net{constructor(){this.elementZIndex=new Map,this.nextZIndex=2e3}get elementCount(){return this.elementZIndex.size}ensureZIndex(e,t){const{elementZIndex:i}=this;if(t!==void 0){e.style.zIndex=`${t}`,i.delete(e);return}const{nextZIndex:r}=this;i.has(e)&&i.get(e)+1===this.nextZIndex||(e.style.zIndex=`${r}`,i.set(e,r),this.nextZIndex=r+1,this.squashState())}unregister(e,t){const{elementZIndex:i}=this;i.has(e)?i.delete(e):t===void 0&&Let("z-index-manager/unregister-element","Element not found when unregistering."),this.squashState()}squashState(){const{elementCount:e}=this;e||(this.nextZIndex=2e3),this.nextZIndex-e>2500&&this.rearrange()}rearrange(){const e=Array.from(this.elementZIndex.entries());e.sort((t,i)=>t[1]-i[1]),this.nextZIndex=2e3,e.forEach(t=>{const i=t[0],r=this.nextZIndex++;`${r}`!==i.style.zIndex&&(i.style.zIndex=`${r}`)})}}const SP=new Net,rm="@@ziContext",Bet={mounted(n,e){const{value:t={}}=e,{zIndex:i,enabled:r}=t;n[rm]={enabled:!!r,initialized:!1},r&&(SP.ensureZIndex(n,i),n[rm].initialized=!0)},updated(n,e){const{value:t={}}=e,{zIndex:i,enabled:r}=t,s=n[rm].enabled;r&&!s&&(SP.ensureZIndex(n,i),n[rm].initialized=!0),n[rm].enabled=!!r},unmounted(n,e){if(!n[rm].initialized)return;const{value:t={}}=e,{zIndex:i}=t;SP.unregister(n,i)}},SZ=Bet,PZ=Symbol("@css-render/vue3-ssr");function Fet(n,e){return`<style cssr-id="${n}">
${e}
</style>`}function Uet(n,e){const t=Er(PZ,null);if(t===null){console.error("[css-render/vue3-ssr]: no ssr context found.");return}const{styles:i,ids:r}=t;r.has(n)||i!==null&&(r.add(n),i.push(Fet(n,e)))}const Get=typeof document<"u";function _g(){if(Get)return;const n=Er(PZ,null);if(n!==null)return{adapter:Uet,context:n}}function a$(n,e){console.error(`[vueuc/${n}]: ${e}`)}const{c:hd}=pZ(),bN="vueuc-style";function l$(n){return n&-n}class Het{constructor(e,t){this.l=e,this.min=t;const i=new Array(e+1);for(let r=0;r<e+1;++r)i[r]=0;this.ft=i}add(e,t){if(t===0)return;const{l:i,ft:r}=this;for(e+=1;e<=i;)r[e]+=t,e+=l$(e)}get(e){return this.sum(e+1)-this.sum(e)}sum(e){if(e===void 0&&(e=this.l),e<=0)return 0;const{ft:t,min:i,l:r}=this;if(e>r)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let s=e*i;for(;e>0;)s+=t[e],e-=l$(e);return s}getBound(e){let t=0,i=this.l;for(;i>t;){const r=Math.floor((t+i)/2),s=this.sum(r);if(s>e){i=r;continue}else if(s<e){if(t===r)return this.sum(t+1)<=e?t+1:r;t=r}else return r}return t}}function c$(n){return typeof n=="string"?document.querySelector(n):n()}const Vet=Fe({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(n){return{showTeleport:vet(ri(n,"show")),mergedTo:te(()=>{const{to:e}=n;return e??"body"})}},render(){return this.showTeleport?this.disabled?jk("lazy-teleport",this.$slots):Ue(Wee,{disabled:this.disabled,to:this.mergedTo},jk("lazy-teleport",this.$slots)):null}}),_x={top:"bottom",bottom:"top",left:"right",right:"left"},u$={start:"end",center:"center",end:"start"},PP={top:"height",bottom:"height",left:"width",right:"width"},zet={"bottom-start":"top left",bottom:"top center","bottom-end":"top right","top-start":"bottom left",top:"bottom center","top-end":"bottom right","right-start":"top left",right:"center left","right-end":"bottom left","left-start":"top right",left:"center right","left-end":"bottom right"},$et={"bottom-start":"bottom left",bottom:"bottom center","bottom-end":"bottom right","top-start":"top left",top:"top center","top-end":"top right","right-start":"top right",right:"center right","right-end":"bottom right","left-start":"top left",left:"center left","left-end":"bottom left"},Wet={"bottom-start":"right","bottom-end":"left","top-start":"right","top-end":"left","right-start":"bottom","right-end":"top","left-start":"bottom","left-end":"top"},h$={top:!0,bottom:!1,left:!0,right:!1},d$={top:"end",bottom:"start",left:"end",right:"start"};function jet(n,e,t,i,r,s){if(!r||s)return{placement:n,top:0,left:0};const[o,a]=n.split("-");let l=a??"center",c={top:0,left:0};const u=(f,p,g)=>{let m=0,v=0;const _=t[f]-e[p]-e[f];return _>0&&i&&(g?v=h$[p]?_:-_:m=h$[p]?_:-_),{left:m,top:v}},h=o==="left"||o==="right";if(l!=="center"){const f=Wet[n],p=_x[f],g=PP[f];if(t[g]>e[g]){if(e[f]+e[g]<t[g]){const m=(t[g]-e[g])/2;e[f]<m||e[p]<m?e[f]<e[p]?(l=u$[a],c=u(g,p,h)):c=u(g,f,h):l="center"}}else t[g]<e[g]&&e[p]<0&&e[f]>e[p]&&(l=u$[a])}else{const f=o==="bottom"||o==="top"?"left":"top",p=_x[f],g=PP[f],m=(t[g]-e[g])/2;(e[f]<m||e[p]<m)&&(e[f]>e[p]?(l=d$[f],c=u(g,f,h)):(l=d$[p],c=u(g,p,h)))}let d=o;return e[o]<t[PP[o]]&&e[o]<e[_x[o]]&&(d=_x[o]),{placement:l!=="center"?`${d}-${l}`:d,left:c.left,top:c.top}}function Qet(n,e){return e?$et[n]:zet[n]}function Xet(n,e,t,i,r,s){if(s)switch(n){case"bottom-start":return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left)}px`,transform:"translateY(-100%)"};case"bottom-end":return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top-start":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left)}px`,transform:""};case"top-end":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%)"};case"right-start":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%)"};case"right-end":return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"left-start":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left)}px`,transform:""};case"left-end":return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left)}px`,transform:"translateY(-100%)"};case"top":return{top:`${Math.round(t.top-e.top)}px`,left:`${Math.round(t.left-e.left+t.width/2)}px`,transform:"translateX(-50%)"};case"right":return{top:`${Math.round(t.top-e.top+t.height/2)}px`,left:`${Math.round(t.left-e.left+t.width)}px`,transform:"translateX(-100%) translateY(-50%)"};case"left":return{top:`${Math.round(t.top-e.top+t.height/2)}px`,left:`${Math.round(t.left-e.left)}px`,transform:"translateY(-50%)"};case"bottom":default:return{top:`${Math.round(t.top-e.top+t.height)}px`,left:`${Math.round(t.left-e.left+t.width/2)}px`,transform:"translateX(-50%) translateY(-100%)"}}switch(n){case"bottom-start":return{top:`${Math.round(t.top-e.top+t.height+i)}px`,left:`${Math.round(t.left-e.left+r)}px`,transform:""};case"bottom-end":return{top:`${Math.round(t.top-e.top+t.height+i)}px`,left:`${Math.round(t.left-e.left+t.width+r)}px`,transform:"translateX(-100%)"};case"top-start":return{top:`${Math.round(t.top-e.top+i)}px`,left:`${Math.round(t.left-e.left+r)}px`,transform:"translateY(-100%)"};case"top-end":return{top:`${Math.round(t.top-e.top+i)}px`,left:`${Math.round(t.left-e.left+t.width+r)}px`,transform:"translateX(-100%) translateY(-100%)"};case"right-start":return{top:`${Math.round(t.top-e.top+i)}px`,left:`${Math.round(t.left-e.left+t.width+r)}px`,transform:""};case"right-end":return{top:`${Math.round(t.top-e.top+t.height+i)}px`,left:`${Math.round(t.left-e.left+t.width+r)}px`,transform:"translateY(-100%)"};case"left-start":return{top:`${Math.round(t.top-e.top+i)}px`,left:`${Math.round(t.left-e.left+r)}px`,transform:"translateX(-100%)"};case"left-end":return{top:`${Math.round(t.top-e.top+t.height+i)}px`,left:`${Math.round(t.left-e.left+r)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top":return{top:`${Math.round(t.top-e.top+i)}px`,left:`${Math.round(t.left-e.left+t.width/2+r)}px`,transform:"translateY(-100%) translateX(-50%)"};case"right":return{top:`${Math.round(t.top-e.top+t.height/2+i)}px`,left:`${Math.round(t.left-e.left+t.width+r)}px`,transform:"translateY(-50%)"};case"left":return{top:`${Math.round(t.top-e.top+t.height/2+i)}px`,left:`${Math.round(t.left-e.left+r)}px`,transform:"translateY(-50%) translateX(-100%)"};case"bottom":default:return{top:`${Math.round(t.top-e.top+t.height+i)}px`,left:`${Math.round(t.left-e.left+t.width/2+r)}px`,transform:"translateX(-50%)"}}}const Yet=hd([hd(".v-binder-follower-container",{position:"absolute",left:"0",right:"0",top:"0",height:"0",pointerEvents:"none",zIndex:"auto"}),hd(".v-binder-follower-content",{position:"absolute",zIndex:"auto"},[hd("> *",{pointerEvents:"all"})])]),MZ=Fe({name:"Follower",inheritAttrs:!1,props:{show:Boolean,enabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom"},syncTrigger:{type:Array,default:["resize","scroll"]},to:[String,Object],flip:{type:Boolean,default:!0},internalShift:Boolean,x:Number,y:Number,width:String,minWidth:String,containerClass:String,teleportDisabled:Boolean,zindexable:{type:Boolean,default:!0},zIndex:Number,overlap:Boolean},setup(n){const e=Er("VBinder"),t=th(()=>n.enabled!==void 0?n.enabled:n.show),i=ee(null),r=ee(null),s=()=>{const{syncTrigger:d}=n;d.includes("scroll")&&e.addScrollListener(l),d.includes("resize")&&e.addResizeListener(l)},o=()=>{e.removeScrollListener(l),e.removeResizeListener(l)};Zn(()=>{t.value&&(l(),s())});const a=_g();Yet.mount({id:"vueuc/binder",head:!0,anchorMetaName:bN,ssr:a}),qo(()=>{o()}),Aet(()=>{t.value&&l()});const l=()=>{if(!t.value)return;const d=i.value;if(d===null)return;const f=e.targetRef,{x:p,y:g,overlap:m}=n,v=p!==void 0&&g!==void 0?Pet(p,g):IP(f);d.style.setProperty("--v-target-width",`${Math.round(v.width)}px`),d.style.setProperty("--v-target-height",`${Math.round(v.height)}px`);const{width:_,minWidth:y,placement:A,internalShift:w,flip:b}=n;d.setAttribute("v-placement",A),m?d.setAttribute("v-overlap",""):d.removeAttribute("v-overlap");const{style:C}=d;_==="target"?C.width=`${v.width}px`:_!==void 0?C.width=_:C.width="",y==="target"?C.minWidth=`${v.width}px`:y!==void 0?C.minWidth=y:C.minWidth="";const I=IP(d),x=IP(r.value),{left:T,top:O,placement:F}=jet(A,v,I,w,b,m),G=Qet(F,m),{left:B,top:R,transform:P}=Xet(F,x,v,O,T,m);d.setAttribute("v-placement",F),d.style.setProperty("--v-offset-left",`${Math.round(T)}px`),d.style.setProperty("--v-offset-top",`${Math.round(O)}px`),d.style.transform=`translateX(${B}) translateY(${R}) ${P}`,d.style.setProperty("--v-transform-origin",G),d.style.transformOrigin=G};yt(t,d=>{d?(s(),c()):o()});const c=()=>{Yi().then(l).catch(d=>console.error(d))};["placement","x","y","internalShift","flip","width","overlap","minWidth"].forEach(d=>{yt(ri(n,d),l)}),["teleportDisabled"].forEach(d=>{yt(ri(n,d),c)}),yt(ri(n,"syncTrigger"),d=>{d.includes("resize")?e.addResizeListener(l):e.removeResizeListener(l),d.includes("scroll")?e.addScrollListener(l):e.removeScrollListener(l)});const u=HI(),h=th(()=>{const{to:d}=n;if(d!==void 0)return d;u.value});return{VBinder:e,mergedEnabled:t,offsetContainerRef:r,followerRef:i,mergedTo:h,syncPosition:l}},render(){return Ue(Vet,{show:this.show,to:this.mergedTo,disabled:this.teleportDisabled},{default:()=>{var n,e;const t=Ue("div",{class:["v-binder-follower-container",this.containerClass],ref:"offsetContainerRef"},[Ue("div",{class:"v-binder-follower-content",ref:"followerRef"},(e=(n=this.$slots).default)===null||e===void 0?void 0:e.call(n))]);return this.zindexable?tg(t,[[SZ,{enabled:this.mergedEnabled,zIndex:this.zIndex}]]):t}})}});var Mp=[],qet=function(){return Mp.some(function(n){return n.activeTargets.length>0})},Ket=function(){return Mp.some(function(n){return n.skippedTargets.length>0})},f$="ResizeObserver loop completed with undelivered notifications.",Jet=function(){var n;typeof ErrorEvent=="function"?n=new ErrorEvent("error",{message:f$}):(n=document.createEvent("Event"),n.initEvent("error",!1,!1),n.message=f$),window.dispatchEvent(n)},YA;(function(n){n.BORDER_BOX="border-box",n.CONTENT_BOX="content-box",n.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(YA||(YA={}));var Rp=function(n){return Object.freeze(n)},Zet=function(){function n(e,t){this.inlineSize=e,this.blockSize=t,Rp(this)}return n}(),RZ=function(){function n(e,t,i,r){return this.x=e,this.y=t,this.width=i,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Rp(this)}return n.prototype.toJSON=function(){var e=this,t=e.x,i=e.y,r=e.top,s=e.right,o=e.bottom,a=e.left,l=e.width,c=e.height;return{x:t,y:i,top:r,right:s,bottom:o,left:a,width:l,height:c}},n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n}(),wN=function(n){return n instanceof SVGElement&&"getBBox"in n},DZ=function(n){if(wN(n)){var e=n.getBBox(),t=e.width,i=e.height;return!t&&!i}var r=n,s=r.offsetWidth,o=r.offsetHeight;return!(s||o||n.getClientRects().length)},p$=function(n){var e;if(n instanceof Element)return!0;var t=(e=n==null?void 0:n.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(t&&n instanceof t.Element)},ett=function(n){switch(n.tagName){case"INPUT":if(n.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},Qy=typeof window<"u"?window:{},yx=new WeakMap,g$=/auto|scroll/,ttt=/^tb|vertical/,ntt=/msie|trident/i.test(Qy.navigator&&Qy.navigator.userAgent),fc=function(n){return parseFloat(n||"0")},Gm=function(n,e,t){return n===void 0&&(n=0),e===void 0&&(e=0),t===void 0&&(t=!1),new Zet((t?e:n)||0,(t?n:e)||0)},m$=Rp({devicePixelContentBoxSize:Gm(),borderBoxSize:Gm(),contentBoxSize:Gm(),contentRect:new RZ(0,0,0,0)}),kZ=function(n,e){if(e===void 0&&(e=!1),yx.has(n)&&!e)return yx.get(n);if(DZ(n))return yx.set(n,m$),m$;var t=getComputedStyle(n),i=wN(n)&&n.ownerSVGElement&&n.getBBox(),r=!ntt&&t.boxSizing==="border-box",s=ttt.test(t.writingMode||""),o=!i&&g$.test(t.overflowY||""),a=!i&&g$.test(t.overflowX||""),l=i?0:fc(t.paddingTop),c=i?0:fc(t.paddingRight),u=i?0:fc(t.paddingBottom),h=i?0:fc(t.paddingLeft),d=i?0:fc(t.borderTopWidth),f=i?0:fc(t.borderRightWidth),p=i?0:fc(t.borderBottomWidth),g=i?0:fc(t.borderLeftWidth),m=h+c,v=l+u,_=g+f,y=d+p,A=a?n.offsetHeight-y-n.clientHeight:0,w=o?n.offsetWidth-_-n.clientWidth:0,b=r?m+_:0,C=r?v+y:0,I=i?i.width:fc(t.width)-b-w,x=i?i.height:fc(t.height)-C-A,T=I+m+w+_,O=x+v+A+y,F=Rp({devicePixelContentBoxSize:Gm(Math.round(I*devicePixelRatio),Math.round(x*devicePixelRatio),s),borderBoxSize:Gm(T,O,s),contentBoxSize:Gm(I,x,s),contentRect:new RZ(h,l,I,x)});return yx.set(n,F),F},OZ=function(n,e,t){var i=kZ(n,t),r=i.borderBoxSize,s=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(e){case YA.DEVICE_PIXEL_CONTENT_BOX:return o;case YA.BORDER_BOX:return r;default:return s}},itt=function(){function n(e){var t=kZ(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=Rp([t.borderBoxSize]),this.contentBoxSize=Rp([t.contentBoxSize]),this.devicePixelContentBoxSize=Rp([t.devicePixelContentBoxSize])}return n}(),LZ=function(n){if(DZ(n))return 1/0;for(var e=0,t=n.parentNode;t;)e+=1,t=t.parentNode;return e},rtt=function(){var n=1/0,e=[];Mp.forEach(function(o){if(o.activeTargets.length!==0){var a=[];o.activeTargets.forEach(function(c){var u=new itt(c.target),h=LZ(c.target);a.push(u),c.lastReportedSize=OZ(c.target,c.observedBox),h<n&&(n=h)}),e.push(function(){o.callback.call(o.observer,a,o.observer)}),o.activeTargets.splice(0,o.activeTargets.length)}});for(var t=0,i=e;t<i.length;t++){var r=i[t];r()}return n},v$=function(n){Mp.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(r){r.isActive()&&(LZ(r.target)>n?t.activeTargets.push(r):t.skippedTargets.push(r))})})},stt=function(){var n=0;for(v$(n);qet();)n=rtt(),v$(n);return Ket()&&Jet(),n>0},MP,NZ=[],ott=function(){return NZ.splice(0).forEach(function(n){return n()})},att=function(n){if(!MP){var e=0,t=document.createTextNode(""),i={characterData:!0};new MutationObserver(function(){return ott()}).observe(t,i),MP=function(){t.textContent="".concat(e?e--:e++)}}NZ.push(n),MP()},ltt=function(n){att(function(){requestAnimationFrame(n)})},tC=0,ctt=function(){return!!tC},utt=250,htt={attributes:!0,characterData:!0,childList:!0,subtree:!0},_$=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],y$=function(n){return n===void 0&&(n=0),Date.now()+n},RP=!1,dtt=function(){function n(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return n.prototype.run=function(e){var t=this;if(e===void 0&&(e=utt),!RP){RP=!0;var i=y$(e);ltt(function(){var r=!1;try{r=stt()}finally{if(RP=!1,e=i-y$(),!ctt())return;r?t.run(1e3):e>0?t.run(e):t.start()}})}},n.prototype.schedule=function(){this.stop(),this.run()},n.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,htt)};document.body?t():Qy.addEventListener("DOMContentLoaded",t)},n.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),_$.forEach(function(t){return Qy.addEventListener(t,e.listener,!0)}))},n.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),_$.forEach(function(t){return Qy.removeEventListener(t,e.listener,!0)}),this.stopped=!0)},n}(),Xk=new dtt,A$=function(n){!tC&&n>0&&Xk.start(),tC+=n,!tC&&Xk.stop()},ftt=function(n){return!wN(n)&&!ett(n)&&getComputedStyle(n).display==="inline"},ptt=function(){function n(e,t){this.target=e,this.observedBox=t||YA.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return n.prototype.isActive=function(){var e=OZ(this.target,this.observedBox,!0);return ftt(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},n}(),gtt=function(){function n(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t}return n}(),Ax=new WeakMap,b$=function(n,e){for(var t=0;t<n.length;t+=1)if(n[t].target===e)return t;return-1},bx=function(){function n(){}return n.connect=function(e,t){var i=new gtt(e,t);Ax.set(e,i)},n.observe=function(e,t,i){var r=Ax.get(e),s=r.observationTargets.length===0;b$(r.observationTargets,t)<0&&(s&&Mp.push(r),r.observationTargets.push(new ptt(t,i&&i.box)),A$(1),Xk.schedule())},n.unobserve=function(e,t){var i=Ax.get(e),r=b$(i.observationTargets,t),s=i.observationTargets.length===1;r>=0&&(s&&Mp.splice(Mp.indexOf(i),1),i.observationTargets.splice(r,1),A$(-1))},n.disconnect=function(e){var t=this,i=Ax.get(e);i.observationTargets.slice().forEach(function(r){return t.unobserve(e,r.target)}),i.activeTargets.splice(0,i.activeTargets.length)},n}(),mtt=function(){function n(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");bx.connect(this,e)}return n.prototype.observe=function(e,t){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!p$(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");bx.observe(this,e,t)},n.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!p$(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");bx.unobserve(this,e)},n.prototype.disconnect=function(){bx.disconnect(this)},n.toString=function(){return"function ResizeObserver () { [polyfill code] }"},n}();class vtt{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new(typeof window<"u"&&window.ResizeObserver||mtt)(this.handleResize),this.elHandlersMap=new Map}handleResize(e){for(const t of e){const i=this.elHandlersMap.get(t.target);i!==void 0&&i(t)}}registerHandler(e,t){this.elHandlersMap.set(e,t),this.observer.observe(e)}unregisterHandler(e){this.elHandlersMap.has(e)&&(this.elHandlersMap.delete(e),this.observer.unobserve(e))}}const EE=new vtt,TE=Fe({name:"ResizeObserver",props:{onResize:Function},setup(n){let e=!1;const t=jv().proxy;function i(r){const{onResize:s}=n;s!==void 0&&s(r)}Zn(()=>{const r=t.$el;if(r===void 0){a$("resize-observer","$el does not exist.");return}if(r.nextElementSibling!==r.nextSibling&&r.nodeType===3&&r.nodeValue!==""){a$("resize-observer","$el can not be observed (it may be a text node).");return}r.nextElementSibling!==null&&(EE.registerHandler(r.nextElementSibling,i),e=!0)}),qo(()=>{e&&EE.unregisterHandler(t.$el.nextElementSibling)})},render(){return Fs(this.$slots,"default")}});let wx;function _tt(){return typeof document>"u"?!1:(wx===void 0&&("matchMedia"in window?wx=window.matchMedia("(pointer:coarse)").matches:wx=!1),wx)}let DP;function w$(){return typeof document>"u"?1:(DP===void 0&&(DP="chrome"in window?window.devicePixelRatio:1),DP)}const ytt=hd(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[hd("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[hd("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),Att=Fe({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(n){const e=_g();ytt.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:bN,ssr:e}),Zn(()=>{const{defaultScrollIndex:O,defaultScrollKey:F}=n;O!=null?p({index:O}):F!=null&&p({key:F})});let t=!1,i=!1;a6(()=>{if(t=!1,!i){i=!0;return}p({top:h.value,left:u})}),l6(()=>{t=!0,i||(i=!0)});const r=te(()=>{const O=new Map,{keyField:F}=n;return n.items.forEach((G,B)=>{O.set(G[F],B)}),O}),s=ee(null),o=ee(void 0),a=new Map,l=te(()=>{const{items:O,itemSize:F,keyField:G}=n,B=new Het(O.length,F);return O.forEach((R,P)=>{const k=R[G],L=a.get(k);L!==void 0&&B.add(P,L)}),B}),c=ee(0);let u=0;const h=ee(0),d=th(()=>Math.max(l.value.getBound(h.value-XA(n.paddingTop))-1,0)),f=te(()=>{const{value:O}=o;if(O===void 0)return[];const{items:F,itemSize:G}=n,B=d.value,R=Math.min(B+Math.ceil(O/G+1),F.length-1),P=[];for(let k=B;k<=R;++k)P.push(F[k]);return P}),p=(O,F)=>{if(typeof O=="number"){_(O,F,"auto");return}const{left:G,top:B,index:R,key:P,position:k,behavior:L,debounce:H=!0}=O;if(G!==void 0||B!==void 0)_(G,B,L);else if(R!==void 0)v(R,L,H);else if(P!==void 0){const U=r.value.get(P);U!==void 0&&v(U,L,H)}else k==="bottom"?_(0,Number.MAX_SAFE_INTEGER,L):k==="top"&&_(0,0,L)};let g,m=null;function v(O,F,G){const{value:B}=l,R=B.sum(O)+XA(n.paddingTop);if(!G)s.value.scrollTo({left:0,top:R,behavior:F});else{g=O,m!==null&&window.clearTimeout(m),m=window.setTimeout(()=>{g=void 0,m=null},16);const{scrollTop:P,offsetHeight:k}=s.value;if(R>P){const L=B.get(O);R+L<=P+k||s.value.scrollTo({left:0,top:R+L-k,behavior:F})}else s.value.scrollTo({left:0,top:R,behavior:F})}}function _(O,F,G){s.value.scrollTo({left:O,top:F,behavior:G})}function y(O,F){var G,B,R;if(t||n.ignoreItemResize||T(F.target))return;const{value:P}=l,k=r.value.get(O),L=P.get(k),H=(R=(B=(G=F.borderBoxSize)===null||G===void 0?void 0:G[0])===null||B===void 0?void 0:B.blockSize)!==null&&R!==void 0?R:F.contentRect.height;if(H===L)return;H-n.itemSize===0?a.delete(O):a.set(O,H-n.itemSize);const $=H-L;if($===0)return;P.add(k,$);const j=s.value;if(j!=null){if(g===void 0){const Q=P.sum(k);j.scrollTop>Q&&j.scrollBy(0,$)}else if(k<g)j.scrollBy(0,$);else if(k===g){const Q=P.sum(k);H+Q>j.scrollTop+j.offsetHeight&&j.scrollBy(0,$)}x()}c.value++}const A=!_tt();let w=!1;function b(O){var F;(F=n.onScroll)===null||F===void 0||F.call(n,O),(!A||!w)&&x()}function C(O){var F;if((F=n.onWheel)===null||F===void 0||F.call(n,O),A){const G=s.value;if(G!=null){if(O.deltaX===0&&(G.scrollTop===0&&O.deltaY<=0||G.scrollTop+G.offsetHeight>=G.scrollHeight&&O.deltaY>=0))return;O.preventDefault(),G.scrollTop+=O.deltaY/w$(),G.scrollLeft+=O.deltaX/w$(),x(),w=!0,cZ(()=>{w=!1})}}}function I(O){if(t||T(O.target)||O.contentRect.height===o.value)return;o.value=O.contentRect.height;const{onResize:F}=n;F!==void 0&&F(O)}function x(){const{value:O}=s;O!=null&&(h.value=O.scrollTop,u=O.scrollLeft)}function T(O){let F=O;for(;F!==null;){if(F.style.display==="none")return!0;F=F.parentElement}return!1}return{listHeight:o,listStyle:{overflow:"auto"},keyToIndex:r,itemsStyle:te(()=>{const{itemResizable:O}=n,F=px(l.value.sum());return c.value,[n.itemsStyle,{boxSizing:"content-box",height:O?"":F,minHeight:O?F:"",paddingTop:px(n.paddingTop),paddingBottom:px(n.paddingBottom)}]}),visibleItemsStyle:te(()=>(c.value,{transform:`translateY(${px(l.value.sum(d.value))})`})),viewportItems:f,listElRef:s,itemsElRef:ee(null),scrollTo:p,handleListResize:I,handleListScroll:b,handleListWheel:C,handleItemResize:y}},render(){const{itemResizable:n,keyField:e,keyToIndex:t,visibleItemsTag:i}=this;return Ue(TE,{onResize:this.handleListResize},{default:()=>{var r,s;return Ue("div",ht(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[this.items.length!==0?Ue("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[Ue(i,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>this.viewportItems.map(o=>{const a=o[e],l=t.get(a),c=this.$slots.default({item:o,index:l})[0];return n?Ue(TE,{key:a,onResize:u=>this.handleItemResize(a,u)},{default:()=>c}):(c.key=a,c)})})]):(s=(r=this.$slots).empty)===null||s===void 0?void 0:s.call(r)])}})}}),cu="v-hidden",btt=hd("[v-hidden]",{display:"none!important"}),x$=Fe({name:"Overflow",props:{getCounter:Function,getTail:Function,updateCounter:Function,onUpdateCount:Function,onUpdateOverflow:Function},setup(n,{slots:e}){const t=ee(null),i=ee(null);function r(o){const{value:a}=t,{getCounter:l,getTail:c}=n;let u;if(l!==void 0?u=l():u=i.value,!a||!u)return;u.hasAttribute(cu)&&u.removeAttribute(cu);const{children:h}=a;if(o.showAllItemsBeforeCalculate)for(const y of h)y.hasAttribute(cu)&&y.removeAttribute(cu);const d=a.offsetWidth,f=[],p=e.tail?c==null?void 0:c():null;let g=p?p.offsetWidth:0,m=!1;const v=a.children.length-(e.tail?1:0);for(let y=0;y<v-1;++y){if(y<0)continue;const A=h[y];if(m){A.hasAttribute(cu)||A.setAttribute(cu,"");continue}else A.hasAttribute(cu)&&A.removeAttribute(cu);const w=A.offsetWidth;if(g+=w,f[y]=w,g>d){const{updateCounter:b}=n;for(let C=y;C>=0;--C){const I=v-1-C;b!==void 0?b(I):u.textContent=`${I}`;const x=u.offsetWidth;if(g-=f[C],g+x<=d||C===0){m=!0,y=C-1,p&&(y===-1?(p.style.maxWidth=`${d-x}px`,p.style.boxSizing="border-box"):p.style.maxWidth="");const{onUpdateCount:T}=n;T&&T(I);break}}}}const{onUpdateOverflow:_}=n;m?_!==void 0&&_(!0):(_!==void 0&&_(!1),u.setAttribute(cu,""))}const s=_g();return btt.mount({id:"vueuc/overflow",head:!0,anchorMetaName:bN,ssr:s}),Zn(()=>r({showAllItemsBeforeCalculate:!1})),{selfRef:t,counterRef:i,sync:r}},render(){const{$slots:n}=this;return Yi(()=>this.sync({showAllItemsBeforeCalculate:!1})),Ue("div",{class:"v-overflow",ref:"selfRef"},[Fs(n,"default"),n.counter?n.counter():Ue("span",{style:{display:"inline-block"},ref:"counterRef"}),n.tail?n.tail():null])}});function BZ(n){return n instanceof HTMLElement}function FZ(n){for(let e=0;e<n.childNodes.length;e++){const t=n.childNodes[e];if(BZ(t)&&(GZ(t)||FZ(t)))return!0}return!1}function UZ(n){for(let e=n.childNodes.length-1;e>=0;e--){const t=n.childNodes[e];if(BZ(t)&&(GZ(t)||UZ(t)))return!0}return!1}function GZ(n){if(!wtt(n))return!1;try{n.focus({preventScroll:!0})}catch{}return document.activeElement===n}function wtt(n){if(n.tabIndex>0||n.tabIndex===0&&n.getAttribute("tabIndex")!==null)return!0;if(n.getAttribute("disabled"))return!1;switch(n.nodeName){case"A":return!!n.href&&n.rel!=="ignore";case"INPUT":return n.type!=="hidden"&&n.type!=="file";case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}let q_=[];const xtt=Fe({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(n){const e=FZe(),t=ee(null),i=ee(null);let r=!1,s=!1;const o=typeof document>"u"?null:document.activeElement;function a(){return q_[q_.length-1]===e}function l(m){var v;m.code==="Escape"&&a()&&((v=n.onEsc)===null||v===void 0||v.call(n,m))}Zn(()=>{yt(()=>n.active,m=>{m?(h(),yo("keydown",document,l)):(Yr("keydown",document,l),r&&d())},{immediate:!0})}),qo(()=>{Yr("keydown",document,l),r&&d()});function c(m){if(!s&&a()){const v=u();if(v===null||v.contains(QA(m)))return;f("first")}}function u(){const m=t.value;if(m===null)return null;let v=m;for(;v=v.nextSibling,!(v===null||v instanceof Element&&v.tagName==="DIV"););return v}function h(){var m;if(!n.disabled){if(q_.push(e),n.autoFocus){const{initialFocusTo:v}=n;v===void 0?f("first"):(m=c$(v))===null||m===void 0||m.focus({preventScroll:!0})}r=!0,document.addEventListener("focus",c,!0)}}function d(){var m;if(n.disabled||(document.removeEventListener("focus",c,!0),q_=q_.filter(_=>_!==e),a()))return;const{finalFocusTo:v}=n;v!==void 0?(m=c$(v))===null||m===void 0||m.focus({preventScroll:!0}):n.returnFocusOnDeactivated&&o instanceof HTMLElement&&(s=!0,o.focus({preventScroll:!0}),s=!1)}function f(m){if(a()&&n.active){const v=t.value,_=i.value;if(v!==null&&_!==null){const y=u();if(y==null||y===_){s=!0,v.focus({preventScroll:!0}),s=!1;return}s=!0;const A=m==="first"?FZ(y):UZ(y);s=!1,A||(s=!0,v.focus({preventScroll:!0}),s=!1)}}}function p(m){if(s)return;const v=u();v!==null&&(m.relatedTarget!==null&&v.contains(m.relatedTarget)?f("last"):f("first"))}function g(m){s||(m.relatedTarget!==null&&m.relatedTarget===t.value?f("last"):f("first"))}return{focusableStartRef:t,focusableEndRef:i,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:p,handleEndFocus:g}},render(){const{default:n}=this.$slots;if(n===void 0)return null;if(this.disabled)return n();const{active:e,focusableStyle:t}=this;return Ue(vt,null,[Ue("div",{"aria-hidden":"true",tabindex:e?"0":"-1",ref:"focusableStartRef",style:t,onFocus:this.handleStartFocus}),n(),Ue("div",{"aria-hidden":"true",style:t,ref:"focusableEndRef",tabindex:e?"0":"-1",onFocus:this.handleEndFocus})])}});function HZ(n,e){e&&(Zn(()=>{const{value:t}=n;t&&EE.registerHandler(t,e)}),qo(()=>{const{value:t}=n;t&&EE.unregisterHandler(t)}))}function Ctt(n){const e={isDeactivated:!1};let t=!1;return a6(()=>{if(e.isDeactivated=!1,!t){t=!0;return}n()}),l6(()=>{e.isDeactivated=!0,t||(t=!0)}),e}const C$="n-form-item";function Ett(n,{defaultSize:e="medium",mergedSize:t,mergedDisabled:i}={}){const r=Er(C$,null);ju(C$,null);const s=te(t?()=>t(r):()=>{const{size:l}=n;if(l)return l;if(r){const{mergedSize:c}=r;if(c.value!==void 0)return c.value}return e}),o=te(i?()=>i(r):()=>{const{disabled:l}=n;return l!==void 0?l:r?r.disabled.value:!1}),a=te(()=>{const{status:l}=n;return l||(r==null?void 0:r.mergedValidationStatus.value)});return qo(()=>{r&&r.restoreValidation()}),{mergedSizeRef:s,mergedDisabledRef:o,mergedStatusRef:a,nTriggerFormBlur(){r&&r.handleContentBlur()},nTriggerFormChange(){r&&r.handleContentChange()},nTriggerFormFocus(){r&&r.handleContentFocus()},nTriggerFormInput(){r&&r.handleContentInput()}}}const _b={fontFamily:'v-sans, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontFamilyMono:"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace",fontWeight:"400",fontWeightStrong:"500",cubicBezierEaseInOut:"cubic-bezier(.4, 0, .2, 1)",cubicBezierEaseOut:"cubic-bezier(0, 0, .2, 1)",cubicBezierEaseIn:"cubic-bezier(.4, 0, 1, 1)",borderRadius:"3px",borderRadiusSmall:"2px",fontSize:"14px",fontSizeMini:"12px",fontSizeTiny:"12px",fontSizeSmall:"14px",fontSizeMedium:"14px",fontSizeLarge:"15px",fontSizeHuge:"16px",lineHeight:"1.6",heightMini:"16px",heightTiny:"22px",heightSmall:"28px",heightMedium:"34px",heightLarge:"40px",heightHuge:"46px"},{fontSize:Ttt,fontFamily:Itt,lineHeight:Stt}=_b,VZ=Ut("body",`
 margin: 0;
 font-size: ${Ttt};
 font-family: ${Itt};
 line-height: ${Stt};
 -webkit-text-size-adjust: 100%;
 -webkit-tap-highlight-color: transparent;
`,[Ut("input",`
 font-family: inherit;
 font-size: inherit;
 `)]),yg="n-config-provider",qA="naive-ui-style";function ys(n,e,t,i,r,s){const o=_g(),a=Er(yg,null);if(t){const c=()=>{const u=s==null?void 0:s.value;t.mount({id:u===void 0?e:u+e,head:!0,props:{bPrefix:u?`.${u}-`:void 0},anchorMetaName:qA,ssr:o}),a!=null&&a.preflightStyleDisabled||VZ.mount({id:"n-global",head:!0,anchorMetaName:qA,ssr:o})};o?c():oO(c)}return te(()=>{var c;const{theme:{common:u,self:h,peers:d={}}={},themeOverrides:f={},builtinThemeOverrides:p={}}=r,{common:g,peers:m}=f,{common:v=void 0,[n]:{common:_=void 0,self:y=void 0,peers:A={}}={}}=(a==null?void 0:a.mergedThemeRef.value)||{},{common:w=void 0,[n]:b={}}=(a==null?void 0:a.mergedThemeOverridesRef.value)||{},{common:C,peers:I={}}=b,x=Ln({},u||_||v||i.common,w,C,g),T=Ln((c=h||y||i.self)===null||c===void 0?void 0:c(x),p,b,f);return{common:x,self:T,peers:Ln({},i.peers,A,d),peerOverrides:Ln({},p.peers,I,m)}})}ys.props={theme:Object,themeOverrides:Object,builtinThemeOverrides:Object};const Ptt="n";function Hd(n={},e={defaultBordered:!0}){const t=Er(yg,null);return{inlineThemeDisabled:t==null?void 0:t.inlineThemeDisabled,mergedRtlRef:t==null?void 0:t.mergedRtlRef,mergedComponentPropsRef:t==null?void 0:t.mergedComponentPropsRef,mergedBreakpointsRef:t==null?void 0:t.mergedBreakpointsRef,mergedBorderedRef:te(()=>{var i,r;const{bordered:s}=n;return s!==void 0?s:(r=(i=t==null?void 0:t.mergedBorderedRef.value)!==null&&i!==void 0?i:e.defaultBordered)!==null&&r!==void 0?r:!0}),mergedClsPrefixRef:t?t.mergedClsPrefixRef:jee(Ptt),namespaceRef:te(()=>t==null?void 0:t.mergedNamespaceRef.value)}}const Mtt={name:"en-US",global:{undo:"Undo",redo:"Redo",confirm:"Confirm",clear:"Clear"},Popconfirm:{positiveText:"Confirm",negativeText:"Cancel"},Cascader:{placeholder:"Please Select",loading:"Loading",loadingRequiredMessage:n=>`Please load all ${n}'s descendants before checking it.`},Time:{dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss"},DatePicker:{yearFormat:"yyyy",monthFormat:"MMM",dayFormat:"eeeeee",yearTypeFormat:"yyyy",monthTypeFormat:"yyyy-MM",dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss",quarterFormat:"yyyy-qqq",weekFormat:"yyyy-w",clear:"Clear",now:"Now",confirm:"Confirm",selectTime:"Select Time",selectDate:"Select Date",datePlaceholder:"Select Date",datetimePlaceholder:"Select Date and Time",monthPlaceholder:"Select Month",yearPlaceholder:"Select Year",quarterPlaceholder:"Select Quarter",weekPlaceholder:"Select Week",startDatePlaceholder:"Start Date",endDatePlaceholder:"End Date",startDatetimePlaceholder:"Start Date and Time",endDatetimePlaceholder:"End Date and Time",startMonthPlaceholder:"Start Month",endMonthPlaceholder:"End Month",monthBeforeYear:!0,firstDayOfWeek:6,today:"Today"},DataTable:{checkTableAll:"Select all in the table",uncheckTableAll:"Unselect all in the table",confirm:"Confirm",clear:"Clear"},LegacyTransfer:{sourceTitle:"Source",targetTitle:"Target"},Transfer:{selectAll:"Select all",unselectAll:"Unselect all",clearAll:"Clear",total:n=>`Total ${n} items`,selected:n=>`${n} items selected`},Empty:{description:"No Data"},Select:{placeholder:"Please Select"},TimePicker:{placeholder:"Select Time",positiveText:"OK",negativeText:"Cancel",now:"Now",clear:"Clear"},Pagination:{goto:"Goto",selectionSuffix:"page"},DynamicTags:{add:"Add"},Log:{loading:"Loading"},Input:{placeholder:"Please Input"},InputNumber:{placeholder:"Please Input"},DynamicInput:{create:"Create"},ThemeEditor:{title:"Theme Editor",clearAllVars:"Clear All Variables",clearSearch:"Clear Search",filterCompName:"Filter Component Name",filterVarName:"Filter Variable Name",import:"Import",export:"Export",restore:"Reset to Default"},Image:{tipPrevious:"Previous picture (←)",tipNext:"Next picture (→)",tipCounterclockwise:"Counterclockwise",tipClockwise:"Clockwise",tipZoomOut:"Zoom out",tipZoomIn:"Zoom in",tipDownload:"Download",tipClose:"Close (Esc)",tipOriginalSize:"Zoom to original size"}},Rtt=Mtt,Dtt={name:"en-US",locale:qO},ktt=Dtt;function zZ(n){const{mergedLocaleRef:e,mergedDateLocaleRef:t}=Er(yg,null)||{},i=te(()=>{var s,o;return(o=(s=e==null?void 0:e.value)===null||s===void 0?void 0:s[n])!==null&&o!==void 0?o:Rtt[n]});return{dateLocaleRef:te(()=>{var s;return(s=t==null?void 0:t.value)!==null&&s!==void 0?s:ktt}),localeRef:i}}function VI(n,e,t){if(!e)return;const i=_g(),r=Er(yg,null),s=()=>{const o=t.value;e.mount({id:o===void 0?n:o+n,head:!0,anchorMetaName:qA,props:{bPrefix:o?`.${o}-`:void 0},ssr:i}),r!=null&&r.preflightStyleDisabled||VZ.mount({id:"n-global",head:!0,anchorMetaName:qA,ssr:i})};i?s():oO(s)}function Ag(n,e,t,i){var r;t||HZe("useThemeClass","cssVarsRef is not passed");const s=(r=Er(yg,null))===null||r===void 0?void 0:r.mergedThemeHashRef,o=ee(""),a=_g();let l;const c=`__${n}`,u=()=>{let h=c;const d=e?e.value:void 0,f=s==null?void 0:s.value;f&&(h+="-"+f),d&&(h+="-"+d);const{themeOverrides:p,builtinThemeOverrides:g}=i;p&&(h+="-"+$k(JSON.stringify(p))),g&&(h+="-"+$k(JSON.stringify(g))),o.value=h,l=()=>{const m=t.value;let v="";for(const _ in m)v+=`${_}: ${m[_]};`;Ut(`.${h}`,v).mount({id:h,ssr:a}),l=void 0}};return Qv(()=>{u()}),{themeClass:o,onRender:()=>{l==null||l()}}}function yb(n,e,t){if(!e)return;const i=_g(),r=te(()=>{const{value:o}=e;if(!o)return;const a=o[n];if(a)return a}),s=()=>{Qv(()=>{const{value:o}=t,a=`${o}${n}Rtl`;if(set(a,i))return;const{value:l}=r;l&&l.style.mount({id:a,head:!0,anchorMetaName:qA,props:{bPrefix:o?`.${o}-`:void 0},ssr:i})})};return i?s():oO(s),r}function $Z(n,e){return Fe({name:dae(n),setup(){var t;const i=(t=Er(yg,null))===null||t===void 0?void 0:t.mergedIconsRef;return()=>{var r;const s=(r=i==null?void 0:i.value)===null||r===void 0?void 0:r[n];return s?s():e}}})}const Ott=Fe({name:"Checkmark",render(){return Ue("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},Ue("g",{fill:"none"},Ue("path",{d:"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032z",fill:"currentColor"})))}}),Ltt=$Z("close",Ue("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0},Ue("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},Ue("g",{fill:"currentColor","fill-rule":"nonzero"},Ue("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"}))))),Ntt=Fe({name:"Empty",render(){return Ue("svg",{viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ue("path",{d:"M26 7.5C26 11.0899 23.0899 14 19.5 14C15.9101 14 13 11.0899 13 7.5C13 3.91015 15.9101 1 19.5 1C23.0899 1 26 3.91015 26 7.5ZM16.8536 4.14645C16.6583 3.95118 16.3417 3.95118 16.1464 4.14645C15.9512 4.34171 15.9512 4.65829 16.1464 4.85355L18.7929 7.5L16.1464 10.1464C15.9512 10.3417 15.9512 10.6583 16.1464 10.8536C16.3417 11.0488 16.6583 11.0488 16.8536 10.8536L19.5 8.20711L22.1464 10.8536C22.3417 11.0488 22.6583 11.0488 22.8536 10.8536C23.0488 10.6583 23.0488 10.3417 22.8536 10.1464L20.2071 7.5L22.8536 4.85355C23.0488 4.65829 23.0488 4.34171 22.8536 4.14645C22.6583 3.95118 22.3417 3.95118 22.1464 4.14645L19.5 6.79289L16.8536 4.14645Z",fill:"currentColor"}),Ue("path",{d:"M25 22.75V12.5991C24.5572 13.0765 24.053 13.4961 23.5 13.8454V16H17.5L17.3982 16.0068C17.0322 16.0565 16.75 16.3703 16.75 16.75C16.75 18.2688 15.5188 19.5 14 19.5C12.4812 19.5 11.25 18.2688 11.25 16.75L11.2432 16.6482C11.1935 16.2822 10.8797 16 10.5 16H4.5V7.25C4.5 6.2835 5.2835 5.5 6.25 5.5H12.2696C12.4146 4.97463 12.6153 4.47237 12.865 4H6.25C4.45507 4 3 5.45507 3 7.25V22.75C3 24.5449 4.45507 26 6.25 26H21.75C23.5449 26 25 24.5449 25 22.75ZM4.5 22.75V17.5H9.81597L9.85751 17.7041C10.2905 19.5919 11.9808 21 14 21L14.215 20.9947C16.2095 20.8953 17.842 19.4209 18.184 17.5H23.5V22.75C23.5 23.7165 22.7165 24.5 21.75 24.5H6.25C5.2835 24.5 4.5 23.7165 4.5 22.75Z",fill:"currentColor"}))}}),Btt=Fe({name:"ChevronDown",render(){return Ue("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ue("path",{d:"M3.14645 5.64645C3.34171 5.45118 3.65829 5.45118 3.85355 5.64645L8 9.79289L12.1464 5.64645C12.3417 5.45118 12.6583 5.45118 12.8536 5.64645C13.0488 5.84171 13.0488 6.15829 12.8536 6.35355L8.35355 10.8536C8.15829 11.0488 7.84171 11.0488 7.64645 10.8536L3.14645 6.35355C2.95118 6.15829 2.95118 5.84171 3.14645 5.64645Z",fill:"currentColor"}))}}),Ftt=$Z("clear",Ue("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ue("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},Ue("g",{fill:"currentColor","fill-rule":"nonzero"},Ue("path",{d:"M8,2 C11.3137085,2 14,4.6862915 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 C2,4.6862915 4.6862915,2 8,2 Z M6.5343055,5.83859116 C6.33943736,5.70359511 6.07001296,5.72288026 5.89644661,5.89644661 L5.89644661,5.89644661 L5.83859116,5.9656945 C5.70359511,6.16056264 5.72288026,6.42998704 5.89644661,6.60355339 L5.89644661,6.60355339 L7.293,8 L5.89644661,9.39644661 L5.83859116,9.4656945 C5.70359511,9.66056264 5.72288026,9.92998704 5.89644661,10.1035534 L5.89644661,10.1035534 L5.9656945,10.1614088 C6.16056264,10.2964049 6.42998704,10.2771197 6.60355339,10.1035534 L6.60355339,10.1035534 L8,8.707 L9.39644661,10.1035534 L9.4656945,10.1614088 C9.66056264,10.2964049 9.92998704,10.2771197 10.1035534,10.1035534 L10.1035534,10.1035534 L10.1614088,10.0343055 C10.2964049,9.83943736 10.2771197,9.57001296 10.1035534,9.39644661 L10.1035534,9.39644661 L8.707,8 L10.1035534,6.60355339 L10.1614088,6.5343055 C10.2964049,6.33943736 10.2771197,6.07001296 10.1035534,5.89644661 L10.1035534,5.89644661 L10.0343055,5.83859116 C9.83943736,5.70359511 9.57001296,5.72288026 9.39644661,5.89644661 L9.39644661,5.89644661 L8,7.293 L6.60355339,5.89644661 Z"}))))),WZ=Fe({name:"BaseIconSwitchTransition",setup(n,{slots:e}){const t=HI();return()=>Ue(dv,{name:"icon-switch-transition",appear:t.value},e)}}),Utt=nn("base-icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[Ut("svg",`
 height: 1em;
 width: 1em;
 `)]),Ab=Fe({name:"BaseIcon",props:{role:String,ariaLabel:String,ariaDisabled:{type:Boolean,default:void 0},ariaHidden:{type:Boolean,default:void 0},clsPrefix:{type:String,required:!0},onClick:Function,onMousedown:Function,onMouseup:Function},setup(n){VI("-base-icon",Utt,ri(n,"clsPrefix"))},render(){return Ue("i",{class:`${this.clsPrefix}-base-icon`,onClick:this.onClick,onMousedown:this.onMousedown,onMouseup:this.onMouseup,role:this.role,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,"aria-disabled":this.ariaDisabled},this.$slots)}}),Gtt=nn("base-close",`
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: pointer;
 background-color: transparent;
 color: var(--n-close-icon-color);
 border-radius: var(--n-close-border-radius);
 height: var(--n-close-size);
 width: var(--n-close-size);
 font-size: var(--n-close-icon-size);
 outline: none;
 border: none;
 position: relative;
 padding: 0;
`,[Jn("absolute",`
 height: var(--n-close-icon-size);
 width: var(--n-close-icon-size);
 `),Ut("&::before",`
 content: "";
 position: absolute;
 width: var(--n-close-size);
 height: var(--n-close-size);
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 transition: inherit;
 border-radius: inherit;
 `),jl("disabled",[Ut("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),Ut("&:hover::before",`
 background-color: var(--n-close-color-hover);
 `),Ut("&:focus::before",`
 background-color: var(--n-close-color-hover);
 `),Ut("&:active",`
 color: var(--n-close-icon-color-pressed);
 `),Ut("&:active::before",`
 background-color: var(--n-close-color-pressed);
 `)]),Jn("disabled",`
 cursor: not-allowed;
 color: var(--n-close-icon-color-disabled);
 background-color: transparent;
 `),Jn("round",[Ut("&::before",`
 border-radius: 50%;
 `)])]),Htt=Fe({name:"BaseClose",props:{isButtonTag:{type:Boolean,default:!0},clsPrefix:{type:String,required:!0},disabled:{type:Boolean,default:void 0},focusable:{type:Boolean,default:!0},round:Boolean,onClick:Function,absolute:Boolean},setup(n){return VI("-base-close",Gtt,ri(n,"clsPrefix")),()=>{const{clsPrefix:e,disabled:t,absolute:i,round:r,isButtonTag:s}=n;return Ue(s?"button":"div",{type:s?"button":void 0,tabindex:t||!n.focusable?-1:0,"aria-disabled":t,"aria-label":"close",role:s?void 0:"button",disabled:t,class:[`${e}-base-close`,i&&`${e}-base-close--absolute`,t&&`${e}-base-close--disabled`,r&&`${e}-base-close--round`],onMousedown:a=>{n.focusable||a.preventDefault()},onClick:n.onClick},Ue(Ab,{clsPrefix:e},{default:()=>Ue(Ltt,null)}))}}}),Vtt=Fe({props:{onFocus:Function,onBlur:Function},setup(n){return()=>Ue("div",{style:"width: 0; height: 0",tabindex:0,onFocus:n.onFocus,onBlur:n.onBlur})}}),{cubicBezierEaseInOut:ztt}=_b;function Yk({originalTransform:n="",left:e=0,top:t=0,transition:i=`all .3s ${ztt} !important`}={}){return[Ut("&.icon-switch-transition-enter-from, &.icon-switch-transition-leave-to",{transform:n+" scale(0.75)",left:e,top:t,opacity:0}),Ut("&.icon-switch-transition-enter-to, &.icon-switch-transition-leave-from",{transform:`scale(1) ${n}`,left:e,top:t,opacity:1}),Ut("&.icon-switch-transition-enter-active, &.icon-switch-transition-leave-active",{transformOrigin:"center",position:"absolute",left:e,top:t,transition:i})]}const $tt=Ut([Ut("@keyframes rotator",`
 0% {
 -webkit-transform: rotate(0deg);
 transform: rotate(0deg);
 }
 100% {
 -webkit-transform: rotate(360deg);
 transform: rotate(360deg);
 }`),nn("base-loading",`
 position: relative;
 line-height: 0;
 width: 1em;
 height: 1em;
 `,[ln("transition-wrapper",`
 position: absolute;
 width: 100%;
 height: 100%;
 `,[Yk()]),ln("placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[Yk({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),ln("container",`
 animation: rotator 3s linear infinite both;
 `,[ln("icon",`
 height: 1em;
 width: 1em;
 `)])])]),kP="1.6s",Wtt={strokeWidth:{type:Number,default:28},stroke:{type:String,default:void 0}},jZ=Fe({name:"BaseLoading",props:Object.assign({clsPrefix:{type:String,required:!0},show:{type:Boolean,default:!0},scale:{type:Number,default:1},radius:{type:Number,default:100}},Wtt),setup(n){VI("-base-loading",$tt,ri(n,"clsPrefix"))},render(){const{clsPrefix:n,radius:e,strokeWidth:t,stroke:i,scale:r}=this,s=e/r;return Ue("div",{class:`${n}-base-loading`,role:"img","aria-label":"loading"},Ue(WZ,null,{default:()=>this.show?Ue("div",{key:"icon",class:`${n}-base-loading__transition-wrapper`},Ue("div",{class:`${n}-base-loading__container`},Ue("svg",{class:`${n}-base-loading__icon`,viewBox:`0 0 ${2*s} ${2*s}`,xmlns:"http://www.w3.org/2000/svg",style:{color:i}},Ue("g",null,Ue("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${s} ${s};270 ${s} ${s}`,begin:"0s",dur:kP,fill:"freeze",repeatCount:"indefinite"}),Ue("circle",{class:`${n}-base-loading__icon`,fill:"none",stroke:"currentColor","stroke-width":t,"stroke-linecap":"round",cx:s,cy:s,r:e-t/2,"stroke-dasharray":5.67*e,"stroke-dashoffset":18.48*e},Ue("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${s} ${s};135 ${s} ${s};450 ${s} ${s}`,begin:"0s",dur:kP,fill:"freeze",repeatCount:"indefinite"}),Ue("animate",{attributeName:"stroke-dashoffset",values:`${5.67*e};${1.42*e};${5.67*e}`,begin:"0s",dur:kP,fill:"freeze",repeatCount:"indefinite"})))))):Ue("div",{key:"placeholder",class:`${n}-base-loading__placeholder`},this.$slots)}))}});function E$(n){return Array.isArray(n)?n:[n]}const qk={STOP:"STOP"};function QZ(n,e){const t=e(n);n.children!==void 0&&t!==qk.STOP&&n.children.forEach(i=>QZ(i,e))}function jtt(n,e={}){const{preserveGroup:t=!1}=e,i=[],r=t?o=>{o.isLeaf||(i.push(o.key),s(o.children))}:o=>{o.isLeaf||(o.isGroup||i.push(o.key),s(o.children))};function s(o){o.forEach(r)}return s(n),i}function Qtt(n,e){const{isLeaf:t}=n;return t!==void 0?t:!e(n)}function Xtt(n){return n.children}function Ytt(n){return n.key}function qtt(){return!1}function Ktt(n,e){const{isLeaf:t}=n;return!(t===!1&&!Array.isArray(e(n)))}function Jtt(n){return n.disabled===!0}function Ztt(n,e){return n.isLeaf===!1&&!Array.isArray(e(n))}function OP(n){var e;return n==null?[]:Array.isArray(n)?n:(e=n.checkedKeys)!==null&&e!==void 0?e:[]}function LP(n){var e;return n==null||Array.isArray(n)?[]:(e=n.indeterminateKeys)!==null&&e!==void 0?e:[]}function ent(n,e){const t=new Set(n);return e.forEach(i=>{t.has(i)||t.add(i)}),Array.from(t)}function tnt(n,e){const t=new Set(n);return e.forEach(i=>{t.has(i)&&t.delete(i)}),Array.from(t)}function nnt(n){return(n==null?void 0:n.type)==="group"}function int(n){const e=new Map;return n.forEach((t,i)=>{e.set(t.key,i)}),t=>{var i;return(i=e.get(t))!==null&&i!==void 0?i:null}}class rnt extends Error{constructor(){super(),this.message="SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded."}}function snt(n,e,t,i){return IE(e.concat(n),t,i,!1)}function ont(n,e){const t=new Set;return n.forEach(i=>{const r=e.treeNodeMap.get(i);if(r!==void 0){let s=r.parent;for(;s!==null&&!(s.disabled||t.has(s.key));)t.add(s.key),s=s.parent}}),t}function ant(n,e,t,i){const r=IE(e,t,i,!1),s=IE(n,t,i,!0),o=ont(n,t),a=[];return r.forEach(l=>{(s.has(l)||o.has(l))&&a.push(l)}),a.forEach(l=>r.delete(l)),r}function NP(n,e){const{checkedKeys:t,keysToCheck:i,keysToUncheck:r,indeterminateKeys:s,cascade:o,leafOnly:a,checkStrategy:l,allowNotLoaded:c}=n;if(!o)return i!==void 0?{checkedKeys:ent(t,i),indeterminateKeys:Array.from(s)}:r!==void 0?{checkedKeys:tnt(t,r),indeterminateKeys:Array.from(s)}:{checkedKeys:Array.from(t),indeterminateKeys:Array.from(s)};const{levelTreeNodeMap:u}=e;let h;r!==void 0?h=ant(r,t,e,c):i!==void 0?h=snt(i,t,e,c):h=IE(t,e,c,!1);const d=l==="parent",f=l==="child"||a,p=h,g=new Set,m=Math.max.apply(null,Array.from(u.keys()));for(let v=m;v>=0;v-=1){const _=v===0,y=u.get(v);for(const A of y){if(A.isLeaf)continue;const{key:w,shallowLoaded:b}=A;if(f&&b&&A.children.forEach(T=>{!T.disabled&&!T.isLeaf&&T.shallowLoaded&&p.has(T.key)&&p.delete(T.key)}),A.disabled||!b)continue;let C=!0,I=!1,x=!0;for(const T of A.children){const O=T.key;if(!T.disabled){if(x&&(x=!1),p.has(O))I=!0;else if(g.has(O)){I=!0,C=!1;break}else if(C=!1,I)break}}C&&!x?(d&&A.children.forEach(T=>{!T.disabled&&p.has(T.key)&&p.delete(T.key)}),p.add(w)):I&&g.add(w),_&&f&&p.has(w)&&p.delete(w)}}return{checkedKeys:Array.from(p),indeterminateKeys:Array.from(g)}}function IE(n,e,t,i){const{treeNodeMap:r,getChildren:s}=e,o=new Set,a=new Set(n);return n.forEach(l=>{const c=r.get(l);c!==void 0&&QZ(c,u=>{if(u.disabled)return qk.STOP;const{key:h}=u;if(!o.has(h)&&(o.add(h),a.add(h),Ztt(u.rawNode,s))){if(i)return qk.STOP;if(!t)throw new rnt}})}),a}function lnt(n,{includeGroup:e=!1,includeSelf:t=!0},i){var r;const s=i.treeNodeMap;let o=n==null?null:(r=s.get(n))!==null&&r!==void 0?r:null;const a={keyPath:[],treeNodePath:[],treeNode:o};if(o!=null&&o.ignored)return a.treeNode=null,a;for(;o;)!o.ignored&&(e||!o.isGroup)&&a.treeNodePath.push(o),o=o.parent;return a.treeNodePath.reverse(),t||a.treeNodePath.pop(),a.keyPath=a.treeNodePath.map(l=>l.key),a}function cnt(n){if(n.length===0)return null;const e=n[0];return e.isGroup||e.ignored||e.disabled?e.getNext():e}function unt(n,e){const t=n.siblings,i=t.length,{index:r}=n;return e?t[(r+1)%i]:r===t.length-1?null:t[r+1]}function T$(n,e,{loop:t=!1,includeDisabled:i=!1}={}){const r=e==="prev"?hnt:unt,s={reverse:e==="prev"};let o=!1,a=null;function l(c){if(c!==null){if(c===n){if(!o)o=!0;else if(!n.disabled&&!n.isGroup){a=n;return}}else if((!c.disabled||i)&&!c.ignored&&!c.isGroup){a=c;return}if(c.isGroup){const u=xN(c,s);u!==null?a=u:l(r(c,t))}else{const u=r(c,!1);if(u!==null)l(u);else{const h=dnt(c);h!=null&&h.isGroup?l(r(h,t)):t&&l(r(c,!0))}}}}return l(n),a}function hnt(n,e){const t=n.siblings,i=t.length,{index:r}=n;return e?t[(r-1+i)%i]:r===0?null:t[r-1]}function dnt(n){return n.parent}function xN(n,e={}){const{reverse:t=!1}=e,{children:i}=n;if(i){const{length:r}=i,s=t?r-1:0,o=t?-1:r,a=t?-1:1;for(let l=s;l!==o;l+=a){const c=i[l];if(!c.disabled&&!c.ignored)if(c.isGroup){const u=xN(c,e);if(u!==null)return u}else return c}}return null}const fnt={getChild(){return this.ignored?null:xN(this)},getParent(){const{parent:n}=this;return n!=null&&n.isGroup?n.getParent():n},getNext(n={}){return T$(this,"next",n)},getPrev(n={}){return T$(this,"prev",n)}};function pnt(n,e){const t=e?new Set(e):void 0,i=[];function r(s){s.forEach(o=>{i.push(o),!(o.isLeaf||!o.children||o.ignored)&&(o.isGroup||t===void 0||t.has(o.key))&&r(o.children)})}return r(n),i}function gnt(n,e){const t=n.key;for(;e;){if(e.key===t)return!0;e=e.parent}return!1}function XZ(n,e,t,i,r,s=null,o=0){const a=[];return n.forEach((l,c)=>{var u;const h=Object.create(i);if(h.rawNode=l,h.siblings=a,h.level=o,h.index=c,h.isFirstChild=c===0,h.isLastChild=c+1===n.length,h.parent=s,!h.ignored){const d=r(l);Array.isArray(d)&&(h.children=XZ(d,e,t,i,r,h,o+1))}a.push(h),e.set(h.key,h),t.has(o)||t.set(o,[]),(u=t.get(o))===null||u===void 0||u.push(h)}),a}function mnt(n,e={}){var t;const i=new Map,r=new Map,{getDisabled:s=Jtt,getIgnored:o=qtt,getIsGroup:a=nnt,getKey:l=Ytt}=e,c=(t=e.getChildren)!==null&&t!==void 0?t:Xtt,u=e.ignoreEmptyChildren?A=>{const w=c(A);return Array.isArray(w)?w.length?w:null:w}:c,h=Object.assign({get key(){return l(this.rawNode)},get disabled(){return s(this.rawNode)},get isGroup(){return a(this.rawNode)},get isLeaf(){return Qtt(this.rawNode,u)},get shallowLoaded(){return Ktt(this.rawNode,u)},get ignored(){return o(this.rawNode)},contains(A){return gnt(this,A)}},fnt),d=XZ(n,i,r,h,u);function f(A){if(A==null)return null;const w=i.get(A);return w&&!w.isGroup&&!w.ignored?w:null}function p(A){if(A==null)return null;const w=i.get(A);return w&&!w.ignored?w:null}function g(A,w){const b=p(A);return b?b.getPrev(w):null}function m(A,w){const b=p(A);return b?b.getNext(w):null}function v(A){const w=p(A);return w?w.getParent():null}function _(A){const w=p(A);return w?w.getChild():null}const y={treeNodes:d,treeNodeMap:i,levelTreeNodeMap:r,maxLevel:Math.max(...r.keys()),getChildren:u,getFlattenedNodes(A){return pnt(d,A)},getNode:f,getPrev:g,getNext:m,getParent:v,getChild:_,getFirstAvailableNode(){return cnt(d)},getPath(A,w={}){return lnt(A,w,y)},getCheckedKeys(A,w={}){const{cascade:b=!0,leafOnly:C=!1,checkStrategy:I="all",allowNotLoaded:x=!1}=w;return NP({checkedKeys:OP(A),indeterminateKeys:LP(A),cascade:b,leafOnly:C,checkStrategy:I,allowNotLoaded:x},y)},check(A,w,b={}){const{cascade:C=!0,leafOnly:I=!1,checkStrategy:x="all",allowNotLoaded:T=!1}=b;return NP({checkedKeys:OP(w),indeterminateKeys:LP(w),keysToCheck:A==null?[]:E$(A),cascade:C,leafOnly:I,checkStrategy:x,allowNotLoaded:T},y)},uncheck(A,w,b={}){const{cascade:C=!0,leafOnly:I=!1,checkStrategy:x="all",allowNotLoaded:T=!1}=b;return NP({checkedKeys:OP(w),indeterminateKeys:LP(w),keysToUncheck:A==null?[]:E$(A),cascade:C,leafOnly:I,checkStrategy:x,allowNotLoaded:T},y)},getNonLeafKeys(A={}){return jtt(d,A)}};return y}const Kt={neutralBase:"#FFF",neutralInvertBase:"#000",neutralTextBase:"#000",neutralPopover:"#fff",neutralCard:"#fff",neutralModal:"#fff",neutralBody:"#fff",alpha1:"0.82",alpha2:"0.72",alpha3:"0.38",alpha4:"0.24",alpha5:"0.18",alphaClose:"0.6",alphaDisabled:"0.5",alphaDisabledInput:"0.02",alphaPending:"0.05",alphaTablePending:"0.02",alphaPressed:"0.07",alphaAvatar:"0.2",alphaRail:"0.14",alphaProgressRail:".08",alphaBorder:"0.12",alphaDivider:"0.06",alphaInput:"0",alphaAction:"0.02",alphaTab:"0.04",alphaScrollbar:"0.25",alphaScrollbarHover:"0.4",alphaCode:"0.05",alphaTag:"0.02",primaryHover:"#36ad6a",primaryDefault:"#18a058",primaryActive:"#0c7a43",primarySuppl:"#36ad6a",infoHover:"#4098fc",infoDefault:"#2080f0",infoActive:"#1060c9",infoSuppl:"#4098fc",errorHover:"#de576d",errorDefault:"#d03050",errorActive:"#ab1f3f",errorSuppl:"#de576d",warningHover:"#fcb040",warningDefault:"#f0a020",warningActive:"#c97c10",warningSuppl:"#fcb040",successHover:"#36ad6a",successDefault:"#18a058",successActive:"#0c7a43",successSuppl:"#36ad6a"},vnt=Zp(Kt.neutralBase),YZ=Zp(Kt.neutralInvertBase),_nt="rgba("+YZ.slice(0,3).join(", ")+", ";function I$(n){return _nt+String(n)+")"}function $s(n){const e=Array.from(YZ);return e[3]=Number(n),NZe(vnt,e)}const ynt=Object.assign(Object.assign({name:"common"},_b),{baseColor:Kt.neutralBase,primaryColor:Kt.primaryDefault,primaryColorHover:Kt.primaryHover,primaryColorPressed:Kt.primaryActive,primaryColorSuppl:Kt.primarySuppl,infoColor:Kt.infoDefault,infoColorHover:Kt.infoHover,infoColorPressed:Kt.infoActive,infoColorSuppl:Kt.infoSuppl,successColor:Kt.successDefault,successColorHover:Kt.successHover,successColorPressed:Kt.successActive,successColorSuppl:Kt.successSuppl,warningColor:Kt.warningDefault,warningColorHover:Kt.warningHover,warningColorPressed:Kt.warningActive,warningColorSuppl:Kt.warningSuppl,errorColor:Kt.errorDefault,errorColorHover:Kt.errorHover,errorColorPressed:Kt.errorActive,errorColorSuppl:Kt.errorSuppl,textColorBase:Kt.neutralTextBase,textColor1:"rgb(31, 34, 37)",textColor2:"rgb(51, 54, 57)",textColor3:"rgb(118, 124, 130)",textColorDisabled:$s(Kt.alpha4),placeholderColor:$s(Kt.alpha4),placeholderColorDisabled:$s(Kt.alpha5),iconColor:$s(Kt.alpha4),iconColorHover:gx($s(Kt.alpha4),{lightness:.75}),iconColorPressed:gx($s(Kt.alpha4),{lightness:.9}),iconColorDisabled:$s(Kt.alpha5),opacity1:Kt.alpha1,opacity2:Kt.alpha2,opacity3:Kt.alpha3,opacity4:Kt.alpha4,opacity5:Kt.alpha5,dividerColor:"rgb(239, 239, 245)",borderColor:"rgb(224, 224, 230)",closeIconColor:$s(Number(Kt.alphaClose)),closeIconColorHover:$s(Number(Kt.alphaClose)),closeIconColorPressed:$s(Number(Kt.alphaClose)),closeColorHover:"rgba(0, 0, 0, .09)",closeColorPressed:"rgba(0, 0, 0, .13)",clearColor:$s(Kt.alpha4),clearColorHover:gx($s(Kt.alpha4),{lightness:.75}),clearColorPressed:gx($s(Kt.alpha4),{lightness:.9}),scrollbarColor:I$(Kt.alphaScrollbar),scrollbarColorHover:I$(Kt.alphaScrollbarHover),scrollbarWidth:"5px",scrollbarHeight:"5px",scrollbarBorderRadius:"5px",progressRailColor:$s(Kt.alphaProgressRail),railColor:"rgb(219, 219, 223)",popoverColor:Kt.neutralPopover,tableColor:Kt.neutralCard,cardColor:Kt.neutralCard,modalColor:Kt.neutralModal,bodyColor:Kt.neutralBody,tagColor:"#eee",avatarColor:$s(Kt.alphaAvatar),invertedColor:"rgb(0, 20, 40)",inputColor:$s(Kt.alphaInput),codeColor:"rgb(244, 244, 248)",tabColor:"rgb(247, 247, 250)",actionColor:"rgb(250, 250, 252)",tableHeaderColor:"rgb(250, 250, 252)",hoverColor:"rgb(243, 243, 245)",tableColorHover:"rgba(0, 0, 100, 0.03)",tableColorStriped:"rgba(0, 0, 100, 0.02)",pressedColor:"rgb(237, 237, 239)",opacityDisabled:Kt.alphaDisabled,inputColorDisabled:"rgb(250, 250, 252)",buttonColor2:"rgba(46, 51, 56, .05)",buttonColor2Hover:"rgba(46, 51, 56, .09)",buttonColor2Pressed:"rgba(46, 51, 56, .13)",boxShadow1:"0 1px 2px -2px rgba(0, 0, 0, .08), 0 3px 6px 0 rgba(0, 0, 0, .06), 0 5px 12px 4px rgba(0, 0, 0, .04)",boxShadow2:"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05)",boxShadow3:"0 6px 16px -9px rgba(0, 0, 0, .08), 0 9px 28px 0 rgba(0, 0, 0, .05), 0 12px 48px 16px rgba(0, 0, 0, .03)"}),bg=ynt,Ant={iconSizeSmall:"34px",iconSizeMedium:"40px",iconSizeLarge:"46px",iconSizeHuge:"52px"},bnt=n=>{const{textColorDisabled:e,iconColor:t,textColor2:i,fontSizeSmall:r,fontSizeMedium:s,fontSizeLarge:o,fontSizeHuge:a}=n;return Object.assign(Object.assign({},Ant),{fontSizeSmall:r,fontSizeMedium:s,fontSizeLarge:o,fontSizeHuge:a,textColor:e,iconColor:t,extraTextColor:i})},wnt={name:"Empty",common:bg,self:bnt},qZ=wnt,xnt=nn("empty",`
 display: flex;
 flex-direction: column;
 align-items: center;
 font-size: var(--n-font-size);
`,[ln("icon",`
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 line-height: var(--n-icon-size);
 color: var(--n-icon-color);
 transition:
 color .3s var(--n-bezier);
 `,[Ut("+",[ln("description",`
 margin-top: 8px;
 `)])]),ln("description",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),ln("extra",`
 text-align: center;
 transition: color .3s var(--n-bezier);
 margin-top: 12px;
 color: var(--n-extra-text-color);
 `)]),Cnt=Object.assign(Object.assign({},ys.props),{description:String,showDescription:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},size:{type:String,default:"medium"},renderIcon:Function}),Ent=Fe({name:"Empty",props:Cnt,setup(n){const{mergedClsPrefixRef:e,inlineThemeDisabled:t}=Hd(n),i=ys("Empty","-empty",xnt,qZ,n,e),{localeRef:r}=zZ("Empty"),s=Er(yg,null),o=te(()=>{var u,h,d;return(u=n.description)!==null&&u!==void 0?u:(d=(h=s==null?void 0:s.mergedComponentPropsRef.value)===null||h===void 0?void 0:h.Empty)===null||d===void 0?void 0:d.description}),a=te(()=>{var u,h;return((h=(u=s==null?void 0:s.mergedComponentPropsRef.value)===null||u===void 0?void 0:u.Empty)===null||h===void 0?void 0:h.renderIcon)||(()=>Ue(Ntt,null))}),l=te(()=>{const{size:u}=n,{common:{cubicBezierEaseInOut:h},self:{[rr("iconSize",u)]:d,[rr("fontSize",u)]:f,textColor:p,iconColor:g,extraTextColor:m}}=i.value;return{"--n-icon-size":d,"--n-font-size":f,"--n-bezier":h,"--n-text-color":p,"--n-icon-color":g,"--n-extra-text-color":m}}),c=t?Ag("empty",te(()=>{let u="";const{size:h}=n;return u+=h[0],u}),l,n):void 0;return{mergedClsPrefix:e,mergedRenderIcon:a,localizedDescription:te(()=>o.value||r.value.description),cssVars:t?void 0:l,themeClass:c==null?void 0:c.themeClass,onRender:c==null?void 0:c.onRender}},render(){const{$slots:n,mergedClsPrefix:e,onRender:t}=this;return t==null||t(),Ue("div",{class:[`${e}-empty`,this.themeClass],style:this.cssVars},this.showIcon?Ue("div",{class:`${e}-empty__icon`},n.icon?n.icon():Ue(Ab,{clsPrefix:e},{default:this.mergedRenderIcon})):null,this.showDescription?Ue("div",{class:`${e}-empty__description`},n.default?n.default():this.localizedDescription):null,n.extra?Ue("div",{class:`${e}-empty__extra`},n.extra()):null)}}),Tnt=n=>{const{scrollbarColor:e,scrollbarColorHover:t}=n;return{color:e,colorHover:t}},Int={name:"Scrollbar",common:bg,self:Tnt},KZ=Int,{cubicBezierEaseInOut:S$}=_b;function Snt({name:n="fade-in",enterDuration:e="0.2s",leaveDuration:t="0.2s",enterCubicBezier:i=S$,leaveCubicBezier:r=S$}={}){return[Ut(`&.${n}-transition-enter-active`,{transition:`all ${e} ${i}!important`}),Ut(`&.${n}-transition-leave-active`,{transition:`all ${t} ${r}!important`}),Ut(`&.${n}-transition-enter-from, &.${n}-transition-leave-to`,{opacity:0}),Ut(`&.${n}-transition-leave-from, &.${n}-transition-enter-to`,{opacity:1})]}const Pnt=nn("scrollbar",`
 overflow: hidden;
 position: relative;
 z-index: auto;
 height: 100%;
 width: 100%;
`,[Ut(">",[nn("scrollbar-container",`
 width: 100%;
 overflow: scroll;
 height: 100%;
 min-height: inherit;
 max-height: inherit;
 scrollbar-width: none;
 `,[Ut("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),Ut(">",[nn("scrollbar-content",`
 box-sizing: border-box;
 min-width: 100%;
 `)])])]),Ut(">, +",[nn("scrollbar-rail",`
 position: absolute;
 pointer-events: none;
 user-select: none;
 -webkit-user-select: none;
 `,[Jn("horizontal",`
 left: 2px;
 right: 2px;
 bottom: 4px;
 height: var(--n-scrollbar-height);
 `,[Ut(">",[ln("scrollbar",`
 height: var(--n-scrollbar-height);
 border-radius: var(--n-scrollbar-border-radius);
 right: 0;
 `)])]),Jn("vertical",`
 right: 4px;
 top: 2px;
 bottom: 2px;
 width: var(--n-scrollbar-width);
 `,[Ut(">",[ln("scrollbar",`
 width: var(--n-scrollbar-width);
 border-radius: var(--n-scrollbar-border-radius);
 bottom: 0;
 `)])]),Jn("disabled",[Ut(">",[ln("scrollbar","pointer-events: none;")])]),Ut(">",[ln("scrollbar",`
 z-index: 1;
 position: absolute;
 cursor: pointer;
 pointer-events: all;
 background-color: var(--n-scrollbar-color);
 transition: background-color .2s var(--n-scrollbar-bezier);
 `,[Snt(),Ut("&:hover","background-color: var(--n-scrollbar-color-hover);")])])])])]),Mnt=Object.assign(Object.assign({},ys.props),{size:{type:Number,default:5},duration:{type:Number,default:0},scrollable:{type:Boolean,default:!0},xScrollable:Boolean,trigger:{type:String,default:"hover"},useUnifiedContainer:Boolean,triggerDisplayManually:Boolean,container:Function,content:Function,containerClass:String,containerStyle:[String,Object],contentClass:[String,Array],contentStyle:[String,Object],horizontalRailStyle:[String,Object],verticalRailStyle:[String,Object],onScroll:Function,onWheel:Function,onResize:Function,internalOnUpdateScrollLeft:Function,internalHoistYRail:Boolean}),JZ=Fe({name:"Scrollbar",props:Mnt,inheritAttrs:!1,setup(n){const{mergedClsPrefixRef:e,inlineThemeDisabled:t,mergedRtlRef:i}=Hd(n),r=yb("Scrollbar",i,e),s=ee(null),o=ee(null),a=ee(null),l=ee(null),c=ee(null),u=ee(null),h=ee(null),d=ee(null),f=ee(null),p=ee(null),g=ee(null),m=ee(0),v=ee(0),_=ee(!1),y=ee(!1);let A=!1,w=!1,b,C,I=0,x=0,T=0,O=0;const F=Iet(),G=te(()=>{const{value:D}=d,{value:z}=u,{value:K}=p;return D===null||z===null||K===null?0:Math.min(D,K*D/z+n.size*1.5)}),B=te(()=>`${G.value}px`),R=te(()=>{const{value:D}=f,{value:z}=h,{value:K}=g;return D===null||z===null||K===null?0:K*D/z+n.size*1.5}),P=te(()=>`${R.value}px`),k=te(()=>{const{value:D}=d,{value:z}=m,{value:K}=u,{value:ce}=p;if(D===null||K===null||ce===null)return 0;{const ae=K-D;return ae?z/ae*(ce-G.value):0}}),L=te(()=>`${k.value}px`),H=te(()=>{const{value:D}=f,{value:z}=v,{value:K}=h,{value:ce}=g;if(D===null||K===null||ce===null)return 0;{const ae=K-D;return ae?z/ae*(ce-R.value):0}}),U=te(()=>`${H.value}px`),$=te(()=>{const{value:D}=d,{value:z}=u;return D!==null&&z!==null&&z>D}),j=te(()=>{const{value:D}=f,{value:z}=h;return D!==null&&z!==null&&z>D}),Q=te(()=>{const{trigger:D}=n;return D==="none"||_.value}),ne=te(()=>{const{trigger:D}=n;return D==="none"||y.value}),ve=te(()=>{const{container:D}=n;return D?D():o.value}),Pe=te(()=>{const{content:D}=n;return D?D():a.value}),De=Ctt(()=>{n.container||et({top:m.value,left:v.value})}),Xe=()=>{De.isDeactivated||pe()},Ne=D=>{if(De.isDeactivated)return;const{onResize:z}=n;z&&z(D),pe()},et=(D,z)=>{if(!n.scrollable)return;if(typeof D=="number"){de(z??0,D,0,!1,"auto");return}const{left:K,top:ce,index:ae,elSize:J,position:xe,behavior:Se,el:rt,debounce:ot=!0}=D;(K!==void 0||ce!==void 0)&&de(K??0,ce??0,0,!1,Se),rt!==void 0?de(0,rt.offsetTop,rt.offsetHeight,ot,Se):ae!==void 0&&J!==void 0?de(0,ae*J,J,ot,Se):xe==="bottom"?de(0,Number.MAX_SAFE_INTEGER,0,!1,Se):xe==="top"&&de(0,0,0,!1,Se)},ze=(D,z)=>{if(!n.scrollable)return;const{value:K}=ve;K&&(typeof D=="object"?K.scrollBy(D):K.scrollBy(D,z||0))};function de(D,z,K,ce,ae){const{value:J}=ve;if(J){if(ce){const{scrollTop:xe,offsetHeight:Se}=J;if(z>xe){z+K<=xe+Se||J.scrollTo({left:D,top:z+K-Se,behavior:ae});return}}J.scrollTo({left:D,top:z,behavior:ae})}}function lt(){He(),Y(),pe()}function he(){Ce()}function Ce(){se(),Re()}function se(){C!==void 0&&window.clearTimeout(C),C=window.setTimeout(()=>{y.value=!1},n.duration)}function Re(){b!==void 0&&window.clearTimeout(b),b=window.setTimeout(()=>{_.value=!1},n.duration)}function He(){b!==void 0&&window.clearTimeout(b),_.value=!0}function Y(){C!==void 0&&window.clearTimeout(C),y.value=!0}function W(D){const{onScroll:z}=n;z&&z(D),ge()}function ge(){const{value:D}=ve;D&&(m.value=D.scrollTop,v.value=D.scrollLeft*(r!=null&&r.value?-1:1))}function Le(){const{value:D}=Pe;D&&(u.value=D.offsetHeight,h.value=D.offsetWidth);const{value:z}=ve;z&&(d.value=z.offsetHeight,f.value=z.offsetWidth);const{value:K}=c,{value:ce}=l;K&&(g.value=K.offsetWidth),ce&&(p.value=ce.offsetHeight)}function Ve(){const{value:D}=ve;D&&(m.value=D.scrollTop,v.value=D.scrollLeft*(r!=null&&r.value?-1:1),d.value=D.offsetHeight,f.value=D.offsetWidth,u.value=D.scrollHeight,h.value=D.scrollWidth);const{value:z}=c,{value:K}=l;z&&(g.value=z.offsetWidth),K&&(p.value=K.offsetHeight)}function pe(){n.scrollable&&(n.useUnifiedContainer?Ve():(Le(),ge()))}function fe(D){var z;return!(!((z=s.value)===null||z===void 0)&&z.contains(QA(D)))}function Ee(D){D.preventDefault(),D.stopPropagation(),w=!0,yo("mousemove",window,oe,!0),yo("mouseup",window,Me,!0),x=v.value,T=r!=null&&r.value?window.innerWidth-D.clientX:D.clientX}function oe(D){if(!w)return;b!==void 0&&window.clearTimeout(b),C!==void 0&&window.clearTimeout(C);const{value:z}=f,{value:K}=h,{value:ce}=R;if(z===null||K===null)return;const J=(r!=null&&r.value?window.innerWidth-D.clientX-T:D.clientX-T)*(K-z)/(z-ce),xe=K-z;let Se=x+J;Se=Math.min(xe,Se),Se=Math.max(Se,0);const{value:rt}=ve;if(rt){rt.scrollLeft=Se*(r!=null&&r.value?-1:1);const{internalOnUpdateScrollLeft:ot}=n;ot&&ot(Se)}}function Me(D){D.preventDefault(),D.stopPropagation(),Yr("mousemove",window,oe,!0),Yr("mouseup",window,Me,!0),w=!1,pe(),fe(D)&&Ce()}function je(D){D.preventDefault(),D.stopPropagation(),A=!0,yo("mousemove",window,_e,!0),yo("mouseup",window,Ye,!0),I=m.value,O=D.clientY}function _e(D){if(!A)return;b!==void 0&&window.clearTimeout(b),C!==void 0&&window.clearTimeout(C);const{value:z}=d,{value:K}=u,{value:ce}=G;if(z===null||K===null)return;const J=(D.clientY-O)*(K-z)/(z-ce),xe=K-z;let Se=I+J;Se=Math.min(xe,Se),Se=Math.max(Se,0);const{value:rt}=ve;rt&&(rt.scrollTop=Se)}function Ye(D){D.preventDefault(),D.stopPropagation(),Yr("mousemove",window,_e,!0),Yr("mouseup",window,Ye,!0),A=!1,pe(),fe(D)&&Ce()}Qv(()=>{const{value:D}=j,{value:z}=$,{value:K}=e,{value:ce}=c,{value:ae}=l;ce&&(D?ce.classList.remove(`${K}-scrollbar-rail--disabled`):ce.classList.add(`${K}-scrollbar-rail--disabled`)),ae&&(z?ae.classList.remove(`${K}-scrollbar-rail--disabled`):ae.classList.add(`${K}-scrollbar-rail--disabled`))}),Zn(()=>{n.container||pe()}),qo(()=>{b!==void 0&&window.clearTimeout(b),C!==void 0&&window.clearTimeout(C),Yr("mousemove",window,_e,!0),Yr("mouseup",window,Ye,!0)});const q=ys("Scrollbar","-scrollbar",Pnt,KZ,n,e),we=te(()=>{const{common:{cubicBezierEaseInOut:D,scrollbarBorderRadius:z,scrollbarHeight:K,scrollbarWidth:ce},self:{color:ae,colorHover:J}}=q.value;return{"--n-scrollbar-bezier":D,"--n-scrollbar-color":ae,"--n-scrollbar-color-hover":J,"--n-scrollbar-border-radius":z,"--n-scrollbar-width":ce,"--n-scrollbar-height":K}}),M=t?Ag("scrollbar",void 0,we,n):void 0;return Object.assign(Object.assign({},{scrollTo:et,scrollBy:ze,sync:pe,syncUnifiedContainer:Ve,handleMouseEnterWrapper:lt,handleMouseLeaveWrapper:he}),{mergedClsPrefix:e,rtlEnabled:r,containerScrollTop:m,wrapperRef:s,containerRef:o,contentRef:a,yRailRef:l,xRailRef:c,needYBar:$,needXBar:j,yBarSizePx:B,xBarSizePx:P,yBarTopPx:L,xBarLeftPx:U,isShowXBar:Q,isShowYBar:ne,isIos:F,handleScroll:W,handleContentResize:Xe,handleContainerResize:Ne,handleYScrollMouseDown:je,handleXScrollMouseDown:Ee,cssVars:t?void 0:we,themeClass:M==null?void 0:M.themeClass,onRender:M==null?void 0:M.onRender})},render(){var n;const{$slots:e,mergedClsPrefix:t,triggerDisplayManually:i,rtlEnabled:r,internalHoistYRail:s}=this;if(!this.scrollable)return(n=e.default)===null||n===void 0?void 0:n.call(e);const o=this.trigger==="none",a=(u,h)=>Ue("div",{ref:"yRailRef",class:[`${t}-scrollbar-rail`,`${t}-scrollbar-rail--vertical`,u],"data-scrollbar-rail":!0,style:[h||"",this.verticalRailStyle],"aria-hiddens":!0},Ue(o?Vk:dv,o?null:{name:"fade-in-transition"},{default:()=>this.needYBar&&this.isShowYBar&&!this.isIos?Ue("div",{class:`${t}-scrollbar-rail__scrollbar`,style:{height:this.yBarSizePx,top:this.yBarTopPx},onMousedown:this.handleYScrollMouseDown}):null})),l=()=>{var u,h;return(u=this.onRender)===null||u===void 0||u.call(this),Ue("div",ht(this.$attrs,{role:"none",ref:"wrapperRef",class:[`${t}-scrollbar`,this.themeClass,r&&`${t}-scrollbar--rtl`],style:this.cssVars,onMouseenter:i?void 0:this.handleMouseEnterWrapper,onMouseleave:i?void 0:this.handleMouseLeaveWrapper}),[this.container?(h=e.default)===null||h===void 0?void 0:h.call(e):Ue("div",{role:"none",ref:"containerRef",class:[`${t}-scrollbar-container`,this.containerClass],style:this.containerStyle,onScroll:this.handleScroll,onWheel:this.onWheel},Ue(TE,{onResize:this.handleContentResize},{default:()=>Ue("div",{ref:"contentRef",role:"none",style:[{width:this.xScrollable?"fit-content":null},this.contentStyle],class:[`${t}-scrollbar-content`,this.contentClass]},e)})),s?null:a(void 0,void 0),this.xScrollable&&Ue("div",{ref:"xRailRef",class:[`${t}-scrollbar-rail`,`${t}-scrollbar-rail--horizontal`],style:this.horizontalRailStyle,"data-scrollbar-rail":!0,"aria-hidden":!0},Ue(o?Vk:dv,o?null:{name:"fade-in-transition"},{default:()=>this.needXBar&&this.isShowXBar&&!this.isIos?Ue("div",{class:`${t}-scrollbar-rail__scrollbar`,style:{width:this.xBarSizePx,right:r?this.xBarLeftPx:void 0,left:r?void 0:this.xBarLeftPx},onMousedown:this.handleXScrollMouseDown}):null}))])},c=this.container?l():Ue(TE,{onResize:this.handleContainerResize},{default:l});return s?Ue(vt,null,c,a(this.themeClass,this.cssVars)):c}}),Rnt=JZ,Dnt=JZ,knt={height:"calc(var(--n-option-height) * 7.6)",paddingSmall:"4px 0",paddingMedium:"4px 0",paddingLarge:"4px 0",paddingHuge:"4px 0",optionPaddingSmall:"0 12px",optionPaddingMedium:"0 12px",optionPaddingLarge:"0 12px",optionPaddingHuge:"0 12px",loadingSize:"18px"},Ont=n=>{const{borderRadius:e,popoverColor:t,textColor3:i,dividerColor:r,textColor2:s,primaryColorPressed:o,textColorDisabled:a,primaryColor:l,opacityDisabled:c,hoverColor:u,fontSizeSmall:h,fontSizeMedium:d,fontSizeLarge:f,fontSizeHuge:p,heightSmall:g,heightMedium:m,heightLarge:v,heightHuge:_}=n;return Object.assign(Object.assign({},knt),{optionFontSizeSmall:h,optionFontSizeMedium:d,optionFontSizeLarge:f,optionFontSizeHuge:p,optionHeightSmall:g,optionHeightMedium:m,optionHeightLarge:v,optionHeightHuge:_,borderRadius:e,color:t,groupHeaderTextColor:i,actionDividerColor:r,optionTextColor:s,optionTextColorPressed:o,optionTextColorDisabled:a,optionTextColorActive:l,optionOpacityDisabled:c,optionCheckColor:l,optionColorPending:u,optionColorActive:"rgba(0, 0, 0, 0)",optionColorActivePending:u,actionTextColor:s,loadingColor:l})},Lnt={name:"InternalSelectMenu",common:bg,peers:{Scrollbar:KZ,Empty:qZ},self:Ont},ZZ=Lnt;function Nnt(n,e){return Ue(dv,{name:"fade-in-scale-up-transition"},{default:()=>n?Ue(Ab,{clsPrefix:e,class:`${e}-base-select-option__check`},{default:()=>Ue(Ott)}):null})}const P$=Fe({name:"NBaseSelectOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(n){const{valueRef:e,pendingTmNodeRef:t,multipleRef:i,valueSetRef:r,renderLabelRef:s,renderOptionRef:o,labelFieldRef:a,valueFieldRef:l,showCheckmarkRef:c,nodePropsRef:u,handleOptionClick:h,handleOptionMouseEnter:d}=Er(AN),f=th(()=>{const{value:v}=t;return v?n.tmNode.key===v.key:!1});function p(v){const{tmNode:_}=n;_.disabled||h(v,_)}function g(v){const{tmNode:_}=n;_.disabled||d(v,_)}function m(v){const{tmNode:_}=n,{value:y}=f;_.disabled||y||d(v,_)}return{multiple:i,isGrouped:th(()=>{const{tmNode:v}=n,{parent:_}=v;return _&&_.rawNode.type==="group"}),showCheckmark:c,nodeProps:u,isPending:f,isSelected:th(()=>{const{value:v}=e,{value:_}=i;if(v===null)return!1;const y=n.tmNode.rawNode[l.value];if(_){const{value:A}=r;return A.has(y)}else return v===y}),labelField:a,renderLabel:s,renderOption:o,handleMouseMove:m,handleMouseEnter:g,handleClick:p}},render(){const{clsPrefix:n,tmNode:{rawNode:e},isSelected:t,isPending:i,isGrouped:r,showCheckmark:s,nodeProps:o,renderOption:a,renderLabel:l,handleClick:c,handleMouseEnter:u,handleMouseMove:h}=this,d=Nnt(t,n),f=l?[l(e,t),s&&d]:[Cm(e[this.labelField],e,t),s&&d],p=o==null?void 0:o(e),g=Ue("div",Object.assign({},p,{class:[`${n}-base-select-option`,e.class,p==null?void 0:p.class,{[`${n}-base-select-option--disabled`]:e.disabled,[`${n}-base-select-option--selected`]:t,[`${n}-base-select-option--grouped`]:r,[`${n}-base-select-option--pending`]:i,[`${n}-base-select-option--show-checkmark`]:s}],style:[(p==null?void 0:p.style)||"",e.style||""],onClick:CP([c,p==null?void 0:p.onClick]),onMouseenter:CP([u,p==null?void 0:p.onMouseenter]),onMousemove:CP([h,p==null?void 0:p.onMousemove])}),Ue("div",{class:`${n}-base-select-option__content`},f));return e.render?e.render({node:g,option:e,selected:t}):a?a({node:g,option:e,selected:t}):g}}),M$=Fe({name:"NBaseSelectGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{renderLabelRef:n,renderOptionRef:e,labelFieldRef:t,nodePropsRef:i}=Er(AN);return{labelField:t,nodeProps:i,renderLabel:n,renderOption:e}},render(){const{clsPrefix:n,renderLabel:e,renderOption:t,nodeProps:i,tmNode:{rawNode:r}}=this,s=i==null?void 0:i(r),o=e?e(r,!1):Cm(r[this.labelField],r,!1),a=Ue("div",Object.assign({},s,{class:[`${n}-base-select-group-header`,s==null?void 0:s.class]}),o);return r.render?r.render({node:a,option:r}):t?t({node:a,option:r,selected:!1}):a}}),{cubicBezierEaseIn:R$,cubicBezierEaseOut:D$}=_b;function eee({transformOrigin:n="inherit",duration:e=".2s",enterScale:t=".9",originalTransform:i="",originalTransition:r=""}={}){return[Ut("&.fade-in-scale-up-transition-leave-active",{transformOrigin:n,transition:`opacity ${e} ${R$}, transform ${e} ${R$} ${r&&","+r}`}),Ut("&.fade-in-scale-up-transition-enter-active",{transformOrigin:n,transition:`opacity ${e} ${D$}, transform ${e} ${D$} ${r&&","+r}`}),Ut("&.fade-in-scale-up-transition-enter-from, &.fade-in-scale-up-transition-leave-to",{opacity:0,transform:`${i} scale(${t})`}),Ut("&.fade-in-scale-up-transition-leave-from, &.fade-in-scale-up-transition-enter-to",{opacity:1,transform:`${i} scale(1)`})]}const Bnt=nn("base-select-menu",`
 line-height: 1.5;
 outline: none;
 z-index: 0;
 position: relative;
 border-radius: var(--n-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-color);
`,[nn("scrollbar",`
 max-height: var(--n-height);
 `),nn("virtual-list",`
 max-height: var(--n-height);
 `),nn("base-select-option",`
 min-height: var(--n-option-height);
 font-size: var(--n-option-font-size);
 display: flex;
 align-items: center;
 `,[ln("content",`
 z-index: 1;
 white-space: nowrap;
 text-overflow: ellipsis;
 overflow: hidden;
 `)]),nn("base-select-group-header",`
 min-height: var(--n-option-height);
 font-size: .93em;
 display: flex;
 align-items: center;
 `),nn("base-select-menu-option-wrapper",`
 position: relative;
 width: 100%;
 `),ln("loading, empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),ln("loading",`
 color: var(--n-loading-color);
 font-size: var(--n-loading-size);
 `),ln("header",`
 padding: 8px var(--n-option-padding-left);
 font-size: var(--n-option-font-size);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),ln("action",`
 padding: 8px var(--n-option-padding-left);
 font-size: var(--n-option-font-size);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),nn("base-select-group-header",`
 position: relative;
 cursor: default;
 padding: var(--n-option-padding);
 color: var(--n-group-header-text-color);
 `),nn("base-select-option",`
 cursor: pointer;
 position: relative;
 padding: var(--n-option-padding);
 transition:
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 box-sizing: border-box;
 color: var(--n-option-text-color);
 opacity: 1;
 `,[Jn("show-checkmark",`
 padding-right: calc(var(--n-option-padding-right) + 20px);
 `),Ut("&::before",`
 content: "";
 position: absolute;
 left: 4px;
 right: 4px;
 top: 0;
 bottom: 0;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),Ut("&:active",`
 color: var(--n-option-text-color-pressed);
 `),Jn("grouped",`
 padding-left: calc(var(--n-option-padding-left) * 1.5);
 `),Jn("pending",[Ut("&::before",`
 background-color: var(--n-option-color-pending);
 `)]),Jn("selected",`
 color: var(--n-option-text-color-active);
 `,[Ut("&::before",`
 background-color: var(--n-option-color-active);
 `),Jn("pending",[Ut("&::before",`
 background-color: var(--n-option-color-active-pending);
 `)])]),Jn("disabled",`
 cursor: not-allowed;
 `,[jl("selected",`
 color: var(--n-option-text-color-disabled);
 `),Jn("selected",`
 opacity: var(--n-option-opacity-disabled);
 `)]),ln("check",`
 font-size: 16px;
 position: absolute;
 right: calc(var(--n-option-padding-right) - 4px);
 top: calc(50% - 7px);
 color: var(--n-option-check-color);
 transition: color .3s var(--n-bezier);
 `,[eee({enterScale:"0.5"})])])]),Fnt=Fe({name:"InternalSelectMenu",props:Object.assign(Object.assign({},ys.props),{clsPrefix:{type:String,required:!0},scrollable:{type:Boolean,default:!0},treeMate:{type:Object,required:!0},multiple:Boolean,size:{type:String,default:"medium"},value:{type:[String,Number,Array],default:null},autoPending:Boolean,virtualScroll:{type:Boolean,default:!0},show:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},loading:Boolean,focusable:Boolean,renderLabel:Function,renderOption:Function,nodeProps:Function,showCheckmark:{type:Boolean,default:!0},onMousedown:Function,onScroll:Function,onFocus:Function,onBlur:Function,onKeyup:Function,onKeydown:Function,onTabOut:Function,onMouseenter:Function,onMouseleave:Function,onResize:Function,resetMenuOnOptionsChange:{type:Boolean,default:!0},inlineThemeDisabled:Boolean,onToggle:Function}),setup(n){const{mergedClsPrefixRef:e,mergedRtlRef:t}=Hd(n),i=yb("InternalSelectMenu",t,e),r=ys("InternalSelectMenu","-internal-select-menu",Bnt,ZZ,n,ri(n,"clsPrefix")),s=ee(null),o=ee(null),a=ee(null),l=te(()=>n.treeMate.getFlattenedNodes()),c=te(()=>int(l.value)),u=ee(null);function h(){const{treeMate:j}=n;let Q=null;const{value:ne}=n;ne===null?Q=j.getFirstAvailableNode():(n.multiple?Q=j.getNode((ne||[])[(ne||[]).length-1]):Q=j.getNode(ne),(!Q||Q.disabled)&&(Q=j.getFirstAvailableNode())),B(Q||null)}function d(){const{value:j}=u;j&&!n.treeMate.getNode(j.key)&&(u.value=null)}let f;yt(()=>n.show,j=>{j?f=yt(()=>n.treeMate,()=>{n.resetMenuOnOptionsChange?(n.autoPending?h():d(),Yi(R)):d()},{immediate:!0}):f==null||f()},{immediate:!0}),qo(()=>{f==null||f()});const p=te(()=>XA(r.value.self[rr("optionHeight",n.size)])),g=te(()=>Fm(r.value.self[rr("padding",n.size)])),m=te(()=>n.multiple&&Array.isArray(n.value)?new Set(n.value):new Set),v=te(()=>{const j=l.value;return j&&j.length===0});function _(j){const{onToggle:Q}=n;Q&&Q(j)}function y(j){const{onScroll:Q}=n;Q&&Q(j)}function A(j){var Q;(Q=a.value)===null||Q===void 0||Q.sync(),y(j)}function w(){var j;(j=a.value)===null||j===void 0||j.sync()}function b(){const{value:j}=u;return j||null}function C(j,Q){Q.disabled||B(Q,!1)}function I(j,Q){Q.disabled||_(Q)}function x(j){var Q;wE(j,"action")||(Q=n.onKeyup)===null||Q===void 0||Q.call(n,j)}function T(j){var Q;wE(j,"action")||(Q=n.onKeydown)===null||Q===void 0||Q.call(n,j)}function O(j){var Q;(Q=n.onMousedown)===null||Q===void 0||Q.call(n,j),!n.focusable&&j.preventDefault()}function F(){const{value:j}=u;j&&B(j.getNext({loop:!0}),!0)}function G(){const{value:j}=u;j&&B(j.getPrev({loop:!0}),!0)}function B(j,Q=!1){u.value=j,Q&&R()}function R(){var j,Q;const ne=u.value;if(!ne)return;const ve=c.value(ne.key);ve!==null&&(n.virtualScroll?(j=o.value)===null||j===void 0||j.scrollTo({index:ve}):(Q=a.value)===null||Q===void 0||Q.scrollTo({index:ve,elSize:p.value}))}function P(j){var Q,ne;!((Q=s.value)===null||Q===void 0)&&Q.contains(j.target)&&((ne=n.onFocus)===null||ne===void 0||ne.call(n,j))}function k(j){var Q,ne;!((Q=s.value)===null||Q===void 0)&&Q.contains(j.relatedTarget)||(ne=n.onBlur)===null||ne===void 0||ne.call(n,j)}ju(AN,{handleOptionMouseEnter:C,handleOptionClick:I,valueSetRef:m,pendingTmNodeRef:u,nodePropsRef:ri(n,"nodeProps"),showCheckmarkRef:ri(n,"showCheckmark"),multipleRef:ri(n,"multiple"),valueRef:ri(n,"value"),renderLabelRef:ri(n,"renderLabel"),renderOptionRef:ri(n,"renderOption"),labelFieldRef:ri(n,"labelField"),valueFieldRef:ri(n,"valueField")}),ju(yZ,s),Zn(()=>{const{value:j}=a;j&&j.sync()});const L=te(()=>{const{size:j}=n,{common:{cubicBezierEaseInOut:Q},self:{height:ne,borderRadius:ve,color:Pe,groupHeaderTextColor:De,actionDividerColor:Xe,optionTextColorPressed:Ne,optionTextColor:et,optionTextColorDisabled:ze,optionTextColorActive:de,optionOpacityDisabled:lt,optionCheckColor:he,actionTextColor:Ce,optionColorPending:se,optionColorActive:Re,loadingColor:He,loadingSize:Y,optionColorActivePending:W,[rr("optionFontSize",j)]:ge,[rr("optionHeight",j)]:Le,[rr("optionPadding",j)]:Ve}}=r.value;return{"--n-height":ne,"--n-action-divider-color":Xe,"--n-action-text-color":Ce,"--n-bezier":Q,"--n-border-radius":ve,"--n-color":Pe,"--n-option-font-size":ge,"--n-group-header-text-color":De,"--n-option-check-color":he,"--n-option-color-pending":se,"--n-option-color-active":Re,"--n-option-color-active-pending":W,"--n-option-height":Le,"--n-option-opacity-disabled":lt,"--n-option-text-color":et,"--n-option-text-color-active":de,"--n-option-text-color-disabled":ze,"--n-option-text-color-pressed":Ne,"--n-option-padding":Ve,"--n-option-padding-left":Fm(Ve,"left"),"--n-option-padding-right":Fm(Ve,"right"),"--n-loading-color":He,"--n-loading-size":Y}}),{inlineThemeDisabled:H}=n,U=H?Ag("internal-select-menu",te(()=>n.size[0]),L,n):void 0,$={selfRef:s,next:F,prev:G,getPendingTmNode:b};return HZ(s,n.onResize),Object.assign({mergedTheme:r,mergedClsPrefix:e,rtlEnabled:i,virtualListRef:o,scrollbarRef:a,itemSize:p,padding:g,flattenedNodes:l,empty:v,virtualListContainer(){const{value:j}=o;return j==null?void 0:j.listElRef},virtualListContent(){const{value:j}=o;return j==null?void 0:j.itemsElRef},doScroll:y,handleFocusin:P,handleFocusout:k,handleKeyUp:x,handleKeyDown:T,handleMouseDown:O,handleVirtualListResize:w,handleVirtualListScroll:A,cssVars:H?void 0:L,themeClass:U==null?void 0:U.themeClass,onRender:U==null?void 0:U.onRender},$)},render(){const{$slots:n,virtualScroll:e,clsPrefix:t,mergedTheme:i,themeClass:r,onRender:s}=this;return s==null||s(),Ue("div",{ref:"selfRef",tabindex:this.focusable?0:-1,class:[`${t}-base-select-menu`,this.rtlEnabled&&`${t}-base-select-menu--rtl`,r,this.multiple&&`${t}-base-select-menu--multiple`],style:this.cssVars,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeyup:this.handleKeyUp,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},Pp(n.header,o=>o&&Ue("div",{class:`${t}-base-select-menu__header`,"data-header":!0,key:"header"},o)),this.loading?Ue("div",{class:`${t}-base-select-menu__loading`},Ue(jZ,{clsPrefix:t,strokeWidth:20})):this.empty?Ue("div",{class:`${t}-base-select-menu__empty`,"data-empty":!0},yN(n.empty,()=>[Ue(Ent,{theme:i.peers.Empty,themeOverrides:i.peerOverrides.Empty})])):Ue(Rnt,{ref:"scrollbarRef",theme:i.peers.Scrollbar,themeOverrides:i.peerOverrides.Scrollbar,scrollable:this.scrollable,container:e?this.virtualListContainer:void 0,content:e?this.virtualListContent:void 0,onScroll:e?void 0:this.doScroll},{default:()=>e?Ue(Att,{ref:"virtualListRef",class:`${t}-virtual-list`,items:this.flattenedNodes,itemSize:this.itemSize,showScrollbar:!1,paddingTop:this.padding.top,paddingBottom:this.padding.bottom,onResize:this.handleVirtualListResize,onScroll:this.handleVirtualListScroll,itemResizable:!0},{default:({item:o})=>o.isGroup?Ue(M$,{key:o.key,clsPrefix:t,tmNode:o}):o.ignored?null:Ue(P$,{clsPrefix:t,key:o.key,tmNode:o})}):Ue("div",{class:`${t}-base-select-menu-option-wrapper`,style:{paddingTop:this.padding.top,paddingBottom:this.padding.bottom}},this.flattenedNodes.map(o=>o.isGroup?Ue(M$,{key:o.key,clsPrefix:t,tmNode:o}):Ue(P$,{clsPrefix:t,key:o.key,tmNode:o})))}),Pp(n.action,o=>o&&[Ue("div",{class:`${t}-base-select-menu__action`,"data-action":!0,key:"action"},o),Ue(Vtt,{onFocus:this.onTabOut,key:"focus-detector"})]))}}),Unt={space:"6px",spaceArrow:"10px",arrowOffset:"10px",arrowOffsetVertical:"10px",arrowHeight:"6px",padding:"8px 14px"},Gnt=n=>{const{boxShadow2:e,popoverColor:t,textColor2:i,borderRadius:r,fontSize:s,dividerColor:o}=n;return Object.assign(Object.assign({},Unt),{fontSize:s,borderRadius:r,color:t,dividerColor:o,textColor:i,boxShadow:e})},Hnt={name:"Popover",common:bg,self:Gnt},tee=Hnt,BP={top:"bottom",bottom:"top",left:"right",right:"left"},zr="var(--n-arrow-height) * 1.414",Vnt=Ut([nn("popover",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 position: relative;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 box-shadow: var(--n-box-shadow);
 word-break: break-word;
 `,[Ut(">",[nn("scrollbar",`
 height: inherit;
 max-height: inherit;
 `)]),jl("raw",`
 background-color: var(--n-color);
 border-radius: var(--n-border-radius);
 `,[jl("scrollable",[jl("show-header-or-footer","padding: var(--n-padding);")])]),ln("header",`
 padding: var(--n-padding);
 border-bottom: 1px solid var(--n-divider-color);
 transition: border-color .3s var(--n-bezier);
 `),ln("footer",`
 padding: var(--n-padding);
 border-top: 1px solid var(--n-divider-color);
 transition: border-color .3s var(--n-bezier);
 `),Jn("scrollable, show-header-or-footer",[ln("content",`
 padding: var(--n-padding);
 `)])]),nn("popover-shared",`
 transform-origin: inherit;
 `,[nn("popover-arrow-wrapper",`
 position: absolute;
 overflow: hidden;
 pointer-events: none;
 `,[nn("popover-arrow",`
 transition: background-color .3s var(--n-bezier);
 position: absolute;
 display: block;
 width: calc(${zr});
 height: calc(${zr});
 box-shadow: 0 0 8px 0 rgba(0, 0, 0, .12);
 transform: rotate(45deg);
 background-color: var(--n-color);
 pointer-events: all;
 `)]),Ut("&.popover-transition-enter-from, &.popover-transition-leave-to",`
 opacity: 0;
 transform: scale(.85);
 `),Ut("&.popover-transition-enter-to, &.popover-transition-leave-from",`
 transform: scale(1);
 opacity: 1;
 `),Ut("&.popover-transition-enter-active",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .15s var(--n-bezier-ease-out),
 transform .15s var(--n-bezier-ease-out);
 `),Ut("&.popover-transition-leave-active",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .15s var(--n-bezier-ease-in),
 transform .15s var(--n-bezier-ease-in);
 `)]),Sa("top-start",`
 top: calc(${zr} / -2);
 left: calc(${uu("top-start")} - var(--v-offset-left));
 `),Sa("top",`
 top: calc(${zr} / -2);
 transform: translateX(calc(${zr} / -2)) rotate(45deg);
 left: 50%;
 `),Sa("top-end",`
 top: calc(${zr} / -2);
 right: calc(${uu("top-end")} + var(--v-offset-left));
 `),Sa("bottom-start",`
 bottom: calc(${zr} / -2);
 left: calc(${uu("bottom-start")} - var(--v-offset-left));
 `),Sa("bottom",`
 bottom: calc(${zr} / -2);
 transform: translateX(calc(${zr} / -2)) rotate(45deg);
 left: 50%;
 `),Sa("bottom-end",`
 bottom: calc(${zr} / -2);
 right: calc(${uu("bottom-end")} + var(--v-offset-left));
 `),Sa("left-start",`
 left: calc(${zr} / -2);
 top: calc(${uu("left-start")} - var(--v-offset-top));
 `),Sa("left",`
 left: calc(${zr} / -2);
 transform: translateY(calc(${zr} / -2)) rotate(45deg);
 top: 50%;
 `),Sa("left-end",`
 left: calc(${zr} / -2);
 bottom: calc(${uu("left-end")} + var(--v-offset-top));
 `),Sa("right-start",`
 right: calc(${zr} / -2);
 top: calc(${uu("right-start")} - var(--v-offset-top));
 `),Sa("right",`
 right: calc(${zr} / -2);
 transform: translateY(calc(${zr} / -2)) rotate(45deg);
 top: 50%;
 `),Sa("right-end",`
 right: calc(${zr} / -2);
 bottom: calc(${uu("right-end")} + var(--v-offset-top));
 `),...Zi({top:["right-start","left-start"],right:["top-end","bottom-end"],bottom:["right-end","left-end"],left:["top-start","bottom-start"]},(n,e)=>{const t=["right","left"].includes(e),i=t?"width":"height";return n.map(r=>{const s=r.split("-")[1]==="end",a=`calc((${`var(--v-target-${i}, 0px)`} - ${zr}) / 2)`,l=uu(r);return Ut(`[v-placement="${r}"] >`,[nn("popover-shared",[Jn("center-arrow",[nn("popover-arrow",`${e}: calc(max(${a}, ${l}) ${s?"+":"-"} var(--v-offset-${t?"left":"top"}));`)])])])})})]);function uu(n){return["top","bottom"].includes(n.split("-")[0])?"var(--n-arrow-offset)":"var(--n-arrow-offset-vertical)"}function Sa(n,e){const t=n.split("-")[0],i=["top","bottom"].includes(t)?"height: var(--n-space-arrow);":"width: var(--n-space-arrow);";return Ut(`[v-placement="${n}"] >`,[nn("popover-shared",`
 margin-${BP[t]}: var(--n-space);
 `,[Jn("show-arrow",`
 margin-${BP[t]}: var(--n-space-arrow);
 `),Jn("overlap",`
 margin: 0;
 `),det("popover-arrow-wrapper",`
 right: 0;
 left: 0;
 top: 0;
 bottom: 0;
 ${t}: 100%;
 ${BP[t]}: auto;
 ${i}
 `,[nn("popover-arrow",e)])])])}const nee=Object.assign(Object.assign({},ys.props),{to:ah.propTo,show:Boolean,trigger:String,showArrow:Boolean,delay:Number,duration:Number,raw:Boolean,arrowPointToCenter:Boolean,arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],displayDirective:String,x:Number,y:Number,flip:Boolean,overlap:Boolean,placement:String,width:[Number,String],keepAliveOnHover:Boolean,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],internalDeactivateImmediately:Boolean,animated:Boolean,onClickoutside:Function,internalTrapFocus:Boolean,internalOnAfterLeave:Function,minWidth:Number,maxWidth:Number}),znt=({arrowClass:n,arrowStyle:e,arrowWrapperClass:t,arrowWrapperStyle:i,clsPrefix:r})=>Ue("div",{key:"__popover-arrow__",style:i,class:[`${r}-popover-arrow-wrapper`,t]},Ue("div",{class:[`${r}-popover-arrow`,n],style:e})),$nt=Fe({name:"PopoverBody",inheritAttrs:!1,props:nee,setup(n,{slots:e,attrs:t}){const{namespaceRef:i,mergedClsPrefixRef:r,inlineThemeDisabled:s}=Hd(n),o=ys("Popover","-popover",Vnt,tee,n,r),a=ee(null),l=Er("NPopover"),c=ee(null),u=ee(n.show),h=ee(!1);Qv(()=>{const{show:C}=n;C&&!fet()&&!n.internalDeactivateImmediately&&(h.value=!0)});const d=te(()=>{const{trigger:C,onClickoutside:I}=n,x=[],{positionManuallyRef:{value:T}}=l;return T||(C==="click"&&!I&&x.push([CE,A,void 0,{capture:!0}]),C==="hover"&&x.push([ket,y])),I&&x.push([CE,A,void 0,{capture:!0}]),(n.displayDirective==="show"||n.animated&&h.value)&&x.push([c6,n.show]),x}),f=te(()=>{const C=n.width==="trigger"?void 0:EP(n.width),I=[];C&&I.push({width:C});const{maxWidth:x,minWidth:T}=n;return x&&I.push({maxWidth:EP(x)}),T&&I.push({maxWidth:EP(T)}),s||I.push(p.value),I}),p=te(()=>{const{common:{cubicBezierEaseInOut:C,cubicBezierEaseIn:I,cubicBezierEaseOut:x},self:{space:T,spaceArrow:O,padding:F,fontSize:G,textColor:B,dividerColor:R,color:P,boxShadow:k,borderRadius:L,arrowHeight:H,arrowOffset:U,arrowOffsetVertical:$}}=o.value;return{"--n-box-shadow":k,"--n-bezier":C,"--n-bezier-ease-in":I,"--n-bezier-ease-out":x,"--n-font-size":G,"--n-text-color":B,"--n-color":P,"--n-divider-color":R,"--n-border-radius":L,"--n-arrow-height":H,"--n-arrow-offset":U,"--n-arrow-offset-vertical":$,"--n-padding":F,"--n-space":T,"--n-space-arrow":O}}),g=s?Ag("popover",void 0,p,n):void 0;l.setBodyInstance({syncPosition:m}),qo(()=>{l.setBodyInstance(null)}),yt(ri(n,"show"),C=>{n.animated||(C?u.value=!0:u.value=!1)});function m(){var C;(C=a.value)===null||C===void 0||C.syncPosition()}function v(C){n.trigger==="hover"&&n.keepAliveOnHover&&n.show&&l.handleMouseEnter(C)}function _(C){n.trigger==="hover"&&n.keepAliveOnHover&&l.handleMouseLeave(C)}function y(C){n.trigger==="hover"&&!w().contains(QA(C))&&l.handleMouseMoveOutside(C)}function A(C){(n.trigger==="click"&&!w().contains(QA(C))||n.onClickoutside)&&l.handleClickOutside(C)}function w(){return l.getTriggerElement()}ju(wZ,c),ju(bZ,null),ju(AZ,null);function b(){if(g==null||g.onRender(),!(n.displayDirective==="show"||n.show||n.animated&&h.value))return null;let I;const x=l.internalRenderBodyRef.value,{value:T}=r;if(x)I=x([`${T}-popover-shared`,g==null?void 0:g.themeClass.value,n.overlap&&`${T}-popover-shared--overlap`,n.showArrow&&`${T}-popover-shared--show-arrow`,n.arrowPointToCenter&&`${T}-popover-shared--center-arrow`],c,f.value,v,_);else{const{value:O}=l.extraClassRef,{internalTrapFocus:F}=n,G=!e$(e.header)||!e$(e.footer),B=()=>{var R,P;const k=G?Ue(vt,null,Pp(e.header,U=>U?Ue("div",{class:[`${T}-popover__header`,n.headerClass],style:n.headerStyle},U):null),Pp(e.default,U=>U?Ue("div",{class:[`${T}-popover__content`,n.contentClass],style:n.contentStyle},e):null),Pp(e.footer,U=>U?Ue("div",{class:[`${T}-popover__footer`,n.footerClass],style:n.footerStyle},U):null)):n.scrollable?(R=e.default)===null||R===void 0?void 0:R.call(e):Ue("div",{class:[`${T}-popover__content`,n.contentClass],style:n.contentStyle},e),L=n.scrollable?Ue(Dnt,{contentClass:G?void 0:`${T}-popover__content ${(P=n.contentClass)!==null&&P!==void 0?P:""}`,contentStyle:G?void 0:n.contentStyle},{default:()=>k}):k,H=n.showArrow?znt({arrowClass:n.arrowClass,arrowStyle:n.arrowStyle,arrowWrapperClass:n.arrowWrapperClass,arrowWrapperStyle:n.arrowWrapperStyle,clsPrefix:T}):null;return[L,H]};I=Ue("div",ht({class:[`${T}-popover`,`${T}-popover-shared`,g==null?void 0:g.themeClass.value,O.map(R=>`${T}-${R}`),{[`${T}-popover--scrollable`]:n.scrollable,[`${T}-popover--show-header-or-footer`]:G,[`${T}-popover--raw`]:n.raw,[`${T}-popover-shared--overlap`]:n.overlap,[`${T}-popover-shared--show-arrow`]:n.showArrow,[`${T}-popover-shared--center-arrow`]:n.arrowPointToCenter}],ref:c,style:f.value,onKeydown:l.handleKeydown,onMouseenter:v,onMouseleave:_},t),F?Ue(xtt,{active:n.show,autoFocus:!0},{default:B}):B())}return tg(I,d.value)}return{displayed:h,namespace:i,isMounted:l.isMountedRef,zIndex:l.zIndexRef,followerRef:a,adjustedTo:ah(n),followerEnabled:u,renderContentNode:b}},render(){return Ue(MZ,{ref:"followerRef",zIndex:this.zIndex,show:this.show,enabled:this.followerEnabled,to:this.adjustedTo,x:this.x,y:this.y,flip:this.flip,placement:this.placement,containerClass:this.namespace,overlap:this.overlap,width:this.width==="trigger"?"target":void 0,teleportDisabled:this.adjustedTo===ah.tdkey},{default:()=>this.animated?Ue(dv,{name:"popover-transition",appear:this.isMounted,onEnter:()=>{this.followerEnabled=!0},onAfterLeave:()=>{var n;(n=this.internalOnAfterLeave)===null||n===void 0||n.call(this),this.followerEnabled=!1,this.displayed=!1}},{default:this.renderContentNode}):this.renderContentNode()})}}),Wnt=Object.keys(nee),jnt={focus:["onFocus","onBlur"],click:["onClick"],hover:["onMouseenter","onMouseleave"],manual:[],nested:["onFocus","onBlur","onMouseenter","onMouseleave","onClick"]};function Qnt(n,e,t){jnt[e].forEach(i=>{n.props?n.props=Object.assign({},n.props):n.props={};const r=n.props[i],s=t[i];r?n.props[i]=(...o)=>{r(...o),s(...o)}:n.props[i]=s})}const Xnt={show:{type:Boolean,default:void 0},defaultShow:Boolean,showArrow:{type:Boolean,default:!0},trigger:{type:String,default:"hover"},delay:{type:Number,default:100},duration:{type:Number,default:100},raw:Boolean,placement:{type:String,default:"top"},x:Number,y:Number,arrowPointToCenter:Boolean,disabled:Boolean,getDisabled:Function,displayDirective:{type:String,default:"if"},arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],flip:{type:Boolean,default:!0},animated:{type:Boolean,default:!0},width:{type:[Number,String],default:void 0},overlap:Boolean,keepAliveOnHover:{type:Boolean,default:!0},zIndex:Number,to:ah.propTo,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],onClickoutside:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],internalDeactivateImmediately:Boolean,internalSyncTargetWithParent:Boolean,internalInheritedEventHandlers:{type:Array,default:()=>[]},internalTrapFocus:Boolean,internalExtraClass:{type:Array,default:()=>[]},onShow:[Function,Array],onHide:[Function,Array],arrow:{type:Boolean,default:void 0},minWidth:Number,maxWidth:Number},Ynt=Object.assign(Object.assign(Object.assign({},ys.props),Xnt),{internalOnAfterLeave:Function,internalRenderBody:Function}),qnt=Fe({name:"Popover",inheritAttrs:!1,props:Ynt,__popover__:!0,setup(n){const e=HI(),t=ee(null),i=te(()=>n.show),r=ee(n.defaultShow),s=Wk(i,r),o=th(()=>n.disabled?!1:s.value),a=()=>{if(n.disabled)return!0;const{getDisabled:R}=n;return!!(R!=null&&R())},l=()=>a()?!1:s.value,c=_Z(n,["arrow","showArrow"]),u=te(()=>n.overlap?!1:c.value);let h=null;const d=ee(null),f=ee(null),p=th(()=>n.x!==void 0&&n.y!==void 0);function g(R){const{"onUpdate:show":P,onUpdateShow:k,onShow:L,onHide:H}=n;r.value=R,P&&qs(P,R),k&&qs(k,R),R&&L&&qs(L,!0),R&&H&&qs(H,!1)}function m(){h&&h.syncPosition()}function v(){const{value:R}=d;R&&(window.clearTimeout(R),d.value=null)}function _(){const{value:R}=f;R&&(window.clearTimeout(R),f.value=null)}function y(){const R=a();if(n.trigger==="focus"&&!R){if(l())return;g(!0)}}function A(){const R=a();if(n.trigger==="focus"&&!R){if(!l())return;g(!1)}}function w(){const R=a();if(n.trigger==="hover"&&!R){if(_(),d.value!==null||l())return;const P=()=>{g(!0),d.value=null},{delay:k}=n;k===0?P():d.value=window.setTimeout(P,k)}}function b(){const R=a();if(n.trigger==="hover"&&!R){if(v(),f.value!==null||!l())return;const P=()=>{g(!1),f.value=null},{duration:k}=n;k===0?P():f.value=window.setTimeout(P,k)}}function C(){b()}function I(R){var P;l()&&(n.trigger==="click"&&(v(),_(),g(!1)),(P=n.onClickoutside)===null||P===void 0||P.call(n,R))}function x(){if(n.trigger==="click"&&!a()){v(),_();const R=!l();g(R)}}function T(R){n.internalTrapFocus&&R.key==="Escape"&&(v(),_(),g(!1))}function O(R){r.value=R}function F(){var R;return(R=t.value)===null||R===void 0?void 0:R.targetRef}function G(R){h=R}return ju("NPopover",{getTriggerElement:F,handleKeydown:T,handleMouseEnter:w,handleMouseLeave:b,handleClickOutside:I,handleMouseMoveOutside:C,setBodyInstance:G,positionManuallyRef:p,isMountedRef:e,zIndexRef:ri(n,"zIndex"),extraClassRef:ri(n,"internalExtraClass"),internalRenderBodyRef:ri(n,"internalRenderBody")}),Qv(()=>{s.value&&a()&&g(!1)}),{binderInstRef:t,positionManually:p,mergedShowConsideringDisabledProp:o,uncontrolledShow:r,mergedShowArrow:u,getMergedShow:l,setShow:O,handleClick:x,handleMouseEnter:w,handleMouseLeave:b,handleFocus:y,handleBlur:A,syncPosition:m}},render(){var n;const{positionManually:e,$slots:t}=this;let i,r=!1;if(!e&&(t.activator?i=Z5(t,"activator"):i=Z5(t,"trigger"),i)){i=Qee(i),i=i.type===Xee?Ue("span",[i]):i;const s={onClick:this.handleClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onFocus:this.handleFocus,onBlur:this.handleBlur};if(!((n=i.type)===null||n===void 0)&&n.__popover__)r=!0,i.props||(i.props={internalSyncTargetWithParent:!0,internalInheritedEventHandlers:[]}),i.props.internalSyncTargetWithParent=!0,i.props.internalInheritedEventHandlers?i.props.internalInheritedEventHandlers=[s,...i.props.internalInheritedEventHandlers]:i.props.internalInheritedEventHandlers=[s];else{const{internalInheritedEventHandlers:o}=this,a=[s,...o],l={onBlur:c=>{a.forEach(u=>{u.onBlur(c)})},onFocus:c=>{a.forEach(u=>{u.onFocus(c)})},onClick:c=>{a.forEach(u=>{u.onClick(c)})},onMouseenter:c=>{a.forEach(u=>{u.onMouseenter(c)})},onMouseleave:c=>{a.forEach(u=>{u.onMouseleave(c)})}};Qnt(i,o?"nested":e?"manual":this.trigger,l)}}return Ue(TZ,{ref:"binderInstRef",syncTarget:!r,syncTargetWithParent:this.internalSyncTargetWithParent},{default:()=>{this.mergedShowConsideringDisabledProp;const s=this.getMergedShow();return[this.internalTrapFocus&&s?tg(Ue("div",{style:{position:"fixed",inset:0}}),[[SZ,{enabled:s,zIndex:this.zIndex}]]):null,e?null:Ue(IZ,null,{default:()=>i}),Ue($nt,GZe(this.$props,Wnt,Object.assign(Object.assign({},this.$attrs),{showArrow:this.mergedShowArrow,show:s})),{default:()=>{var o,a;return(a=(o=this.$slots).default)===null||a===void 0?void 0:a.call(o)},header:()=>{var o,a;return(a=(o=this.$slots).header)===null||a===void 0?void 0:a.call(o)},footer:()=>{var o,a;return(a=(o=this.$slots).footer)===null||a===void 0?void 0:a.call(o)}})]}})}}),Knt={closeIconSizeTiny:"12px",closeIconSizeSmall:"12px",closeIconSizeMedium:"14px",closeIconSizeLarge:"14px",closeSizeTiny:"16px",closeSizeSmall:"16px",closeSizeMedium:"18px",closeSizeLarge:"18px",padding:"0 7px",closeMargin:"0 0 0 4px"},Jnt=n=>{const{textColor2:e,primaryColorHover:t,primaryColorPressed:i,primaryColor:r,infoColor:s,successColor:o,warningColor:a,errorColor:l,baseColor:c,borderColor:u,opacityDisabled:h,tagColor:d,closeIconColor:f,closeIconColorHover:p,closeIconColorPressed:g,borderRadiusSmall:m,fontSizeMini:v,fontSizeTiny:_,fontSizeSmall:y,fontSizeMedium:A,heightMini:w,heightTiny:b,heightSmall:C,heightMedium:I,closeColorHover:x,closeColorPressed:T,buttonColor2Hover:O,buttonColor2Pressed:F,fontWeightStrong:G}=n;return Object.assign(Object.assign({},Knt),{closeBorderRadius:m,heightTiny:w,heightSmall:b,heightMedium:C,heightLarge:I,borderRadius:m,opacityDisabled:h,fontSizeTiny:v,fontSizeSmall:_,fontSizeMedium:y,fontSizeLarge:A,fontWeightStrong:G,textColorCheckable:e,textColorHoverCheckable:e,textColorPressedCheckable:e,textColorChecked:c,colorCheckable:"#0000",colorHoverCheckable:O,colorPressedCheckable:F,colorChecked:r,colorCheckedHover:t,colorCheckedPressed:i,border:`1px solid ${u}`,textColor:e,color:d,colorBordered:"rgb(250, 250, 252)",closeIconColor:f,closeIconColorHover:p,closeIconColorPressed:g,closeColorHover:x,closeColorPressed:T,borderPrimary:`1px solid ${Kn(r,{alpha:.3})}`,textColorPrimary:r,colorPrimary:Kn(r,{alpha:.12}),colorBorderedPrimary:Kn(r,{alpha:.1}),closeIconColorPrimary:r,closeIconColorHoverPrimary:r,closeIconColorPressedPrimary:r,closeColorHoverPrimary:Kn(r,{alpha:.12}),closeColorPressedPrimary:Kn(r,{alpha:.18}),borderInfo:`1px solid ${Kn(s,{alpha:.3})}`,textColorInfo:s,colorInfo:Kn(s,{alpha:.12}),colorBorderedInfo:Kn(s,{alpha:.1}),closeIconColorInfo:s,closeIconColorHoverInfo:s,closeIconColorPressedInfo:s,closeColorHoverInfo:Kn(s,{alpha:.12}),closeColorPressedInfo:Kn(s,{alpha:.18}),borderSuccess:`1px solid ${Kn(o,{alpha:.3})}`,textColorSuccess:o,colorSuccess:Kn(o,{alpha:.12}),colorBorderedSuccess:Kn(o,{alpha:.1}),closeIconColorSuccess:o,closeIconColorHoverSuccess:o,closeIconColorPressedSuccess:o,closeColorHoverSuccess:Kn(o,{alpha:.12}),closeColorPressedSuccess:Kn(o,{alpha:.18}),borderWarning:`1px solid ${Kn(a,{alpha:.35})}`,textColorWarning:a,colorWarning:Kn(a,{alpha:.15}),colorBorderedWarning:Kn(a,{alpha:.12}),closeIconColorWarning:a,closeIconColorHoverWarning:a,closeIconColorPressedWarning:a,closeColorHoverWarning:Kn(a,{alpha:.12}),closeColorPressedWarning:Kn(a,{alpha:.18}),borderError:`1px solid ${Kn(l,{alpha:.23})}`,textColorError:l,colorError:Kn(l,{alpha:.1}),colorBorderedError:Kn(l,{alpha:.08}),closeIconColorError:l,closeIconColorHoverError:l,closeIconColorPressedError:l,closeColorHoverError:Kn(l,{alpha:.12}),closeColorPressedError:Kn(l,{alpha:.18})})},Znt={name:"Tag",common:bg,self:Jnt},eit=Znt,tit={color:Object,type:{type:String,default:"default"},round:Boolean,size:{type:String,default:"medium"},closable:Boolean,disabled:{type:Boolean,default:void 0}},nit=nn("tag",`
 --n-close-margin: var(--n-close-margin-top) var(--n-close-margin-right) var(--n-close-margin-bottom) var(--n-close-margin-left);
 white-space: nowrap;
 position: relative;
 box-sizing: border-box;
 cursor: default;
 display: inline-flex;
 align-items: center;
 flex-wrap: nowrap;
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 color: var(--n-text-color);
 background-color: var(--n-color);
 transition: 
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 line-height: 1;
 height: var(--n-height);
 font-size: var(--n-font-size);
`,[Jn("strong",`
 font-weight: var(--n-font-weight-strong);
 `),ln("border",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 border: var(--n-border);
 transition: border-color .3s var(--n-bezier);
 `),ln("icon",`
 display: flex;
 margin: 0 4px 0 0;
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 font-size: var(--n-avatar-size-override);
 `),ln("avatar",`
 display: flex;
 margin: 0 6px 0 0;
 `),ln("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),Jn("round",`
 padding: 0 calc(var(--n-height) / 3);
 border-radius: calc(var(--n-height) / 2);
 `,[ln("icon",`
 margin: 0 4px 0 calc((var(--n-height) - 8px) / -2);
 `),ln("avatar",`
 margin: 0 6px 0 calc((var(--n-height) - 8px) / -2);
 `),Jn("closable",`
 padding: 0 calc(var(--n-height) / 4) 0 calc(var(--n-height) / 3);
 `)]),Jn("icon, avatar",[Jn("round",`
 padding: 0 calc(var(--n-height) / 3) 0 calc(var(--n-height) / 2);
 `)]),Jn("disabled",`
 cursor: not-allowed !important;
 opacity: var(--n-opacity-disabled);
 `),Jn("checkable",`
 cursor: pointer;
 box-shadow: none;
 color: var(--n-text-color-checkable);
 background-color: var(--n-color-checkable);
 `,[jl("disabled",[Ut("&:hover","background-color: var(--n-color-hover-checkable);",[jl("checked","color: var(--n-text-color-hover-checkable);")]),Ut("&:active","background-color: var(--n-color-pressed-checkable);",[jl("checked","color: var(--n-text-color-pressed-checkable);")])]),Jn("checked",`
 color: var(--n-text-color-checked);
 background-color: var(--n-color-checked);
 `,[jl("disabled",[Ut("&:hover","background-color: var(--n-color-checked-hover);"),Ut("&:active","background-color: var(--n-color-checked-pressed);")])])])]),iit=Object.assign(Object.assign(Object.assign({},ys.props),tit),{bordered:{type:Boolean,default:void 0},checked:Boolean,checkable:Boolean,strong:Boolean,triggerClickOnClose:Boolean,onClose:[Array,Function],onMouseenter:Function,onMouseleave:Function,"onUpdate:checked":Function,onUpdateChecked:Function,internalCloseFocusable:{type:Boolean,default:!0},internalCloseIsButtonTag:{type:Boolean,default:!0},onCheckedChange:Function}),rit="n-tag",FP=Fe({name:"Tag",props:iit,setup(n){const e=ee(null),{mergedBorderedRef:t,mergedClsPrefixRef:i,inlineThemeDisabled:r,mergedRtlRef:s}=Hd(n),o=ys("Tag","-tag",nit,eit,n,i);ju(rit,{roundRef:ri(n,"round")});function a(f){if(!n.disabled&&n.checkable){const{checked:p,onCheckedChange:g,onUpdateChecked:m,"onUpdate:checked":v}=n;m&&m(!p),v&&v(!p),g&&g(!p)}}function l(f){if(n.triggerClickOnClose||f.stopPropagation(),!n.disabled){const{onClose:p}=n;p&&qs(p,f)}}const c={setTextContent(f){const{value:p}=e;p&&(p.textContent=f)}},u=yb("Tag",s,i),h=te(()=>{const{type:f,size:p,color:{color:g,textColor:m}={}}=n,{common:{cubicBezierEaseInOut:v},self:{padding:_,closeMargin:y,borderRadius:A,opacityDisabled:w,textColorCheckable:b,textColorHoverCheckable:C,textColorPressedCheckable:I,textColorChecked:x,colorCheckable:T,colorHoverCheckable:O,colorPressedCheckable:F,colorChecked:G,colorCheckedHover:B,colorCheckedPressed:R,closeBorderRadius:P,fontWeightStrong:k,[rr("colorBordered",f)]:L,[rr("closeSize",p)]:H,[rr("closeIconSize",p)]:U,[rr("fontSize",p)]:$,[rr("height",p)]:j,[rr("color",f)]:Q,[rr("textColor",f)]:ne,[rr("border",f)]:ve,[rr("closeIconColor",f)]:Pe,[rr("closeIconColorHover",f)]:De,[rr("closeIconColorPressed",f)]:Xe,[rr("closeColorHover",f)]:Ne,[rr("closeColorPressed",f)]:et}}=o.value,ze=Fm(y);return{"--n-font-weight-strong":k,"--n-avatar-size-override":`calc(${j} - 8px)`,"--n-bezier":v,"--n-border-radius":A,"--n-border":ve,"--n-close-icon-size":U,"--n-close-color-pressed":et,"--n-close-color-hover":Ne,"--n-close-border-radius":P,"--n-close-icon-color":Pe,"--n-close-icon-color-hover":De,"--n-close-icon-color-pressed":Xe,"--n-close-icon-color-disabled":Pe,"--n-close-margin-top":ze.top,"--n-close-margin-right":ze.right,"--n-close-margin-bottom":ze.bottom,"--n-close-margin-left":ze.left,"--n-close-size":H,"--n-color":g||(t.value?L:Q),"--n-color-checkable":T,"--n-color-checked":G,"--n-color-checked-hover":B,"--n-color-checked-pressed":R,"--n-color-hover-checkable":O,"--n-color-pressed-checkable":F,"--n-font-size":$,"--n-height":j,"--n-opacity-disabled":w,"--n-padding":_,"--n-text-color":m||ne,"--n-text-color-checkable":b,"--n-text-color-checked":x,"--n-text-color-hover-checkable":C,"--n-text-color-pressed-checkable":I}}),d=r?Ag("tag",te(()=>{let f="";const{type:p,size:g,color:{color:m,textColor:v}={}}=n;return f+=p[0],f+=g[0],m&&(f+=`a${n$(m)}`),v&&(f+=`b${n$(v)}`),t.value&&(f+="c"),f}),h,n):void 0;return Object.assign(Object.assign({},c),{rtlEnabled:u,mergedClsPrefix:i,contentRef:e,mergedBordered:t,handleClick:a,handleCloseClick:l,cssVars:r?void 0:h,themeClass:d==null?void 0:d.themeClass,onRender:d==null?void 0:d.onRender})},render(){var n,e;const{mergedClsPrefix:t,rtlEnabled:i,closable:r,color:{borderColor:s}={},round:o,onRender:a,$slots:l}=this;a==null||a();const c=Pp(l.avatar,h=>h&&Ue("div",{class:`${t}-tag__avatar`},h)),u=Pp(l.icon,h=>h&&Ue("div",{class:`${t}-tag__icon`},h));return Ue("div",{class:[`${t}-tag`,this.themeClass,{[`${t}-tag--rtl`]:i,[`${t}-tag--strong`]:this.strong,[`${t}-tag--disabled`]:this.disabled,[`${t}-tag--checkable`]:this.checkable,[`${t}-tag--checked`]:this.checkable&&this.checked,[`${t}-tag--round`]:o,[`${t}-tag--avatar`]:c,[`${t}-tag--icon`]:u,[`${t}-tag--closable`]:r}],style:this.cssVars,onClick:this.handleClick,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},u||c,Ue("span",{class:`${t}-tag__content`,ref:"contentRef"},(e=(n=this.$slots).default)===null||e===void 0?void 0:e.call(n)),!this.checkable&&r?Ue(Htt,{clsPrefix:t,class:`${t}-tag__close`,disabled:this.disabled,onClick:this.handleCloseClick,focusable:this.internalCloseFocusable,round:o,isButtonTag:this.internalCloseIsButtonTag,absolute:!0}):null,!this.checkable&&this.mergedBordered?Ue("div",{class:`${t}-tag__border`,style:{borderColor:s}}):null)}}),sit=nn("base-clear",`
 flex-shrink: 0;
 height: 1em;
 width: 1em;
 position: relative;
`,[Ut(">",[ln("clear",`
 font-size: var(--n-clear-size);
 height: 1em;
 width: 1em;
 cursor: pointer;
 color: var(--n-clear-color);
 transition: color .3s var(--n-bezier);
 display: flex;
 `,[Ut("&:hover",`
 color: var(--n-clear-color-hover)!important;
 `),Ut("&:active",`
 color: var(--n-clear-color-pressed)!important;
 `)]),ln("placeholder",`
 display: flex;
 `),ln("clear, placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[Yk({originalTransform:"translateX(-50%) translateY(-50%)",left:"50%",top:"50%"})])])]),oit=Fe({name:"BaseClear",props:{clsPrefix:{type:String,required:!0},show:Boolean,onClear:Function},setup(n){return VI("-base-clear",sit,ri(n,"clsPrefix")),{handleMouseDown(e){e.preventDefault()}}},render(){const{clsPrefix:n}=this;return Ue("div",{class:`${n}-base-clear`},Ue(WZ,null,{default:()=>{var e,t;return this.show?Ue("div",{key:"dismiss",class:`${n}-base-clear__clear`,onClick:this.onClear,onMousedown:this.handleMouseDown,"data-clear":!0},yN(this.$slots.icon,()=>[Ue(Ab,{clsPrefix:n},{default:()=>Ue(Ftt,null)})])):Ue("div",{key:"icon",class:`${n}-base-clear__placeholder`},(t=(e=this.$slots).placeholder)===null||t===void 0?void 0:t.call(e))}}))}}),ait=Fe({name:"InternalSelectionSuffix",props:{clsPrefix:{type:String,required:!0},showArrow:{type:Boolean,default:void 0},showClear:{type:Boolean,default:void 0},loading:{type:Boolean,default:!1},onClear:Function},setup(n,{slots:e}){return()=>{const{clsPrefix:t}=n;return Ue(jZ,{clsPrefix:t,class:`${t}-base-suffix`,strokeWidth:24,scale:.85,show:n.loading},{default:()=>n.showArrow?Ue(oit,{clsPrefix:t,show:n.showClear,onClear:n.onClear},{placeholder:()=>Ue(Ab,{clsPrefix:t,class:`${t}-base-suffix__arrow`},{default:()=>yN(e.default,()=>[Ue(Btt,null)])})}):null})}}}),lit={paddingSingle:"0 26px 0 12px",paddingMultiple:"3px 26px 0 12px",clearSize:"16px",arrowSize:"16px"},cit=n=>{const{borderRadius:e,textColor2:t,textColorDisabled:i,inputColor:r,inputColorDisabled:s,primaryColor:o,primaryColorHover:a,warningColor:l,warningColorHover:c,errorColor:u,errorColorHover:h,borderColor:d,iconColor:f,iconColorDisabled:p,clearColor:g,clearColorHover:m,clearColorPressed:v,placeholderColor:_,placeholderColorDisabled:y,fontSizeTiny:A,fontSizeSmall:w,fontSizeMedium:b,fontSizeLarge:C,heightTiny:I,heightSmall:x,heightMedium:T,heightLarge:O}=n;return Object.assign(Object.assign({},lit),{fontSizeTiny:A,fontSizeSmall:w,fontSizeMedium:b,fontSizeLarge:C,heightTiny:I,heightSmall:x,heightMedium:T,heightLarge:O,borderRadius:e,textColor:t,textColorDisabled:i,placeholderColor:_,placeholderColorDisabled:y,color:r,colorDisabled:s,colorActive:r,border:`1px solid ${d}`,borderHover:`1px solid ${a}`,borderActive:`1px solid ${o}`,borderFocus:`1px solid ${a}`,boxShadowHover:"none",boxShadowActive:`0 0 0 2px ${Kn(o,{alpha:.2})}`,boxShadowFocus:`0 0 0 2px ${Kn(o,{alpha:.2})}`,caretColor:o,arrowColor:f,arrowColorDisabled:p,loadingColor:o,borderWarning:`1px solid ${l}`,borderHoverWarning:`1px solid ${c}`,borderActiveWarning:`1px solid ${l}`,borderFocusWarning:`1px solid ${c}`,boxShadowHoverWarning:"none",boxShadowActiveWarning:`0 0 0 2px ${Kn(l,{alpha:.2})}`,boxShadowFocusWarning:`0 0 0 2px ${Kn(l,{alpha:.2})}`,colorActiveWarning:r,caretColorWarning:l,borderError:`1px solid ${u}`,borderHoverError:`1px solid ${h}`,borderActiveError:`1px solid ${u}`,borderFocusError:`1px solid ${h}`,boxShadowHoverError:"none",boxShadowActiveError:`0 0 0 2px ${Kn(u,{alpha:.2})}`,boxShadowFocusError:`0 0 0 2px ${Kn(u,{alpha:.2})}`,colorActiveError:r,caretColorError:u,clearColor:g,clearColorHover:m,clearColorPressed:v})},uit={name:"InternalSelection",common:bg,peers:{Popover:tee},self:cit},iee=uit,hit=Ut([nn("base-selection",`
 --n-padding-single: var(--n-padding-single-top) var(--n-padding-single-right) var(--n-padding-single-bottom) var(--n-padding-single-left);
 --n-padding-multiple: var(--n-padding-multiple-top) var(--n-padding-multiple-right) var(--n-padding-multiple-bottom) var(--n-padding-multiple-left);
 position: relative;
 z-index: auto;
 box-shadow: none;
 width: 100%;
 max-width: 100%;
 display: inline-block;
 vertical-align: bottom;
 border-radius: var(--n-border-radius);
 min-height: var(--n-height);
 line-height: 1.5;
 font-size: var(--n-font-size);
 `,[nn("base-loading",`
 color: var(--n-loading-color);
 `),nn("base-selection-tags","min-height: var(--n-height);"),ln("border, state-border",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border: var(--n-border);
 border-radius: inherit;
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),ln("state-border",`
 z-index: 1;
 border-color: #0000;
 `),nn("base-suffix",`
 cursor: pointer;
 position: absolute;
 top: 50%;
 transform: translateY(-50%);
 right: 10px;
 `,[ln("arrow",`
 font-size: var(--n-arrow-size);
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 `)]),nn("base-selection-overlay",`
 display: flex;
 align-items: center;
 white-space: nowrap;
 pointer-events: none;
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 padding: var(--n-padding-single);
 transition: color .3s var(--n-bezier);
 `,[ln("wrapper",`
 flex-basis: 0;
 flex-grow: 1;
 overflow: hidden;
 text-overflow: ellipsis;
 `)]),nn("base-selection-placeholder",`
 color: var(--n-placeholder-color);
 `,[ln("inner",`
 max-width: 100%;
 overflow: hidden;
 `)]),nn("base-selection-tags",`
 cursor: pointer;
 outline: none;
 box-sizing: border-box;
 position: relative;
 z-index: auto;
 display: flex;
 padding: var(--n-padding-multiple);
 flex-wrap: wrap;
 align-items: center;
 width: 100%;
 vertical-align: bottom;
 background-color: var(--n-color);
 border-radius: inherit;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),nn("base-selection-label",`
 height: var(--n-height);
 display: inline-flex;
 width: 100%;
 vertical-align: bottom;
 cursor: pointer;
 outline: none;
 z-index: auto;
 box-sizing: border-box;
 position: relative;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: inherit;
 background-color: var(--n-color);
 align-items: center;
 `,[nn("base-selection-input",`
 font-size: inherit;
 line-height: inherit;
 outline: none;
 cursor: pointer;
 box-sizing: border-box;
 border:none;
 width: 100%;
 padding: var(--n-padding-single);
 background-color: #0000;
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 caret-color: var(--n-caret-color);
 `,[ln("content",`
 text-overflow: ellipsis;
 overflow: hidden;
 white-space: nowrap; 
 `)]),ln("render-label",`
 color: var(--n-text-color);
 `)]),jl("disabled",[Ut("&:hover",[ln("state-border",`
 box-shadow: var(--n-box-shadow-hover);
 border: var(--n-border-hover);
 `)]),Jn("focus",[ln("state-border",`
 box-shadow: var(--n-box-shadow-focus);
 border: var(--n-border-focus);
 `)]),Jn("active",[ln("state-border",`
 box-shadow: var(--n-box-shadow-active);
 border: var(--n-border-active);
 `),nn("base-selection-label","background-color: var(--n-color-active);"),nn("base-selection-tags","background-color: var(--n-color-active);")])]),Jn("disabled","cursor: not-allowed;",[ln("arrow",`
 color: var(--n-arrow-color-disabled);
 `),nn("base-selection-label",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[nn("base-selection-input",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 `),ln("render-label",`
 color: var(--n-text-color-disabled);
 `)]),nn("base-selection-tags",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `),nn("base-selection-placeholder",`
 cursor: not-allowed;
 color: var(--n-placeholder-color-disabled);
 `)]),nn("base-selection-input-tag",`
 height: calc(var(--n-height) - 6px);
 line-height: calc(var(--n-height) - 6px);
 outline: none;
 display: none;
 position: relative;
 margin-bottom: 3px;
 max-width: 100%;
 vertical-align: bottom;
 `,[ln("input",`
 font-size: inherit;
 font-family: inherit;
 min-width: 1px;
 padding: 0;
 background-color: #0000;
 outline: none;
 border: none;
 max-width: 100%;
 overflow: hidden;
 width: 1em;
 line-height: inherit;
 cursor: pointer;
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 `),ln("mirror",`
 position: absolute;
 left: 0;
 top: 0;
 white-space: pre;
 visibility: hidden;
 user-select: none;
 -webkit-user-select: none;
 opacity: 0;
 `)]),["warning","error"].map(n=>Jn(`${n}-status`,[ln("state-border",`border: var(--n-border-${n});`),jl("disabled",[Ut("&:hover",[ln("state-border",`
 box-shadow: var(--n-box-shadow-hover-${n});
 border: var(--n-border-hover-${n});
 `)]),Jn("active",[ln("state-border",`
 box-shadow: var(--n-box-shadow-active-${n});
 border: var(--n-border-active-${n});
 `),nn("base-selection-label",`background-color: var(--n-color-active-${n});`),nn("base-selection-tags",`background-color: var(--n-color-active-${n});`)]),Jn("focus",[ln("state-border",`
 box-shadow: var(--n-box-shadow-focus-${n});
 border: var(--n-border-focus-${n});
 `)])])]))]),nn("base-selection-popover",`
 margin-bottom: -3px;
 display: flex;
 flex-wrap: wrap;
 margin-right: -8px;
 `),nn("base-selection-tag-wrapper",`
 max-width: 100%;
 display: inline-flex;
 padding: 0 7px 3px 0;
 `,[Ut("&:last-child","padding-right: 0;"),nn("tag",`
 font-size: 14px;
 max-width: 100%;
 `,[ln("content",`
 line-height: 1.25;
 text-overflow: ellipsis;
 overflow: hidden;
 `)])])]),dit=Fe({name:"InternalSelection",props:Object.assign(Object.assign({},ys.props),{clsPrefix:{type:String,required:!0},bordered:{type:Boolean,default:void 0},active:Boolean,pattern:{type:String,default:""},placeholder:String,selectedOption:{type:Object,default:null},selectedOptions:{type:Array,default:null},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},multiple:Boolean,filterable:Boolean,clearable:Boolean,disabled:Boolean,size:{type:String,default:"medium"},loading:Boolean,autofocus:Boolean,showArrow:{type:Boolean,default:!0},inputProps:Object,focused:Boolean,renderTag:Function,onKeydown:Function,onClick:Function,onBlur:Function,onFocus:Function,onDeleteOption:Function,maxTagCount:[String,Number],ellipsisTagPopoverProps:Object,onClear:Function,onPatternInput:Function,onPatternFocus:Function,onPatternBlur:Function,renderLabel:Function,status:String,inlineThemeDisabled:Boolean,ignoreComposition:{type:Boolean,default:!0},onResize:Function}),setup(n){const{mergedClsPrefixRef:e,mergedRtlRef:t}=Hd(n),i=yb("InternalSelection",t,e),r=ee(null),s=ee(null),o=ee(null),a=ee(null),l=ee(null),c=ee(null),u=ee(null),h=ee(null),d=ee(null),f=ee(null),p=ee(!1),g=ee(!1),m=ee(!1),v=ys("InternalSelection","-internal-selection",hit,iee,n,ri(n,"clsPrefix")),_=te(()=>n.clearable&&!n.disabled&&(m.value||n.active)),y=te(()=>n.selectedOption?n.renderTag?n.renderTag({option:n.selectedOption,handleClose:()=>{}}):n.renderLabel?n.renderLabel(n.selectedOption,!0):Cm(n.selectedOption[n.labelField],n.selectedOption,!0):n.placeholder),A=te(()=>{const pe=n.selectedOption;if(pe)return pe[n.labelField]}),w=te(()=>n.multiple?!!(Array.isArray(n.selectedOptions)&&n.selectedOptions.length):n.selectedOption!==null);function b(){var pe;const{value:fe}=r;if(fe){const{value:Ee}=s;Ee&&(Ee.style.width=`${fe.offsetWidth}px`,n.maxTagCount!=="responsive"&&((pe=d.value)===null||pe===void 0||pe.sync({showAllItemsBeforeCalculate:!1})))}}function C(){const{value:pe}=f;pe&&(pe.style.display="none")}function I(){const{value:pe}=f;pe&&(pe.style.display="inline-block")}yt(ri(n,"active"),pe=>{pe||C()}),yt(ri(n,"pattern"),()=>{n.multiple&&Yi(b)});function x(pe){const{onFocus:fe}=n;fe&&fe(pe)}function T(pe){const{onBlur:fe}=n;fe&&fe(pe)}function O(pe){const{onDeleteOption:fe}=n;fe&&fe(pe)}function F(pe){const{onClear:fe}=n;fe&&fe(pe)}function G(pe){const{onPatternInput:fe}=n;fe&&fe(pe)}function B(pe){var fe;(!pe.relatedTarget||!(!((fe=o.value)===null||fe===void 0)&&fe.contains(pe.relatedTarget)))&&x(pe)}function R(pe){var fe;!((fe=o.value)===null||fe===void 0)&&fe.contains(pe.relatedTarget)||T(pe)}function P(pe){F(pe)}function k(){m.value=!0}function L(){m.value=!1}function H(pe){!n.active||!n.filterable||pe.target!==s.value&&pe.preventDefault()}function U(pe){O(pe)}function $(pe){if(pe.key==="Backspace"&&!j.value&&!n.pattern.length){const{selectedOptions:fe}=n;fe!=null&&fe.length&&U(fe[fe.length-1])}}const j=ee(!1);let Q=null;function ne(pe){const{value:fe}=r;if(fe){const Ee=pe.target.value;fe.textContent=Ee,b()}n.ignoreComposition&&j.value?Q=pe:G(pe)}function ve(){j.value=!0}function Pe(){j.value=!1,n.ignoreComposition&&G(Q),Q=null}function De(pe){var fe;g.value=!0,(fe=n.onPatternFocus)===null||fe===void 0||fe.call(n,pe)}function Xe(pe){var fe;g.value=!1,(fe=n.onPatternBlur)===null||fe===void 0||fe.call(n,pe)}function Ne(){var pe,fe;if(n.filterable)g.value=!1,(pe=c.value)===null||pe===void 0||pe.blur(),(fe=s.value)===null||fe===void 0||fe.blur();else if(n.multiple){const{value:Ee}=a;Ee==null||Ee.blur()}else{const{value:Ee}=l;Ee==null||Ee.blur()}}function et(){var pe,fe,Ee;n.filterable?(g.value=!1,(pe=c.value)===null||pe===void 0||pe.focus()):n.multiple?(fe=a.value)===null||fe===void 0||fe.focus():(Ee=l.value)===null||Ee===void 0||Ee.focus()}function ze(){const{value:pe}=s;pe&&(I(),pe.focus())}function de(){const{value:pe}=s;pe&&pe.blur()}function lt(pe){const{value:fe}=u;fe&&fe.setTextContent(`+${pe}`)}function he(){const{value:pe}=h;return pe}function Ce(){return s.value}let se=null;function Re(){se!==null&&window.clearTimeout(se)}function He(){n.active||(Re(),se=window.setTimeout(()=>{w.value&&(p.value=!0)},100))}function Y(){Re()}function W(pe){pe||(Re(),p.value=!1)}yt(w,pe=>{pe||(p.value=!1)}),Zn(()=>{Qv(()=>{const pe=c.value;pe&&(n.disabled?pe.removeAttribute("tabindex"):pe.tabIndex=g.value?-1:0)})}),HZ(o,n.onResize);const{inlineThemeDisabled:ge}=n,Le=te(()=>{const{size:pe}=n,{common:{cubicBezierEaseInOut:fe},self:{borderRadius:Ee,color:oe,placeholderColor:Me,textColor:je,paddingSingle:_e,paddingMultiple:Ye,caretColor:q,colorDisabled:we,textColorDisabled:M,placeholderColorDisabled:N,colorActive:D,boxShadowFocus:z,boxShadowActive:K,boxShadowHover:ce,border:ae,borderFocus:J,borderHover:xe,borderActive:Se,arrowColor:rt,arrowColorDisabled:ot,loadingColor:gt,colorActiveWarning:ut,boxShadowFocusWarning:ct,boxShadowActiveWarning:Ct,boxShadowHoverWarning:vn,borderWarning:ti,borderFocusWarning:fr,borderHoverWarning:Ao,borderActiveWarning:_r,colorActiveError:ni,boxShadowFocusError:mi,boxShadowActiveError:li,boxShadowHoverError:Mr,borderError:Ei,borderFocusError:Ti,borderHoverError:so,borderActiveError:Zo,clearColor:re,clearColorHover:Ge,clearColorPressed:Ke,clearSize:Je,arrowSize:qe,[rr("height",pe)]:Et,[rr("fontSize",pe)]:Bt}}=v.value,Nt=Fm(_e),Qt=Fm(Ye);return{"--n-bezier":fe,"--n-border":ae,"--n-border-active":Se,"--n-border-focus":J,"--n-border-hover":xe,"--n-border-radius":Ee,"--n-box-shadow-active":K,"--n-box-shadow-focus":z,"--n-box-shadow-hover":ce,"--n-caret-color":q,"--n-color":oe,"--n-color-active":D,"--n-color-disabled":we,"--n-font-size":Bt,"--n-height":Et,"--n-padding-single-top":Nt.top,"--n-padding-multiple-top":Qt.top,"--n-padding-single-right":Nt.right,"--n-padding-multiple-right":Qt.right,"--n-padding-single-left":Nt.left,"--n-padding-multiple-left":Qt.left,"--n-padding-single-bottom":Nt.bottom,"--n-padding-multiple-bottom":Qt.bottom,"--n-placeholder-color":Me,"--n-placeholder-color-disabled":N,"--n-text-color":je,"--n-text-color-disabled":M,"--n-arrow-color":rt,"--n-arrow-color-disabled":ot,"--n-loading-color":gt,"--n-color-active-warning":ut,"--n-box-shadow-focus-warning":ct,"--n-box-shadow-active-warning":Ct,"--n-box-shadow-hover-warning":vn,"--n-border-warning":ti,"--n-border-focus-warning":fr,"--n-border-hover-warning":Ao,"--n-border-active-warning":_r,"--n-color-active-error":ni,"--n-box-shadow-focus-error":mi,"--n-box-shadow-active-error":li,"--n-box-shadow-hover-error":Mr,"--n-border-error":Ei,"--n-border-focus-error":Ti,"--n-border-hover-error":so,"--n-border-active-error":Zo,"--n-clear-size":Je,"--n-clear-color":re,"--n-clear-color-hover":Ge,"--n-clear-color-pressed":Ke,"--n-arrow-size":qe}}),Ve=ge?Ag("internal-selection",te(()=>n.size[0]),Le,n):void 0;return{mergedTheme:v,mergedClearable:_,mergedClsPrefix:e,rtlEnabled:i,patternInputFocused:g,filterablePlaceholder:y,label:A,selected:w,showTagsPanel:p,isComposing:j,counterRef:u,counterWrapperRef:h,patternInputMirrorRef:r,patternInputRef:s,selfRef:o,multipleElRef:a,singleElRef:l,patternInputWrapperRef:c,overflowRef:d,inputTagElRef:f,handleMouseDown:H,handleFocusin:B,handleClear:P,handleMouseEnter:k,handleMouseLeave:L,handleDeleteOption:U,handlePatternKeyDown:$,handlePatternInputInput:ne,handlePatternInputBlur:Xe,handlePatternInputFocus:De,handleMouseEnterCounter:He,handleMouseLeaveCounter:Y,handleFocusout:R,handleCompositionEnd:Pe,handleCompositionStart:ve,onPopoverUpdateShow:W,focus:et,focusInput:ze,blur:Ne,blurInput:de,updateCounter:lt,getCounter:he,getTail:Ce,renderLabel:n.renderLabel,cssVars:ge?void 0:Le,themeClass:Ve==null?void 0:Ve.themeClass,onRender:Ve==null?void 0:Ve.onRender}},render(){const{status:n,multiple:e,size:t,disabled:i,filterable:r,maxTagCount:s,bordered:o,clsPrefix:a,ellipsisTagPopoverProps:l,onRender:c,renderTag:u,renderLabel:h}=this;c==null||c();const d=s==="responsive",f=typeof s=="number",p=d||f,g=Ue(Vk,null,{default:()=>Ue(ait,{clsPrefix:a,loading:this.loading,showArrow:this.showArrow,showClear:this.mergedClearable&&this.selected,onClear:this.handleClear},{default:()=>{var v,_;return(_=(v=this.$slots).arrow)===null||_===void 0?void 0:_.call(v)}})});let m;if(e){const{labelField:v}=this,_=G=>Ue("div",{class:`${a}-base-selection-tag-wrapper`,key:G.value},u?u({option:G,handleClose:()=>{this.handleDeleteOption(G)}}):Ue(FP,{size:t,closable:!G.disabled,disabled:i,onClose:()=>{this.handleDeleteOption(G)},internalCloseIsButtonTag:!1,internalCloseFocusable:!1},{default:()=>h?h(G,!0):Cm(G[v],G,!0)})),y=()=>(f?this.selectedOptions.slice(0,s):this.selectedOptions).map(_),A=r?Ue("div",{class:`${a}-base-selection-input-tag`,ref:"inputTagElRef",key:"__input-tag__"},Ue("input",Object.assign({},this.inputProps,{ref:"patternInputRef",tabindex:-1,disabled:i,value:this.pattern,autofocus:this.autofocus,class:`${a}-base-selection-input-tag__input`,onBlur:this.handlePatternInputBlur,onFocus:this.handlePatternInputFocus,onKeydown:this.handlePatternKeyDown,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),Ue("span",{ref:"patternInputMirrorRef",class:`${a}-base-selection-input-tag__mirror`},this.pattern)):null,w=d?()=>Ue("div",{class:`${a}-base-selection-tag-wrapper`,ref:"counterWrapperRef"},Ue(FP,{size:t,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,onMouseleave:this.handleMouseLeaveCounter,disabled:i})):void 0;let b;if(f){const G=this.selectedOptions.length-s;G>0&&(b=Ue("div",{class:`${a}-base-selection-tag-wrapper`,key:"__counter__"},Ue(FP,{size:t,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,disabled:i},{default:()=>`+${G}`})))}const C=d?r?Ue(x$,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,getTail:this.getTail,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:y,counter:w,tail:()=>A}):Ue(x$,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:y,counter:w}):f&&b?y().concat(b):y(),I=p?()=>Ue("div",{class:`${a}-base-selection-popover`},d?y():this.selectedOptions.map(_)):void 0,x=p?Object.assign({show:this.showTagsPanel,trigger:"hover",overlap:!0,placement:"top",width:"trigger",onUpdateShow:this.onPopoverUpdateShow,theme:this.mergedTheme.peers.Popover,themeOverrides:this.mergedTheme.peerOverrides.Popover},l):null,O=(this.selected?!1:this.active?!this.pattern&&!this.isComposing:!0)?Ue("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`},Ue("div",{class:`${a}-base-selection-placeholder__inner`},this.placeholder)):null,F=r?Ue("div",{ref:"patternInputWrapperRef",class:`${a}-base-selection-tags`},C,d?null:A,g):Ue("div",{ref:"multipleElRef",class:`${a}-base-selection-tags`,tabindex:i?void 0:0},C,g);m=Ue(vt,null,p?Ue(qnt,Object.assign({},x,{scrollable:!0,style:"max-height: calc(var(--v-target-height) * 6.6);"}),{trigger:()=>F,default:I}):F,O)}else if(r){const v=this.pattern||this.isComposing,_=this.active?!v:!this.selected,y=this.active?!1:this.selected;m=Ue("div",{ref:"patternInputWrapperRef",class:`${a}-base-selection-label`},Ue("input",Object.assign({},this.inputProps,{ref:"patternInputRef",class:`${a}-base-selection-input`,value:this.active?this.pattern:"",placeholder:"",readonly:i,disabled:i,tabindex:-1,autofocus:this.autofocus,onFocus:this.handlePatternInputFocus,onBlur:this.handlePatternInputBlur,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),y?Ue("div",{class:`${a}-base-selection-label__render-label ${a}-base-selection-overlay`,key:"input"},Ue("div",{class:`${a}-base-selection-overlay__wrapper`},u?u({option:this.selectedOption,handleClose:()=>{}}):h?h(this.selectedOption,!0):Cm(this.label,this.selectedOption,!0))):null,_?Ue("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`,key:"placeholder"},Ue("div",{class:`${a}-base-selection-overlay__wrapper`},this.filterablePlaceholder)):null,g)}else m=Ue("div",{ref:"singleElRef",class:`${a}-base-selection-label`,tabindex:this.disabled?void 0:0},this.label!==void 0?Ue("div",{class:`${a}-base-selection-input`,title:VZe(this.label),key:"input"},Ue("div",{class:`${a}-base-selection-input__content`},u?u({option:this.selectedOption,handleClose:()=>{}}):h?h(this.selectedOption,!0):Cm(this.label,this.selectedOption,!0))):Ue("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`,key:"placeholder"},Ue("div",{class:`${a}-base-selection-placeholder__inner`},this.placeholder)),g);return Ue("div",{ref:"selfRef",class:[`${a}-base-selection`,this.rtlEnabled&&`${a}-base-selection--rtl`,this.themeClass,n&&`${a}-base-selection--${n}-status`,{[`${a}-base-selection--active`]:this.active,[`${a}-base-selection--selected`]:this.selected||this.active&&this.pattern,[`${a}-base-selection--disabled`]:this.disabled,[`${a}-base-selection--multiple`]:this.multiple,[`${a}-base-selection--focus`]:this.focused}],style:this.cssVars,onClick:this.onClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onKeydown:this.onKeydown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onMousedown:this.handleMouseDown},m,o?Ue("div",{class:`${a}-base-selection__border`}):null,o?Ue("div",{class:`${a}-base-selection__state-border`}):null)}});function SE(n){return n.type==="group"}function ree(n){return n.type==="ignored"}function UP(n,e){try{return!!(1+e.toString().toLowerCase().indexOf(n.trim().toLowerCase()))}catch{return!1}}function fit(n,e){return{getIsGroup:SE,getIgnored:ree,getKey(i){return SE(i)?i.name||i.key||"key-required":i[n]},getChildren(i){return i[e]}}}function pit(n,e,t,i){if(!e)return n;function r(s){if(!Array.isArray(s))return[];const o=[];for(const a of s)if(SE(a)){const l=r(a[i]);l.length&&o.push(Object.assign({},a,{[i]:l}))}else{if(ree(a))continue;e(t,a)&&o.push(a)}return o}return r(n)}function git(n,e,t){const i=new Map;return n.forEach(r=>{SE(r)?r[t].forEach(s=>{i.set(s[e],s)}):i.set(r[e],r)}),i}function mit(n){const{boxShadow2:e}=n;return{menuBoxShadow:e}}const vit={name:"Select",common:bg,peers:{InternalSelection:iee,InternalSelectMenu:ZZ},self:mit},_it=vit,yit=Ut([nn("select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),nn("select-menu",`
 margin: 4px 0;
 box-shadow: var(--n-menu-box-shadow);
 `,[eee({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),Ait=Object.assign(Object.assign({},ys.props),{to:ah.propTo,bordered:{type:Boolean,default:void 0},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},defaultValue:{type:[String,Number,Array],default:null},keyboard:{type:Boolean,default:!0},value:[String,Number,Array],placeholder:String,menuProps:Object,multiple:Boolean,size:String,filterable:Boolean,disabled:{type:Boolean,default:void 0},remote:Boolean,loading:Boolean,filter:Function,placement:{type:String,default:"bottom-start"},widthMode:{type:String,default:"trigger"},tag:Boolean,onCreate:Function,fallbackOption:{type:[Function,Boolean],default:void 0},show:{type:Boolean,default:void 0},showArrow:{type:Boolean,default:!0},maxTagCount:[Number,String],ellipsisTagPopoverProps:Object,consistentMenuWidth:{type:Boolean,default:!0},virtualScroll:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},childrenField:{type:String,default:"children"},renderLabel:Function,renderOption:Function,renderTag:Function,"onUpdate:value":[Function,Array],inputProps:Object,nodeProps:Function,ignoreComposition:{type:Boolean,default:!0},showOnFocus:Boolean,onUpdateValue:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onFocus:[Function,Array],onScroll:[Function,Array],onSearch:[Function,Array],onUpdateShow:[Function,Array],"onUpdate:show":[Function,Array],displayDirective:{type:String,default:"show"},resetMenuOnOptionsChange:{type:Boolean,default:!0},status:String,showCheckmark:{type:Boolean,default:!0},onChange:[Function,Array],items:Array}),__=Fe({name:"Select",props:Ait,setup(n){const{mergedClsPrefixRef:e,mergedBorderedRef:t,namespaceRef:i,inlineThemeDisabled:r}=Hd(n),s=ys("Select","-select",yit,_it,n,e),o=ee(n.defaultValue),a=ri(n,"value"),l=Wk(a,o),c=ee(!1),u=ee(""),h=te(()=>{const{valueField:D,childrenField:z}=n,K=fit(D,z);return mnt(F.value,K)}),d=te(()=>git(T.value,n.valueField,n.childrenField)),f=ee(!1),p=Wk(ri(n,"show"),f),g=ee(null),m=ee(null),v=ee(null),{localeRef:_}=zZ("Select"),y=te(()=>{var D;return(D=n.placeholder)!==null&&D!==void 0?D:_.value.placeholder}),A=_Z(n,["items","options"]),w=[],b=ee([]),C=ee([]),I=ee(new Map),x=te(()=>{const{fallbackOption:D}=n;if(D===void 0){const{labelField:z,valueField:K}=n;return ce=>({[z]:String(ce),[K]:ce})}return D===!1?!1:z=>Object.assign(D(z),{value:z})}),T=te(()=>C.value.concat(b.value).concat(A.value)),O=te(()=>{const{filter:D}=n;if(D)return D;const{labelField:z,valueField:K}=n;return(ce,ae)=>{if(!ae)return!1;const J=ae[z];if(typeof J=="string")return UP(ce,J);const xe=ae[K];return typeof xe=="string"?UP(ce,xe):typeof xe=="number"?UP(ce,String(xe)):!1}}),F=te(()=>{if(n.remote)return A.value;{const{value:D}=T,{value:z}=u;return!z.length||!n.filterable?D:pit(D,O.value,z,n.childrenField)}});function G(D){const z=n.remote,{value:K}=I,{value:ce}=d,{value:ae}=x,J=[];return D.forEach(xe=>{if(ce.has(xe))J.push(ce.get(xe));else if(z&&K.has(xe))J.push(K.get(xe));else if(ae){const Se=ae(xe);Se&&J.push(Se)}}),J}const B=te(()=>{if(n.multiple){const{value:D}=l;return Array.isArray(D)?G(D):[]}return null}),R=te(()=>{const{value:D}=l;return!n.multiple&&!Array.isArray(D)?D===null?null:G([D])[0]||null:null}),P=Ett(n),{mergedSizeRef:k,mergedDisabledRef:L,mergedStatusRef:H}=P;function U(D,z){const{onChange:K,"onUpdate:value":ce,onUpdateValue:ae}=n,{nTriggerFormChange:J,nTriggerFormInput:xe}=P;K&&qs(K,D,z),ae&&qs(ae,D,z),ce&&qs(ce,D,z),o.value=D,J(),xe()}function $(D){const{onBlur:z}=n,{nTriggerFormBlur:K}=P;z&&qs(z,D),K()}function j(){const{onClear:D}=n;D&&qs(D)}function Q(D){const{onFocus:z,showOnFocus:K}=n,{nTriggerFormFocus:ce}=P;z&&qs(z,D),ce(),K&&Xe()}function ne(D){const{onSearch:z}=n;z&&qs(z,D)}function ve(D){const{onScroll:z}=n;z&&qs(z,D)}function Pe(){var D;const{remote:z,multiple:K}=n;if(z){const{value:ce}=I;if(K){const{valueField:ae}=n;(D=B.value)===null||D===void 0||D.forEach(J=>{ce.set(J[ae],J)})}else{const ae=R.value;ae&&ce.set(ae[n.valueField],ae)}}}function De(D){const{onUpdateShow:z,"onUpdate:show":K}=n;z&&qs(z,D),K&&qs(K,D),f.value=D}function Xe(){L.value||(De(!0),f.value=!0,n.filterable&&Ye())}function Ne(){De(!1)}function et(){u.value="",C.value=w}const ze=ee(!1);function de(){n.filterable&&(ze.value=!0)}function lt(){n.filterable&&(ze.value=!1,p.value||et())}function he(){L.value||(p.value?n.filterable?Ye():Ne():Xe())}function Ce(D){var z,K;!((K=(z=v.value)===null||z===void 0?void 0:z.selfRef)===null||K===void 0)&&K.contains(D.relatedTarget)||(c.value=!1,$(D),Ne())}function se(D){Q(D),c.value=!0}function Re(D){c.value=!0}function He(D){var z;!((z=g.value)===null||z===void 0)&&z.$el.contains(D.relatedTarget)||(c.value=!1,$(D),Ne())}function Y(){var D;(D=g.value)===null||D===void 0||D.focus(),Ne()}function W(D){var z;p.value&&(!((z=g.value)===null||z===void 0)&&z.$el.contains(QA(D))||Ne())}function ge(D){if(!Array.isArray(D))return[];if(x.value)return Array.from(D);{const{remote:z}=n,{value:K}=d;if(z){const{value:ce}=I;return D.filter(ae=>K.has(ae)||ce.has(ae))}else return D.filter(ce=>K.has(ce))}}function Le(D){Ve(D.rawNode)}function Ve(D){if(L.value)return;const{tag:z,remote:K,clearFilterAfterSelect:ce,valueField:ae}=n;if(z&&!K){const{value:J}=C,xe=J[0]||null;if(xe){const Se=b.value;Se.length?Se.push(xe):b.value=[xe],C.value=w}}if(K&&I.value.set(D[ae],D),n.multiple){const J=ge(l.value),xe=J.findIndex(Se=>Se===D[ae]);if(~xe){if(J.splice(xe,1),z&&!K){const Se=pe(D[ae]);~Se&&(b.value.splice(Se,1),ce&&(u.value=""))}}else J.push(D[ae]),ce&&(u.value="");U(J,G(J))}else{if(z&&!K){const J=pe(D[ae]);~J?b.value=[b.value[J]]:b.value=w}_e(),Ne(),U(D[ae],D)}}function pe(D){return b.value.findIndex(K=>K[n.valueField]===D)}function fe(D){p.value||Xe();const{value:z}=D.target;u.value=z;const{tag:K,remote:ce}=n;if(ne(z),K&&!ce){if(!z){C.value=w;return}const{onCreate:ae}=n,J=ae?ae(z):{[n.labelField]:z,[n.valueField]:z},{valueField:xe,labelField:Se}=n;A.value.some(rt=>rt[xe]===J[xe]||rt[Se]===J[Se])||b.value.some(rt=>rt[xe]===J[xe]||rt[Se]===J[Se])?C.value=w:C.value=[J]}}function Ee(D){D.stopPropagation();const{multiple:z}=n;!z&&n.filterable&&Ne(),j(),z?U([],[]):U(null,null)}function oe(D){!wE(D,"action")&&!wE(D,"empty")&&D.preventDefault()}function Me(D){ve(D)}function je(D){var z,K,ce,ae,J;if(!n.keyboard){D.preventDefault();return}switch(D.key){case" ":if(n.filterable)break;D.preventDefault();case"Enter":if(!(!((z=g.value)===null||z===void 0)&&z.isComposing)){if(p.value){const xe=(K=v.value)===null||K===void 0?void 0:K.getPendingTmNode();xe?Le(xe):n.filterable||(Ne(),_e())}else if(Xe(),n.tag&&ze.value){const xe=C.value[0];if(xe){const Se=xe[n.valueField],{value:rt}=l;n.multiple&&Array.isArray(rt)&&rt.some(ot=>ot===Se)||Ve(xe)}}}D.preventDefault();break;case"ArrowUp":if(D.preventDefault(),n.loading)return;p.value&&((ce=v.value)===null||ce===void 0||ce.prev());break;case"ArrowDown":if(D.preventDefault(),n.loading)return;p.value?(ae=v.value)===null||ae===void 0||ae.next():Xe();break;case"Escape":p.value&&(met(D),Ne()),(J=g.value)===null||J===void 0||J.focus();break}}function _e(){var D;(D=g.value)===null||D===void 0||D.focus()}function Ye(){var D;(D=g.value)===null||D===void 0||D.focusInput()}function q(){var D;p.value&&((D=m.value)===null||D===void 0||D.syncPosition())}Pe(),yt(ri(n,"options"),Pe);const we={focus:()=>{var D;(D=g.value)===null||D===void 0||D.focus()},focusInput:()=>{var D;(D=g.value)===null||D===void 0||D.focusInput()},blur:()=>{var D;(D=g.value)===null||D===void 0||D.blur()},blurInput:()=>{var D;(D=g.value)===null||D===void 0||D.blurInput()}},M=te(()=>{const{self:{menuBoxShadow:D}}=s.value;return{"--n-menu-box-shadow":D}}),N=r?Ag("select",void 0,M,n):void 0;return Object.assign(Object.assign({},we),{mergedStatus:H,mergedClsPrefix:e,mergedBordered:t,namespace:i,treeMate:h,isMounted:HI(),triggerRef:g,menuRef:v,pattern:u,uncontrolledShow:f,mergedShow:p,adjustedTo:ah(n),uncontrolledValue:o,mergedValue:l,followerRef:m,localizedPlaceholder:y,selectedOption:R,selectedOptions:B,mergedSize:k,mergedDisabled:L,focused:c,activeWithoutMenuOpen:ze,inlineThemeDisabled:r,onTriggerInputFocus:de,onTriggerInputBlur:lt,handleTriggerOrMenuResize:q,handleMenuFocus:Re,handleMenuBlur:He,handleMenuTabOut:Y,handleTriggerClick:he,handleToggle:Le,handleDeleteOption:Ve,handlePatternInput:fe,handleClear:Ee,handleTriggerBlur:Ce,handleTriggerFocus:se,handleKeydown:je,handleMenuAfterLeave:et,handleMenuClickOutside:W,handleMenuScroll:Me,handleMenuKeydown:je,handleMenuMousedown:oe,mergedTheme:s,cssVars:r?void 0:M,themeClass:N==null?void 0:N.themeClass,onRender:N==null?void 0:N.onRender})},render(){return Ue("div",{class:`${this.mergedClsPrefix}-select`},Ue(TZ,null,{default:()=>[Ue(IZ,null,{default:()=>Ue(dit,{ref:"triggerRef",inlineThemeDisabled:this.inlineThemeDisabled,status:this.mergedStatus,inputProps:this.inputProps,clsPrefix:this.mergedClsPrefix,showArrow:this.showArrow,maxTagCount:this.maxTagCount,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,bordered:this.mergedBordered,active:this.activeWithoutMenuOpen||this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,renderTag:this.renderTag,renderLabel:this.renderLabel,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,labelField:this.labelField,valueField:this.valueField,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,loading:this.loading,focused:this.focused,onClick:this.handleTriggerClick,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onBlur:this.handleTriggerBlur,onFocus:this.handleTriggerFocus,onKeydown:this.handleKeydown,onPatternBlur:this.onTriggerInputBlur,onPatternFocus:this.onTriggerInputFocus,onResize:this.handleTriggerOrMenuResize,ignoreComposition:this.ignoreComposition},{arrow:()=>{var n,e;return[(e=(n=this.$slots).arrow)===null||e===void 0?void 0:e.call(n)]}})}),Ue(MZ,{ref:"followerRef",show:this.mergedShow,to:this.adjustedTo,teleportDisabled:this.adjustedTo===ah.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target",placement:this.placement},{default:()=>Ue(dv,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterLeave:this.handleMenuAfterLeave},{default:()=>{var n,e,t;return this.mergedShow||this.displayDirective==="show"?((n=this.onRender)===null||n===void 0||n.call(this),tg(Ue(Fnt,Object.assign({},this.menuProps,{ref:"menuRef",onResize:this.handleTriggerOrMenuResize,inlineThemeDisabled:this.inlineThemeDisabled,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,class:[`${this.mergedClsPrefix}-select-menu`,this.themeClass,(e=this.menuProps)===null||e===void 0?void 0:e.class],clsPrefix:this.mergedClsPrefix,focusable:!0,labelField:this.labelField,valueField:this.valueField,autoPending:!0,nodeProps:this.nodeProps,theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,treeMate:this.treeMate,multiple:this.multiple,size:"medium",renderOption:this.renderOption,renderLabel:this.renderLabel,value:this.mergedValue,style:[(t=this.menuProps)===null||t===void 0?void 0:t.style,this.cssVars],onToggle:this.handleToggle,onScroll:this.handleMenuScroll,onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onTabOut:this.handleMenuTabOut,onMousedown:this.handleMenuMousedown,show:this.mergedShow,showCheckmark:this.showCheckmark,resetMenuOnOptionsChange:this.resetMenuOnOptionsChange}),{empty:()=>{var i,r;return[(r=(i=this.$slots).empty)===null||r===void 0?void 0:r.call(i)]},header:()=>{var i,r;return[(r=(i=this.$slots).header)===null||r===void 0?void 0:r.call(i)]},action:()=>{var i,r;return[(r=(i=this.$slots).action)===null||r===void 0?void 0:r.call(i)]}}),this.displayDirective==="show"?[[c6,this.mergedShow],[CE,this.handleMenuClickOutside,void 0,{capture:!0}]]:[[CE,this.handleMenuClickOutside,void 0,{capture:!0}]])):null}})})]}))}}),bit={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},wit=()=>bit,xit={name:"Space",self:wit},Cit=xit;let GP;const Eit=()=>{if(!pet)return!0;if(GP===void 0){const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.rowGap="1px",n.appendChild(document.createElement("div")),n.appendChild(document.createElement("div")),document.body.appendChild(n);const e=n.scrollHeight===1;return document.body.removeChild(n),GP=e}return GP},Tit=Object.assign(Object.assign({},ys.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrapItem:{type:Boolean,default:!0},itemClass:String,itemStyle:[String,Object],wrap:{type:Boolean,default:!0},internalUseGap:{type:Boolean,default:void 0}}),CN=Fe({name:"Space",props:Tit,setup(n){const{mergedClsPrefixRef:e,mergedRtlRef:t}=Hd(n),i=ys("Space","-space",void 0,Cit,n,e),r=yb("Space",t,e);return{useGap:Eit(),rtlEnabled:r,mergedClsPrefix:e,margin:te(()=>{const{size:s}=n;if(Array.isArray(s))return{horizontal:s[0],vertical:s[1]};if(typeof s=="number")return{horizontal:s,vertical:s};const{self:{[rr("gap",s)]:o}}=i.value,{row:a,col:l}=SZe(o);return{horizontal:XA(l),vertical:XA(a)}})}},render(){const{vertical:n,reverse:e,align:t,inline:i,justify:r,itemClass:s,itemStyle:o,margin:a,wrap:l,mergedClsPrefix:c,rtlEnabled:u,useGap:h,wrapItem:d,internalUseGap:f}=this,p=xE(UZe(this),!1);if(!p.length)return null;const g=`${a.horizontal}px`,m=`${a.horizontal/2}px`,v=`${a.vertical}px`,_=`${a.vertical/2}px`,y=p.length-1,A=r.startsWith("space-");return Ue("div",{role:"none",class:[`${c}-space`,u&&`${c}-space--rtl`],style:{display:i?"inline-flex":"flex",flexDirection:n&&!e?"column":n&&e?"column-reverse":!n&&e?"row-reverse":"row",justifyContent:["start","end"].includes(r)?"flex-"+r:r,flexWrap:!l||n?"nowrap":"wrap",marginTop:h||n?"":`-${_}`,marginBottom:h||n?"":`-${_}`,alignItems:t,gap:h?`${a.vertical}px ${a.horizontal}px`:""}},!d&&(h||f)?p:p.map((w,b)=>w.type===gT?w:Ue("div",{role:"none",class:s,style:[o,{maxWidth:"100%"},h?"":n?{marginBottom:b!==y?v:""}:u?{marginLeft:A?r==="space-between"&&b===y?"":m:b!==y?g:"",marginRight:A?r==="space-between"&&b===0?"":m:"",paddingTop:_,paddingBottom:_}:{marginRight:A?r==="space-between"&&b===y?"":m:b!==y?g:"",marginLeft:A?r==="space-between"&&b===0?"":m:"",paddingTop:_,paddingBottom:_}]},w)))}}),y_=()=>({name:"common-checkmark",size:"18px",class:"check-mark-icon"});function A_(n,e){var t,i,r,s,o,a,l;if(n)try{const c=Ue(Nn,e),u=Ue("div",{class:"x-select-option__checkmark"},c);(r=(i=(t=n==null?void 0:n.props)==null?void 0:t.class)==null?void 0:i.includes)!=null&&r.call(i,"n-base-select-option--show-checkmark")&&((l=(a=(o=(s=n.children)==null?void 0:s[0])==null?void 0:o.children)==null?void 0:a.splice)==null||l.call(a,1,1,u))}catch(c){console.error(c)}}const Iit={class:"x-select-wrap"},Sit={class:"title"},Pit={class:"mr-22"},Mit=1133,Rit=Fe({__name:"WidgetInlineSelect",props:{borderLess:{type:Boolean,default:!0},options:{},ignoreTranslate:{type:Boolean},multiState:{type:Boolean},label:{},labelClassName:{},labelSuffix:{},checkMarkIconProps:{default:y_}},setup(n){const{t:e}=Yt(),t=mT(),i=n,r=qr(i.options),s=te({get:()=>(r.forEach(_=>{_!=null&&_.icon&&_.value===t.value&&(_.icon=_.icon.replace("unselected","light"))}),r.filter(_=>(_==null?void 0:_.status)!=="disable")),set:_=>{console.log("select-optionsList:",s)}}),o=ee(!1),a=ee(!1),l=_=>{o.value=_,a.value=_,tt.isShowOptionSelect=_},c=ee(""),u=(_,y)=>{y!=null&&y.icon&&(c.value=y==null?void 0:y.icon.replace("unselected","light"),s.value.forEach(A=>{(A==null?void 0:A.value)===_?A.icon=c.value:A.icon.endsWith("light")&&(A.icon=A.icon.replace("light","unselected"))}))},h=_=>_.map(({label:y,...A})=>({label:pi(y)&&y.includes(".")?e(y):y,...A})),d=_=>Ue("div",{title:_,class:"mr-22 common-text-ellipsis"},[_||e("common.input-multi-state")]),f=()=>(console.log("props.label:",i.label),Ue(PE,{label:(i==null?void 0:i.label)||"",labelSuffix:(i==null?void 0:i.labelSuffix)||{}})),g=window.innerWidth/Mit*16,m=({option:_,handleClose:y})=>[Ue(CN,{align:"center",justify:"space-between",size:[6,0],wrap:!1,style:{fontSize:`${g}px`}},()=>[f(),d(_.label)])],v=({node:_,option:y,selected:A})=>(i.checkMarkIconProps&&A&&A_(_,i.checkMarkIconProps),[_]);return(_,y)=>(V(),le("section",Iit,[ye(Be(__),ht(_.$attrs,{class:["x-select",{"border-less":o.value}],bordered:!1,show:a.value,placeholder:"",options:_.ignoreTranslate===!0?s.value:h(s.value),"render-tag":m,"render-option":v,"on-update-show":l,"on-update-value":u}),null,16,["show","class","options"]),_.$attrs.value===null?(V(),le("div",{key:0,class:"multi-state-box",style:On({fontSize:`${g}px`}),onClick:y[0]||(y[0]=dr(A=>l(!0),["stop"]))},[ue("div",Sit,Te(Be(e)(i.label)),1),ue("div",Pit,Te(Be(e)("common.input-multi-state")),1)],4)):$e("",!0)]))}}),Dit=dt(Rit,[["__scopeId","data-v-4cff7da3"]]),kit=Fe({__name:"WidgetInput",props:{type:{default:void 0},value:{default:void 0},prefix:{default:""},suffix:{default:""},trigger:{default:void 0},debounceTime:{default:0},allowEmpty:{type:Boolean,default:!0},digits:{default:void 0},multiState:{type:Boolean,default:!1},borderLess:{type:Boolean,default:!1},showButton:{type:Boolean,default:!1},handler:{type:Function,default(){}}},emits:["update:value"],setup(n){const e=n,t=te(()=>eh(e.value,e.digits)),{valueRef:i,running:r,update:s,debouncedFn:o}=Gd(t.value,e.handler,e.debounceTime??0),a=l=>{const c=eh(l??null,e.digits);if(!e.allowEmpty&&cr(c)){i.value=t.value;return}i.value=c,o()};return yt(()=>t.value,l=>{l!==i.value&&(i.value=l)}),(l,c)=>{const u=Jo;return V(),Ie(u,{modelValue:Be(i),"onUpdate:modelValue":[c[0]||(c[0]=h=>Td(i)?i.value=h:null),a],modelModifiers:{trim:!0},disabled:Be(r),placeholder:"",center:"",class:"border_i"},null,8,["modelValue","disabled"])}}}),Oit=dt(kit,[["__scopeId","data-v-58ae60ad"]]),Lit={};function Nit(n,e){return V(),le("div")}const Bit=dt(Lit,[["render",Nit]]),Fit=["id"],Uit={key:0,class:"multiple-values"},Git={key:1},Hit={key:2},Vit=Fe({__name:"WidgetInputNumber",props:{value:{default:void 0},name:{default:void 0},parentEle:{default:""},width:{default:"76px"},min:{default:void 0},max:{default:void 0},prefix:{default:void 0},suffix:{default:void 0},debounceTime:{default:0},allowEmpty:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},digits:{default:void 0},multiState:{type:Boolean,default:!1},handler:{type:Function,default(){}},onBlur:{type:Function,default(){}}},setup(n){const e=n,t=te(()=>e.multiState),i=te(()=>eh(e.value,e.digits)),{valueRef:r,running:s,update:o,debouncedFn:a}=Gd(i.value,e.handler,e.debounceTime??0),l=h=>{var f;if(!e.allowEmpty&&cr(h)){r.value=i.value;return}h!==null&&e.min&&h<e.min&&(h=e.min),h!==null&&e.max&&h>e.max&&(h=e.max);const d=eh(h??null,e.digits);console.log("[表单最终更新值]",d),r.value=d,a(),(f=e.onBlur)==null||f.call(e,{target:{_value:d}})};yt(()=>i.value,h=>{h!==r.value&&(r.value=h)});const c=ee(!1),u=()=>{if(e.disabled||s.value)return;c.value=!0;const h=e.min&&e.min<0;tt.modal.showNumberKeyboard({parentEle:e.parentEle,targetEle:`#${e.name}`,position:e.parentEle?"left":"right",inputVal:r.value,focusedIndex:0,unit:e.suffix,showMinus:h,inputs:[{id:e.name,value:r.value}],confirmCallback:d=>{console.log("[数字键盘确认值]",d[0].value),l(d[0].value),c.value=!1},closeCallback:()=>{console.log("[数字键盘取消]"),c.value=!1}})};return(h,d)=>{const f=xn;return V(),le("div",ht({id:h.name,class:["right_panel",{"border-less":c.value}]},h.$attrs,{onClick:u}),[ue("div",{class:St(["num_box",{"disabled-color":h.disabled}])},[t.value?(V(),le("span",Uit,Te(h.$t("common.input-multi-state")),1)):(V(),le("span",Git,Te(Be(r)),1)),h.suffix?(V(),le("span",Hit,Te(h.suffix),1)):$e("",!0),c.value?$e("",!0):(V(),Ie(f,{key:3,name:"slider_right",size:"9px",class:"f-s-9"}))],2)],16,Fit)}}}),zit=dt(Vit,[["__scopeId","data-v-9452433b"]]),$it="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACnSURBVHgBjZJbDsUgCERRu/+1+mni497SZgwSlJIQTcuZATXknH930BiDOHiVyVFKod47yTrEdYL5X2tt7jUcQqB4grWAhjkvFGoYe27dcl4Edu611q3zFLBgrDi4HRxjtAUwuwc/acFwd2EpoGG4n+CU0juCvAkOuHvws9cwBI9t3zm/6RfG7h68dCBha24LXlI+Ehb7Cs8aKSBnd51xDmhbun+FOf6pIC/vP1SE1gAAAABJRU5ErkJggg==",Wit="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADHSURBVHgB7ZTRCcIwFEXvjXUAN9BROoE6ge6h0BT0W0fQCRzBEcQJ7CCaZ/srbcnNh/rRC4EQXs4hjyTAkF+HnwuF3z8AmyIprEq/mfWWFH5nSEzb3qyn+EY8c8P4YDA6jLwhXOtxdshOzbw+fknSgoVj6beTNo7rEihwgnkXp1OgwEnMEwTx8GBYywIFTriUFsXDybBKEUTDg9lCFihwYrSEKlDghtdFFijw+vnedYEAb26cLFDgTTsRmy98dqzSJaww5O/yBod29aaLsIgUAAAAAElFTkSuQmCC",jit=["src","alt"],Qit={class:"txt"},Xit=Fe({__name:"MaterialLabel",props:{label:{default:void 0},imgUrl:{default:void 0},isDangerous:{type:Boolean,default:!1}},setup(n){const e=n,t=ee(null);return ore(t,r=>{const s=ZO(e.imgUrl,"m_fill,w_480,h_480","webp");tt.modal.showMaterialModal({label:e.label,imgUrl:s,isDangerous:e.isDangerous})}),(r,s)=>{const o=xn;return V(),le("div",{ref_key:"materialLabelRef",ref:t,class:St(["material-label",r.isDangerous?"dangerous-label":""])},[ue("img",{src:r.imgUrl,alt:r.label},null,8,jit),ue("span",Qit,Te(r.label),1),r.isDangerous?(V(),Ie(o,{key:0,size:"20",class:"f-s-20 mr-4",name:"flammable"})):$e("",!0)],2)}}}),Yit=dt(Xit,[["__scopeId","data-v-95299a25"]]),{client:zI,domain:qit}=nl();zI.token=ST();zI.system=xr.SYSTEM_TYPE.PAD;zI.platform=xr.XTOOL_PLATFORM.XCS;zI.showSocialLogin=!0;const Kit={class:"f-s-16 action-text"},Jit=1133,Zit=Fe({__name:"WidgetMaterial",props:{value:{default:void 0},options:{},borderLess:{type:Boolean,default:!0},handler:{type:Function,default:void 0},processTypes:{},checkMarkIconProps:{default:y_}},setup(n){const{t:e,locale:t}=Yt(),i=bt(),r=el(),s=ee(!1),o=_=>{s.value=_,tt.isShowOptionSelect=_},a=n,l=te(()=>{const _=i.info.power??0;return Rt(_)?!wt(_):_>0}),u=DT().isOnline,h=()=>{if(jt(Zt.buttonClick,{elementId:ki.plusMore}),!u.value){aO(e("announcement.network_error"));return}let _=i.currentPower;Rt(_)&&(_=_.join(","));const y=`${qit.material}?power=${_}&device=${i.ext.config.productID}`;console.log(["=> material lab url",_,y]),window.open(y)},d=te(()=>{const _=r.getMaterialList;return Oj(a.processTypes,_)}),f=te(()=>d.value.map(_=>{const{id:y,name:A,image:w,isDangerous:b}=_,C=t.value==="zh-CN"?A.zh:A.en;return{value:y,label:y===0?e(C):C,image:w,isDangerous:b}})),p=_=>{const A=window.innerWidth/Jit*16,{image:w,value:b,label:C,isDangerous:I}=_,x=w?ZO(w,"m_fill,w_48,h_48","webp"):Number(b)>0?$it:Wit;return Ue(Yit,{imgUrl:x,label:C,style:{fontSize:`${A}px`},isDangerous:I})},g=({node:_,option:y,selected:A})=>(a.checkMarkIconProps&&A&&A_(_,a.checkMarkIconProps),[_]),m=_=>{const y=d.value.find(A=>A.id===_);return y&&a.handler?(a.handler(y),_>0&&r.sortLocalMaterial(_),!0):!1};yt(()=>f.value,(_,y)=>{const A=_.map(b=>b.value).join(","),w=(y||[]).map(b=>b.value).join(",");if(A!==w&&(!_.some(C=>C.value===a.value)&&(i!=null&&i.ext)&&(m(0),console.log(["不支持该材料",a.value,_])),a.value)){const C=d.value.find(x=>x.id===a.value),I=i.dataSource.getOfficialMaterial();gi(I)&&C&&(i.dataSource.officialMaterial={id:i.dataSource.canvasId,value:C})}},{immediate:!0}),yt(()=>r.getMaterialList,()=>{if(a.value&&a.value>0){const _=d.value.find(y=>y.id===a.value);_&&a.handler&&a.handler({..._,justUpdateProcessingData:!0})}},{immediate:!0});const v=_=>{const{action:y,id:A,processingType:w="",matrix:b={},power:C,productID:I,originLaserSource:x}=_.data;if(y==="SelectMaterial")if(m(A)){const O={processingType:w,matrix:b};Yi(()=>{var F;(F=i.dataSource)==null||F.setMatrixParamFromOutside(O),tt.modal.showToast({msg:"device.parameter_panel.used_success",icon:"success",duration:3e3})})}else["MF1","GS002"].includes(I)&&r.setLaserSource(x),tt.modal.showToast({msg:"device.parameter_panel.used_fail",icon:"error",duration:3e3})};return Zn(()=>{window.addEventListener("message",v)}),qo(()=>{window.removeEventListener("message",v)}),(_,y)=>{const A=Oi;return V(),Ie(Be(__),{class:St(["x-select",{"border-less":s.value}]),bordered:!1,"on-update-show":o,value:_.value,"render-label":p,"render-option":g,options:f.value,"onUpdate:value":m},Pr({_:2},[(l.value,{name:"action",fn:be(()=>[ye(A,{style:{padding:"0"},"is-link":"",center:"",onClick:h},{title:be(()=>[ue("span",Kit,Te(Be(e)("device.material.material_lab")),1)]),icon:be(()=>[ye(Be(Nn),{name:"more-material",class:"f-s-16 mr-6"})]),_:1})]),key:"0"})]),1032,["value","class","options"])}}}),ert=dt(Zit,[["__scopeId","data-v-86c543eb"]]),trt=Fe({__name:"WidgetPopconfirm",props:{label:{},triggerSlot:{},content:{}},setup(n){return(e,t)=>(V(),le("div"))}}),nrt=Fe({__name:"WidgetPopover",props:{label:{},triggerSlot:{},content:{},width:{}},setup(n){const e=n,{t}=Yt(),i=()=>{var l;let r="",s,o,a;if(typeof e.content=="string")r=t(e.content);else if(typeof e.content=="object"){typeof e.content.text=="string"&&(r=t(e.content.text));let c=(l=e.content)==null?void 0:l.button;c&&(s=c.label,o=c.href,a=c.onClick)}tt.modal.showTipModal({title:e.label?t(e.label):t("ipad.dialog.tips"),content:r,hasClose:!1,hasCancel:!1,confirmTxt:t("ipad.dialog.got_it"),hasSupply:!!s,supplyTxt:t(s||""),onSupply:a??(()=>{window.MeApi.openNative.openWebInApp(o||"")}),onConfirm:()=>{}})};return(r,s)=>{const o=Hi,a=xn,l=Gs;return V(),Ie(l,{onClick:dr(i,["stop"])},{default:be(()=>{var c;return[r.triggerSlot.type==="button"?(V(),Ie(o,jo(ht({key:0},r.triggerSlot.props)),{default:be(()=>{var u;return[Gt(Te(r.$t(((u=r.triggerSlot)==null?void 0:u.label)||"")),1)]}),_:1},16)):r.triggerSlot.type==="text"?(V(),le("span",jo(ht({key:1},r.triggerSlot.props)),Te(r.$t(((c=r.triggerSlot)==null?void 0:c.label)||"")),17)):(V(),Ie(a,ht({key:2,name:r.triggerSlot.icon,size:"16px",color:"#97999C",class:"svg-tip f-s-16"},r.triggerSlot.props),null,16,["name"]))]}),_:1})}}}),irt=dt(nrt,[["__scopeId","data-v-f3c385ac"]]),rrt=Fe({__name:"WidgetPopoverGroup",props:{label:{},value:{},triggerSlot:{},popContent:{},handler:{type:Function}},setup(n){return(e,t)=>(V(),le("div"))}}),srt=Fe({__name:"WidgetRadioGroup",props:{gap:{},cols:{},useButtonType:{type:Boolean},value:{type:[String,Number,Boolean]},textClassName:{},options:{},handler:{type:Function}},emits:["update:value"],setup(n){Yt();const e=n,{valueRef:t,running:i,update:r}=Gd(e.value,e.handler,0),s=o=>{t.value=o,r()};return yt(()=>e.value,(o,a)=>{o!==a&&(t.value=o)}),(o,a)=>{const l=U0,c=rte,u=ste,h=vT;return V(),Ie(h,ht({modelValue:Be(t),"onUpdate:modelValue":a[0]||(a[0]=d=>Td(t)?t.value=d:null),class:["poison_bg",o.textClassName]},o.$attrs,{disabled:Be(i),direction:"horizontal",shape:"dot",onChange:s}),{default:be(()=>[ye(u,{style:{width:"100%"}},{default:be(()=>[(V(!0),le(vt,null,Fn(o.options,d=>(V(),Ie(c,{key:d.value,span:12},{default:be(()=>[ye(l,{disabled:d.disabled||!1,name:d.value},{default:be(()=>[Gt(Te(d.label.includes(".")?o.$t(d.label):d.label),1)]),_:2},1032,["disabled","name"])]),_:2},1024))),128))]),_:1})]),_:1},16,["modelValue","class","disabled"])}}}),ort=dt(srt,[["__scopeId","data-v-e7f9fe1d"]]),art={};function lrt(n,e){return V(),le("div")}const crt=dt(art,[["render",lrt]]),k$=1133,urt=744,hrt=Fe({__name:"WidgetSelect",props:{options:{},value:{default:void 0},borderLess:{type:Boolean,default:!0},ignoreTranslate:{type:Boolean},multiState:{type:Boolean},checkMarkIconProps:{default:y_}},setup(n){const{t:e}=Yt(),t=mT(),i=n,r=te({get:()=>{var v;if(t.name==="mode"){const _=[],y=[];if(i.options.forEach(A=>{A.status==="disable"?y.push(A):_.push(A.value)}),_.includes(i.value))return i.value;{const A=(v=y.find(w=>w.value===i.value))==null?void 0:v.label;return e(A)}}return i.value},set:v=>v}),s=qr(i.options),o=te({get:()=>(s.forEach(v=>{v!=null&&v.icon&&v.value===i.value&&(v.icon=v.icon.replace("unselected","light"))}),s.filter(v=>(v==null?void 0:v.status)!=="disable")),set:v=>v}),a=ee(!1),l=v=>{a.value=v,tt.isShowOptionSelect=v},c=ee(""),u=(v,_)=>{var y;_.icon&&(c.value=(y=_.icon)==null?void 0:y.replace("unselected","light"),o.value.forEach(A=>{(A==null?void 0:A.value)===v?A.icon=c.value:A.icon.endsWith("light")&&(A.icon=A.icon.replace("light","unselected"))}))},h=v=>v.map(({label:_,...y})=>({label:pi(_)&&_.includes(".")?e(_):_,...y})),d=v=>{const y=window.innerWidth/k$*22,w=window.innerHeight/urt*22;if(v)return Ue("div",{class:"flex items-center justify-center"},[Ue(Nn,{name:v,style:{fontSize:"20px",width:`${y}px`,height:`${w}px`,"margin-right":"4px"}})])},f=te(()=>t.name&&["mode","pathPlanning","processPath"].includes(t.name)),p=v=>{let _="txt common-text-ellipsis";return f.value&&(_="txt wrap-option-text"),Ue("div",{title:v,class:_},[v])},g=v=>{const y=window.innerWidth/k$*16;return[Ue(CN,{size:[6,0],wrap:!1,style:{fontSize:`${y}px`},itemClass:t.name==="mode"?"maxWidth85":""},()=>[d(v.icon),p(v.label)])]},m=({node:v,option:_,selected:y})=>(i.checkMarkIconProps&&y&&A_(v,i.checkMarkIconProps),[v]);return(v,_)=>(V(),Ie(Be(__),ht(v.$attrs,{class:["x-select",{"border-less":a.value,"multi-state":v.multiState}],bordered:!1,value:r.value,placeholder:v.multiState?Be(e)("common.input-multi-state"):"",options:v.ignoreTranslate===!0?o.value:h(o.value),"render-label":g,"render-option":m,"on-update-show":l,"on-update-value":u}),null,16,["value","class","placeholder","options"]))}}),drt=dt(hrt,[["__scopeId","data-v-3395ca29"]]),frt=Fe({__name:"WidgetSelectOption",props:{value:{},options:{},ignoreTranslate:{type:Boolean},empty:{},onDeleteOption:{type:Function},handler:{type:Function}},setup(n){return ee(),(e,t)=>(V(),le("div"))}}),prt={key:1,class:"num_tip"},grt=Fe({__name:"SliderBlock",props:{modelValue:{}},setup(n){const e=ee(!1),t=()=>{e.value=!0},i=()=>{e.value=!1};return(r,s)=>{const o=xn;return V(),le("div",{class:St(["custom-button",e.value?"active":""]),onTouchstart:t,onTouchend:i},[e.value?(V(),Ie(o,{key:0,class:"down_icon f-s-12",name:"down_slider",size:"12px"})):$e("",!0),e.value?(V(),le("div",prt,Te(Be(Rt)(r.modelValue)?`${parseInt(r.modelValue[0])}~${parseInt(r.modelValue[1])}`:r.modelValue),1)):$e("",!0)],34)}}}),see=dt(grt,[["__scopeId","data-v-0e71741d"]]),mrt={class:"content_slider"},vrt={class:"slider_box mb-8"},_rt={style:{padding:"36px"}},yrt=["id"],Art={key:0,class:"multiple-values"},brt={key:1},wrt=Fe({__name:"WidgetSlider",props:{value:{},name:{default:""},suffix:{default:""},parentEle:{default:""},width:{default:"76px"},fillColor:{default:""},showNumber:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},multiState:{type:Boolean,default:!1},range:{type:Boolean,default:void 0},debounceTime:{default:0},digits:{default:void 0},step:{default:1},min:{default:void 0},max:{default:void 0},unit:{default:""},allowEmpty:{type:Boolean,default:!0},showText:{type:Boolean,default:!1},handler:{type:Function,default(){}}},setup(n){const e=n,t=te(()=>eh(e.value,e.digits)),{valueRef:i,running:r,debouncedFn:s}=Gd(t.value,e.handler,e.debounceTime??0),o=te(()=>e.multiState),a=u=>{u!==null&&e.min&&u<e.min&&(u=e.min),u!==null&&e.max&&u>e.max&&(u=e.max);const h=eh(u??null,e.digits)??e.min;console.log("[表单最终更新值]",h),e.name==="power"||e.name,i.value=h,s()};yt(()=>t.value,u=>{u!==i.value&&(i.value=u)});const l=ee(!1),c=()=>{if(e.disabled||r.value)return;l.value=!0;const u=e.min&&e.min<0;console.log("props.name",e.name),tt.modal.showNumberKeyboard({parentEle:e.parentEle,targetEle:`.${e.name}`,customOffsetY:28,position:e.parentEle?"left":"right",inputVal:i.value,focusedIndex:0,unit:e.unit,showMinus:u,inputs:[{id:e.name,value:i.value}],confirmCallback:h=>{l.value=!1,console.log("[数字键盘确认值]",h[0].value),a(h[0].value)},closeCallback:()=>{l.value=!1,console.log("[数字键盘取消]")}})};return(u,h)=>{const d=ig,f=xn;return V(),le("div",mrt,[ue("div",vrt,[ye(d,{modelValue:Be(i),"onUpdate:modelValue":h[0]||(h[0]=p=>Td(i)?i.value=p:null),"bar-height":"2px",class:"bar_speed","active-color":"#28BE44",disabled:u.disabled,min:u.min,step:u.step,max:u.max,onChange:a},{button:be(()=>[ue("div",_rt,[ye(see,{"model-value":Be(i)},null,8,["model-value"])])]),_:1},8,["modelValue","disabled","min","step","max"]),ue("div",{id:u.name,class:St(["right_panel",{[u.name]:u.name,"border-less":l.value}]),onClick:dr(c,["stop"])},[ue("div",{class:St(["num_box",{"disabled-color":u.disabled}])},[o.value?(V(),le("span",Art,Te(u.$t("common.input-multi-state")),1)):(V(),le("span",brt,Te(Be(i)),1)),l.value?$e("",!0):(V(),Ie(f,{key:2,name:"slider_right",size:"9px",class:"f-s-9"}))],2)],10,yrt)])])}}}),xrt=dt(wrt,[["__scopeId","data-v-8f6c85f7"]]),Crt={class:"slider-wrap"},Ert={class:"content_slider"},Trt={class:"slider_box mt-8 mb-8"},Irt={style:{padding:"36px"}},Srt=["id"],Prt={class:"num_box"},Mrt={key:0,class:"multiple-values"},Rrt={key:1},Drt=Fe({__name:"WidgetSliderRange",props:{value:{},fillColor:{default:""},showNumber:{type:Boolean,default:!0},name:{default:void 0},parentEle:{default:""},width:{default:"76px"},range:{type:Boolean,default:!0},debounceTime:{default:0},digits:{default:void 0},step:{default:1},min:{default:1},max:{default:100},prefix:{default:""},suffix:{default:""},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiState:{type:Boolean,default:!1},handler:{type:Function,default(){}}},setup(n){const e=n,t=te(()=>e.multiState),i=te(()=>eh(e.value,e.digits)),r=te(()=>cr(e==null?void 0:e.value)),{valueRef:s,running:o,debouncedFn:a}=Gd(i.value,e.handler,e.debounceTime??0),l=ee(r.value?[e.min,e.min]:s.value),c=te(()=>`${parseInt(l.value[0])},${parseInt(l.value[1])}`);yt(()=>i.value,f=>{f!==s.value&&!cr(f)&&(s.value=f)});const u=f=>{let p=[eh(f[0],e.digits),eh(f[1],e.digits)];cr(f[0])&&(p[0]=l.value[0]),cr(f[1])&&(p[1]=l.value[1]);const g=Wa(p),m=[Math.max(g[0],e.min),Math.min(g[1],e.max)];console.log("[表单最终更新值]",m),s.value=m,l.value=m,a()},h=ee(!1),d=()=>{if(e.disabled||o.value)return;h.value=!0;const f=e.min&&e.min<0;tt.modal.showNumberKeyboard({parentEle:e.parentEle,targetEle:`#${e.name}`,position:e.parentEle?"left":"right",inputVal:l.value,focusedIndex:0,unit:e.suffix,showMinus:f,inputs:[{id:"inputLeft",value:parseInt(l.value[0])},{id:"inputRight",value:parseInt(l.value[1])}],confirmCallback:p=>{h.value=!1,console.log("[数字键盘确认值]",p),u([p[0].value,p[1].value])},closeCallback:()=>{h.value=!1,console.log("[数字键盘取消]")}})};return(f,p)=>{const g=ig,m=xn;return V(),le("div",Crt,[ue("div",Ert,[ue("div",Trt,[ye(g,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=v=>l.value=v),range:Be(Rt)(l.value),"bar-height":"2px",class:"bar_speed","active-color":"#28BE44",disabled:f.disabled,min:f.min,max:f.max,step:f.step,onChange:u},{button:be(()=>[ue("div",Irt,[ye(see,{"model-value":l.value},null,8,["model-value"])])]),_:1},8,["modelValue","range","disabled","min","max","step"]),ue("div",{id:f.name,class:St(["right_panel",{"border-less":h.value}]),onClick:dr(d,["stop"])},[ue("div",Prt,[t.value?(V(),le("span",Mrt,Te(f.$t("common.input-multi-state")),1)):(V(),le("span",Rrt,Te(c.value),1)),h.value?$e("",!0):(V(),Ie(m,{key:2,name:"slider_right",size:"9px",class:"f-s-9"}))])],10,Srt)])])])}}}),krt=dt(Drt,[["__scopeId","data-v-8c945172"]]),Ort=Fe({__name:"WidgetSwitch",props:{name:{},value:{type:Boolean},class:{},debounceTime:{default:300},multiState:{type:Boolean,default:!1},handler:{type:Function,default(){}}},emits:["update:value"],setup(n){const e=n,t=te(()=>e.name==="processIgnore"?!e.value:e.value),{running:i,debouncedFn:r}=Gd(t.value,e.handler,e.debounceTime),s=o=>{const a=e.name==="processIgnore"?!o:o;e.multiState?r(!1):r(a)};return(o,a)=>{const l=G0;return V(),le("section",{class:St({"multi-state":o.multiState})},[ye(l,ht({modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=c=>t.value=c),disabled:Be(i),loading:Be(i)},o.$attrs,{onChange:s}),null,16,["modelValue","disabled","loading"])],2)}}}),Lrt=dt(Ort,[["__scopeId","data-v-e31ad713"]]),Nrt=Fe({__name:"WidgetTabs",props:{options:{},filterPredicate:{},value:{}},setup(n){const e=n,t=te(()=>e.value??0);return(i,r)=>{const s=cO,o=uO;return V(),Ie(o,{active:t.value,"onUpdate:active":r[0]||(r[0]=a=>t.value=a)},{default:be(()=>[(V(!0),le(vt,null,Fn(Be(uC)(i.options,i.filterPredicate),({value:a,label:l})=>(V(),Ie(s,{key:a,title:a},{default:be(()=>[Gt(Te(i.$t(l)),1)]),_:2},1032,["title"]))),128))]),_:1},8,["active"])}}}),Brt=Fe({__name:"WidgetText",props:{value:{},textClassName:{},format:{type:Function}},setup(n){const e=n,t=te(()=>mt(e.format)?e.format(e.value??""):e.value);return(i,r)=>(V(),le("div",ht({class:"w-text"},i.$attrs,{class:i.textClassName}),Te(t.value),17))}}),Frt=dt(Brt,[["__scopeId","data-v-8ec1135c"]]),Urt={class:"unit"},Grt=Fe({__name:"WidgetUnitInput",props:{name:{default:void 0},value:{default:void 0},width:{default:void 0},parentEle:{default:void 0},disabled:{type:Boolean,default:!1},noBorder:{type:Boolean},prefix:{default:void 0},suffix:{default:void 0},min:{default:void 0},max:{default:void 0},allowEmpty:{type:Boolean,default:!0},onBlur:{type:Function,default(){}},handler:{type:Function,default(){}}},setup(n){const e=n,t=ee(!1),i=si(),r=te(()=>i.unit),s=te(()=>e.value===null?null:Vy(e.value)),o=te(()=>Vy(e.min)),a=te(()=>Vy(e.max)),l=async h=>{var f,p;if(!e.allowEmpty)return;h!==null&&(h=Math.min(Math.max(h,o.value),a.value));const d=h===null?null:h7e(h);console.log("[表单最终更新值]",d);try{t.value=!0,await((f=e.handler)==null?void 0:f.call(e,d)),await((p=e.onBlur)==null?void 0:p.call(e,{target:{_value:d}}))}catch(g){console.error(g)}finally{t.value=!1}},c=ee(!1),u=()=>{if(e.disabled||t.value)return;c.value=!0;const h=e.min&&e.min<0;tt.modal.showNumberKeyboard({parentEle:e.parentEle??"",targetEle:`#${e.name}`,position:e.parentEle?"left":"right",inputVal:s.value,focusedIndex:0,unit:r.value.current,showMinus:h,inputs:[{id:e.name,value:s.value}],confirmCallback:d=>{console.log("[数字键盘确认值]",d[0].value),l(d[0].value),c.value=!1},closeCallback:()=>{console.log("[数字键盘取消]"),c.value=!1}})};return(h,d)=>{const f=xn,p=Jo;return V(),Ie(p,{id:h.name,modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=g=>s.value=g),class:St(["unit-input",{"no-border":h.noBorder,"border-less":c.value,"auto-width":h.name==="perimeter"||h.name==="diameter"}]),type:"number",placeholder:"",readonly:"",disabled:h.disabled||t.value,border:!1,"input-align":"right",style:On({width:h.width?h.width:"100%"}),onClick:u},Pr({"right-icon":be(()=>[h.noBorder&&!c.value?(V(),le(vt,{key:0},[ue("span",Urt,Te(r.value.current),1),ye(f,{name:"slider_right",size:"9px",class:"f-s-9"})],64)):$e("",!0)]),_:2},[h.prefix?{name:"left-icon",fn:be(()=>[Gt(Te(h.prefix),1)]),key:"0"}:void 0]),1032,["id","modelValue","disabled","class","style"])}}}),Hrt=dt(Grt,[["__scopeId","data-v-91845871"]]),Vrt={class:"mr-3"},zrt=Fe({__name:"WidgetUnitNumber",props:{value:{},prefix:{},defaultValue:{}},setup(n){const e=n,t=si(),i=te(()=>t.unit),r=te(()=>e.value===null?null:Vy(e.value).toString());return(s,o)=>(V(),le("section",jo(ch(s.$attrs)),[ue("span",null,[s.prefix?(V(),le(vt,{key:0},[Gt(Te(s.prefix),1)],64)):$e("",!0),ue("span",Vrt,Te(r.value||s.defaultValue),1),i.value.current?(V(),le(vt,{key:1},[Gt(Te(i.value.current),1)],64)):$e("",!0)])],16))}}),$rt=dt(zrt,[["__scopeId","data-v-37c7911c"]]),Wrt={class:"select-option-content"},jrt={class:"select-icon"},Qrt={class:"header"},Xrt={class:"content"},Yrt={class:"footer"},qrt=Fe({__name:"OptionItem",props:{option:{},value:{},handleRemove:{type:Function},updateValue:{type:Function}},setup(n){const{t:e}=Yt(),t=ee(!1),i=n,r=te(()=>{var c;return i.value===((c=i.option)==null?void 0:c.value)}),s=()=>{var c;if(!i.option.disabled){const u=((c=i.option)==null?void 0:c.value)||"";console.log("[选择元素方案]",u),i.updateValue(u)}},o=c=>{c.stopPropagation(),t.value=!0},a=c=>{var u;c.stopPropagation(),r.value||i.handleRemove(((u=i.option)==null?void 0:u.value)||""),t.value=!1},l=c=>{c.stopPropagation(),t.value=!1};return(c,u)=>{var f;const h=Hi,d=Ko;return V(),le(vt,null,[ue("section",{class:St(["select-option",{selected:r.value,"ml-4":!r.value,"mr-4":!r.value}]),onClick:dr(s,["stop"])},[ue("div",Wrt,[ue("span",{class:St({"common-ellipsis-multiline-2":!r.value})},Te(c.option.label),3),ue("div",jrt,[r.value?(V(),Ie(Be(Nn),{key:0,name:"common-checkmark",class:"f-s-18",size:"18px"})):$e("",!0),!r.value&&c.option.value&&!["customize","official"].includes((f=c.option)==null?void 0:f.value)?(V(),Ie(Be(Nn),{key:1,name:"icon-delete",size:"18px",class:"f-s-18",onClick:dr(o,["stop"])})):$e("",!0)])])],2),ye(d,{show:t.value,"onUpdate:show":u[1]||(u[1]=p=>t.value=p),"close-on-click-overlay":!1,class:"save-param-popup",teleport:"body"},{default:be(()=>[ue("section",null,[ue("section",Qrt,[ue("span",null,Te(Be(e)("device.user_defined.is_delete")),1),ye(Be(Nn),{name:"icon-close",class:"f-s-18",size:"18px",onClick:u[0]||(u[0]=()=>t.value=!1)})]),ue("section",Xrt,Te(Be(e)("device.user_defined.cant_be_restored")),1),ue("section",Yrt,[ye(h,{type:"primary",class:"btn",onClick:a},{default:be(()=>[Gt(Te(Be(e)("device.user_defined.confirm")),1)]),_:1}),ye(h,{class:"btn",onClick:l},{default:be(()=>[Gt(Te(Be(e)("device.user_defined.think")),1)]),_:1})])])]),_:1},8,["show"])],64)}}}),Krt=dt(qrt,[["__scopeId","data-v-09c64922"]]),Jrt={class:"x-select-wrap"},Zrt={class:"locale"},est={class:"f-s-16 ml-4 mr-4"},tst={class:"title"},nst={class:"mr-22"},ist=1133,rst=Fe({__name:"WidgetParamSelect",props:{value:{},options:{},processingType:{},material:{},disabledOfficial:{type:Boolean},multiState:{type:Boolean},label:{},labelClassName:{},labelSuffix:{},handler:{},checkMarkIconProps:{default:y_}},setup(n){const{t:e}=Yt(),t=ee(),i=bt(),r=Hc(),s=n,o=()=>{window.open(Mf.SUPPORT_LINK)},a=ee([]),l=()=>r.getProcessingParamList().filter(w=>w.processingType===s.processingType);Zn(()=>{a.value=l()});const c=ee(!1),u=ee(!1),h=w=>{c.value=w,u.value=w,console.log("[参数方案当前值]",s.value);const b=l();a.value=b,!(!w||!s.value)&&(["customize","official"].includes((s==null?void 0:s.value)||"")?r.updateProcessParam():r.updateProcessParam().finally(()=>{if(!b.find(I=>I.id===(s==null?void 0:s.value))){const I={materialType:"customize",data:{}};s.handler&&s.handler(I)}}))},d=({node:w,option:b,selected:C})=>(s.checkMarkIconProps&&C&&A_(w,s.checkMarkIconProps),Ue(Krt,{value:(s==null?void 0:s.value)||"",option:b,handleRemove:_,updateValue:A})),f=w=>Ue("div",{title:w,class:"mr-22 common-text-ellipsis"},[w]),p=()=>Ue(PE,{label:(s==null?void 0:s.label)||"",labelSuffix:s.value==="official"?s==null?void 0:s.labelSuffix:{visible:!1}}),m=window.innerWidth/ist*16,v=({option:w,handleClose:b})=>[Ue(CN,{align:"center",justify:"space-between",size:[6,0],wrap:!1,style:{fontSize:`${m}px`}},()=>[p(),f(w.label)])],_=w=>{if(w!==s.value){r.removeProcessingParam(w);const b=i.dataSource;b&&b.removeProcessingParam(w)}},y=te(()=>{let w=!1;const b=i.dataSource;if(b){const T=b.getOfficialMaterial();w=T&&T.processingData&&T.processingData[(s==null?void 0:s.processingType)||""]}const C=a.value.map(T=>({label:T.name,value:T.id})),I={label:e("device.processing_attrs.x_tool_parameter_reference"),value:"official"},x=[{label:e("device.parameter_panel.user_defined"),value:"customize"}].concat(C);return w&&x.unshift(I),x}),A=w=>{var b;if(w==="official"&&jt(Zt.buttonClick,{elementId:ki.recommend,source:"parameter"}),(b=t.value)==null||b.blur(),u.value=!1,s.handler&&w!==s.value){const C=a.value.find(x=>x.id===w),I={materialType:w,data:(C==null?void 0:C.data)||{}};s.handler(I),!["customize","official"].includes(w)&&C&&r.selectProcessingParam(C==null?void 0:C.id)}};return(w,b)=>(V(),le("section",Jrt,[ye(Be(__),ht({ref_key:"selectRef",ref:t,class:"x-select"},w.$attrs,{bordered:!1,options:y.value,value:w.value,"render-tag":v,"render-option":d,show:u.value,class:{"border-less":c.value},"onUpdate:show":h}),Pr({_:2},[Be(wt)(a.value)?{name:"action",fn:be(()=>[ue("section",Zrt,[ue("span",est,Te(w.$t("device.element_container.no_param")),1),ye(Nn,{name:"icon-help",class:"f-s-18 icon-help",onClick:dr(o,["stop"])})])]),key:"0"}:void 0]),1040,["options","value","show","class"]),w.value===null?(V(),le("div",{key:0,class:"multi-state-box",style:On({fontSize:`${m}px`}),onClick:b[0]||(b[0]=dr(C=>h(!0),["stop"]))},[ue("div",tst,[ye(Be(PE),{label:(s==null?void 0:s.label)||"","label-suffix":(s==null?void 0:s.labelSuffix)||{}},null,8,["label","label-suffix"])]),ue("div",nst,Te(Be(e)("common.input-multi-state")),1)],4)):$e("",!0)]))}}),sst=dt(rst,[["__scopeId","data-v-4add94ed"]]),nC={text:Frt,input:Oit,inputGroup:Bit,button:EZe,buttonGroup:TZe,select:drt,switch:Lrt,number:zit,radio:U0,slider:xrt,tabs:Nrt,radioGroup:ort,unitInput:Hrt,material:ert,paramSelect:sst,saveParamButton:crt,popover:irt,popoverGroup:rrt,sliderRange:krt,unitNumber:$rt,selectOption:frt,popconfirm:trt,inlineSelect:Dit},ost=Fe({__name:"UnitExtra",props:{unitExtra:{type:[String,Boolean]},isUnitWidget:{type:Boolean}},setup(n){const e=si(),t=te(()=>{var i;return`(${(i=e.unit)==null?void 0:i.current})`});return(i,r)=>(V(),le("span",null,[Be(tA)(i.unitExtra)||i.isUnitWidget?(V(),le(vt,{key:0},[Gt(Te(t.value),1)],64)):(V(),le(vt,{key:1},[Gt(Te(i.unitExtra),1)],64))]))}}),ast={key:0,class:"red-dot"},lst={key:2},cst=Fe({__name:"XFormLabel",props:{name:{},label:{},labelClassName:{},labelExtra:{},unitExtra:{type:[String,Boolean]},labelSuffix:{},widget:{},widgetAttrs:{},handler:{type:Function},showRedDot:{type:Boolean},textClassName:{},unitExtraDesc:{type:Boolean},values:{}},setup(n){const e=n,t=te(()=>e.name!=="focalLength"&&e.name!=="thickness"&&e.name!=="autoMeasure"&&e.name!=="focalLengthM1"&&e.name!=="focalLenM1Lite"),i=r=>{let s=!0;return mt(r)?s=r(e.values):s=r!==!1,s};return(r,s)=>{var o;return r.label?(V(),le("section",{key:0,class:St(["x-form-label-wrap",r.labelClassName])},[ue("section",null,[ue("span",{class:St(["f-s-14",r.textClassName])},Te(r.$t(r.label)),3),r.showRedDot?(V(),le("em",ast)):$e("",!0),t.value&&(r.unitExtra||["unitInput"].includes(r.widget||""))?(V(),Ie(ost,{key:1,"unit-extra":r.unitExtra,"is-unit-widget":["unitInput"].includes(r.widget||"")||r.unitExtraDesc||!1},null,8,["unit-extra","is-unit-widget"])):$e("",!0),r.labelExtra?(V(),le("span",lst,Te(r.$t(r.labelExtra)),1)):$e("",!0)]),r.labelSuffix&&i((o=r.labelSuffix)==null?void 0:o.visible)?(V(),Ie(Uo(Be(nC)[r.labelSuffix.widget]),ht({key:0},r.labelSuffix.widgetAttrs,{values:r.values,visible:r.labelSuffix.visible,handler:(...a)=>{var l;return(l=r.handler)==null?void 0:l.call(r,r.name,...a)},"onUpdate:value":s[0]||(s[0]=(...a)=>{var l;return(l=r.handler)==null?void 0:l.call(r,r.name,...a)})}),null,16,["values","visible","handler"])):$e("",!0)],2)):$e("",!0)}}}),PE=dt(cst,[["__scopeId","data-v-2177b980"]]),ust=n=>(u6("data-v-3aedecea"),n=n(),h6(),n),hst=["inline"],dst={class:"x-form-item-label"},fst={key:0,class:"x-form-item-desc"},pst={key:1,class:"line-pd"},gst=ust(()=>ue("section",{class:"line"},null,-1)),mst=[gst],vst=Fe({__name:"XFormItem",props:{name:{},label:{},labelClassName:{},labelExtra:{},labelVertical:{type:Boolean},textClassName:{},unitExtra:{type:[String,Boolean]},labelSuffix:{},widget:{},widgetAttrs:{},popoverContent:{},handler:{type:Function},inline:{type:Boolean},desc:{},prefix:{},suffix:{},inputWrapperStyle:{},inputWrapperClass:{},itemStyle:{},itemClass:{},dividerLine:{},showRedDot:{type:Boolean},value:{},values:{},descClassName:{},descIcon:{},unitExtraDesc:{type:Boolean},hide:{type:Boolean}},setup(n){return(e,t)=>(V(),le("section",{class:St(e.dividerLine)},[e.hide?$e("",!0):(V(),le("section",{key:0,class:St(["x-form-item",e.itemClass]),inline:e.inline,style:On(e.itemStyle)},[ue("section",dst,[ye(Be(PE),jo(ch({name:e.name,label:e.label,labelClassName:e.labelClassName,textClassName:e.textClassName,labelExtra:e.labelExtra,labelVertical:e.labelVertical,unitExtra:e.unitExtra,labelSuffix:e.labelSuffix,widget:e.widget,widgetAttrs:e.widgetAttrs,handler:e.handler,showRedDot:e.showRedDot,unitExtraDesc:e.unitExtraDesc,values:e.values})),null,16)]),ue("section",{class:St(["x-form-item-widget",[e.inputWrapperClass,e.name]]),style:On(e.inputWrapperStyle)},[e.prefix?(V(),Ie(Uo(Be(nC)[e.prefix.widget]),jo(ht({key:0},e.prefix.widgetAttrs)),null,16)):$e("",!0),e.widget?(V(),Ie(Uo(Be(nC)[e.widget]),ht({key:1,handler:(...i)=>e.handler(e.name,...i),"popover-content":e.popoverContent},{value:e.value,name:e.name,textClassName:e.textClassName,...e.$attrs,...e.widgetAttrs},{"onUpdate:value":t[0]||(t[0]=(...i)=>e.handler(e.name,...i))}),null,16,["handler","popover-content"])):$e("",!0),e.suffix?(V(),Ie(Uo(Be(nC)[e.suffix.widget]),ht({key:2,label:e.suffix.label,handler:(...i)=>{var r;return e.handler(((r=e.suffix)==null?void 0:r.name)||"",...i)}},e.suffix.widgetAttrs),null,16,["label","handler"])):$e("",!0),Fs(e.$slots,"default",{},void 0,!0)],6),e.desc?(V(),le("section",fst,[e.descIcon?(V(),Ie(Be(Nn),{key:0,class:"x-form-item-desc-icon mr-8 f-s-20",name:e.descIcon,size:"20px"},null,8,["name"])):$e("",!0),e.desc?(V(),le("span",{key:1,class:St(["x-form-item-desc-text",e.descClassName])},Te(e.$t(e.desc)),3)):$e("",!0)])):$e("",!0)],14,hst)),e.dividerLine?(V(),le("section",pst,mst)):$e("",!0)],2))}}),O$=dt(vst,[["__scopeId","data-v-3aedecea"]]),_st=Fe({__name:"XFormItems",props:{items:{},values:{},handler:{type:Function}},setup(n){const e=n,t=r=>{let s=!0;return mt(r)?s=r(e.values):s=r!==!1,s},i=r=>{let s=!1;return mt(r)?s=r(e.values):s=r===!0,s};return(r,s)=>(V(!0),le(vt,null,Fn(r.items,({childs:o,visible:a,...l})=>(V(),le(vt,{key:l.name},[t(a)?(V(),Ie(O$,ht({key:0,value:r.values[l.name],values:r.values,handler:r.handler},{...l,...r.$attrs},{disabled:i(l.disabled)}),{default:be(()=>[o&&o.length>0?(V(!0),le(vt,{key:0},Fn(o,({visible:c,...u})=>(V(),le(vt,{key:u.name},[t(c)?(V(),Ie(O$,ht({key:0,handler:r.handler,value:r.values[u.name]},{...u,...r.$attrs},{disabled:i(u.disabled)}),null,16,["handler","value","disabled"])):$e("",!0)],64))),128)):$e("",!0)]),_:2},1040,["value","values","handler","disabled"])):$e("",!0)],64))),128))}}),yst=Fe({__name:"XForm",props:{title:{},items:{},handler:{},values:{}},setup(n){return(e,t)=>(V(),le("section",ht({class:"x-form-wrap"},e.$attrs),[Fs(e.$slots,"default"),e.items?(V(),Ie(_st,{key:0,items:e.items,values:e.values,handler:e.handler},null,8,["items","values","handler"])):$e("",!0)],16))}});var vf=(n=>(n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.TWO=2]="TWO",n[n.THREE=3]="THREE",n[n.FOUR=4]="FOUR",n[n.FIVE=5]="FIVE",n[n.SIX=6]="SIX",n[n.SEVEN=7]="SEVEN",n[n.EIGHT=8]="EIGHT",n[n.NINE=9]="NINE",n.MINUS="-",n.DOT=".",n))(vf||{});const Ast=Fe({__name:"InputNumber",props:{id:{default:void 0},modelValue:{default:void 0},onBlur:{type:Function,default:void 0},domProps:{default:void 0}},emits:["update:model-value","change"],setup(n,{expose:e,emit:t}){const i=n,r=t,s=ee(null),o=ee(""),a=y=>{const A=y.clipboardData||window.clipboardData;o.value=A.getData("text")};Zn(()=>{d(i.domProps),document.addEventListener("paste",a)}),L0(()=>{document.removeEventListener("paste",a)}),yt(()=>i.domProps,()=>{d(i.domProps)});const l=ee(),c=y=>{setTimeout(()=>{var A,w;l.value=(A=y.target)!=null&&A.value?Number((w=y.target)==null?void 0:w.value):Number(o.value),r("change",o.value)},100)},u=ee(i.modelValue),h=()=>s.value?s.value.$el.querySelector("input"):null,d=y=>{const A=h();if(A){y=Object.assign({},y);for(const w in y){const b=y[w];b!==void 0&&(A[w]=b)}}},f=(y,A,w,b)=>y.slice(0,w)+A+y.slice(b),p=y=>{const A=h();if(!A)return;const w=A.selectionStart??0,b=A.selectionEnd??0,C=A.value,I=!y&&w===b&&w>0?w-1:w;let x;C.includes(".")&&y==="."?x=f(C,"",I,b):x=f(C,y,I,b),y==="-"&&(C.includes("-")?x=C.replace("-",""):x="-"+C),u.value=x,Yi(()=>{const T=b+(x.length-C.length);A.setSelectionRange(T,T),A.blur(),A.focus();const O=x?[".","-","-."].includes(x)?null:Number(x):null;r("update:model-value",O)})};function g(){return p("")}function m(){u.value=null,r("update:model-value",null)}function v(){var y;(y=s.value)==null||y.focus(),Yi(()=>{var w;const A=h();if(A){const b=((w=u.value)==null?void 0:w.length)||0;A.setSelectionRange(b,b)}})}return e({inputVal:u,insertText:p,deleteText:g,deleteAllText:m,focus:v,blur:()=>{var y;(y=s.value)==null||y.blur()}}),(y,A)=>{const w=Jo;return V(),Ie(w,ht({ref_key:"inputField",ref:s,modelValue:u.value,"onUpdate:modelValue":A[0]||(A[0]=b=>u.value=b),class:"input-number","input-align":"left",type:"number"},y.$attrs,{onBlur:y.onBlur,onPaste:c}),null,16,["modelValue","onBlur"])}}}),Fa=4,Ff=8,oee=".custom-number-keyboard-wrapper",bst=".m-canvas-container",wst=248,xst=240,Cst=n=>{const e=document.querySelector(n.targetEle),t=document.querySelector(oee),i=document.querySelector((n==null?void 0:n.parentEle)||"body"),r=document.body.clientHeight,s=document.body.clientWidth,o=(t==null?void 0:t.clientHeight)||wst,a=(t==null?void 0:t.clientWidth)||xst,l=e==null?void 0:e.getBoundingClientRect().top,c=e==null?void 0:e.getBoundingClientRect().bottom;if(n.type==="left"){const u=i==null?void 0:i.getBoundingClientRect().left;l+o<r-Ff?t==null||t.setAttribute("style",`left: ${u-a-Fa}px; top: ${l}px;`):t==null||t.setAttribute("style",`left: ${u-a-Fa}px; top: ${r-o-Ff}px;`)}else{const u=e==null?void 0:e.getBoundingClientRect().right,h=e==null?void 0:e.getBoundingClientRect().left;if(l+o>r-Ff)if(u+a>s-Ff){t==null||t.setAttribute("style",`left: ${h-Fa-a}px; top: ${c-o+n.offsetY}px;`);return}else{t==null||t.setAttribute("style",`left: ${u+Fa}px; top: ${c-o+n.offsetY}px;`);return}if(u+a>s-Fa){t==null||t.setAttribute("style",`left: ${h-a-Fa}px; top: ${l+n.offsetY}px;`);return}t==null||t.setAttribute("style",`left: ${u+Fa}px; top: ${l+n.offsetY}px;`)}},Est=n=>{const{left:e,top:t,right:i,bottom:r}=n,s=document.querySelector(bst),{right:o,height:a}=s==null?void 0:s.getBoundingClientRect(),l=document.querySelector(oee),{width:c,height:u}=l==null?void 0:l.getBoundingClientRect();if(i+c>o-Ff)if(t+u>a-Ff){l==null||l.setAttribute("style",`left: ${e-c-Fa}px; top: ${r-u}px;`);return}else{l==null||l.setAttribute("style",`left: ${e-c-Fa}px; top: ${t}px;`);return}if(t+u>a-Ff){l==null||l.setAttribute("style",`left: ${i+Fa}px; top: ${a-u-Fa}px;`);return}l==null||l.setAttribute("style",`left: ${i+Fa}px; top: ${t}px;`)},Tst={id:"x-number-keyboard-header",class:"keyboard-header"},Ist={key:0,class:"divided-sign"},Sst={class:"unit"},Pst=["id","onClick"],Mst={key:0,class:"three-column"},Rst={id:"x-number-keyboard-minus",class:"box minus"},Dst={id:"x-number-keyboard-minus",class:"box zero"},kst={id:"x-number-keyboard-minus",class:"box dot"},Ost={key:1,class:"two-column"},Lst={id:"x-number-keyboard-tzero",class:"box only-zero"},Nst={id:"x-number-keyboard-tot",class:"box dot"},Bst="-",Fst=Fe({__name:"Index",props:{parentEle:{},targetEle:{},customOffsetY:{},position:{},inputVal:{},focusedIndex:{},unit:{},inputs:{},showMinus:{type:Boolean},customStyle:{},confirmCallback:{type:Function},closeCallback:{type:Function}},emits:["close"],setup(n,{expose:e,emit:t}){const i=n,r=t,s=pg(L9e);II(()=>s.uiState.currentTempXcs,()=>{r("close")});const o=ee(i.showMinus),a=ee([]),l=ee(!0),c=ee(Math.random()),u=ee(i.unit),h=ee(i.inputs),d=ee(0),f=te(()=>({"arrange-input":!x.value,"number-field-large":x.value,"small-input":x.value&&F.value})),p=P=>({"number-keyboard__field":x.value,"number-keyboard__field__double":!x.value,"number-keyboard__field__double_small":!x.value&&G(P)}),g=["seven","eight","nine","delete","four","five","six","delete-all","one","two","three","confirm"],m=()=>{const P=d.value;return a.value[P]||null},v=()=>{var k;const P=m();(k=P==null?void 0:P.deleteText)==null||k.call(P)},_=()=>{var k;const P=m();(k=P==null?void 0:P.deleteAllText)==null||k.call(P)},y=P=>{h.value[d.value].value=isNaN(Number(P))?"":Number(P)},w={delete:v,"delete-all":_,confirm:()=>{i.confirmCallback(h.value),I()}},b=P=>`box ${P}`,C=P=>{w[P]?w[P]():B(event)},I=()=>{var P,k;l.value=!1;for(let L=0;L<a.value.length;L++)((P=a.value[L])==null?void 0:P.inputVal)!==void 0&&((k=a.value[L])==null||k.blur());r("close"),i==null||i.closeCallback()},x=te(()=>h.value.length===1);Zn(()=>{var k;const P=document.querySelectorAll(".custom-number-keyboard-wrapper");P.length>0&&((k=P[0].parentNode)==null||k.remove()),Yi(()=>{var H;T(i.position);const L=a.value[i.focusedIndex];L&&((H=L.focus)==null||H.call(L))})});const T=P=>{const k={type:P,parentEle:i.parentEle,targetEle:i.targetEle,offsetY:i.customOffsetY??0};Cst(k)},O=P=>{d.value=P},F=te(()=>h.value[0].value&&h.value[0].value.toString().length>12),G=P=>h.value[P].value&&h.value[P].value.toString().length>4,B=P=>{var H;const k=m(),L=P.target.innerHTML;k&&((H=k.insertText)==null||H.call(k,L))};return e({changePosition:P=>{Est(P)}}),(P,k)=>{const L=Yee("click-outside");return l.value?tg((V(),le("div",{key:0,id:"x-number-keyboard",class:"custom-number-keyboard-wrapper",style:On(P.customStyle)},[ue("div",Tst,[(V(),le("div",{id:"x-number-keyboard-header-randKey",key:c.value,class:St(f.value)},[(V(!0),le(vt,null,Fn(h.value,(H,U)=>(V(),le(vt,{key:U},[ye(Ast,{id:H.id,ref_for:!0,ref_key:"inputRefs",ref:a,modelValue:H.value,"onUpdate:modelValue":$=>H.value=$,class:St(p(U)),"dom-props":{type:"text",inputMode:"none"},onFocus:$=>O(U),onChange:y},null,8,["id","modelValue","onUpdate:modelValue","class","onFocus"]),!x.value&&U===0?(V(),le("div",Ist,Te(Bst))):$e("",!0)],64))),128))],2)),ue("label",Sst,Te(u.value),1)]),ue("div",{id:"x-number-keyboard-container",class:"container",onClick:B},[(V(),le(vt,null,Fn(g,H=>ue("div",{id:`x-number-keyboard-${H}`,key:H,class:St(b(H)),onClick:dr(U=>C(H),["stop"])},[["delete","delete-all","confirm"].includes(H)?(V(),Ie(Be(Nn),{key:0,id:`x-number-keyboard-commond-${H}`,name:"keyboard-"+H,class:St({"f-s-24":H==="confirm","f-s-20":H!=="confirm"}),size:H==="confirm"?"24px":"20px"},null,8,["id","name","class","size"])):(V(),le(vt,{key:1},[Gt(Te(Be(vf)[H.toUpperCase()]),1)],64))],10,Pst)),64)),o.value?(V(),le("div",Mst,[ue("div",Rst,Te(Be(vf).MINUS),1),ue("div",Dst,Te(Be(vf).ZERO),1),ue("div",kst,Te(Be(vf).DOT),1)])):(V(),le("div",Ost,[ue("div",Lst,Te(Be(vf).ZERO),1),ue("div",Nst,Te(Be(vf).DOT),1)]))])],4)),[[L,I]]):$e("",!0)}}}),Ust=dt(Fst,[["__scopeId","data-v-558a3271"]]),$I=Object.assign,Gst=n=>n!==null&&typeof n=="object",Hst=typeof window<"u";function Vst(n){const e=d6(n),t=document.createElement("div");return document.body.appendChild(t),{instance:e.mount(t),unmount(){e.unmount(),document.body.removeChild(t)}}}function zst(n){const e=jv();e&&$I(e.proxy,n)}function $st(){const n=qr({show:!1}),e=r=>{n.show=r},t=r=>{$I(n,r,{transitionAppear:!0}),e(!0)},i=r=>{e(!1),setTimeout(()=>{r&&r()},500)};return zst({open:t,close:i,toggle:e}),{open:t,close:i,state:n,toggle:e}}function Wst(n,e,t){return e.reduce((i,r)=>((!t||n[r]!==void 0)&&(i[r]=n[r]),i),{})}const jst=n=>n!=null,L$=null,K_=[Number,String],Qst=n=>({type:Number,default:n}),HP=n=>({type:String,default:n});function Kk(n,e){return e?typeof e=="string"?` ${n}--${e}`:Array.isArray(e)?e.reduce((t,i)=>t+Kk(n,i),""):Object.keys(e).reduce((t,i)=>t+(e[i]?Kk(n,i):""),""):""}function Xst(n){return(e,t)=>(e&&(t=e,e=""),e=e?`${n}__${e}`:n,`${e}${Kk(e,t)}`)}function Yst(n){const e=`mk-${n}`;return[e,Xst(e)]}const qst=/-(\w)/g,Kst=n=>n.replace(qst,(e,t)=>t.toUpperCase());function Jst(n){return n.install=e=>{const{name:t}=n;t&&(e.component(t,n),e.component(Kst(`-${t}`),n))},n}const Zst=8;function N$(n){const e=document.querySelectorAll(".mk-toast"),t=Array.from(e).filter(i=>!i.classList.contains("mk-toast--vertical"));t.forEach((i,r)=>{r===0?i.setAttribute("style",`top: ${n}px !important`):Yi(()=>{const s=t[r-1].getBoundingClientRect().bottom,o=i.getBoundingClientRect().height;i.setAttribute("style",`top: ${s+o/2+Zst}px !important`)})})}let J_=0;function eot(n){n?(J_||document.body.classList.add("mk-toast--unclickable"),J_++):J_&&(J_--,J_||document.body.classList.remove("mk-toast--unclickable"))}const[tot,not]=Yst("toast"),iot=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],rot={icon:String,show:Boolean,type:HP("text"),overlay:Boolean,message:K_,iconSize:K_,duration:Qst(3e3),position:HP("top"),teleport:[String,Object],wordBreak:String,className:L$,iconPrefix:String,transition:HP("mk-fade"),forbidClick:Boolean,overlayClass:L$,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:K_,closeable:Boolean,bckWhiteColor:Boolean,linkTips:String,closeCb:Function,confirmCb:Function,openCb:Function,customCb:Function,scene:K_,source:String,layout:String,btnLabel:String,topDistance:K_,needOverride:Boolean,addSpace:Boolean},VP={error:"mk-toast-error",info:"mk-toast-info",success:"mk-toast-success",warning:"mk-toast-warning",close:"icon-close",loading:"mk-toast-loading",confirm:"mk-toast-confirm"},B$=24,sot=8,aee=Fe({name:tot,props:rot,emits:["update:show"],setup(n,{emit:e,slots:t}){let i,r=!1,s,o,a,l;const c=()=>{const A=n.show&&n.forbidClick;r!==A&&(r=A,eot(r))},u=A=>e("update:show",A),h=()=>{n.closeOnClick&&u(!1),n.linkTips&&a&&(a(),u(!1))},d=A=>{A.stopPropagation(),u(!1),s&&s()},f=A=>{A.stopPropagation(),u(!1),s&&s()},p=A=>{A.stopPropagation(),u(!1),o&&o()},g=A=>{A.stopPropagation(),u(!1),l&&l()},m=()=>clearTimeout(i),v=A=>{const{icon:w,type:b,iconSize:C=20,iconPrefix:I,scene:x}=n,T=w||b==="success"||b==="error"||b==="warning";let O=VP[w]||VP[b];if(O||(O=T),A&&(O=VP[A]),T)return ye(Nn,{name:O||b,size:C,classPrefix:I,color:"#1a1a1e",class:`f-s-${C}`},null)},_=()=>{const{type:A,message:w,linkTips:b}=n;if(t.message)return ye("div",{class:{"mk-toast-text":!0,"mk-toast-text_bc_white":n.bckWhiteColor,"mk-toast-text_no_prefix":!n.icon,"mk-toast-text_photo":n.source==="mobile"&&n.bckWhiteColor&&n.scene===2}},[t.message()]);if(jst(w)&&w!=="")return A==="html"?ye("div",{class:{"mobile-text-link-wrap":n.source==="mobile"&&n.bckWhiteColor&&n.scene===2,"mobile-text-link-common-wrap":n.source==="mobile"&&n.bckWhiteColor&&n.scene!==2,"pad-text-link-wrap":n.source!=="mobile"}},[ye("div",{key:0,class:"mk-toast-text",innerHTML:String(w)},null),b&&(n.addSpace||typeof n.addSpace>"u")&&ye("span",null,[Gt(" ")]),b&&ye("a",{key:1,class:["mk-toast-text","mk-toast-text-link",n.source==="mobile"&&n.bckWhiteColor?"mk-toast-text-link_mobile":""],innerHTML:String(b)},null)]):ye("div",{class:{"mk-toast-text":!0,"mk-toast-text_bc_white":n.bckWhiteColor,"mk-toast-text_no_prefix":!n.icon,"mk-toast-text_photo":n.source==="mobile"&&n.bckWhiteColor&&n.scene===2}},[w])},y=()=>{const A=document.querySelectorAll(".mk-toast"),w=Array.from(A).filter(b=>!b.classList.contains("mk-toast--vertical"));w.forEach((b,C)=>{C===0?n.source==="mobile"?n.layout&&n.layout!=="vertical"&&b.setAttribute("style",`top: ${n.topDistance||103}px !important`):b.setAttribute("style",`top: ${n.topDistance||126}px !important`):Yi(()=>{const P=w[C-1].getBoundingClientRect().bottom,k=b.getBoundingClientRect().height;b.setAttribute("style",`top: ${P+k/2+sot}px !important`)});const I=b.querySelector(".mk-toast-text"),x=b.querySelector(".icon-wrapper"),T=b.querySelector(".close"),O=b.querySelector(".btn-close"),F=b.querySelector(".btn-confirm"),G=b.querySelector(".btn-refresh"),B=I==null?void 0:I.getBoundingClientRect().height,R=b==null?void 0:b.querySelector(".mk-toast-text-link");n.layout!=="vertical"&&(B>B$||R)&&(x==null||x.classList.add("icon-wrapper__more"),T==null||T.classList.add("close__more"),O==null||O.classList.add("btn-close__more"),F==null||F.classList.add("btn-confirm__more"),G==null||G.classList.add("btn-refresh__more")),B<=B$&&!n.bckWhiteColor&&(I==null||I.classList.add("mk-toast-text_single"),b==null||b.classList.add("mk-toast_single"))})};return yt(()=>[n.show,n.forbidClick],c),yt(()=>[n.show,n.type,n.message,n.duration],()=>{m(),n.show&&Yi(()=>{y()}),n.show&&n.duration>0&&(i=setTimeout(()=>{u(!1)},n.duration))}),yt(()=>n.show,A=>{A&&(s=n==null?void 0:n.closeCb,o=n==null?void 0:n.confirmCb,a=n==null?void 0:n.openCb,l=n==null?void 0:n.customCb)}),Zn(c),L0(c),()=>ye(Ko,ht({class:[not([n.position,n.icon,n.wordBreak==="normal"?"break-normal":n.wordBreak,{[n.type]:!n.icon},{"bck-white-color":n.bckWhiteColor},{mobile:n.source==="mobile"},{vertical:n.layout==="vertical"},{mobile_white:n.source==="mobile"&&n.bckWhiteColor}]),n.className],teleport:n.teleport,lockScroll:!1,onClick:h,onClosed:m,"onUpdate:show":u},Wst(n,iot)),{default:()=>[ye("div",{class:["icon-wrapper",{"icon-wrapper_no":!n.icon}]},[v()]),_(),ye("div",{class:["close",{"unseen-close":!n.closeable}],onClick:d},[v("close")]),n.scene===1&&ye("div",{class:["btn-close"],onClick:f},[v("close")]),n.scene===1&&ye("div",{class:["btn-confirm"],onClick:p},[v("confirm")]),n.scene===2&&ye("div",{class:["btn-refresh"],onClick:g},[n.btnLabel])]})}}),oot={uniqueId:"",icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:3e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"top",transition:"mk-fade",forbidClick:!1,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1,topDistance:103,order:-1,needOverride:!1};let po=[],WI=!1,F$=$I({},oot);const aot=new Map;function lot(n){return Gst(n)?n:{message:n}}function cot(n,e,t,i,r){const{instance:s,unmount:o}=Vst({setup(){const a=ee(""),l=n,{open:c,state:u,close:h,toggle:d}=$st(),f=()=>{if(WI){po=po.filter(A=>A!==s);const m=e,v=t,_=i,y=r;o(),_&&_==="mobile"?y&&y!=="vertical"&&N$(v?m||125:m||103):N$(v?m||116:m||126)}},p=()=>u.show,g=()=>ye(aee,ht(u,{onClosed:f,"onUpdate:show":d}),null);return yt(a,m=>{u.message=m}),jv().render=g,{open:c,close:h,message:a,id:l,onClosed:f,getShow:p}}});return s}function uot({uniqueId:n,order:e,topDistance:t,linkTips:i,source:r,layout:s,needOverride:o}={}){if(!po.length||WI){po.forEach(l=>{l.id===n&&o&&l.close()}),po=po.filter(l=>l.id!==n);const a=cot(n,t,i,r,s);e&&e===-1?po.unshift(a):po.push(a)}return po[po.length-1]}function lee(n={}){if(!Hst)return{};const e=uot({uniqueId:n==null?void 0:n.uniqueId,order:n==null?void 0:n.order,topDistance:n==null?void 0:n.topDistance,linkTips:n==null?void 0:n.linkTips,source:n==null?void 0:n.source,layout:n==null?void 0:n.layout,needOverride:n==null?void 0:n.needOverride}),t=lot(n);return e.open($I({},F$,aot.get(t.type||F$.type),t)),e}const hot=n=>{var e;po.length&&(n?(po.forEach(t=>{t.close()}),po=[]):WI?(e=po.shift())==null||e.close():po[0].close())},cee=(n=!0)=>{WI=n},dot=Jst(aee);var $o="top",cl="bottom",ul="right",Wo="left",EN="auto",bb=[$o,cl,ul,Wo],Hv="start",KA="end",fot="clippingParents",uee="viewport",Z_="popper",pot="reference",U$=bb.reduce(function(n,e){return n.concat([e+"-"+Hv,e+"-"+KA])},[]),hee=[].concat(bb,[EN]).reduce(function(n,e){return n.concat([e,e+"-"+Hv,e+"-"+KA])},[]),got="beforeRead",mot="read",vot="afterRead",_ot="beforeMain",yot="main",Aot="afterMain",bot="beforeWrite",wot="write",xot="afterWrite",Cot=[got,mot,vot,_ot,yot,Aot,bot,wot,xot];function Vc(n){return n?(n.nodeName||"").toLowerCase():null}function Aa(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function eg(n){var e=Aa(n).Element;return n instanceof e||n instanceof Element}function tl(n){var e=Aa(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function TN(n){if(typeof ShadowRoot>"u")return!1;var e=Aa(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Eot(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var i=e.styles[t]||{},r=e.attributes[t]||{},s=e.elements[t];!tl(s)||!Vc(s)||(Object.assign(s.style,i),Object.keys(r).forEach(function(o){var a=r[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function Tot(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(i){var r=e.elements[i],s=e.attributes[i]||{},o=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:t[i]),a=o.reduce(function(l,c){return l[c]="",l},{});!tl(r)||!Vc(r)||(Object.assign(r.style,a),Object.keys(s).forEach(function(l){r.removeAttribute(l)}))})}}const Iot={name:"applyStyles",enabled:!0,phase:"write",fn:Eot,effect:Tot,requires:["computeStyles"]};function Bc(n){return n.split("-")[0]}var Dp=Math.max,RE=Math.min,Vv=Math.round;function Jk(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function dee(){return!/^((?!chrome|android).)*safari/i.test(Jk())}function zv(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var i=n.getBoundingClientRect(),r=1,s=1;e&&tl(n)&&(r=n.offsetWidth>0&&Vv(i.width)/n.offsetWidth||1,s=n.offsetHeight>0&&Vv(i.height)/n.offsetHeight||1);var o=eg(n)?Aa(n):window,a=o.visualViewport,l=!dee()&&t,c=(i.left+(l&&a?a.offsetLeft:0))/r,u=(i.top+(l&&a?a.offsetTop:0))/s,h=i.width/r,d=i.height/s;return{width:h,height:d,top:u,right:c+h,bottom:u+d,left:c,x:c,y:u}}function IN(n){var e=zv(n),t=n.offsetWidth,i=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:i}}function fee(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&TN(t)){var i=e;do{if(i&&n.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function lh(n){return Aa(n).getComputedStyle(n)}function Sot(n){return["table","td","th"].indexOf(Vc(n))>=0}function Vd(n){return((eg(n)?n.ownerDocument:n.document)||window.document).documentElement}function jI(n){return Vc(n)==="html"?n:n.assignedSlot||n.parentNode||(TN(n)?n.host:null)||Vd(n)}function G$(n){return!tl(n)||lh(n).position==="fixed"?null:n.offsetParent}function Pot(n){var e=/firefox/i.test(Jk()),t=/Trident/i.test(Jk());if(t&&tl(n)){var i=lh(n);if(i.position==="fixed")return null}var r=jI(n);for(TN(r)&&(r=r.host);tl(r)&&["html","body"].indexOf(Vc(r))<0;){var s=lh(r);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return r;r=r.parentNode}return null}function wb(n){for(var e=Aa(n),t=G$(n);t&&Sot(t)&&lh(t).position==="static";)t=G$(t);return t&&(Vc(t)==="html"||Vc(t)==="body"&&lh(t).position==="static")?e:t||Pot(n)||e}function SN(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Xy(n,e,t){return Dp(n,RE(e,t))}function Mot(n,e,t){var i=Xy(n,e,t);return i>t?t:i}function pee(){return{top:0,right:0,bottom:0,left:0}}function gee(n){return Object.assign({},pee(),n)}function mee(n,e){return e.reduce(function(t,i){return t[i]=n,t},{})}var Rot=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,gee(typeof e!="number"?e:mee(e,bb))};function Dot(n){var e,t=n.state,i=n.name,r=n.options,s=t.elements.arrow,o=t.modifiersData.popperOffsets,a=Bc(t.placement),l=SN(a),c=[Wo,ul].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!o)){var h=Rot(r.padding,t),d=IN(s),f=l==="y"?$o:Wo,p=l==="y"?cl:ul,g=t.rects.reference[u]+t.rects.reference[l]-o[l]-t.rects.popper[u],m=o[l]-t.rects.reference[l],v=wb(s),_=v?l==="y"?v.clientHeight||0:v.clientWidth||0:0,y=g/2-m/2,A=h[f],w=_-d[u]-h[p],b=_/2-d[u]/2+y,C=Xy(A,b,w),I=l;t.modifiersData[i]=(e={},e[I]=C,e.centerOffset=C-b,e)}}function kot(n){var e=n.state,t=n.options,i=t.element,r=i===void 0?"[data-popper-arrow]":i;r!=null&&(typeof r=="string"&&(r=e.elements.popper.querySelector(r),!r)||fee(e.elements.popper,r)&&(e.elements.arrow=r))}const Oot={name:"arrow",enabled:!0,phase:"main",fn:Dot,effect:kot,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function $v(n){return n.split("-")[1]}var Lot={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Not(n,e){var t=n.x,i=n.y,r=e.devicePixelRatio||1;return{x:Vv(t*r)/r||0,y:Vv(i*r)/r||0}}function H$(n){var e,t=n.popper,i=n.popperRect,r=n.placement,s=n.variation,o=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,h=n.isFixed,d=o.x,f=d===void 0?0:d,p=o.y,g=p===void 0?0:p,m=typeof u=="function"?u({x:f,y:g}):{x:f,y:g};f=m.x,g=m.y;var v=o.hasOwnProperty("x"),_=o.hasOwnProperty("y"),y=Wo,A=$o,w=window;if(c){var b=wb(t),C="clientHeight",I="clientWidth";if(b===Aa(t)&&(b=Vd(t),lh(b).position!=="static"&&a==="absolute"&&(C="scrollHeight",I="scrollWidth")),b=b,r===$o||(r===Wo||r===ul)&&s===KA){A=cl;var x=h&&b===w&&w.visualViewport?w.visualViewport.height:b[C];g-=x-i.height,g*=l?1:-1}if(r===Wo||(r===$o||r===cl)&&s===KA){y=ul;var T=h&&b===w&&w.visualViewport?w.visualViewport.width:b[I];f-=T-i.width,f*=l?1:-1}}var O=Object.assign({position:a},c&&Lot),F=u===!0?Not({x:f,y:g},Aa(t)):{x:f,y:g};if(f=F.x,g=F.y,l){var G;return Object.assign({},O,(G={},G[A]=_?"0":"",G[y]=v?"0":"",G.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",G))}return Object.assign({},O,(e={},e[A]=_?g+"px":"",e[y]=v?f+"px":"",e.transform="",e))}function Bot(n){var e=n.state,t=n.options,i=t.gpuAcceleration,r=i===void 0?!0:i,s=t.adaptive,o=s===void 0?!0:s,a=t.roundOffsets,l=a===void 0?!0:a,c={placement:Bc(e.placement),variation:$v(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,H$(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,H$(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Fot={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Bot,data:{}};var xx={passive:!0};function Uot(n){var e=n.state,t=n.instance,i=n.options,r=i.scroll,s=r===void 0?!0:r,o=i.resize,a=o===void 0?!0:o,l=Aa(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",t.update,xx)}),a&&l.addEventListener("resize",t.update,xx),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",t.update,xx)}),a&&l.removeEventListener("resize",t.update,xx)}}const Got={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Uot,data:{}};var Hot={left:"right",right:"left",bottom:"top",top:"bottom"};function iC(n){return n.replace(/left|right|bottom|top/g,function(e){return Hot[e]})}var Vot={start:"end",end:"start"};function V$(n){return n.replace(/start|end/g,function(e){return Vot[e]})}function PN(n){var e=Aa(n),t=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:t,scrollTop:i}}function MN(n){return zv(Vd(n)).left+PN(n).scrollLeft}function zot(n,e){var t=Aa(n),i=Vd(n),r=t.visualViewport,s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var c=dee();(c||!c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+MN(n),y:l}}function $ot(n){var e,t=Vd(n),i=PN(n),r=(e=n.ownerDocument)==null?void 0:e.body,s=Dp(t.scrollWidth,t.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Dp(t.scrollHeight,t.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+MN(n),l=-i.scrollTop;return lh(r||t).direction==="rtl"&&(a+=Dp(t.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function RN(n){var e=lh(n),t=e.overflow,i=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+r+i)}function vee(n){return["html","body","#document"].indexOf(Vc(n))>=0?n.ownerDocument.body:tl(n)&&RN(n)?n:vee(jI(n))}function Yy(n,e){var t;e===void 0&&(e=[]);var i=vee(n),r=i===((t=n.ownerDocument)==null?void 0:t.body),s=Aa(i),o=r?[s].concat(s.visualViewport||[],RN(i)?i:[]):i,a=e.concat(o);return r?a:a.concat(Yy(jI(o)))}function Zk(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Wot(n,e){var t=zv(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function z$(n,e,t){return e===uee?Zk(zot(n,t)):eg(e)?Wot(e,t):Zk($ot(Vd(n)))}function jot(n){var e=Yy(jI(n)),t=["absolute","fixed"].indexOf(lh(n).position)>=0,i=t&&tl(n)?wb(n):n;return eg(i)?e.filter(function(r){return eg(r)&&fee(r,i)&&Vc(r)!=="body"}):[]}function Qot(n,e,t,i){var r=e==="clippingParents"?jot(n):[].concat(e),s=[].concat(r,[t]),o=s[0],a=s.reduce(function(l,c){var u=z$(n,c,i);return l.top=Dp(u.top,l.top),l.right=RE(u.right,l.right),l.bottom=RE(u.bottom,l.bottom),l.left=Dp(u.left,l.left),l},z$(n,o,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function _ee(n){var e=n.reference,t=n.element,i=n.placement,r=i?Bc(i):null,s=i?$v(i):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(r){case $o:l={x:o,y:e.y-t.height};break;case cl:l={x:o,y:e.y+e.height};break;case ul:l={x:e.x+e.width,y:a};break;case Wo:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=r?SN(r):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case Hv:l[c]=l[c]-(e[u]/2-t[u]/2);break;case KA:l[c]=l[c]+(e[u]/2-t[u]/2);break}}return l}function JA(n,e){e===void 0&&(e={});var t=e,i=t.placement,r=i===void 0?n.placement:i,s=t.strategy,o=s===void 0?n.strategy:s,a=t.boundary,l=a===void 0?fot:a,c=t.rootBoundary,u=c===void 0?uee:c,h=t.elementContext,d=h===void 0?Z_:h,f=t.altBoundary,p=f===void 0?!1:f,g=t.padding,m=g===void 0?0:g,v=gee(typeof m!="number"?m:mee(m,bb)),_=d===Z_?pot:Z_,y=n.rects.popper,A=n.elements[p?_:d],w=Qot(eg(A)?A:A.contextElement||Vd(n.elements.popper),l,u,o),b=zv(n.elements.reference),C=_ee({reference:b,element:y,strategy:"absolute",placement:r}),I=Zk(Object.assign({},y,C)),x=d===Z_?I:b,T={top:w.top-x.top+v.top,bottom:x.bottom-w.bottom+v.bottom,left:w.left-x.left+v.left,right:x.right-w.right+v.right},O=n.modifiersData.offset;if(d===Z_&&O){var F=O[r];Object.keys(T).forEach(function(G){var B=[ul,cl].indexOf(G)>=0?1:-1,R=[$o,cl].indexOf(G)>=0?"y":"x";T[G]+=F[R]*B})}return T}function Xot(n,e){e===void 0&&(e={});var t=e,i=t.placement,r=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?hee:l,u=$v(i),h=u?a?U$:U$.filter(function(p){return $v(p)===u}):bb,d=h.filter(function(p){return c.indexOf(p)>=0});d.length===0&&(d=h);var f=d.reduce(function(p,g){return p[g]=JA(n,{placement:g,boundary:r,rootBoundary:s,padding:o})[Bc(g)],p},{});return Object.keys(f).sort(function(p,g){return f[p]-f[g]})}function Yot(n){if(Bc(n)===EN)return[];var e=iC(n);return[V$(n),e,V$(e)]}function qot(n){var e=n.state,t=n.options,i=n.name;if(!e.modifiersData[i]._skip){for(var r=t.mainAxis,s=r===void 0?!0:r,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,c=t.padding,u=t.boundary,h=t.rootBoundary,d=t.altBoundary,f=t.flipVariations,p=f===void 0?!0:f,g=t.allowedAutoPlacements,m=e.options.placement,v=Bc(m),_=v===m,y=l||(_||!p?[iC(m)]:Yot(m)),A=[m].concat(y).reduce(function(ne,ve){return ne.concat(Bc(ve)===EN?Xot(e,{placement:ve,boundary:u,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:g}):ve)},[]),w=e.rects.reference,b=e.rects.popper,C=new Map,I=!0,x=A[0],T=0;T<A.length;T++){var O=A[T],F=Bc(O),G=$v(O)===Hv,B=[$o,cl].indexOf(F)>=0,R=B?"width":"height",P=JA(e,{placement:O,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),k=B?G?ul:Wo:G?cl:$o;w[R]>b[R]&&(k=iC(k));var L=iC(k),H=[];if(s&&H.push(P[F]<=0),a&&H.push(P[k]<=0,P[L]<=0),H.every(function(ne){return ne})){x=O,I=!1;break}C.set(O,H)}if(I)for(var U=p?3:1,$=function(ve){var Pe=A.find(function(De){var Xe=C.get(De);if(Xe)return Xe.slice(0,ve).every(function(Ne){return Ne})});if(Pe)return x=Pe,"break"},j=U;j>0;j--){var Q=$(j);if(Q==="break")break}e.placement!==x&&(e.modifiersData[i]._skip=!0,e.placement=x,e.reset=!0)}}const Kot={name:"flip",enabled:!0,phase:"main",fn:qot,requiresIfExists:["offset"],data:{_skip:!1}};function $$(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function W$(n){return[$o,ul,cl,Wo].some(function(e){return n[e]>=0})}function Jot(n){var e=n.state,t=n.name,i=e.rects.reference,r=e.rects.popper,s=e.modifiersData.preventOverflow,o=JA(e,{elementContext:"reference"}),a=JA(e,{altBoundary:!0}),l=$$(o,i),c=$$(a,r,s),u=W$(l),h=W$(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const Zot={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Jot};function eat(n,e,t){var i=Bc(n),r=[Wo,$o].indexOf(i)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[Wo,ul].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}function tat(n){var e=n.state,t=n.options,i=n.name,r=t.offset,s=r===void 0?[0,0]:r,o=hee.reduce(function(u,h){return u[h]=eat(h,e.rects,s),u},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[i]=o}const nat={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tat};function iat(n){var e=n.state,t=n.name;e.modifiersData[t]=_ee({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const rat={name:"popperOffsets",enabled:!0,phase:"read",fn:iat,data:{}};function sat(n){return n==="x"?"y":"x"}function oat(n){var e=n.state,t=n.options,i=n.name,r=t.mainAxis,s=r===void 0?!0:r,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,c=t.rootBoundary,u=t.altBoundary,h=t.padding,d=t.tether,f=d===void 0?!0:d,p=t.tetherOffset,g=p===void 0?0:p,m=JA(e,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),v=Bc(e.placement),_=$v(e.placement),y=!_,A=SN(v),w=sat(A),b=e.modifiersData.popperOffsets,C=e.rects.reference,I=e.rects.popper,x=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,T=typeof x=="number"?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),O=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,F={x:0,y:0};if(b){if(s){var G,B=A==="y"?$o:Wo,R=A==="y"?cl:ul,P=A==="y"?"height":"width",k=b[A],L=k+m[B],H=k-m[R],U=f?-I[P]/2:0,$=_===Hv?C[P]:I[P],j=_===Hv?-I[P]:-C[P],Q=e.elements.arrow,ne=f&&Q?IN(Q):{width:0,height:0},ve=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:pee(),Pe=ve[B],De=ve[R],Xe=Xy(0,C[P],ne[P]),Ne=y?C[P]/2-U-Xe-Pe-T.mainAxis:$-Xe-Pe-T.mainAxis,et=y?-C[P]/2+U+Xe+De+T.mainAxis:j+Xe+De+T.mainAxis,ze=e.elements.arrow&&wb(e.elements.arrow),de=ze?A==="y"?ze.clientTop||0:ze.clientLeft||0:0,lt=(G=O==null?void 0:O[A])!=null?G:0,he=k+Ne-lt-de,Ce=k+et-lt,se=Xy(f?RE(L,he):L,k,f?Dp(H,Ce):H);b[A]=se,F[A]=se-k}if(a){var Re,He=A==="x"?$o:Wo,Y=A==="x"?cl:ul,W=b[w],ge=w==="y"?"height":"width",Le=W+m[He],Ve=W-m[Y],pe=[$o,Wo].indexOf(v)!==-1,fe=(Re=O==null?void 0:O[w])!=null?Re:0,Ee=pe?Le:W-C[ge]-I[ge]-fe+T.altAxis,oe=pe?W+C[ge]+I[ge]-fe-T.altAxis:Ve,Me=f&&pe?Mot(Ee,W,oe):Xy(f?Ee:Le,W,f?oe:Ve);b[w]=Me,F[w]=Me-W}e.modifiersData[i]=F}}const aat={name:"preventOverflow",enabled:!0,phase:"main",fn:oat,requiresIfExists:["offset"]};function lat(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function cat(n){return n===Aa(n)||!tl(n)?PN(n):lat(n)}function uat(n){var e=n.getBoundingClientRect(),t=Vv(e.width)/n.offsetWidth||1,i=Vv(e.height)/n.offsetHeight||1;return t!==1||i!==1}function hat(n,e,t){t===void 0&&(t=!1);var i=tl(e),r=tl(e)&&uat(e),s=Vd(e),o=zv(n,r,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!t)&&((Vc(e)!=="body"||RN(s))&&(a=cat(e)),tl(e)?(l=zv(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=MN(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function dat(n){var e=new Map,t=new Set,i=[];n.forEach(function(s){e.set(s.name,s)});function r(s){t.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&r(l)}}),i.push(s)}return n.forEach(function(s){t.has(s.name)||r(s)}),i}function fat(n){var e=dat(n);return Cot.reduce(function(t,i){return t.concat(e.filter(function(r){return r.phase===i}))},[])}function pat(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function gat(n){var e=n.reduce(function(t,i){var r=t[i.name];return t[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,t},{});return Object.keys(e).map(function(t){return e[t]})}var j$={placement:"bottom",modifiers:[],strategy:"absolute"};function Q$(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function mat(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,i=t===void 0?[]:t,r=e.defaultOptions,s=r===void 0?j$:r;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},j$,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},h=[],d=!1,f={state:u,setOptions:function(v){var _=typeof v=="function"?v(u.options):v;g(),u.options=Object.assign({},s,u.options,_),u.scrollParents={reference:eg(a)?Yy(a):a.contextElement?Yy(a.contextElement):[],popper:Yy(l)};var y=fat(gat([].concat(i,u.options.modifiers)));return u.orderedModifiers=y.filter(function(A){return A.enabled}),p(),f.update()},forceUpdate:function(){if(!d){var v=u.elements,_=v.reference,y=v.popper;if(Q$(_,y)){u.rects={reference:hat(_,wb(y),u.options.strategy==="fixed"),popper:IN(y)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(T){return u.modifiersData[T.name]=Object.assign({},T.data)});for(var A=0;A<u.orderedModifiers.length;A++){if(u.reset===!0){u.reset=!1,A=-1;continue}var w=u.orderedModifiers[A],b=w.fn,C=w.options,I=C===void 0?{}:C,x=w.name;typeof b=="function"&&(u=b({state:u,options:I,name:x,instance:f})||u)}}}},update:pat(function(){return new Promise(function(m){f.forceUpdate(),m(u)})}),destroy:function(){g(),d=!0}};if(!Q$(a,l))return f;f.setOptions(c).then(function(m){!d&&c.onFirstUpdate&&c.onFirstUpdate(m)});function p(){u.orderedModifiers.forEach(function(m){var v=m.name,_=m.options,y=_===void 0?{}:_,A=m.effect;if(typeof A=="function"){var w=A({state:u,name:v,instance:f,options:y}),b=function(){};h.push(w||b)}})}function g(){h.forEach(function(m){return m()}),h=[]}return f}}var vat=[Got,rat,Fot,Iot,nat,Kot,aat,Oot,Zot],_at=mat({defaultModifiers:vat});function yee(n,e="mk"){return`${e}-${n}`}const Wu=new WeakMap;let Cx=!1;const yat=63,Aat=1133,Aee={beforeMount(n,e){const t=X$(e),i=wat(t);let r=null,s=null;document.body.addEventListener("touchstart",o=>{s=setTimeout(()=>{n.contains(o.target)&&!i.hasAttribute("data-show")?(o.stopPropagation(),o.preventDefault(),r=setTimeout(()=>{xee(n),clearTimeout(r),Cx=!0,n.dispatchEvent(new CustomEvent("longpress",{detail:Cx}))},t.delay)):i.hasAttribute("data-show")&&zP(n)},t.pressTime||500)}),document.body.addEventListener("touchend",()=>{s!==null&&(clearTimeout(s),s=null,setTimeout(()=>{clearTimeout(r),zP(n),Cx=!1,n.dispatchEvent(new CustomEvent("longpress",{detail:Cx}))},800))}),Wu.set(n,{opts:t,popper:i,popperInstance:null})},updated(n,e){Wu.get(n)&&(Wu.get(n).opts=X$(e))},unmounted(n){zP(n),Wu.delete(n)}};function bat(){return{arrow:!0,disabled:!1,trigger:"click",content:"",showOnInit:!1,placement:"top",distance:12,extCls:"",sameWidth:!1,delay:0,pressTime:500,onShow:()=>{},onHide:()=>{}}}function X$(n){const e=bat();return typeof n.value=="object"?Object.assign(e,n.value):e.content=n.value,e}function bee(n,e){e.innerText=n}function wat(n){const{content:e,arrow:t,extCls:i}=n,r="9999",s=document.createElement("div");if(s.className=`${yee("popper")}${i}`,s.innerText=e,s.style.zIndex=String(r),bee(e,s),t){const o=wee();s.appendChild(o)}return s}function wee(){const n=document.createElement("div");return n.className=yee("popper-arrow"),n.setAttribute("data-popper-arrow",""),n}function xat(n,e){const{opts:t}=Wu.get(n),{placement:i,distance:r,showOnInit:s,sameWidth:o}=t,a=_at(n,e,{placement:i,modifiers:[{name:"offset",options:{offset:[0,r]}},{name:"preventOverflow",options:{boundary:"viewport",padding:15}},{name:"arrow",options:{padding:18}},...o?[{name:"sameWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:l})=>{l.styles.popper.width=`${l.rects.reference.width}px`},effect:({state:l})=>{l.elements.popper.style.overflowWrap="break-word",l.elements.popper.style.width=`${l.elements.reference.offsetWidth}px`}}]:[]]});return s&&xee(n),a}function xee(n){const{popper:e,opts:t}=Wu.get(n),{disabled:i,content:r,arrow:s,onShow:o,boundary:a}=t;if(Yi(()=>{const u=window.innerWidth,h=e.clientWidth;Math.abs(h-u/Aat*yat)<1&&(e.style.textAlign="center")}),i)return;if(bee(r,e),s){const u=wee();e.appendChild(u)}let l=document.body;a&&(a==="parent"?l=n.parentElement:a instanceof HTMLElement&&(l=a)),l.appendChild(e);const c=xat(n,e);o(),e.setAttribute("data-show",""),c.setOptions(u=>({...u,modifiers:[...u.modifiers,{name:"eventListeners",enabled:!0}]})),c.forceUpdate(),Wu.get(n).popperInstance=c}function zP(n){if(!Wu.get(n))return;const{popper:e,popperInstance:t,opts:i}=Wu.get(n),{onHide:r}=i;e&&document.body.contains(e)&&(e.removeAttribute("data-show"),t==null||t.destroy(),document.body.removeChild(e),r())}const Cat={class:"xcs-form-button"},Eat={key:0},Tat=Fe({__name:"Button",props:{pid:{},id:{},disabled:{type:Boolean},label:{},value:{},tag:{},href:{},text:{type:Boolean},loading:{type:Boolean},icon:{},iconSize:{},popoverProps:{},popoverContent:{},onClick:{type:Function},getRef:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=ee(!1),s=te(()=>t.loading||r.value),o=async()=>{if(t.id==="firmwareVersionButton"?jt(Zt.buttonClick,{elementId:ki.checkUpdate}):(t.id==="checkExtVersion"||t.id==="updateExtVersion")&&jt(Zt.buttonClick,{elementId:ki.instruction}),t.tag==="a"&&t.href){window.MeApi.openNative.openWebInApp(t.href);return}if(i("formChange",t.pid,t.id,t.value),t.onClick){const l=t.onClick();if(Object.prototype.toString.call(l)==="[object Promise]")try{r.value=!0,await l}finally{r.value=!1}}},a=()=>{t.href&&window.MeApi.openNative.openWebInApp(t.href)};return(l,c)=>{const u=Hi;return V(),le("div",Cat,[l.text&&l.tag==="a"?(V(),le("span",{key:0,class:St(["tag-a",{special:l.id=="unrecognizedLaser"}]),onClick:a},Te(l.label),3)):(V(),Ie(u,ht({key:1,id:l.id},l.$attrs,{ref:l.getRef,loading:s.value,disabled:l.disabled,class:"btn",onClick:o}),Pr({default:be(()=>[l.label?(V(),le("span",Eat,Te(s.value?"":l.label),1)):$e("",!0)]),_:2},[l.icon?{name:"icon",fn:be(()=>[ye(Be(Nn),{name:l.icon||"",size:l.iconSize,class:St(`f-s-${l.iconSize}`)},null,8,["name","size","class"])]),key:"0"}:void 0]),1040,["id","loading","disabled"]))])}}}),Iat=dt(Tat,[["__scopeId","data-v-cad26075"]]),Sat=Fe({__name:"Label",props:{label:{},labelWrapperClass:{},labelProps:{},isGroup:{type:Boolean},tips:{},showRedDot:{type:Boolean},arrow:{type:Boolean},titleColor:{},tipColor:{},href:{}},setup(n){const{t:e}=Yt(),t=n,i=()=>{var l,c,u,h;let s=((c=(l=t.tips)==null?void 0:l.content)==null?void 0:c.text)||"",o=(h=(u=t.tips)==null?void 0:u.content)==null?void 0:h.button,a=t.label;tt.modal.showRemindDialog({title:a||e("ipad.dialog.tips"),message:s,link:o==null?void 0:o.href,linkText:o==null?void 0:o.label,linkType:2,allowHtml:!1,defaultBtn:!0,confirmButtonText:e("ipad.dialog.got_it")})},r=()=>{t.href&&window.MeApi.openNative.openWebInApp(t.href)};return(s,o)=>{const a=Gs;return s.label?(V(),Ie(a,{key:0,class:St([[s.isGroup?"form-group-label":"input-label",s.labelWrapperClass],"xcs-form-label-wrap"])},{default:be(()=>[ue("span",{class:St([s.tips?"mr-1":"","label_tip"]),style:On({color:s.titleColor?s.titleColor:"#1A1A1E"})},Te(s.label),7),s.tips?(V(),Ie(Be(Nn),{key:0,name:"infomation",size:"20px",class:"f-s-20",onClick:i})):$e("",!0),s.arrow?(V(),Ie(Be(Nn),{key:1,name:"arrow_right",size:"22px",class:"f-s-20",onClick:r})):$e("",!0)]),_:1},8,["class"])):$e("",!0)}}}),zc=dt(Sat,[["__scopeId","data-v-26a2b456"]]),Pat={class:"xcs-button-group"},Mat={key:0},Rat=Fe({__name:"ButtonGroup",props:{id:{},label:{},labelProps:{},tips:{},spaceProps:{},optionsSpaceProps:{},options:{}},setup(n){const e=qr({}),t=async i=>{console.log("======item",i);const r=i.attrs&&i.attrs.onClick;r&&(e[i.id]=!0,await r(),e[i.id]=!1)};return(i,r)=>{const s=Hi,o=Gs;return V(),le("section",Pat,[ye(o,ht({size:4,vertical:""},i.spaceProps),{default:be(()=>[ye(zc,{label:i.label,tips:i.tips,"label-props":i.labelProps},null,8,["label","tips","label-props"]),ue("section",null,[ye(o,ht({size:16,align:"center"},i.optionsSpaceProps),{default:be(()=>[(V(!0),le(vt,null,Fn(i.options,a=>(V(),le("section",{key:a.id,class:"button-group-item"},[ye(s,ht({id:a.id},{...a.attrs,onClick:void 0},{loading:e[a.id]??!1,class:"btn",onClick:l=>t(a)}),Pr({default:be(()=>[i.label?(V(),le("span",Mat,Te(a.label),1)):$e("",!0)]),_:2},[i.icon?{name:"icon",fn:be(()=>[ye(Be(Nn),{name:a.icon||"",size:20,class:St(`f-s-${i.iconSize}`)},null,8,["name","class"])]),key:"0"}:void 0]),1040,["id","loading","onClick"])]))),128))]),_:1},16)])]),_:1},16)])}}}),Dat=dt(Rat,[["__scopeId","data-v-c592cf4f"]]),kat={key:0},Oat=Fe({__name:"Checkbox",props:{pid:{},id:{},label:{},labelProps:{},value:{type:Boolean},tips:{},multiState:{type:Boolean}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=ee(t.value),r=e,s=o=>{r("formChange",t.pid,t.id,o)};return(o,a)=>{const l=_T;return V(),Ie(l,ht({modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=c=>i.value=c),class:"x-checkbox"},o.$attrs,{onChange:s}),{default:be(()=>[o.label?(V(),le("span",kat,Te(o.label),1)):$e("",!0)]),_:1},16,["modelValue"])}}}),Lat={class:"xcs-checkbox-group"},Nat=Fe({__name:"CheckboxGroup",props:{pid:{},id:{},label:{},tips:{},value:{},spaceProps:{},options:{}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=ee(t.value),s=o=>{i("formChange",t.pid,t.id,o)};return(o,a)=>{const l=_T,c=g6;return V(),le("div",null,[ye(zc,{label:o.label,tips:o.tips},null,8,["label","tips"]),ue("section",Lat,[ye(c,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=u=>r.value=u),onChange:s},{default:be(()=>[(V(!0),le(vt,null,Fn(o.options,u=>(V(),Ie(l,{key:u.value,name:u.value,class:"checkbox","checked-color":"#28BE44","icon-size":"18px"},{default:be(()=>[Gt(Te(u.label),1)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])])}}}),Bat=dt(Nat,[["__scopeId","data-v-c2b9b99b"]]),Fat=Fe({__name:"Dropdown",props:{pid:{},id:{},label:{},icon:{},value:{}},emits:["formChange"],setup(n,{emit:e}){const{button:t,...i}=mT(),r=n,s=e,o=(a,l)=>{s("formChange",r.pid,r.id,l.value)};return(a,l)=>{const c=Hi,u=m6;return V(),Ie(u,ht({value:a.value},i,{onSelect:o}),{default:be(()=>[ye(c,jo(ch(Be(t))),{default:be(()=>[a.label?(V(),le(vt,{key:0},[Gt(Te(a.label),1)],64)):$e("",!0),a.icon?(V(),Ie(Be(Nn),{key:1,name:a.icon,class:"f-s-18"},null,8,["name"])):$e("",!0)]),_:1},16)]),_:1},16,["value"])}}}),Uat=Fe({__name:"Input",props:{pid:{},id:{},maxlength:{},value:{},defaultValue:{},prefix:{},suffix:{},label:{},labelWrapperClass:{},tips:{},onBlur:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=l=>{i("formChange",t.pid,t.id,l)},s=ee(),o=ee(t.value||t.defaultValue),a=()=>{t.onBlur(s.value,o),o.value&&r(o.value)};return yt(()=>t.value||t.defaultValue,l=>{o.value=l}),(l,c)=>{const u=Jo,h=Gs;return V(),Ie(h,{direction:"vertical",class:"xcs-form-input-wrap",fill:!0,size:10},{default:be(()=>[ue("section",null,[ye(zc,{label:l.label,tips:l.tips,"label-wrapper-class":l.labelWrapperClass},null,8,["label","tips","label-wrapper-class"])]),ue("section",null,[ye(u,ht({ref_key:"myField",ref:s},l.$attrs,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=d=>o.value=d),modelModifiers:{trim:!0},maxlength:l.maxlength||15,placeholder:"",class:"xcs-form-input",onBlur:a}),Pr({_:2},[l.prefix?{name:"left-icon",fn:be(()=>{var d,f;return[typeof l.prefix=="string"?(V(),le(vt,{key:0},[Gt(Te(l.prefix),1)],64)):(V(),Ie(Be(Nn),ht({key:1,name:(d=l.prefix)==null?void 0:d.iconName},(f=l.prefix)==null?void 0:f.props,{class:"f-s-24"}),null,16,["name"]))]}),key:"0"}:void 0,l.suffix?{name:"right-icon",fn:be(()=>{var d,f;return[typeof l.suffix=="string"?(V(),le(vt,{key:0},[Gt(Te(l.suffix),1)],64)):(V(),Ie(Be(Nn),ht({key:1,name:(d=l.suffix)==null?void 0:d.iconName},(f=l.suffix)==null?void 0:f.props,{class:"f-s-24"}),null,16,["name"]))]}),key:"1"}:void 0]),1040,["modelValue","maxlength"])])]),_:1})}}}),Y$=dt(Uat,[["__scopeId","data-v-ebb084c6"]]),Gat=(n,e)=>{let i=n;if(e=Math.floor(Math.abs(e)),e>6&&(e=6),n.toString().indexOf("e")!==-1){const s=n.toString().split("e"),o=Number(s[1]);s[1]=(o+(o>=0?e:-e)).toString(),i=s.join("e")}else i=`${n}e${e}`;return Math.round(i)/Math.pow(10,e)},Hat=(n,e)=>Number(Gat(n,e).toFixed(e)),Vat=(n,e)=>n*e,$P=(n,e)=>n/e,zat=(n,e,t)=>{const i=Vat(n,e);return gi(t)?i:Hat(i,t)},br=(n,e,t)=>gi(n)||hC(n)||cr(n)?n:zat(n,e,t);function q$(n,e){const i=/^(?:[-]?(?=\.?\d?)(?:\d+)?(?:\.?\d*)(?:[eE][+-]?\d*)?)$/.test(n);if(e===void 0)return i;const[,r="",s=""]=n.split(/\.|[eE][+]?/);return i&&(r.length<=e||s.length>0)}function K$(n,{fractionDigits:e,min:t,max:i}={}){let r,s=n;if(n===".")r=0,s="0.";else{r=parseFloat(n);const o=r;isNaN(r)||(r=Cee(r,{fractionDigits:e,min:t,max:i}),o!==r&&(s=String(r)))}return{num:r,value:s}}function Cee(n,{fractionDigits:e,min:t,max:i}){let r=n;if(isNaN(r))return r;const s=e!==void 0&&e>=0;if(s&&(r=Eee(r,e)),t!==void 0&&Number.isFinite(t)){const o=s?k8(t,e):t;r<o&&(r=t)}if(i!==void 0&&Number.isFinite(i)){const o=s?oj(i,e):i;r>o&&(r=o)}return Object.is(r,-0)&&(r=0),r}const $at=(n,e)=>{let i=n;if(e=Math.floor(Math.abs(e)),e>6&&(e=6),n.toString().indexOf("e")!==-1){const s=n.toString().split("e"),o=Number(s[1]);s[1]=(o+(o>=0?e:-e)).toString(),i=s.join("e")}else i=`${n}e${e}`;return Math.round(i)/10**e},Eee=(n,e)=>Number($at(n,e).toFixed(e)),Tee=(n,e)=>n*e,Wat=(n,e)=>n/e,jat=(n,e,t)=>{const i=Tee(n,e);return gi(t)?i:Eee(i,t)},DE=(n,e,t)=>gi(n)||cr(n)||isNaN(n)?n:jat(n,e,t),Qat=(n,e)=>e?Number(n.toFixed(e)):Math.round(n),Xat=Fe({__name:"InputNumber",props:{id:{default:void 0},prefix:{default:void 0},suffix:{default:void 0},label:{default:""},modelValue:{default:void 0},max:{default:void 0},min:{default:void 0},scale:{default:1},fractionDigits:{default:void 0},placeholder:{default:""},allowNull:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},onBlur:{type:Function,default:void 0},defaultValue:{default:0},domProps:{default:void 0}},emits:["update:model-value","change"],setup(n,{expose:e,emit:t}){const i=n,r=t,s={type:"number",inputMode:""},o=ee(null),a=ee(!1);a.value=!!i.id&&["x","y","width","height"].includes(i.id);const l=ee(""),c=P=>{const k=P.clipboardData||window.clipboardData;l.value=k.getData("text")};Zn(()=>{T(i.domProps),document.addEventListener("paste",c)}),L0(()=>{document.removeEventListener("paste",c)}),yt(()=>i.domProps,()=>{T(i.domProps)});const u=ee(),h=P=>{setTimeout(()=>{var k,L;u.value=(k=P.target)!=null&&k.value?Number((L=P.target)==null?void 0:L.value):Number(l.value)},100)},d=te(()=>DE(i.max,i.scale,i.fractionDigits)),f=te(()=>DE(i.min,i.scale,i.fractionDigits)),p=te(()=>({fractionDigits:i.fractionDigits,max:d.value,min:f.value})),g=ee(C(i.modelValue).value);yt(()=>i.modelValue,()=>{if(i.allowNull&&i.modelValue===null&&g.value==="")return;const{value:P,num:k}=C(i.modelValue);(g.value===""||Number(g.value)!==k)&&(g.value=P)});let m=!1;const v=P=>{if(P.target!==null&&!P.target.composing){const k=P.target.value??"";m=!0,_(k)}},_=Fc(P=>{m&&(b(P,i.scale),m=!1)},0),y=P=>q$(P,i.fractionDigits)?P:g.value;let A=!1;const w=P=>{var k;if(A){A=!1;return}m&&(b(g.value,i.scale),m=!1),g.value=C(i.modelValue).value,(k=i.onBlur)==null||k.call(i,P)};function b(P,k){let L;if(P===""&&i.allowNull)L=null;else{const{value:H,num:U}=K$(P,p.value);g.value=H,isNaN(U)||(L=Cee(Wat(U,k),{min:i.min,max:i.max}))}if(console.log("paste...",u.value),tn(u.value)&&!isNaN(u.value)){const H=Qat(Number(u.value),i.fractionDigits);g.value=H.toString(),L=H,Yi(()=>{const U=x();if(U){const $=g.value.length;U.setSelectionRange($,$)}u.value=""})}console.log("inputVal:",g.value,L),L!==void 0&&L!==i.modelValue&&(r("update:model-value",L),r("change",L,i.id))}function C(P){return I(P,i.scale,i.allowNull,i.defaultValue)}function I(P,k,L,H){if(P===null){if(L)return{value:"",num:null};P=void 0}P===void 0&&(H===null&&!L||typeof H=="number"&&!isFinite(H)?P=H:P=0);const U=String(Tee(Number(P),k)),{value:$,num:j}=K$(U,p.value);return i.modelValue===null?{value:"",num:0}:{value:$,num:j}}const x=()=>o.value?o.value.$el.querySelector("input"):null;function T(P){const k=x();if(k){P=Object.assign({},s,P);for(const L in P){const H=P[L];H!==void 0&&(k[L]=H)}}}function O(P,k,L,H){return P.slice(0,L)+k+P.slice(H)}const F=P=>{if(typeof P!="string")throw new TypeError("inserted text must be a string");const k=x();if(!k)return;const L=k.selectionStart??0,H=k.selectionEnd??0,U=k.value,$=!P&&L===H&&L>0?L-1:L,j=O(U,P,$,H);q$(j,i.fractionDigits)&&(g.value=j,m=!0,Yi(()=>{const Q=H+(j.length-U.length);k.setSelectionRange(Q,Q),A=!0,k.blur(),k.focus()}))};function G(){return F("")}function B(){var P;(P=o.value)==null||P.focus(),Yi(()=>{const k=x();if(k){const L=g.value.length;k.setSelectionRange(L,L)}})}function R(){var P;(P=o.value)==null||P.blur()}return e({inputVal:g,insertText:F,deleteText:G,focus:B,blur:R}),(P,k)=>{const L=Jo;return V(),Ie(L,ht({ref_key:"inputField",ref:o,modelValue:g.value,"onUpdate:modelValue":k[0]||(k[0]=H=>g.value=H),class:["input-number process-param-setting",{"gray-bg-cls":a.value&&(i==null?void 0:i.domProps.kind)}],formatter:y,label:i.label,placeholder:i.placeholder,"input-align":"right",disabled:P.disabled,type:"number"},P.$attrs,{onBlur:w,onInput:v,onPaste:h}),Pr({_:2},[P.prefix?{name:"left-icon",fn:be(()=>[Gt(Te(P.prefix),1)]),key:"0"}:void 0,P.suffix?{name:"right-icon",fn:be(()=>[Gt(Te(P.suffix),1)]),key:"1"}:void 0]),1040,["modelValue","class","label","placeholder","disabled"])}}}),Yat=dt(Xat,[["__scopeId","data-v-10083f6e"]]),qat={key:0,class:"number-keyboard-valid"},Kat=Fe({__name:"NumberKeyboard",props:{show:{type:Boolean},title:{},inputs:{default:()=>[]},popupAttrs:{default:void 0},focusIndex:{}},emits:["update:show"],setup(n,{emit:e}){const t=N0(),{t:i}=Yt(),r=te(()=>t.name==="editor"),s=te(()=>t.name==="device"),o=qr({"number-keyboard-overlay":!r.value,"number-keyboard-overlay_editor":r.value,"number-keyboard-overlay_device_detail":s.value}),a=si(),{unit:{fractionDigits:l,scale:c}}=a,u=te(()=>DE(y.inputs[0].attrs.max,c,l)),h=te(()=>DE(y.inputs[0].attrs.min,c,l)),d=te(()=>y.inputs[0].attrs.unit==="in"?`${i("mobile.common.input_effective_range")}${h.value}~${u.value}`:`${i("mobile.common.input_effective_range")}${y.inputs[0].attrs.min}~${y.inputs[0].attrs.max}`),f=P=>{var L;const k=x();k&&((L=k.insertText)==null||L.call(k,String(P)))},p=()=>{var k;console.log("handleKeyboardDelete",T.value);const P=x();P&&((k=P.deleteText)==null||k.call(P))},g=te(()=>{var P,k;return((k=(P=y.inputs[0])==null?void 0:P.attrs)==null?void 0:k.min)<0?["-","."]:"."}),m=()=>{T.value!==""&&(F.value=!1)},v=()=>{var P,k;for(let L=0;L<w.value.length;L++)((P=w.value[L])==null?void 0:P.inputVal)!==void 0&&((k=w.value[L])==null||k.blur());setTimeout(()=>{let L=T.value;console.log(L,"closeKeyboard"),F.value=!1},100)},_=()=>{var k;const P=x();P&&((k=P.focus)==null||k.call(P))},y=n,A=e,w=ee([]),b=ee(null),C=te(()=>{const P=b.value;return P!==null?y.inputs[P]:null}),I=te(()=>{const P=b.value;return P!==null?w.value[P]:null}),x=()=>{const P=b.value;return P!==null?w.value[P]:null},T=te(()=>I.value?I.value.inputVal:""),O=ee(Math.random()),F=te({get(){return y.show},set(P){A("update:show",P)}});yt(()=>F.value,P=>{O.value=Math.random(),P&&G(y.focusIndex||0)});function G(P){R(P)&&(b.value=P)}const B=P=>{b.value=P};function R(P){var L;const k=(L=y.inputs)==null?void 0:L[P];if((k==null?void 0:k.type)==="number")return k}return(P,k)=>{const L=Oi,H=f6,U=Ko;return V(),Ie(U,ht({show:F.value,"onUpdate:show":k[1]||(k[1]=$=>F.value=$),position:"bottom",class:{"number-keyboard__popup":r.value},overlay:!0,"close-on-click-overlay":!0,"overlay-class":o,round:"",teleport:"#app"},P.popupAttrs,{onOpened:_,onClose:m}),{default:be(()=>[ye(L,{class:"number-keyboard__title",title:y.title},null,8,["title"]),(V(),le("div",{key:O.value+"",class:St(["number-keyboard__content",y.inputs[0].attrs.showValRange?"":"keyboard__flex"])},[(V(!0),le(vt,null,Fn(y.inputs,($,j)=>(V(),le(vt,{key:j},[$.type==="component"?(V(),Ie(Uo($.cmp),ht({key:0,ref_for:!0,ref_key:"inputRefs",ref:w},$.attrs),null,16)):$e("",!0),$.type==="number"?(V(),Ie(Yat,ht({key:1,id:$.id,ref_for:!0,ref_key:"inputRefs",ref:w,modelValue:$.value,"onUpdate:modelValue":Q=>$.value=Q,class:["number-keyboard__field",{"number-keyboard__field--focus":b.value===j}],style:{"--number-keyboard-input-width":$.attrs.valueWidth??"100%",width:$.attrs.valueWidth??"100%"},"dom-props":{type:"text",inputMode:"none"}},$.attrs,{onFocus:Q=>B(j)}),null,16,["id","modelValue","onUpdate:modelValue","class","style","onFocus"])):$e("",!0)],64))),128)),y.inputs[0].attrs.showValRange?(V(),le("div",qat,Te(d.value),1)):$e("",!0)],2)),b.value!==null?(V(),Ie(H,ht({key:0,modelValue:T.value,"onUpdate:modelValue":k[0]||(k[0]=$=>T.value=$),class:"number-keyboard__keyboard",show:!0,theme:"custom","extra-key":g.value,"close-button-text":Be(i)("mobile.editor.keyboard_confirm")},C.value?C.value.keyboardAttrs:null,{onClose:v,onInput:f,onDelete:p}),null,16,["modelValue","extra-key","close-button-text"])):$e("",!0)]),_:1},16,["show","class","overlay-class"])}}}),Jat=dt(Kat,[["__scopeId","data-v-a5e86357"]]),Zat={class:"number-wrap"},elt=Fe({__name:"Number",props:{pid:{},id:{},prefix:{},suffix:{},width:{},label:{},labelProps:{},showLabel:{type:Boolean,default:!0},value:{},defaultValue:{},max:{},min:{},scale:{},step:{},fractionDigits:{},placeholder:{},allowNull:{type:Boolean},borderLess:{type:Boolean,default:!1},onUpdateValue:{},onBlur:{},tips:{},disabled:{type:Boolean},multiState:{type:Boolean,default:!1},themeMode:{},format:{type:Function,default:n=>n!==null?String(n):""},parse:{type:Function,default:n=>!n||n==="-"||n==="+"?null:Number(n)},align:{},justify:{},vertical:{type:Boolean},reverse:{type:Boolean},spaceSize:{}},emits:["formChange"],setup(n,{emit:e}){Yt();const t=e,i=n,r=ee(!1),o=ee(br(i.value,i.scale??1,i.fractionDigits)??null),a=ee({id:"offset",type:"number",value:o,attrs:{max:i.max,min:i.min,showValRange:!0,valueWidth:"100px",onChange:f=>{d(f)}}}),l=te(()=>i.scale||1),c=te(()=>br(i.max,l.value,i.fractionDigits)??1/0),u=te(()=>br(i.min,l.value,i.fractionDigits)??-1/0),h=te(()=>{let f="";return i.label&&(f=`${f}${i.label}`),i.prefix&&(f=`${f}${i.prefix}`),i.suffix&&(f=`${f}(${i.suffix})`),f});yt(()=>[i.value,i.scale,i.fractionDigits],()=>{const f=br(i.value,l.value,i.fractionDigits);o.value=f});const d=f=>{let p=br(f,l.value,i.fractionDigits);p&&p>c.value&&(p=c.value),p&&p<u.value&&(p=u.value),p===0&&(p=u.value),mt(i==null?void 0:i.onUpdateValue)&&(t("formChange",i.pid,i.id,p),i.onUpdateValue(p)),o.value=p};return(f,p)=>{const g=Jo,m=Gs;return V(),le(vt,null,[ye(m,{class:"xcs-input-number-wrapper",align:f.align??"center",justify:f.justify,direction:f.vertical?"vertical":"horizontal",size:f.spaceSize},{default:be(()=>[ue("div",Zat,[ye(zc,{label:h.value,tips:f.tips,"label-props":f.labelProps},null,8,["label","tips","label-props"]),ye(g,{id:f.id,modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=v=>o.value=v),readonly:"","input-align":"right",class:"xcs-input-number",onClick:p[1]||(p[1]=dr(v=>r.value=!0,["stop"]))},null,8,["id","modelValue"])])]),_:1},8,["align","justify","direction","size"]),ye(Jat,{show:r.value,"onUpdate:show":p[2]||(p[2]=v=>r.value=v),title:h.value,"focus-index":0,inputs:[a.value]},null,8,["show","title","inputs"])],64)}}}),tlt=dt(elt,[["__scopeId","data-v-3bf890dd"]]),nlt={class:"flex-row"},ilt={class:"title"},rlt={class:"device-select-wrap"},slt=Fe({__name:"Picker",props:{pid:{},id:{},label:{},tips:{},value:{},spaceProps:{},radioType:{},radioRender:{type:Function},options:{},disabled:{type:Boolean},optionPopoverProps:{},optionStyle:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=p=>{i("formChange",t.pid,t.id,p)},s=(p,g)=>{var m;return((m=p.filter(v=>v.value===g)[0])==null?void 0:m.label)||""},o=te(()=>s(t.options,t.value)),a=te(()=>o.value),l=te(()=>{const p=ee([]);return p.value[0]=t.value,p}),c=ee(0),u=()=>{t.disabled||(c.value=Math.random(),d.value=!0)},h=p=>p.map(({label:m,value:v})=>({text:m,value:v})),d=ee(!1),f=({selectedOptions:p})=>{const g=p[0].value;d.value=!1,r(g),t.onUpdateValue(g)};return(p,g)=>{const m=xn,v=Jo,_=lO,y=Ko;return V(),le("div",nlt,[ue("div",ilt,Te(p.label),1),ue("div",rlt,[ye(v,{modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=A=>a.value=A),readonly:"","input-align":"right",border:!1,disabled:p.disabled,onClick:dr(u,["stop"])},{"right-icon":be(()=>[ye(m,{size:"22px",style:{"margin-top":"6px"},name:"arrow_right",class:"f-s-22"})]),_:1},8,["modelValue","disabled"]),ye(y,{show:d.value,"onUpdate:show":g[2]||(g[2]=A=>d.value=A),round:"",position:"bottom"},{default:be(()=>[(V(),Ie(_,{key:c.value,"model-value":l.value.value,columns:h(p.options),title:p.label,onCancel:g[1]||(g[1]=A=>d.value=!1),onConfirm:f},{confirm:be(()=>[ye(m,{name:"checkmark",size:"24px",class:"f-s-24"})]),cancel:be(()=>[ye(m,{name:"close",size:"24px",class:"f-s-24"})]),_:1},8,["model-value","columns","title"]))]),_:1},8,["show"])])])}}}),olt=dt(slt,[["__scopeId","data-v-313ea842"]]),alt=Fe({__name:"Popover",props:{id:{},label:{},triggerSlot:{},content:{},pre:{type:Boolean}},setup(n){return(e,t)=>(V(),le("div"))}}),llt=Fe({__name:"RadioGroup",props:{pid:{},id:{},label:{},disabled:{type:Boolean},labelProps:{},labelWrapperClass:{},tips:{},value:{},spaceProps:{},radioType:{},radioRender:{type:Function},options:{},optionPopoverProps:{},optionStyle:{},optionClass:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=te({get:()=>t.value,set:o=>{s(o)}}),s=o=>{i("formChange",t.pid,t.id,o),t.onUpdateValue(o)};return(o,a)=>{const l=U0,c=vT;return V(),le("div",null,[o.id!="flameAlarmSensitivity"?(V(),Ie(zc,{key:0,label:o.label,tips:o.tips,"label-wrapper-class":o.labelWrapperClass,"label-props":o.labelProps},null,8,["label","tips","label-wrapper-class","label-props"])):$e("",!0),ue("section",null,[ye(c,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=u=>r.value=u),disabled:o.disabled,direction:"vertical",shape:"dot",onChange:s},{default:be(()=>[(V(!0),le(vt,null,Fn(o.options,(u,h)=>(V(),Ie(l,{key:u.value,name:u.value,style:On({marginBottom:h!=o.options.length-1?"30px":"0px"})},{default:be(()=>[Gt(Te(u.label),1)]),_:2},1032,["name","style"]))),128))]),_:1},8,["modelValue","disabled"])])])}}}),clt=dt(llt,[["__scopeId","data-v-588b8502"]]),ult={class:"w-full"},hlt=Fe({__name:"Select",props:{pid:{},id:{},label:{},labelProps:{},labelWrapperClass:{},actionSlot:{},borderLess:{type:Boolean,default:!0},emptySlot:{},options:{},renderLabel:{},renderOption:{},multiState:{type:Boolean,default:!1},tips:{},checkMarkIconProps:{default:y_},labelAlign:{},placeholder:{},onUpdateValue:{}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=o=>{o!==null&&(i("formChange",t.pid,t.id,o),t.onUpdateValue(o))},s=o=>{var a;return t.checkMarkIconProps&&o.selected&&A_(o.node,t.checkMarkIconProps),t.renderOption?(a=t==null?void 0:t.renderOption)==null?void 0:a.call(t,o):o.node};return(o,a)=>(V(),le("section",ult,[ye(zc,{label:o.label,tips:o.tips,"label-props":o.labelProps,"label-wrapper-class":o.labelWrapperClass},null,8,["label","tips","label-props","label-wrapper-class"]),ye(Be(__),ht({class:["x-select",{"border-less":o.borderLess,"multi-state":o.multiState}]},o.$attrs,{placeholder:o.multiState?o.$t("common.input-multi-state"):o.placeholder,options:o.options,"render-option":s,"render-label":o.renderLabel,"label-align":o.labelAlign,onUpdateValue:r}),Pr({_:2},[o.actionSlot?{name:"action",fn:be(()=>{var l,c;return[(V(),Ie(Uo((l=o.actionSlot)==null?void 0:l.cmp),jo(ch((c=o.actionSlot)==null?void 0:c.props)),null,16))]}),key:"0"}:void 0,o.emptySlot!==void 0?{name:"empty",fn:be(()=>[Gt(Te(o.emptySlot),1)]),key:"1"}:void 0]),1040,["class","placeholder","options","render-label","label-align"])]))}}),dlt=Fe({__name:"Slider",props:{pid:{},id:{},label:{},value:{},defaultValue:{},max:{},min:{},scale:{},fractionDigits:{},fillColor:{},tips:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=te(()=>t.scale||1),s=te(()=>br(t.max,r.value,t.fractionDigits)),o=te(()=>br(t.min,r.value,t.fractionDigits)),a=te(()=>Rt(t.value)?[br(t.value[0],r.value,t.fractionDigits),br(t.value[1],r.value,t.fractionDigits)]:br(t.value,r.value,t.fractionDigits)),l=te(()=>Rt(t.defaultValue)?[br(t.defaultValue[0],r.value,t.fractionDigits),br(t.defaultValue[1],r.value,t.fractionDigits)]:br(t.defaultValue,r.value,t.fractionDigits)),c=h=>{h!==null&&(Rt(h)?h=[$P(h[0],r.value),$P(h[1],r.value)]:h=$P(h,r.value),i("formChange",t.pid,t.id,h),t.onUpdateValue(h))},u=te(()=>t.fillColor?{"--n-fill-color":t.fillColor,"--n-fill-color-hover":t.fillColor}:{});return(h,d)=>{const f=ig;return V(),le("div",null,[ye(zc,{label:h.label,tips:h.tips},null,8,["label","tips"]),ye(f,ht(h.$attrs,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=p=>a.value=p),max:s.value,min:o.value,style:u.value,"default-value":l.value,onChange:c}),null,16,["modelValue","max","min","style","default-value"])])}}}),flt=Fe({__name:"SliderGroup",props:{pid:{},id:{},label:{},value:{},defaultValue:{},max:{},min:{},scale:{},fractionDigits:{},fillColor:{},tips:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=te(()=>t.scale||1);return te(()=>br(t.max,i.value,t.fractionDigits)),te(()=>br(t.min,i.value,t.fractionDigits)),te(()=>Rt(t.value)?[br(t.value[0],i.value,t.fractionDigits),br(t.value[1],i.value,t.fractionDigits)]:br(t.value,i.value,t.fractionDigits)),te(()=>Rt(t.defaultValue)?[br(t.defaultValue[0],i.value,t.fractionDigits),br(t.defaultValue[1],i.value,t.fractionDigits)]:br(t.defaultValue,i.value,t.fractionDigits)),te(()=>t.fillColor?{"--n-fill-color":t.fillColor,"--n-fill-color-hover":t.fillColor}:{}),(r,s)=>(V(),le("div"))}}),plt={key:1,class:"num_tip"},glt=Fe({__name:"SliderBlock",props:{modelValue:{}},setup(n){const e=ee(!1),t=()=>{e.value=!0},i=()=>{e.value=!1};return(r,s)=>{const o=xn;return V(),le("div",{class:St(["custom-button",e.value?"active":""]),onTouchstart:t,onTouchend:i},[e.value?(V(),Ie(o,{key:0,class:"down_icon",name:"down_slider",size:"12px"})):$e("",!0),e.value?(V(),le("div",plt,Te(Be(Rt)(r.modelValue)?`${parseInt(r.modelValue[0])}~${parseInt(r.modelValue[1])}`:r.modelValue),1)):$e("",!0)],34)}}}),mlt=dt(glt,[["__scopeId","data-v-5cbd8ca4"]]),vlt={class:"van-cell-title"},_lt={class:"slider-content"},ylt={style:{padding:"36px"}},Alt={style:{display:"flex"}},blt=Fe({__name:"SliderTips",props:{id:{},step:{},name:{},label:{},labelExtra:{},value:{},defaultValue:{},min:{},max:{},scale:{},fractionDigits:{},unitExtra:{},desc:{},prefix:{},suffix:{},disabled:{type:Boolean},onUpdateValue:{type:Function}},setup(n){const e=n;Yt();const t=ee(!1),i=te(()=>e.step||1),r=ee(0);yt(()=>e.value,_=>{r.value=Math.random(),s.value.value=_,o.value=_});const s=te({get:()=>ee(e.value),set:_=>_}),o=ee(e.value);yt(()=>s.value.value,_=>{e.value?o.value=_:o.value=null},{immediate:!0});const a=ee(!1),l=te(()=>qr({type:"number",value:e.value===null?null:s.value,attrs:{min:e.min,max:e.max,fractionDigits:e.fractionDigits,keyboardAttrs:{extraKey:e.min<0?["-","."]:""},scale:e.scale,showValRange:!0,disabled:e.disabled,valueWidth:"100px",onChange:y=>{s.value.value=y,o.value=y,a.value=!0}}}));yt(()=>t.value,_=>{_||a.value&&(a.value=!1,c(s.value.value))});const c=_=>{let y=_;_==0||_==-0?y=0:y=Number(_)>Number(e.min)?_:e.min,h(y,1)},u=_=>{o.value=_},h=(_,y)=>{const A=y===1?Zt.inputEdit:Zt.slideAdjust;console.log(["id",`${e.id}`,`${_}`,`${y}`]),e.id==="purifierTimeout"?jt(A,{elementId:ki.processingExhaustTime,value:_}):e.id==="fillLight"?jt(A,{elementId:ki.lightBright,value:_}):e.id==="motionPowerCut"?jt(A,{elementId:ki.minimumOutputPower,value:_}):e.id==="airPumpEngrave"?jt(A,{elementId:ki.airPumpEngrave,value:_}):e.id==="airPumpCut"&&jt(A,{elementId:ki.airPumpCut,value:_});let w=Number(_);e.onUpdateValue(w),o.value=w},d=()=>{e.disabled||(t.value=!0)},f=ee(!1),p=te(()=>({"--v-tooltip-visible":f.value?"visible":"hidden"})),g=()=>{f.value=!0},m=()=>{f.value=!1},v=te(()=>{let _="";return e.label&&(_=`${_}${e.label}`),e.prefix&&(_=`${_}${e.prefix}`),e.suffix&&(_=`${_}(${e.suffix})`),_});return(_,y)=>{const A=ig,w=xn,b=vg,C=Oi;return V(),Ie(C,{center:"",class:"add-icon-suffix-wrap"},{title:be(()=>[ue("div",vlt,[ue("div",{class:St(["slider-label-wrap",{"multi-wrap":_.labelExtra}])},[_.label?(V(),le("div",{key:0,class:St(["slider-label",{"widget-disabled":_.disabled}])},Te(v.value),3)):$e("",!0)],2)])]),label:be(()=>[ue("div",_lt,[ye(A,{modelValue:s.value.value,"onUpdate:modelValue":[y[0]||(y[0]=I=>s.value.value=I),u],min:_.min,max:_.max,step:i.value,"bar-height":"4px",class:St(["bar_speed",e.name]),"active-color":"#28BE44","inactive-color":"#D9D9DE",style:On(p.value),disabled:_.disabled,onDragStart:g,onDragEnd:m,onChange:h},{button:be(()=>[ue("div",ylt,[ye(mlt,{"model-value":s.value.value},null,8,["model-value"])])]),_:1},8,["modelValue","min","max","step","style","class","disabled"]),ue("div",Alt,[ue("div",{class:"num_box",onClick:dr(d,["stop"])},[ue("div",{class:St({num_box_disabled:_.disabled})},Te(s.value.value),3),ye(w,{name:"slider_right",size:"9px",class:"f-s-9",color:_.disabled?"#B0B2B5":"#97999C"},null,8,["color"])]),ye(b,{show:t.value,"onUpdate:show":y[1]||(y[1]=I=>t.value=I),"focus-index":0,title:v.value,inputs:[l.value]},null,8,["show","title","inputs"])])])]),_:1})}}}),wlt=dt(blt,[["__scopeId","data-v-03d8c782"]]),xlt=Fe({__name:"Switch",props:{pid:{},id:{},label:{},align:{},justify:{},vertical:{type:Boolean},reverse:{type:Boolean},spaceSize:{},tips:{},multiState:{type:Boolean},value:{type:Boolean},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=te(()=>t.value),s=o=>{i("formChange",t.pid,t.id,o),t.onUpdateValue(o)};return(o,a)=>{const l=G0,c=Gs;return V(),Ie(c,{class:"switch-container",align:o.align??"center",justify:o.justify,direction:o.vertical?"vertical":"horizontal",size:o.spaceSize},{default:be(()=>[o.reverse?(V(),le(vt,{key:1},[ye(l,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=u=>r.value=u),size:Be(Uv)(22),class:St({"multi-state":o.multiState}),onChange:s},null,8,["modelValue","size","class"]),o.label?(V(),Ie(zc,{key:0,class:"switch-text",label:o.label,tips:o.tips,style:{"margin-bottom":"0"}},null,8,["label","tips"])):$e("",!0)],64)):(V(),le(vt,{key:0},[o.label?(V(),Ie(zc,{key:0,class:"switch-text",label:o.label,tips:o.tips,style:{"margin-bottom":"0"}},null,8,["label","tips"])):$e("",!0),ye(l,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=u=>r.value=u),size:Be(Uv)(22),class:St({"multi-state":o.multiState}),onChange:s},null,8,["modelValue","size","class"])],64))]),_:1},8,["align","justify","direction","size"])}}}),Clt=dt(xlt,[["__scopeId","data-v-c1c3d72d"]]),Elt={style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},Tlt=Fe({__name:"Tabs",props:{pid:{},id:{},value:{},options:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=e,i=n,r=s=>{t("formChange",i.pid,i.id,s),i.onUpdateValue(s)};return(s,o)=>{const a=cO,l=uO;return V(),Ie(l,ht({id:s.id,value:s.value,size:"small"},s.$attrs,{onUpdateValue:r}),{default:be(()=>[(V(!0),le(vt,null,Fn(s.options,c=>(V(),Ie(a,{key:c.value,style:{flex:"1"},name:c.value},{default:be(()=>[ue("span",Elt,Te(c.label),1)]),_:2},1032,["name"]))),128))]),_:1},16,["id","value"])}}}),Ilt={class:"xcs-form-text"},Slt={key:2,class:"suffix"},Plt=Fe({__name:"Text",props:{id:{},label:{},labelProps:{},labelWrapperClass:{},value:{type:[String,Number,Boolean]},tips:{},arrow:{type:Boolean},suffix:{},direc:{},titleColor:{},fontWeight:{},tipColor:{},href:{}},setup(n){return(e,t)=>(V(),le("div",{class:St(e.direc?"column-wrap":"row-wrap")},[ye(zc,{label:e.label,tips:e.tips,arrow:e.arrow,href:e.href,"title-color":e.titleColor,"label-props":e.labelProps,"label-wrapper-class":e.labelWrapperClass},null,8,["label","tips","arrow","href","title-color","label-props","label-wrapper-class"]),ue("section",Ilt,[Be(Rt)(e.value)?(V(!0),le(vt,{key:0},Fn(e.value,(i,r)=>(V(),le("span",{key:r,class:"title",style:On({color:e.tipColor?e.tipColor:"#97999C"})},Te(i.contentVersion||i),5))),128)):(V(),le("span",{key:1,style:On([{"word-break":"keep-all"},{color:e.tipColor?e.tipColor:"#1A1A1E",fontWeight:e.fontWeight?e.fontWeight:"400"}]),class:"text"},Te(e.value),5)),e.suffix?(V(),le("span",Slt,Te(e.suffix),1)):$e("",!0)])],2))}}),Mlt=dt(Plt,[["__scopeId","data-v-2a0992e8"]]),Rlt={key:0},Dlt=Fe({__name:"Upload",props:{id:{},label:{},buttonProps:{}},setup(n){const e=n,t=te(()=>Object.assign(e.buttonProps||{},{id:`button-${e.id}`,label:e.label}));return(i,r)=>{const s=Hi,o=v6;return V(),Ie(o,jo(ch(i.$attrs)),{default:be(()=>{var a,l;return[ye(s,ht({id:t.value.id},(a=t.value)==null?void 0:a.attrs),Pr({default:be(()=>[t.value.label?(V(),le("span",Rlt,Te(t.value.label),1)):$e("",!0)]),_:2},[(l=t.value)!=null&&l.icon?{name:"icon",fn:be(()=>{var c;return[ye(Be(Nn),{name:((c=t.value)==null?void 0:c.icon)||"",class:"f-s-24"},null,8,["name"])]}),key:"0"}:void 0]),1040,["id"])]}),_:1},16)}}}),klt={};function Olt(n,e){return V(),le("div")}const Llt=dt(klt,[["render",Olt]]),J$={default:Y$,input:Y$,number:tlt,checkbox:Oat,select:hlt,button:Iat,dropdown:Fat,slider:dlt,text:Mlt,popover:alt,radioGroup:clt,switch:Clt,checkboxGroup:Bat,buttonGroup:Dat,upload:Dlt,tabs:Tlt,xToolSelect:Llt,sliderGroup:flt,picker:olt,divider:hO,sliderTips:wlt},Nlt=Fe({__name:"FormInput",props:{type:{},inputProps:{},value:{},title:{},fontWeight:{},tipColor:{}},setup(n){return(e,t)=>(V(),Ie(Uo(Be(J$)[e.type]??Be(J$).default),ht({...e.$attrs,...e.inputProps,title:e.title,fontWeight:e.fontWeight,tipColor:e.tipColor},{value:e.value}),null,16,["value"]))}}),Iee=Fe({__name:"FormItem",props:{data:{},itemStyle:{type:[Boolean,null,String,Object,Array]},className:{},formValues:{},title:{},tipColor:{}},setup(n){const e=n,t=te(()=>{const{data:{id:i,value:r},formValues:s={}}=e;return r!==void 0?r:s[i]});return(i,r)=>(V(),le("section",{class:St(["form-item",i.className]),style:On([{flex:"1"},i.itemStyle])},[ye(Nlt,ht(i.$attrs,{id:i.data.id,type:i.data.type,label:i.data.label,"label-props":i.data.labelProps,"label-wrapper-class":i.data.labelWrapperClass,tips:i.data.tips,arrow:i.data.arrow,"title-color":i.data.titleColor,"font-weight":i.data.fontWeight,"tip-color":i.tipColor||i.data.tipColor,direc:i.data.direc,icon:i.data.icon,value:t.value,"input-props":i.data.attrs,title:i.title}),null,16,["id","type","label","label-props","label-wrapper-class","tips","arrow","title-color","font-weight","tip-color","direc","icon","value","input-props","title"])],6))}}),Blt={key:1,class:"red-dot"},Flt=Fe({__name:"Label",props:{label:{},labelWrapperClass:{},labelProps:{},isGroup:{type:Boolean},tips:{},showRedDot:{type:Boolean},titleColor:{},hideTitle:{type:Boolean}},setup(n){const{t:e}=Yt(),t=n,i=()=>{var o,a,l,c;let r=((a=(o=t.tips)==null?void 0:o.content)==null?void 0:a.text)||"",s=(c=(l=t.tips)==null?void 0:l.content)==null?void 0:c.button;s&&(s.tag=s.tag??"a",r===""?r=`<${s.tag} style="color:#0074fd" href='${s.href}' target="${s.target}">${s.label}</${s.tag}>`:r=`${r}<${s.tag} style="color:#0074fd" href='${s.href}' target="${s.target}">${s.label}</${s.tag}>`),tt.modal.showTipModal({title:e("ipad.dialog.tips"),content:r,hasCancel:!1,confirmTxt:e("ipad.dialog.got_it"),onConfirm:()=>{}})};return(r,s)=>{const o=Gs;return r.label&&!r.hideTitle?(V(),Ie(o,{key:0,class:St([[r.isGroup?"form-group-label":"input-label",r.labelWrapperClass],"xcs-form-label-wrap"])},{default:be(()=>[ue("span",{class:St([r.tips?"mr-1":"","label_tip"]),style:On({color:r.titleColor?r.titleColor:"#1A1A1E",fontWeight:400})},Te(r.label),7),r.tips?(V(),Ie(Be(Nn),{key:0,name:"icon-tips",size:"20px",onClick:i})):$e("",!0),r.showRedDot?(V(),le("em",Blt)):$e("",!0)]),_:1},8,["class"])):$e("",!0)}}}),Ult=dt(Flt,[["__scopeId","data-v-384c6572"]]),Glt=["inline","size"],Hlt=Fe({__name:"FormGroup",props:{data:{},inline:{type:Boolean},size:{},tipColor:{},fontWeight:{}},setup(n){return(e,t)=>{const i=Gs;return V(),le("section",{class:St(["form-group",e.data.direc?e.data.direc:"column"]),style:On(e.data.flexStart?"align-items: flex-start;":""),inline:e.inline,size:e.size},[ye(Be(Ult),{"label-props":e.data.labelProps,"label-wrapper-class":e.data.labelWrapperClass,label:e.data.label,"is-group":!0,tips:e.data.tips,"show-red-dot":e.data.showRedDot,arrow:e.data.arrow,"title-color":e.data.titleColor,"tip-color":e.data.tipColor,direc:e.data.direc,"hide-title":e.data.hideTitle},null,8,["label-props","label-wrapper-class","label","tips","show-red-dot","arrow","title-color","tip-color","direc","hide-title"]),ue("section",{class:St(e.data.id=="redCrossOffset"?"form-group-items":"")},[Array.isArray(e.data.children)?(V(),Ie(i,ht({key:0,size:0,direction:e.data.direc?"vertical":"horizontal",align:"center"},e.data.spaceProps,{class:e.data.id=="redCrossOffset"||e.data.id=="purifierTimeoutGroup"?"van-space-special":""}),{default:be(()=>[(V(!0),le(vt,null,Fn(e.data.children,r=>(V(),le(vt,{key:r.id},[r.hidden?$e("",!0):(V(),Ie(Iee,ht({key:0,data:r,"class-name":r.className,"item-style":r.itemStyle},e.$attrs,{disabled:r.disabled||e.$attrs.disabled,"tip-color":e.data.tipColor,title:e.data.label,"font-weight":e.data.fontWeight}),null,16,["data","class-name","item-style","disabled","tip-color","title","font-weight"]))],64))),128))]),_:1},16,["direction","class"])):$e("",!0)],2)],14,Glt)}}}),Vlt=dt(Hlt,[["__scopeId","data-v-300c6180"]]),zlt=Fe({__name:"Form",props:{formData:{},inline:{type:Boolean},class:{},formValues:{},disabled:{type:Boolean}},setup(n){const e=n,t=r=>r!=null&&r.hidden?!1:!["wifiConfigButton","safe_use_specifications","exportGcodeGroup","exportXfGroup","workLogsGroup","motionDelayLight","laserOffJumpSpeed","delayTimeContent","lightPathTest","import","gcode","importTips"].includes(r==null?void 0:r.id),i=te(()=>e.formData.filter(r=>t(r)));return(r,s)=>{const o=Oi,a=ote;return V(),le("section",{class:St(["xcs-form-container",r.class])},[ye(a,{inset:""},{default:be(()=>[(V(!0),le(vt,null,Fn(i.value,l=>(V(),Ie(o,{key:l.id,inset:""},{default:be(()=>[l.type==="group"?(V(),le(vt,{key:0},[l.hidden?$e("",!0):(V(),Ie(Vlt,ht({key:0,data:l,inline:r.inline},r.$attrs),null,16,["data","inline"]))],64)):(V(),le(vt,{key:1},[l.hidden?$e("",!0):(V(),Ie(Iee,ht({key:0,data:l,"class-name":l.className,"item-style":l.itemStyle},r.$attrs),null,16,["data","class-name","item-style"]))],64))]),_:2},1024))),128))]),_:1})],2)}}}),$lt=dt(zlt,[["__scopeId","data-v-928a9197"]]),Wlt={class:"xcs-form-button"},jlt={key:0},Qlt=Fe({__name:"Button",props:{pid:{},id:{},disabled:{type:Boolean},label:{},value:{},tag:{},href:{},text:{type:Boolean},loading:{type:Boolean},icon:{},iconSize:{},popoverProps:{},popoverContent:{},onClick:{type:Function},getRef:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=ee(!1),s=te(()=>t.loading||r.value),o=async()=>{if(t.tag==="a"&&t.href){window.open(t.href);return}if(i("formChange",t.pid,t.id,t.value),t.onClick){const l=t.onClick();if(Object.prototype.toString.call(l)==="[object Promise]")try{r.value=!0,await l}finally{r.value=!1}}},a=()=>{t.href&&window.open(t.href)};return(l,c)=>{const u=Hi;return V(),le("div",Wlt,[l.text&&l.tag==="a"?(V(),le("span",{key:0,class:"tag-a",onClick:a},Te(l.label),1)):(V(),Ie(u,ht({key:1,id:l.id},l.$attrs,{ref:l.getRef,loading:s.value,disabled:l.disabled,class:"btn",onClick:o}),Pr({default:be(()=>[l.label?(V(),le("span",jlt,Te(s.value?"":l.label),1)):$e("",!0)]),_:2},[l.icon?{name:"icon",fn:be(()=>[ye(Be(Nn),{name:l.icon||"",size:l.iconSize,class:St(`f-s-${l.iconSize}`)},null,8,["name","size","class"])]),key:"0"}:void 0]),1040,["id","loading","disabled"]))])}}}),Xlt=dt(Qlt,[["__scopeId","data-v-e026cc31"]]),Ylt={key:1,class:"red-dot"},qlt=Fe({__name:"Label",props:{label:{},labelWrapperClass:{},labelProps:{},isGroup:{type:Boolean},tips:{},showRedDot:{type:Boolean},suffix:{},fontWeight:{}},setup(n){const{t:e}=Yt(),t=n,i=()=>{var o,a,l,c;let r=((a=(o=t.tips)==null?void 0:o.content)==null?void 0:a.text)||"",s=(c=(l=t.tips)==null?void 0:l.content)==null?void 0:c.button;s&&(s.tag=s.tag??"a",r===""?r=`<${s.tag} style="color:#0074fd" href='${s.href}' target="${s.target}">${s.label}</${s.tag}>`:r=`${r}<${s.tag} style="color:#0074fd" href='${s.href}' target="${s.target}">${s.label}</${s.tag}>`),tt.modal.showTipModal({title:e("ipad.dialog.tips"),content:r,hasCancel:!1,confirmTxt:e("ipad.dialog.got_it"),onConfirm:()=>{}})};return(r,s)=>{const o=Gs;return r.label?(V(),Ie(o,{key:0,class:St([[r.isGroup?"form-group-label":"input-label",r.labelWrapperClass],"xcs-form-label-wrap"])},{default:be(()=>[ue("span",{class:St([r.tips?"mr-1":r.fontWeight?"font-weight":"","label_tip"])},[Gt(Te(r.label)+" ",1),r.suffix?(V(),le(vt,{key:0},[Gt("("+Te(r.suffix)+")",1)],64)):$e("",!0)],2),r.tips?(V(),Ie(Be(Nn),{key:0,name:"icon-tips",size:"20px",class:"f-s-20",onClick:i})):$e("",!0),r.showRedDot?(V(),le("em",Ylt)):$e("",!0)]),_:1},8,["class"])):$e("",!0)}}}),$c=dt(qlt,[["__scopeId","data-v-d68188f4"]]),Klt={class:"xcs-button-group"},Jlt={key:0},Zlt=Fe({__name:"ButtonGroup",props:{id:{},label:{},labelProps:{},tips:{},spaceProps:{},optionsSpaceProps:{},options:{}},setup(n){const e=qr({}),t=async i=>{const r=i.attrs&&i.attrs.onClick;if(r){e[i.id]=!0;try{await r()}catch{}finally{e[i.id]=!1}}};return(i,r)=>{const s=Hi,o=Gs;return V(),le("section",Klt,[ye(o,ht({size:4,vertical:""},i.spaceProps),{default:be(()=>[ye($c,{label:i.label,tips:i.tips,"label-props":i.labelProps},null,8,["label","tips","label-props"]),ue("section",null,[ye(o,ht({size:8,align:"center"},i.optionsSpaceProps),{default:be(()=>[(V(!0),le(vt,null,Fn(i.options,a=>{var l;return V(),le("section",{key:a.id,class:"button-group-item"},[ye(s,ht({id:a.id},Be(eb)({...a.attrs},["onClick"]),{loading:((l=a.attrs)==null?void 0:l.loading)||(e[a.id]??!1),class:"btn",onClick:c=>t(a)}),Pr({default:be(()=>[i.label?(V(),le("span",Jlt,Te(a.label),1)):$e("",!0)]),_:2},[i.icon?{name:"icon",fn:be(()=>[ye(Be(Nn),{name:a.icon||"",size:20,class:"f-s-20"},null,8,["name"])]),key:"0"}:void 0]),1040,["id","loading","onClick"])])}),128))]),_:1},16)])]),_:1},16)])}}}),ect=dt(Zlt,[["__scopeId","data-v-6b937d44"]]),tct={key:0},nct=Fe({__name:"Checkbox",props:{pid:{},id:{},label:{},labelProps:{},value:{type:Boolean},tips:{},multiState:{type:Boolean}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=ee(t.value),r=e,s=o=>{r("formChange",t.pid,t.id,o)};return(o,a)=>{const l=_T;return V(),Ie(l,ht({modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=c=>i.value=c),class:"x-checkbox"},o.$attrs,{onChange:s}),{default:be(()=>[o.label?(V(),le("span",tct,Te(o.label),1)):$e("",!0)]),_:1},16,["modelValue"])}}}),ict={class:"xcs-checkbox-group"},rct=Fe({__name:"CheckboxGroup",props:{pid:{},id:{},label:{},tips:{},value:{},spaceProps:{},options:{}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=ee(t.value),s=o=>{i("formChange",t.pid,t.id,o)};return(o,a)=>{const l=_T,c=Gs,u=g6;return V(),le("div",null,[ye($c,{label:o.label,tips:o.tips},null,8,["label","tips"]),ue("section",ict,[ye(u,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=h=>r.value=h),onChange:s},{default:be(()=>[ye(c,{direction:o.spaceProps.vertical?"vertical":"horizontal",size:o.spaceProps.size},{default:be(()=>[(V(!0),le(vt,null,Fn(o.options,h=>(V(),Ie(l,{key:h.value,name:h.value},{default:be(()=>[Gt(Te(h.label),1)]),_:2},1032,["name"]))),128))]),_:1},8,["direction","size"])]),_:1},8,["modelValue"])])])}}}),sct=Fe({__name:"Dropdown",props:{pid:{},id:{},label:{},icon:{},value:{}},emits:["formChange"],setup(n,{emit:e}){const{button:t,...i}=mT(),r=n,s=e,o=(a,l)=>{s("formChange",r.pid,r.id,l.value)};return(a,l)=>{const c=Hi,u=m6;return V(),Ie(u,ht({value:a.value},i,{onSelect:o}),{default:be(()=>[ye(c,jo(ch(Be(t))),{default:be(()=>[a.label?(V(),le(vt,{key:0},[Gt(Te(a.label),1)],64)):$e("",!0),a.icon?(V(),Ie(Be(Nn),{key:1,name:a.icon,class:"f-s-18"},null,8,["name"])):$e("",!0)]),_:1},16)]),_:1},16,["value"])}}}),oct=Fe({__name:"Input",props:{pid:{},id:{},maxlength:{},value:{},defaultValue:{},prefix:{},suffix:{},label:{},labelWrapperClass:{},tips:{},onBlur:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=d=>{i("formChange",t.pid,t.id,d)},{t:s}=Yt(),o=ee(),a=ee(!1),l=te(()=>t.value||t.defaultValue),c=ee(l.value),u=()=>{c.value=l.value,a.value=!0,setTimeout(()=>{var d;(d=o.value)==null||d.focus()},100)},h=async()=>{if(c.value.length===0){tt.modal.showToast({msg:s("device.setting.name_is_empty"),wordBreak:"break-word",icon:"info",uniqueId:"nameIsEmpty"}),a.value=!1;return}t.onBlur(c.value),r(c.value),await Yi(),setTimeout(()=>{var d;window.scroll(0,0),(d=o.value)==null||d.blur(),a.value=!1},1e3)};return(d,f)=>{const p=Jo,g=Gs;return V(),Ie(g,{direction:"vertical",class:"xcs-form-input-wrap",fill:!0,size:10},{default:be(()=>[ue("section",null,[ye($c,{label:d.label,tips:d.tips,"label-wrapper-class":d.labelWrapperClass},null,8,["label","tips","label-wrapper-class"])]),ue("section",null,[a.value?$e("",!0):(V(),Ie(p,{key:0,modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=m=>l.value=m),modelModifiers:{trim:!0},placeholder:"",readonly:"",class:"xcs-form-input",onClick:dr(u,["stop"])},null,8,["modelValue"])),a.value?(V(),Ie(p,ht({key:1,ref_key:"myField",ref:o},d.$attrs,{modelValue:c.value,"onUpdate:modelValue":f[1]||(f[1]=m=>c.value=m),modelModifiers:{trim:!0},maxlength:d.maxlength||15,placeholder:"",class:"xcs-form-input",onBlur:h}),Pr({_:2},[d.prefix?{name:"left-icon",fn:be(()=>{var m,v;return[typeof d.prefix=="string"?(V(),le(vt,{key:0},[Gt(Te(d.prefix),1)],64)):(V(),Ie(Be(Nn),ht({key:1,name:(m=d.prefix)==null?void 0:m.iconName},(v=d.prefix)==null?void 0:v.props,{class:"f-s-24"}),null,16,["name"]))]}),key:"0"}:void 0,d.suffix?{name:"right-icon",fn:be(()=>{var m,v;return[typeof d.suffix=="string"?(V(),le(vt,{key:0},[Gt(Te(d.suffix),1)],64)):(V(),Ie(Be(Nn),ht({key:1,name:(m=d.suffix)==null?void 0:m.iconName},(v=d.suffix)==null?void 0:v.props,{class:"f-s-24"}),null,16,["name"]))]}),key:"1"}:void 0]),1040,["modelValue","maxlength"])):$e("",!0)])]),_:1})}}}),Z$=dt(oct,[["__scopeId","data-v-cb7d5156"]]),act=(n,e)=>{let i=n;if(e=Math.floor(Math.abs(e)),e>6&&(e=6),n.toString().indexOf("e")!==-1){const s=n.toString().split("e"),o=Number(s[1]);s[1]=(o+(o>=0?e:-e)).toString(),i=s.join("e")}else i=`${n}e${e}`;return Math.round(i)/Math.pow(10,e)},lct=(n,e)=>Number(act(n,e).toFixed(e)),cct=(n,e)=>n*e,WP=(n,e)=>n/e,uct=(n,e,t)=>{const i=cct(n,e);return gi(t)?i:lct(i,t)},wr=(n,e,t)=>gi(n)||hC(n)||cr(n)?n:uct(n,e,t),hct={key:0,class:"flex"};const dct=Fe({__name:"Number",props:{pid:{},id:{},prefix:{},suffix:{},width:{},label:{},labelProps:{},showLabel:{type:Boolean,default:!0},fontWeight:{},value:{},defaultValue:{},max:{},min:{},scale:{},step:{},fractionDigits:{},placeholder:{},allowNull:{type:Boolean},borderLess:{type:Boolean,default:!1},hiddenIcon:{type:Boolean},onUpdateValue:{},onBlur:{},tips:{},disabled:{type:Boolean},multiState:{type:Boolean,default:!1},themeMode:{},format:{type:Function,default:n=>n!==null?String(n):""},parse:{type:Function,default:n=>!n||n==="-"||n==="+"?null:Number(n)},align:{},justify:{},vertical:{type:Boolean},reverse:{type:Boolean},spaceSize:{}},emits:["formChange"],setup(n,{emit:e}){const t=e,i=n,r=()=>wr(i.value,i.scale??1,i.fractionDigits),s=te({get:()=>r(),set:d=>d}),o=te(()=>i.scale||1),a=te(()=>wr(i.max,o.value,i.fractionDigits)??1/0),l=te(()=>wr(i.min,o.value,i.fractionDigits)??-1/0);yt(()=>[i.value,i.scale,i.fractionDigits],()=>{const d=wr(i.value,o.value,i.fractionDigits);s.value=d});const c=d=>{let f=wr(d,o.value,i.fractionDigits);gi(f)||hC(f)||cr(f)||(f>a.value&&(f=a.value),f<l.value&&(f=l.value),mt(i==null?void 0:i.onUpdateValue)&&(t("formChange",i.pid,i.id,f),i.onUpdateValue(f)),s.value=f)},u=ee(!1),h=()=>{if(i.disabled)return;u.value=!0;const d=(i.min&&i.min<0)??!1;tt.modal.showNumberKeyboard({targetEle:`#${i.id}`,position:"right",inputVal:s.value,focusedIndex:0,unit:i.suffix,showMinus:d,inputs:[{id:i.id,value:s.value}],confirmCallback:f=>{console.log("[数字键盘确认值]",f[0].value),u.value=!1;const p=f[0].value;gi(p)||hC(p)||cr(p)||c(p)},closeCallback:()=>{console.log("[数字键盘取消]"),u.value=!1}})};return(d,f)=>{const p=Jo,g=Gs;return V(),Ie(g,{class:"xcs-input-number-wrapper",align:d.align??"center",justify:d.justify,direction:d.vertical?"vertical":"horizontal",size:d.spaceSize},{default:be(()=>[d.showLabel?(V(),Ie($c,{key:0,label:d.label,tips:d.tips,"label-props":d.labelProps,suffix:d.suffix,"font-weight":d.fontWeight},null,8,["label","tips","label-props","suffix","font-weight"])):$e("",!0),ue("section",null,[ye(p,{id:d.id,modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=m=>s.value=m),readonly:"","input-align":"right",class:St(["xcs-input-number",{"disabled-color":d.disabled,"border-less":u.value}]),onClick:h},Pr({"right-icon":be(()=>{var m;return[(m=d.$attrs)!=null&&m.hiddenIcon?$e("",!0):(V(),le("section",hct,[$e("",!0),$e("",!0)]))]}),_:2},[d.prefix?{name:"left-icon",fn:be(()=>[Gt(Te(d.prefix),1)]),key:"0"}:void 0]),1032,["id","modelValue","class"])])]),_:1},8,["align","justify","direction","size"])}}}),fct=dt(dct,[["__scopeId","data-v-7fedd30d"]]),pct=Fe({__name:"Popover",props:{id:{},label:{},triggerSlot:{},content:{},pre:{type:Boolean}},setup(n){return(e,t)=>(V(),le("div"))}}),gct={class:"pad-radio-group"},mct={style:{margin:"10px auto 0"}},vct=Fe({__name:"RadioGroup",props:{pid:{},id:{},label:{},disabled:{type:Boolean},labelProps:{},labelWrapperClass:{},tips:{},value:{},spaceProps:{},radioType:{},radioRender:{type:Function},options:{},optionPopoverProps:{},optionStyle:{},optionClass:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=te({get:()=>t.value,set:o=>{s(o)}}),s=o=>{i("formChange",t.pid,t.id,o),t.onUpdateValue(o)};return(o,a)=>{const l=U0,c=vT;return V(),le("div",gct,[ye($c,{label:o.label,tips:o.tips,"label-wrapper-class":o.labelWrapperClass,"label-props":o.labelProps},null,8,["label","tips","label-wrapper-class","label-props"]),ue("section",mct,[ye(c,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=u=>r.value=u),disabled:o.disabled,shape:"dot",direction:o.id=="cutAirAssist"||o.id=="scoreAirAssist"?"horizontal":"vertical"},{default:be(()=>[(V(!0),le(vt,null,Fn(o.options,u=>(V(),Ie(l,{key:u.value,name:u.value},{default:be(()=>[Gt(Te(u.label),1)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","disabled","direction"])])])}}}),_ct=dt(vct,[["__scopeId","data-v-e025356d"]]),yct={class:"w-full"},Act=Fe({__name:"Select",props:{pid:{},id:{},label:{},labelProps:{},labelWrapperClass:{},actionSlot:{},borderLess:{type:Boolean,default:!0},emptySlot:{},options:{},renderLabel:{},renderOption:{},multiState:{type:Boolean,default:!1},tips:{},checkMarkIconProps:{default:y_},labelAlign:{},placeholder:{},onUpdateValue:{}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=o=>{o!==null&&(i("formChange",t.pid,t.id,o),t.onUpdateValue(o))},s=o=>{var a;return t.checkMarkIconProps&&o.selected&&A_(o.node,t.checkMarkIconProps),t.renderOption?(a=t==null?void 0:t.renderOption)==null?void 0:a.call(t,o):o.node};return(o,a)=>(V(),le("section",yct,[ye($c,{label:o.label,tips:o.tips,"label-props":o.labelProps,"label-wrapper-class":o.labelWrapperClass},null,8,["label","tips","label-props","label-wrapper-class"]),ye(Be(__),ht({class:["x-select",{"border-less":o.borderLess,"multi-state":o.multiState}]},o.$attrs,{placeholder:o.multiState?o.$t("common.input-multi-state"):o.placeholder,options:o.options,"render-option":s,"render-label":o.renderLabel,"label-align":o.labelAlign,onUpdateValue:r}),Pr({_:2},[o.actionSlot?{name:"action",fn:be(()=>{var l,c;return[(V(),Ie(Uo((l=o.actionSlot)==null?void 0:l.cmp),jo(ch((c=o.actionSlot)==null?void 0:c.props)),null,16))]}),key:"0"}:void 0,o.emptySlot!==void 0?{name:"empty",fn:be(()=>[Gt(Te(o.emptySlot),1)]),key:"1"}:void 0]),1040,["class","placeholder","options","render-label","label-align"])]))}}),bct=Fe({__name:"Slider",props:{pid:{},id:{},label:{},value:{},defaultValue:{},max:{},min:{},scale:{},fractionDigits:{},fillColor:{},tips:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=te(()=>t.scale||1),s=te(()=>wr(t.max,r.value,t.fractionDigits)),o=te(()=>wr(t.min,r.value,t.fractionDigits)),a=te(()=>Rt(t.value)?[wr(t.value[0],r.value,t.fractionDigits),wr(t.value[1],r.value,t.fractionDigits)]:wr(t.value,r.value,t.fractionDigits)),l=te(()=>Rt(t.defaultValue)?[wr(t.defaultValue[0],r.value,t.fractionDigits),wr(t.defaultValue[1],r.value,t.fractionDigits)]:wr(t.defaultValue,r.value,t.fractionDigits)),c=h=>{h!==null&&(Rt(h)?h=[WP(h[0],r.value),WP(h[1],r.value)]:h=WP(h,r.value),i("formChange",t.pid,t.id,h),t.onUpdateValue(h))},u=te(()=>t.fillColor?{"--n-fill-color":t.fillColor,"--n-fill-color-hover":t.fillColor}:{});return(h,d)=>{const f=ig;return V(),le("div",null,[ye($c,{label:h.label,tips:h.tips},null,8,["label","tips"]),ye(f,ht(h.$attrs,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=p=>a.value=p),max:s.value,min:o.value,style:u.value,"default-value":l.value,onChange:c}),null,16,["modelValue","max","min","style","default-value"])])}}}),wct=Fe({__name:"SliderGroup",props:{pid:{},id:{},label:{},value:{},defaultValue:{},max:{},min:{},scale:{},fractionDigits:{},fillColor:{},tips:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=te(()=>t.scale||1);return te(()=>wr(t.max,i.value,t.fractionDigits)),te(()=>wr(t.min,i.value,t.fractionDigits)),te(()=>Rt(t.value)?[wr(t.value[0],i.value,t.fractionDigits),wr(t.value[1],i.value,t.fractionDigits)]:wr(t.value,i.value,t.fractionDigits)),te(()=>Rt(t.defaultValue)?[wr(t.defaultValue[0],i.value,t.fractionDigits),wr(t.defaultValue[1],i.value,t.fractionDigits)]:wr(t.defaultValue,i.value,t.fractionDigits)),te(()=>t.fillColor?{"--n-fill-color":t.fillColor,"--n-fill-color-hover":t.fillColor}:{}),(r,s)=>(V(),le("div"))}}),xct=Fe({__name:"Switch",props:{pid:{},id:{},label:{},align:{},justify:{},vertical:{type:Boolean},reverse:{type:Boolean},spaceSize:{},tips:{},multiState:{type:Boolean},value:{type:Boolean},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=n,i=e,r=te(()=>t.value),s=o=>{i("formChange",t.pid,t.id,o),t.onUpdateValue(o)};return(o,a)=>{const l=G0,c=Gs;return V(),Ie(c,{class:"switch-container",align:o.align??"center",justify:o.justify,direction:o.vertical?"vertical":"horizontal",size:o.spaceSize},{default:be(()=>[o.reverse?(V(),le(vt,{key:1},[ye(l,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=u=>r.value=u),size:"20px",class:St({"multi-state":o.multiState}),onChange:s},null,8,["modelValue","class"]),o.label?(V(),Ie($c,{key:0,class:"switch-text",label:o.label,tips:o.tips,style:{"margin-bottom":"0"}},null,8,["label","tips"])):$e("",!0)],64)):(V(),le(vt,{key:0},[o.label?(V(),Ie($c,{key:0,class:"switch-text",label:o.label,tips:o.tips,style:{"margin-bottom":"0"}},null,8,["label","tips"])):$e("",!0),ye(l,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=u=>r.value=u),size:"20px",class:St({"multi-state":o.multiState}),onChange:s},null,8,["modelValue","class"])],64))]),_:1},8,["align","justify","direction","size"])}}}),Cct={style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},Ect=Fe({__name:"Tabs",props:{pid:{},id:{},value:{},options:{},onUpdateValue:{type:Function}},emits:["formChange"],setup(n,{emit:e}){const t=e,i=n,r=s=>{t("formChange",i.pid,i.id,s),i.onUpdateValue(s)};return(s,o)=>{const a=cO,l=uO;return V(),Ie(l,ht({id:s.id,value:s.value,size:"small"},s.$attrs,{onUpdateValue:r}),{default:be(()=>[(V(!0),le(vt,null,Fn(s.options,c=>(V(),Ie(a,{key:c.value,style:{flex:"1"},name:c.value},{default:be(()=>[ue("span",Cct,Te(c.label),1)]),_:2},1032,["name"]))),128))]),_:1},16,["id","value"])}}}),Tct={class:"xcs-form-text"},Ict={key:1,style:{"word-break":"keep-all"}},Sct={key:2,class:"suffix"},Pct=Fe({__name:"Text",props:{id:{},label:{},labelProps:{},labelWrapperClass:{},value:{type:[String,Number,Boolean]},tips:{},suffix:{}},setup(n){return(e,t)=>(V(),le("div",null,[ye($c,{label:e.label,tips:e.tips,"label-props":e.labelProps,"label-wrapper-class":e.labelWrapperClass},null,8,["label","tips","label-props","label-wrapper-class"]),ue("section",Tct,[Be(Rt)(e.value)?(V(!0),le(vt,{key:0},Fn(e.value,(i,r)=>(V(),le("span",{key:r,style:{"word-break":"keep-all",display:"block",margin:"4px auto"}},Te(i.contentVersion||i),1))),128)):(V(),le("span",Ict,Te(e.value),1)),e.suffix?(V(),le("span",Sct,Te(e.suffix),1)):$e("",!0)])]))}}),Mct=dt(Pct,[["__scopeId","data-v-88a48345"]]),Rct={key:0},Dct=Fe({__name:"Upload",props:{id:{},label:{},buttonProps:{}},setup(n){const e=n,t=te(()=>Object.assign(e.buttonProps||{},{id:`button-${e.id}`,label:e.label}));return(i,r)=>{const s=Hi,o=v6;return V(),Ie(o,jo(ch(i.$attrs)),{default:be(()=>{var a,l;return[ye(s,ht({id:t.value.id},(a=t.value)==null?void 0:a.attrs),Pr({default:be(()=>[t.value.label?(V(),le("span",Rct,Te(t.value.label),1)):$e("",!0)]),_:2},[(l=t.value)!=null&&l.icon?{name:"icon",fn:be(()=>{var c;return[ye(Be(Nn),{name:((c=t.value)==null?void 0:c.icon)||"",class:"f-s-24"},null,8,["name"])]}),key:"0"}:void 0]),1040,["id"])]}),_:1},16)}}}),kct={};function Oct(n,e){return V(),le("div")}const Lct=dt(kct,[["render",Oct]]),eW={default:Z$,input:Z$,number:fct,checkbox:nct,select:Act,button:Xlt,dropdown:sct,slider:bct,text:Mct,popover:pct,radioGroup:_ct,switch:xct,checkboxGroup:rct,buttonGroup:ect,upload:Dct,tabs:Ect,xToolSelect:Lct,sliderGroup:wct,divider:hO},Nct=Fe({__name:"FormInput",props:{type:{},inputProps:{},value:{},fontWeight:{}},setup(n){return(e,t)=>(V(),Ie(Uo(Be(eW)[e.type]??Be(eW).default),ht({...e.$attrs,...e.inputProps,fontWeight:e.fontWeight},{value:e.value}),null,16,["value"]))}}),See=Fe({__name:"FormItem",props:{data:{},itemStyle:{type:[Boolean,null,String,Object,Array]},className:{},formValues:{}},setup(n){const e=n,t=te(()=>{const{data:{id:i,value:r},formValues:s={}}=e;return r!==void 0?r:s[i]});return(i,r)=>(V(),le("section",{class:St(["form-item",i.className]),style:On(i.itemStyle)},[ye(Nct,ht(i.$attrs,{id:i.data.id,type:i.data.type,label:i.data.label,"label-props":i.data.labelProps,"label-wrapper-class":i.data.labelWrapperClass,tips:i.data.tips,arrow:i.data.arrow,"title-color":i.data.titleColor,"tip-color":i.data.tipColor,direc:i.data.direc,"font-weight":i.data.fontWeight,icon:i.data.icon,value:t.value,"input-props":i.data.attrs}),null,16,["id","type","label","label-props","label-wrapper-class","tips","arrow","title-color","tip-color","direc","font-weight","icon","value","input-props"])],6))}}),Bct={key:1,class:"red-dot"},Fct=Fe({__name:"Label",props:{label:{},labelWrapperClass:{},labelProps:{},isGroup:{type:Boolean},tips:{},showRedDot:{type:Boolean},titleColor:{},hideTitle:{type:Boolean},fontWeight:{}},setup(n){const{t:e}=Yt(),t=n,i=()=>{var o,a,l,c;let r=((a=(o=t.tips)==null?void 0:o.content)==null?void 0:a.text)||"",s=(c=(l=t.tips)==null?void 0:l.content)==null?void 0:c.button;s&&(s.tag=s.tag??"a",r===""?r=`<${s.tag} style="color:#0074fd" href='${s.href}' target="${s.target}">${s.label}</${s.tag}>`:r=`${r}<${s.tag} style="color:#0074fd" href='${s.href}' target="${s.target}">${s.label}</${s.tag}>`),tt.modal.showTipModal({title:e("ipad.dialog.tips"),content:r,hasCancel:!1,confirmTxt:e("ipad.dialog.got_it"),onConfirm:()=>{}})};return(r,s)=>{const o=Gs;return r.label&&!r.hideTitle?(V(),Ie(o,{key:0,class:St([[r.isGroup?"form-group-label":"input-label",r.labelWrapperClass],"xcs-form-label-wrap"])},{default:be(()=>[ue("span",{class:St([r.tips?"mr-1":"","label_tip"]),style:On({color:r.titleColor?r.titleColor:"#1A1A1E",fontWeight:r.fontWeight?r.fontWeight:500})},Te(r.label),7),r.tips?(V(),Ie(Be(Nn),{key:0,name:"icon-tips",size:"20px",onClick:i})):$e("",!0),r.showRedDot?(V(),le("em",Bct)):$e("",!0)]),_:1},8,["class"])):$e("",!0)}}}),Uct=dt(Fct,[["__scopeId","data-v-9b59fa31"]]),Gct=["inline","size"],Hct={class:"form-group-items"},Vct=Fe({__name:"FormGroup",props:{data:{},inline:{type:Boolean},size:{},tipColor:{}},setup(n){return(e,t)=>{const i=Gs;return V(),le("section",{class:"form-group",inline:e.inline,size:e.size},[ye(Be(Uct),{"label-props":e.data.labelProps,"label-wrapper-class":e.data.labelWrapperClass,label:e.data.label,"is-group":!0,tips:e.data.tips,"show-red-dot":e.data.showRedDot,arrow:e.data.arrow,"title-color":e.data.titleColor,"tip-color":e.data.tipColor,direc:e.data.direc,"hide-title":e.data.hideTitle,"font-weight":e.data.fontWeight},null,8,["label-props","label-wrapper-class","label","tips","show-red-dot","arrow","title-color","tip-color","direc","hide-title","font-weight"]),ue("section",Hct,[Array.isArray(e.data.children)?(V(),Ie(i,ht({key:0,size:4,direction:e.data.spaceDirec||"horizontal",align:e.data.align||"center"},e.data.spaceProps,{class:{"van-space-special":e.data.spaceBetween}}),{default:be(()=>[(V(!0),le(vt,null,Fn(e.data.children,r=>(V(),le(vt,{key:r.id},[r.hidden?$e("",!0):(V(),Ie(See,ht({key:0,data:r,"class-name":r.className,"item-style":r.itemStyle},e.$attrs,{disabled:r.disabled||e.$attrs.disabled,"tip-color":e.data.tipColor,"font-weight":r.fontWeight}),null,16,["data","class-name","item-style","disabled","tip-color","font-weight"]))],64))),128))]),_:1},16,["direction","align","class"])):$e("",!0)])],8,Gct)}}}),zct=dt(Vct,[["__scopeId","data-v-1e2cdd96"]]),$ct=Fe({__name:"Form",props:{formData:{},inline:{type:Boolean},class:{},formValues:{},disabled:{type:Boolean}},setup(n){return(e,t)=>(V(),le("section",{class:St(["xcs-form-container",e.class])},[(V(!0),le(vt,null,Fn(e.formData,i=>(V(),le(vt,{key:i.id},[i.type==="group"?(V(),le(vt,{key:0},[i.hidden?$e("",!0):(V(),Ie(zct,ht({key:0,data:i,inline:e.inline},e.$attrs),null,16,["data","inline"]))],64)):(V(),le(vt,{key:1},[i.hidden?$e("",!0):(V(),Ie(See,ht({key:0,data:i,"class-name":i.className,"item-style":i.itemStyle},e.$attrs),null,16,["data","class-name","item-style"]))],64))],64))),128))],2))}}),Wct=dt($ct,[["__scopeId","data-v-46c6e23c"]]),jct=""+new URL("../assets/connect_success_d-xnSz3VpY.png",import.meta.url).href,Qct={class:"content_box"},Xct={class:"header_titile"},Yct={class:"left-panel"},qct={class:"content_mid"},Kct=["src"],Jct={class:"title_r"},Zct={key:0},eut={class:"footer_global_btn"},tut={key:1,class:"ml_auto"},nut=Fe({__name:"Index",props:{modelValue:{type:Boolean,default:!1},title:{type:String,default:"title"},leftImg:{type:String,default:jct},iconName:{type:String,default:"msg_info"},leftTitle:{type:String,default:""},confirmTxt:{type:String,default:"OK"},cancelTxt:{type:String,default:"Cancel"},hasIcon:{type:Boolean,default:!1},hasClose:{type:Boolean,default:!0},hasCancel:{type:Boolean,default:!0},hasConfirm:{type:Boolean,default:!0},hasLeftLink:{type:Boolean,default:!1},hasRightBtn:{type:Boolean,default:!0},confirmDisabled:{type:Boolean,default:!1},hasWalkBorder:{type:Boolean,default:!1},walkBorderTxt:{type:String,default:""},dismissOnCancel:{type:Boolean,default:!0}},emits:["update:modelValue","ok","openLink","onBack","cancel","startWalkBorder"],setup(n,{emit:e}){const t=n,i=e,r=te(()=>t.modelValue),s=u=>{i("cancel",u),t.dismissOnCancel&&i("update:modelValue",!1)},o=()=>{i("startWalkBorder")},a=()=>{i("ok")},l=()=>{i("openLink")},c=()=>{i("onBack")};return(u,h)=>{const d=Hi,f=Ko;return V(),Ie(f,{show:r.value,"onUpdate:show":h[2]||(h[2]=p=>r.value=p),"close-on-click-overlay":!1,class:"pop_modal_global"},{default:be(()=>[ue("div",Qct,[ue("div",Xct,[ue("div",Yct,[n.hasIcon?(V(),Ie(Be(Nn),{key:0,name:n.iconName,class:"mr-12 title-icon f-s-24",size:"24px",onClick:c},null,8,["name"])):$e("",!0),ue("div",null,Te(n.title),1)]),n.hasClose?(V(),Ie(Be(Nn),{key:0,class:"ml_auto f-s-24",name:"icon-close",color:"#545458",onClick:h[0]||(h[0]=p=>s(!0))})):$e("",!0)]),ue("div",qct,[ue("img",{class:"img",src:n.leftImg},null,8,Kct),ue("div",Jct,[Fs(u.$slots,"rightWord",{},void 0,!0)])]),n.hasLeftLink||n.hasRightBtn?(V(),le("div",Zct,[ue("div",eut,[n.hasLeftLink?(V(),le("div",{key:0,class:"left_tit",onClick:l},Te(n.leftTitle),1)):$e("",!0),n.hasRightBtn?(V(),le("div",tut,[n.hasCancel?(V(),Ie(d,{key:0,class:"mr-12 right_no",onClick:h[1]||(h[1]=p=>s(!1))},{default:be(()=>[Gt(Te(n.cancelTxt),1)]),_:1})):$e("",!0),n.hasWalkBorder?(V(),Ie(d,{key:1,type:"primary",class:"mr-12 right_ok",onClick:o},{default:be(()=>[Gt(Te(n.walkBorderTxt),1)]),_:1})):$e("",!0),n.hasConfirm?(V(),Ie(d,{key:2,type:"primary",class:"right_ok",disabled:n.confirmDisabled,onClick:a},{default:be(()=>[Gt(Te(n.confirmTxt),1)]),_:1},8,["disabled"])):$e("",!0)])):$e("",!0)])])):$e("",!0)])]),_:3},8,["show"])}}}),iut=dt(nut,[["__scopeId","data-v-1c5458ac"]]),rut=(n,e)=>{let i=n;if(e=Math.floor(Math.abs(e)),e>6&&(e=6),n.toString().indexOf("e")!==-1){const s=n.toString().split("e"),o=Number(s[1]);s[1]=(o+(o>=0?e:-e)).toString(),i=s.join("e")}else i=`${n}e${e}`;return Math.round(i)/10**e},sut=(n,e)=>Number(rut(n,e).toFixed(e)),out={class:"xcs-number-keyboard"},aut=Fe({__name:"NumberKeyboard",props:{id:{},name:{},label:{},labelAlign:{},inputAlign:{},prefix:{},suffix:{},unit:{},width:{},max:{},min:{},scale:{},step:{},fractionDigits:{},allowNull:{type:Boolean},disabled:{type:Boolean},value:{},onUpdateValue:{type:Function}},setup(n){const e=n,t=te(()=>e.value),i=s=>{if(e.onUpdateValue){if(!e.allowNull&&s===null)return;s!==null&&e.max&&s>e.max&&(s=e.max),s!==null&&e.min&&s<e.min&&(s=e.min),e.onUpdateValue(sut(s,e.fractionDigits||0))}},r=()=>{if(e.disabled)return;const s=!!(e.min&&e.min<0);tt.modal.showNumberKeyboard({targetEle:`#${e.id}`,position:"right",inputVal:t.value,focusedIndex:0,unit:e.unit??"",showMinus:s,inputs:[{id:e.id,value:t.value}],confirmCallback:o=>{console.log("[数字键盘确认值]",o[0].value),i(o[0].value)},closeCallback:()=>{console.log("[数字键盘取消]")}})};return(s,o)=>{const a=Jo;return V(),le("section",out,[ye(a,{id:s.id,modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),readonly:"",label:s.label,"label-align":s.labelAlign,"input-align":s.inputAlign,style:On({width:s.width?s.width:"100%"}),onClick:r},Pr({_:2},[s.prefix?{name:"left-icon",fn:be(()=>[Gt(Te(s.prefix),1)]),key:"0"}:void 0,s.suffix?{name:"right-icon",fn:be(()=>[Gt(Te(s.suffix),1)]),key:"1"}:void 0]),1032,["id","modelValue","label","label-align","input-align","style"])])}}}),lut=dt(aut,[["__scopeId","data-v-991bd99d"]]),cut=Object.freeze(Object.defineProperty({__proto__:null,LeftRightLayout:iut,MaterialModal:wKe,SvgIcon:Nn,Toast:dot,XForm:yst,XFormMobile:Gv,XNumberKeyboard:Ust,XTooltip:Aee,XcsForm:Wct,XcsFormMobile:$lt,XcsNumberKeyboard:lut,allowMultipleToast:cee,closeToast:hot,showToast:lee},Symbol.toStringTag,{value:"Module"}));function uut({componentPrefix:n="",components:e={}}={}){const t=[];function i(s,o,a){s.component(n+o)||s.component(n+o,a)}function r(s){if(!t.includes(s)){t.push(s);for(const o in e){const a=e[o],{setup:l,props:c,render:u}=a;!l&&!c&&!u||(console.log(["=> install",o,a]),i(s,o,a))}}}return{install:r}}const hut=uut({components:cut}),dut={class:"header_titile"},fut={class:"content"},put=["innerHTML"],gut={class:"footer_btn"},mut=Fe({__name:"TipPhoneModal",props:{title:{type:String,default:""},content:{type:String,default:""},hasSupply:{type:Boolean,default:!1},supplyTxt:{type:String,default:"View"},onSupply:{type:Function,default:()=>{}},hasConfirm:{type:Boolean,default:!0},confirmTxt:{type:String,default:"Confirm"},hasCancel:{type:Boolean,default:!0},cancelTxt:{type:String,default:"Cancel"},hasClose:{type:Boolean,default:!1},popZIndex:{type:Number}},emits:["update:modelValue","close","confirm","cancel"],setup(n,{emit:e}){const t=n,i=e,r=ee(!0),s=()=>{o(),t.onSupply()},o=()=>{i("close",!1),r.value=!1},a=()=>{i("cancel",!1),r.value=!1},l=async()=>{try{await i("confirm"),r.value=!1}catch(c){console.log(c)}};return(c,u)=>{const h=xn,d=Ko;return V(),Ie(d,{show:r.value,"onUpdate:show":u[0]||(u[0]=f=>r.value=f),round:"","close-on-click-overlay":!1,class:"pop_modal","z-index":n.popZIndex,"overlay-class":"common-popup-filter-overlay"},{default:be(()=>[n.hasClose?(V(),le("div",{key:0,class:"close-right-top",onClick:o},[ye(h,{name:"tip-close",class:"f-s-24"})])):$e("",!0),ue("div",dut,[ue("div",null,Te(n.title),1)]),ue("div",fut,[ue("span",{innerHTML:n.content},null,8,put),n.hasSupply?(V(),le("span",{key:0,class:"supply",onClick:s},[Gt(Te(n.supplyTxt)+" ",1),ye(h,{name:"arrow-right-up",style:{"vertical-align":"bottom"},size:"16px"})])):$e("",!0)]),ue("div",gut,[n.hasCancel?(V(),le("div",{key:0,class:"cancel-btn",onClick:a},Te(n.cancelTxt),1)):$e("",!0),n.hasConfirm?(V(),le("div",{key:1,class:"ok-btn",onClick:l},Te(n.confirmTxt),1)):$e("",!0)])]),_:1},8,["show","z-index"])}}}),vut=dt(mut,[["__scopeId","data-v-9e88e360"]]),_ut={class:"pop-title"},yut={class:"pop-content"},Aut={class:"footer_btn"},but=Fe({__name:"RenamePopup",props:{name:{type:String,default:""},title:{type:String,default:""},inputType:{type:String,default:"text"},confirmTxt:{type:String,default:"Confirm"},maxLength:{type:Number,default:1e5}},emits:["confirm","cancel"],setup(n,{emit:e}){const{t}=Yt(),i=n,r=e,s=ee(!0),o=()=>{setTimeout(()=>{var d;window.scroll(0,0),(d=l.value)==null||d.blur()},100)},a=ee(""),l=ee(),c=()=>{r("cancel"),s.value=!1},u=()=>{Yi(()=>{r("confirm",a.value),a.value=""}),s.value=!1},h=d=>{d==null||d.target.select()};return Zn(()=>{a.value=i.name,console.log("newName.value:",a.value),setTimeout(()=>{l.value.focus(),Yi(()=>{h()})},100)}),vN(()=>!0),(d,f)=>{const p=Jo,g=Hi,m=Ko;return V(),Ie(m,{show:s.value,"onUpdate:show":f[2]||(f[2]=v=>s.value=v),round:"","close-on-click-overlay":!1,class:"common-input-pop","overlay-class":"common-popup-filter-overlay"},{default:be(()=>[ue("div",_ut,[ue("span",null,Te(n.title),1)]),ue("div",yut,[ye(p,{ref_key:"renameRef",ref:l,modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=v=>a.value=v),modelModifiers:{trim:!0},type:n.inputType,clearable:"",maxlength:n.maxLength,placeholder:n.inputType==="password"?"":Be(t)("device.user_defined.name"),class:"input-box",onBlur:o,onFocus:f[1]||(f[1]=v=>h(v))},null,8,["modelValue","type","maxlength","placeholder"])]),ue("div",Aut,[ye(g,{class:"cancel-btn",onClick:c},{default:be(()=>[Gt(Te(d.$t("ipad.dialog.cancel")),1)]),_:1}),ye(g,{class:"ok-btn",disabled:a.value.length===0,onClick:u},{default:be(()=>[Gt(Te(n.confirmTxt),1)]),_:1},8,["disabled"])])]),_:1},8,["show"])}}}),wut=dt(but,[["__scopeId","data-v-1d8c9201"]]),xut=""+new URL("../assets/exception-default-JnJKCDfk.png",import.meta.url).href,Cut={class:"header-title"},Eut={class:"header-err-code"},Tut={class:"content-detail"},Iut={class:"content-link-text"},Sut=Fe({__name:"Index",emits:["close"],setup(n,{emit:e}){const{t}=Yt(),i=ee(!0),r=e,s=pg(Y9e,!1),o=ee({msg:"",code:""}),a=ee(!0),l=ee(!0),c=ee(""),u=ee("");Lo(()=>s.uiState.errorInfo,p=>{o.value=p}),Lo(()=>s.uiState.isShowIgnore,p=>{a.value=p}),Lo(()=>s.uiState.isShowClose,p=>{l.value=p}),Lo(()=>s.uiState.headerMsg,p=>{c.value=t(p)}),Lo(()=>s.uiState.contentMsg,p=>{u.value=t(p)}),II(()=>s.uiEffect.close,()=>{i.value=!1,r("close")});const h=()=>{s.sendEvent(new jJ)},d=()=>{s.sendEvent(new $J)},f=p=>{p?s.sendEvent(new QJ):s.sendEvent(new WJ)};return vN(()=>!0),(p,g)=>{var v;const m=xn;return V(),Ie(Be(NI),{show:i.value,title:c.value,content:u.value,"cancel-txt":a.value?p.$t("device.modal.ignore"):"","confirm-txt":p.$t(o.value.confirmLabelKey||"device.modal.confirm"),"has-close":l.value,img:((v=o.value)==null?void 0:v.img)??Be(xut),"z-index":"100000",class:St([i.value?"device-error-modal-guide":""]),onConfirm:h,onCancel:g[0]||(g[0]=_=>f(!1)),onClose:g[1]||(g[1]=_=>f(!0))},{title:be(()=>[ue("div",Cut,Te(c.value),1),ue("div",Eut,Te(p.$t("device.error.error_code",{code:o.value.code})),1)]),content:be(()=>[ue("div",Tut,[ue("span",null,Te(u.value),1),Gt("   "),ue("div",{class:"content-link",onClick:d},[ue("span",Iut,Te(p.$t("device.error.how_resolve")),1),ye(m,{name:"common-arrow-right-up",class:"content-link-icon"})])])]),_:1},8,["show","title","content","cancel-txt","confirm-txt","has-close","img","class"])}}}),Put=dt(Sut,[["__scopeId","data-v-c5fa31b6"]]),Pee=""+new URL("../assets/device-d1-pro-zohI6o09.png",import.meta.url).href,Mee=""+new URL("../assets/device-d1-pro2-hF_OKBK9.png",import.meta.url).href,eO=""+new URL("../assets/device-d1-FsboyT4d.png",import.meta.url).href,Ree=""+new URL("../assets/device-f1-uitra-VNezYWpb.png",import.meta.url).href,Dee=""+new URL("../assets/device-f1-Cm1ZvBmL.png",import.meta.url).href,tO=""+new URL("../assets/device-m1-PePydCan.png",import.meta.url).href,kee=""+new URL("../assets/device-p2-2R0iC9qn.png",import.meta.url).href,Oee=""+new URL("../assets/device-s1-5Et1SErj.png",import.meta.url).href,Lee=""+new URL("../assets/p1-cover-mkfxD98_.png",import.meta.url).href,Nee={[nt.D1]:{pic:eO},[nt.D1Pro]:{pic:Pee},[nt.D1Pro2]:{pic:Mee},[nt.S1]:{pic:Oee},[nt.P1]:{pic:Lee},[nt.P2]:{pic:kee},[nt.M1]:{pic:tO},[nt.M2]:{pic:tO},[nt.F1]:{pic:Dee},[nt.F1Ultra]:{pic:Ree},empty:{pic:eO}},Mut={class:"pop-container"},Rut={class:"pop-header"},Dut={class:"pop-header-title"},kut={class:"pop-main"},Out={class:"pop-content"},Lut={class:"content-status current-scroll-none"},Nut={class:"pop-footer"},But={class:"common-btn-text"},Fut={class:"common-btn-text"},Uut=Fe({__name:"FirmwareStep",props:{isShowPopup:{type:Boolean},title:{},statusIcon:{},statusImg:{},subTitleList:{},content:{},cancelTxt:{},confirmTxt:{},closeTxt:{}},emits:["close","confirm","cancel"],setup(n,{emit:e}){const t=e;te(()=>{let o=bt().extId??"empty";return console.log("ext",o),Nee[o].pic});const i=()=>{t("close")},r=()=>{t("cancel")},s=()=>{t("confirm")};return(o,a)=>{const l=xn,c=ng,u=Hi,h=Ko;return V(),Ie(h,{show:o.isShowPopup,round:"","close-on-click-overlay":!1,class:"firmware-modal",position:"bottom"},{default:be(()=>[ue("div",Mut,[ue("div",Rut,[ue("span",Dut,Te(o.title),1)]),ue("div",kut,[ue("div",Out,[o.statusIcon?(V(),Ie(l,{key:0,name:o.statusIcon,class:"content-svg"},null,8,["name"])):$e("",!0),o.statusImg?(V(),Ie(c,{key:1,fit:"contain",src:o.statusImg,class:"content-img"},null,8,["src"])):$e("",!0),ue("div",Lut,Te(o.content),1)])]),ue("div",Nut,[o.confirmTxt?(V(),Ie(u,{key:0,type:"primary",class:"common-primary-btn bottom-btn",block:"",onClick:s},{default:be(()=>[ue("span",But,Te(o.confirmTxt),1)]),_:1})):$e("",!0),o.cancelTxt?(V(),Ie(u,{key:1,type:"default",class:"common-default-btn bottom-btn",block:"",onClick:r},{default:be(()=>[ue("span",Fut,Te(o.cancelTxt),1)]),_:1})):$e("",!0),o.closeTxt?(V(),le("span",{key:2,class:"close-btn bottom-btn",onClick:i},Te(o.closeTxt),1)):$e("",!0)])])]),_:1},8,["show"])}}}),ey=dt(Uut,[["__scopeId","data-v-224195aa"]]),Gut={class:"content-detail"},Hut=Fe({__name:"FirmwareUpdate",props:{isShowPopup:{type:Boolean},title:{},statusIcon:{},subTitleList:{},content:{},cancelTxt:{},confirmTxt:{}},emits:["close","confirm","cancel"],setup(n,{emit:e}){const t=e;te(()=>{let o=bt().extId??"empty";return console.log("ext",o),Nee[o].pic});const i=()=>{t("close")},r=()=>{t("cancel")},s=()=>{t("confirm")};return(o,a)=>{const l=xn;return V(),Ie(Be(NI),{show:o.isShowPopup,title:o.title,"cancel-txt":o.cancelTxt,"confirm-txt":o.confirmTxt,onClose:i,onConfirm:s,onCancel:r},{header:be(()=>[ye(l,{name:o.statusIcon,class:"header-icon"},null,8,["name"])]),content:be(()=>[(V(!0),le(vt,null,Fn(o.subTitleList,(c,u)=>(V(),le("div",{key:u,class:"content-tip"},Te(c),1))),128)),ue("div",Gut,Te(o.content),1)]),_:1},8,["show","title","cancel-txt","confirm-txt"])}}}),tW=dt(Hut,[["__scopeId","data-v-9df88014"]]),Vut={class:"pop-main"},zut={class:"pop-main-title"},$ut={class:"pop-main-content current-scroll-none"},Wut={class:"content-detail"},jut=Fe({__name:"TipDialog",props:{toShow:{type:Boolean},show:{type:Boolean},img:{},title:{},content:{},cancelTxt:{},confirmTxt:{},closeTxt:{},hasClose:{type:Boolean},confirmDisabled:{type:Boolean}},emits:["update:show","close","confirm","cancel"],setup(n,{emit:e}){const t=n,i=e,r=te({get:()=>t.show,set:l=>i("update:show",l)}),s=()=>{i("cancel")},o=()=>{i("confirm")},a=()=>{t.toShow&&(r.value=!0)};return Zn(()=>{a()}),(l,c)=>{const u=F0;return V(),Ie(u,{show:r.value,"onUpdate:show":c[0]||(c[0]=h=>r.value=h),"show-cancel-button":!!l.cancelTxt,"cancel-button-text":l.cancelTxt,"cancel-button-disabled":!1,"show-confirm-button":!!l.confirmTxt,"confirm-button-text":l.confirmTxt,"confirm-button-disabled":!1,"close-on-click-overlay":!1,class:"firmware-tip-dialog","overlay-class":"common-popup-filter-overlay",onCancel:s,onConfirm:o},Pr({default:be(()=>[ue("div",Vut,[ue("div",zut,[Fs(l.$slots,"title",{},()=>[ue("span",null,Te(l.title),1)])]),ue("div",$ut,[Fs(l.$slots,"content",{},()=>[ue("div",Wut,Te(l.content),1)])])])]),_:2},[l.$slots.footer?{name:"footer",fn:be(()=>[Fs(l.$slots,"footer")]),key:"0"}:void 0]),1032,["show","show-cancel-button","cancel-button-text","show-confirm-button","confirm-button-text"])}}}),Qut={class:"content-top"},Xut={class:"content-tip"},Yut={class:"content-detail",style:{"white-space":"pre-line"}},qut=Fe({__name:"FirmwareUpdateTip",props:{isShowPopup:{type:Boolean},title:{},subTitle:{},subTitleList:{},content:{},cancelTxt:{},confirmTxt:{}},emits:["close","confirm","cancel"],setup(n,{emit:e}){const t=e,i=()=>{t("close")},r=()=>{t("cancel")},s=()=>{t("confirm")};return(o,a)=>(V(),Ie(jut,{show:o.isShowPopup,title:o.title,"cancel-txt":o.cancelTxt,"confirm-txt":o.confirmTxt,onClose:i,onConfirm:s,onCancel:r},{content:be(()=>[ue("div",Qut,[ue("div",Xut,Te(o.subTitle),1),(V(!0),le(vt,null,Fn(o.subTitleList,(l,c)=>(V(),le("div",{key:c},Te(l),1))),128))]),ue("div",Yut,Te(o.content),1)]),_:1},8,["show","title","cancel-txt","confirm-txt"]))}}),Kut=dt(qut,[["__scopeId","data-v-1094d50e"]]),Jut=Fe({__name:"Index",setup(n){const e=pg(p7e),{t}=Yt(),i=te(()=>za.local),r=(b,C={})=>{const[I]=b.split("-");return C[I]||C.en||"empty"};II(()=>e.uiEffect.showToast,b=>{tt.modal.showToast({msg:b.msgKey})});const s=te(()=>{const b=e.uiState.isShowPopup;return console.log("======isShowPopup",b),b||(tt.modal.didShowFirmwareDialog=!1),b});L0(()=>{console.log("======onUnmounted"),tt.modal.didShowFirmwareDialog=!1});const o=te(()=>e.uiState.currentVersion),a=te(()=>{var b;return((b=e.uiState.lastCheckResult)==null?void 0:b.latestVersion)??""}),l=te(()=>e.uiState.currentAppVersion),c=te(()=>{var b;return`${r(i.value,((b=e.uiState.lastCheckResult)==null?void 0:b.changeLog)??{})}`}),u=te(()=>e.uiState.downloadPercent),h=te(()=>e.uiState.uploadPercent),d=te(()=>e.uiState.currentStep),f=()=>{e.sendEvent(new Lh({id:ks.show}))},p=()=>{e.sendEvent(new Lh({id:ks.close}))},g=()=>{e.sendEvent(new Lh({id:ks.cancel}))},m=()=>{e.sendEvent(new Lh({id:ks.laterReminder}))},v=()=>{e.sendEvent(new Lh({id:ks.changeLogNext}))},_=()=>{e.sendEvent(new Lh({id:ks.retry}))},y=()=>{e.sendEvent(new Lh({id:ks.updateAppNow}))},A=te(()=>{const b=a.value;return{[as.changeLog]:{cmp:tW,title:t("device.firmware.find_new_version"),statusIcon:"firmware-success",subTitleList:[t("device.firmware.need_update_firmware",{latestVersion:b}),`${t("device.firmware.version")}${o.value}`],content:c.value,cancelTxt:t("device.firmware.later_remind"),confirmTxt:t("device.firmware.update_now"),hasClose:!0,onCancel:m,onConfirm:v,onClose:p},[as.changeLogForce]:{cmp:Kut,title:t("device.firmware.find_new_version"),subTitle:t("device.firmware.force_update_firmware_2"),subTitleList:[`${t("device.firmware.version")}${o.value}`,t("ipad.firmware.need_update_firmware",{latestVersion:b})],content:c.value,confirmTxt:t("device.firmware.update_now"),cancelTxt:t("device.firmware.not_now"),onConfirm:v,onCancel:g},[as.appVersionLow]:{cmp:tW,title:t("device.firmware.find_new_version"),statusIcon:"firmware-success",content:`${t("mobile.common.current_software_version")}: v${l.value}
${t("device.firmware.version")}${o.value}
${t("device.firmware.app_version_low")}`,confirmTxt:t("setting.download_update"),cancelTxt:t("device.firmware.cancel"),onConfirm:y,onCancel:g},[as.download]:{cmp:ey,title:t("device.firmware.download"),statusIcon:"firmware-download",content:t("ipad.firmware.downloading",{percent:u.value})},[as.upload]:{cmp:ey,statusIcon:"firmware-download",title:t("device.firmware.update"),content:t("device.firmware.updating_tip1",{percent:h.value})+`
`+t("device.firmware.updating_tip2")},[as.updating]:{cmp:ey,statusIcon:"firmware-download",title:t("device.firmware.update"),content:t("device.firmware.updating_tip1",{percent:h.value})+`
`+t("device.firmware.updating_tip2")},[as.success]:{cmp:ey,title:t("device.firmware.update_success"),statusIcon:"firmware-success",content:t("ipad.firmware.succeeded"),confirmTxt:t("device.firmware.done"),onConfirm:p},[as.failed]:{cmp:ey,title:t("device.firmware.update"),statusIcon:"firmware-fail",content:e.uiState.failType===zy.DOWNLOAD?t("device.firmware.download_fail"):t("device.firmware.failed"),cancelTxt:t("device.firmware.cancel"),confirmTxt:t("device.firmware.retry"),onCancel:g,onConfirm:_}}}),w=te(()=>{if(d.value){const b=A.value[d.value];return console.log("======step",b),b}return null});return Zn(()=>{console.log("firmware update onMounted"),f()}),(b,C)=>(V(),Ie(Uo(w.value&&w.value.cmp),ht(w.value,{"is-show-popup":s.value,onClose:C[0]||(C[0]=I=>w.value&&w.value.onClose),onConfirm:C[1]||(C[1]=I=>w.value&&w.value.onConfirm),onCancel:C[2]||(C[2]=I=>w.value&&w.value.onCancel)}),null,16,["is-show-popup"]))}}),Zut={class:"soft-header-container"},eht={class:"soft-header-fill"},tht={class:"soft-header-title"},nht={class:"soft-header-title-text"},iht={class:"soft-header-title-num"},rht={style:{"text-align":"left"}},sht=["innerHTML"],oht=Fe({__name:"Index",emits:["close"],setup(n,{emit:e}){const t=pg(Jze),i=ee(!1),r=te(()=>t.uiState.description),s=te(()=>t.uiState.newVersion),o=te(()=>t.uiState.currentVersion),a=()=>{i.value=!1},l=()=>{t.sendEvent(new gK),a()},c=()=>{t.sendEvent(new mK),a()};return Lo(()=>t.uiState.isShouldShowDialog,u=>{console.log("==>softUpdate isShow",u),u&&(t.sendEvent(new pK),i.value=!0)}),(u,h)=>(V(),Ie(Be(NI),{show:i.value,"cancel-txt":u.$t("device.firmware.later_remind"),"confirm-txt":u.$t("mobile.common.update_now"),"has-close":!0,"z-index":"100000",class:"soft-update-modal",onConfirm:l,onCancel:h[0]||(h[0]=d=>c()),onClose:a},{header:be(()=>[ue("div",Zut,[ue("div",eht,[ue("div",tht,[ue("span",nht,Te(u.$t("mobile.common.discovered_new_version")),1),ue("span",iht,Te(`V${s.value}`),1)])])])]),content:be(()=>[ue("div",rht,Te(u.$t("mobile.common.current_software_version")+o.value),1),ue("div",{style:{"text-align":"left","white-space":"pre-line"},innerHTML:r.value},null,8,sht)]),_:1},8,["show","cancel-txt","confirm-txt"]))}}),aht=dt(oht,[["__scopeId","data-v-d44a61de"]]),nW=""+new URL("../assets/d1-d1pro-connect-success-1uWYA4Pz.png",import.meta.url).href,iW=""+new URL("../assets/d1-d1pro-power-tip-A_mg2qXk.png",import.meta.url).href,lht=""+new URL("../assets/d1-pro2-connect-success-vU0b77DI.png",import.meta.url).href,jP=""+new URL("../assets/d1pro-process-start-7bYuPE-p.png",import.meta.url).href,cht=""+new URL("../assets/d1pro2-power-tip-12IfLH1p.png",import.meta.url).href,uht=""+new URL("../assets/f1-connect-success-poJWI1VR.png",import.meta.url).href,hht=""+new URL("../assets/f1-power-tip-IPyg2qke.png",import.meta.url).href,rW=""+new URL("../assets/f1-process-start-mwhX51Wb.png",import.meta.url).href,dht=""+new URL("../assets/f1-uitra-connect-success-HFPbnbT9.png",import.meta.url).href,fht=""+new URL("../assets/f1uitra-power-tip-vyz1UN1B.png",import.meta.url).href,pht=""+new URL("../assets/s1-connect-success-pqplZOFj.png",import.meta.url).href,ght=""+new URL("../assets/s1-power-tip--uHqZA3W.png",import.meta.url).href,mht=""+new URL("../assets/s1-process-start-vSdO6W_3.png",import.meta.url).href,sW=""+new URL("../assets/p2-connect-success-kK53UPYl.png",import.meta.url).href,oW=""+new URL("../assets/p2-power-tip-bEACSw1n.png",import.meta.url).href,aW=""+new URL("../assets/p2-process-start-Ss81TFlW.png",import.meta.url).href,lW=""+new URL("../assets/m1-connect-success-hPV0BHWB.png",import.meta.url).href,vht=""+new URL("../assets/m1-power-tip-JoU88VqT.png",import.meta.url).href,cW=[{id:nt.F1Ultra,name:nt.F1Ultra,isIgnore:!1,devicePic:Ree,deviceWifi:"xTool_F1 Ultra_XXXXXX",powerImg:fht,successImg:dht,processImg:rW,preLightColor:"mobile.connect.pre_light_color_purple",successLightColor:"mobile.connect.success_light_color_purple"},{id:nt.S1,name:nt.S1,isIgnore:!1,devicePic:Oee,deviceWifi:"xTool_S1_XXXXXX",powerImg:ght,successImg:pht,processImg:mht,preLightColor:"mobile.connect.pre_light_color_purple",successLightColor:"mobile.connect.success_light_color_purple"},{id:nt.F1,name:nt.F1,isIgnore:!1,devicePic:Dee,deviceWifi:"xTool_F1_XXXXXX",powerImg:hht,successImg:uht,processImg:rW,preLightColor:"mobile.connect.pre_light_color_yellow",successLightColor:"mobile.connect.success_light_color_blue_white"},{id:nt.P2,name:nt.P2,isIgnore:!1,devicePic:kee,deviceWifi:"xTool_P2_XXXXXX",powerImg:oW,successImg:sW,processImg:aW,preLightColor:"mobile.connect.pre_light_color_yellow",successLightColor:"mobile.connect.success_light_color_white"},{id:nt.D1Pro2,name:nt.D1Pro2,isIgnore:!1,devicePic:Mee,deviceWifi:"xTool_D1P_XXXXXX",powerImg:cht,successImg:lht,processImg:jP,preLightColor:"mobile.connect.pre_light_color_white",successLightColor:"mobile.connect.success_light_color_green"},{id:nt.D1Pro,name:nt.D1Pro,isIgnore:!1,devicePic:Pee,deviceWifi:"xTool_D1P_XXXXXX",powerImg:iW,successImg:nW,processImg:jP,preLightColor:"mobile.connect.pre_light_color_white",successLightColor:"mobile.connect.success_light_color_green"},{id:nt.D1,name:nt.D1,isIgnore:!1,devicePic:eO,deviceWifi:"xTool_D1_XXXXXX",powerImg:iW,successImg:nW,processImg:jP,preLightColor:"mobile.connect.pre_light_color_white",successLightColor:"mobile.connect.success_light_color_green"},{id:nt.M1,name:nt.M1,isIgnore:!1,devicePic:tO,deviceWifi:"xTool_M1_XXXXXX",powerImg:vht,successImg:lW,processImg:lW,preLightColor:"mobile.connect.pre_light_color_green",successLightColor:"mobile.connect.success_light_color_blue_white"},{id:nt.P1,name:"Laserbox",isIgnore:!0,devicePic:Lee,deviceWifi:"xTool_P1_XXXXXX",powerImg:oW,successImg:sW,processImg:aW,preLightColor:"mobile.connect.pre_light_color_yellow",successLightColor:"mobile.connect.success_light_color_white"}],$pt=async()=>{var e;return await((e=window.MeApi)==null?void 0:e.app.getOsPlatform())==="iPhone"},_ht={class:"device-list"},yht=["onClick"],Aht={class:"device-flex"},bht={class:"device-name"},wht={key:0,class:"device-icon"},xht=Fe({__name:"DeviceList",emits:["updateSelectedDevice","updateSelectedDeviceImg"],setup(n,{emit:e}){const t=ee(),i=e;Zn(()=>{const l=t;cW.forEach((c,u)=>{c.id===l.value&&r(u)})});const r=l=>{t.value=a.value[l].id,i("updateSelectedDevice",a.value[l].id),i("updateSelectedDeviceImg",a.value[l].powerImg)};let s=JSON.parse(localStorage.getItem(yJ)||"[]");s.length===0&&(s=GYe);const o=ee(s),a=te(()=>{const l=[];for(const c of o.value){if(c.status!=="enabled")break;const u=cW.find(h=>h.id===c.code);u&&l.push(u)}return console.log("devices:",l),l});return(l,c)=>{const u=ng,h=xn;return V(),le("div",_ht,[(V(!0),le(vt,null,Fn(a.value,(d,f)=>(V(),le("div",{key:d.id,center:"",clickable:!0,class:"device-item",onClick:p=>r(f)},[ue("div",Aht,[ye(u,{class:"device-pic",src:d.devicePic},null,8,["src"]),ue("span",bht,Te(d.name),1),d.id===t.value?(V(),le("div",wht,[ye(h,{class:"device-selected f-s-20",name:"device_success",size:"20px"})])):$e("",!0)])],8,yht))),128))])}}}),Cht=dt(xht,[["__scopeId","data-v-48b91700"]]),Eht={class:"device-list-popup"},Tht={class:"popup-header"},Iht={class:"popup-title"},Sht={class:"popup-content"},Pht=Fe({__name:"Index",emits:["close"],setup(n,{emit:e}){const{t}=Yt(),i=e,r=ee(),s=ee(!0),o=te(()=>r.value?"checkmark":"common-check"),a=()=>{r.value&&(bt().changeDevice(r.value),l())},l=()=>{s.value=!1,i("close")},c=u=>{jt(Zt.buttonClick,{elementId:u}),r.value=u};return(u,h)=>{const d=ate;return V(),le("div",Eht,[ye(d,{show:s.value,"onUpdate:show":h[0]||(h[0]=f=>s.value=f),"close-on-click-action":!0},{description:be(()=>[ue("div",Tht,[ye(Be(xn),{name:"close",class:"f-s-24",size:"24px",onClick:l}),ue("span",Iht,Te(Be(t)("mobile.connect.select_device")),1),ye(Be(xn),{name:o.value,class:St([{disabled:!r.value},"f-s-24"]),size:"24px",onClick:a},null,8,["name","class"])])]),default:be(()=>[ue("div",Sht,[ye(Cht,{onUpdateSelectedDevice:c})])]),_:1},8,["show"])])}}}),Mht=dt(Pht,[["__scopeId","data-v-f6e6ff04"]]),Rht={class:"switch-dialog"},Dht=Fe({__name:"Index",props:{onConfirm:{type:Function},onCancel:{type:Function}},emits:["close"],setup(n,{emit:e}){const t=e,i=ee(!0),r=n,s=()=>{i.value=!1,r.onConfirm(),t("close")},o=()=>{i.value=!1,r.onCancel(),t("close")};return(a,l)=>{const c=F0;return V(),le("div",Rht,[ye(c,{show:i.value,title:a.$t("device.connect.switch_device"),"close-on-click-overlay":!0,"confirm-button-text":a.$t("common.msg.ok"),"cancel-button-text":a.$t("common.msg.cancel"),message:a.$t("device.connect.switch_device_content"),"show-cancel-button":"","overlay-class":"common-popup-filter-overlay",onConfirm:s,onCancel:o},null,8,["show","title","confirm-button-text","cancel-button-text","message"])])}}}),kht=dt(Dht,[["__scopeId","data-v-ffec2a36"]]);class Oht{constructor(){E(this,"didShowFirmwareDialog",!1);E(this,"lastKeepAliveMessage");E(this,"lastKeepAliveMessageContext");E(this,"showBetaNoticeLast")}i18nStr(e,t={}){var r;const i=(r=za.i18n)==null?void 0:r.global.t;try{return i(e,t)}catch{return e}}showToast(e){const t=(e==null?void 0:e.uniqueId)||`${e.icon||"info"}${e.msg&&this.i18nStr(e.msg,e==null?void 0:e.params)||"default_msg"}`;return document.querySelectorAll(".mk-toast").forEach(r=>{var o;const s=r.getAttribute("uniqueId");s&&s===t&&((o=r==null?void 0:r.parentNode)==null||o.removeChild(r))}),lee({message:e.msg&&this.i18nStr(e.msg,e==null?void 0:e.params)||"",icon:e.icon,linkTips:e.linkTips&&this.i18nStr(e.linkTips,e==null?void 0:e.params)||"",wordBreak:(e==null?void 0:e.wordBreak)||"normal",duration:(e==null?void 0:e.duration)??3e3,closeable:(e==null?void 0:e.closeable)||!1,type:(e==null?void 0:e.type)||"text",overlay:(e==null?void 0:e.overlay)||!1,openCb:e==null?void 0:e.openCb,forbidClick:(e==null?void 0:e.forbidClick)||!1,scene:(e==null?void 0:e.scene)||0,confirmCb:e==null?void 0:e.confirmCb,closeCb:e==null?void 0:e.closeCb,teleport:(e==null?void 0:e.teleport)||"body",bckWhiteColor:(e==null?void 0:e.bckWhiteColor)||!1,source:"mobile",layout:(e==null?void 0:e.layout)||"horizontal",btnLabel:(e==null?void 0:e.btnLabel)&&this.i18nStr(e.btnLabel,e==null?void 0:e.params)||"",customCb:e==null?void 0:e.customCb,uniqueId:t,topDistance:e==null?void 0:e.topDistance,order:e==null?void 0:e.order,needOverride:(e==null?void 0:e.needOverride)||!1,addSpace:e==null?void 0:e.addSpace})}showHasNewExtDialog(e){const t=i=>new Promise(r=>{i==="confirm"?r(!0):(window.MeApi.openNative.openWebInApp(Bhe),r(!1))});p6({title:this.i18nStr("device.modal.tip"),message:this.i18nStr("device.common.ext_updated_tip",{deviceName:e}),confirmButtonText:this.i18nStr("common.msg.ok"),cancelButtonText:this.i18nStr("device.common.check_change_log"),beforeClose:t}).then(()=>{}).catch(()=>{})}showNewFirmwareDialog(){if(console.log("showNewFirmwareDialog",this.didShowFirmwareDialog),this.didShowFirmwareDialog)return;const e=()=>{this.didShowFirmwareDialog=!1};Ia(Ms.appContext,Jut,{onClose:e},null),this.didShowFirmwareDialog=!0}showNewSoftDialog(){Ia(Ms.appContext,aht)}showConfirmDialog(e){let t;const i=new Promise(r=>{t=r});return ON({title:this.i18nStr(e.title??""),message:this.i18nStr(e.msg),confirmButtonText:this.i18nStr(e.confirmButtonText??"common.msg.ok"),showCancelButton:!!e.cancelButtonText,cancelButtonText:e.cancelButtonText?this.i18nStr(e.cancelButtonText):void 0}).then(()=>{t(!0)}).catch(()=>{t(!1)}),i}cleanKeepAliveMessage(){this.lastKeepAliveMessage&&(this.lastKeepAliveMessage.close(),this.lastKeepAliveMessage=void 0,this.lastKeepAliveMessageContext=void 0)}showlastKeepAliveMessageIfExist(){this.lastKeepAliveMessageContext&&(this.lastKeepAliveMessage=this.showToast(this.lastKeepAliveMessageContext))}showKeepAliveMessage(e){this.cleanKeepAliveMessage();const t={icon:"info",duration:3e3,msg:e==null?void 0:e.content,type:"html",linkTips:e==null?void 0:e.linkText,addSpace:(e==null?void 0:e.addSpace)||!0,closeable:!1,forbidClick:(e==null?void 0:e.forbidClick)||!1,teleport:(e==null?void 0:e.teleport)||"body",uniqueId:e==null?void 0:e.uniqueId,order:e==null?void 0:e.order,topDistance:e==null?void 0:e.topDistance,bckWhiteColor:(e==null?void 0:e.bckWhiteColor)||!1,needOverride:(e==null?void 0:e.needOverride)||!1,closeCb:()=>{this.cleanKeepAliveMessage()},openCb:()=>{console.log("========openCb",e==null?void 0:e.link),e!=null&&e.link&&window.MeApi.openNative.openWebInApp(e==null?void 0:e.link)}};this.lastKeepAliveMessageContext=t,this.lastKeepAliveMessage=this.showToast(t)}showDeviceErrorModal(){Ia(Ms.appContext,Put)}projectSaveConfirm(){}showLossFontsDialog(e){let t;const i=new Promise(r=>{t=r});return ON({title:this.i18nStr("component.modal.loss_fonts_title"),message:this.i18nStr(e.useLegacy?"mobile.editor.loss_fonts":"mobile.editor.loss_fonts_description"),confirmButtonText:this.i18nStr(e.useLegacy?"component.modal.confirm_title":"component.modal.loss_fonts_option_replace_font"),cancelButtonText:this.i18nStr("component.modal.loss_fonts_option_to_paths"),showCancelButton:!e.useLegacy}).then(()=>{e.useLegacy||t(ak.REPLACE_FONT)}).catch(()=>{t(ak.TO_PATHS)}),i}showMessage(e){var t,i,r,s,o,a,l,c,u,h,d,f,p,g,m,v,_,y,A,w,b,C,I,x;return this.showToast({msg:e.contentI18nKey||((t=e.render)==null?void 0:t.textI18nKey)||"",duration:((i=e.options)==null?void 0:i.duration)??3e3,icon:((r=e.options)==null?void 0:r.icon)||e.type,type:"html",linkTips:(o=(s=e.render)==null?void 0:s.link)==null?void 0:o.labelI18nKey,addSpace:((a=e.options)==null?void 0:a.addSpace)||!0,openCb:((l=e.options)==null?void 0:l.openCb)??((u=(c=e.render)==null?void 0:c.link)==null?void 0:u.onClick)??(()=>{var T,O,F,G;(G=(T=window.MeApi)==null?void 0:T.app)==null||G.openBrowser((F=(O=e.render)==null?void 0:O.link)==null?void 0:F.href)}),forbidClick:((h=e.options)==null?void 0:h.forbidClick)||!1,scene:((d=e.options)==null?void 0:d.scene)||0,closeable:(p=(f=e.render)==null?void 0:f.link)==null?void 0:p.closable,closeCb:(m=(g=e.render)==null?void 0:g.link)==null?void 0:m.onClose,teleport:((v=e.options)==null?void 0:v.teleport)||"body",bckWhiteColor:((_=e.options)==null?void 0:_.bckWhiteColor)||!1,source:"mobile",layout:((y=e.options)==null?void 0:y.layout)||"horizontal",btnLabel:((A=e.options)==null?void 0:A.btnLabel)||"",customCb:(w=e.options)==null?void 0:w.customCb,uniqueId:(b=e.options)==null?void 0:b.uniqueId,order:(C=e.options)==null?void 0:C.order,topDistance:(I=e.options)==null?void 0:I.topDistance,needOverride:((x=e.options)==null?void 0:x.needOverride)||!1})}showTopToast(e){Ia(Ms.appContext,Vqe,e)}showRemindDialog(e){Ia(Ms.appContext,Uqe,e)}showPreviewPathDialog(){Ia(Ms.appContext,Yqe)}showDeviceWarnModal(){}showImageFitSizeDialog(){return Promise.resolve(!1)}showNumberKeyboard(){}showPageLoading(){}showSwitchDeviceModal(e){Ia(Ms.appContext,kht,e)}showTipModal(e){const t={...e,title:this.i18nStr(e.title),content:this.i18nStr(e.content),hasSupply:e.hasSupply||!1,supplyTxt:this.i18nStr(e.supplyTxt||""),confirmTxt:this.i18nStr(e.confirmTxt||""),cancelTxt:this.i18nStr(e.cancelTxt||"")};Ia(Ms.appContext,vut,t)}showRenameModal(e){const t={...e,title:this.i18nStr(e.title),name:this.i18nStr(e.name),confirmTxt:this.i18nStr(e.confirmTxt||"")};Ia(Ms.appContext,wut,t)}showCenterColumnModal(e){Ia(Ms.appContext,NI,e)}showManualDistanceModal(){Ia(Ms.appContext,hKe)}showSelectDeviceDialog(){Ia(Ms.appContext,Mht)}showBetaTextNotice(){this.showBetaNoticeLast&&this.showBetaNoticeLast.close(),this.showBetaNoticeLast=this.showToast({msg:"canvas.message.text_version_not_match",icon:"warning",type:"html",linkTips:"canvas.message.learn_more",openCb:()=>{window.MeApi.openNative.openWebInApp("https://support.xtool.com/hc/en-us/articles/9001607040791")},duration:0,bckWhiteColor:!0})}showDisconnectTip(e){const t=Ls.currentRoute.value.path;console.log("mxn-log","showDisconnectTip",t),(!["/process"].includes(t)||e)&&this.showToast({msg:"device.process.disconnect",icon:"warning",uniqueId:"device.process.disconnect",needOverride:!0})}showMaterialModal(e){}}const Lht={class:"device-container"},Nht={class:"connected-card"},Bht={class:"connected-img"},Fht=["src"],Uht={class:"device-detail"},Ght={class:"title"},Hht={class:"device-status"},Vht=Fe({__name:"ChangeDevice",props:{deviceData:{type:Array,default:[]}},setup(n){const{t:e}=Yt(),t=B0(),i=bt(),r=te(()=>i.ext);console.log("[ext]=>",r.value);const s=pg(UYe),o=te(()=>s.uiState.currentData),a=te(()=>{var d,f;return(d=o==null?void 0:o.value)!=null&&d.snCode?(f=o==null?void 0:o.value)==null?void 0:f.name:e("device.list.xTool")+(o==null?void 0:o.value.extId)}),l=te(()=>{var d,f;if((d=o==null?void 0:o.value)!=null&&d.connected){const p=(f=o.value)==null?void 0:f.connectIdentity;return console.log("=====connectType ip:",p),e(p==="192.168.40.1"?"device.list.Hotspot_status":"device.list.wifi_status")}else return e("ipad.connect.not_connect")}),c=n,u=async()=>{var p;jt(Zt.buttonClick,{elementId:ki.switching});let f=((p=o==null?void 0:o.value)==null?void 0:p.connectIdentity)==="192.168.40.1"?"HOTSPOT":"WIFI";await t.replace({path:"/connect-device",query:{active:f}})},h=async()=>{jt(Zt.buttonClick,{elementId:ki.deviceRename}),tt.modal.showRenameModal({name:a.value,title:"mobile.connect.device_name",confirmTxt:"device.common.confirm",maxLength:15,onConfirm:async d=>{c.deviceData[0].attrs.onBlur(d)}})};return(d,f)=>{var m,v;const p=xn,g=Hi;return V(),le("div",Lht,[ue("div",Nht,[ue("div",Bht,[ue("img",{src:((m=r.value)==null?void 0:m.info.detailCover)||((v=r.value)==null?void 0:v.info.cover)},null,8,Fht)]),ue("div",Uht,[ue("div",Ght,Te(a.value),1),ue("div",Hht,[ue("div",{class:"dot",style:On({backgroundColor:o.value.connected?"#29be44":"#877f7f"})},null,4),ue("span",{class:"status",style:On({color:o.value.connected?"#29be44":"#877f7f"})},Te(l.value),5)])]),ye(p,{name:"device-edit",size:"18px",class:"f-s-20",onClick:h})]),ye(g,{type:"default",class:"btn-card",onClick:u},{default:be(()=>[Gt(Te(Be(e)("device.setting.change")),1)]),_:1})])}}}),zht=dt(Vht,[["__scopeId","data-v-83d0d08a"]]),$ht={key:1},Wht={class:"device-container mt-12"},jht={class:"device-container mt-12"},Qht={class:"detail-line"},Xht={class:"title",style:{color:"#1a1a1e"}},Yht={key:2},qht={key:0,class:"device-container"},Kht={key:1,class:"device-container"},Jht={key:2,class:"device-container",style:{"margin-bottom":"16px"}},Zht=Fe({__name:"Setting",props:{show:{type:Boolean},close:{type:Function},info:{},list:{}},emits:["formValueChange"],setup(n,{emit:e}){const t=n,i=e;te(()=>t.list.map((b,C)=>({label:b.label,key:C,show:!b.hidden})));const r=B0(),{t:s}=Yt(),o=ee(0),a=ee(1),l=ee(2),c=ee(3),u=ee(localStorage.getItem("DEVICE_SETTING_VISIBLE")=="1"||!1),h=ee(0),d=bt(),f=te(()=>{const b=t.list[o.value].formData.filter(C=>["name","powerGroup","device_introduction","headGroup"].includes(C.id));return b.map(C=>{C.id==="name"&&(C.name=C.value,C.label=s("mobile.device.device_model"),C.value=d.ext.config.name),C.titleColor="#97999C",(C.id==="name"||C.id==="powerGroup"||C.id==="headGroup")&&(C.fontWeight="500")}),b}),p=te(()=>t.list[o.value].formData.filter(C=>["name"].includes(C.id))),g=te(()=>{const b=t.list[o.value].formData.filter(C=>["snCode","deviceExtVersionGroup","firmwareVersionGroup","wifiConfigGroup","hotspotPassword","safe_use_specifications","subType"].includes(C.id));return b.map(C=>{C.titleColor="#97999C"}),b}),m=te(()=>t.list[a.value].formData.filter(C=>!["workLog","workTime","workTimes","taskTotal","standbyTime","workLogsGroup"].includes(C.id))),v=te(()=>{var I;const b=t.list.length>=3&&t.list[l.value].formData.filter(x=>!["airPump","cutPressureCorrect","backlash","offlineSelectKeys"].includes(x.id)),C=t.list[l.value].formData.filter(x=>["airPump"].includes(x.id));return C&&(C==null?void 0:C.length)==1?b.concat((I=C[0])==null?void 0:I.children):b}),_=te(()=>t.list.length>=4&&t.list[c.value].formData),y=(b,C,I)=>{C==="moveStop"||C==="handHeld"?jt(Zt.switch,{name:El.moveStop,type:I?"on":"off"}):C==="openGapStop"?jt(Zt.switch,{name:El.coverOpenPause,type:I?"on":"off"}):C==="smokingFanSwitch"?jt(Zt.switch,{name:El.exhaustFan,type:I?"on":"off"}):C==="beeperEnable"||C==="beepEnable"?jt(Zt.switch,{name:El.workReminder,type:I?"on":"off"}):C==="flameAlarmSensitivity"?jt(Zt.switch,{name:El.flameAlarm,type:I?"on":"off"}):C==="irPreHeat"?jt(Zt.switch,{name:El.infraredLightPreheat,type:I?"on":"off"}):C==="switch"?jt(Zt.switch,{name:El.drawerDetection,type:I?"on":"off"}):C==="exposureIncrease"?jt(Zt.switch,{name:El.backgroundIntensity,type:I?"on":"off"}):C==="beepSwitch"?jt(Zt.switch,{name:El.buzzer,type:I?"on":"off"}):C==="flameSensitivity"&&jt(Zt.switch,{name:El.flameSensitivity,type:I?"on":"off"}),console.log("[handleChange]=>",b,C,I),i("formValueChange",b,C,I)};vN(()=>(u.value?u.value=!u.value:r.back(),!0));const A=()=>{u.value?(u.value=!u.value,localStorage.setItem("DEVICE_SETTING_VISIBLE","0")):r.back()},w=()=>{h.value=Math.random(),d.updateDeviceInfo(),localStorage.setItem("DEVICE_SETTING_VISIBLE","1"),u.value=!0};return(b,C)=>{const I=lte,x=XP("xcs-form-mobile");return V(),le("div",{key:h.value,class:"out-wrap"},[ye(I,{"left-arrow":"",fixed:"",placeholder:"",title:u.value?Be(s)("mobile.device.device_setting"):Be(s)("mobile.device.device_details")},{left:be(()=>[ye(Be(Nn),{name:"arrow_left",size:"22px",class:"f-s-22",onClick:A})]),_:1},8,["title"]),u.value?$e("",!0):(V(),Ie(zht,{key:0,"device-data":p.value},null,8,["device-data"])),u.value?(V(),le("div",Yht,[m.value&&m.value.length>0?(V(),le("section",qht,[ye(x,{"form-data":m.value,onFormChange:y},null,8,["form-data"])])):$e("",!0),b.list.length>=3?(V(),le("section",Kht,[ye(x,{"form-data":v.value,onFormChange:y},null,8,["form-data"])])):$e("",!0),b.list.length>=4?(V(),le("section",Jht,[ye(x,{"form-data":_.value,onFormChange:y},null,8,["form-data"])])):$e("",!0)])):(V(),le("div",$ht,[ue("section",Wht,[ye(x,{"form-data":f.value,onFormChange:y},null,8,["form-data"])]),ue("section",jht,[ye(x,{"form-data":g.value,onFormChange:y},null,8,["form-data"])]),ue("section",{class:"device-container mt-12",style:{padding:"15px 16px"},onClick:w},[ue("div",Qht,[ue("span",Xht,Te(Be(s)("device.setting.setting")),1),ye(Be(Nn),{name:"arrow_right",size:"20px",class:"f-s-20"})])])]))])}}}),edt=dt(Zht,[["__scopeId","data-v-f4242689"]]),tdt=n=>{n.component("XcsSetting",edt)},uW=(n,e)=>pi(n)&&n in W5?ndt(jle(W5[n]),e):null,ndt=(n,e)=>{let t=n.visible??!0;return mt(n.visible)&&(t=n.visible(e)),t?n:null},DN=(n,e)=>{const t=[];return n.forEach(i=>{const r=uW(i,e);if(r)t.push(r);else if(vs(i)&&Ds(i,"name")){const s=uW(i.name,e);s?t.push(Ln(s,i)):t.push(i),console.log(["=> field is plain object.",i])}else console.warn([`=> parse field "${i}" not found.`])}),t},idt=Fe({__name:"DeviceValuesContainer",props:{ext:{},canvasId:{},deviceInfo:{},modeOptions:{type:[Function,Array]},deviceValues:{},fieldsMap:{},handler:{type:Function},processTypes:{type:[Function,Array]}},setup(n){const e=n,t=bt(),i=ee(),r=te(()=>{var h;return(h=t.ext)==null?void 0:h.uiApp.ProcessSetting}),s=te(()=>({ext:t.ext})),o=(h,d)=>{var f,p;if(console.log("[DeviceValuesContainer handlerWrapper]=>",h,d),(p=(f=i.value)==null?void 0:f.handlerWrapper)==null||p.call(f,h,d),h==="mode"&&(t.processingModeChecked=d),!(d===e.deviceValues[h]&&Ds(e.deviceValues,h)))return e.handler(h,d)},a={mode(h){if(h&&e.modeOptions){let d=e.modeOptions;mt(d)&&(d=d()),h.widgetAttrs.options=d}},material(h){var f;const d=mt(e.processTypes)?e.processTypes():e.processTypes;h.widgetAttrs=Object.assign({},h.widgetAttrs,{power:((f=e.deviceInfo)==null?void 0:f.power)??0,processTypes:Zi(d,"value")})}},l=h=>{h.forEach(d=>{const f=a[d.name];mt(f)&&f(d)})},c=te(()=>{const{mode:h}=e.deviceValues,d=e.fieldsMap[h]||[];let f=DN(d,e.deviceValues);return l(f),u(f,nt.D1Pro,[zt.SCREEN_PRINT]),u(f,nt.D1Pro2,[zt.SCREEN_PRINT]),u(f,nt.S1,[zt.SCREEN_PRINT,zt.CURVE_PROCESS,zt.LASER_CONVEYOR_FEEDER]),u(f,nt.P2,[zt.CURVE_PROCESS,zt.LASER_CONVEYOR_FEEDER]),u(f,nt.M1,[zt.PRINTER_KNIFE_CUT]),f=f.filter(p=>p.name!="captureGroup"),console.log("[设备加工面板组件列表]",f),console.log("[设备加工面板组件列表值]",JSON.stringify(e.deviceValues)),f}),u=(h,d,f)=>{if(t.extId===d){const p=h.find(g=>g.name==="mode");p==null||p.widgetAttrs.options.map(g=>(f.includes(g.value)&&(g.status="disable"),g))}};return(h,d)=>(V(),le(vt,null,[ye(Be(Gv),{values:h.deviceValues,items:c.value,handler:o},null,8,["values","items"]),(V(),Ie(Uo(r.value),ht({ref_key:"processSettingRef",ref:i},s.value),null,16))],64))}}),rdt=dt(idt,[["__scopeId","data-v-de71dd4c"]]),sdt={class:"pop-header"},odt={class:"pop-header-title"},adt={class:"pop-main"},ldt={key:0,class:"pop-footer"},cdt=Fe({__name:"CommonPanel",props:{teleportName:{},show:{type:Boolean},title:{},titleIcon:{},content:{},hideOverlay:{type:Boolean},maxHeight:{}},emits:["update:show","close"],setup(n,{emit:e}){const t=n,i=e,r=te({get:()=>t.show,set:o=>i("update:show",o)}),s=()=>{r.value=!1,i("close")};return(o,a)=>{const l=xn,c=Ko;return V(),Ie(c,{show:r.value,"close-on-click-overlay":!1,duration:.5,teleport:o.teleportName??"body",overlay:!o.hideOverlay,"overlay-class":"common-modal-overlay",position:"bottom",class:"common-modal"},{default:be(()=>[ue("div",{style:On({"--max-height":o.maxHeight??"100vh"}),class:"pop-container"},[ue("div",sdt,[Fs(o.$slots,"header",{},()=>[ue("span",odt,Te(o.title),1),ye(l,{class:"header-close f-s-30",name:o.titleIcon,onClick:s},null,8,["name"])],!0)]),ue("div",adt,[Fs(o.$slots,"content",{},void 0,!0)]),o.$slots.footer?(V(),le("div",ldt,[Fs(o.$slots,"footer",{},void 0,!0)])):$e("",!0)],4)]),_:3},8,["show","teleport","overlay"])}}}),udt=dt(cdt,[["__scopeId","data-v-3f37ed33"]]),hdt=""+new URL("../images/matrix-loading.gif",import.meta.url).href,ddt={class:"matrix-param-wrap"},fdt=["src"],pdt=["src"],gdt=["onClick"],mdt=Fe({__name:"MatrixParam",props:{originWidth:{},loading:{type:Boolean},imgPopoverVisible:{type:Boolean},width:{},ignoreClick:{type:Boolean},handler:{type:Function},material:{},mode:{},items:{},elementValues:{}},emits:["clickImage"],setup(n,{emit:e}){const t=n,i=e,{t:r}=Yt(),s=el(),o=(y,A)=>`${y*(A/180)}px`,a=y=>{const A=[];for(let w=0;w<y.length;w++)A[w]=new Image,A[w].src=y[w]};yt(()=>t.loading,()=>{var y;a([(y=h.value)==null?void 0:y.url])});const c=DT().isOnline,u=qr({img:"frontImg"}),h=te(()=>{if(t.mode!==zt.LASER_PLANE)return;const y=p.value.images.find(A=>A.key===u.img);return y&&y.url&&(y.url=ZO(y.url,"m_fill,w_644,h_644","webp")),y}),d=te(()=>{var Pe,De;const{material:y=0,elementValues:A,items:w=[]}=t,{paraMatrix:b={},processingData:C={}}=g.value||{},I=b[A.processingType],x=(Pe=C[A.processingType])==null?void 0:Pe.power,T=(De=C[A.processingType])==null?void 0:De.speed;if(console.log(["=> materialItem",g.value]),y===0||!A.processingType||!g.value||!I||wt(w))return{minPower:0,maxPower:0,minSpeed:0,maxSpeed:0,row:0,col:0,rowSpacing:0,colSpacing:0,xOffset:0,yOffset:0,elementHeight:0,elementWidth:0,frontImg:"",reverseImg:""};const{minPower:F,maxPower:G,minSpeed:B,maxSpeed:R,row:P,col:k,rowSpacing:L,colSpacing:H,xOffset:U,yOffset:$,elementHeight:j,elementWidth:Q,frontImg:ne,reverseImg:ve}=I;return{minPower:F,maxPower:G,minSpeed:B,maxSpeed:R,row:P,col:k,rowSpacing:L,colSpacing:H,xOffset:U,yOffset:$,elementHeight:j,elementWidth:Q,frontImg:ne,reverseImg:ve,defaultPower:x,defaultSpeed:T}}),f=(y,A,w)=>{const b=y-1,C=(A-w)/(b>0?b:1),I=Array(y).fill(0).map((x,T)=>Math.ceil(w+T*C));return console.log("getValueLabel",I),I},p=te(()=>{const{minPower:y,maxPower:A,minSpeed:w,maxSpeed:b,row:C,col:I,elementHeight:x,elementWidth:T,xOffset:O,yOffset:F,rowSpacing:G,colSpacing:B,frontImg:R,reverseImg:P,defaultPower:k,defaultSpeed:L}=d.value,H=[],U=f(I,A,y),$=hj(f(C,b,w));for(let Ne=0;Ne<$.length;Ne++){const et=$[Ne];H[Ne]=[];for(let ze=0;ze<U.length;ze++){const de=U[ze];H[Ne].push({power:de,speed:et})}}const j=x,Q=T,ne=O,ve=F,Pe=G,De=B,Xe=[];return R&&Xe.push({key:"frontImg",label:"device.parameter_panel.front",url:R}),P&&Xe.push({key:"reverseImg",label:"device.parameter_panel.back",url:P}),{defaultPower:k,defaultSpeed:L,data:H,style:{height:j,width:Q,left:ne,top:ve,gapX:De,gapY:Pe},images:Xe}}),g=te(()=>s.getMaterialList.find(y=>y.id===t.material)),m=te(()=>{const{style:y}=p.value,{width:A,height:w,left:b,top:C,gapY:I,gapX:x}=y,T=t.originWidth;return{width:o(A,T),height:o(w,T),left:o(b,T),top:o(C,T),gapY:o(I,T),gapX:o(x,T)}}),v=(y,A)=>{t.ignoreClick||(y.speed===A.speed&&y.power===A.power?t.handler("materialType",{materialType:"official",data:{}}):t.handler("matrixParam",y))},_=()=>{var y;(y=h.value)!=null&&y.url&&(jt(Zt.buttonClick,{elementId:ki.paramMatrix}),i("clickImage",!t.imgPopoverVisible))};return yt(()=>h.value,y=>{y!=null&&y.url||i("clickImage",!1)}),(y,A)=>{var w,b;return V(),le("div",ddt,[y.loading?(V(),le("div",{key:0,class:"loading-box",style:On({width:`${y.width}px`,height:`${y.width}px`})},[ue("img",{src:Be(hdt),class:"loading-img",alt:""},null,8,fdt)],4)):(V(),le(vt,{key:1},[Be(c)?(V(),le("div",{key:0,class:"matrix-param-online",style:On({width:`${y.width}px`,height:`${y.width}px`})},[(w=h.value)!=null&&w.url?(V(),le("section",{key:0,class:"absolute",style:On({width:`${y.originWidth}px`,height:`${y.originWidth}px`,top:`-${(y.originWidth-y.width)/2}px`,left:`-${(y.originWidth-y.width)/2}px`})},[ue("img",{src:h.value.url,alt:"",class:"w-full"},null,8,pdt)],4)):(V(),le("section",{key:1,class:"matrix-param-not-online",style:On({width:`${y.width}px`,height:`${y.width}px`})},[ye(Be(Nn),{name:"param-empty",class:"f-s-80"}),ue("span",null,Te(Be(r)("device.parameter_panel.array")),1)],4)),(b=h.value)!=null&&b.url?(V(),le("section",{key:2,id:"parameterMatrix",class:"absolute",style:On({width:`${y.originWidth}px`,height:`${y.originWidth}px`,top:`-${(y.originWidth-y.width)/2}px`,left:`-${(y.originWidth-y.width)/2}px`}),onClick:_},[ue("section",{class:"absolute-gap",style:On({gap:m.value.gapY,top:m.value.top,left:m.value.left})},[(V(!0),le(vt,null,Fn(p.value.data,(C,I)=>(V(),le("section",{key:I,class:"matrix-box",style:On({gap:m.value.gapX})},[(V(!0),le(vt,null,Fn(C,(x,T)=>(V(),le("span",{key:T,style:On({width:m.value.width,height:m.value.height}),class:St({active:t.elementValues.speed===x.speed&&t.elementValues.power===x.power,default:x.speed===p.value.defaultSpeed&&x.power===p.value.defaultPower}),onClick:O=>v(x,{speed:p.value.defaultSpeed,power:p.value.defaultPower})},null,14,gdt))),128))],4))),128))],4)],4)):$e("",!0)],4)):(V(),le("div",{key:1,class:"matrix-param-not-online",style:On({width:`${y.width}px`,height:`${y.width}px`})},[ye(Be(Nn),{name:"network-error",class:"f-s-80"}),ue("span",null,Te(Be(r)("common.network_error")),1)],4))],64))])}}}),vdt=dt(mdt,[["__scopeId","data-v-f58be72f"]]),_dt={class:"parameter-content"};const ydt={key:1,class:"border-12"},Adt={key:2,class:"border-12"},bdt={key:3,class:"border-12 param-box"},wdt={class:"param-title"},xdt={id:"matrix"},Cdt=Fe({__name:"ParameterPanel",props:{showPanel:{type:Boolean},formItems:{},elementValues:{},material:{},mode:{},handler:{type:Function}},emits:["onClose"],setup(n,{emit:e}){const t=n,i=e,{t:r}=Yt(),s=ee(330),o=ee(!1),a=te(()=>t.showPanel),l=ee(!1);yt(()=>a.value,p=>{p&&(l.value=p,setTimeout(()=>{l.value=!1},3e3))}),Zn(()=>{Yi(()=>{const p=document.getElementById("matrix");s.value=(p==null?void 0:p.clientWidth)||330})});const c=()=>{i("onClose")},u=()=>{const p=DN(["speed","repeat"],{});return p.map(g=>{g.disabled=!0}),p},h=["processingLightSource","power","speed","cutPressure","powerMinMaxRange","dotDuration","dpi","repeat"],d=te(()=>{var p;return(p=t.formItems)==null?void 0:p.filter(g=>h.includes(g.name))}),f=te(()=>{var p;return(p=t.formItems)==null?void 0:p.filter(g=>!h.includes(g.name))});return(p,g)=>{const m=udt;return V(),Ie(m,{show:a.value,"onUpdate:show":g[0]||(g[0]=v=>a.value=v),title:Be(r)("device.parameter_panel.title"),"title-icon":"common-round-close",class:"floating-panel-wrap",onClose:c},{content:be(()=>[ue("div",_dt,[$e("",!0),d.value&&d.value.length>0?(V(),le("section",ydt,[ye(Be(Gv),{values:p.elementValues,items:d.value,handler:p.handler},null,8,["values","items","handler"])])):$e("",!0),f.value&&f.value.length>0?(V(),le("section",Adt,[ye(Be(Gv),{values:p.elementValues,items:f.value,handler:p.handler},null,8,["values","items","handler"])])):$e("",!0),p.formItems?(V(),le("section",bdt,[ue("section",wdt,Te(Be(r)("device.parameter_panel.array")),1),ue("section",xdt,[ye(vdt,{loading:l.value,width:s.value,"origin-width":s.value,"ignore-click":!1,handler:p.handler,material:p.material,mode:p.mode,items:p.formItems,"element-values":p.elementValues,"img-popover-visible":o.value},null,8,["loading","width","origin-width","handler","material","mode","items","element-values","img-popover-visible"])])])):$e("",!0)])]),_:1},8,["show","title"])}}}),Edt=dt(Cdt,[["__scopeId","data-v-d7050394"]]),Tdt={key:0,class:"x-form-mobile-wrap"},Idt={class:"divider-line"},Sdt={key:1,class:"selected-types"},Pdt={class:"txt"},Mdt={key:2,class:"processing-is-not-supported"},Rdt={key:0,class:"x-form-mobile-wrap"},Ddt={class:"divider-line"},kdt={key:1,class:"parameter-panel-box"},Odt={class:"bg-box"},Ldt={key:0},Ndt={key:1},Bdt={class:"icon"},Fdt={key:2},Udt=Fe({__name:"ElementContainer",props:{ext:{},elements:{},elementValues:{},deviceValues:{},selectedTypes:{},typeOptions:{type:[Function,Array]},fieldsMap:{},handler:{type:Function},handleSelectVector:{type:Function},handleSelectBitmap:{type:Function}},setup(n){const e=n;bt();const{t}=Yt(),i=ee(!1),r=g=>{g&&jt(Zt.buttonClick,{elementId:ki.parameterPanel,source:"parameter"}),i.value=g},s=g=>{g.height===0&&(i.value=!1)},o=te(()=>{var v;const g=e.deviceValues.mode,m=(v=e.ext)==null?void 0:v.getProcessingTypes({mode:g,imageType:e.selectedTypes[0]});return wt(m)}),a={processingType(g){if(g&&e.typeOptions){let m=e.typeOptions;mt(m)&&(m=m()),g.widgetAttrs.options=m}},materialType(g){var m,v;g.widgetAttrs=Object.assign({},g.widgetAttrs,{processingType:e.elementValues.processingType,material:e.deviceValues.material}),Ft(g,"labelSuffix.widgetAttrs.content.button.href",(m=e.ext.config.supportUrls)==null?void 0:m.material),((v=e.elementValues)==null?void 0:v.materialType)!=="official"&&Ft(g,"labelSuffix",void 0)},speed(g){g.widgetAttrs=Object.assign({},g.widgetAttrs,e.ext.getSpeedScope(e.deviceValues,e.elementValues));const{max:m}=g.widgetAttrs;tn(m)&&e.elementValues.speed>m&&e.handler("speed",m)}},l=g=>{g.forEach(m=>{const v=a[m.name];mt(v)&&v(m);let _=e==null?void 0:e.elementValues[m.name];m!=null&&m.label&&cr(_)&&(m.class+=" multiple-values",m.multiState=!0)})},c=te(()=>{let g={ignore:[],type:[],other:[]};if(o.value)return g;const{processingType:m}=e.elementValues,v=e.fieldsMap[m]||["processIgnore","processingType"];let _=DN(v,e.elementValues);wt(m)&&(_=_.slice(0,2)),l(_);const[y,A,w,...b]=_;return g={ignore:y?[y]:[],type:A?[A]:[],other:b},w&&g.type.push(w),g}),u=te(()=>{if(e.ext&&e.ext.processingTypes&&e.elementValues.processingType){const g=e.elementValues.processingType,m=e.ext.processingTypes.find(_=>_.value===g);if(!m||wt(m==null?void 0:m.keyParameter))return c.value.other.slice(0,3);console.log("[keyParameter]=>",m.keyParameter);const v=m.keyParameter.filter(_=>_!=="processingLightSource");return c.value.other.filter(_=>da(v,_.name)).filter(_=>mt(_.visible)?_.visible(e.elementValues):_.visible!==!1)}else return c.value.other.slice(0,3)}),h=g=>{const m=e.elementValues[g.name];if(g.widget==="select"){const v=g.widgetAttrs.options.find(_=>_.value===m);return v?t(v.label):""}else return Wv.isArray(m)?Wa(m).join(" - "):m},d=te(()=>{var g,m;return mt(e.ext.elementDataValues)?e.ext.elementDataValues()[((g=e.elementValues)==null?void 0:g.processingType)||""]||{}:e.ext.elementDataValues[((m=e.elementValues)==null?void 0:m.processingType)||""]||{}}),f=te(()=>Object.keys(d.value)),p=te(()=>{let g=!0;return f.value.forEach(m=>{Fl(e.elementValues[m],d.value[m])||(g=!1)}),e.elementValues.materialType==="customize"&&g});return(g,m)=>{var A,w;const v=hO,_=Hi,y=Oi;return V(),le("div",null,[Be(wt)(c.value.ignore)?$e("",!0):(V(),le("section",Tdt,[ye(Be(Gv),{values:g.elementValues,items:c.value.ignore,handler:g.handler},null,8,["values","items","handler"]),ue("section",Idt,[ye(v,{style:{margin:"0",padding:"0"}})])])),g.selectedTypes.length>1?(V(),le("section",Sdt,[ue("section",Pdt,Te(g.$t("device.element_container.cant_set_params_for_both")),1),ye(_,{class:"btn",block:"",plain:"",onClick:g.handleSelectVector},{default:be(()=>[Gt(Te(g.$t("device.element_container.select_vector")),1)]),_:1},8,["onClick"]),ye(_,{class:"btn",block:"",plain:"",onClick:g.handleSelectBitmap},{default:be(()=>[Gt(Te(g.$t("device.element_container.select_bitmap")),1)]),_:1},8,["onClick"])])):o.value?(V(),le("section",Mdt,Te(g.$t("device.element_container.processing_is_not_supported")),1)):(V(),le(vt,{key:3},[Be(wt)(c.value.type)?$e("",!0):(V(),le("section",Rdt,[ye(Be(Gv),{values:g.elementValues,items:c.value.type,handler:g.handler},null,8,["values","items","handler"]),ue("section",Ddt,[ye(v,{style:{margin:"0",padding:"0"}})])])),g.elementValues.processingType!==null?(V(),le("section",kdt,[ye(y,{border:!1,title:g.$t("device.parameter_panel.title"),center:"","is-link":"",onClick:m[0]||(m[0]=b=>r(!0))},{"right-icon":be(()=>[ye(Be(Nn),{name:"arrow_right",size:"22px",class:"f-s-22"})]),_:1},8,["title"]),ue("section",{class:"parameter-panel-body",onClick:m[1]||(m[1]=b=>r(!0))},[ue("section",Odt,[Be(cr)(g.elementValues.processingType)||Be(cr)(g.elementValues.materialType)?(V(),le("span",Ldt,Te(g.$t("common.input-multi-state")),1)):p.value?(V(),le("span",Ndt,Te(g.$t("ipad.parameter_panel.user_guide")),1)):(V(!0),le(vt,{key:2},Fn(u.value,b=>(V(),le("span",{key:b.name,class:"show-items"},[ue("span",Bdt,[ye(Be(Nn),{name:`icon-${b.name}`,class:"f-s-18"},null,8,["name"])]),ue("span",null,Te(Be(cr)(g.elementValues[b.name])?g.$t("common.input-multi-state"):`${h(b)} ${b.unitExtra?b.unitExtra.slice(1,-1):""}`),1)]))),128))])])])):$e("",!0),Be(wt)(g.elements)?$e("",!0):(V(),le("section",Fdt,[ye(Edt,{"show-panel":i.value,"form-items":c.value.other,"element-values":g.elementValues,material:(A=g.deviceValues)==null?void 0:A.material,mode:(w=g.deviceValues)==null?void 0:w.mode,handler:g.handler,onOnClose:m[2]||(m[2]=b=>r(!1)),onHeightChange:s},null,8,["show-panel","form-items","element-values","material","mode","handler"])]))],64))])}}}),Gdt=dt(Udt,[["__scopeId","data-v-751fc880"]]),Hdt=n=>{n.component("ElementContainer",Gdt),n.component("DeviceValuesContainer",rdt)},Vdt=Nze();var cv,uv;const oa=class oa{static add(e,t){S(oa,cv).set(e,t)}static addStop(e,t){S(oa,uv).set(e,t)}static remove(e){S(oa,cv).delete(e),S(oa,uv).delete(e)}static onActivity(){oa.isActive=!0,S(oa,cv).forEach(e=>e())}static onPause(){oa.isActive=!1,S(oa,uv).forEach(e=>e())}};cv=new WeakMap,uv=new WeakMap,ke(oa,cv,new Map),ke(oa,uv,new Map),E(oa,"isActive",!0);let kE=oa;const zdt=n=>(u6("data-v-6b0ffdc1"),n=n(),h6(),n),$dt=zdt(()=>ue("span",null,null,-1)),Wdt=Fe({__name:"Index",setup(n){Yt();const e=pg(ZXe),t=ha(),r=ee({x:(g=>g*Math.min(document.documentElement.clientWidth/375,2))(319),y:document.documentElement.clientHeight-48-231}),s=ee(!1),o=ee(null);Lo(()=>e.uiState.showMinimizedWindow,g=>{s.value=g}),ee(!1);const a=te(()=>{var g;return t.isShowCountTime((g=o.value)==null?void 0:g.extInstanceId)});Lo(()=>e.uiState.currentProcessTaskData,(g,m)=>{o.value=g});const l=te(()=>{var A,w,b;let g=(A=o.value)==null?void 0:A.countTime,m=(((w=o.value)==null?void 0:w.totalTime)??0)*1e3,_=(((b=o.value)==null?void 0:b.timeUse)??0)/m*100;return g?100-_:_}),c=g=>{o.value&&t.isProcessAlive(o.value.extInstanceId)&&(console.log("skipProcess",o.value.id),Ls.push({path:"/process",query:{taskId:o.value.id,instanceId:o.value.extInstanceId,action:g}}))},u=(g,m)=>{g===It.FINISH_PROCESS&&m!==""&&Ls.currentRoute.value.path!=="/process"&&!t.isHideMinimizedWindow&&c()},h=g=>{var v;let m=((v=o.value)==null?void 0:v.extInstanceId)??bt().currentInstanceId;g[m]===It.CANCEL_PROCESS&&Ls.currentRoute.value.path!=="/process"&&e.sendEvent(new uJ(m))},d=()=>{tt.modal.showToast({icon:"warning",msg:"device.process.task_canceled",duration:3e3})},f=ee(!1),p=g=>{f.value=g===It.PAUSE_PROCESS};return Lo(()=>e.uiState.currentProcessState,(g,m)=>{var A;let v=((A=o.value)==null?void 0:A.extInstanceId)??bt().currentInstanceId,_=g[v]??"",y=(m==null?void 0:m[v])??"";u(_,y),h(g),p(_),_===It.CANCEL_PROCESS&&Ls.currentRoute.value.path=="/editor"&&d()}),(g,m)=>{const v=xn,_=cte,y=ute;return s.value&&Be(Ls).currentRoute.value.path!=="/process"?(V(),Ie(y,{key:0,offset:r.value,"onUpdate:offset":m[1]||(m[1]=A=>r.value=A),axis:"xy",magnetic:"x",gap:8,class:"task-floating",style:{"z-index":"4000",background:"#ffffff","box-shadow":`0px 0px 2px 0px #00000014,
        0px 6px 16px 0px #0000001f,
        0.5px 0.5px 0px 0px #ffffff14 inset`},onClick:c},{default:be(()=>[a.value?(V(),Ie(_,{key:0,"current-rate":l.value,"onUpdate:currentRate":m[0]||(m[0]=A=>l.value=A),rate:l.value,speed:50,"stroke-width":50,color:f.value?"#ff7c23":"#28be44","layer-color":"#ffffff",fill:"#ffffff",class:"task-circle"},{default:be(()=>[ye(v,{name:f.value?"process-task-pause":"process-task-process",class:"task-icon",color:f.value?"#ff7c23":"#28be44"},null,8,["name","color"])]),_:1},8,["current-rate","rate","color"])):(V(),Ie(v,{key:1,name:f.value?"process-task-pause":"process-task-process",class:"task-icon"},null,8,["name"])),$dt]),_:1},8,["offset"])):$e("",!0)}}}),jdt=dt(Wdt,[["__scopeId","data-v-6b0ffdc1"]]),Qdt=Fe({__name:"App",setup(n){var i;N0();const e=((i=jv())==null?void 0:i.appContext)||void 0;Ms.setAppContext(e);const t=()=>{const{domain:r}=nl(),s=`${r.commonApi}/efficacy/v1/data/type/xtool_onsale_devices/items`;fi.get(s).then(o=>{if(o.status,o.data.code===0){const a=o.data.data;console.log("======getRemoteDeviceConfig deviceList:",a),a.length>0&&localStorage.setItem(yJ,JSON.stringify(a))}}).catch(o=>{console.log("======getRemoteDeviceConfig err:",o)})};return Zn(()=>{bd().initFont().finally(()=>{setTimeout(()=>{var r;(r=window.MeApi)==null||r.mainWindowLoaded(),tt.onPageLoad()},300)}),si().updateLangeFile(),si().checkSoftUpdate(),t()}),yt(()=>kn().currentTempXcs,(r,s)=>{console.log("====watch currentTempXcs====",r,s),(r==null?void 0:r.tempFileId)===(s==null?void 0:s.tempFileId)&&(r==null?void 0:r.extInstanceId)!==(s==null?void 0:s.extInstanceId)&&(console.log("====watch currentTempXcs==== clearProjectCanvasBgImageMap"),fn().clearProjectCanvasBgImageMap())}),(r,s)=>{const o=XP("vue-page-stack"),a=XP("router-view"),l=hte;return V(),Ie(l,{class:"provider-wrapper"},{default:be(()=>[ye(a,null,{default:be(({Component:c})=>[ye(o,null,{default:be(()=>[(V(),Ie(Uo(c),{key:r.$route.fullPath}))]),_:2},1024)]),_:1}),ye(jdt)]),_:1})}}}),Xdt=dt(Qdt,[["__scopeId","data-v-457992eb"]]);class Ydt{init(){HA.addIgnoreGlobalShowKeys("device.status.taking_picture"),HA.addIgnoreGlobalShowKeys("device.status.editor_page")}}const qdt=new Ydt;console.log(qee,Kee,Jee);cee();const Kdt=new Map([[xf.SCALE,{icon:"images/cnv-qck-btn/node.svg",iconHover:"images/cnv-qck-btn/node-hover.svg"}],[xf.ROTATE,{icon:"images/cnv-qck-btn/transformer-rotate.png",iconHover:"images/cnv-qck-btn/transformer-rotate.svg",y:-11}],[xf.COPY,{icon:"images/cnv-qck-btn/node.svg",iconHover:"images/cnv-qck-btn/node-hover.svg"}],[xf.DELETE,{icon:"images/cnv-qck-btn/node.svg",iconHover:"images/cnv-qck-btn/node-hover.svg"}],[xf.LOCK,{icon:"images/cnv-qck-btn/node.svg",iconHover:"images/cnv-qck-btn/node-hover.svg"}]]),Jdt={imgEditorBaseDrop:"images/cnv-config/alpha-bg.png",textCurve:"images/cnv-config/text-curve.png",cutterSava:{icon:"images/cnv-config/confirm.png",iconHover:"images/cnv-config/confirm_hover.svg"},cutterCancel:{icon:"images/cnv-config/cancel.png",iconHover:"images/cnv-config/cancel_hover.png"}};za.setup({mergeExtRes:!0}).then(n=>{const e=d6(Xdt);e.use(Vdt),e.use(Ls),e.use(dte),e.use(n),e.use(hut),e.directive("x-tooltip",Aee),e.use(Z4e,{router:Ls}),e.mount("#app");const t=new O5e;t.setButtons(Kdt).seTimageConfig(Jdt),tt.setModal(new Oht).setEvent(new pqe).setCanvasFactory(t).setAppType(ps.App),Hdt(e),tdt(e),E7e().initOutOpen(),e.provide("useMessage",()=>{}),e.provide("useDialog",()=>{}),qdt.init()});window.openApi=Object.assign(window.openApi||{},{onPause:(n,e)=>{var t,i;console.log(n,e),kn().saveCurrentTempXcsIfEnable(),kE.onPause(),(i=(t=window.MeApi)==null?void 0:t.openNative)==null||i.needBackgroundTask(ha().isAnyProcessStarted)},onDidActive:(n,e)=>{console.log(n,e),xp().requestUserInfo(),kE.onActivity(),_N().onPageResume()},onWebTerminated:()=>{},notifyRefreshUserInfo:()=>{console.log("==>notifyRefreshUserInfo"),xp().requestUserInfo()},loadMaterial:n=>{el().webCommandSelectMaterial(n)}});jYe();const Wpt=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{dy as ACTION_ID,XO as ADD_EXT_MODE,Tl as ALIGN_TYPE,ps as AppType,G6 as AxiosError,RC as BATCH_CREATE_TYPE,Vh as BOOL_OP,Yc as BaseViewModel,yze as BinderUiRequestEvent,Am as BitMaskOpt,wa as BufferGeometry,ki as ButtonNames,gn as CANVAS_EVENT,kc as CHANGE_LAYER_TYPE,ja as CONNECT_TYPE,Ept as CSS2DObject,Npt as CameraLocationViewModel,o7e as CameraTipIKnowEvent,a7e as CameraTipNeverRemindEvent,$9e as CancelDownloadXcsTaskEvent,W9e as CancelUploadXcsTaskEvent,l7e as CanvasLoadPictureEvent,c7e as CanvasUpdateBgImageEvent,opt as CheckAppVersionEvent,R9e as CheckNeedReopenTempXcsEvent,Gft as ClearOutlineEvent,J9e as ClickActionEvent,N5 as CloudProjectViewModel,Lft as CnvBatchCreateEvent,Oft as CnvEleBitMaskOptEvent,Dft as CnvEleInsertEvent,kft as CnvEleQuickOpEvent,wpt as CnvOpVecViewModel,Bft as CnvParamsTestEvent,Xft as CodeFillEvent,udt as CommonPanel,Uhe as CommonProcessDataCheckTip,n7e as CompleteStickerEvent,fa as Config,eK as ConnectType,mn as Container,C9e as CreateNewTempXcsEvent,hK as DEBUG_DISPLAY_DEVICE,uK as DEBUG_ENV,dK as DEBUG_PRE_STATE,Nhe as DEFAULT_COLOR_NAME,Za as DEFAULT_ELEMENT_LINE_STYLE,Apt as DEFAULT_IMPORT_DISPLAY_X,bpt as DEFAULT_IMPORT_DISPLAY_Y,ii as DEFAULT_LAYER_COLOR,Lhe as DEFAULT_LAYER_COLOR_LIST,pft as DEFAULT_LAYER_NAME,Fhe as DEVICE_PROCESSING_MODE,dM as DEVICE_TYPE,it as DISPLAY_TYPE,A9e as DeleteAllTempXcsFileEvent,F9e as DeleteCloudProjectEvent,pk as DialogName,H9e as DownloadProjectEvent,Vt as EDIT_MODE,Zt as EventNames,Mi as ExtManager,Qft as ExtractEvent,Nft as FinishBatchCreateEvent,jft as FinishCurModeEvent,p7e as FirmwareUpdateViewModel,Tpt as G0_COLOR,fd as GRAPHICS_CURVES_QUALITY,ypt as GetAllDebugData,ept as GetSupportLanguageEvent,Yft as GraffitiEvent,Jw as Group,_R as HANDLE_MODE,u7e as HOTSPOT_DEVICE_IP,Fpt as HOTSPOT_PASSWORD_MAP,Bpt as HOTSPOT_PREFIX,D9e as HaveOpenProjectEvent,rh as IMAGE_PROCESS_TOOL,mc as InsertType,Ipt as LINE_POINT_COUNT,N5e as MCanvasViewModel,Dt as Matrix,$u as Mesh,VK as MeshBasicMaterial,zO as MessageType,NI as ModalCenterColumn,UYe as MultiConnectViewModel,ir as MultiProcessManager,L9e as MultiProjectViewModel,Op as NativeApi,apt as OpenAppUpdateUrlEvent,V9e as OpenCloudProejctEvent,dpt as OpenHelpCenterUrlEvent,cpt as OpenPrivacyUrlEvent,ppt as OpenProjectUrlEvent,hpt as OpenSafetyUrlEvent,fpt as OpenShopUrlEvent,x9e as OpenTempXcsEvent,upt as OpenTermsUrlEvent,Uft as OutlineEventEvent,Ppt as PLANE_COLOR,Spt as POINT_STEP_COUNT,It as PROCESSING_EVENT,zt as PROCESSING_MODE,xl as PROCESSING_STEP_NAMES,Hy as PROCESS_START_POINT,eVe as PageName,bp as PageStack,vze as ParamsTestType,uN as PlaneGeometry,_Xe as Points,vXe as PointsMaterial,nt as ProductType,um as ProjectSource,mze as QuickOp,wze as RedoCnvRequestEvent,K9e as RefreshCameraLocationStateEvent,N9e as RefreshProjectEvent,U9e as RenameCloudProjectEvent,S9e as RenameCurrentTempXcsEvent,$ft as ResetInsertEvent,I9e as SaveCurrentTempXcsEvent,k9e as SaveCurrentXcsThenDeleteAllEvent,Vft as SelectAllEvent,npt as SetAutoSnappingEvent,lpt as SetAutoUpdateDeviceExtEvent,Ize as SetCanvasZoomEvent,_pt as SetDebugModeEvent,rpt as SetDisplayVectorFillEvent,vpt as SetDxfValueEvent,gpt as SetImageFitEvent,mpt as SetIsPreciseDxfFileParseEvent,O9e as SetIsShowPopToastEvent,Zft as SetLanguageEvent,spt as SetOperationPromptEvent,ipt as SetPreciseVectorPathEvent,tpt as SetQualityEvent,Jft as SetUnitEvent,zo as ShaderConfig,_E as SingleData,Wft as SmartFillEvent,t7e as StickerStep1DismssEvent,e7e as StickerStep1NextEvent,i7e as StickerStep2DismssEvent,s7e as StickerStep2RedoEvent,r7e as StickerStep2UndoEvent,Z9e as StickerTipNextEvent,xze as StopCnvRequestEvent,bv as Storage,Nn as SvgIcon,Hft as SwitchMultiSelectModeEvent,w9e as SwitchToTempXcsEvent,sr as TRANSFORMER_EVENT,M5 as ThreeRenderer,Qi as Ticker,ko as UNDO_HISTORY_EVENT,_C as UNIT_TYPE,bze as UndoCnvRequestEvent,Fft as UpDateAttributesEvent,G9e as UploadProjectEvent,z9e as UploadXcsFromSystemEvent,Oe as Vector3,zft as VisibleEvent,No as WorkerManager,kE as XCSActivityStateListener,Gy as XCS_DEFAULT_NAME,mft as __decorate,xn as __unplugin_components_0,BI as __unplugin_components_1,vg as __unplugin_components_3,dt as _export_sfc,VT as apiParserNext,Js as appDataPath,yl as appFontManager,Ms as appManager,fi as axios,cI as calcAspectRatioFit,Gi as canvasInterface,Hpt as checkDisplayInfo,Upt as checkIsIphone,$pt as checkIsIphone$1,jle as clone,hot as closeToast,Mpt as configGcodeToPoits,Us as createDisplay,Fc as debounce,GYe as defaultRemoteDeviceConfig,ba as defineStore,ft as deviceManager,$r as deviceService,Qce as endsWith,uh as eventsExports,Di as externalInterface,Ri as fileHelper,Oj as filterMaterialListByDeviceMode,e5e as fontInterface,Sd as format,nl as getDomain,ZO as getOssProcessedImage,A5e as getOutlinePath,vM as getPlatform,Rpt as getThreeJSObjects,oft as gtmEvokePassport,gft as imageData2Image,m7e as importFileManager,Rt as isArray,wt as isEmpty,Fl as isEqual,C8 as isError,cr as isNull,tn as isNumber,pi as isString,gi as isUndefined,Rhe as loadImg,RV as loaderMap,za as localization,X as mCanvasManager,Wpt as main,Zi as map,ia as materialManager,Ln as merge,HA as messageManager,II as observeEffect,Lo as observeState,mN as openBrowser,nf as parseJSON,Hl as processUtilityManager,L5 as projectManager,h7e as recoverNumber,yJ as remoteDeviceConfigKey,nye as require$$0,Ls as router,jt as sensorsTrack,qi as settingManager,Wa as sortBy,Kft as storeToRefs,fft as stringifyObject,Nr as taskManager,bhe as throttle,NV as toFixedNumber,L4 as toUnicodeCharArray,aft as trackProcessingResult,Gpt as unSupportMode,Ja as uniq,nr as uniqueId,WXe as updateUniforms,dft as useArrayUnique,fn as useCanvasStore,xp as useCenterStore,qx as useDataSource,n8 as useDebounceFn,bt as useExtCenterStore,R5 as useFirmwareUpdateStore,_N as useGlobalParamStore,el as useMaterialStore,DT as useNetwork,ha as useProcessStore,Hc as useProjectDataStore,kn as useProjectStroe,si as useSettingStore,vN as useSystemBack,pg as useViewModel,hm as userCenterManager,bd as userFontStore,ho as w,tt as xcsApp};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./jsbarcode-mnEjUZ4Q.js","../assets/index-FfF0Lcw0.js","./canvaskit-74p6ItzK.js","./hitareadebugpainter-bRWMRks3.js","./importmap-vue-u6Q_1Jji.js","./importmap-vue-router-aHGpzyJi.js","./importmap-vue-i18n-LlhaB8iP.js","./importmap-vant-Ij4SMMwJ.js","./browser-module--7s41BTz.js","./index-754fNoS4.js","./useviewstate-4zKfOP-K.js","./importfileviewmodel-n9UVAPSW.js","./projectsheet-K9koNuPr.js","./home-ZBXW98bt.js","./index-w40geAFS.js","./card-QDkFRbbw.js","./griditem.vue_vue_type_style_index_0_scoped_39934db8_lang-w40geAFS.js","./projectcard-A3Vctj2I.js","./index-DkoCfqcs.js","./index-0yD8KSdE.js","./index-km_fhrhL.js","./index-QtrcpKXE.js","./useconnecttoast-pF_Ib8b4.js","./wifiviewmodel-2Do6mA4t.js","./permissioncheck-Ft6xUpiy.js","./apconnectconfig-XbZ4D7sa.js","./index-atWsQG3N.js","./index-k-x69QfE.js","./index-roID5kc2.js","./morematerial-QfHZr2Dl.js","./grid-aKCJR2-u.js","./index-EYoMjYy0.js","./checkprocessviewmodel-tS8tDPuW.js","./usemessage-BSDaXe4E.js","./index-DbmKAz3P.js","./index-boqBdARU.js","./index-dUN4QEi_.js","./hotspotconfigviewmodel-8JYLNcii.js","./index-pz0EIdNc.js","./index-oAR9KX4n.js","./settingviewmodel-IPUaoc4k.js","./about-4Rdeb4vP.js","./index-A54THr5o.js","./index-K6PsDQ08.js","./index-vRYiIf5g.js","./modifyhotspotpwd-PdWsv42Y.js","./regexhelpr-tVNfJSeD.js","./configwifibyhotspot-6AyvAm6O.js","./xcs-app-xcs-app-mobile-src-page-editor-setting-more-material-dnbs2u9g.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
