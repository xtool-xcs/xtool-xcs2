var xl=Object.defineProperty;var El=(n,t,e)=>t in n?xl(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Z=(n,t,e)=>(El(n,typeof t!="symbol"?t+"":t,e),e),gi=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)};var L=(n,t,e)=>(gi(n,t,"read from private field"),e?e.call(n):t.get(n)),ge=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)},he=(n,t,e,a)=>(gi(n,t,"write to private field"),a?a.call(n,e):t.set(n,e),e);var Ia=(n,t,e)=>(gi(n,t,"access private method"),e);import{watch as Ee,toRaw as ft,defineComponent as G,ref as y,openBlock as g,createElementBlock as T,createVNode as w,normalizeClass as oe,computed as M,toDisplayString as N,normalizeStyle as qe,onMounted as je,onUnmounted as Yt,createBaseVNode as b,unref as v,Fragment as Se,createSlots as ao,withCtx as B,renderList as Pe,createBlock as j,withDirectives as Oe,vShow as Fe,createTextVNode as mt,resolveDirective as ri,renderSlot as aa,createCommentVNode as le,resolveDynamicComponent as it,shallowRef as nn,toRefs as hn,reactive as gt,h as Il,getCurrentInstance as Xi,nextTick as Qe,isRef as qi,pushScopeId as Qi,popScopeId as Zi,readonly as io,withModifiers as rt,mergeProps as mn,watchEffect as Wa,Transition as Ji,Teleport as an,onBeforeUnmount as es,markRaw as kl,useAttrs as Al,normalizeProps as Tl,guardReactiveProps as Ol}from"./importmap-vue-u6Q_1Jji.js";import{BaseViewModel as fn,fontInterface as Wn,appFontManager as gn,isEmpty as St,mCanvasManager as E,canvasInterface as Qt,BitMaskOpt as on,EDIT_MODE as Dl,clone as Pl,toFixedNumber as ln,CnvEleQuickOpEvent as Qn,CnvEleInsertEvent as ia,CnvEleBitMaskOptEvent as Ml,CnvBatchCreateEvent as Bl,FinishBatchCreateEvent as Ll,CnvParamsTestEvent as zl,OutlineEventEvent as so,ClearOutlineEvent as $a,SelectAllEvent as Rl,VisibleEvent as $l,ResetInsertEvent as oo,SmartFillEvent as Fl,FinishCurModeEvent as Nl,ExtractEvent as Hl,CodeFillEvent as Vl,GraffitiEvent as Bi,SwitchMultiSelectModeEvent as Ul,UpDateAttributesEvent as Ya,InsertType as zn,QuickOp as _t,sensorsTrack as $,ButtonNames as q,EventNames as F,ParamsTestType as fs,BATCH_CREATE_TYPE as Wl,useProjectDataStore as xn,getOutlinePath as Yl,WorkerManager as Li,isArray as Gl,ALIGN_TYPE as $e,CHANGE_LAYER_TYPE as ka,DEFAULT_LAYER_COLOR as jl,sortBy as zi,IMAGE_PROCESS_TOOL as yt,UNDO_HISTORY_EVENT as gs,CANVAS_EVENT as Kl,loadImg as Xl,DEFAULT_ELEMENT_LINE_STYLE as bs,HANDLE_MODE as ql,xcsApp as ce,uniq as zt,userFontStore as bi,DISPLAY_TYPE as _s,isNumber as lo,isString as Ql,isUndefined as ts,isNull as Zl,useViewModel as R,MCanvasViewModel as Ze,observeState as ie,SetCanvasZoomEvent as Jl,__unplugin_components_0 as Ce,_export_sfc as ae,useSettingStore as $n,BinderUiRequestEvent as ys,StopCnvRequestEvent as er,useCanvasStore as Dt,CameraLocationViewModel as Gt,CanvasLoadPictureEvent as Ri,MultiProjectViewModel as ns,UndoCnvRequestEvent as tr,RedoCnvRequestEvent as nr,SetIsShowPopToastEvent as bn,useProjectStroe as Ga,XCS_DEFAULT_NAME as ar,RenameCurrentTempXcsEvent as ir,DeleteAllTempXcsFileEvent as sr,HaveOpenProjectEvent as $i,SaveCurrentXcsThenDeleteAllEvent as or,useExtCenterStore as Xe,debounce as as,DEFAULT_LAYER_COLOR_LIST as lr,DEFAULT_COLOR_NAME as ws,DEFAULT_LAYER_NAME as Ss,w as rr,SvgIcon as wt,calcAspectRatioFit as cr,__unplugin_components_1 as ro,__unplugin_components_3 as is,useArrayUnique as Cs,useProcessStore as ja,useSystemBack as Fn,imageData2Image as dr,DEFAULT_IMPORT_DISPLAY_X as ur,DEFAULT_IMPORT_DISPLAY_Y as vr,closeToast as pr,recoverNumber as hr,throttle as mr,observeEffect as tt,ClickActionEvent as Yn,ACTION_ID as Gn,BOOL_OP as Aa,toUnicodeCharArray as fr,storeToRefs as Ka,useDataSource as ci,isEqual as co,map as gr,RefreshCameraLocationStateEvent as xs,CanvasUpdateBgImageEvent as br,DEVICE_PROCESSING_MODE as _r,CommonPanel as yr,ModalCenterColumn as wr,ProductType as at,PROCESS_START_POINT as Sr,CONNECT_TYPE as Cr,appManager as uo,MultiConnectViewModel as xr,openBrowser as vo,CameraTipIKnowEvent as Er,CameraTipNeverRemindEvent as Ir,StickerTipNextEvent as kr,StickerStep1NextEvent as Ar,StickerStep1DismssEvent as Tr,StickerStep2UndoEvent as Or,StickerStep2RedoEvent as Dr,CompleteStickerEvent as Pr,StickerStep2DismssEvent as Mr,useFirmwareUpdateStore as Br,uniqueId as Lr,SwitchToTempXcsEvent as zr,OpenTempXcsEvent as Rr,CreateNewTempXcsEvent as $r,MessageType as Es,CnvOpVecViewModel as Fr,FirmwareUpdateViewModel as Nr,SaveCurrentTempXcsEvent as Is,unSupportMode as ks,externalInterface as As,checkDisplayInfo as Hr,DialogName as Vr}from"./main-f7BGirYr.js";import{lodashExports as Ur}from"../assets/index-FfF0Lcw0.js";import{useI18n as fe}from"./importmap-vue-i18n-LlhaB8iP.js";import{Button as jt,NavBar as ga,SwipeCell as Wr,Popup as ba,Slider as Yr,Cell as po,GridItem as ho,Grid as mo,CellGroup as Kt,Tab as di,Tabs as ui,Switch as fo,Field as go,Popover as bo,ActionSheet as ss,Icon as Gr,FloatingPanel as jr,Empty as Kr,Col as Xr,Row as qr,Image as vi}from"./importmap-vant-Ij4SMMwJ.js";import{EdSettingViewModel as _o,DeleteCanvasEvent as Qr,ReNameCanvasEvent as Zr,SortCanvasEvent as Jr,ChangeCanvasDataEvent as ec,AddCanvasEvent as tc}from"./index-roID5kc2.js";import{ImportFileViewModel as yo,ImportFileEvent as nc}from"./importfileviewmodel-n9UVAPSW.js";import"./griditem.vue_vue_type_style_index_0_scoped_39934db8_lang-w40geAFS.js";import{Grid as ac}from"./grid-aKCJR2-u.js";import"./index-DkoCfqcs.js";import{deviceConfigReady as ic}from"./apconnectconfig-XbZ4D7sa.js";import{WalkBorderViewModel as sc,CheckProcessViewModel as wo,StopWalkBorderEvent as Ts,CheckProcessEvent as Fi,CheckType as un,RequestDeviceStatusEvent as oc,WalkBorderEvent as lc,CheckDeviceLengthEvent as rc}from"./checkprocessviewmodel-tS8tDPuW.js";import{useMessage as Os}from"./usemessage-BSDaXe4E.js";import{useRouter as os}from"./importmap-vue-router-aHGpzyJi.js";var sa=(n=>(n[n.create=0]="create",n[n.break=1]="break",n))(sa||{});class So{constructor(t){this.type=t}}class Co{constructor(t){this.type=t}}class xo{constructor(t){this.type=t}}class Eo{constructor(t){this.type=t}}class Io{constructor(t){this.attr=t}}class ko{constructor(t){this.attr=t}}class Ao{constructor(t,e){this.attr=t,this.needRecord=e}}class To{constructor(t){this.data=t}}var Rt=(n=>(n[n.none=0]="none",n[n.base=1]="base",n[n.editor=2]="editor",n[n.trace=3]="trace",n))(Rt||{});class Oo{constructor(t){this.type=t}}class Do{constructor(t){this.element=t}}class cc{constructor(t,e){this.type=t,this.save=e}}class pi{constructor(t,e){this.type=t,this.attr=e}}class dc{constructor(t){this.save=t}}class Ni{constructor(t){this.save=t}}class uc{constructor(t){this.attr=t}}class Po{constructor(){}}var Xa=(n=>(n[n.undo=0]="undo",n[n.redo=1]="redo",n))(Xa||{});class Hi{constructor(t){this.type=t}}var Ve=(n=>(n.text="text",n.fontSize="fontSize",n.letterSpacing="letterSpacing",n.leading="leading",n.align="align",n.fontSubfamily="fontSubfamily",n.textWeld="textWeld",n))(Ve||{});class Ut{constructor(t,e){this.type=t,this.value=e}static createTextEvent(t,e){if(Ve[t])return new Ut(Ve[t],e);throw new Error("id is not a TextStyleType")}}class Vi{constructor(t){this.font=t}}class vc{}class ls extends fn{initWatch(){super.initWatch(),Ee(()=>[Wn.textAttrs(),Wn.langKey()],()=>{const t=this.fontFamilyItem();this.updateGroup(),this.updateState({subFontFamily:t})},{immediate:!0})}createState(){return{fonts:gn.fonts,system:void 0,buildIn:void 0,subFontFamily:[]}}setEventHandler(){this.registerEventHandler(vc,this.initFont)}onMounted(){super.onMounted(),gn.fonts?this.updateGroup():this.initFont().then(()=>{this.updateGroup()})}fontFamilyItem(){var s,o;const{fontSource:t,fontFamily:e}=Wn.textAttrs();if(St(t)||St(e))return[];const a=(o=(s=ft(this.uiState.fonts))==null?void 0:s[t].fonts)==null?void 0:o[e],i=gn.langKeyToFontLocaleKey(Wn.langKey());return a?gn.toFontSubfamilyOpts(a.subFontFamilys,{locale:i}):[]}async initFont(){const t=await gn.getGroupedFontList();this.updateState({fonts:t}),this.sendEffect({fontInitFinish:{value:!0}})}updateGroup(){const{buildIn:t,system:e}=gn.fontList(Wn.langKey()),a=this.fontFamilyItem();this.updateState({buildIn:t,system:e,subFontFamily:a})}}const Ds=4;class ct extends fn{constructor(){super(...arguments);Z(this,"insertPosition")}createState(){return{importing:!1,selectedNum:0,hasClipboardData:E.clipboardData!==void 0,onBatchCreate:!1,onBatchPreview:!1,enableEditor:!1,unitData:Qt.unit(),extractIng:!1,isMultiSelectMode:!1,bitmapMaskType:on.none,filterLoading:!1,onExtract:!1,onSmartFill:!1,onCodeFill:!1,onRotate:!1,selectedIds:[],selectAttrs:{x:0,y:0,width:0,height:0,angle:0,radius:0,fontSize:0,lockRatio:!1,strength:5}}}initWatch(){Ee([()=>E.selectLengthRef.value,()=>E.groupJSONRef.value,()=>E.selectIdsRef.value,()=>E.bitmapMask.value],([e=0,a,i,s])=>{var r,l,d,c;const o=Qt.unit().fractionDigits;if(((r=E.currentCanvas)==null?void 0:r.modeManager.curMode)!==Dl.BITMAP_MASK){let u=on.none;switch(s){case"can-build":u=on.CREATE;break;case"can-modify":u=on.MODIFY;break}this.updateState({bitmapMaskType:u})}this.updateState({enableEditor:e>0,selectedNum:e,selectedIds:Pl(ft(i)),selectAttrs:{x:ln((a==null?void 0:a.x)||0,o),y:ln((a==null?void 0:a.y)||0,o),width:ln((a==null?void 0:a.width)||0,o),height:ln((a==null?void 0:a.height)||0,o),angle:ln((a==null?void 0:a.angle)||0,o),radius:ln((a==null?void 0:a.radius)||0,o),fontSize:ln(Math.min(((l=a==null?void 0:a.style)==null?void 0:l.fontSize)??72,3e3),0),lockRatio:(a==null?void 0:a.lockRatio)||!1,strength:((c=(d=a==null?void 0:a.filterAttrsMap)==null?void 0:d.emboss)==null?void 0:c.strength)??5}})},{immediate:!0}),Ee(()=>Qt.unit(),e=>{this.updateState({unitData:e})},{immediate:!0}),Ee(()=>E.isMultiSelectModeRef.value,e=>{this.updateState({isMultiSelectMode:e})}),Ee(()=>E.onRotateRef.value,e=>{this.updateState({onRotate:e})})}setEventHandler(){this.registerEventHandler(Qn,this.quickOp),this.registerEventHandler(ia,this.insertEvent),this.registerEventHandler(Ml,this.bitMaskOpt),this.registerEventHandler(Bl,this.batchCreate),this.registerEventHandler(Ll,this.finishBatchCreate),this.registerEventHandler(zl,this.batchParamsTest),this.registerEventHandler(so,this.extractContours),this.registerEventHandler($a,this.clearOutline),this.registerEventHandler(Rl,this.selectAll),this.registerEventHandler($l,this.toggleVisibleState),this.registerEventHandler(oo,this.resetInsertPosition),this.registerEventHandler(Fl,this.smartFill),this.registerEventHandler(Nl,this.finishCurMode),this.registerEventHandler(Hl,this.onEctract),this.registerEventHandler(Vl,this.onCodeFill),this.registerEventHandler(Bi,this.graffitiEvent),this.registerEventHandler(Ul,this.switchMultiSelectModeEvent),this.registerEventHandler(Ya,this.updateSelectedAttributes)}async waitAsync(e=40){return new Promise(a=>{setTimeout(()=>{a()},e)})}async insertEvent(e){var i,s;(i=E.currentCanvas)==null||i.finishCurMode(),this.updateState({importing:!0}),e.data.type===zn.File&&await this.waitAsync();const a=await E.insertElement(e.data,this.insertPosition);e.data.type===zn.Shape&&a&&(this.insertPosition={x:a[0].x+4,y:a[0].y+4}),e.data.cancelSelect&&((s=E.currentCanvas)==null||s.clearSelected()),this.updateState({importing:!1})}quickOp(e){var a,i,s,o;switch((((a=e.options)==null?void 0:a.saveSubMode)??!1)||(i=E.currentCanvas)==null||i.finishCurMode(),e.type){case _t.COPY:{$(F.buttonClick,{elementId:q.copy}),E.copy(!0)&&this.updateState({hasClipboardData:!0});break}case _t.PASTE:E.paste(e.options);break;case _t.CUT:{$(F.buttonClick,{elementId:q.cut}),E.copy(!0)&&this.updateState({hasClipboardData:!0}),E.deleteSelectedElement();break}case _t.COPY_PASTE:{this.updateState({importing:!0});const r=E.copy(!1);r==null||r.forEach(l=>{l.x+=Ds,l.y+=Ds}),E.pasteToCanvas({data:r,canvasId:E.currentId,projectId:Qt.getCurrentXcsTempId(),groupTags:(s=E.currentCanvas)==null?void 0:s.getSelectedGroupTags(),pasteGroupMap:(o=E.currentCanvas)==null?void 0:o.getPasteGroupMap()},!0),this.updateState({importing:!1});break}case _t.DELETE:$(F.buttonClick,{elementId:q.delete}),E.deleteSelectedElement();break;case _t.CLIP_MASK:break;case _t.LOCK:$(F.buttonClick,{elementId:q.lockUnlock}),E.lockElement();break}}bitMaskOpt(e){e.type===on.CREATE?$(F.buttonClick,{elementId:q.createMask}):e.type===on.RELEASE?$(F.buttonClick,{elementId:q.releaseMask}):e.type===on.MODIFY&&$(F.maskAdjust,{}),E.isMultiSelectMode=!1,E.bitMaskOpt(e.type)}batchCreate(e){var a;E.isMultiSelectMode=!1,this.updateState({onBatchCreate:!0,onBatchPreview:!0}),(a=E.currentCanvas)==null||a.batchCreateOnTemp(e.type,e.params),this.updateState({onBatchCreate:!1})}finishBatchCreate(e){var a;this.updateState({onBatchPreview:!1}),(a=E.currentCanvas)==null||a.finishBatchCreate(!e.save,!0)}batchParamsTest(e){var a;switch(E.isMultiSelectMode=!1,e.type){case fs.preview:this.batchParamsTestPreview(e);break;case fs.finish:this.batchParamsTestFinish(e);break;default:(a=E.currentCanvas)==null||a.finishBatchCreate(!0),this.updateState({onBatchCreate:!1,onBatchPreview:!1});break}}batchParamsTestPreview(e){var a;E.isMultiSelectMode=!1,this.updateState({onBatchCreate:!0}),(a=E.currentCanvas)==null||a.batchCreateOnTemp(Wl.LINER,e.params),this.updateState({onBatchCreate:!1,onBatchPreview:!0})}batchParamsTestFinish(e){var u;E.isMultiSelectMode=!1,this.updateState({onBatchCreate:!0});const a=((u=E.currentCanvas)==null?void 0:u.finishBatchCreate(!1,!0))||{matrixResult:[],descriptionResult:[]},{matrixResult:i,descriptionResult:s}=a,o=e.params.xCoordinate,r=e.params.yCoordinate,l={value:o==null?void 0:o.label,key:this.columnKye()},d={value:r==null?void 0:r.label,key:this.rowKye()},c={matrixResult:i,descriptionResult:s,xCoordinate:l,yCoordinate:d};xn().updateParamTest({...c}),console.log(c),this.updateState({onBatchCreate:!1,onBatchPreview:!1})}columnKye(){const e=xn().currentMode;let a="power";return["KNIFE_CUT","PRINTER_KNIFE_CUT","PASSIVE_KNIFE_CUT","ACTIVE_KNIFE_CUT","PRESS_PRINT","DISC_PRESS_CUT"].includes(e)&&(a="cutPressure"),["BRUSH_PAINTING"].includes(e)&&(a="brushPressure"),a}rowKye(){const e=Qt.getProcessingType(),a=Qt.getExtId();let i="speed";return["F1","F1Ultra"].includes(a)&&e==="BITMAP_ENGRAVING"&&(i="dotDuration"),i}async updateSelectedAttributes(e){var i;const a=E.selectIds;(e.attr.filterList||e.showLoading)&&this.updateState({filterLoading:!0}),St(a)||(i=E.currentCanvas)==null||i.updateSelectedAttributes(e.attr,a),setTimeout(()=>{this.updateState({filterLoading:!1})},300)}async extractContours(e){var o,r;this.updateState({extractIng:!0});const a=((o=e.attr)==null?void 0:o.offset)??2,i=await E.currentCanvas.getSelectedOutlineEleInfo(a),s=await Yl(i,a,e.attr);(r=E.currentCanvas)==null||r.drawOutline(s),this.updateState({extractIng:!1})}async clearOutline(e){var a;e.clear&&(Li.destroyClipperHelper(),Li.destroyOutlineHelper()),(a=E.currentCanvas)==null||a.clearOutline(e.clear)}switchMultiSelectModeEvent(e){e.isCancel?E.isMultiSelectMode=!1:E.isMultiSelectMode=!this.uiState.isMultiSelectMode}selectAll(){var e;$(F.buttonClick,{elementId:q.selectAll}),(e=E.currentCanvas)==null||e.selectAll()}toggleVisibleState(e){var a,i;$(F.buttonClick,{elementId:q.showHide}),e.all?(a=E.currentCanvas)==null||a.showInvisible():(i=E.currentCanvas)==null||i.toggleVisibleState()}resetInsertPosition(){this.insertPosition=void 0}async smartFill(){this.updateState({onSmartFill:!0});const e=await E.smartFill();this.sendEffect({afterSmartFill:{value:Gl(e)&&e.length>0}}),this.updateState({onSmartFill:!1})}finishCurMode(){var e;(e=E.currentCanvas)==null||e.finishCurMode(),this.uiState.isMultiSelectMode&&(E.isMultiSelectMode=!1)}onEctract(e){this.updateState({onExtract:e.onExtract})}onCodeFill(e){this.updateState({onCodeFill:e.onCodeFill})}graffitiEvent(e){E.setOnGraffiti(e.onGraffiti)}}class _a extends fn{createState(){return{enableAlign:!1,enableDistribute:!1,enableArrange:!1,x:null,y:null,width:null,height:null,angle:null,lockRatio:!1}}setEventHandler(){this.registerEventHandler(xo,this.alignment),this.registerEventHandler(Eo,this.level),this.registerEventHandler(Ao,this.attributes),this.registerEventHandler(Io,this.attributes),this.registerEventHandler(ko,this.attributes),this.registerEventHandler(To,this.flip)}initWatch(){Ee([()=>E.selectLengthRef.value,()=>E.groupJSONRef.value],([t,e])=>{this.updateState({enableAlign:t>1,enableDistribute:t>2,enableArrange:t>0,x:(e==null?void 0:e.x)??null,y:(e==null?void 0:e.y)??null,width:(e==null?void 0:e.width)??null,height:(e==null?void 0:e.height)??null,angle:(e==null?void 0:e.rotate)??null,lockRatio:(e==null?void 0:e.lockRatio)??!1})},{immediate:!0})}alignment(t){var a;switch(t.type){case $e.LEFT:$(F.buttonClick,{elementId:q.leftAlignment,source:"rightPanel"});break;case $e.RIGHT:$(F.buttonClick,{elementId:q.rightAlignment,source:"rightPanel"});break;case $e.TOP:$(F.buttonClick,{elementId:q.topAlignment,source:"rightPanel"});break;case $e.BOTTOM:$(F.buttonClick,{elementId:q.bottomAlignment,source:"rightPanel"});break;case $e.HORIZONTAL_CENTER:$(F.buttonClick,{elementId:q.verticalCenter,source:"rightPanel"});break;case $e.VERTICAL_CENTER:$(F.buttonClick,{elementId:q.horizonCenter,source:"rightPanel"});break;case $e.HORIZONTAL_DISTRIBUTE:$(F.buttonClick,{elementId:q.horizonDistribution,source:"rightPanel"});break;case $e.VERTICAL_DISTRIBUTE:$(F.buttonClick,{elementId:q.verticalDistribution,source:"rightPanel"});break}const e=[$e.HORIZONTAL_DISTRIBUTE,$e.VERTICAL_DISTRIBUTE].includes(t.type)?3:2;E.eleNumsLegal(e)&&((a=E.currentCanvas)==null||a.align(t.type))}level(t){var e;switch(console.log("level-该功能新版本有调整，待实现",t),E.eleNumsLegal(1)&&((e=E.currentCanvas)==null||e.changeSelectedLayer(t.type)),t.type){case ka.UP:$(F.buttonClick,{elementId:q.upperFloor,source:"rightPanel"});break;case ka.DOWN:$(F.buttonClick,{elementId:q.nextFloor,source:"rightPanel"});break;case ka.TOP:$(F.buttonClick,{elementId:q.topLevel,source:"rightPanel"});break;case ka.END:$(F.buttonClick,{elementId:q.underFloor,source:"rightPanel"});break}}attributes(t){var a;const e={};for(const i in t.attr)e[i]=t.attr[i];!St(e)&&E.eleNumsLegal(1)&&((a=E.currentCanvas)==null||a.updateSelectedAttributes(e,null,{needRecord:t.needRecord??!0}))}flip(t){var e;t.data.flipX&&$(F.buttonClick,{elementId:q.horizonFlip,source:"rightPanel"}),t.data.flipY&&$(F.buttonClick,{elementId:q.verticalFlip,source:"rightPanel"}),E.eleNumsLegal(1)&&((e=E.currentCanvas)==null||e.flipSelected({flipX:t.data.flipX??!1,flipY:t.data.flipY??!1}))}}class pc extends fn{createState(){return{isGroup:!1,enableCombine:!1,isBoolOperate:!1,selectNum:0,enableGroup:!1,enableUnGroup:!1}}initWatch(){Ee([()=>E.isGroupRef.value,()=>E.enableCombineRef.value,()=>E.selectLengthRef.value,()=>E.isBoolOperateRef.value],([t,e,a,i])=>{this.updateState({isGroup:t,enableCombine:e&&!i,selectNum:a,isBoolOperate:i,enableGroup:a>=2,enableUnGroup:t})},{immediate:!0})}setEventHandler(){this.registerEventHandler(So,this.group),this.registerEventHandler(Co,this.combine)}group(t){var e,a;switch(t.type){case sa.break:this.uiState.isGroup&&($(F.buttonClick,{elementId:q.unGroup,source:"rightPanel"}),(e=E.currentCanvas)==null||e.breakGroup());break;case sa.create:if(this.uiState.selectNum>=2){$(F.buttonClick,{elementId:q.group,source:"rightPanel"}),(a=E.currentCanvas)==null||a.createGroup();return}break}}combine(t){$(F.booleanOperation,{type:t.type,result:"success"}),this.uiState.enableCombine&&E.combine(t.type)}}class Mo{constructor(t){this.color=t}}var Tt=(n=>(n.update="update",n.delete="delete",n.hideShow="hideOrShow",n.change="change",n.rename="rename",n))(Tt||{});class oa{constructor(t,e,a,i){this.type=t,this.layerData=e,this.name=a,this.location=i}}class Bo{constructor(t,e){this.key=t,this.order=e}}class rs extends fn{createState(){return{}}setEventHandler(){this.registerEventHandler(Mo,this.moveLayer),this.registerEventHandler(oa,this.editor),this.registerEventHandler(Bo,this.orderLayer)}editor(t){var i,s,o,r;const e=t.layerData.key,a=E.currentLayerChildKeys(e);switch(t.type){case Tt.change:$(F.layerAction,{mode:"layer",location:t.location??"mobile",type:"choose",x:E.bridgeTreeData.length});const l=String(t.layerData.key);E.updateLayerData({currentLayer:l,needRecord:!1});const d=E.getCanvasDataLayerDataById(E.currentId);E.getCanvasDataById().currentLayer=l||jl,(i=E.currentCanvas)==null||i.updateDisplayConfig({layerColor:l,layerTag:l,visible:!0,layerData:d,updateCanvasDisplay:!1}),(s=E.currentCanvas)==null||s.selectSpecDisplays(a);break;case Tt.delete:$(F.layerAction,{mode:"layer",location:"layer",type:"delete",x:E.bridgeTreeData.length}),(o=E.currentCanvas)==null||o.removeElements(a,!0,!0);break;case Tt.hideShow:(r=E.currentCanvas)==null||r.updateDisplayObjectsAttributes({visible:!t.layerData.visible},{displayObjectsQuery:a,displaysAsGroup:!1});break;case Tt.update:break;case Tt.rename:$(F.layerAction,{mode:"layer",location:"layer",type:"rename",x:E.bridgeTreeData.length});const c=t.name.replace(`
`,"");!St(c)&&t.layerData.label!==t.name&&E.renameLayer(t.layerData.key,c);break}}moveLayer(t){$(F.layerAction,{mode:"layer",location:"rightClick",type:"move",x:E.bridgeTreeData.length}),E.moveEleToLayer(t.color)}orderLayer(t){$(F.layerAction,{mode:"layer",location:"layer",type:"move",x:E.bridgeTreeData.length});const e=E.orderLayer(E.bridgeTreeData,t.key,t.order);E.bridgeTreeData=zi(e,"order").reverse()}}class Nn extends fn{constructor(){super(...arguments);Z(this,"lastActiveTool",yt.MAGIC_WAND)}createState(){return{imageProcessType:Rt.none,onEditor:!1,imageAdjust:!1,imageEditor:!1,imageTrace:!1,aberration:40,eraserSize:40,active:yt.MAGIC_WAND,inTracing:!1,enableUndo:!1,enableRedo:!1,aberrationThreshold:180,turdsize:80,alphamax:1,layeredByColor:!0,tracingResult:!1,originToolScale:1,toolScale:1,onInsertTrace:!1}}setEventHandler(){this.registerEventHandler(Oo,this.enter),this.registerEventHandler(Do,this.bind),this.registerEventHandler(cc,this.release),this.registerEventHandler(pi,this.change),this.registerEventHandler(dc,this.finishCut),this.registerEventHandler(Ni,this.finishEditor),this.registerEventHandler(Hi,this.changeHistory),this.registerEventHandler(uc,this.traceOptsUpdate),this.registerEventHandler(Po,this.resizeToolCanvas)}traceOptsUpdate(e){for(const a in e.attr)switch(a){case"aberrationThreshold":e.attr[a]=this.checkNumber(e.attr[a],0,255);break;case"turdsize":e.attr[a]=this.checkNumber(e.attr[a],0,100);break;case"alphamax":e.attr[a]=this.checkNumber(e.attr[a],0,1);break}this.updateState(e.attr),this.tracing()}bind(e){var a,i,s;E.toolCanvas.removeListener(gs.CAN_DO_CHANGE),E.toolCanvas.on(gs.CAN_DO_CHANGE,(o,r)=>{this.updateState({enableUndo:o,enableRedo:r})}).on(Kl.ZOOMED,o=>{this.updateState({toolScale:o})}),(a=E.toolCanvas)==null||a.start(),e.element.appendChild(E.toolCanvas.view),(i=E.toolCanvas)==null||i.resizeCanvasTo(e.element),(s=E.toolCanvas)==null||s.render(),this.updateState({originToolScale:E.toolCanvas.viewport.scale.x,toolScale:E.toolCanvas.viewport.scale.x})}async enter(e){var a,i,s,o,r,l;switch(this.updateState({onEditor:!0,imageProcessType:e.type}),E.setToolCanvasOnBusy(!0),e.type){case Rt.editor:(i=(a=E.currentCanvas)==null?void 0:a.processImageNew)==null||i.call(a,E.toolCanvas),this.updateTools(),this.updateState({imageEditor:!0});break;case Rt.trace:this.updateState({imageTrace:!0});const d=(s=E.currentCanvas)==null?void 0:s.exportSelectedJSON({texture:!0}),c=(o=E.currentCanvas)==null?void 0:o.getDisplaysBounds("selected"),u=d[0];if(!u)return;await Xl(u.base64),E.toolCanvas.importDisplayJSON(d),(l=(r=E.toolCanvas).updateViewportConfig)==null||l.call(r,{worldWidth:c.maxX-c.minX,worldHeight:c.maxY-c.minY,gridVisible:!1,backdropVisible:!1}),E.toolCanvas.setImageTracingMode(!0),this.tracing();break;default:this.updateState({onEditor:!1,imageAdjust:!1,imageEditor:!1,imageTrace:!1});break}}release(e){var a,i;switch(e.type){case Rt.editor:e.save?(a=E.toolCanvas)==null||a.saveImageProcess(!0,{autoDestroyOriginal:!0}):(i=E.toolCanvas)==null||i.closeImageProcess(),E.setToolCanvasOnBusy(!1),this.updateState({imageEditor:!1});break;case Rt.trace:this.updateState({imageTrace:!1});break}}change(e){var a,i;(e.type!==this.uiState.active||e.attr)&&this.updateTools(e.type,{aberration:((a=e.attr)==null?void 0:a.aberration)??this.uiState.aberration,eraserSize:((i=e.attr)==null?void 0:i.size)??this.uiState.eraserSize})}finishCut(e){var a,i;e.save?(a=E.toolCanvas)==null||a.confirmImageProcessTool():(i=E.toolCanvas)==null||i.cancelImageProcessTool(),this.updateTools(this.lastActiveTool,{aberration:this.uiState.aberration,eraserSize:this.uiState.eraserSize})}updateTools(e=yt.MAGIC_WAND,a={aberration:40,eraserSize:40}){var i;e===yt.CUTTER?bs.color=37768:bs.color=0,(i=E.toolCanvas)==null||i.updateImageProcessTool(e,{aberration:a.aberration,size:a.eraserSize}),e!==yt.CUTTER&&(this.lastActiveTool=e),this.updateState({active:e,aberration:a.aberration,eraserSize:a.eraserSize})}finishEditor(e){var i;let a=!0;this.uiState.imageProcessType===Rt.editor?(this.finishImageProcess(e),E.setToolCanvasOnBusy(!1),setTimeout(()=>{var s;(s=E.currentCanvas)==null||s.updateTransformHandleMode(ql.custom)},200)):this.uiState.imageProcessType===Rt.trace&&(this.uiState.imageTrace?(a=!1,E.terminateImageTracing()):e.save?(this.updateState({onInsertTrace:!0}),(i=E.saveImageTracing())==null||i.finally(()=>{E.setToolCanvasOnBusy(!1),this.updateState({onInsertTrace:!1})})):(E.cancelImageTracing(),E.setToolCanvasOnBusy(!1))),this.updateState({onEditor:!a,imageAdjust:!1,imageEditor:!1,imageTrace:!1,enableRedo:!1,enableUndo:!1,aberration:40,eraserSize:40,active:yt.MAGIC_WAND,aberrationThreshold:180,turdsize:80,alphamax:1,layeredByColor:!0}),this.resizeToolCanvas()}finishImageProcess(e){var a,i;e.save?(a=E.currentCanvas)==null||a.saveImageProcessNew(E.toolCanvas):(i=E.currentCanvas)==null||i.closeImageProcessNew(E.toolCanvas)}tracing(){this.updateState({imageTrace:!0,tracingResult:!1}),E.generatorImageTracing({turdsize:this.uiState.turdsize,alphamax:this.uiState.alphamax,layeredByColor:this.uiState.layeredByColor,aberrationThreshold:this.uiState.aberrationThreshold}).then(e=>{!(e!=null&&e.cancel)&&(e!=null&&e.failToFillSvg||e!=null&&e.hardToFillSvg)?ce.modal.showToast({msg:"editor.image_tracing.fail_to_fill_svg",icon:"error"}):e!=null&&e.cancel||this.updateState({tracingResult:!0}),this.updateState({imageTrace:!1})}).catch(e=>{console.log("-----------图像描摹失败-----------",e),ce.modal.showToast({msg:"editor.image_tracing.fail_to_fill_svg",icon:"error"}),this.updateState({imageTrace:!1,tracingResult:!1})})}changeHistory(e){var a,i;e.type===Xa.undo?(a=E.toolCanvas)==null||a.undo():(i=E.toolCanvas)==null||i.redo()}checkNumber(e,a,i){return e<a?a:e>i?i:e}resizeToolCanvas(){var e;(e=E.toolCanvas)==null||e.setViewportToFit()}}class Hn extends fn{createState(){return{enableText:!1,welding:!1,alignType:[],fontFamily:[],fontSize:[72],fontSubfamily:[],fontSource:[],leading:[0],letterSpacing:[0],fontName:""}}initWatch(){Ee(()=>E.selectJSONRef.value,t=>{const e=zt(t.map(o=>(o==null?void 0:o.type)??"")),a=zt(t.map(o=>{var r;return((r=o==null?void 0:o.style)==null?void 0:r.fontFamily)??""})),i=zt(t.map(o=>{var r;return((r=o==null?void 0:o.style)==null?void 0:r.fontSource)??""}));let s="";a.length===1&&i.length===1&&!St(a[0])&&!St(i[0])&&(s=bi().getFontName({fontFamily:a[0],fontSource:i[0]})??""),this.updateState({enableText:e.length===1&&e[0]===_s.TEXT,alignType:zt(t.map(o=>{var r;return((r=o==null?void 0:o.style)==null?void 0:r.align)??""})),fontFamily:a,fontSize:zt(t.map(o=>{var r,l;return Number((l=(r=o==null?void 0:o.style)==null?void 0:r.fontSize)==null?void 0:l.toFixed(2))??0})),fontSubfamily:zt(t.map(o=>{var r;return((r=o==null?void 0:o.style)==null?void 0:r.fontSubfamily)??""})),fontSource:i,leading:zt(t.map(o=>{var r;return((r=o==null?void 0:o.style)==null?void 0:r.leading)??0})),fontName:s,letterSpacing:zt(t.map(o=>{var r;return((r=o==null?void 0:o.style)==null?void 0:r.letterSpacing)??0}))})},{immediate:!0})}setEventHandler(){this.registerEventHandler(Ut,this.changeStyle),this.registerEventHandler(Vi,this.changeFont)}async changeStyle(t){var e,a;if(this.uiState.enableText){t.type===Ve.align&&(t.value==="left"?$(F.textPositionEdit,{elementId:q.alignment,type:q.leftAlignment}):t.value==="center"?$(F.textPositionEdit,{elementId:q.alignment,type:q.centerAlignment}):t.value==="right"&&$(F.textPositionEdit,{elementId:q.alignment,type:q.rightAlignment})),t.type===Ve.textWeld&&$(F.weldFont,{result:"success"}),t.type===Ve.fontSize&&$(F.textEdit,{elementId:"fontSize",type:t.value}),t.type===Ve.letterSpacing&&$(F.textEdit,{elementId:"wordSpace",type:t.value}),t.type===Ve.leading&&$(F.textEdit,{elementId:"lineSpace",type:t.value});let i;t.type!==Ve.align?i="selected":i=E.selectJSON.filter(l=>l.type===_s.TEXT).reduce((l,d)=>(d.style.curveY!==0&&l.push(d.id),l),[]),lo(t.value)?Number(t.value.toFixed(2)):t.value;const s={style:{[t.type]:t.value},textsFixupAnchor:i};switch(t.type){case Ve.fontSubfamily:const o=E.selectJSON[0].style.fontFamily,r=E.selectJSON[0].style.fontSource;await this.changeFont(new Vi({fontFamily:o,fontSource:r}),t.value);break;case Ve.textWeld:this.updateState({welding:!0}),await E.textWeld(),this.updateState({welding:!0});break;case Ve.text:const l=E.groupJSON;l.text=t.value,await this.loadText(l),(e=E.currentCanvas)==null||e.updateSelectedAttributes({text:t.value},E.selectIds);break;default:(a=E.currentCanvas)==null||a.updateSelectedAttributes(s,E.selectIds);break}}}async changeFont(t,e){var i,s;e?$(F.textEdit,{elementId:"fontStyle",type:e}):$(F.textEdit,{elementId:"font",type:t.font});const a=E.groupJSON;if(!St(a)){const o=this.fromFontFamilyOptValue(t.font),r={style:o},l=e??Qt.adjustSubfamilyForFamilyChanges(o,((i=a==null?void 0:a.style)==null?void 0:i.fontSubfamily)??"");if(Object.assign(r.style,{fontSubfamily:l}),a.style)Object.assign(a.style,r.style),await this.loadText(a);else{const d=E.selectJSON.map(c=>c.text);await bi().preloadTextWithText(d,r.style)}(s=E.currentCanvas)==null||s.updateSelectedAttributes(r,E.selectIds)}}async loadText(t){await bi().preloadTextGlyphs(t)}fromFontFamilyOptValue(t){if(!Ql(t))return t;let e={fontFamily:"",fontSource:""};try{t&&(e=JSON.parse(t))}catch{}return e}}const hc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAABGCAYAAABWgGNsAAAGs0lEQVR4nO1c7VXbShC9s4LkmY9nbQemgudUEKggUEFIBZAKgAoeVACpIHSAU0GcCqIO1gYTc0I0835INjaWrK9dST/ePYcfHEure+7Ozs7O7C7wP5yAbDRiptMe/qAHCXsLTY9AagTyRnrnzdDGd2xilXPMdwOB7nSCqu2XEtYY8aEej4nUBwj3AfJzvDYkwpAh3xBu32pNozLfLgtjxMfGU18JfxSRw0zORAMiDFnkG8KtQVG+hYQ1Ztojj/+F4LDIe4kfJtxwqC60rm4d62CM+Grj6UQ4PM1pAIkgwg2T+qJ3O4Ncz+cnNz0TltOyxFIJOBR4PPl1IiGfVxE0AYHw5pHW691bprDGTPqk6CuAXtazFTAS0IXubl3aaCwaWXINkX0b7SUhMojfn7XWiS5irbD3k+lHDsNLyz2eClLqvLvbuajShjHTHim+g1tDmCEQVgdJoy1V2EhUvnHLaxVVxK1Z1BkSxU0UNh7+3+vhtYoy4jYk6gwr4q4I2zDBOWKiuWZgABiNH3+iSc5EA//vrYPZv+r178rjMzQsKgCQ4mtjTC7fPn54bJ6zyL4Z/5pHTUsWax4e9onVXf2skiHAhe5un697Jh5hP+vilIGR8O89rfVoyWJJ6KwpRkkg4CTLauMR1hb4UG9OgQVXYMykDyFncV9J+FBvj9N+NMb4YmEVaBMEnAALwiqPTpqjkw4ifEj90ds8BFBLjF0AvjHT/bmwIug3ySYVIvtp7kCB3tdNJxdUeKiAaEgBLRUWmFnmCtpqDAR6H1nsxkYrCc6g4KVZZlt59yNhRdrmp5YgwisC5o1xm0LsY1WrSSIx+P+r1ZxXVl4thW/M9JW4T7VWIIoiEjZE62pSq/CWLDQtD9oWxBb77LQ8Ygdh0tBvLW8FzHu/tSQj8KqwRK0daS8LBMi3JolkwluNXETCH01QyYOXyYuQO/fZCMKE8jO3l/OLsOHzLYAWTwhqhZvWuwO0lPNcWK31SCBfmiRTBgK+appDApbzsWDPSvnZEZInV/5zibZZLdFwSVitO0FLLQBpCwKt9UhYKpXMbUOEfyQUE41P6u13QBqvey1g5He39doH7id3bUnUC+NoZUkbWQAfoU3DK0e8KqH3CaCWxOJqmJgr0HpnKBx+qptOGkRknPWM1p1AmA5aIO5Q606QmoTR+u9bYXnXAqIAKFe82gZxZwuttdmtyHJbYAWcf+mqdSfwu1t7jU3C7N0COdKGc6IsDfqwp8I5Ad3dPRVWe/XG5hTMdu/kzsdqvXMzF5ikzqXksGyKUOtOoLs7x7HAV64NgxZ0KX0GwRjxgUkfoL7y6B+B9CBkvSgpkCvd3bG24TlKmD/3SXnXsFw6X9xvZuVwxwwuYmBhHGm9fWurvRnMeHJDoI/2WqTA727tzf6zWpqJYmDbYdpvN27HcjZPmJdWf9ZrXlrvDqz5YKKBsxJM6FnusOX2nBQTJbSzdpeQnc3o8SZhK51GhJvXO7qdCGsvT2rbqlZgRVgO1YohOSt/V44fiQauz4CBpPoJxARrBVzuKyCuZG0u3YBNJFkr4FLYcLNKBXUEPFsPsWwjzVoBh8JWmRyIcFvLhgypdn4tzVoB91uMSomzjrBllF7IrLNWANgo23BOFBe2jkkL892KJS2WAg5pbee7tViSwsJKBmFrqLAnWJivsjrfrcUW9mEvaTfnYCopLAVab2dWs1372EI+7PV62yWIVKnzC1HiPxuufWwBi6VA6+36DkWXOHIvLJkuYAZnFmvMpNBQE6baipfm4WEfhScuCoD1pyQX4c4VePkT3nHoUltVQokqnIcVpoMi98I4E7bIGawa41YAgAgKuQFhLny1irskTE7yZUhXgbmfHKPIpEo00Ho3twuYv1b0hTzIfyJ7uZxRB4rda0BB5AKKd7wbi1VhroPDeUMXW4gnrdzWKsxHZUeTE2EJ2Qee63YBQLFrA4Tls9Y7pTN01oXNZxU0LOO3qsDcT47z7kaMOn2n0l5h68JmhzIUCNOR7e9mIa+1RqJW73TL+wqyJy1heVdliJXB+OHxTBiZYgnLF613Ui+eKAKrFpt1jYiwfKpbVGOmvTxXB9oUFbAorDHTnghSicV+q/4L0jy5zrrpLsoB2BMVsO5jkzedRTNsvZMVEF8blZFsiTvc/mWYNhuLfKzcLezdGsVhS+2WGu0je2PWPOKUm/WVVzyBfQXIjwLsen3qMpeHc1Iqwe/TUJhKB/+NwRjjR9s8m4cZT25G40eZ/RkzuayDm5NcQZtgjPHJ2/wKKEjIlVZTRfAf2HoPqoMJ5S8AAAAASUVORK5CYII=";let Ui={};function _i(n={}){Ui={animate:!0,allowClose:!0,overlayOpacity:.7,smoothScroll:!1,disableActiveInteraction:!1,showProgress:!1,stagePadding:10,stageRadius:5,popoverOffset:10,showButtons:["next","previous","close"],disableButtons:[],overlayColor:"#000",...n}}function Y(n){return n?Ui[n]:Ui}function Ta(n,t,e,a){return(n/=a/2)<1?e/2*n*n+t:-e/2*(--n*(n-2)-1)+t}function Lo(n){const t='a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])';return n.flatMap(e=>{const a=e.matches(t),i=Array.from(e.querySelectorAll(t));return[...a?[e]:[],...i]}).filter(e=>getComputedStyle(e).pointerEvents!=="none"&&gc(e))}function zo(n){if(!n||fc(n))return;const t=Y("smoothScroll");n.scrollIntoView({behavior:!t||mc(n)?"auto":"smooth",inline:"center",block:"center"})}function mc(n){if(!n||!n.parentElement)return;const t=n.parentElement;return t.scrollHeight>t.clientHeight}function fc(n){const t=n.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function gc(n){return!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length)}let qa={};function He(n,t){qa[n]=t}function K(n){return n?qa[n]:qa}function Ps(){qa={}}let Qa={};function Oa(n,t){Qa[n]=t}function pn(n){var t;(t=Qa[n])==null||t.call(Qa)}function bc(){Qa={}}function _c(n,t,e,a){let i=K("__activeStagePosition");const s=i||e.getBoundingClientRect(),o=a.getBoundingClientRect(),r=Ta(n,s.x,o.x-s.x,t),l=Ta(n,s.y,o.y-s.y,t),d=Ta(n,s.width,o.width-s.width,t),c=Ta(n,s.height,o.height-s.height,t);i={x:r,y:l,width:d,height:c},$o(i),He("__activeStagePosition",i)}function Ro(n){if(!n)return;const t=n.getBoundingClientRect(),e={x:t.x,y:t.y,width:t.width,height:t.height};He("__activeStagePosition",e),$o(e)}function yc(){const n=K("__activeStagePosition"),t=K("__overlaySvg");if(!n)return;if(!t){console.warn("No stage svg found.");return}const e=window.innerWidth,a=window.innerHeight;t.setAttribute("viewBox",`0 0 ${e} ${a}`)}function wc(n){const t=Sc(n);document.body.appendChild(t),Ho(t,e=>{e.target.tagName==="path"&&pn("overlayClick")}),He("__overlaySvg",t)}function $o(n){const t=K("__overlaySvg");if(!t){wc(n);return}const e=t.firstElementChild;if((e==null?void 0:e.tagName)!=="path")throw new Error("no path element found in stage svg");e.setAttribute("d",Fo(n))}function Sc(n){const t=window.innerWidth,e=window.innerHeight,a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.classList.add("driver-overlay","driver-overlay-animated"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a.setAttribute("xmlSpace","preserve"),a.setAttribute("xmlnsXlink","http://www.w3.org/1999/xlink"),a.setAttribute("version","1.1"),a.setAttribute("preserveAspectRatio","xMinYMin slice"),a.style.fillRule="evenodd",a.style.clipRule="evenodd",a.style.strokeLinejoin="round",a.style.strokeMiterlimit="2",a.style.zIndex="10000",a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%";const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",Fo(n)),i.style.fill=Y("overlayColor")||"rgb(0,0,0)",i.style.opacity=`${Y("overlayOpacity")}`,i.style.pointerEvents="auto",i.style.cursor="auto",a.appendChild(i),a}function Fo(n){const t=window.innerWidth,e=window.innerHeight,a=Y("stagePadding")||0,i=Y("stageRadius")||0,s=n.width+a*2,o=n.height+a*2,r=Math.min(i,s/2,o/2),l=Math.floor(Math.max(r,0)),d=n.x-a+l,c=n.y-a,u=s-l*2,h=o-l*2;return`M${t},0L0,0L0,${e}L${t},${e}L${t},0Z
    M${d},${c} h${u} a${l},${l} 0 0 1 ${l},${l} v${h} a${l},${l} 0 0 1 -${l},${l} h-${u} a${l},${l} 0 0 1 -${l},-${l} v-${h} a${l},${l} 0 0 1 ${l},-${l} z`}function Cc(){const n=K("__overlaySvg");n&&n.remove()}function xc(){const n=document.getElementById("driver-dummy-element");if(n)return n;let t=document.createElement("div");return t.id="driver-dummy-element",t.style.width="0",t.style.height="0",t.style.pointerEvents="none",t.style.opacity="0",t.style.position="fixed",t.style.top="50%",t.style.left="50%",document.body.appendChild(t),t}function Ms(n){const{element:t}=n;let e=typeof t=="string"?document.querySelector(t):t;e||(e=xc()),Ic(e,n)}function Ec(){const n=K("__activeElement"),t=K("__activeStep");n&&(Ro(n),yc(),Uo(n,t))}function Ic(n,t){const e=Date.now(),a=K("__activeStep"),i=K("__activeElement")||n,s=!i||i===n,o=n.id==="driver-dummy-element",r=i.id==="driver-dummy-element",l=Y("animate"),d=t.onHighlightStarted||Y("onHighlightStarted"),c=(t==null?void 0:t.onHighlighted)||Y("onHighlighted"),u=(a==null?void 0:a.onDeselected)||Y("onDeselected"),h=Y(),p=K();!s&&u&&u(r?void 0:i,a,{config:h,state:p}),d&&d(o?void 0:n,t,{config:h,state:p});const f=!s&&l;let m=!1;Dc(),He("previousStep",a),He("previousElement",i),He("activeStep",t),He("activeElement",n);const _=()=>{if(K("__transitionCallback")!==_)return;const S=Date.now()-e,k=400-S<=400/2;t.popover&&k&&!m&&f&&(Bs(n,t),m=!0),Y("animate")&&S<400?_c(S,400,i,n):(Ro(n),c&&c(o?void 0:n,t,{config:Y(),state:K()}),He("__transitionCallback",void 0),He("__previousStep",a),He("__previousElement",i),He("__activeStep",t),He("__activeElement",n)),window.requestAnimationFrame(_)};He("__transitionCallback",_),window.requestAnimationFrame(_),zo(n),!f&&t.popover&&Bs(n,t),i.classList.remove("driver-active-element","driver-no-interaction"),i.removeAttribute("aria-haspopup"),i.removeAttribute("aria-expanded"),i.removeAttribute("aria-controls"),Y("disableActiveInteraction")&&n.classList.add("driver-no-interaction"),n.classList.add("driver-active-element"),n.setAttribute("aria-haspopup","dialog"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-controls","driver-popover-content")}function kc(){var n;(n=document.getElementById("driver-dummy-element"))==null||n.remove(),document.querySelectorAll(".driver-active-element").forEach(t=>{t.classList.remove("driver-active-element","driver-no-interaction"),t.removeAttribute("aria-haspopup"),t.removeAttribute("aria-expanded"),t.removeAttribute("aria-controls")})}function la(){const n=K("__resizeTimeout");n&&window.cancelAnimationFrame(n),He("__resizeTimeout",window.requestAnimationFrame(Ec))}function Ac(n){var t;if(!K("isInitialized")||!(n.key==="Tab"||n.keyCode===9))return;const e=K("__activeElement"),a=(t=K("popover"))==null?void 0:t.wrapper,i=Lo([...a?[a]:[],...e?[e]:[]]),s=i[0],o=i[i.length-1];if(n.preventDefault(),n.shiftKey){const r=i[i.indexOf(document.activeElement)-1]||o;r==null||r.focus()}else{const r=i[i.indexOf(document.activeElement)+1]||s;r==null||r.focus()}}function No(n){var t;((t=Y("allowKeyboardControl"))==null||t)&&(n.key==="Escape"?pn("escapePress"):n.key==="ArrowRight"?pn("arrowRightPress"):n.key==="ArrowLeft"&&pn("arrowLeftPress"))}function Ho(n,t,e){const a=(i,s)=>{const o=i.target;n.contains(o)&&((!e||e(o))&&(i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation()),s==null||s(i))};document.addEventListener("pointerdown",a,!0),document.addEventListener("mousedown",a,!0),document.addEventListener("pointerup",a,!0),document.addEventListener("mouseup",a,!0),document.addEventListener("click",i=>{a(i,t)},!0)}function Tc(){window.addEventListener("keyup",No,!1),window.addEventListener("keydown",Ac,!1),window.addEventListener("resize",la),window.addEventListener("scroll",la)}function Oc(){window.removeEventListener("keyup",No),window.removeEventListener("resize",la),window.removeEventListener("scroll",la)}function Dc(){const n=K("popover");n&&(n.wrapper.style.display="none")}function Bs(n,t){var e,a;let i=K("popover");i&&document.body.removeChild(i.wrapper),i=Mc(),document.body.appendChild(i.wrapper);const{title:s,description:o,showButtons:r,disableButtons:l,showProgress:d,nextBtnText:c=Y("nextBtnText")||"Next &rarr;",prevBtnText:u=Y("prevBtnText")||"&larr; Previous",progressText:h=Y("progressText")||"{current} of {total}"}=t.popover||{};i.nextButton.innerHTML=c,i.previousButton.innerHTML=u,i.progress.innerHTML=h,s?(i.title.innerHTML=s,i.title.style.display="block"):i.title.style.display="none",o?(i.description.innerHTML=o,i.description.style.display="block"):i.description.style.display="none";const p=r||Y("showButtons"),f=d||Y("showProgress")||!1,m=(p==null?void 0:p.includes("next"))||(p==null?void 0:p.includes("previous"))||f;i.closeButton.style.display=p.includes("close")?"block":"none",m?(i.footer.style.display="flex",i.progress.style.display=f?"block":"none",i.nextButton.style.display=p.includes("next")?"block":"none",i.previousButton.style.display=p.includes("previous")?"block":"none"):i.footer.style.display="none";const _=l||Y("disableButtons")||[];_!=null&&_.includes("next")&&(i.nextButton.disabled=!0,i.nextButton.classList.add("driver-popover-btn-disabled")),_!=null&&_.includes("previous")&&(i.previousButton.disabled=!0,i.previousButton.classList.add("driver-popover-btn-disabled")),_!=null&&_.includes("close")&&(i.closeButton.disabled=!0,i.closeButton.classList.add("driver-popover-btn-disabled"));const S=i.wrapper;S.style.display="block",S.style.left="",S.style.top="",S.style.bottom="",S.style.right="",S.id="driver-popover-content",S.setAttribute("role","dialog"),S.setAttribute("aria-labelledby","driver-popover-title"),S.setAttribute("aria-describedby","driver-popover-description");const k=i.arrow;k.className="driver-popover-arrow";const A=((e=t.popover)==null?void 0:e.popoverClass)||Y("popoverClass")||"";S.className=`driver-popover ${A}`.trim(),Ho(i.wrapper,P=>{var I,D,ee;const W=P.target,U=((I=t.popover)==null?void 0:I.onNextClick)||Y("onNextClick"),V=((D=t.popover)==null?void 0:D.onPrevClick)||Y("onPrevClick"),Q=((ee=t.popover)==null?void 0:ee.onCloseClick)||Y("onCloseClick");if(W.classList.contains("driver-popover-next-btn"))return U?U(n,t,{config:Y(),state:K()}):pn("nextClick");if(W.classList.contains("driver-popover-prev-btn"))return V?V(n,t,{config:Y(),state:K()}):pn("prevClick");if(W.classList.contains("driver-popover-close-btn"))return Q?Q(n,t,{config:Y(),state:K()}):pn("closeClick")},P=>!(i!=null&&i.description.contains(P))&&!(i!=null&&i.title.contains(P))&&typeof P.className=="string"&&P.className.includes("driver-popover")),He("popover",i);const x=((a=t.popover)==null?void 0:a.onPopoverRender)||Y("onPopoverRender");x&&x(i,{config:Y(),state:K()}),Uo(n,t),zo(S);const O=n.classList.contains("driver-dummy-element"),C=Lo([S,...O?[]:[n]]);C.length>0&&C[0].focus()}function Vo(){const n=K("popover");if(!(n!=null&&n.wrapper))return;const t=n.wrapper.getBoundingClientRect(),e=Y("stagePadding")||0,a=Y("popoverOffset")||0;return{width:t.width+e+a,height:t.height+e+a,realWidth:t.width,realHeight:t.height}}function Ls(n,t){const{elementDimensions:e,popoverDimensions:a,popoverPadding:i,popoverArrowDimensions:s}=t;return n==="start"?Math.max(Math.min(e.top-i,window.innerHeight-a.realHeight-s.width),s.width):n==="end"?Math.max(Math.min(e.top-(a==null?void 0:a.realHeight)+e.height+i,window.innerHeight-(a==null?void 0:a.realHeight)-s.width),s.width):n==="center"?Math.max(Math.min(e.top+e.height/2-(a==null?void 0:a.realHeight)/2,window.innerHeight-(a==null?void 0:a.realHeight)-s.width),s.width):0}function zs(n,t){const{elementDimensions:e,popoverDimensions:a,popoverPadding:i,popoverArrowDimensions:s}=t;return n==="start"?Math.max(Math.min(e.left-i,window.innerWidth-a.realWidth-s.width),s.width):n==="end"?Math.max(Math.min(e.left-(a==null?void 0:a.realWidth)+e.width+i,window.innerWidth-(a==null?void 0:a.realWidth)-s.width),s.width):n==="center"?Math.max(Math.min(e.left+e.width/2-(a==null?void 0:a.realWidth)/2,window.innerWidth-(a==null?void 0:a.realWidth)-s.width),s.width):0}function Uo(n,t){const e=K("popover");if(!e)return;const{align:a="start",side:i="left"}=(t==null?void 0:t.popover)||{},s=a,o=n.id==="driver-dummy-element"?"over":i,r=Y("stagePadding")||0,l=Vo(),d=e.arrow.getBoundingClientRect(),c=n.getBoundingClientRect(),u=c.top-l.height;let h=u>=0;const p=window.innerHeight-(c.bottom+l.height);let f=p>=0;const m=c.left-l.width;let _=m>=0;const S=window.innerWidth-(c.right+l.width);let k=S>=0;const A=!h&&!f&&!_&&!k;let x=o;if(o==="top"&&h?k=_=f=!1:o==="bottom"&&f?k=_=h=!1:o==="left"&&_?k=h=f=!1:o==="right"&&k&&(_=h=f=!1),o==="over"){const O=window.innerWidth/2-l.realWidth/2,C=window.innerHeight/2-l.realHeight/2;e.wrapper.style.left=`${O}px`,e.wrapper.style.right="auto",e.wrapper.style.top=`${C}px`,e.wrapper.style.bottom="auto"}else if(A){const O=window.innerWidth/2-(l==null?void 0:l.realWidth)/2,C=10;e.wrapper.style.left=`${O}px`,e.wrapper.style.right="auto",e.wrapper.style.bottom=`${C}px`,e.wrapper.style.top="auto"}else if(_){const O=Math.min(m,window.innerWidth-(l==null?void 0:l.realWidth)-d.width),C=Ls(s,{elementDimensions:c,popoverDimensions:l,popoverPadding:r,popoverArrowDimensions:d});e.wrapper.style.left=`${O}px`,e.wrapper.style.top=`${C}px`,e.wrapper.style.bottom="auto",e.wrapper.style.right="auto",x="left"}else if(k){const O=Math.min(S,window.innerWidth-(l==null?void 0:l.realWidth)-d.width),C=Ls(s,{elementDimensions:c,popoverDimensions:l,popoverPadding:r,popoverArrowDimensions:d});e.wrapper.style.right=`${O}px`,e.wrapper.style.top=`${C}px`,e.wrapper.style.bottom="auto",e.wrapper.style.left="auto",x="right"}else if(h){const O=Math.min(u,window.innerHeight-l.realHeight-d.width);let C=zs(s,{elementDimensions:c,popoverDimensions:l,popoverPadding:r,popoverArrowDimensions:d});e.wrapper.style.top=`${O}px`,e.wrapper.style.left=`${C}px`,e.wrapper.style.bottom="auto",e.wrapper.style.right="auto",x="top"}else if(f){const O=Math.min(p,window.innerHeight-(l==null?void 0:l.realHeight)-d.width);let C=zs(s,{elementDimensions:c,popoverDimensions:l,popoverPadding:r,popoverArrowDimensions:d});e.wrapper.style.left=`${C}px`,e.wrapper.style.bottom=`${O}px`,e.wrapper.style.top="auto",e.wrapper.style.right="auto",x="bottom"}A?e.arrow.classList.add("driver-popover-arrow-none"):Pc(s,x,n)}function Pc(n,t,e){const a=K("popover");if(!a)return;const i=e.getBoundingClientRect(),s=Vo(),o=a.arrow,r=s.width,l=window.innerWidth,d=i.width,c=i.left,u=s.height,h=window.innerHeight,p=i.top,f=i.height;o.className="driver-popover-arrow";let m=t,_=n;t==="top"?(c+d<=0?(m="right",_="end"):c+d-r<=0&&(m="top",_="start"),c>=l?(m="left",_="end"):c+r>=l&&(m="top",_="end")):t==="bottom"?(c+d<=0?(m="right",_="start"):c+d-r<=0&&(m="bottom",_="start"),c>=l?(m="left",_="start"):c+r>=l&&(m="bottom",_="end")):t==="left"?(p+f<=0?(m="bottom",_="end"):p+f-u<=0&&(m="left",_="start"),p>=h?(m="top",_="end"):p+u>=h&&(m="left",_="end")):t==="right"&&(p+f<=0?(m="bottom",_="start"):p+f-u<=0&&(m="right",_="start"),p>=h?(m="top",_="start"):p+u>=h&&(m="right",_="end")),m?(o.classList.add(`driver-popover-arrow-side-${m}`),o.classList.add(`driver-popover-arrow-align-${_}`)):o.classList.add("driver-popover-arrow-none")}function Mc(){const n=document.createElement("div");n.classList.add("driver-popover");const t=document.createElement("div");t.classList.add("driver-popover-arrow");const e=document.createElement("header");e.id="driver-popover-title",e.classList.add("driver-popover-title"),e.style.display="none",e.innerText="Popover Title";const a=document.createElement("div");a.id="driver-popover-description",a.classList.add("driver-popover-description"),a.style.display="none",a.innerText="Popover description is here";const i=document.createElement("button");i.type="button",i.classList.add("driver-popover-close-btn"),i.setAttribute("aria-label","Close"),i.innerHTML="&times;";const s=document.createElement("footer");s.classList.add("driver-popover-footer");const o=document.createElement("span");o.classList.add("driver-popover-progress-text"),o.innerText="";const r=document.createElement("span");r.classList.add("driver-popover-navigation-btns");const l=document.createElement("button");l.type="button",l.classList.add("driver-popover-prev-btn"),l.innerHTML="&larr; Previous";const d=document.createElement("button");return d.type="button",d.classList.add("driver-popover-next-btn"),d.innerHTML="Next &rarr;",r.appendChild(l),r.appendChild(d),s.appendChild(o),s.appendChild(r),n.appendChild(i),n.appendChild(t),n.appendChild(e),n.appendChild(a),n.appendChild(s),{wrapper:n,arrow:t,title:e,description:a,footer:s,previousButton:l,nextButton:d,closeButton:i,footerButtons:r,progress:o}}function Bc(){var n;const t=K("popover");t&&((n=t.wrapper.parentElement)==null||n.removeChild(t.wrapper))}function Lc(n={}){_i(n);function t(){Y("allowClose")&&d()}function e(){const c=K("activeIndex"),u=Y("steps")||[];if(typeof c>"u")return;const h=c+1;u[h]?l(h):d()}function a(){const c=K("activeIndex"),u=Y("steps")||[];if(typeof c>"u")return;const h=c-1;u[h]?l(h):d()}function i(c){(Y("steps")||[])[c]?l(c):d()}function s(){var c;if(K("__transitionCallback"))return;const u=K("activeIndex"),h=K("__activeStep"),p=K("__activeElement");if(typeof u>"u"||typeof h>"u"||typeof K("activeIndex")>"u")return;const f=((c=h.popover)==null?void 0:c.onPrevClick)||Y("onPrevClick");if(f)return f(p,h,{config:Y(),state:K()});a()}function o(){var c;if(K("__transitionCallback"))return;const u=K("activeIndex"),h=K("__activeStep"),p=K("__activeElement");if(typeof u>"u"||typeof h>"u")return;const f=((c=h.popover)==null?void 0:c.onNextClick)||Y("onNextClick");if(f)return f(p,h,{config:Y(),state:K()});e()}function r(){K("isInitialized")||(He("isInitialized",!0),document.body.classList.add("driver-active",Y("animate")?"driver-fade":"driver-simple"),Tc(),Oa("overlayClick",t),Oa("escapePress",t),Oa("arrowLeftPress",s),Oa("arrowRightPress",o))}function l(c=0){var u,h,p,f,m,_,S,k;const A=Y("steps");if(!A){console.error("No steps to drive through"),d();return}if(!A[c]){d();return}He("__activeOnDestroyed",document.activeElement),He("activeIndex",c);const x=A[c],O=A[c+1],C=A[c-1],P=((u=x.popover)==null?void 0:u.doneBtnText)||Y("doneBtnText")||"Done",I=Y("allowClose"),D=typeof((h=x.popover)==null?void 0:h.showProgress)<"u"?(p=x.popover)==null?void 0:p.showProgress:Y("showProgress"),ee=(((f=x.popover)==null?void 0:f.progressText)||Y("progressText")||"{{current}} of {{total}}").replace("{{current}}",`${c+1}`).replace("{{total}}",`${A.length}`),W=((m=x.popover)==null?void 0:m.showButtons)||Y("showButtons"),U=["next","previous",...I?["close"]:[]].filter(ne=>!(W!=null&&W.length)||W.includes(ne)),V=((_=x.popover)==null?void 0:_.onNextClick)||Y("onNextClick"),Q=((S=x.popover)==null?void 0:S.onPrevClick)||Y("onPrevClick"),ve=((k=x.popover)==null?void 0:k.onCloseClick)||Y("onCloseClick");Ms({...x,popover:{showButtons:U,nextBtnText:O?void 0:P,disableButtons:[...C?[]:["previous"]],showProgress:D,progressText:ee,onNextClick:V||(()=>{O?l(c+1):d()}),onPrevClick:Q||(()=>{l(c-1)}),onCloseClick:ve||(()=>{d()}),...(x==null?void 0:x.popover)||{}}})}function d(c=!0){const u=K("__activeElement"),h=K("__activeStep"),p=K("__activeOnDestroyed"),f=Y("onDestroyStarted");if(c&&f){const S=!u||(u==null?void 0:u.id)==="driver-dummy-element";f(S?void 0:u,h,{config:Y(),state:K()});return}const m=(h==null?void 0:h.onDeselected)||Y("onDeselected"),_=Y("onDestroyed");if(document.body.classList.remove("driver-active","driver-fade","driver-simple"),Oc(),Bc(),kc(),Cc(),bc(),Ps(),u&&h){const S=u.id==="driver-dummy-element";m&&m(S?void 0:u,h,{config:Y(),state:K()}),_&&_(S?void 0:u,h,{config:Y(),state:K()})}p&&p.focus()}return{isActive:()=>K("isInitialized")||!1,refresh:la,drive:(c=0)=>{r(),l(c)},setConfig:_i,setSteps:c=>{Ps(),_i({...Y(),steps:c})},getConfig:Y,getState:K,getActiveIndex:()=>K("activeIndex"),isFirstStep:()=>K("activeIndex")===0,isLastStep:()=>{const c=Y("steps")||[],u=K("activeIndex");return u!==void 0&&u===c.length-1},getActiveStep:()=>K("activeStep"),getActiveElement:()=>K("activeElement"),getPreviousElement:()=>K("previousElement"),getPreviousStep:()=>K("previousStep"),moveNext:e,movePrevious:a,moveTo:i,hasNextStep:()=>{const c=Y("steps")||[],u=K("activeIndex");return u!==void 0&&c[u+1]},hasPreviousStep:()=>{const c=Y("steps")||[],u=K("activeIndex");return u!==void 0&&c[u-1]},highlight:c=>{r(),Ms({...c,popover:c.popover?{showButtons:[],showProgress:!1,progressText:"",...c.popover}:void 0})},destroy:()=>{d(!1)}}}const zc=(n,t)=>{let a=n;if(t=Math.floor(Math.abs(t)),t>6&&(t=6),n.toString().indexOf("e")!==-1){const s=n.toString().split("e"),o=Number(s[1]);s[1]=(o+(o>=0?t:-t)).toString(),a=s.join("e")}else a=`${n}e${t}`;return Math.round(a)/Math.pow(10,t)},Rc=(n,t)=>Number(zc(n,t).toFixed(t)),$c=(n,t)=>n*t,Fc=(n,t,e)=>{const a=$c(n,t);return ts(e)?a:Rc(a,e)},Da=(n,t,e)=>ts(n)||Zl(n)||isNaN(n)?n:Fc(n,t,e),Nc=G({__name:"Index",setup(n){const t=R(Ze),e=()=>{t.sendEvent(new Jl(-1))},a=y();return ie(()=>t.uiState.isZooming||t.uiState.isTransformTouch,i=>{a.value=i}),(i,s)=>{const o=Ce;return g(),T("section",{class:oe(["reposition-wrap",a.value?"reposition-opacity":""]),onClick:e},[w(o,{name:"canvas-opt-reposition",size:"20px",class:"f-s-20"})],2)}}}),Hc=ae(Nc,[["__scopeId","data-v-f91214d2"]]),yi=0,Pa=6,Vc=G({__name:"NoticeMessage",setup(n){const t=y(!1),e=y(),a=y(0),i=y(0),s=y(0),o=R(Ze),r=R(ct);y(""),M(()=>$n().unit.current);const l=y({width:0,height:0});ie(()=>r.uiState.selectAttrs,u=>{l.value={width:u.width,height:u.height}});const d=M(()=>`${(r.uiState.selectAttrs.angle??0).toFixed(2)}°`);ie(()=>r.uiState.onRotate,u=>{t.value=u}),Ee(()=>t.value,()=>{const{x:u=0,y:h=0}=o.uiState.actionPosition;c(u,h,0)});const c=(u,h,p)=>{if(e.value){const{width:f,height:m}=e.value.getBoundingClientRect(),_=Math.sin(p*(Math.PI/180)),S=Math.cos(p*(Math.PI/180));let k=f/2;_>0?k=f+Pa*_:_<0&&(k=Pa*_);let A=Pa;S<0&&(A=-m+Pa*S);const x=u-k,O=h+A+yi+6;e.value.style.transform=`translate(${x}px,${O}px)`;let C=0,P=0;x<20&&(P=(20-x)/f*100),O<20+yi&&(C=(20+yi-O)/m*100),e.value.style.clipPath=`polygon(${P}% ${C}%, 100% ${C}%, 100% 100%, ${P}% 100%)`}};return ie(()=>o.uiState.isTouching,u=>{t.value&&!u&&(t.value=!1)}),Ee([()=>a.value,()=>i.value,()=>s.value],([u,h,p])=>{c(u,h,p)}),ie(()=>o.uiState.actionPosition,u=>{u&&(a.value=u.x,i.value=u.y)}),ie(()=>o.uiState.selectedAttrs.angle,u=>{s.value=u}),(u,h)=>(g(),T("div",{ref_key:"noticeView",ref:e,style:qe({opacity:t.value?1:0}),class:"notice"},N(d.value),5))}}),Uc=ae(Vc,[["__scopeId","data-v-ca1ec958"]]),Wc=G({__name:"MobileCanvas",setup(n){const t=R(Ze);R(_a);const e=y(),a=()=>{const s=e.value;s&&!Dt().isEmpty&&!i.value&&(i.value=!0,t.sendEvent(new ys({ele:s})))};je(()=>{a()});const i=y(!1);return ie(()=>Dt().isEmpty,s=>{s||a()}),Yt(()=>{const s=document.getElementById("canvas");s&&t.sendEvent(new ys({ele:s,isResize:!1})),t.sendEvent(new er),console.log(t.uiState.canvasView)}),(s,o)=>(g(),T(Se,null,[b("div",{id:"editor-canvas",ref_key:"container",ref:e,class:"m-canvas-container"},null,512),w(v(Hc)),w(Uc)],64))}}),Yc=ae(Wc,[["__scopeId","data-v-e5824559"]]),Gc={id:"editor-box",class:"canvas-wrapper"},jc={class:"canvas-selected-info"},Kc={class:"canvas-container"},Xc=G({__name:"EditorCanvas",setup(n){const t=R(Ze),e=R(Gt),a=M(()=>{if(t.uiState.eleSelected){const i=t.uiState.selectedAttrs,{scale:s,fractionDigits:o,current:r}=Qt.unit()??{scale:1,fractionDigits:1,current:"mm"},l=`${Da(i.width,s,o)}${r} x ${Da(i.height,s,o)}${r}`,d=`X:${Da(i.x,s,o)}${r} Y:${Da(i.y,s,o)}${r}`;return`${l}     ${d}`}else return""});return je(()=>{e.sendEvent(new Ri)}),(i,s)=>(g(),T("div",Gc,[b("div",jc,N(a.value),1),b("div",Kc,[w(Yc)])]))}}),qc=ae(Xc,[["__scopeId","data-v-df8a3e11"]]),Qc={class:"header-back-wrapper"},Zc={class:"do-btn-wrapper"},Jc=G({__name:"EditorHeader",props:{headerDisabled:{type:Boolean}},emits:["clickProcess"],setup(n,{expose:t,emit:e}){const{t:a}=fe(),i=R(Ze),s=R(ns),o=R(Nn),r=M(()=>!0),l=y(!1);ie(()=>i.uiState.enableUndo,x=>{l.value=x});const d=y(!1);ie(()=>i.uiState.enableRedo,x=>{d.value=x});const c=M(()=>[{id:"undo",icon:"nav-bar-undo",disabled:!l.value,onClick(){i.sendEvent(new tr)}},{id:"redo",icon:"nav-bar-redo",disabled:!d.value,onClick(){i.sendEvent(new nr)}}]),u=y();ie(()=>o.uiState.imageEditor,x=>{u.value=x});const h=os(),p=y(!1),f=async()=>{p.value=!0,s.sendEvent(new bn(!0)),ce.modal.showTipModal({title:"",content:a("mobile.common.save_notice_title"),confirmTxt:a("mobile.common.yes"),cancelTxt:a("mobile.common.no"),hasClose:!0,onClose:()=>{s.sendEvent(new bn(!1)),p.value=!1},onConfirm:async()=>{var x;if(Ga().isNewProject()){const O=((x=Ga().currentTempXcs)==null?void 0:x.name)||ar;ce.modal.showRenameModal({name:O,title:"mobile.projects.dialog_rename_project",confirmTxt:"common.msg.ok",maxLength:50,onConfirm:async C=>{s.sendEvent(new bn(!1)),await s.sendEvent(new ir(C)),m()},onCancel:()=>{s.sendEvent(new bn(!1))}})}else m(),s.sendEvent(new bn(!1));p.value=!1},onCancel:async()=>{s.sendEvent(new sr),s.sendEvent(new $i(!1)),p.value=!1,s.sendEvent(new bn(!1)),h.back()}})};async function m(){await s.sendEvent(new or),s.sendEvent(new $i(!1)),p.value=!1,h.back()}const _=e,S=()=>{_("clickProcess")},k=y(!1);ie(()=>s.uiState.isLoading,x=>{k.value=x,console.log("isLoading=====>",k.value)});const A=y(!1);return ie(()=>Xe().ext,x=>{A.value=!!x}),t({showBackDialog:p,goBack:f}),(x,O)=>{const C=Ce,P=jt,I=ga;return g(),T("div",Qc,[w(I,{fixed:"",placeholder:"",class:"editor-canvas-bar"},ao({left:B(()=>[Oe(w(P,{class:"header-lft-btn",size:"small",disabled:x.headerDisabled,onClick:f},{default:B(()=>[w(C,{name:"nav-bar-back",size:"22px",color:"#fff",class:"f-s-22"})]),_:1},8,["disabled"]),[[Fe,!u.value]])]),right:B(()=>[Oe(w(P,{class:"process-btn guide-editor-process",disabled:k.value||!A.value||x.headerDisabled,onClick:S},{default:B(()=>[mt(N(x.$t("device.process.processing")),1)]),_:1},8,["disabled"]),[[Fe,!u.value]])]),_:2},[r.value?{name:"title",fn:B(()=>[b("div",Zc,[(g(!0),T(Se,null,Pe(c.value,D=>(g(),j(P,{key:D.id,disabled:D.disabled||x.headerDisabled,class:oe(["btn-item",D.id]),size:"small",onClick:D.onClick},{default:B(()=>[w(C,{name:D.icon,size:"24px",color:"#fff",class:"f-s-24"},null,8,["name"])]),_:2},1032,["disabled","class","onClick"]))),128))])]),key:"0"}:void 0]),1024)])}}}),ed=ae(Jc,[["__scopeId","data-v-27a3d691"]]),td={class:"actions-wrap"},nd={class:"label"},ad={class:"action-list"},id=["onClick"],sd={class:"icon-wrap"},od=G({__name:"Index",props:{title:{},actionList:{}},emits:["selected"],setup(n,{emit:t}){const e=t,a=i=>{i.disable||(i.onClick?i.onClick():(i.child||i.component)&&e("selected",i))};return(i,s)=>(g(),T("div",td,[b("div",nd,N(i.$t(i.title)),1),b("div",ad,[(g(!0),T(Se,null,Pe(i.actionList,o=>(g(),T("div",{key:o.id,class:"action-item",onClick:r=>a(o)},[b("div",sd,[w(v(Ce),{name:o.icon,size:"24px",class:"f-s-24",color:"#1a1a1e"},null,8,["name"])]),b("span",{class:oe(["action-name",o.disable?"disabled":""])},N(i.$t(o.name)),3)],8,id))),128))])]))}}),Rs=ae(od,[["__scopeId","data-v-c974a645"]]),ld={class:"basic-panel-wrapper"},rd={key:0,class:"basic-default-content"},cd={key:1},dd={class:"panel-content"},ud=["data-id","onClick"],vd={class:"panel-bottom"},pd={class:"panel-tab"},hd=G({__name:"BasicPanel",props:{selected:{},data:{},hideBack:{type:Boolean}},emits:["onClose"],setup(n,{emit:t}){const{t:e}=fe(),a=n,i=t,s=c=>{c.disable||(c.onClick?c.onClick():a.data.childClick&&a.data.childClick(c))},o=y(),r=y(!1),l=as(c=>{var u;c.target&&(o.value=(u=c.target)==null?void 0:u.attributes["data-id"].value,r.value=c.detail)}),d=()=>{i("onClose")};return(c,u)=>{var f;const h=Ce,p=ri("x-tooltip");return g(),T("div",ld,[c.$slots.default?(g(),T("div",rd,[aa(c.$slots,"default",{},void 0,!0)])):(g(),T("div",cd,[b("div",dd,[c.data.child?(g(),T("div",{key:0,class:oe(["icon-list",{"icon-list-small":((f=c.data.child)==null?void 0:f.length)>4}])},[(g(!0),T(Se,null,Pe(c.data.child,m=>Oe((g(),T("div",{key:m.id,"data-id":m.id,class:oe(["icon-item",{"icon-disable":m==null?void 0:m.disable,"is-selected":c.selected===m.id||o.value===m.id&&r.value}]),onClick:_=>s(m),onLongpress:u[0]||(u[0]=(..._)=>v(l)&&v(l)(..._))},[w(h,{name:m.icon,size:"24px",class:"f-s-24"},null,8,["name"])],42,ud)),[[p,{content:v(e)(m.name),placement:"top",pressTime:500,distance:10}]])),128))],2)):le("",!0),c.data.component?(g(),j(it(c.data.component),{key:1})):le("",!0)])])),b("div",vd,[c.hideBack?le("",!0):(g(),j(h,{key:0,name:"basic_back",size:"24px",class:"f-s-24 basic-back",onClick:d})),Oe((g(),T("div",pd,[w(h,{name:c.data.icon,size:"24px",class:"f-s-24"},null,8,["name"])])),[[p,{content:v(e)(c.data.name),placement:"top",pressTime:500,distance:10}]])])])}}}),ya=ae(hd,[["__scopeId","data-v-c22eed2e"]]),md={class:"basic-panel-wrapper"},fd={class:"color-list"},gd=["onClick"],bd=G({__name:"Index",emits:["close"],setup(n,{emit:t}){fe();const e=nn({id:"move-layer",icon:"canvas-opt-layer-move",name:"layer"}),a=t,i=y(),s=R(Ze);ie(()=>s.uiState.selected.data,d=>{if(d.length>0){const c=[];d.forEach(u=>{c.includes(u.layerColor)||c.push(u.layerColor)}),c.length>1?i.value="":i.value=d[0].layerColor}});const o=R(rs),r=d=>{d!==i.value&&o.sendEvent(new Mo(d))},l=()=>{a("close")};return(d,c)=>(g(),T("div",md,[w(v(ya),{data:e.value,onOnClose:l},{default:B(()=>[b("div",fd,[(g(!0),T(Se,null,Pe(v(lr),u=>(g(),T("div",{key:u,class:"item",onClick:h=>r(u)},[b("div",{class:"layer-shadow",style:qe(`background-color: ${i.value===u?u:"transparent"}`)},null,4),b("div",{class:"color-node",style:qe(`background-color: ${u}`)},null,4)],8,gd))),128))])]),_:1},8,["data"])]))}}),_d=ae(bd,[["__scopeId","data-v-cc431bb2"]]);var yd=Object.defineProperty,Za=Object.getOwnPropertySymbols,Wo=Object.prototype.hasOwnProperty,Yo=Object.prototype.propertyIsEnumerable,$s=(n,t,e)=>t in n?yd(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,Sn=(n,t)=>{for(var e in t||(t={}))Wo.call(t,e)&&$s(n,e,t[e]);if(Za)for(var e of Za(t))Yo.call(t,e)&&$s(n,e,t[e]);return n},Go=(n,t)=>{var e={};for(var a in n)Wo.call(n,a)&&t.indexOf(a)<0&&(e[a]=n[a]);if(n!=null&&Za)for(var a of Za(n))t.indexOf(a)<0&&Yo.call(n,a)&&(e[a]=n[a]);return e};const jo="[vue-draggable-plus]: ";function wd(n){console.warn(jo+n)}function Sd(n){console.error(jo+n)}function Fs(n,t,e){return e>=0&&e<n.length&&n.splice(e,0,n.splice(t,1)[0]),n}function Cd(n){return n.replace(/-(\w)/g,(t,e)=>e?e.toUpperCase():"")}function xd(n){return Object.keys(n).reduce((t,e)=>(typeof n[e]<"u"&&(t[Cd(e)]=n[e]),t),{})}function Ed(n,t){if(Array.isArray(n))return n.splice(t,1)}function Id(n,t,e){if(Array.isArray(n))return n.splice(t,0,e)}function kd(n){return typeof n>"u"}function Ad(n){return typeof n=="string"}function Ns(n,t,e){const a=n.children[e];n.insertBefore(t,a)}function wi(n){n.parentNode&&n.parentNode.removeChild(n)}function Td(n,t=document){var e;let a=null;return typeof(t==null?void 0:t.querySelector)=="function"?a=(e=t==null?void 0:t.querySelector)==null?void 0:e.call(t,n):a=document.querySelector(n),a||wd(`Element not found: ${n}`),a}function Od(n,t,e=null){return function(...a){return n.apply(e,a),t.apply(e,a)}}function Dd(n,t){const e=Sn({},n);return Object.keys(t).forEach(a=>{e[a]?e[a]=Od(n[a],t[a]):e[a]=t[a]}),e}function Pd(n){return n instanceof HTMLElement}function Md(n,t){Object.keys(n).forEach(e=>{t(e,n[e])})}/**!
 * Sortable 1.15.1
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Hs(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,a)}return e}function Pt(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Hs(Object(e),!0).forEach(function(a){Bd(n,a,e[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Hs(Object(e)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(e,a))})}return n}function Fa(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Fa=function(t){return typeof t}:Fa=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(n)}function Bd(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function Wt(){return Wt=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n},Wt.apply(this,arguments)}function Ld(n,t){if(n==null)return{};var e={},a=Object.keys(n),i,s;for(s=0;s<a.length;s++)i=a[s],!(t.indexOf(i)>=0)&&(e[i]=n[i]);return e}function zd(n,t){if(n==null)return{};var e=Ld(n,t),a,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)a=s[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(n,a)&&(e[a]=n[a])}return e}var Rd="1.15.1";function Vt(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var Xt=Vt(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),wa=Vt(/Edge/i),Vs=Vt(/firefox/i),Zn=Vt(/safari/i)&&!Vt(/chrome/i)&&!Vt(/android/i),Ko=Vt(/iP(ad|od|hone)/i),Xo=Vt(/chrome/i)&&Vt(/android/i),qo={capture:!1,passive:!1};function ye(n,t,e){n.addEventListener(t,e,!Xt&&qo)}function _e(n,t,e){n.removeEventListener(t,e,!Xt&&qo)}function Ja(n,t){if(t){if(t[0]===">"&&(t=t.substring(1)),n)try{if(n.matches)return n.matches(t);if(n.msMatchesSelector)return n.msMatchesSelector(t);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(t)}catch{return!1}return!1}}function $d(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function Et(n,t,e,a){if(n){e=e||document;do{if(t!=null&&(t[0]===">"?n.parentNode===e&&Ja(n,t):Ja(n,t))||a&&n===e)return n;if(n===e)break}while(n=$d(n))}return null}var Us=/\s+/g;function st(n,t,e){if(n&&t)if(n.classList)n.classList[e?"add":"remove"](t);else{var a=(" "+n.className+" ").replace(Us," ").replace(" "+t+" "," ");n.className=(a+(e?" "+t:"")).replace(Us," ")}}function J(n,t,e){var a=n&&n.style;if(a){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(e=n.currentStyle),t===void 0?e:e[t];!(t in a)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),a[t]=e+(typeof e=="string"?"":"px")}}function En(n,t){var e="";if(typeof n=="string")e=n;else do{var a=J(n,"transform");a&&a!=="none"&&(e=a+" "+e)}while(!t&&(n=n.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(e)}function Qo(n,t,e){if(n){var a=n.getElementsByTagName(t),i=0,s=a.length;if(e)for(;i<s;i++)e(a[i],i);return a}return[]}function Ot(){var n=document.scrollingElement;return n||document.documentElement}function ze(n,t,e,a,i){if(!(!n.getBoundingClientRect&&n!==window)){var s,o,r,l,d,c,u;if(n!==window&&n.parentNode&&n!==Ot()?(s=n.getBoundingClientRect(),o=s.top,r=s.left,l=s.bottom,d=s.right,c=s.height,u=s.width):(o=0,r=0,l=window.innerHeight,d=window.innerWidth,c=window.innerHeight,u=window.innerWidth),(t||e)&&n!==window&&(i=i||n.parentNode,!Xt))do if(i&&i.getBoundingClientRect&&(J(i,"transform")!=="none"||e&&J(i,"position")!=="static")){var h=i.getBoundingClientRect();o-=h.top+parseInt(J(i,"border-top-width")),r-=h.left+parseInt(J(i,"border-left-width")),l=o+s.height,d=r+s.width;break}while(i=i.parentNode);if(a&&n!==window){var p=En(i||n),f=p&&p.a,m=p&&p.d;p&&(o/=m,r/=f,u/=f,c/=m,l=o+c,d=r+u)}return{top:o,left:r,bottom:l,right:d,width:u,height:c}}}function Zo(n){var t=ze(n),e=parseInt(J(n,"padding-left")),a=parseInt(J(n,"padding-top")),i=parseInt(J(n,"padding-right")),s=parseInt(J(n,"padding-bottom"));return t.top+=a+parseInt(J(n,"border-top-width")),t.left+=e+parseInt(J(n,"border-left-width")),t.width=n.clientWidth-e-i,t.height=n.clientHeight-a-s,t.bottom=t.top+t.height,t.right=t.left+t.width,t}function Ws(n,t,e){for(var a=tn(n,!0),i=ze(n)[t];a;){var s=ze(a)[e],o=void 0;if(e==="top"||e==="left"?o=i>=s:o=i<=s,!o)return a;if(a===Ot())break;a=tn(a,!1)}return!1}function Rn(n,t,e,a){for(var i=0,s=0,o=n.children;s<o.length;){if(o[s].style.display!=="none"&&o[s]!==se.ghost&&(a||o[s]!==se.dragged)&&Et(o[s],e.draggable,n,!1)){if(i===t)return o[s];i++}s++}return null}function cs(n,t){for(var e=n.lastElementChild;e&&(e===se.ghost||J(e,"display")==="none"||t&&!Ja(e,t));)e=e.previousElementSibling;return e||null}function dt(n,t){var e=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==se.clone&&(!t||Ja(n,t))&&e++;return e}function Ys(n){var t=0,e=0,a=Ot();if(n)do{var i=En(n),s=i.a,o=i.d;t+=n.scrollLeft*s,e+=n.scrollTop*o}while(n!==a&&(n=n.parentNode));return[t,e]}function Fd(n,t){for(var e in n)if(n.hasOwnProperty(e)){for(var a in t)if(t.hasOwnProperty(a)&&t[a]===n[e][a])return Number(e)}return-1}function tn(n,t){if(!n||!n.getBoundingClientRect)return Ot();var e=n,a=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var i=J(e);if(e.clientWidth<e.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return Ot();if(a||t)return e;a=!0}}while(e=e.parentNode);return Ot()}function Nd(n,t){if(n&&t)for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function Si(n,t){return Math.round(n.top)===Math.round(t.top)&&Math.round(n.left)===Math.round(t.left)&&Math.round(n.height)===Math.round(t.height)&&Math.round(n.width)===Math.round(t.width)}var Jn;function Jo(n,t){return function(){if(!Jn){var e=arguments,a=this;e.length===1?n.call(a,e[0]):n.apply(a,e),Jn=setTimeout(function(){Jn=void 0},t)}}}function Hd(){clearTimeout(Jn),Jn=void 0}function el(n,t,e){n.scrollLeft+=t,n.scrollTop+=e}function tl(n){var t=window.Polymer,e=window.jQuery||window.Zepto;return t&&t.dom?t.dom(n).cloneNode(!0):e?e(n).clone(!0)[0]:n.cloneNode(!0)}var lt="Sortable"+new Date().getTime();function Vd(){var n=[],t;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var e=[].slice.call(this.el.children);e.forEach(function(a){if(!(J(a,"display")==="none"||a===se.ghost)){n.push({target:a,rect:ze(a)});var i=Pt({},n[n.length-1].rect);if(a.thisAnimationDuration){var s=En(a,!0);s&&(i.top-=s.f,i.left-=s.e)}a.fromRect=i}})}},addAnimationState:function(e){n.push(e)},removeAnimationState:function(e){n.splice(Fd(n,{target:e}),1)},animateAll:function(e){var a=this;if(!this.options.animation){clearTimeout(t),typeof e=="function"&&e();return}var i=!1,s=0;n.forEach(function(o){var r=0,l=o.target,d=l.fromRect,c=ze(l),u=l.prevFromRect,h=l.prevToRect,p=o.rect,f=En(l,!0);f&&(c.top-=f.f,c.left-=f.e),l.toRect=c,l.thisAnimationDuration&&Si(u,c)&&!Si(d,c)&&(p.top-c.top)/(p.left-c.left)===(d.top-c.top)/(d.left-c.left)&&(r=Wd(p,u,h,a.options)),Si(c,d)||(l.prevFromRect=d,l.prevToRect=c,r||(r=a.options.animation),a.animate(l,p,c,r)),r&&(i=!0,s=Math.max(s,r),clearTimeout(l.animationResetTimer),l.animationResetTimer=setTimeout(function(){l.animationTime=0,l.prevFromRect=null,l.fromRect=null,l.prevToRect=null,l.thisAnimationDuration=null},r),l.thisAnimationDuration=r)}),clearTimeout(t),i?t=setTimeout(function(){typeof e=="function"&&e()},s):typeof e=="function"&&e(),n=[]},animate:function(e,a,i,s){if(s){J(e,"transition",""),J(e,"transform","");var o=En(this.el),r=o&&o.a,l=o&&o.d,d=(a.left-i.left)/(r||1),c=(a.top-i.top)/(l||1);e.animatingX=!!d,e.animatingY=!!c,J(e,"transform","translate3d("+d+"px,"+c+"px,0)"),this.forRepaintDummy=Ud(e),J(e,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),J(e,"transform","translate3d(0,0,0)"),typeof e.animated=="number"&&clearTimeout(e.animated),e.animated=setTimeout(function(){J(e,"transition",""),J(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},s)}}}}function Ud(n){return n.offsetWidth}function Wd(n,t,e,a){return Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))/Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))*a.animation}var _n=[],Ci={initializeByDefault:!0},Sa={mount:function(n){for(var t in Ci)Ci.hasOwnProperty(t)&&!(t in n)&&(n[t]=Ci[t]);_n.forEach(function(e){if(e.pluginName===n.pluginName)throw"Sortable: Cannot mount plugin ".concat(n.pluginName," more than once")}),_n.push(n)},pluginEvent:function(n,t,e){var a=this;this.eventCanceled=!1,e.cancel=function(){a.eventCanceled=!0};var i=n+"Global";_n.forEach(function(s){t[s.pluginName]&&(t[s.pluginName][i]&&t[s.pluginName][i](Pt({sortable:t},e)),t.options[s.pluginName]&&t[s.pluginName][n]&&t[s.pluginName][n](Pt({sortable:t},e)))})},initializePlugins:function(n,t,e,a){_n.forEach(function(o){var r=o.pluginName;if(!(!n.options[r]&&!o.initializeByDefault)){var l=new o(n,t,n.options);l.sortable=n,l.options=n.options,n[r]=l,Wt(e,l.defaults)}});for(var i in n.options)if(n.options.hasOwnProperty(i)){var s=this.modifyOption(n,i,n.options[i]);typeof s<"u"&&(n.options[i]=s)}},getEventProperties:function(n,t){var e={};return _n.forEach(function(a){typeof a.eventProperties=="function"&&Wt(e,a.eventProperties.call(t[a.pluginName],n))}),e},modifyOption:function(n,t,e){var a;return _n.forEach(function(i){n[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[t]=="function"&&(a=i.optionListeners[t].call(n[i.pluginName],e))}),a}};function Yd(n){var t=n.sortable,e=n.rootEl,a=n.name,i=n.targetEl,s=n.cloneEl,o=n.toEl,r=n.fromEl,l=n.oldIndex,d=n.newIndex,c=n.oldDraggableIndex,u=n.newDraggableIndex,h=n.originalEvent,p=n.putSortable,f=n.extraEventProperties;if(t=t||e&&e[lt],!!t){var m,_=t.options,S="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!Xt&&!wa?m=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(m=document.createEvent("Event"),m.initEvent(a,!0,!0)),m.to=o||e,m.from=r||e,m.item=i||e,m.clone=s,m.oldIndex=l,m.newIndex=d,m.oldDraggableIndex=c,m.newDraggableIndex=u,m.originalEvent=h,m.pullMode=p?p.lastPutMode:void 0;var k=Pt(Pt({},f),Sa.getEventProperties(a,t));for(var A in k)m[A]=k[A];e&&e.dispatchEvent(m),_[S]&&_[S].call(t,m)}}var Gd=["evt"],nt=function(n,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=e.evt,i=zd(e,Gd);Sa.pluginEvent.bind(se)(n,t,Pt({dragEl:z,parentEl:Me,ghostEl:de,rootEl:Te,nextEl:dn,lastDownEl:Na,cloneEl:De,cloneHidden:Jt,dragStarted:jn,putSortable:Ge,activeSortable:se.active,originalEvent:a,oldIndex:Cn,oldDraggableIndex:ea,newIndex:ot,newDraggableIndex:Zt,hideGhostForTarget:sl,unhideGhostForTarget:ol,cloneNowHidden:function(){Jt=!0},cloneNowShown:function(){Jt=!1},dispatchSortableEvent:function(s){et({sortable:t,name:s,originalEvent:a})}},i))};function et(n){Yd(Pt({putSortable:Ge,cloneEl:De,targetEl:z,rootEl:Te,oldIndex:Cn,oldDraggableIndex:ea,newIndex:ot,newDraggableIndex:Zt},n))}var z,Me,de,Te,dn,Na,De,Jt,Cn,ot,ea,Zt,Ma,Ge,wn=!1,ei=!1,ti=[],rn,bt,xi,Ei,Gs,js,jn,yn,ta,na=!1,Ba=!1,Ha,Ke,Ii=[],Wi=!1,ni=[],hi=typeof document<"u",La=Ko,Ks=wa||Xt?"cssFloat":"float",jd=hi&&!Xo&&!Ko&&"draggable"in document.createElement("div"),nl=function(){if(hi){if(Xt)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),al=function(n,t){var e=J(n),a=parseInt(e.width)-parseInt(e.paddingLeft)-parseInt(e.paddingRight)-parseInt(e.borderLeftWidth)-parseInt(e.borderRightWidth),i=Rn(n,0,t),s=Rn(n,1,t),o=i&&J(i),r=s&&J(s),l=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+ze(i).width,d=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+ze(s).width;if(e.display==="flex")return e.flexDirection==="column"||e.flexDirection==="column-reverse"?"vertical":"horizontal";if(e.display==="grid")return e.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&o.float&&o.float!=="none"){var c=o.float==="left"?"left":"right";return s&&(r.clear==="both"||r.clear===c)?"vertical":"horizontal"}return i&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||l>=a&&e[Ks]==="none"||s&&e[Ks]==="none"&&l+d>a)?"vertical":"horizontal"},Kd=function(n,t,e){var a=e?n.left:n.top,i=e?n.right:n.bottom,s=e?n.width:n.height,o=e?t.left:t.top,r=e?t.right:t.bottom,l=e?t.width:t.height;return a===o||i===r||a+s/2===o+l/2},Xd=function(n,t){var e;return ti.some(function(a){var i=a[lt].options.emptyInsertThreshold;if(!(!i||cs(a))){var s=ze(a),o=n>=s.left-i&&n<=s.right+i,r=t>=s.top-i&&t<=s.bottom+i;if(o&&r)return e=a}}),e},il=function(n){function t(i,s){return function(o,r,l,d){var c=o.options.group.name&&r.options.group.name&&o.options.group.name===r.options.group.name;if(i==null&&(s||c))return!0;if(i==null||i===!1)return!1;if(s&&i==="clone")return i;if(typeof i=="function")return t(i(o,r,l,d),s)(o,r,l,d);var u=(s?o:r).options.group.name;return i===!0||typeof i=="string"&&i===u||i.join&&i.indexOf(u)>-1}}var e={},a=n.group;(!a||Fa(a)!="object")&&(a={name:a}),e.name=a.name,e.checkPull=t(a.pull,!0),e.checkPut=t(a.put),e.revertClone=a.revertClone,n.group=e},sl=function(){!nl&&de&&J(de,"display","none")},ol=function(){!nl&&de&&J(de,"display","")};hi&&!Xo&&document.addEventListener("click",function(n){if(ei)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),ei=!1,!1},!0);var cn=function(n){if(z){n=n.touches?n.touches[0]:n;var t=Xd(n.clientX,n.clientY);if(t){var e={};for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a]);e.target=e.rootEl=t,e.preventDefault=void 0,e.stopPropagation=void 0,t[lt]._onDragOver(e)}}},qd=function(n){z&&z.parentNode[lt]._isOutsideThisEl(n.target)};function se(n,t){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=t=Wt({},t),n[lt]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return al(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(s,o){s.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:se.supportPointer!==!1&&"PointerEvent"in window&&!Zn,emptyInsertThreshold:5};Sa.initializePlugins(this,n,e);for(var a in e)!(a in t)&&(t[a]=e[a]);il(t);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:jd,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?ye(n,"pointerdown",this._onTapStart):(ye(n,"mousedown",this._onTapStart),ye(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(ye(n,"dragover",this),ye(n,"dragenter",this)),ti.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Wt(this,Vd())}se.prototype={constructor:se,_isOutsideThisEl:function(n){!this.el.contains(n)&&n!==this.el&&(yn=null)},_getDirection:function(n,t){return typeof this.options.direction=="function"?this.options.direction.call(this,n,t,z):this.options.direction},_onTapStart:function(n){if(n.cancelable){var t=this,e=this.el,a=this.options,i=a.preventOnFilter,s=n.type,o=n.touches&&n.touches[0]||n.pointerType&&n.pointerType==="touch"&&n,r=(o||n).target,l=n.target.shadowRoot&&(n.path&&n.path[0]||n.composedPath&&n.composedPath()[0])||r,d=a.filter;if(iu(e),!z&&!(/mousedown|pointerdown/.test(s)&&n.button!==0||a.disabled)&&!l.isContentEditable&&!(!this.nativeDraggable&&Zn&&r&&r.tagName.toUpperCase()==="SELECT")&&(r=Et(r,a.draggable,e,!1),!(r&&r.animated)&&Na!==r)){if(Cn=dt(r),ea=dt(r,a.draggable),typeof d=="function"){if(d.call(this,n,r,this)){et({sortable:t,rootEl:l,name:"filter",targetEl:r,toEl:e,fromEl:e}),nt("filter",t,{evt:n}),i&&n.cancelable&&n.preventDefault();return}}else if(d&&(d=d.split(",").some(function(c){if(c=Et(l,c.trim(),e,!1),c)return et({sortable:t,rootEl:c,name:"filter",targetEl:r,fromEl:e,toEl:e}),nt("filter",t,{evt:n}),!0}),d)){i&&n.cancelable&&n.preventDefault();return}a.handle&&!Et(l,a.handle,e,!1)||this._prepareDragStart(n,o,r)}}},_prepareDragStart:function(n,t,e){var a=this,i=a.el,s=a.options,o=i.ownerDocument,r;if(e&&!z&&e.parentNode===i){var l=ze(e);if(Te=i,z=e,Me=z.parentNode,dn=z.nextSibling,Na=e,Ma=s.group,se.dragged=z,rn={target:z,clientX:(t||n).clientX,clientY:(t||n).clientY},Gs=rn.clientX-l.left,js=rn.clientY-l.top,this._lastX=(t||n).clientX,this._lastY=(t||n).clientY,z.style["will-change"]="all",r=function(){if(nt("delayEnded",a,{evt:n}),se.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!Vs&&a.nativeDraggable&&(z.draggable=!0),a._triggerDragStart(n,t),et({sortable:a,name:"choose",originalEvent:n}),st(z,s.chosenClass,!0)},s.ignore.split(",").forEach(function(d){Qo(z,d.trim(),ki)}),ye(o,"dragover",cn),ye(o,"mousemove",cn),ye(o,"touchmove",cn),ye(o,"mouseup",a._onDrop),ye(o,"touchend",a._onDrop),ye(o,"touchcancel",a._onDrop),Vs&&this.nativeDraggable&&(this.options.touchStartThreshold=4,z.draggable=!0),nt("delayStart",this,{evt:n}),s.delay&&(!s.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(wa||Xt))){if(se.eventCanceled){this._onDrop();return}ye(o,"mouseup",a._disableDelayedDrag),ye(o,"touchend",a._disableDelayedDrag),ye(o,"touchcancel",a._disableDelayedDrag),ye(o,"mousemove",a._delayedDragTouchMoveHandler),ye(o,"touchmove",a._delayedDragTouchMoveHandler),s.supportPointer&&ye(o,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(r,s.delay)}else r()}},_delayedDragTouchMoveHandler:function(n){var t=n.touches?n.touches[0]:n;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){z&&ki(z),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var n=this.el.ownerDocument;_e(n,"mouseup",this._disableDelayedDrag),_e(n,"touchend",this._disableDelayedDrag),_e(n,"touchcancel",this._disableDelayedDrag),_e(n,"mousemove",this._delayedDragTouchMoveHandler),_e(n,"touchmove",this._delayedDragTouchMoveHandler),_e(n,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(n,t){t=t||n.pointerType=="touch"&&n,!this.nativeDraggable||t?this.options.supportPointer?ye(document,"pointermove",this._onTouchMove):t?ye(document,"touchmove",this._onTouchMove):ye(document,"mousemove",this._onTouchMove):(ye(z,"dragend",this),ye(Te,"dragstart",this._onDragStart));try{document.selection?Va(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(n,t){if(wn=!1,Te&&z){nt("dragStarted",this,{evt:t}),this.nativeDraggable&&ye(document,"dragover",qd);var e=this.options;!n&&st(z,e.dragClass,!1),st(z,e.ghostClass,!0),se.active=this,n&&this._appendGhost(),et({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(bt){this._lastX=bt.clientX,this._lastY=bt.clientY,sl();for(var n=document.elementFromPoint(bt.clientX,bt.clientY),t=n;n&&n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(bt.clientX,bt.clientY),n!==t);)t=n;if(z.parentNode[lt]._isOutsideThisEl(n),t)do{if(t[lt]){var e=void 0;if(e=t[lt]._onDragOver({clientX:bt.clientX,clientY:bt.clientY,target:n,rootEl:t}),e&&!this.options.dragoverBubble)break}n=t}while(t=t.parentNode);ol()}},_onTouchMove:function(n){if(rn){var t=this.options,e=t.fallbackTolerance,a=t.fallbackOffset,i=n.touches?n.touches[0]:n,s=de&&En(de,!0),o=de&&s&&s.a,r=de&&s&&s.d,l=La&&Ke&&Ys(Ke),d=(i.clientX-rn.clientX+a.x)/(o||1)+(l?l[0]-Ii[0]:0)/(o||1),c=(i.clientY-rn.clientY+a.y)/(r||1)+(l?l[1]-Ii[1]:0)/(r||1);if(!se.active&&!wn){if(e&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<e)return;this._onDragStart(n,!0)}if(de){s?(s.e+=d-(xi||0),s.f+=c-(Ei||0)):s={a:1,b:0,c:0,d:1,e:d,f:c};var u="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");J(de,"webkitTransform",u),J(de,"mozTransform",u),J(de,"msTransform",u),J(de,"transform",u),xi=d,Ei=c,bt=i}n.cancelable&&n.preventDefault()}},_appendGhost:function(){if(!de){var n=this.options.fallbackOnBody?document.body:Te,t=ze(z,!0,La,!0,n),e=this.options;if(La){for(Ke=n;J(Ke,"position")==="static"&&J(Ke,"transform")==="none"&&Ke!==document;)Ke=Ke.parentNode;Ke!==document.body&&Ke!==document.documentElement?(Ke===document&&(Ke=Ot()),t.top+=Ke.scrollTop,t.left+=Ke.scrollLeft):Ke=Ot(),Ii=Ys(Ke)}de=z.cloneNode(!0),st(de,e.ghostClass,!1),st(de,e.fallbackClass,!0),st(de,e.dragClass,!0),J(de,"transition",""),J(de,"transform",""),J(de,"box-sizing","border-box"),J(de,"margin",0),J(de,"top",t.top),J(de,"left",t.left),J(de,"width",t.width),J(de,"height",t.height),J(de,"opacity","0.8"),J(de,"position",La?"absolute":"fixed"),J(de,"zIndex","100000"),J(de,"pointerEvents","none"),se.ghost=de,n.appendChild(de),J(de,"transform-origin",Gs/parseInt(de.style.width)*100+"% "+js/parseInt(de.style.height)*100+"%")}},_onDragStart:function(n,t){var e=this,a=n.dataTransfer,i=e.options;if(nt("dragStart",this,{evt:n}),se.eventCanceled){this._onDrop();return}nt("setupClone",this),se.eventCanceled||(De=tl(z),De.removeAttribute("id"),De.draggable=!1,De.style["will-change"]="",this._hideClone(),st(De,this.options.chosenClass,!1),se.clone=De),e.cloneId=Va(function(){nt("clone",e),!se.eventCanceled&&(e.options.removeCloneOnHide||Te.insertBefore(De,z),e._hideClone(),et({sortable:e,name:"clone"}))}),!t&&st(z,i.dragClass,!0),t?(ei=!0,e._loopId=setInterval(e._emulateDragOver,50)):(_e(document,"mouseup",e._onDrop),_e(document,"touchend",e._onDrop),_e(document,"touchcancel",e._onDrop),a&&(a.effectAllowed="move",i.setData&&i.setData.call(e,a,z)),ye(document,"drop",e),J(z,"transform","translateZ(0)")),wn=!0,e._dragStartId=Va(e._dragStarted.bind(e,t,n)),ye(document,"selectstart",e),jn=!0,Zn&&J(document.body,"user-select","none")},_onDragOver:function(n){var t=this.el,e=n.target,a,i,s,o=this.options,r=o.group,l=se.active,d=Ma===r,c=o.sort,u=Ge||l,h,p=this,f=!1;if(Wi)return;function m(re,ke){nt(re,p,Pt({evt:n,isOwner:d,axis:h?"vertical":"horizontal",revert:s,dragRect:a,targetRect:i,canSort:c,fromSortable:u,target:e,completed:S,onMove:function(Ae,Be){return za(Te,t,z,a,Ae,ze(Ae),n,Be)},changed:k},ke))}function _(){m("dragOverAnimationCapture"),p.captureAnimationState(),p!==u&&u.captureAnimationState()}function S(re){return m("dragOverCompleted",{insertion:re}),re&&(d?l._hideClone():l._showClone(p),p!==u&&(st(z,Ge?Ge.options.ghostClass:l.options.ghostClass,!1),st(z,o.ghostClass,!0)),Ge!==p&&p!==se.active?Ge=p:p===se.active&&Ge&&(Ge=null),u===p&&(p._ignoreWhileAnimating=e),p.animateAll(function(){m("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(e===z&&!z.animated||e===t&&!e.animated)&&(yn=null),!o.dragoverBubble&&!n.rootEl&&e!==document&&(z.parentNode[lt]._isOutsideThisEl(n.target),!re&&cn(n)),!o.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),f=!0}function k(){ot=dt(z),Zt=dt(z,o.draggable),et({sortable:p,name:"change",toEl:t,newIndex:ot,newDraggableIndex:Zt,originalEvent:n})}if(n.preventDefault!==void 0&&n.cancelable&&n.preventDefault(),e=Et(e,o.draggable,t,!0),m("dragOver"),se.eventCanceled)return f;if(z.contains(n.target)||e.animated&&e.animatingX&&e.animatingY||p._ignoreWhileAnimating===e)return S(!1);if(ei=!1,l&&!o.disabled&&(d?c||(s=Me!==Te):Ge===this||(this.lastPutMode=Ma.checkPull(this,l,z,n))&&r.checkPut(this,l,z,n))){if(h=this._getDirection(n,e)==="vertical",a=ze(z),m("dragOverValid"),se.eventCanceled)return f;if(s)return Me=Te,_(),this._hideClone(),m("revert"),se.eventCanceled||(dn?Te.insertBefore(z,dn):Te.appendChild(z)),S(!0);var A=cs(t,o.draggable);if(!A||eu(n,h,this)&&!A.animated){if(A===z)return S(!1);if(A&&t===n.target&&(e=A),e&&(i=ze(e)),za(Te,t,z,a,e,i,n,!!e)!==!1)return _(),A&&A.nextSibling?t.insertBefore(z,A.nextSibling):t.appendChild(z),Me=t,k(),S(!0)}else if(A&&Jd(n,h,this)){var x=Rn(t,0,o,!0);if(x===z)return S(!1);if(e=x,i=ze(e),za(Te,t,z,a,e,i,n,!1)!==!1)return _(),t.insertBefore(z,x),Me=t,k(),S(!0)}else if(e.parentNode===t){i=ze(e);var O=0,C,P=z.parentNode!==t,I=!Kd(z.animated&&z.toRect||a,e.animated&&e.toRect||i,h),D=h?"top":"left",ee=Ws(e,"top","top")||Ws(z,"top","top"),W=ee?ee.scrollTop:void 0;yn!==e&&(C=i[D],na=!1,Ba=!I&&o.invertSwap||P),O=tu(n,e,i,h,I?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,Ba,yn===e);var U;if(O!==0){var V=dt(z);do V-=O,U=Me.children[V];while(U&&(J(U,"display")==="none"||U===de))}if(O===0||U===e)return S(!1);yn=e,ta=O;var Q=e.nextElementSibling,ve=!1;ve=O===1;var ne=za(Te,t,z,a,e,i,n,ve);if(ne!==!1)return(ne===1||ne===-1)&&(ve=ne===1),Wi=!0,setTimeout(Zd,30),_(),ve&&!Q?t.appendChild(z):e.parentNode.insertBefore(z,ve?Q:e),ee&&el(ee,0,W-ee.scrollTop),Me=z.parentNode,C!==void 0&&!Ba&&(Ha=Math.abs(C-ze(e)[D])),k(),S(!0)}if(t.contains(z))return S(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){_e(document,"mousemove",this._onTouchMove),_e(document,"touchmove",this._onTouchMove),_e(document,"pointermove",this._onTouchMove),_e(document,"dragover",cn),_e(document,"mousemove",cn),_e(document,"touchmove",cn)},_offUpEvents:function(){var n=this.el.ownerDocument;_e(n,"mouseup",this._onDrop),_e(n,"touchend",this._onDrop),_e(n,"pointerup",this._onDrop),_e(n,"touchcancel",this._onDrop),_e(document,"selectstart",this)},_onDrop:function(n){var t=this.el,e=this.options;if(ot=dt(z),Zt=dt(z,e.draggable),nt("drop",this,{evt:n}),Me=z&&z.parentNode,ot=dt(z),Zt=dt(z,e.draggable),se.eventCanceled){this._nulling();return}wn=!1,Ba=!1,na=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Yi(this.cloneId),Yi(this._dragStartId),this.nativeDraggable&&(_e(document,"drop",this),_e(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Zn&&J(document.body,"user-select",""),J(z,"transform",""),n&&(jn&&(n.cancelable&&n.preventDefault(),!e.dropBubble&&n.stopPropagation()),de&&de.parentNode&&de.parentNode.removeChild(de),(Te===Me||Ge&&Ge.lastPutMode!=="clone")&&De&&De.parentNode&&De.parentNode.removeChild(De),z&&(this.nativeDraggable&&_e(z,"dragend",this),ki(z),z.style["will-change"]="",jn&&!wn&&st(z,Ge?Ge.options.ghostClass:this.options.ghostClass,!1),st(z,this.options.chosenClass,!1),et({sortable:this,name:"unchoose",toEl:Me,newIndex:null,newDraggableIndex:null,originalEvent:n}),Te!==Me?(ot>=0&&(et({rootEl:Me,name:"add",toEl:Me,fromEl:Te,originalEvent:n}),et({sortable:this,name:"remove",toEl:Me,originalEvent:n}),et({rootEl:Me,name:"sort",toEl:Me,fromEl:Te,originalEvent:n}),et({sortable:this,name:"sort",toEl:Me,originalEvent:n})),Ge&&Ge.save()):ot!==Cn&&ot>=0&&(et({sortable:this,name:"update",toEl:Me,originalEvent:n}),et({sortable:this,name:"sort",toEl:Me,originalEvent:n})),se.active&&((ot==null||ot===-1)&&(ot=Cn,Zt=ea),et({sortable:this,name:"end",toEl:Me,originalEvent:n}),this.save()))),this._nulling()},_nulling:function(){nt("nulling",this),Te=z=Me=de=dn=De=Na=Jt=rn=bt=jn=ot=Zt=Cn=ea=yn=ta=Ge=Ma=se.dragged=se.ghost=se.clone=se.active=null,ni.forEach(function(n){n.checked=!0}),ni.length=xi=Ei=0},handleEvent:function(n){switch(n.type){case"drop":case"dragend":this._onDrop(n);break;case"dragenter":case"dragover":z&&(this._onDragOver(n),Qd(n));break;case"selectstart":n.preventDefault();break}},toArray:function(){for(var n=[],t,e=this.el.children,a=0,i=e.length,s=this.options;a<i;a++)t=e[a],Et(t,s.draggable,this.el,!1)&&n.push(t.getAttribute(s.dataIdAttr)||au(t));return n},sort:function(n,t){var e={},a=this.el;this.toArray().forEach(function(i,s){var o=a.children[s];Et(o,this.options.draggable,a,!1)&&(e[i]=o)},this),t&&this.captureAnimationState(),n.forEach(function(i){e[i]&&(a.removeChild(e[i]),a.appendChild(e[i]))}),t&&this.animateAll()},save:function(){var n=this.options.store;n&&n.set&&n.set(this)},closest:function(n,t){return Et(n,t||this.options.draggable,this.el,!1)},option:function(n,t){var e=this.options;if(t===void 0)return e[n];var a=Sa.modifyOption(this,n,t);typeof a<"u"?e[n]=a:e[n]=t,n==="group"&&il(e)},destroy:function(){nt("destroy",this);var n=this.el;n[lt]=null,_e(n,"mousedown",this._onTapStart),_e(n,"touchstart",this._onTapStart),_e(n,"pointerdown",this._onTapStart),this.nativeDraggable&&(_e(n,"dragover",this),_e(n,"dragenter",this)),Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ti.splice(ti.indexOf(this.el),1),this.el=n=null},_hideClone:function(){if(!Jt){if(nt("hideClone",this),se.eventCanceled)return;J(De,"display","none"),this.options.removeCloneOnHide&&De.parentNode&&De.parentNode.removeChild(De),Jt=!0}},_showClone:function(n){if(n.lastPutMode!=="clone"){this._hideClone();return}if(Jt){if(nt("showClone",this),se.eventCanceled)return;z.parentNode==Te&&!this.options.group.revertClone?Te.insertBefore(De,z):dn?Te.insertBefore(De,dn):Te.appendChild(De),this.options.group.revertClone&&this.animate(z,De),J(De,"display",""),Jt=!1}}};function Qd(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function za(n,t,e,a,i,s,o,r){var l,d=n[lt],c=d.options.onMove,u;return window.CustomEvent&&!Xt&&!wa?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=t,l.from=n,l.dragged=e,l.draggedRect=a,l.related=i||t,l.relatedRect=s||ze(t),l.willInsertAfter=r,l.originalEvent=o,n.dispatchEvent(l),c&&(u=c.call(d,l,o)),u}function ki(n){n.draggable=!1}function Zd(){Wi=!1}function Jd(n,t,e){var a=ze(Rn(e.el,0,e.options,!0)),i=Zo(e.el),s=10;return t?n.clientX<i.left-s||n.clientY<a.top&&n.clientX<a.right:n.clientY<i.top-s||n.clientY<a.bottom&&n.clientX<a.left}function eu(n,t,e){var a=ze(cs(e.el,e.options.draggable)),i=Zo(e.el),s=10;return t?n.clientX>i.right+s||n.clientY>a.bottom&&n.clientX>a.left:n.clientY>i.bottom+s||n.clientX>a.right&&n.clientY>a.top}function tu(n,t,e,a,i,s,o,r){var l=a?n.clientY:n.clientX,d=a?e.height:e.width,c=a?e.top:e.left,u=a?e.bottom:e.right,h=!1;if(!o){if(r&&Ha<d*i){if(!na&&(ta===1?l>c+d*s/2:l<u-d*s/2)&&(na=!0),na)h=!0;else if(ta===1?l<c+Ha:l>u-Ha)return-ta}else if(l>c+d*(1-i)/2&&l<u-d*(1-i)/2)return nu(t)}return h=h||o,h&&(l<c+d*s/2||l>u-d*s/2)?l>c+d/2?1:-1:0}function nu(n){return dt(z)<dt(n)?1:-1}function au(n){for(var t=n.tagName+n.className+n.src+n.href+n.textContent,e=t.length,a=0;e--;)a+=t.charCodeAt(e);return a.toString(36)}function iu(n){ni.length=0;for(var t=n.getElementsByTagName("input"),e=t.length;e--;){var a=t[e];a.checked&&ni.push(a)}}function Va(n){return setTimeout(n,0)}function Yi(n){return clearTimeout(n)}hi&&ye(document,"touchmove",function(n){(se.active||wn)&&n.cancelable&&n.preventDefault()});se.utils={on:ye,off:_e,css:J,find:Qo,is:function(n,t){return!!Et(n,t,n,!1)},extend:Nd,throttle:Jo,closest:Et,toggleClass:st,clone:tl,index:dt,nextTick:Va,cancelNextTick:Yi,detectDirection:al,getChild:Rn};se.get=function(n){return n[lt]};se.mount=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];t[0].constructor===Array&&(t=t[0]),t.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(se.utils=Pt(Pt({},se.utils),a.utils)),Sa.mount(a)})};se.create=function(n,t){return new se(n,t)};se.version=Rd;var Le=[],Kn,Gi,ji=!1,Ai,Ti,ai,Xn;function su(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return n.prototype={dragStarted:function(t){var e=t.originalEvent;this.sortable.nativeDraggable?ye(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ye(document,"pointermove",this._handleFallbackAutoScroll):e.touches?ye(document,"touchmove",this._handleFallbackAutoScroll):ye(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var e=t.originalEvent;!this.options.dragOverBubble&&!e.rootEl&&this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?_e(document,"dragover",this._handleAutoScroll):(_e(document,"pointermove",this._handleFallbackAutoScroll),_e(document,"touchmove",this._handleFallbackAutoScroll),_e(document,"mousemove",this._handleFallbackAutoScroll)),Xs(),Ua(),Hd()},nulling:function(){ai=Gi=Kn=ji=Xn=Ai=Ti=null,Le.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var a=this,i=(t.touches?t.touches[0]:t).clientX,s=(t.touches?t.touches[0]:t).clientY,o=document.elementFromPoint(i,s);if(ai=t,e||this.options.forceAutoScrollFallback||wa||Xt||Zn){Oi(t,this.options,o,e);var r=tn(o,!0);ji&&(!Xn||i!==Ai||s!==Ti)&&(Xn&&Xs(),Xn=setInterval(function(){var l=tn(document.elementFromPoint(i,s),!0);l!==r&&(r=l,Ua()),Oi(t,a.options,l,e)},10),Ai=i,Ti=s)}else{if(!this.options.bubbleScroll||tn(o,!0)===Ot()){Ua();return}Oi(t,this.options,tn(o,!1),!1)}}},Wt(n,{pluginName:"scroll",initializeByDefault:!0})}function Ua(){Le.forEach(function(n){clearInterval(n.pid)}),Le=[]}function Xs(){clearInterval(Xn)}var Oi=Jo(function(n,t,e,a){if(t.scroll){var i=(n.touches?n.touches[0]:n).clientX,s=(n.touches?n.touches[0]:n).clientY,o=t.scrollSensitivity,r=t.scrollSpeed,l=Ot(),d=!1,c;Gi!==e&&(Gi=e,Ua(),Kn=t.scroll,c=t.scrollFn,Kn===!0&&(Kn=tn(e,!0)));var u=0,h=Kn;do{var p=h,f=ze(p),m=f.top,_=f.bottom,S=f.left,k=f.right,A=f.width,x=f.height,O=void 0,C=void 0,P=p.scrollWidth,I=p.scrollHeight,D=J(p),ee=p.scrollLeft,W=p.scrollTop;p===l?(O=A<P&&(D.overflowX==="auto"||D.overflowX==="scroll"||D.overflowX==="visible"),C=x<I&&(D.overflowY==="auto"||D.overflowY==="scroll"||D.overflowY==="visible")):(O=A<P&&(D.overflowX==="auto"||D.overflowX==="scroll"),C=x<I&&(D.overflowY==="auto"||D.overflowY==="scroll"));var U=O&&(Math.abs(k-i)<=o&&ee+A<P)-(Math.abs(S-i)<=o&&!!ee),V=C&&(Math.abs(_-s)<=o&&W+x<I)-(Math.abs(m-s)<=o&&!!W);if(!Le[u])for(var Q=0;Q<=u;Q++)Le[Q]||(Le[Q]={});(Le[u].vx!=U||Le[u].vy!=V||Le[u].el!==p)&&(Le[u].el=p,Le[u].vx=U,Le[u].vy=V,clearInterval(Le[u].pid),(U!=0||V!=0)&&(d=!0,Le[u].pid=setInterval((function(){a&&this.layer===0&&se.active._onTouchMove(ai);var ve=Le[this.layer].vy?Le[this.layer].vy*r:0,ne=Le[this.layer].vx?Le[this.layer].vx*r:0;typeof c=="function"&&c.call(se.dragged.parentNode[lt],ne,ve,n,ai,Le[this.layer].el)!=="continue"||el(Le[this.layer].el,ne,ve)}).bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==l&&(h=tn(h,!1)));ji=d}},30),ll=function(n){var t=n.originalEvent,e=n.putSortable,a=n.dragEl,i=n.activeSortable,s=n.dispatchSortableEvent,o=n.hideGhostForTarget,r=n.unhideGhostForTarget;if(t){var l=e||i;o();var d=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,c=document.elementFromPoint(d.clientX,d.clientY);r(),l&&!l.el.contains(c)&&(s("spill"),this.onSpill({dragEl:a,putSortable:e}))}};function ds(){}ds.prototype={startIndex:null,dragStart:function(n){var t=n.oldDraggableIndex;this.startIndex=t},onSpill:function(n){var t=n.dragEl,e=n.putSortable;this.sortable.captureAnimationState(),e&&e.captureAnimationState();var a=Rn(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(t,a):this.sortable.el.appendChild(t),this.sortable.animateAll(),e&&e.animateAll()},drop:ll};Wt(ds,{pluginName:"revertOnSpill"});function us(){}us.prototype={onSpill:function(n){var t=n.dragEl,e=n.putSortable,a=e||this.sortable;a.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),a.animateAll()},drop:ll};Wt(us,{pluginName:"removeOnSpill"});se.mount(new su);se.mount(us,ds);function ou(n){return n==null?n:JSON.parse(JSON.stringify(n))}function lu(n){Xi()&&Yt(n)}function ru(n){Xi()?je(n):Qe(n)}const qs=Symbol("cloneElement");function cu(...n){var t,e;const a=(t=Xi())==null?void 0:t.proxy,i=n[0];let[,s,o]=n;Array.isArray(v(s))||(o=s,s=null);let r=null;const{immediate:l=!0,clone:d=ou,customUpdate:c}=(e=v(o))!=null?e:{};function u(C){var P;C.item[qs]=d(v((P=v(s))==null?void 0:P[C.oldIndex]))}function h(C){const P=C.item[qs];kd(P)||(wi(C.item),Id(v(s),C.newDraggableIndex,P))}function p(C){const{from:P,item:I,oldIndex:D,oldDraggableIndex:ee,pullMode:W,clone:U}=C;if(W==="clone"){Ns(P,I,D),wi(U);return}Ed(v(s),ee)}function f(C){if(c){c(C);return}const{from:P,item:I,oldIndex:D,newIndex:ee}=C;if(wi(I),Ns(P,I,D),qi(s)){const W=[...v(s)];s.value=Fs(W,D,ee);return}Fs(v(s),D,ee)}const m={onUpdate:f,onStart:u,onAdd:h,onRemove:p};function _(C){const P=v(i);return C||(C=Ad(P)?Td(P,a==null?void 0:a.$el):P),C&&!Pd(C)&&(C=C.$el),C||Sd("Root element not found"),C}function S(){var C;const P=(C=v(o))!=null?C:{},I=Go(P,["immediate","clone"]);return Dd(s===null?{}:m,I)}const k=C=>{C=_(C),r&&A.destroy(),r=new se(C,S())};Ee(()=>o,()=>{r&&Md(S(),(C,P)=>{r==null||r.option(C,P)})},{deep:!0});const A={option:(C,P)=>r==null?void 0:r.option(C,P),destroy:()=>{r==null||r.destroy(),r=null},save:()=>r==null?void 0:r.save(),toArray:()=>r==null?void 0:r.toArray(),closest:(...C)=>r==null?void 0:r.closest(...C)},x=()=>A==null?void 0:A.option("disabled",!0),O=()=>A==null?void 0:A.option("disabled",!1);return ru(()=>{l&&k()}),lu(A.destroy),Sn({start:k,pause:x,resume:O},A)}const Ki=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],du=["animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target","customUpdate",...Ki.map(n=>`on${n.replace(/^\S/,t=>t.toUpperCase())}`)],rl=G({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:du,emits:["update:modelValue",...Ki],setup(n,{slots:t,emit:e,expose:a,attrs:i}){const s=Ki.reduce((c,u)=>{const h=`on${u.replace(/^\S/,p=>p.toUpperCase())}`;return c[h]=p=>e(u,p),c},{}),o=M(()=>{const c=hn(n),u=Go(c,["modelValue"]),h=Object.entries(u).reduce((p,[f,m])=>{const _=v(m);return _!==void 0&&(p[f]=_),p},{});return Sn(Sn({},s),xd(Sn(Sn({},i),h)))}),r=M({get:()=>n.modelValue,set:c=>e("update:modelValue",c)}),l=y(),d=gt(cu(n.target||l,r,o));return a(d),()=>{if(t.default)return Il(n.tag||"div",{ref:l},t.default(d))}}});var qt=(n=>(n.EDIT="edit",n.Delete="delete",n.Drag="drag",n))(qt||{});const uu=n=>(Qi("data-v-06cab8f2"),n=n(),Zi(),n),vu=uu(()=>b("span",{class:"layer-color-dot-wrapper"},[b("span",{class:"layer-color-dot"})],-1)),pu={class:"icon-wrapper"},hu=G({__name:"LayerItem",props:{layerItemData:{},isEdit:{type:Boolean}},emits:["selectItem"],setup(n,{emit:t}){const e=R(rs),a=R(Ze),{t:i}=fe(),s=n,o=M(()=>a.uiState.currentLayer??"blue"),r=M(()=>[{id:qt.EDIT,icon:"canvas-opt-layer-edit",iconSize:"22",isEdit:!s.isEdit},{id:qt.Delete,icon:"canvas-opt-layer-delete",iconSize:"18",isEdit:s.isEdit},{id:qt.Drag,icon:"canvas-opt-layer-drag",iconSize:"18",isEdit:s.isEdit}]);function l(c){const u=rr(c),h=u.toRgbString(),p=u.alpha(.3).toRgbString(),f=u.alpha(.06).toRgbString();return`
      --layer-color: ${h};
      --layer-active-color: ${p};
      --layer-active-bg-color: ${f};
    `}const d=c=>{var u;switch(c){case qt.EDIT:ce.modal.showRenameModal({title:i("mobile.editor.layer_multi_canvas.rename_layer"),name:(u=s.layerItemData.label)==null?void 0:u.replace("{layer}",i("editor.layer.layer")).replace(`${ws[s.layerItemData.key]}`,i(`${Ss[s.layerItemData.key]}`)),confirmTxt:i("mobile.editor.layer_multi_canvas.confirm"),maxLength:20,onConfirm:h=>{e.sendEvent(new oa(Tt.rename,s.layerItemData,h))}});break;case qt.Delete:ce.modal.showTipModal({haveIcon:!1,iconName:"",title:i("mobile.editor.layer_multi_canvas.delete_layer_title"),content:i("mobile.editor.layer_multi_canvas.delete_layer"),hasCancel:!0,confirmTxt:i("mobile.editor.layer_multi_canvas.confirm"),cancelTxt:i("mobile.editor.layer_multi_canvas.cancel"),onConfirm:()=>{e.sendEvent(new oa(Tt.delete,s.layerItemData))},onCancel:()=>{}});break;case qt.Drag:break}};return(c,u)=>{var h;return g(),T("div",{class:oe({"layer-item-wrapper":!0,"layer-item-wrapper-selected":c.layerItemData.key===o.value,"layer-item-wrapper-not-selected":c.layerItemData.key!==o.value}),style:qe(l(c.layerItemData.color))},[vu,b("span",{class:oe(["layer-label",{"layer-label_in_edit":c.isEdit}])},N((h=c.layerItemData.label)==null?void 0:h.replace("{layer}",v(i)("editor.layer.layer")).replace(`${v(ws)[c.layerItemData.key]}`,v(i)(`${v(Ss)[c.layerItemData.key]}`))),3),b("section",pu,[(g(!0),T(Se,null,Pe(r.value,p=>Oe((g(),j(v(Ce),{key:p.id,class:oe([p.id!==v(qt).Drag?"opt-btn":"",`f-s-${p.iconSize}`]),name:p.icon,size:`${p.iconSize}px`,color:"#545458",onTouchend:f=>d(p.id)},null,8,["class","name","size","onTouchend"])),[[Fe,p.isEdit]])),128))])],6)}}}),mu=ae(hu,[["__scopeId","data-v-06cab8f2"]]),fu=["id","onClick"],gu=["onClick"],bu=G({__name:"Index",props:{isEdit:{type:Boolean,default:!1}},setup(n){const t=n,{t:e}=fe(),a=y(!0),i=y(!0),s=y(["#287CF6"]),o=R(Ze),r=R(rs),l=y(io([]));ie(()=>o.uiState.treeData,D=>{l.value=D});const d=y(!1),c=y(!1),u=y(null),h=y(!1),p=y(!1),f=y(0),m=()=>{setTimeout(()=>{c.value=!0},500)},_=()=>{c.value=!1,f.value=0},S=()=>{h.value=!0,p.value=!1},k=()=>{h.value=!1,p.value=!0},A=D=>{d.value=!0,Qe(()=>{D.item.classList.remove("sortable-drag"),D.item.classList.remove("sortable-chosen"),D.item.classList.remove("sortable-ghost"),u.value.forEach(ee=>{ee.close()})}),setTimeout(()=>{c.value&&(setTimeout(()=>{p.value=!1},800),h.value||p.value)},500)},x=()=>{d.value=!1},O=D=>{d.value=!0,f.value++,D.dragged.classList.add("sortable-chosen"),f.value===1&&window.MeApi.openNative.generateImpactFeedback()},C=D=>{console.log("dragEnd",D),a.value=!1,Qe(()=>{a.value=!0,l.value.findLast(W=>W.key===D.item.id).order!==l.value.length-D.newIndex&&r.sendEvent(new Bo(D.item.id,l.value.length-D.newIndex))})},P=D=>{t.isEdit||r.sendEvent(new oa(Tt.change,D))},I=D=>{ce.modal.showTipModal({haveIcon:!1,iconName:"",title:e("mobile.editor.layer_multi_canvas.delete_layer_title"),content:e("mobile.editor.layer_multi_canvas.delete_layer"),hasCancel:!0,confirmTxt:e("mobile.editor.layer_multi_canvas.confirm"),cancelTxt:e("mobile.editor.layer_multi_canvas.cancel"),onConfirm:()=>{r.sendEvent(new oa(Tt.delete,D))},onCancel:()=>{}})};return(D,ee)=>{const W=Wr;return g(),T("div",{class:oe(["drag-layer-container",{"drag-layer-container_edit":n.isEdit}])},[a.value?(g(),j(v(rl),{key:0,modelValue:l.value,"onUpdate:modelValue":ee[0]||(ee[0]=U=>l.value=U),class:"drag-wrapper",direction:"vertical",delay:200,animation:520,sort:i.value,"prevent-on-filter":!0,filter:n.isEdit?".layer-label":"",onEnd:C,onMove:O,onChoose:A,onUnchoose:x,onTouchstart:m,onTouchend:_},{default:B(()=>[(g(!0),T(Se,null,Pe(l.value,U=>(g(),T("div",{id:U.key,key:U.key,class:"layer-item",onClick:V=>P(U)},[w(W,{ref_for:!0,ref_key:"cellRef",ref:u,disabled:d.value,onOpen:S,onClose:k},{right:B(()=>[b("div",{class:"opt-btn",onClick:rt(V=>I(U),["stop"])},[w(v(wt),{name:"canvas-opt-layer-delete",size:"22px",class:"f-s-22",color:"#F7F9FB"})],8,gu)]),default:B(()=>[w(mu,{"selected-key":s.value,"layer-item-data":U,"is-edit":n.isEdit},null,8,["selected-key","layer-item-data","is-edit"])]),_:2},1032,["disabled"])],8,fu))),128))]),_:1},8,["modelValue","sort","filter"])):le("",!0)],2)}}}),_u=ae(bu,[["__scopeId","data-v-715cdf4d"]]),yu={class:"layer-panel"},wu={class:"content-wrap"},Su={key:0,class:"empty"},Cu={key:1,class:"layer-container"},xu=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const e=t,a=y(!1),i=y(!1),{t:s}=fe(),o=R(Ze),r=y(io([]));ie(()=>o.uiState.treeData,h=>{r.value=h});const l=M(()=>r.value.length>0),d=()=>{i.value=!i.value},c=()=>{a.value=!1,e("close")},u=()=>{a.value=!1,e("close")};return je(()=>{a.value=!0}),(h,p)=>{const f=ba;return g(),T("div",yu,[w(f,{show:a.value,"onUpdate:show":p[0]||(p[0]=m=>a.value=m),position:"bottom",round:"",overlay:!0,"overlay-style":{background:"transparent"},class:"layer-popup",onClickOverlay:u},{default:B(()=>[b("div",{class:oe(["title-wrap",{"title-wrap_not":!l.value}])},[Oe(w(v(Ce),{name:"canvas-opt-layer-close",size:"24px",class:"f-s-24",color:"#1A1A1E",onClick:c},null,512),[[Fe,!i.value||!l.value]]),b("span",{class:oe(["title",{title_not:!l.value,title_no_edit:!i.value}])},N(h.$t("mobile.editor.panel.main.layer")),3),Oe(w(v(Ce),{name:"canvas-opt-layer-edit-switch",size:"24px",class:"f-s-24",color:"#1A1A1E",onClick:d},null,512),[[Fe,l.value&&!i.value]]),Oe(w(v(Ce),{name:"canvas-opt-layer-done",size:"24px",class:"f-s-24",onClick:d},null,512),[[Fe,l.value&&i.value]])],2),b("div",wu,[r.value.length===0?(g(),T("div",Su,N(v(s)("editor.layer.no_layer_yet")),1)):(g(),T("div",Cu,[w(v(_u),{"is-edit":i.value},null,8,["is-edit"])]))])]),_:1},8,["show"])])}}}),Eu=ae(xu,[["__scopeId","data-v-8f5324cf"]]);var qn=(n=>(n.EDIT="edit",n.Delete="delete",n))(qn||{});const Iu={class:"canvas-item"},ku={class:"snapshot"},Au=G({__name:"Index",props:{isEdit:{},canvas:{},enableDelete:{}},setup(n){const{t}=fe(),e=R(_o),a=n,i=y(!1);ie(()=>e.uiState.currentId,d=>{i.value=d===a.canvas.id});const s=d=>{switch(d){case qn.EDIT:ce.modal.showRenameModal({title:t("mobile.editor.layer_multi_canvas.rename_canvas"),name:a.canvas.title.replace("{panel}",t("canvas.panel")),confirmTxt:t("mobile.editor.layer_multi_canvas.confirm"),maxLength:20,onConfirm:c=>{o(c)}});break;case qn.Delete:ce.modal.showTipModal({haveIcon:!1,iconName:"",title:t("mobile.editor.layer_multi_canvas.delete_canvas_title"),content:t("mobile.editor.layer_multi_canvas.delete_canvas"),hasCancel:!0,confirmTxt:t("mobile.editor.layer_multi_canvas.delete"),cancelTxt:t("mobile.editor.layer_multi_canvas.cancel"),onConfirm:()=>{e.sendEvent(new Qr(a.canvas.id))},onCancel:()=>{}});break}},o=d=>{e.sendEvent(new Zr(a.canvas.id,d))};je(()=>{l(a.canvas.img)}),Ee(()=>(a==null?void 0:a.canvas.img)??void 0,d=>{l(d)});const r=y(),l=d=>{var u,h,p,f;const c=(d==null?void 0:d.canvas)??void 0;if(c&&r.value){(u=r.value)!=null&&u.innerHTML&&(r.value.innerHTML=""),(h=r.value)==null||h.appendChild(c);const{width:m,height:_}=cr(c.width/2,c.height/2,((p=r.value)==null?void 0:p.clientWidth)??0,((f=r.value)==null?void 0:f.clientHeight)??0);c.style.width=`${m}px`,c.style.height=`${_}px`}};return(d,c)=>(g(),T("section",Iu,[b("div",{class:oe(["focus-wrap",{"focus-wrap_selected":i.value}])},[b("div",ku,[b("div",{ref_key:"canvasPreviewWrapper",ref:r,class:"snapshot-img"},null,512)]),b("label",{class:oe(["label-name",{"label-name_edit":d.isEdit}])},N(d.canvas.title.replace("{panel}",v(t)("canvas.panel"))),3),Oe(w(v(Ce),{class:"opt-btn f-s-22",name:"canvas-opt-layer-delete",size:"22px",color:"#545458",onClick:c[0]||(c[0]=u=>s(v(qn).Delete))},null,512),[[Fe,d.isEdit&&d.enableDelete]]),Oe(w(v(Ce),{name:"canvas-opt-layer-edit",class:"opt-btn f-s-22",size:"22px",color:"#545458",onClick:c[1]||(c[1]=u=>s(v(qn).EDIT))},null,512),[[Fe,d.isEdit]])],2)]))}}),Tu=ae(Au,[["__scopeId","data-v-9b6903cd"]]),Ou={class:"multi-canvas-panel"},Du={class:"title-wrap"},Pu=["id","onClick"],Mu=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const e=y(!1),a=y(!1),i=R(_o),s=y([]),o=y(!0),r=y(!0),l=y(0),d=t,c=()=>{l.value=0},u=O=>{Qe(()=>{O.item.classList.remove("sortable-chosen")})},h=O=>{O.dragged.classList.add("sortable-chosen"),l.value++,l.value===1&&window.MeApi.openNative.generateImpactFeedback()},p=O=>{r.value=!1,Qe(()=>{r.value=!0,i.sendEvent(new Jr(O.oldIndex,O.newIndex))})},f=O=>{a.value||i.uiState.currentId!==O.id&&i.sendEvent(new ec(O.id))},m=y(!0);ie(()=>i.uiState.cnvIdentities,O=>{s.value=O,m.value=O.length<10});const _=()=>{a.value=!a.value},S=()=>{i.sendEvent(new tc)},k=()=>{a.value=!a.value},A=()=>{e.value=!1,d("close")};je(()=>{e.value=!0});let x;return Ee(()=>i.uiState.onChangeCanvas,O=>{O?x=ce.modal.showToast({duration:0,forbidClick:!0,msg:"mobile.material.loading_text",icon:"loading",layout:"vertical"}):x&&(x==null||x.close())}),(O,C)=>{const P=ba;return g(),T("div",Ou,[w(P,{show:e.value,"onUpdate:show":C[2]||(C[2]=I=>e.value=I),position:"bottom",round:"",overlay:!0,"overlay-style":{background:"transparent"},class:"multi-canvas-popup",onClickOverlay:A},{default:B(()=>[b("div",Du,[Oe(w(v(Ce),{name:"canvas-opt-layer-close",size:"24px",class:"f-s-24",color:"#1A1A1E",onClick:C[0]||(C[0]=I=>e.value=!1)},null,512),[[Fe,!a.value]]),b("span",{class:oe(["title",{title_no_edit:!a.value}])},N(O.$t("mobile.editor.panel.main.canvas")),3),Oe(w(v(Ce),{name:"canvas-opt-layer-edit-switch",size:"24px",class:"f-s-24",color:"#1A1A1E",onClick:_},null,512),[[Fe,!a.value]]),Oe(w(v(Ce),{name:"canvas-opt-multi-canvas-add",size:"24px",class:oe(["f-s-24",{"canvas-add__disabled":!m.value}]),color:"#1A1A1E",onClick:S},null,8,["class"]),[[Fe,!a.value]]),Oe(b("span",{class:"done",onClick:k},N(O.$t("mobile.editor.panel.edit_canvas.done")),513),[[Fe,a.value]])]),b("div",{class:oe(["content-wrap",{"content-wrap_edit":a.value}])},[r.value?(g(),j(v(rl),{key:0,modelValue:s.value,"onUpdate:modelValue":C[1]||(C[1]=I=>s.value=I),direction:"vertical",delay:100,animation:520,filter:".opt-btn","prevent-on-filter":!0,handle:".canvas-container",sort:o.value,onEnd:p,onMove:h,onChoose:u,onTouchend:c},{default:B(()=>[(g(!0),T(Se,null,Pe(s.value,I=>(g(),T("div",{id:I.id,key:I.id,class:"canvas-container",onClick:D=>f(I)},[w(v(Tu),{canvas:I,selected:!1,"is-edit":a.value,"enable-delete":s.value.length>1},null,8,["canvas","is-edit","enable-delete"])],8,Pu))),128))]),_:1},8,["modelValue","filter","handle","sort"])):le("",!0)],2)]),_:1},8,["show"])])}}}),Bu=ae(Mu,[["__scopeId","data-v-9945fff9"]]),Lu=G({__name:"SliderButton",props:{value:{type:Number,default:0},show:{type:Boolean,default:!1}},emits:["update:show"],setup(n,{emit:t}){const e=t,a=()=>{e("update:show",!0)},i=()=>{e("update:show",!1)};return(s,o)=>(g(),T("div",{class:oe(["slider-custom-button",n.show?"selected-button":""]),onTouchstart:a,onTouchend:i},[Oe(b("div",{class:"custom-popover-tooltip"},N(n.value),513),[[Fe,n.show]])],34))}}),Di=ae(Lu,[["__scopeId","data-v-fe418248"]]),zu={class:"slider-section"},Ru={key:0,class:"slider-label"},$u={class:"slider-box"},Fu={key:1},Nu=G({__name:"SliderTips",props:{value:{type:[Number,Array],default:0},label:{type:String,default:""},barHeight:{type:Number,default:4},activeColor:{type:String,default:"#28BE44"},inactiveColor:{type:String,default:"#D9D9DE"},disabled:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},range:{type:Boolean,default:!1},gapValue:{type:String,default:""},attrs:{type:Object,default:()=>{}},sync:{type:Boolean,default:!1}},emits:["update:value","change","trigger"],setup(n,{emit:t}){const e=n,{value:a,min:i,max:s,range:o,attrs:r,disabled:l,sync:d}=hn(e),c=t,u=M({get(){return a.value},set(ne){d.value?f(ne):c("update:value",ne)}}),h=M(()=>{var ne;return((ne=r.value)==null?void 0:ne.step)||1}),p=M(()=>{var ne;return((ne=r.value)==null?void 0:ne.fractionDigits)||1}),f=ne=>{c("change",ne),m()},m=()=>{D.value=!1,ee.value=!1,W.value=!1},_=y(!1),S=i.value,k=s.value,A=y([]),x=()=>{l.value||(I.value?A.value=[C.value(0),C.value(1)]:A.value=[O.value],_.value=!0)},O=M(()=>gt({type:"number",value:u.value,attrs:{min:S,max:k,step:h.value,showValRange:!0,valueWidth:"100px",fractionDigits:p.value,keyboardAttrs:{extraKey:S<0?["-","."]:["."]},onChange:re=>{u.value=re,P(re)},...r.value}})),C=M(()=>ne=>gt({type:"number",value:u.value[ne],attrs:{min:S,max:k,step:h.value,fractionDigits:p.value,showValRange:!0,valueWidth:"100px",keyboardAttrs:{extraKey:S<0?["-","."]:["."]},onChange:ke=>{u.value[ne]=ke,f(u.value)},...r.value}})),P=ne=>{f(ne)},I=M(()=>o.value&&Array.isArray(u.value)),D=y(!1),ee=y(!1),W=y(!1),U=()=>{window.MeApi.openNative.generateImpactFeedback()},V=()=>{m()},Q=M(()=>I.value&&Array.isArray(u.value)?u.value.join(","):u.value),ve=ne=>{if(I.value){const re=a.value;ee.value=ne[0]!==re[0],W.value=ne[1]!==re[1]}else D.value=!0;c("trigger")};return je(()=>{m()}),(ne,re)=>{const ke=Yr,Ae=ro,Be=Ce,Ue=is,ue=po;return g(),T("div",zu,[n.label?(g(),T("div",Ru,N(n.label),1)):le("",!0),w(ue,{class:"slider-wrapper"},{title:B(()=>[b("div",$u,[w(ke,{modelValue:u.value,"onUpdate:modelValue":[re[3]||(re[3]=me=>u.value=me),ve],range:I.value,min:v(i),max:v(s),step:h.value,disabled:v(l),"bar-height":n.barHeight,"active-color":n.activeColor,"inactive-color":n.inactiveColor,onChange:f,onDragStart:U,onDragEnd:V},ao({_:2},[I.value?void 0:{name:"button",fn:B(({value:me})=>[w(Di,{show:D.value,"onUpdate:show":re[0]||(re[0]=Ne=>D.value=Ne),value:me},null,8,["show","value"])]),key:"0"},I.value?{name:"left-button",fn:B(({value:me})=>[w(Di,{show:ee.value,"onUpdate:show":re[1]||(re[1]=Ne=>ee.value=Ne),value:me},null,8,["show","value"])]),key:"1"}:void 0,I.value?{name:"right-button",fn:B(({value:me})=>[w(Di,{show:W.value,"onUpdate:show":re[2]||(re[2]=Ne=>W.value=Ne),value:me},null,8,["show","value"])]),key:"2"}:void 0]),1032,["modelValue","range","min","max","step","disabled","bar-height","active-color","inactive-color"])])]),value:B(()=>[b("div",null,[b("div",{class:oe(["slider-value",{"input-disabled":v(l)}])},[n.gapValue?(g(),T("div",{key:0,class:"slider-input",onClick:rt(x,["stop"])},N(n.gapValue),1)):(g(),T("div",Fu,[I.value?(g(),T("div",{key:1,class:"slider-input",onClick:rt(x,["stop"])},N(Q.value),1)):(g(),j(Ae,mn({key:0,class:"slider-input",min:v(i),max:v(s),"model-value":u.value,readonly:""},v(r),{onClick:rt(x,["stop"])}),null,16,["min","max","model-value"]))])),w(Be,{name:"arrow_down",size:"16px",class:"f-s-16 arrow_down_icon",color:v(l)?"#B0B2B5":"#545458"},null,8,["color"])],2),w(Ue,{show:_.value,"onUpdate:show":re[4]||(re[4]=me=>_.value=me),"focus-index":0,title:e.label,inputs:A.value,range:I.value},null,8,["show","title","inputs","range"])])]),_:1})])}}}),Ct=ae(Nu,[["__scopeId","data-v-f87fa308"]]),Hu={class:"panel-card-wrapper"},Vu={class:"card-comtainer"},Uu=["title","name"],Wu={class:"panel-desc"},Yu={class:"card-list"},Gu={class:"family-label text-ellipsis"},ju=G({__name:"FontList",props:{show:{type:Boolean,default:!1}},emits:["onBack"],setup(n,{emit:t}){const e=n,a=R(ls),i=R(Ze),s=R(Hn),o=M(()=>[ft(a.uiState.buildIn),ft(a.uiState.system)]);Wa(()=>{e.show&&h()});const r=M(()=>i.uiState.currentFontFamily),l=p=>{const{fontFamily:f="",fontSource:m=""}=JSON.parse(p.value);return f===r.value.fontFamily&&m===r.value.fontSource},d=p=>{s.sendEvent(new Vi(p.value))},c=t,u=()=>{c("onBack")},h=()=>{Qe(()=>{let p=document.getElementsByClassName("is-selected")[0];p==null||p.scrollIntoView({behavior:"smooth",block:"center"})})};return(p,f)=>{const m=Ce,_=ga,S=ho,k=mo;return g(),T("div",Hu,[w(_,{class:"panel-card-nav",title:p.$t("editor.display.font_family")},{left:B(()=>[w(m,{name:"arrow_left_dark",size:"24px",class:"f-s-24",onClick:u})]),_:1},8,["title"]),b("div",Vu,[(g(!0),T(Se,null,Pe(o.value,A=>(g(),T("div",{key:A.value,title:A.label,name:A.value},[b("div",Wu,N(p.$t(A.label)),1),b("div",Yu,[w(k,{gutter:8,"column-num":3},{default:B(()=>[(g(!0),T(Se,null,Pe(A.children,x=>(g(),j(S,{key:x.key,class:oe(["card-grid-item",{"is-selected":l(x),[x.postscriptName]:!0}]),style:qe(`font-family: ${x.postscriptName??"unset"}`),onClick:O=>d(x)},{default:B(()=>[b("span",Gu,N(x.label),1)]),_:2},1032,["class","style","onClick"]))),128))]),_:2},1024)])],8,Uu))),128))])])}}}),Ku=ae(ju,[["__scopeId","data-v-ed1ba28f"]]),Xu={class:"panel-card-wrapper"},qu={class:"card-comtainer"},Qu={class:"card-list"},Zu={class:"style-label text-ellipsis"},Ju=G({__name:"FamilyStyle",emits:["onBack"],setup(n,{emit:t}){const e=d=>{o.value=d},a=R(ls),i=R(Hn),s=M(()=>a.uiState.subFontFamily.map(d=>d.label)),o=M({get:()=>i.uiState.fontSubfamily.length===1?ft(i.uiState.fontSubfamily[0]):"",set:d=>{const c=Ut.createTextEvent(Ve.fontSubfamily,d);i.sendEvent(c)}}),r=t,l=()=>{r("onBack")};return(d,c)=>{const u=Ce,h=ga,p=ho,f=mo;return g(),T("div",Xu,[w(h,{class:"panel-card-nav",title:d.$t("editor.display.font_style")},{left:B(()=>[w(u,{name:"arrow_left_dark",size:"24px",class:"f-s-24",onClick:l})]),_:1},8,["title"]),b("div",qu,[b("div",Qu,[w(f,{gutter:8,"column-num":3},{default:B(()=>[(g(!0),T(Se,null,Pe(s.value,m=>(g(),j(p,{key:m,class:oe(["card-grid-item",{"is-selected":m===o.value}]),onClick:_=>e(m)},{default:B(()=>[b("span",Zu,N(m),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})])])])}}}),ev=ae(Ju,[["__scopeId","data-v-e4459123"]]),tv={class:"font-style-wrapper"},nv={class:"custom-cell-title"},av=G({__name:"FontStyle",setup(n){const{t}=fe(),e=`${t("editor.display.size")}(pt)`,a=R(Hn),i=y(),s=y(),o=t("common.input-multi-state"),r=gt({fractionDigits:0,keyboardAttrs:{extraKey:""}});ie(()=>ft(a.uiState.fontSize),x=>{if(console.log("00000000000000000",x[0]),x.length===1)s.value="",i.value=Math.min(x[0]??72,3e3);else{const O=[...new Set(x)];O.length>1?(s.value=o,i.value=1):i.value=O[0]}});const l=x=>{x=Math.min(x,3e3),x=Math.max(x,1),a.sendEvent(new Ut(Ve.fontSize,Number(x.toFixed(2))))},d=M(()=>{const x=a.uiState.fontSource,O=a.uiState.fontFamily,C=a.uiState.fontSubfamily,P=u(O),I=u(C);return x.length===1&&O.length===1?{fontFamily:O[0],fontSource:x[0],fontName:a.uiState.fontName,fontSubfamily:I.length>1?[o]:I}:{fontFamily:"",fontSource:"",fontName:P.length>1?o:P[0],fontSubfamily:I.length>1?[o]:I}}),c=M(()=>d.value.fontName===o),u=x=>Array.isArray(x)?[...new Set(x)]:[],h=M(()=>[{id:"typeface",title:t("editor.display.font_family"),value:d.value.fontName,onClick:k},{id:"style",title:t("editor.display.font_style"),value:d.value.fontSubfamily[0],onClick:c.value?()=>{}:k}]),p=R(ls),f=y(d.value.fontSubfamily),m=y([]);ie(()=>p.uiState.subFontFamily,x=>{console.log(x," subFontFamily...."),m.value=ft(x)});const _=y(!1),S=y(!1),k=x=>{x==="typeface"?_.value=!0:S.value=!0},A=()=>{_.value=!1,S.value=!1};return(x,O)=>{const C=Ce,P=po,I=Kt;return g(),T(Se,null,[Oe(b("div",tv,[(g(!0),T(Se,null,Pe(h.value,(D,ee)=>(g(),j(I,{key:ee,border:!1,class:"setting-group"},{default:B(()=>[(g(),j(P,{key:D.id,class:oe(["setting-cell",{"disabled-cell":c.value&&D.id==="style"}]),"is-link":"",center:"",value:D.value,onClick:W=>D.onClick&&D.onClick(D.id)},{title:B(()=>[b("div",nv,[b("span",null,N(D.title),1)])]),"right-icon":B(()=>[w(C,{class:"arrow_right f-s-22",name:"arrow_right",size:"22px"})]),_:2},1032,["class","value","onClick"]))]),_:2},1024))),128)),w(v(Ct),{value:i.value,"onUpdate:value":O[0]||(O[0]=D=>i.value=D),class:"slider-cell",label:e,max:3e3,min:1,"gap-value":s.value,attrs:r,onChange:l},null,8,["value","gap-value","attrs"])],512),[[Fe,!(_.value||S.value)]]),Oe(w(Ku,{show:_.value,onOnBack:A},null,8,["show"]),[[Fe,_.value]]),Oe(w(ev,{value:f.value,options:m.value,onOnBack:A},null,8,["value","options"]),[[Fe,S.value]])],64)}}}),iv=ae(av,[["__scopeId","data-v-94f30322"]]),sv={class:"font-align-wrapper"},ov=G({__name:"FontSpace",setup(n){const{t}=fe(),e=R(Hn),a=y(-20),i=y(100),s=t("editor.display.line_leading"),o=t("editor.display.letter_spacing"),r=y(),l=y(),d=t("common.input-multi-state");ie(()=>e.uiState.leading,f=>{if(console.log("context===",f),f.length===1)l.value="",r.value=f[0];else{const m=Cs(f);m.value.length>1?(l.value=d,r.value=a.value):(l.value="",u.value=m[0])}});const c=f=>{f=Math.min(f,i.value),f=Math.max(f,a.value),e.sendEvent(new Ut(Ve.leading,Number(f.toFixed(2))))},u=y(),h=y();ie(()=>e.uiState.letterSpacing,f=>{if(f.length===1)h.value="",u.value=f[0];else{const m=Cs(f);m.value.length>1?(h.value=d,u.value=a.value):(h.value="",u.value=m[0])}});const p=f=>{f=Math.min(f,i.value),f=Math.max(f,a.value),e.sendEvent(new Ut(Ve.letterSpacing,Number(f.toFixed(2))))};return(f,m)=>(g(),T("div",sv,[w(v(Ct),{value:r.value,"onUpdate:value":m[0]||(m[0]=_=>r.value=_),min:a.value,max:i.value,label:v(s),"gap-value":l.value,onChange:c},null,8,["value","min","max","label","gap-value"]),w(v(Ct),{value:u.value,"onUpdate:value":m[1]||(m[1]=_=>u.value=_),min:a.value,max:i.value,label:v(o),"gap-value":h.value,onChange:p},null,8,["value","min","max","label","gap-value"])]))}}),lv=ae(ov,[["__scopeId","data-v-25d6b4e3"]]),rv={class:"font-align-wrapper"},cv={class:"align-list"},dv=["data-value","onClick"],uv=G({__name:"FontAlign",setup(n){const{t}=fe(),e=y([{value:"left",label:t("editor.display.text_align_left"),icon:"edit-font-tool-align-left"},{value:"center",label:t("editor.display.text_align_middle"),icon:"edit-font-tool-align-center"},{value:"right",label:t("editor.display.text_align_right"),icon:"edit-font-tool-align-right"}]),a=R(Hn),i=M(()=>a.uiState.alignType.length===1?a.uiState.alignType[0]:""),s=d=>{a.sendEvent(Ut.createTextEvent("align",d))},o=y(),r=y(!1),l=as(d=>{var c;d.target&&(o.value=(c=d.target)==null?void 0:c.attributes["data-value"].value,r.value=d.detail)});return(d,c)=>{const u=Ce,h=ri("x-tooltip");return g(),T("div",rv,[b("div",cv,[(g(!0),T(Se,null,Pe(e.value,p=>Oe((g(),T("div",{key:p.value,"data-value":p.value,class:oe(["align-item",p.value===i.value||o.value===p.value&&r.value?"is-selected":""]),onClick:f=>s(p.value),onLongpress:c[0]||(c[0]=(...f)=>v(l)&&v(l)(...f))},[w(u,{name:p.icon,size:"24px",class:"f-s-24"},null,8,["name"])],42,dv)),[[h,{content:v(t)(p.label),placement:"top",pressTime:500,distance:10}]])),128))])])}}}),vv=ae(uv,[["__scopeId","data-v-b987978b"]]),pv={key:0,class:"tabs-icon tabs-left"},hv={key:0},mv={key:1},fv={key:0,class:"tab-title"},gv={key:1,class:"tab-title"},bv={class:"tabs-icon tabs-right"},_v=G({__name:"EditTabs",props:{active:{},hideIcon:{type:Boolean},showBack:{type:Boolean},confirmButtonDisabled:{type:Boolean},showTips:{type:Boolean},list:{}},emits:["update:active","onConfirm","onCancel"],setup(n,{emit:t}){const{t:e}=fe(),a=n,{active:i,confirmButtonDisabled:s}=hn(a),o=y();Wa(()=>{o.value=i.value});const r=t,l=()=>{r("update:active",o.value)},d=()=>{s.value||r("onConfirm")},c=()=>{r("onCancel")};return(u,h)=>{const p=Ce,f=di,m=ui,_=ri("x-tooltip");return g(),j(m,mn({active:o.value,"onUpdate:active":h[0]||(h[0]=S=>o.value=S),type:"card",class:"tabs-wrapper"},u.$attrs,{onChange:l}),{"nav-left":B(()=>[u.hideIcon?le("",!0):(g(),T("div",pv,[w(p,{name:"close",size:"24px",class:"f-s-24",onClick:c})])),u.hideIcon&&u.showBack?(g(),j(p,{key:1,name:"basic_back",size:"24px",class:"f-s-24 basic-back",onClick:c})):le("",!0)]),"nav-right":B(()=>[Oe(b("div",bv,[w(p,{class:oe([{"disabled-icon":v(s)},"f-s-24"]),name:"checkmark",size:"24px",onClick:d},null,8,["class"])],512),[[Fe,!u.hideIcon]])]),default:B(()=>[u.$slots.default?(g(),T("div",hv,[aa(u.$slots,"default",{},void 0,!0)])):(g(),T("div",mv,[(g(!0),T(Se,null,Pe(u.list,S=>(g(),j(f,{key:S.id,name:S.id},{title:B(()=>[u.showTips?Oe((g(),T("div",gv,[w(p,{name:S.icon,size:"24px",class:"f-s-24"},null,8,["name"])])),[[_,{content:v(e)(S.name),placement:"top",pressTime:500,distance:20}]]):(g(),T("div",fv,[w(p,{name:S.icon,size:"24px",class:"f-s-24"},null,8,["name"])]))]),default:B(()=>[S.cmp?(g(),j(it(S.cmp),{key:0,value:S.options,label:S.label},null,8,["value","label"])):le("",!0)]),_:2},1032,["name"]))),128))]))]),_:3},16,["active"])}}}),Ca=ae(_v,[["__scopeId","data-v-e95a7be2"]]),yv={class:"image-ed-wrapper"},wv=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const{t:e}=fe(),a=nn([{id:"fontStyle",icon:"edit-font-tool-text",title:"",name:e("editor.display.text_setting"),desc:"",options:{},label:"",cmp:iv},{id:"fontSpace",icon:"edit-font-tool-space",title:"",name:e("mobile.editor.font_spacing"),desc:"",options:{},label:"",cmp:lv},{id:"fontAlign",icon:"edit-font-tool-align",title:"",name:e("editor.display.text_align"),desc:"",options:{},label:"",cmp:vv}]),i=y(a.value[0].id),s=t,o=()=>{s("close")};return(r,l)=>{const d=Kt;return g(),T("div",yv,[w(d,{border:!1},{default:B(()=>[w(v(Ca),{active:i.value,"onUpdate:active":l[0]||(l[0]=c=>i.value=c),list:a.value,"hide-icon":!0,"show-back":!0,"show-tips":!0,onOnCancel:o},null,8,["active","list"])]),_:1})])}}}),Sv={class:"notice-box"},Cv={class:"notice-title"},xv={class:"notice-content"},Ev=G({__name:"NoticeBox",props:{title:{type:String,default:""},desc:{type:String,default:""}},setup(n){return(t,e)=>(g(),T("div",Sv,[b("div",Cv,N(n.title),1),b("div",xv,N(n.desc),1)]))}}),vs=ae(Ev,[["__scopeId","data-v-f687938c"]]),Iv={class:"cutter-wrapper"},kv=G({__name:"Cutter",setup(n){const{t}=fe();return(e,a)=>(g(),T("div",Iv,[w(vs,{title:v(t)("editor.image_process.tool_cutter"),desc:v(t)("editor.image_process.tool_cutter_desc")},null,8,["title","desc"])]))}}),Av=ae(kv,[["__scopeId","data-v-85c22f38"]]),Tv="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKuSURBVHgB7d3rTRwxFIbhs1EK2BJSAiVAJ3SQEnAHSQchFVDCpoOkgyEVJB182GJGOlyWHXt8O57vlSz+MPZZHiQWZiREGGOMMcYYY4wxxhhjxQJw59fJr8mvB7+uhNXNf9GPM8J73Qmr0wzxGx9HkNKthCBI6SIhCFKqRAiC5G4jBEFylQmCIFvLDEGQ1ApBECS2BIjJL4e4CHKpRIgv87W3iIsg59oCofYgyNZyQKi9CJJaTgi1J0FiKwGh9ibI2kpCqDMIcqkaEOosgpyrJoQ6kyCvawGhzibIUksINQNBeoBQs+wXpCcINdP+QHqEULPtB6RnCDXj+CAWINSs44JYglAzjwdiEWJpKBDLEEtDgIwAsWQaJAHiX68QSyZBkP4Uxw/pvASQa2kVtj9OMxrId2kR8j3XZAHErXwtJ6kd8j9g1i2In+0Kzz/j+nsdBSDavJAVRUKErqVWSHv7OkV8fjcgiIdwUisk/h4xryniuuYgGBFCXW8GBCNDqH26B8EeINR+3YJgTxBq3+5AsEcItX83INgzhDqnOQgI8eK8ZiDoGWIe8BQx3IQMfwZHAxAYgLiNGG5CxvsRqAiC3iHmIR9WDjehwI2hGiAmIOZB12J8k0KVBDEDMQ/rIgYtdosRBUBgCWIe+Bg5sAkQWINYShi8axBYhVjCICCwDrEE4yAYBWIJtkFicmIhjA/ixFIDgzix2IAgTiw3EIiTERoAxMlI9QKC0d6+ptYahBCvagViFeIghcPzv0cIT14fV15y79df2dbXiPMe/fopebo/HA6PklhxjFACiNVuPMYvSeyTVMgP+Md/uPHrv7CzVcEIEeRy1TBCBPm4qhghgpyvOkaIIO/XBCNEkLd9loYFEP+2N4AUe7SncvzGYowxxhhjjDHGGGOMMcby9wSyNBPmvvYBDQAAAABJRU5ErkJggg==",Ov=["src"],Dv=G({__name:"previewIcon",props:{stickStyle:{type:Object,default:()=>({width:"40px",height:"40px",size:24})},img:{type:String,default:Tv}},setup(n){const t=n,{stickStyle:e}=hn(t),a=M(()=>{let o=e.value.size,r=24;return o<=12?r=0:o<=24?r=12:r=24,{width:`${r}px`,height:`${r}px`}}),i=M(()=>Math.max(e.value.size,1)),s=M(()=>{const r=360/i.value,l=e.value.size/100;return r*l});return(o,r)=>(g(),T("div",{class:"preview-icon-box",style:qe(v(e))},[b("div",{class:"border-box",style:qe({"--n":i.value*.3,"--d":s.value+"deg"})},[b("img",{style:qe(a.value),src:n.img,class:"diagram-icon",alt:""},null,12,Ov)],4)],4))}}),cl=ae(Dv,[["__scopeId","data-v-8a8d1530"]]),Pv={class:"eraser-wrapper"},Mv=G({__name:"Eraser",props:{value:{type:Object,default:()=>({})},label:{type:String,default:""}},setup(n){const{t}=fe(),e=R(Nn),a=y();ie(()=>e.uiState.eraserSize,l=>{a.value=l});const i=l=>{s.value=!1,e.sendEvent(new pi(yt.ERASER,{size:l}))},s=y(!1),o=gt({width:"",height:"",size:0}),r=()=>{s.value=!0,o.width=`${a.value}px`,o.height=`${a.value}px`,o.size=a.value};return(l,d)=>(g(),T("div",Pv,[w(vs,{title:v(t)("editor.image_process.tool_eraser"),desc:v(t)("editor.image_process.tool_eraser_desc")},null,8,["title","desc"]),w(v(Ct),{value:a.value,"onUpdate:value":d[0]||(d[0]=c=>a.value=c),label:n.label,min:1,class:"image-slider",onChange:i,onTrigger:r},null,8,["value","label"]),(g(),j(an,{to:"body"},[w(Ji,{name:"van-fade"},{default:B(()=>[s.value?(g(),j(it(cl),{key:0,"stick-style":o},null,8,["stick-style"])):le("",!0)]),_:1})]))]))}}),Bv=ae(Mv,[["__scopeId","data-v-73a869ee"]]),Lv="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPISURBVHgB7Z2NUdswGIY/eh2AETwCnaAZgRGyAWxAOgHdADbICO4GdAOxAd3grXSWDyUkwbL+xfvc6Tju4k+f/ViSY1uKCCGEEEIIIYQQQgghhBA/AGx1eZEEfBPiy09dBiHlMa0CExuJzHepHLvTgy7/dPl7dXX1KoXQudzoPzf231td/shXQO/4tS4jPvIghdB1Pzl5vOkySO9YES84T3YhduA+ZpSeWSAiuxDTPdmWUDSPrHiIyHYgdB23F0TMPEpPrBCRVIiOu8HpMescSpettE6AiKhCMI0Lj4G5KF32uuzQ2gAfQcRMsJBIecyYrm0jrYB4ImZitRDTRT3Dn1GXe12upSUQX8RMtDFExxqwbNwwreBWWmSFCHOWKo/PRx3UMfX/51Bo9cvfGhF2uwFlhTxTxOH2xYTY3NVR/K20SKgIJ05JIfdO3DZvhcQS4cQrIsTux/xtfCutEVuEE7eUkL2NN0hLpBLhxM8uBNOV1Zu0RGoRTj1Zhdj6NtIKuUQ49RW97K2W3CJsnb4y+hfSkIi+hTQool8hOHxY34qI/oRgekbcqoi+hOD0mxOn2EsgK0R89vy6GiG5X+80LWiQldhtzT2hYeEmv3T5ocvrws/vSgsJBof3bD5DrREC/xaxC9i2eSH3Hjur4CEEASICYjQvZOexswoLhCCCiIBYFOLEiiYiICaFIIGIgNhfVwgSigio4+sJQQYRTn4UcgGFTCKc/CgkAjuJBIVUIsLJj0JqEOHkRyE1iHDyo5AaRDj5UcgFss8spZDLKApJDIVUBoVUBoVUBoUkAisnGVJI/IS3CFggi0LiJjvPYVg9BZdC4iU6J7mRADoUknd6MqYJ7TNPEkhnQvLOA8THSeyDBNKIkEXvjUkudF13SHQ21CxE1/WwNC/JAaZ1mc4R3F3ZOqoT4iEi2nH4LKG7BYns0VmX5SlCpcxlHqxHz4S2oUmhAiGoQQSmVmDOcp9X7U8xYppgM8gKUFAIamkR9iCGioCNYaad3chKUEAIauqanKTM5dxv+M8gGhFxHjUyCkGNIo4SNFKeFya3kQTkEFK9iKNkLx0Q0x0lXSoOCYU0JWIGU7dVLLkUQpoUMYOPY0jWm2MxhTQtwoDDG4VFFsiKIaR5ETN4v/QttqJliJBuRBjwfnVVdH3XNUK6EmGwByHJ7xL5Av83F/sRYcB0hq3+Zh0bIOhl63ZF1EpEIYoiIhBBiKKIiAQIURSRgBVCFEUkxEMIReRggRCKyMkFIRRRAkzP5UdHghHU1q/DEEIIIYQQQsgJ/gPe3rr0PFm6CgAAAABJRU5ErkJggg==",zv={class:"magic-wand-wrapper"},Rv=G({__name:"SmartSelection",props:{value:{type:Object,default:()=>({})},label:{type:String,default:""}},setup(n){const{t}=fe(),e=R(Nn),a=y();ie(()=>e.uiState.aberration,l=>{a.value=l});const i=l=>{s.value=!1,e.sendEvent(new pi(yt.MAGIC_WAND,{aberration:l}))},s=y(!1),o=gt({width:"",height:"",size:0}),r=()=>{s.value=!0,o.width=`${a.value}px`,o.height=`${a.value}px`,o.size=a.value};return(l,d)=>(g(),T("div",zv,[w(vs,{title:v(t)("editor.image_process.tool_magic_wand"),desc:v(t)("editor.image_process.tool_magic_wand_desc")},null,8,["title","desc"]),w(v(Ct),{value:a.value,"onUpdate:value":d[0]||(d[0]=c=>a.value=c),label:n.label,min:1,class:"image-slider",onChange:i,onTrigger:r},null,8,["value","label"]),(g(),j(an,{to:"body"},[w(Ji,{name:"van-fade"},{default:B(()=>[s.value?(g(),j(it(cl),{key:0,"stick-style":o,img:v(Lv)},null,8,["stick-style","img"])):le("",!0)]),_:1})]))]))}}),$v=ae(Rv,[["__scopeId","data-v-90f932f4"]]),Fv={class:"image-ed-wrapper"},Nv={class:"img-ed-container"},Hv={class:"header-back-wrapper"},Vv={class:"do-btn-wrapper"},Uv={key:0,class:"zoom-ratio-box",style:{width:"68px",height:"24px","line-height":"24px"}},Wv={class:"operate-text ratio-size",style:{"font-size":"15px"}},Yv={class:"operate-text fit-size"},Gv=G({__name:"Index",emits:["close"],setup(n,{expose:t,emit:e}){const{t:a}=fe(),i=R(Nn),s=e,o=M(()=>[{id:"undo",icon:"nav-bar-undo",disabled:!i.uiState.enableUndo,onClick(){i.sendEvent(new Hi(Xa.undo))}},{id:"redo",icon:"nav-bar-redo",disabled:!i.uiState.enableRedo,onClick(){i.sendEvent(new Hi(Xa.redo))}}]),r=nn([{id:yt.MAGIC_WAND,icon:"edit-image-tool-magic-wand",title:a("editor.image_process.tool_magic_wand"),name:"editor.image_process.tool_magic_wand",desc:y("editor.image_process.tool_magic_wand_desc"),options:{aberration:i.uiState.aberration},label:a("editor.image_process.attr_aberration"),cmp:$v},{id:yt.ERASER,icon:"edit-image-tool-eraser",title:a("editor.image_process.tool_eraser"),name:"editor.image_process.tool_eraser",desc:y("editor.image_process.tool_eraser_desc"),options:{size:i.uiState.eraserSize},label:a("editor.image_process.attr_size"),cmp:Bv},{id:yt.CUTTER,icon:"edit-image-tool-cutter",title:a("editor.image_process.tool_cutter"),name:"editor.image_process.tool_cutter",desc:y("editor.image_process.tool_cutter_desc"),options:{},cmp:Av}]),l=M({get(){return i.uiState.active},set(A){i.sendEvent(new pi(A))}}),d=()=>{$(F.imageEditResult,{}),i.sendEvent(new Ni(!0))},c=()=>{i.sendEvent(new Ni(!1))},u=M(()=>Number(i.uiState.toolScale/i.uiState.originToolScale*100).toFixed(0)),h=M(()=>Number(i.uiState.toolScale.toFixed(2))!==Number(i.uiState.originToolScale.toFixed(2))),p=()=>{i.sendEvent(new Po)};Ee(()=>i.uiState.onEditor,A=>{A||s("close")});const f=y(!1),m=A=>{A.touches.length==2&&(f.value=!0)},_=A=>{f.value=!1};t({isOnTouch:f});const S=y(),k=ja();return je(()=>{k.hideMinimizedWindow(!0),i.sendEvent(new Oo(Rt.editor)),Qe(()=>{i.sendEvent(new Do(S.value))})}),Yt(()=>{k.hideMinimizedWindow(!1)}),Fn(()=>(c(),!0)),(A,x)=>{const O=Kt,C=Ce,P=jt,I=ga;return g(),T("div",Fv,[b("div",{ref_key:"toolCanvas",ref:S,class:"tool-canvas",onTouchstart:m,onTouchend:_},null,544),w(O,{border:!1},{default:B(()=>[b("div",Nv,[w(v(Ca),{active:l.value,"onUpdate:active":x[0]||(x[0]=D=>l.value=D),list:r.value,"show-tips":!0,onOnConfirm:d,onOnCancel:c},null,8,["active","list"])])]),_:1}),b("div",Hv,[w(I,{fixed:"",placeholder:"",class:"editor-canvas-bar"},{title:B(()=>[b("div",Vv,[(g(!0),T(Se,null,Pe(o.value,D=>(g(),j(P,{key:D.id,disabled:D.disabled,class:oe(["btn-item",D.id]),size:"small",onClick:D.onClick},{default:B(()=>[w(C,{name:D.icon,size:"24px",color:"#fff",class:"f-s-24"},null,8,["name"])]),_:2},1032,["disabled","class","onClick"]))),128))])]),_:1})]),f.value?(g(),T("div",Uv,[b("div",Wv,N(`${u.value}%`),1)])):le("",!0),!f.value&&h.value?(g(),T("div",{key:1,class:"fit-on-screen",style:{height:"30px","line-height":"30px","font-size":"15px"},onClick:p},[b("div",Yv,N(v(a)("editor.image_process.fit_on_screen")),1)])):le("",!0)])}}}),jv=ae(Gv,[["__scopeId","data-v-16f317bd"]]),Kv={class:"ment-wrapper"},Xv={class:"custom-cell-title"},qv={class:"color-inverted-title fl"},Qv=G({__name:"Enhancement",setup(n){const{t}=fe(),e=R(Ze),a=y(50),i=y([10,20]),s=y(!1),o=gt({showValRange:!1}),r=p=>{p&&(a.value=ft(p.sharpness)??50,i.value=ft(p.grayValue)??[10,20],s.value=ft(p.colorInverted)??!1)},l=p=>{u({grayValue:p})},d=p=>{u({sharpness:p})};ie(()=>e.uiState.selectedAttrs,r),je(()=>{r(e.uiState.selectedAttrs)});const c=R(ct),u=p=>{p&&c.sendEvent(new Ya(p))},h=()=>{ce.modal.showRemindDialog({title:t("editor.display.color_inverted"),message:t("editor.display.color_inverted_tips"),link:t("editor.display.color_inverted_link_href"),linkType:2,linkText:t("editor.display.color_inverted_link_text"),allowHtml:!1,defaultBtn:!0,confirmButtonText:t("ipad.dialog.got_it")})};return(p,f)=>{const m=fo,_=Ce,S=go,k=Kt;return g(),j(k,{class:"image-gr-wrapper"},{default:B(()=>[b("div",Kv,[w(v(Ct),{value:a.value,"onUpdate:value":f[0]||(f[0]=A=>a.value=A),label:v(t)("editor.display.sharpness"),onChange:d},null,8,["value","label"]),w(v(Ct),{value:i.value,"onUpdate:value":f[1]||(f[1]=A=>i.value=A),min:0,max:255,range:!0,attrs:o,label:v(t)("editor.display.gray_value"),onChange:l},null,8,["value","attrs","label"]),w(S,{class:"image-bold-wrap color-inverted-wrap",name:"switch","input-align":"right",label:v(t)("editor.display.color_inverted")},{input:B(()=>[w(m,{modelValue:s.value,"onUpdate:modelValue":f[2]||(f[2]=A=>s.value=A),size:"20px",class:"mk-switch",onChange:f[3]||(f[3]=A=>u({colorInverted:A}))},null,8,["modelValue"])]),label:B(()=>[b("div",Xv,[b("span",qv,N(v(t)("editor.display.color_inverted")),1),w(_,{class:"fl svg-tip",name:"graph_quality",onClick:rt(h,["stop"])})])]),_:1},8,["label"])])]),_:1})}}}),Zv=ae(Qv,[["__scopeId","data-v-b61dd968"]]),Jv={class:"image-ed-wrapper"},ep=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const e=nn([{id:"enhancement",icon:"edit-image-tool-enhancement",title:"",name:"editor.image_adjust.adjust",desc:"",options:{},label:"",cmp:Zv}]),a=y(e.value[0].id),i=t,s=()=>{i("close")};return(o,r)=>{const l=Kt;return g(),T("div",Jv,[w(l,{border:!1},{default:B(()=>[w(v(Ca),{active:a.value,"onUpdate:active":r[0]||(r[0]=d=>a.value=d),list:e.value,"hide-icon":!0,"show-back":!0,"show-tips":!0,onOnCancel:s},null,8,["active","list"])]),_:1})])}}}),tp=""+new URL("../assets/filter-binary-Ig8wqCWX.png",import.meta.url).href,np=""+new URL("../assets/filter-comic1-Zd7z14JU.png",import.meta.url).href,ap=""+new URL("../assets/filter-comic2-VRsd5rYc.png",import.meta.url).href,ip=""+new URL("../assets/filter-emboss-aKwx6K23.png",import.meta.url).href,sp=""+new URL("../assets/filter-grid-bIu1nole.png",import.meta.url).href,op=""+new URL("../assets/filter-null-MIGNnls7.png",import.meta.url).href,lp=""+new URL("../assets/filter-sketch-46_qHvlp.png",import.meta.url).href,rp={class:"image-gr-wrapper"},cp={class:"image-bold-wrap filter-cls"},dp={class:"filter-container"},up=["onClick"],vp={class:"xxx"},pp=["src"],hp={class:"filter-overlay"},mp={key:0,class:"slider-filter"},fp=G({__name:"FilterList",setup(n){const{t}=fe(),e=R(Ze),a=y(""),i=y(5),s=m=>{var _,S;m&&(a.value=ft(m.filterList??[""])[0],i.value=ft((S=(_=m.filterAttrsMap)==null?void 0:_.emboss)==null?void 0:S.strength)??5)};ie(()=>e.uiState.selectedAttrs,s);const o=["null","grid","sketch","comic1","comic2","emboss","binary"],r={null:{name:op,value:"",displayName:t("editor.filter.null")},grid:{name:sp,value:"dot",displayName:t("editor.filter.grid")},sketch:{name:lp,value:"sketch",displayName:t("editor.filter.sketch")},comic1:{name:np,value:"comic1",displayName:`${t("editor.filter.comic")}1`},comic2:{name:ap,value:"comic2",displayName:`${t("editor.filter.comic")}2`},emboss:{name:ip,value:"emboss",displayName:t("editor.filter.emboss")},binary:{name:tp,value:"binary",displayName:t("editor.filter.binary")}};je(()=>{s(e.uiState.selectedAttrs)});const l=y(0),d=y(),c=(m,_,S)=>{$(F.imageFilterResult,{name:S}),m==null||m.preventDefault();let k;d.value!==_&&(k=ce.modal.showToast({layout:"vertical",overlay:!0,duration:0,icon:"loading"}));try{f({filterList:_?[_]:[]}),l.value=Math.random()}catch(A){console.error(A)}finally{d.value=_,setTimeout(()=>{k&&k.close()},100)}},u=m=>{setTimeout(()=>{m.preventDefault()},20)},h=R(ct),p=m=>{m<1&&(m=1),m>20&&(m=20),h.sendEvent(new Ya({filterAttrsMap:{emboss:{strength:m}}}))},f=m=>{m&&h.sendEvent(new Ya(m))};return(m,_)=>(g(),T("div",rp,[b("div",cp,[b("section",dp,[(g(),T(Se,null,Pe(o,S=>b("div",{key:`${S}${l.value}`,class:oe(["filter-wrap",{"active-filter":a.value===r[S].value||!a.value&&!r[S].value}]),tabindex:"0",onClick:rt(k=>c(k,r[S].value,r[S].displayName),["prevent"]),onTouchstar:rt(u,["prevent"])},[b("div",vp,[b("img",{src:r[S].name,alt:"",width:"62",height:"78"},null,8,pp)]),b("div",hp,[b("span",null,N(r[S].displayName),1)])],42,up)),64))])]),a.value==="emboss"?(g(),T("div",mp,[w(v(Ct),{value:i.value,"onUpdate:value":_[0]||(_[0]=S=>i.value=S),min:1,max:20,label:v(t)("editor.filter.attrs.emboss.strength"),onChange:p},null,8,["value","label"])])):le("",!0)]))}}),gp=ae(fp,[["__scopeId","data-v-94712beb"]]),bp={class:"image-ed-wrapper"},_p=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const e=nn([{id:"filter",icon:"edit-image-tool-filter",title:"",name:"editor.image_filter.filter",desc:"",options:{},label:"",cmp:gp}]),a=y(e.value[0].id),i=t,s=()=>{i("close")};return(o,r)=>{const l=Kt;return g(),T("div",bp,[w(l,{border:!1},{default:B(()=>[w(v(Ca),{active:a.value,"onUpdate:active":r[0]||(r[0]=d=>a.value=d),list:e.value,"hide-icon":!0,"show-back":!0,"confirm-button-disabled":!1,"show-tips":!0,onOnCancel:s},null,8,["active","list"])]),_:1})])}}}),yp={cellSize:55,lineWidth:1,lineColor:"#E1E7E3",lineAlpha:.5};var In,$t,kn,An,Tn,ii,dl,si,ul,oi,vl;class wp{constructor(t,e=yp){ge(this,ii);ge(this,si);ge(this,oi);ge(this,In,void 0);ge(this,$t,void 0);ge(this,kn,void 0);ge(this,An,void 0);ge(this,Tn,void 0);he(this,$t,t),he(this,In,e),he(this,kn,t.getContext("2d"));const{width:a,height:i}=L(this,$t).getBoundingClientRect(),s=window.devicePixelRatio??1;this.retina(a,i,s),he(this,An,Math.floor(a*s)),he(this,Tn,Math.floor(i*s))}get option(){return L(this,In)}get canvas(){return L(this,kn)}draw(){const{cellSize:t,lineWidth:e,lineColor:a,lineAlpha:i}=L(this,In);this.canvas.lineWidth=e,this.canvas.strokeStyle=a,this.canvas.lineWidth=e,this.canvas.globalAlpha=i,this.canvas.fillStyle="#ffffff",Ia(this,ii,dl).call(this,t)}retina(t,e,a){L(this,$t).style.width=t+"px",L(this,$t).style.height=e+"px",L(this,$t).height=e*a,L(this,$t).width=t*a,L(this,kn).scale(a,a)}}In=new WeakMap,$t=new WeakMap,kn=new WeakMap,An=new WeakMap,Tn=new WeakMap,ii=new WeakSet,dl=function(t){!lo(t)||t<=0||(Ia(this,si,ul).call(this,L(this,An),L(this,Tn),t),Ia(this,oi,vl).call(this,L(this,An),L(this,Tn),t),this.canvas.stroke(),this.canvas.globalAlpha=1)},si=new WeakSet,ul=function(t,e,a){let i=a;const s=t,o=e;do this.canvas.beginPath(),this.canvas.moveTo(0,i),this.canvas.lineTo(s,i),this.canvas.stroke(),i+=a;while(i<o)},oi=new WeakSet,vl=function(t,e,a){let i=a;const s=e,o=t;do this.canvas.beginPath(),this.canvas.moveTo(i,0),this.canvas.lineTo(i,s),this.canvas.stroke(),i+=a;while(i<o)};var ra,ca,da,ua;class Sp{constructor(t){ge(this,ra,void 0);ge(this,ca,void 0);ge(this,da,void 0);ge(this,ua,void 0);Z(this,"setLineWidth",t=>{this.canvas.lineWidth=t});Z(this,"setStrokeStyle",t=>{this.canvas.strokeStyle=t});Z(this,"setFillStyle",t=>{this.canvas.fillStyle=t});Z(this,"setLineCap",t=>{this.canvas.lineCap=t});he(this,ua,t),he(this,da,t.canvas),he(this,ra,t.cxt),he(this,ca,t.cxtErase),this.canvas.lineWidth=5,this.canvas.strokeStyle="#545458",this.canvas.fillStyle="#545458",this.canvas.lineCap="round",this.canvasErase.strokeStyle="#545458",this.canvasErase.fillStyle="#545458",this.canvasErase.lineCap="round",this.canvasErase.lineCap="round"}get canvas(){return L(this,ra)}get canvasErase(){return L(this,ca)}get board(){return L(this,ua)}get element(){return L(this,da)}}ra=new WeakMap,ca=new WeakMap,da=new WeakMap,ua=new WeakMap;var Re=(n=>(n[n.Pencil=0]="Pencil",n[n.Erase=1]="Erase",n))(Re||{}),It;class pl extends Sp{constructor(){super(...arguments);ge(this,It,new Map)}get pointsMap(){return L(this,It)}copyTouch(e){return new Zs(e.identifier,e.clientX,e.clientY-this.board.offsetTop)}pushPoint(e){var a,i;if(!L(this,It).has(e.identifier))L(this,It).set(e.identifier,{beginPoint:e,points:[e]});else{const s=(a=L(this,It).get(e.identifier))==null?void 0:a.points;this.canPush(s[s.length-1],e)&&((i=L(this,It).get(e.identifier))==null||i.points.push(e))}}clearPoint(e=0){if(e===0){L(this,It).clear();return}L(this,It).delete(e)}drawLine(e){var s,o,r;const a=this.copyTouch(e);this.pushPoint(a);const i=this.pointsMap.get(a.identifier);if(((s=i.points)==null?void 0:s.length)>3){const l=i.points.slice(-2),d=l[0],c=new Zs(a.identifier,(l[0].x+l[1].x)/2,(l[0].y+l[1].y)/2);this.canvas.beginPath(),this.canvas.moveTo(i.beginPoint.x,i.beginPoint.y),this.canvas.quadraticCurveTo(d.x,d.y,c.x,c.y),this.canvas.stroke(),this.canvas.closePath(),i.beginPoint=c}else((o=i.points)==null?void 0:o.length)>1||((r=i.points)==null?void 0:r.length)===1&&(this.canvas.beginPath(),this.canvas.moveTo(i.beginPoint.x,i.beginPoint.y),this.canvas.lineTo(i.beginPoint.x+.01,i.beginPoint.y+.01),this.canvas.stroke(),this.canvas.closePath())}drawPoint(e){this.canvas.beginPath(),this.canvas.arc(e.x,e.y,this.canvas.lineWidth/2+1,0,Math.PI*2,!1),this.canvas.fill()}canPush(e,a){const i=Math.abs(e.timestamp-a.timestamp),s=Math.sqrt(Math.pow(e.x-a.x,2)+Math.pow(e.y-a.y,2));return s>3||s/i>.5}}It=new WeakMap;class Qs extends pl{drawDown(t){this.drawLine(t)}drawMove(t){this.drawLine(t)}drawUp(t){this.clearPoint(t),this.canvas.restore()}}class Cp extends pl{constructor(){super(...arguments);Z(this,"setDrawPathForEraser",e=>{this.canvasErase.clearRect(0,0,this.element.width,this.element.height);let a=this.canvas.lineWidth;a=a>5?a:5,this.canvasErase.beginPath(),this.canvasErase.arc(e.x,e.y,a/2-2,0,Math.PI*2,!1),this.canvasErase.stroke()})}drawDown(e){this.erase(e),this.setDrawPathForEraser(this.copyTouch(e))}drawMove(e){this.erase(e),this.setDrawPathForEraser(this.copyTouch(e))}drawUp(e){this.clearPoint(e),this.canvasErase.clearRect(0,0,this.element.width,this.element.height)}erase(e){this.canvas.globalCompositeOperation="destination-out",this.drawLine(e),this.canvas.globalCompositeOperation="source-over"}}var vt,li,en,pt,Ft,kt;class xp{constructor(t,e,a){ge(this,vt,void 0);ge(this,li,void 0);ge(this,en,void 0);ge(this,pt,void 0);Z(this,"onAddImageData");ge(this,Ft,void 0);ge(this,kt,new Map);Z(this,"minDuration",100);Z(this,"_initDraw",(t=Re.Pencil)=>{if(L(this,kt).has(t))return he(this,Ft,L(this,kt).get(t)),L(this,Ft);switch(t){case Re.Pencil:L(this,kt).set(t,new Qs(L(this,en)));break;case Re.Erase:L(this,kt).set(t,new Cp(L(this,en)));break;default:L(this,kt).set(t,new Qs(L(this,en)));break}return he(this,Ft,L(this,kt).get(t)),L(this,Ft)});Z(this,"changeMkDraw",t=>this._initDraw(t));Z(this,"startTimer",0);Z(this,"duration",0);Z(this,"targetId",-1);Z(this,"down",t=>{if(t instanceof TouchEvent&&this.targetId===-1){this.targetId=t.changedTouches[0].identifier;const e=Date.now();this.duration=e-this.startTimer,this.duration>this.minDuration&&(this.startTimer=e,this.downEvent(t.changedTouches[0]))}t.preventDefault()});Z(this,"move",t=>{if(t instanceof TouchEvent){const e=t.targetTouches;let a;for(let i=0;i<e.length;i++)if(e[i].identifier===this.targetId){a=e[i];break}this.duration>this.minDuration&&a&&this.moveEvent(a)}t.preventDefault()});Z(this,"up",t=>{if(t instanceof TouchEvent){const e=t.targetTouches;let a;for(let i=0;i<e.length;i++)if(e[i].identifier===this.targetId){a=e[i];break}!a&&this.targetId!==-1&&(this.upEvent(this.targetId),this.targetId=-1)}t.preventDefault()});Z(this,"cancel",()=>{this.cancelEvent(),this.targetId=-1});he(this,vt,t.canvas),he(this,li,t.eraseCanvas),he(this,en,t),he(this,pt,e),this.onAddImageData=a,this.bindListener(),he(this,Ft,this._initDraw())}get mkDraw(){return L(this,Ft)}get board(){return L(this,en)}bindListener(){L(this,vt).addEventListener(L(this,pt).down,this.down),L(this,vt).addEventListener(L(this,pt).move,this.move),L(this,vt).addEventListener(L(this,pt).up,this.up),L(this,vt).addEventListener(L(this,pt).touchcancel,this.cancel)}removeListener(){L(this,kt).clear(),L(this,vt).removeEventListener(L(this,pt).down,this.down),L(this,vt).removeEventListener(L(this,pt).move,this.move),L(this,vt).removeEventListener(L(this,pt).up,this.up),L(this,vt).removeEventListener(L(this,pt).touchcancel,this.cancelEvent)}reset(){this.startTimer=0,this.duration=0,this.targetId=-1}}vt=new WeakMap,li=new WeakMap,en=new WeakMap,pt=new WeakMap,Ft=new WeakMap,kt=new WeakMap;class Zs{constructor(t,e,a,i=void 0,s=void 0){Z(this,"identifier");Z(this,"timestamp");Z(this,"x");Z(this,"y");Z(this,"before");Z(this,"next");this.identifier=t,this.timestamp=Date.now(),this.x=e,this.y=a,this.before=i,this.next=s}insert(t){if(this.isTail())this.next=t;else{const e=this.next;this.next=t,t.next=e,t.before=this}}isHeader(){return this.before===void 0}isTail(){return this.next===void 0}}const Ep={mobile:{down:"touchstart",move:"touchmove",up:"touchend",touchcancel:"touchcancel"},pad:{down:"touchstart",move:"touchmove",up:"touchend",touchcancel:"touchcancel"},pc:{down:"mousedown",move:"mousemove",up:"mouseup"}};class Ip extends xp{constructor(){super(...arguments);Z(this,"startDistance",0);Z(this,"startCenter",{x:0,y:0});Z(this,"identifier",-1)}downEvent(e){var a,i;this.identifier=e.identifier,this.mkDraw.drawDown(e),(i=(a=this.board).drawIngCallBack)==null||i.call(a,!0)}moveEvent(e){e.identifier===this.identifier&&this.mkDraw.drawMove(e)}upEvent(e){var a,i;if(e===this.identifier){this.identifier=-1,this.mkDraw.drawUp(e);const s=this.mkDraw.board.drawType===Re.Pencil;this.onAddImageData(s),(i=(a=this.board).drawIngCallBack)==null||i.call(a,!1)}}cancelEvent(){var a,i;this.mkDraw.drawUp(this.identifier),this.identifier=-1;const e=this.mkDraw.board.drawType===Re.Pencil;this.onAddImageData(e),(i=(a=this.board).drawIngCallBack)==null||i.call(a,!1)}getDistance(e,a){const i=e.clientX-a.clientX,s=e.clientY-a.clientY;return Math.hypot(i,s)}getCenter(e,a){const i=(e.clientX+a.clientX)/2,s=(e.clientY+a.clientY)/2;return{x:i,y:s}}}var At,On,va,Dn,Pn,Mn,Bn,pa,ha,ht,Nt,Ht,Ln,ma,fa,vn;class kp{constructor(t,e,a=!1,i,s=44){ge(this,At,void 0);ge(this,On,void 0);ge(this,va,void 0);ge(this,Dn,void 0);ge(this,Pn,void 0);ge(this,Mn,void 0);ge(this,Bn,void 0);Z(this,"_mkDraw");ge(this,pa,void 0);ge(this,ha,void 0);ge(this,ht,void 0);Z(this,"enableRedo",!1);Z(this,"enableUndo",!1);ge(this,Nt,Re.Pencil);ge(this,Ht,!0);ge(this,Ln,!0);Z(this,"drawIngCallBack");Z(this,"offsetTop",44);Z(this,"initCanvas",(t,e)=>{const a=document.createElement("canvas"),i=document.createElement("canvas");return t.insertBefore(i,e),t==null||t.insertBefore(a,e),a.classList.add("canvas","board"),i.classList.add("canvas","board"),{boardCanvas:a,eraseCanvas:i}});Z(this,"initGrid",(t,e,a=!1)=>{const i=document.createElement("canvas");t.insertBefore(i,e),i.classList.add("canvas");const s=new wp(i);return a&&s.draw(),i});Z(this,"_canvas",()=>L(this,At));Z(this,"_erase",()=>L(this,On));Z(this,"boardRect",()=>({x:L(this,Mn),y:L(this,Bn)}));Z(this,"destory",()=>{document.removeChild(L(this,va)),document.removeChild(L(this,At)),document.removeChild(L(this,On)),L(this,ht).removeListener(),he(this,vn,void 0)});Z(this,"undo",()=>{if(this.history.length>0){const t=this.history.pop();t&&this.redoHistory.push(t),L(this,fa).call(this)}this.upDataEnable(),L(this,ht).reset()});Z(this,"redo",()=>{if(this.redoHistory.length>0){const t=this.redoHistory.pop();t&&this.history.push(t),L(this,fa).call(this)}this.upDataEnable(),L(this,ht).reset()});ge(this,ma,void 0);ge(this,fa,async()=>{const t=this.history.slice(-1)[0];window.MeApi.fileHelper.read2Buffer(t).then(async e=>{he(this,ma,new ImageData(Uint8ClampedArray.from(e),this.canvas.width,this.canvas.height)),this.cxt.putImageData(L(this,ma),0,0),this.upDataEnable()})});Z(this,"addHistory",async(t=!1)=>{if(L(this,Nt)===Re.Pencil&&he(this,Ht,!1),this.history.length<=1&&L(this,Nt)===Re.Erase){he(this,Ht,!0);return}if(L(this,Ht)&&L(this,Nt)===Re.Erase)return;this.redoHistory.splice(0,this.redoHistory.length);const e=this.cxt.getImageData(0,0,this.canvas.width,this.canvas.height),a=await window.MeApi.fileHelper.saveFileWithFetch("temporary","/graffiti/",e.data);this.history.push(a.filePath),this.upDataEnable(t)});Z(this,"upDataEnable",(t=!1)=>{this.enableRedo=this.redoHistory.length>0,this.enableUndo=this.history.length>1,t?he(this,Ht,!1):he(this,Ht,this.isCanvasEmpty()),L(this,vn)&&L(this,vn).call(this,this.enableUndo,this.enableRedo,L(this,Ht))});Z(this,"isCanvasEmpty",()=>{const t=document.createElement("canvas");return t.width=L(this,At).width,t.height=L(this,At).height,L(this,At).toDataURL()===t.toDataURL()});Z(this,"setStrokeStyle",t=>{this.mkDraw.setStrokeStyle(t)});Z(this,"setFillStyle",t=>{this.mkDraw.setFillStyle(t)});Z(this,"setLineCap",t=>{this.mkDraw.setLineCap(t)});Z(this,"setLineWidth",t=>{this.mkDraw.setLineWidth(t),L(this,ht).reset()});Z(this,"changeType",t=>{this._mkDraw=L(this,ht).changeMkDraw(t),he(this,Nt,t),L(this,ht).reset()});ge(this,vn,void 0);Z(this,"addImageDataListener",t=>{he(this,vn,t)});Z(this,"htmlImageElement",async()=>{if(!L(this,Ln))return;he(this,Ln,!1);const{data:t}=this.clearImageEdgeBlank();return await dr(t,"image/png")});Z(this,"convertToSvgPath",async()=>{var s;const{data:t,width:e,height:a}=this.clearImageEdgeBlank(),i=await((s=Li.potraceWorker)==null?void 0:s.convertToSvgPath(t,{aberrationThreshold:100,turdsize:20,alphamax:1,layeredByColor:!1}));return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="${a}mm" width="${e}mm">
        <path d="${i}"></path>
        </svg>`});Z(this,"clearImageEdgeBlank",()=>{let t=this.canvas.width,e=this.canvas.height;const a=this.cxt.getImageData(0,0,t,e),i=a.data,s=i.length,o={top:null,left:null,right:null,bottom:null};let r=null,l,d,c;for(l=0;l<s;l+=4)i[l+3]!==0&&(d=l/4%t,c=~~(l/4/t),o.top===null&&(o.top=c),(o.left===null||d<o.left)&&(o.left=d),(o.right===null||o.right<d+1)&&(o.right=d+1),(o.bottom===null||o.bottom<c)&&(o.bottom=c));o.top!==null&&(t=o.right-o.left,e=o.bottom-o.top+1,r=this.cxt.getImageData(o.left,o.top,t,e)),r=r??a;const u=window.innerWidth/this.canvas.width;return{data:this.scaleImageData(r,u),width:t,height:e}});Z(this,"scaleImageData",(t,e)=>{const a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").putImageData(t,0,0);const s=document.createElement("canvas");s.width=t.width*e,s.height=t.height*e;const o=s.getContext("2d");return o.scale(e,e),o.drawImage(a,0,0),o.getImageData(0,0,s.width,s.height)});Z(this,"reset",()=>{Ap(),this.cxt.clearRect(0,0,window.innerWidth,window.innerHeight),this.setLineWidth(5),this.changeType(Re.Pencil),this.history.splice(0,this.history.length),this.redoHistory.splice(0,this.redoHistory.length),L(this,ht).reset(),this.addHistory(),he(this,Nt,Re.Pencil),he(this,Ln,!0)});this.drawIngCallBack=i,this.offsetTop=s;const o=this.initGrid(t,e,a),{boardCanvas:r,eraseCanvas:l}=this.initCanvas(t,e);he(this,At,r),he(this,On,l),he(this,va,o),he(this,Dn,r.getContext("2d")),he(this,Pn,l.getContext("2d"));const{width:d,height:c}=L(this,At).getBoundingClientRect(),u=window.devicePixelRatio??1;this.retina(d,c,u),he(this,Mn,Math.floor(d*u)),he(this,Bn,Math.floor(c*u)),he(this,pa,[]),he(this,ha,[]),he(this,ht,this.initEvent()),this._mkDraw=L(this,ht).mkDraw,this.addHistory()}retina(t,e,a){this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.canvas.height=e*a,this.canvas.width=t*a,L(this,Dn).scale(a,a),this.eraseCanvas.style.width=t+"px",this.eraseCanvas.style.height=e+"px",this.eraseCanvas.height=e*a,this.eraseCanvas.width=t*a,L(this,Pn).scale(a,a)}get cxt(){return L(this,Dn)}get cxtErase(){return L(this,Pn)}get canvas(){return this._canvas()}get eraseCanvas(){return this._erase()}get drawType(){return L(this,Nt)}get history(){return L(this,pa)}get redoHistory(){return L(this,ha)}get x(){return L(this,Mn)}get y(){return L(this,Bn)}get mkDraw(){return this._mkDraw}initEvent(){return new Ip(this,Ep.mobile,this.addHistory)}}At=new WeakMap,On=new WeakMap,va=new WeakMap,Dn=new WeakMap,Pn=new WeakMap,Mn=new WeakMap,Bn=new WeakMap,pa=new WeakMap,ha=new WeakMap,ht=new WeakMap,Nt=new WeakMap,Ht=new WeakMap,Ln=new WeakMap,ma=new WeakMap,fa=new WeakMap,vn=new WeakMap;const Ap=()=>{window.MeApi.fileHelper.deleteDictory("temporary","/graffiti/").catch(()=>{})},hl=n=>(Qi("data-v-2eabc680"),n=n(),Zi(),n),Tp={class:"graffti-nav"},Op={class:"nav-title-button"},Dp=hl(()=>b("span",{class:"btn-line"},null,-1)),Pp={id:"wrapper",ref:"wrapper",class:"wrapper"},Mp={class:"bottom-active-container"},Bp=hl(()=>b("div",{class:"show-bar-btn"},[b("div",{class:"show-bar"})],-1)),Lp={class:"popover-content"},zp={class:"pop-title"},Rp={class:"shape-wrapper"},$p={key:0,class:"pen-svg"},Fp=["transform"],Np=["stroke-width"],Hp={class:"bottom-tab-container"},Vp={class:"bottom-content"},Ra=0,Js=.5,Up=G({__name:"Graffiti",emits:["close"],setup(n,{emit:t}){const e=t,{t:a}=fe(),i=y(!1);(()=>{setTimeout(()=>{i.value=!0},500)})();const o=y(),r=y(0),l=X=>X*Math.min(document.documentElement.clientWidth/375,2),d=l(76),c=y(d),u=X=>{var pe;r.value=l((pe=X.changedTouches[0])==null?void 0:pe.clientY)},h=X=>{var We;let pe=l((We=X.changedTouches[0])==null?void 0:We.clientY);const Ie=pe-r.value;c.value-=Ie,c.value>d?c.value=d:c.value<Ra&&(c.value=Ra),r.value=pe},p=()=>{c.value>d/2?c.value=d:c.value=Ra},f=X=>{X?c.value=d:c.value=Ra},m=()=>{!(be.value||!C.value)||me.value?ce.modal.showTipModal({title:a("mobile.graffiti.cancel_title"),content:a("mobile.graffiti.cancel_content"),hasClose:!1,confirmTxt:a("mobile.graffiti.continue_editing"),cancelTxt:a("mobile.graffiti.confirm"),onConfirm:()=>{},onCancel:()=>{S()}}):S()};let _;const S=()=>{i.value=!1,_=setTimeout(()=>{e("close")},(Js+.2)*1e3)};let k=y(!1),A=y(0);const x=R(ct),O=async()=>{var Ie;$(F.buttonClick,{elementId:q.complete,source:"graffiti"});const X=Date.now(),pe=X-A.value;if(A.value=X,!(k.value||pe<1e3)){k.value=!0;const We=await((Ie=o.value)==null?void 0:Ie.convertToSvgPath());x.sendEvent(new ia({type:zn.File,file:We,options:{offsetX:ur,offsetY:vr,parseColor:!1,isGraffiti:!0}})),S()}},C=y(!1),P=y(!1),I=(X,pe,Ie)=>{C.value=X,P.value=pe,be.value=Ie},D=()=>{var X;(X=o.value)==null||X.undo()},ee=()=>{var X;(X=o.value)==null||X.redo()},W=y(0),U={[Re.Pencil]:{key:Re.Pencil,type:"pen",label:a("mobile.graffiti.pen"),widthLabel:a("mobile.graffiti.pen_size"),icon:"canvas-graffiti-pencil",min:4,max:20},[Re.Erase]:{key:Re.Erase,type:"eraser",label:a("mobile.graffiti.erase"),widthLabel:a("mobile.graffiti.erase_size"),icon:"canvas-graffiti-eraser",min:10,max:100}},V=M(()=>U[W.value]),Q=gt({pen:6,eraser:40}),ve=y(!1);let ne;const re=()=>{ve.value=!0,ne&&clearInterval(ne),ne=setTimeout(()=>ve.value=!1,1e3)},ke=(X,pe,Ie)=>{re(),Be(X,pe,Ie)},Ae=(X,pe)=>{X===Re.Pencil?$(F.slideAdjust,{elementId:q.brushSize}):X===Re.Erase&&$(F.slideAdjust,{elementId:q.eraserSize})},Be=(X,pe,Ie)=>{var We,Bt;(We=o.value)==null||We.changeType(X),Q[`${pe}`]=Ie,W.value=X,(Bt=o.value)==null||Bt.setLineWidth(Ie)},Ue=y(!0),ue=(X,pe)=>{X===Re.Pencil?$(F.buttonClick,{elementId:q.brush}):X===Re.Erase&&$(F.buttonClick,{elementId:q.eraser}),Ue.value=!1,Qe(()=>{Ue.value=!0,Be(X,pe,Q[`${pe}`]),f(!0)})};Ee(()=>i.value,X=>{var pe;X&&!o.value?Qe(()=>{Je()}):(Q.eraser=40,Q.pen=6,W.value=0,(pe=o.value)==null||pe.reset()),X&&(c.value=d)});const me=y(!1),Ne=X=>{me.value=X},Je=()=>{setTimeout(()=>{var Ie;const X=document.getElementById("wrapper"),pe=document.getElementById("bottom");o.value=new kp(X,pe,!1,Ne),(Ie=o.value)==null||Ie.addImageDataListener(I),o.value.canvas.addEventListener("touchstart",()=>{f(!1)})},100)},Mt=R(ct),te=ja();je(()=>{Mt.sendEvent(new Bi(!0)),te.hideMinimizedWindow(!0)}),Yt(()=>{be.value=!0,clearTimeout(_),Mt.sendEvent(new Bi(!1)),te.hideMinimizedWindow(!1)}),Fn(()=>(m(),!0));const be=y(!0);return(X,pe)=>{const Ie=Ce,We=jt,Bt=ga,xa=bo,Vn=di,H=ui,xe=ba,Ye=ri("x-tooltip");return g(),j(xe,{show:i.value,position:"bottom","close-on-popstate":!0,teleport:"body",duration:Js,class:"graffiti-pop"},{default:B(()=>[b("section",Tp,[w(Bt,{fixed:"","right-disabled":be.value||!C.value},{title:B(()=>[b("div",Op,[w(We,{round:"",disabled:!C.value,size:"small",class:"editor-header-button undo",onClick:D},{default:B(()=>[w(Ie,{name:"canvas-graffiti-undo",class:"redo-undo-svg"})]),_:1},8,["disabled"]),Dp,w(We,{round:"",disabled:!P.value,size:"small",class:"editor-header-button redo",onClick:ee},{default:B(()=>[w(Ie,{name:"canvas-graffiti-redo",class:"redo-undo-svg"})]),_:1},8,["disabled"])])]),_:1},8,["right-disabled"])]),b("div",Pp,[w(xe,{id:"bottom",class:"bottom bottom-popup",overlay:!1,"safe-area-inset-bottom":"",show:!0,position:"bottom",onTouchstart:u,onTouchmove:h,onTouchend:p},{default:B(()=>[b("div",{class:"bottom-pop-container",style:qe(`height: ${c.value+l(81)}px`)},[b("div",Mp,[Bp,b("div",{style:qe(`height: ${c.value}px`),class:oe(["shape-popover",{"popover-bottom":c.value===v(d)}])},[w(xa,{show:ve.value,"onUpdate:show":pe[3]||(pe[3]=we=>ve.value=we),placement:"top","show-arrow":!1,offset:[0,l(18)]},{default:B(()=>[b("div",Lp,[b("div",zp,N(V.value.widthLabel)+" "+N(Q[`${V.value.type}`]),1),b("div",Rp,[V.value.type==="pen"?(g(),T("svg",$p,[b("g",{stroke:"#747A7A","stroke-width":"1",fill:"none","fill-rule":"evenodd",transform:"translate(0,0)"},[b("path",{d:`M38,64.8638332 C43.2880264,
                              56.2879444 51.6360938,52 63.0442023,
                              52 C80.156365,52 100.276074,72 116.245271,
                              72 C126.891403,72 134.142979,
                              67.8995785 138,59.6987355`,stroke:"#545458","stroke-width":Q[`${V.value.type}`],"stroke-linecap":"round"},null,8,Np)],8,Fp)])):le("",!0),V.value.type==="eraser"?(g(),T("div",{key:1,class:"pop-radius",style:qe({width:Q[`${V.value.type}`]+"px",height:Q[`${V.value.type}`]+"px"})},null,4)):le("",!0)])])]),reference:B(()=>[Ue.value?(g(),j(v(Ct),{key:0,value:Q[`${V.value.type}`],"onUpdate:value":[pe[0]||(pe[0]=we=>Q[`${V.value.type}`]=we),pe[2]||(pe[2]=we=>ke(V.value.key,V.value.type,we))],label:V.value.widthLabel,min:V.value.min,max:V.value.max,class:"graffiti-slider",onChange:pe[1]||(pe[1]=we=>Ae(V.value.key,we))},null,8,["value","label","min","max"])):le("",!0)]),_:1},8,["show","offset"])],6)]),b("div",Hp,[w(We,{class:"common-icon-btn",onClick:m},{icon:B(()=>[w(Ie,{name:"common-close",class:"common-btn-icon"})]),_:1}),b("div",Vp,[w(H,{active:W.value,"onUpdate:active":pe[4]||(pe[4]=we=>W.value=we),type:"card",class:"graffti-tabs",onChange:ue},{default:B(()=>[(g(),T(Se,null,Pe(U,we=>w(Vn,{key:we.key,title:we.type},{title:B(()=>[Oe((g(),T("div",null,[w(Ie,{name:we.icon,class:"tab-svg"},null,8,["name"])])),[[Ye,{content:v(a)(we.label),placement:"top",pressTime:500,distance:19}]])]),_:2},1032,["title"])),64))]),_:1},8,["active"])]),w(We,{class:"common-icon-btn",disabled:be.value||!C.value,onClick:O},{icon:B(()=>[w(Ie,{name:"common-check",class:"common-btn-icon"})]),_:1},8,["disabled"])])],4)]),_:1})],512)]),_:1},8,["show"])}}}),Wp=ae(Up,[["__scopeId","data-v-2eabc680"]]),Yp={class:"default"},Gp=["onClick"],jp=G({__name:"Index",setup(n){const{t}=fe(),e=R(yo),a=y(!0),i=y([{name:t("mobile.editor.photo"),id:0,icon:"open-image-camera"},{name:t("mobile.editor.open_photo_album"),id:1,icon:"open-image-device"},{name:t("mobile.editor.my_system_file"),id:2,icon:"open-image-project"}]),s=o=>{const r=o===0?0:o===1?1:2;e.sendEvent(new nc(r)),a.value=!1};return(o,r)=>{const l=ss;return g(),j(l,{show:a.value,"onUpdate:show":r[0]||(r[0]=d=>a.value=d),"cancel-text":o.$t("mobile.common.cancel"),"close-on-click-action":""},{default:B(()=>[b("div",Yp,[(g(!0),T(Se,null,Pe(i.value,d=>(g(),T("div",{key:d.id,class:"img-action",onClick:c=>s(d.id)},[w(v(wt),{name:d.icon,size:"20px",color:"#545458",class:"f-s-20"},null,8,["name"]),b("label",null,N(d.name),1)],8,Gp))),128))])]),_:1},8,["show","cancel-text"])}}}),Kp=ae(jp,[["__scopeId","data-v-cc325d39"]]),Xp={class:"slider-section"},qp={key:0,class:"slider-label"},Qp={class:"slider"},Zp={key:1,class:"num_tip"},Jp={class:"slider-value-content"},eh={class:"slider-value"},th=50,nh=G({__name:"CustomSlider",props:{value:{type:Number,default:0},attrs:{type:Object,default:()=>{}},label:{type:String,default:""},barHeight:{type:Number,default:4},activeColor:{type:String,default:"#28BE44"},inactiveColor:{type:String,default:"#D9D9DE"},disabled:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},sync:{type:Boolean,default:!1}},emits:["update:value","change"],setup(n,{emit:t}){var Be,Ue;fe();const e=n,{value:a,min:i,max:s,label:o,attrs:r,disabled:l,sync:d}=hn(e),c=y(!1),u=M({get(){return Number(a.value)},set(ue){d.value&&re(ue,c.value),ne("update:value",ue)}}),h=i.value,p=s.value,f=((Be=r.value)==null?void 0:Be.step)||1,m=((Ue=r.value)==null?void 0:Ue.fractionDigits)||0,_=y(null),S=y(!1),k=y(!1),A=th,x=M(()=>(u.value-h)/(p-h)*100),O=M(()=>x.value<A?`${x.value}%`:`${A}%`),C=M(()=>x.value<A?`${A-x.value}%`:`${x.value-A}%`),P=()=>{l.value||(S.value=!0,k.value=!0,c.value=!1)},I=ue=>{S.value&&ee(ue)&&U(ue)},D=ue=>{S.value&&(S.value=!1,k.value=!1,ee(ue)&&(c.value=!0,u.value=Math.max(Math.min(u.value,p),h)))},ee=ue=>{if(!l.value)return ue.type.startsWith("touch")?ue.changedTouches.length===1:ue.buttons===1},W=ue=>{ue.type==="click"&&(U(ue),Qe(()=>{re(u.value,!0)})),ue.stopPropagation()},U=ue=>{const me=_.value.getBoundingClientRect(),Mt=((ue.type==="touchmove"?ue.touches[0].clientX:ue.clientX)-me.left)/me.width*(p-h)+h;u.value=Math.max(Math.min(V(Mt),p),h)},V=ue=>{const me=Math.round(ue/f)*f;return Math.min(Math.max(me,h),p)};je(()=>{document.addEventListener("mousemove",I),document.addEventListener("touchmove",I),document.addEventListener("mouseup",D),document.addEventListener("touchend",D)}),Yt(()=>{document.removeEventListener("mousemove",I),document.removeEventListener("touchmove",I),document.removeEventListener("mouseup",D),document.removeEventListener("touchend",D)});const Q=y(!1),ve=M(()=>gt([{id:o,type:"number",value:Number(u.value.toFixed(m)),attrs:{min:h,max:p,defaultValue:0,fractionDigits:1,valueWidth:"100px",keyboardAttrs:{extraKey:h<0?["-","."]:["*"]},onChange:me=>{u.value=me},...r.value}}])),ne=t,re=(ue,me=!1)=>{ne("change",ue,me),Q.value=!1,me&&(c.value=!1)},ke=ue=>{re(ue,!0)},Ae=()=>{l.value||(Q.value=!0)};return(ue,me)=>{const Ne=Gr;return g(),T("div",Xp,[v(o)?(g(),T("div",qp,N(v(o)),1)):le("",!0),b("div",Qp,[b("div",{ref_key:"track",ref:_,class:"slider-track",onMousedown:P,onMousemove:I,onTouchmove:I,onMouseup:D,onTouchend:D,onClick:W,onContextmenu:me[1]||(me[1]=rt(()=>{},["prevent"]))},[b("div",{class:"slider-progress",style:qe({left:O.value,width:C.value})},null,4),b("div",{class:oe(["slider-handle",k.value?"active":""]),style:qe({left:x.value+"%",transform:"translate(-50%, -50%)"}),onMousedown:P,onTouchstart:P,onClick:W,onContextmenu:me[0]||(me[0]=rt(()=>{},["prevent"]))},[k.value?(g(),j(v(wt),{key:0,class:"down_icon f-s-12",name:"down_slider",size:"12px"})):le("",!0),k.value?(g(),T("div",Zp,N(u.value.toFixed(v(m))),1)):le("",!0)],38),b("div",{class:"slider-marker",style:qe({left:v(A)+"%",transform:"translate(-50%, -50%)"})},null,4)],544),b("div",Jp,[b("div",eh,[b("div",{class:"slider-input",onClick:rt(Ae,["stop"])},N(Number(u.value.toFixed(v(m)))),1),w(Ne,{class:"value-icon",name:"play",size:"12px"})]),w(v(is),{show:Q.value,"onUpdate:show":me[2]||(me[2]=Je=>Q.value=Je),"focus-index":0,title:v(o),inputs:ve.value,onKeyboardConfirm:ke},null,8,["show","title","inputs"])])])])}}}),ml=ae(nh,[["__scopeId","data-v-ab279e6b"]]);function ah(){const n=()=>{ce.modal.showToast({duration:0,forbidClick:!0,msg:"mobile.material.loading_text",icon:"loading",layout:"vertical"})},t=()=>{pr()};return es(t),{startLoading:n,stopLoading:t}}const ih={class:"custom-cell-title"},sh={class:"color-inverted-title fl"},eo=2,oh=G({__name:"Outline",props:{value:{type:Object,default:()=>({})},label:{type:String,default:""}},setup(n){const{startLoading:t,stopLoading:e}=ah(),{t:a}=fe(),i=y(!0),s=M(()=>$n().unit),o=y(s.value.current==="in"?eo*s.value.scale:eo),r=M(()=>s.value.current==="in"?-1:-25.4),l=M(()=>s.value.current==="in"?1:25.4),d=M(()=>a("editor.operation.extract_contours_offset")+`(${c(s.value.current)||"mm"})`),c=k=>{switch(k){case"mm":return a("setting.unit_mm");case"in":return a("setting.unit_in");default:return""}},u=gt({min:r.value,max:l.value,step:s.value.current==="in"?.001:.01,scale:1,fractionDigits:s.value.current==="in"?3:2,showValRange:!0}),h=R(ct),p=M(()=>h.uiState.extractIng);Ee(p,k=>{k?t():e()});const f=async()=>{h.sendEvent(new so({offset:Number(hr(o.value).toFixed(u.fractionDigits)),addBitmapInner:i.value}))};function m(){e()}Ee(()=>i.value,()=>{f()});const _=k=>{i.value=k,f()},S=(k,A)=>{A&&(o.value=k,f())};return je(()=>{f()}),es(()=>{m()}),(k,A)=>{const x=fo,O=go,C=Kt;return g(),j(C,{class:"image-gr-wrapper"},{default:B(()=>[b("div",{class:oe(["ment-wrapper",{"wrapper-disabled":p.value}])},[w(v(ml),{value:o.value,"onUpdate:value":A[0]||(A[0]=P=>o.value=P),min:r.value,max:l.value,label:d.value,attrs:u,sync:!0,disabled:p.value,onChange:S},null,8,["value","min","max","label","attrs","disabled"]),w(O,{class:"image-bold-wrap color-inverted-wrap",name:"switch","input-align":"right"},{input:B(()=>[w(x,{modelValue:i.value,"onUpdate:modelValue":A[1]||(A[1]=P=>i.value=P),size:"20px",disabled:p.value,onChange:_},null,8,["modelValue","disabled"])]),label:B(()=>[b("div",ih,[b("span",sh,N(v(a)("editor.operation.extract_contours_add_inner")),1)])]),_:1})],2)]),_:1})}}}),lh=ae(oh,[["__scopeId","data-v-043de3e7"]]),rh={class:"image-ed-wrapper"},ch=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const e=R(ct),a=t,i=()=>{e.sendEvent(new $a(!1))},s=()=>{e.sendEvent(new $a(!0)),a("close")},o=nn([{id:"outline",icon:"canvas-opt-outline",title:"",name:"mobile.editor.panel.design.outline",desc:"",options:{},label:"mobile.editor.panel.design.outline",cmp:lh}]),r=y(o.value[0].id);return es(()=>{e.sendEvent(new $a(!0))}),(l,d)=>{const c=Kt;return g(),T("div",rh,[w(c,{border:!1},{default:B(()=>[w(v(Ca),{active:r.value,"onUpdate:active":d[0]||(d[0]=u=>r.value=u),list:o.value,"show-tips":!0,onOnConfirm:i,onOnCancel:s},null,8,["active","list"])]),_:1})])}}}),dh=G({__name:"InputKeyboard",props:{label:{},showBg:{type:Boolean},kind:{},unit:{},data:{}},emits:["keyboardConfirm"],setup(n,{emit:t}){fe();const e=n,a=y(!1),i=y(0),s=d=>{var c,u;(u=(c=e.data)==null?void 0:c[d])!=null&&u.cmp&&d++,i.value=d,a.value=!0},o=t,r=M(()=>{var d;return((d=e.data)==null?void 0:d.length)<=1}),l=(d,c)=>{o("keyboardConfirm",d)};return(d,c)=>{const u=Kt;return g(),T(Se,null,[w(u,{class:oe(["input-keyboard-wrapper",[d.showBg?"":"white-bg-cls",r.value?"single-input":"multiple-input"]])},{default:B(()=>[(g(!0),T(Se,null,Pe(d.data.filter(h=>!h.cmp),(h,p)=>{var f;return g(),j(v(ro),mn({id:h.id,key:h.id,"model-value":h.value,suffix:(f=d.unit)==null?void 0:f.current},h.attrs,{"dom-props":{kind:d.kind},readonly:"",onClick:rt(m=>s(p),["stop"])}),null,16,["id","model-value","suffix","dom-props","onClick"])}),128))]),_:1},8,["class"]),w(v(is),mn({show:a.value,"onUpdate:show":c[0]||(c[0]=h=>a.value=h),title:d.label,"focus-index":i.value},{inputs:d.data},{onKeyboardConfirm:l}),null,16,["show","title","focus-index"])],64)}}}),fl=ae(dh,[["__scopeId","data-v-7a001711"]]),uh={class:"basic-panel-wrapper"},vh={class:"position-input"},ph=375,hh=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const e=nn({id:"position",icon:"canvas-opt-position",name:"editor.display.position"}),{t:a}=fe(),i=t,s=R(_a),o=y(null),r=y(null),l=M(()=>$n().unit),d=M(()=>{var _;return c((_=l.value)==null?void 0:_.current)}),c=_=>{switch(_){case"mm":return a("setting.unit_mm");case"in":return a("setting.unit_in");default:return""}};ie(()=>s.uiState.x,_=>{o.value=_}),ie(()=>s.uiState.y,_=>{r.value=_});const h=window.innerWidth/ph,p=M(()=>{var _,S;return[{id:"x",type:"number",value:(_=o.value)==null?void 0:_.toFixed(l.value.fractionDigits),attrs:{defaultValue:0,step:l.value.step,scale:l.value.scale,fractionDigits:l.value.fractionDigits,label:a("editor.display.position_x"),valueWidth:`${100*h}px`},keyboardAttrs:{extraKey:["-","."]}},{id:"y",type:"number",value:(S=r.value)==null?void 0:S.toFixed(l.value.fractionDigits),attrs:{defaultValue:0,step:l.value.step,scale:l.value.scale,fractionDigits:l.value.fractionDigits,label:a("editor.display.position_y"),valueWidth:`${100*h}px`},keyboardAttrs:{extraKey:["-","."]}}]}),f=_=>{s.sendEvent(new Io(_))},m=()=>{i("close")};return(_,S)=>(g(),T("div",uh,[w(v(ya),{data:e.value,onOnClose:m},{default:B(()=>[b("div",vh,[w(v(fl),{data:p.value,unit:l.value,"show-bg":!0,label:`${v(a)("mobile.editor.modify_position")}(${d.value})`,onKeyboardConfirm:f},null,8,["data","unit","label"])])]),_:1},8,["data"])]))}}),mh=ae(hh,[["__scopeId","data-v-eada5e62"]]),fh={class:"rotation-wrapper"},gh={class:"rotation-content"},bh=G({__name:"Index",emits:["close"],setup(n,{emit:t}){fe();const e=t,a=y({id:"rotation",icon:"canvas-opt-angle",name:"mobile.editor.modify_rotation"}),i=R(_a),s=y(0),o=gt({step:1,showValRange:!0,valueWidth:"100px"});ie(()=>i.uiState.angle,d=>{s.value=d??0});const r=mr((d,c=!1)=>{i.sendEvent(new Ao({angle:Number(d)},c))},50),l=()=>{e("close")};return(d,c)=>(g(),T("div",fh,[w(v(ya),{data:a.value,onOnClose:l},{default:B(()=>[b("div",gh,[w(v(ml),{value:s.value,"onUpdate:value":c[0]||(c[0]=u=>s.value=u),label:`${d.$t(a.value.name)}(${d.$t("editor.display.rotate_angle")})`,min:-360,max:360,attrs:o,sync:!0,onChange:v(r)},null,8,["value","label","attrs","onChange"])])]),_:1},8,["data"])]))}}),_h=ae(bh,[["__scopeId","data-v-25a82bdf"]]),yh=[{name:"basic-1",file:"svg-shapes/1-basic/basic-1.svg",fileIndex:1},{name:"basic-2",file:"svg-shapes/1-basic/basic-2.svg",fileIndex:2,isOriginSize:0},{name:"basic-3",file:"svg-shapes/1-basic/basic-3.svg",fileIndex:3,isOriginSize:0},{name:"basic-4",file:"svg-shapes/1-basic/basic-4.svg",fileIndex:4,isOriginSize:0},{name:"basic-5",file:"svg-shapes/1-basic/basic-5.svg",fileIndex:5,isOriginSize:0},{name:"basic-6",file:"svg-shapes/1-basic/basic-6.svg",fileIndex:6,isOriginSize:0},{name:"basic-7",file:"svg-shapes/1-basic/basic-7.svg",fileIndex:7,isOriginSize:0},{name:"basic-8",file:"svg-shapes/1-basic/basic-8.svg",fileIndex:8,isOriginSize:0},{name:"basic-9",file:"svg-shapes/1-basic/basic-9.svg",fileIndex:9,isOriginSize:0},{name:"basic-10",file:"svg-shapes/1-basic/basic-10.svg",fileIndex:10,isOriginSize:0},{name:"basic-11",file:"svg-shapes/1-basic/basic-11.svg",fileIndex:11,isOriginSize:0},{name:"basic-12",file:"svg-shapes/1-basic/basic-12.svg",fileIndex:12,isOriginSize:0},{name:"basic-13",file:"svg-shapes/1-basic/basic-13.svg",fileIndex:13,isOriginSize:0},{name:"basic-14",file:"svg-shapes/1-basic/basic-14.svg",fileIndex:14,isOriginSize:0},{name:"basic-15",file:"svg-shapes/1-basic/basic-15.svg",fileIndex:15,isOriginSize:0},{name:"basic-16",file:"svg-shapes/1-basic/basic-16.svg",fileIndex:16,isOriginSize:0},{name:"basic-17",file:"svg-shapes/1-basic/basic-17.svg",fileIndex:17,isOriginSize:0},{name:"basic-18",file:"svg-shapes/1-basic/basic-18.svg",fileIndex:18,isOriginSize:0},{name:"basic-19",file:"svg-shapes/1-basic/basic-19.svg",fileIndex:19,isOriginSize:0},{name:"basic-20",file:"svg-shapes/1-basic/basic-20.svg",fileIndex:20,isOriginSize:0},{name:"basic-21",file:"svg-shapes/1-basic/basic-21.svg",fileIndex:21,isOriginSize:0},{name:"basic-22",file:"svg-shapes/1-basic/basic-22.svg",fileIndex:22,isOriginSize:0},{name:"basic-23",file:"svg-shapes/1-basic/basic-23.svg",fileIndex:23,isOriginSize:0},{name:"basic-24",file:"svg-shapes/1-basic/basic-24.svg",fileIndex:24,isOriginSize:0},{name:"basic-25",file:"svg-shapes/1-basic/basic-25.svg",fileIndex:25,isOriginSize:0},{name:"basic-26",file:"svg-shapes/1-basic/basic-26.svg",fileIndex:26,isOriginSize:0},{name:"basic-27",file:"svg-shapes/1-basic/basic-27.svg",fileIndex:27,isOriginSize:0},{name:"basic-28",file:"svg-shapes/1-basic/basic-28.svg",fileIndex:28,isOriginSize:0},{name:"basic-29",file:"svg-shapes/1-basic/basic-29.svg",fileIndex:29,isOriginSize:0},{name:"basic-30",file:"svg-shapes/1-basic/basic-30.svg",fileIndex:30,isOriginSize:0}],wh=[{name:"festival-1",file:"svg-shapes/2-festival/festival-1.svg",fileIndex:1},{name:"festival-2",file:"svg-shapes/2-festival/festival-2.svg",fileIndex:2,isOriginSize:0},{name:"festival-3",file:"svg-shapes/2-festival/festival-3.svg",fileIndex:3,isOriginSize:0},{name:"festival-4",file:"svg-shapes/2-festival/festival-4.svg",fileIndex:4,isOriginSize:0},{name:"festival-5",file:"svg-shapes/2-festival/festival-5.svg",fileIndex:5,isOriginSize:0},{name:"festival-6",file:"svg-shapes/2-festival/festival-6.svg",fileIndex:6,isOriginSize:0},{name:"festival-7",file:"svg-shapes/2-festival/festival-7.svg",fileIndex:7,isOriginSize:0},{name:"festival-8",file:"svg-shapes/2-festival/festival-8.svg",fileIndex:8,isOriginSize:0},{name:"festival-9",file:"svg-shapes/2-festival/festival-9.svg",fileIndex:9,isOriginSize:0},{name:"festival-10",file:"svg-shapes/2-festival/festival-10.svg",fileIndex:10,isOriginSize:0},{name:"festival-11",file:"svg-shapes/2-festival/festival-11.svg",fileIndex:11,isOriginSize:0},{name:"festival-12",file:"svg-shapes/2-festival/festival-12.svg",fileIndex:12,isOriginSize:0},{name:"festival-13",file:"svg-shapes/2-festival/festival-13.svg",fileIndex:13,isOriginSize:0},{name:"festival-14",file:"svg-shapes/2-festival/festival-14.svg",fileIndex:14,isOriginSize:0},{name:"festival-15",file:"svg-shapes/2-festival/festival-15.svg",fileIndex:15,isOriginSize:0},{name:"festival-16",file:"svg-shapes/2-festival/festival-16.svg",fileIndex:16,isOriginSize:0},{name:"festival-17",file:"svg-shapes/2-festival/festival-17.svg",fileIndex:17,isOriginSize:0},{name:"festival-18",file:"svg-shapes/2-festival/festival-18.svg",fileIndex:18,isOriginSize:0},{name:"festival-19",file:"svg-shapes/2-festival/festival-19.svg",fileIndex:19,isOriginSize:0},{name:"festival-20",file:"svg-shapes/2-festival/festival-20.svg",fileIndex:20,isOriginSize:0},{name:"festival-21",file:"svg-shapes/2-festival/festival-21.svg",fileIndex:21,isOriginSize:0},{name:"festival-22",file:"svg-shapes/2-festival/festival-22.svg",fileIndex:22,isOriginSize:0},{name:"festival-23",file:"svg-shapes/2-festival/festival-23.svg",fileIndex:23,isOriginSize:0},{name:"festival-24",file:"svg-shapes/2-festival/festival-24.svg",fileIndex:24,isOriginSize:0},{name:"festival-25",file:"svg-shapes/2-festival/festival-25.svg",fileIndex:25,isOriginSize:0},{name:"festival-26",file:"svg-shapes/2-festival/festival-26.svg",fileIndex:26,isOriginSize:0},{name:"festival-27",file:"svg-shapes/2-festival/festival-27.svg",fileIndex:27,isOriginSize:0},{name:"festival-28",file:"svg-shapes/2-festival/festival-28.svg",fileIndex:28,isOriginSize:0},{name:"festival-29",file:"svg-shapes/2-festival/festival-29.svg",fileIndex:29,isOriginSize:0},{name:"festival-30",file:"svg-shapes/2-festival/festival-30.svg",fileIndex:30,isOriginSize:0}],Sh=[{name:"plant-1",file:"svg-shapes/3-plant/plant-1.svg",fileIndex:1},{name:"plant-2",file:"svg-shapes/3-plant/plant-2.svg",fileIndex:2,isOriginSize:0},{name:"plant-3",file:"svg-shapes/3-plant/plant-3.svg",fileIndex:3,isOriginSize:0},{name:"plant-4",file:"svg-shapes/3-plant/plant-4.svg",fileIndex:4,isOriginSize:0},{name:"plant-5",file:"svg-shapes/3-plant/plant-5.svg",fileIndex:5,isOriginSize:0},{name:"plant-6",file:"svg-shapes/3-plant/plant-6.svg",fileIndex:6,isOriginSize:0},{name:"plant-7",file:"svg-shapes/3-plant/plant-7.svg",fileIndex:7,isOriginSize:0},{name:"plant-8",file:"svg-shapes/3-plant/plant-8.svg",fileIndex:8,isOriginSize:0},{name:"plant-9",file:"svg-shapes/3-plant/plant-9.svg",fileIndex:9,isOriginSize:0},{name:"plant-10",file:"svg-shapes/3-plant/plant-10.svg",fileIndex:10,isOriginSize:0},{name:"plant-11",file:"svg-shapes/3-plant/plant-11.svg",fileIndex:11,isOriginSize:0},{name:"plant-12",file:"svg-shapes/3-plant/plant-12.svg",fileIndex:12,isOriginSize:0},{name:"plant-13",file:"svg-shapes/3-plant/plant-13.svg",fileIndex:13,isOriginSize:0},{name:"plant-14",file:"svg-shapes/3-plant/plant-14.svg",fileIndex:14,isOriginSize:0},{name:"plant-15",file:"svg-shapes/3-plant/plant-15.svg",fileIndex:15,isOriginSize:0},{name:"plant-16",file:"svg-shapes/3-plant/plant-16.svg",fileIndex:16,isOriginSize:0},{name:"plant-17",file:"svg-shapes/3-plant/plant-17.svg",fileIndex:17,isOriginSize:0},{name:"plant-18",file:"svg-shapes/3-plant/plant-18.svg",fileIndex:18,isOriginSize:0},{name:"plant-19",file:"svg-shapes/3-plant/plant-19.svg",fileIndex:19,isOriginSize:0},{name:"plant-20",file:"svg-shapes/3-plant/plant-20.svg",fileIndex:20,isOriginSize:0},{name:"plant-21",file:"svg-shapes/3-plant/plant-21.svg",fileIndex:21,isOriginSize:0},{name:"plant-22",file:"svg-shapes/3-plant/plant-22.svg",fileIndex:22,isOriginSize:0},{name:"plant-23",file:"svg-shapes/3-plant/plant-23.svg",fileIndex:23,isOriginSize:0},{name:"plant-24",file:"svg-shapes/3-plant/plant-24.svg",fileIndex:24,isOriginSize:0},{name:"plant-25",file:"svg-shapes/3-plant/plant-25.svg",fileIndex:25,isOriginSize:0}],Ch=[{name:"animal-1",file:"svg-shapes/4-animal/animal-1.svg",fileIndex:1},{name:"animal-2",file:"svg-shapes/4-animal/animal-2.svg",fileIndex:2,isOriginSize:0},{name:"animal-3",file:"svg-shapes/4-animal/animal-3.svg",fileIndex:3,isOriginSize:0},{name:"animal-4",file:"svg-shapes/4-animal/animal-4.svg",fileIndex:4,isOriginSize:0},{name:"animal-5",file:"svg-shapes/4-animal/animal-5.svg",fileIndex:5,isOriginSize:0},{name:"animal-6",file:"svg-shapes/4-animal/animal-6.svg",fileIndex:6,isOriginSize:0},{name:"animal-7",file:"svg-shapes/4-animal/animal-7.svg",fileIndex:7,isOriginSize:0},{name:"animal-8",file:"svg-shapes/4-animal/animal-8.svg",fileIndex:8,isOriginSize:0},{name:"animal-9",file:"svg-shapes/4-animal/animal-9.svg",fileIndex:9,isOriginSize:0},{name:"animal-10",file:"svg-shapes/4-animal/animal-10.svg",fileIndex:10,isOriginSize:0},{name:"animal-11",file:"svg-shapes/4-animal/animal-11.svg",fileIndex:11,isOriginSize:0},{name:"animal-12",file:"svg-shapes/4-animal/animal-12.svg",fileIndex:12,isOriginSize:0},{name:"animal-13",file:"svg-shapes/4-animal/animal-13.svg",fileIndex:13,isOriginSize:0},{name:"animal-14",file:"svg-shapes/4-animal/animal-14.svg",fileIndex:14,isOriginSize:0},{name:"animal-15",file:"svg-shapes/4-animal/animal-15.svg",fileIndex:15,isOriginSize:0},{name:"animal-16",file:"svg-shapes/4-animal/animal-16.svg",fileIndex:16,isOriginSize:0},{name:"animal-17",file:"svg-shapes/4-animal/animal-17.svg",fileIndex:17,isOriginSize:0},{name:"animal-18",file:"svg-shapes/4-animal/animal-18.svg",fileIndex:18,isOriginSize:0},{name:"animal-19",file:"svg-shapes/4-animal/animal-19.svg",fileIndex:19,isOriginSize:0},{name:"animal-20",file:"svg-shapes/4-animal/animal-20.svg",fileIndex:20,isOriginSize:0},{name:"animal-21",file:"svg-shapes/4-animal/animal-21.svg",fileIndex:21,isOriginSize:0},{name:"animal-22",file:"svg-shapes/4-animal/animal-22.svg",fileIndex:22,isOriginSize:0},{name:"animal-23",file:"svg-shapes/4-animal/animal-23.svg",fileIndex:23,isOriginSize:0},{name:"animal-24",file:"svg-shapes/4-animal/animal-24.svg",fileIndex:24,isOriginSize:0},{name:"animal-25",file:"svg-shapes/4-animal/animal-25.svg",fileIndex:25,isOriginSize:0},{name:"animal-26",file:"svg-shapes/4-animal/animal-26.svg",fileIndex:26,isOriginSize:0},{name:"animal-27",file:"svg-shapes/4-animal/animal-27.svg",fileIndex:27,isOriginSize:0},{name:"animal-28",file:"svg-shapes/4-animal/animal-28.svg",fileIndex:28,isOriginSize:0},{name:"animal-29",file:"svg-shapes/4-animal/animal-29.svg",fileIndex:29,isOriginSize:0},{name:"animal-30",file:"svg-shapes/4-animal/animal-30.svg",fileIndex:30,isOriginSize:0}],xh=[{name:"border-1",file:"svg-shapes/5-border/border-1.svg",fileIndex:1},{name:"border-2",file:"svg-shapes/5-border/border-2.svg",fileIndex:2,isOriginSize:0},{name:"border-3",file:"svg-shapes/5-border/border-3.svg",fileIndex:3,isOriginSize:0},{name:"border-4",file:"svg-shapes/5-border/border-4.svg",fileIndex:4,isOriginSize:0},{name:"border-5",file:"svg-shapes/5-border/border-5.svg",fileIndex:5,isOriginSize:0},{name:"border-6",file:"svg-shapes/5-border/border-6.svg",fileIndex:6,isOriginSize:0},{name:"border-7",file:"svg-shapes/5-border/border-7.svg",fileIndex:7,isOriginSize:0},{name:"border-8",file:"svg-shapes/5-border/border-8.svg",fileIndex:8,isOriginSize:0},{name:"border-9",file:"svg-shapes/5-border/border-9.svg",fileIndex:9,isOriginSize:0},{name:"border-10",file:"svg-shapes/5-border/border-10.svg",fileIndex:10,isOriginSize:0},{name:"border-11",file:"svg-shapes/5-border/border-11.svg",fileIndex:11,isOriginSize:0},{name:"border-12",file:"svg-shapes/5-border/border-12.svg",fileIndex:12,isOriginSize:0},{name:"border-13",file:"svg-shapes/5-border/border-13.svg",fileIndex:13,isOriginSize:0},{name:"border-14",file:"svg-shapes/5-border/border-14.svg",fileIndex:14,isOriginSize:0},{name:"border-15",file:"svg-shapes/5-border/border-15.svg",fileIndex:15,isOriginSize:0},{name:"border-16",file:"svg-shapes/5-border/border-16.svg",fileIndex:16,isOriginSize:0},{name:"border-17",file:"svg-shapes/5-border/border-17.svg",fileIndex:17,isOriginSize:0},{name:"border-18",file:"svg-shapes/5-border/border-18.svg",fileIndex:18,isOriginSize:0},{name:"border-19",file:"svg-shapes/5-border/border-19.svg",fileIndex:19,isOriginSize:0},{name:"border-20",file:"svg-shapes/5-border/border-20.svg",fileIndex:20,isOriginSize:0},{name:"border-21",file:"svg-shapes/5-border/border-21.svg",fileIndex:21,isOriginSize:0},{name:"border-22",file:"svg-shapes/5-border/border-22.svg",fileIndex:22,isOriginSize:0},{name:"border-23",file:"svg-shapes/5-border/border-23.svg",fileIndex:23,isOriginSize:0},{name:"border-24",file:"svg-shapes/5-border/border-24.svg",fileIndex:24,isOriginSize:0},{name:"border-25",file:"svg-shapes/5-border/border-25.svg",fileIndex:25,isOriginSize:0},{name:"border-26",file:"svg-shapes/5-border/border-26.svg",fileIndex:26,isOriginSize:0},{name:"border-27",file:"svg-shapes/5-border/border-27.svg",fileIndex:27,isOriginSize:0},{name:"border-28",file:"svg-shapes/5-border/border-28.svg",fileIndex:28,isOriginSize:0},{name:"border-29",file:"svg-shapes/5-border/border-29.svg",fileIndex:29,isOriginSize:0},{name:"border-30",file:"svg-shapes/5-border/border-30.svg",fileIndex:30,isOriginSize:0}],Eh=[{name:"others-1",file:"svg-shapes/6-others/others-1.svg",fileIndex:1},{name:"others-2",file:"svg-shapes/6-others/others-2.svg",fileIndex:2,isOriginSize:0},{name:"others-3",file:"svg-shapes/6-others/others-3.svg",fileIndex:3,isOriginSize:0},{name:"others-4",file:"svg-shapes/6-others/others-4.svg",fileIndex:4,isOriginSize:0},{name:"others-5",file:"svg-shapes/6-others/others-5.svg",fileIndex:5,isOriginSize:0},{name:"others-6",file:"svg-shapes/6-others/others-6.svg",fileIndex:6,isOriginSize:0},{name:"others-7",file:"svg-shapes/6-others/others-7.svg",fileIndex:7,isOriginSize:0},{name:"others-8",file:"svg-shapes/6-others/others-8.svg",fileIndex:8,isOriginSize:0},{name:"others-9",file:"svg-shapes/6-others/others-9.svg",fileIndex:9,isOriginSize:0},{name:"others-10",file:"svg-shapes/6-others/others-10.svg",fileIndex:10,isOriginSize:0},{name:"others-11",file:"svg-shapes/6-others/others-11.svg",fileIndex:11,isOriginSize:0},{name:"others-12",file:"svg-shapes/6-others/others-12.svg",fileIndex:12,isOriginSize:0},{name:"others-13",file:"svg-shapes/6-others/others-13.svg",fileIndex:13,isOriginSize:0},{name:"others-14",file:"svg-shapes/6-others/others-14.svg",fileIndex:14,isOriginSize:0},{name:"others-15",file:"svg-shapes/6-others/others-15.svg",fileIndex:15,isOriginSize:0},{name:"others-16",file:"svg-shapes/6-others/others-16.svg",fileIndex:16,isOriginSize:0},{name:"others-17",file:"svg-shapes/6-others/others-17.svg",fileIndex:17,isOriginSize:0},{name:"others-18",file:"svg-shapes/6-others/others-18.svg",fileIndex:18,isOriginSize:0},{name:"others-19",file:"svg-shapes/6-others/others-19.svg",fileIndex:19,isOriginSize:0},{name:"others-20",file:"svg-shapes/6-others/others-20.svg",fileIndex:20,isOriginSize:0},{name:"others-21",file:"svg-shapes/6-others/others-21.svg",fileIndex:21,isOriginSize:0},{name:"others-22",file:"svg-shapes/6-others/others-22.svg",fileIndex:22,isOriginSize:0},{name:"others-23",file:"svg-shapes/6-others/others-23.svg",fileIndex:23,isOriginSize:0},{name:"others-24",file:"svg-shapes/6-others/others-24.svg",fileIndex:24,isOriginSize:0},{name:"others-25",file:"svg-shapes/6-others/others-25.svg",fileIndex:25,isOriginSize:0},{name:"others-26",file:"svg-shapes/6-others/others-26.svg",fileIndex:26,isOriginSize:0},{name:"others-27",file:"svg-shapes/6-others/others-27.svg",fileIndex:27,isOriginSize:0},{name:"others-28",file:"svg-shapes/6-others/others-28.svg",fileIndex:28,isOriginSize:0},{name:"others-29",file:"svg-shapes/6-others/others-29.svg",fileIndex:29,isOriginSize:0},{name:"others-30",file:"svg-shapes/6-others/others-30.svg",fileIndex:30,isOriginSize:0}],Ih={basic:yh,festival:wh,plant:Sh,animal:Ch,border:xh,others:Eh},kh=["basic","festival","plant","animal","border","others"],Ah={class:"shapes-content"},Th=["id","onMousedown"],Oh=["alt","src","onTouchstart"],Dh=["alt","src"],Ph={class:"shapes-title"},to=16,Pi=60,Mi=62,no=8,Mh=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const e=R(ct),a=y(!0),i=t,s=()=>{a.value=!1,i("close")},o=async C=>{e.sendEvent(new ia({type:zn.Shape,name:C.name,file:C.file}))},r=y("basic"),l=y(!1);let d;const c=y(""),u=y(!1),h=(C,P)=>{S||(d=setTimeout(()=>{S||(l.value=!0,c.value=`${C}-${P}`,u.value=!0,window.MeApi.openNative.generateImpactFeedback())},500))},p=()=>{l.value=!1,u.value=!1,clearTimeout(d)},f=y(),m=C=>(C+1)%5===1?(f.value="top-start",[-2,24]):[2,3,4].includes((C+1)%5)?(f.value="top",[33,24]):(f.value="top-end",[document.querySelector(".img-wrap").offsetWidth,24]),_=gt({0:0,1:0,2:0,3:0,4:0,5:0});let S=!1;const k=C=>{_[r.value]=C.target.scrollTop},A=()=>{S=!0},x=()=>{S=!1},O=C=>{if(S)return;u.value&&(C.preventDefault(),C.stopPropagation());const P=document.getElementById("shapes-wrap");if(P){const{left:I,top:D}=(P==null?void 0:P.getBoundingClientRect())??{top:0,left:0},{clientX:ee,clientY:W}=C.touches[0];if(W<D)return;const U=C.view.innerWidth,V=ee-I-to-Number(r.value)*U,Q=V-(Math.floor(V/Pi)-1)*no,ve=W-D-to+_[r.value],ne=ve-(Math.floor(ve/Mi)-1)*no,re=document.querySelector(".img-wrap"),ke=re==null?void 0:re.clientWidth,Ae=re==null?void 0:re.clientHeight,Be=Math.floor(Q/(ke&&ke>Pi?ke:Pi)),Ue=Math.floor(ne/(Ae&&Ae>Mi?Ae:Mi)),ue=document.querySelector(".shapes-title"),{top:me}=ue==null?void 0:ue.getBoundingClientRect(),Ne=document.querySelector(".van-tabs__nav"),{bottom:Je}=Ne==null?void 0:Ne.getBoundingClientRect();Be<5&&W<me&&W>Je&&(c.value=`${r.value}-${Ue*5+Be}`)}};return je(()=>{var C;(C=document.getElementById("editor-box"))==null||C.addEventListener("touchstart",s)}),Yt(()=>{var C;e.sendEvent(new oo),(C=document.getElementById("editor-box"))==null||C.removeEventListener("touchstart",s)}),(C,P)=>{const I=bo,D=di,ee=ui,W=ba;return g(),j(W,{show:a.value,round:"",position:"bottom","close-on-popstate":!0,overlay:!1,teleport:"body",class:"shape-wrapper",style:{overflowY:"hidden"}},{default:B(()=>[b("section",Ah,[w(ee,{active:r.value,"onUpdate:active":P[2]||(P[2]=U=>r.value=U),swipeable:""},{default:B(()=>[(g(!0),T(Se,null,Pe(v(kh),(U,V)=>(g(),j(D,{key:V,title:C.$t(`mobile.editor.${U}`),onTouchmove:A,onTouchend:x},{default:B(()=>[b("section",{id:"shapes-wrap",class:"shapes-panel",onScroll:k},[w(v(ac),{cols:5,gap:"8px"},{default:B(()=>[(g(!0),T(Se,null,Pe(v(Ih)[U],(Q,ve)=>(g(),T("div",{key:ve,id:`img-${V}-${ve}`,class:"img-wrap",onTouchmove:P[1]||(P[1]=ne=>O(ne)),onMousedown:ne=>o(Q)},[(g(),T("img",{key:`img-${V}-${ve}`,alt:Q.name,src:Q.file,draggable:!1,onTouchstart:ne=>h(V,ve),onTouchend:p},null,40,Oh)),c.value===`${V}-${ve}`?(g(),j(I,{key:0,show:l.value,"onUpdate:show":P[0]||(P[0]=ne=>l.value=ne),class:"preview-container",placement:f.value,"show-arrow":!1,offset:m(ve)},{default:B(()=>[b("img",{class:"preview-double-img",alt:Q.name,src:Q.file,draggable:!1},null,8,Dh)]),_:2},1032,["show","placement","offset"])):le("",!0)],40,Th))),128))]),_:2},1024)],32)]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),b("section",Ph,[b("span",null,N(C.$t("mobile.editor.insert_shape")),1)])]),_:1},8,["show"])}}}),Bh=ae(Mh,[["__scopeId","data-v-c633aa2d"]]),Lh=G({__name:"Index",props:{icon:{}},setup(n){const t=R(ct),e=()=>{t.sendEvent(new Qn(_t.LOCK))};return(a,i)=>{const s=Ce,o=jt;return g(),j(o,mn(a.$attrs,{type:"default",style:{padding:"0px",border:"none","font-size":"0"},onClick:e}),{default:B(()=>[w(s,{name:a.icon,class:"f-s-24"},null,8,["name"])]),_:1},16)}}}),zh={class:"basic-panel-wrapper"},Rh={class:"size-input"},$h=375,Fh=G({__name:"Index",emits:["close"],setup(n,{emit:t}){const e=nn({id:"size",icon:"canvas-opt-size",name:"editor.display.size"}),{t:a}=fe(),i=t,s=R(_a),o=R(ct),r=y(0),l=y(0),d=y(!1),c=M(()=>$n().unit),u=M(()=>{var k;return h((k=c.value)==null?void 0:k.current)}),h=k=>{switch(k){case"mm":return a("setting.unit_mm");case"in":return a("setting.unit_in");default:return""}};ie(()=>s.uiState.width,k=>{r.value=k??0}),ie(()=>s.uiState.height,k=>{l.value=k??0}),ie(()=>o.uiState.selectAttrs.lockRatio,k=>{d.value=k});const f=window.innerWidth/$h,m=M(()=>[{id:"width",type:"number",value:r.value.toFixed(c.value.fractionDigits),attrs:{defaultValue:0,step:c.value.step,scale:c.value.scale,fractionDigits:c.value.fractionDigits,min:0,label:a("editor.display.size_width"),valueWidth:`${100*f}px`},keyboardAttrs:{extraKey:["."]}},{id:"update-lock",type:"component",cmp:kl(Lh),attrs:{icon:d.value?"canvas-opt-size-lock":"canvas-opt-size-unlock",onClick:()=>{}}},{id:"height",type:"number",value:l.value.toFixed(c.value.fractionDigits),attrs:{defaultValue:0,step:c.value.step,scale:c.value.scale,fractionDigits:c.value.fractionDigits,min:0,label:a("editor.display.size_height"),valueWidth:`${100*f}px`},keyboardAttrs:{extraKey:["."]}}]),_=k=>{Object.keys(k).length&&(s.sendEvent(new ko(k)),d.value&&Qe(()=>{l.value=0,l.value=s.uiState.height}))},S=()=>{i("close")};return(k,A)=>(g(),T("div",zh,[w(v(ya),{data:e.value,onOnClose:S},{default:B(()=>[b("div",Rh,[w(v(fl),{data:m.value,unit:c.value,"show-bg":!0,label:`${v(a)("mobile.editor.modify_size")}(${u.value})`,onKeyboardConfirm:_},null,8,["data","unit","label"])])]),_:1},8,["data"])]))}}),Nh=ae(Fh,[["__scopeId","data-v-1e6897ec"]]),Hh={class:"default"},Vh=["onClick"],Uh=G({__name:"Index",setup(n){const{t}=fe(),e=R(Gt),a=M(()=>{const h=Dt().hasBackgroundImage;return console.log("====hasBackgroundImage====",h),h}),i=M(()=>{const h=Dt().backgroundVisible;return console.log("====useCanvasStore().backgroundVisible====",h),h}),s=M(()=>e.uiState.isShowStickerAction),o=M(()=>e.uiState.isShowCameraLocation),r=M(()=>a.value&&i.value);tt(()=>e.uiEffect.showToast,h=>{ce.modal.showToast({msg:t(h.msgKey)})});const l=y(!0),d=y([{name:o.value?t("mobile.editor.panel.main.snapshot_preview"):t("device.common.refresh"),id:0,icon:o.value?"snapshot-preview":"snapshot-refresh",isShow:!0,disabled:!1},{name:t("mobile.editor.snap_shot.hide_background"),id:1,icon:"snapshot-hide",isShow:r.value,disabled:!1},{name:t("mobile.editor.snap_shot.display_background"),id:2,icon:"snapshot-display",isShow:!r.value,disabled:!a.value},{name:t("mobile.editor.snap_shot.calibrate"),id:3,icon:"snapshot-calibrate",isShow:s,disabled:!1}]),c=M(()=>d.value.filter(h=>h.isShow)),u=h=>{if(console.log("onActionClick",h),!h.disabled)switch(l.value=!1,h.id){case 0:o.value?e.sendEvent(new Yn({id:Gn.take_picture})):e.sendEvent(new Yn({id:Gn.refresh_bg}));break;case 1:e.sendEvent(new Yn({id:Gn.togglePic}));break;case 2:e.sendEvent(new Yn({id:Gn.togglePic}));break;case 3:e.sendEvent(new Yn({id:Gn.sticker}));break}};return Yt(()=>{console.log("====onUnmounted====")}),(h,p)=>{const f=ss;return g(),j(f,{show:l.value,"onUpdate:show":p[0]||(p[0]=m=>l.value=m),"cancel-text":h.$t("mobile.common.cancel"),"close-on-click-action":""},{default:B(()=>[b("div",Hh,[(g(!0),T(Se,null,Pe(c.value,m=>(g(),T("div",{key:m.id,class:"img-action",onClick:_=>u(m)},[w(v(wt),{name:m.icon,size:"20px",color:m.disabled?"#B0B2B5":"#545458",class:"f-s-20"},null,8,["name","color"]),b("label",{class:oe([m.disabled?"label_disabled":"label"])},N(m.name),3)],8,Vh))),128))])]),_:1},8,["show","cancel-text"])}}}),Wh=ae(Uh,[["__scopeId","data-v-79a10b92"]]);var ut=(n=>(n.Snapshot="snapshot",n.Image="image",n.Text="text",n.Shape="shape",n.Graffiti="graffiti",n.Layer="layer",n.Canvas="canvas",n.Setting="setting",n))(ut||{});const Yh=()=>{const n=R(Gt);return M(()=>{const e=n.uiState.isShowCameraLocation||n.uiState.isShowRefreshBg;return console.log("=====showSnapshot",e),[{id:"snapshot",icon:"canvas-tool-snapshot",label:n.uiState.isShowCameraLocation?"mobile.editor.panel.main.snapshot_preview":"device.common.capture_alignment",cmp:Wh,isShow:e},{id:"image",icon:"canvas-tool-image",label:"mobile.editor.panel.main.image",cmp:Kp,isShow:!0},{id:"text",icon:"canvas-tool-text",label:"mobile.editor.panel.main.text",cmp:"",isShow:!0},{id:"shape",icon:"canvas-tool-shape",label:"mobile.editor.panel.main.shape",cmp:Bh,isShow:!0},{id:"graffiti",icon:"canvas-tool-graffiti",label:"mobile.editor.panel.main.graffiti",cmp:Wp,isShow:!0},{id:"layer",icon:"canvas-tool-layer",label:"mobile.editor.panel.main.layer",cmp:Eu,isShow:!0},{id:"canvas",icon:"canvas-tool-canvas",label:"mobile.editor.panel.main.canvas",cmp:Bu,isShow:!0}].filter(i=>i.isShow)})},Gh=()=>{const n=R(Ze),t=R(ct),e=R(pc),a=R(Hn),i=R(_a),s=M(()=>{const{isGroup:r,enableGroup:l}=e.uiState,d=r&&!l;return[{id:"group",icon:d?"canvas-opt-ungroup":"canvas-opt-group",name:d?"editor.context_menu.ungroup":"editor.context_menu.group",hide:t.uiState.selectedNum<2&&!d,onClick:()=>{e.sendEvent(new So(d?sa.break:sa.create))}},{id:"outline",value:"outline",icon:"canvas-opt-outline",name:"mobile.editor.panel.design.outline",component:ch},{id:"copy",value:"copy",icon:"canvas-opt-copy",name:"mobile.editor.panel.design.copy",onClick:()=>{t.sendEvent(new Qn(_t.COPY_PASTE))}},{id:"lock",value:"lock",icon:t.uiState.selectAttrs.lockRatio?"canvas-opt-size-lock":"canvas-opt-size-unlock",name:t.uiState.selectAttrs.lockRatio?"mobile.editor.panel.design.lock":"mobile.editor.panel.design.un_lock",onClick:()=>{t.sendEvent(new Qn(_t.LOCK))}},{id:"delete",value:"delete",icon:"canvas-opt-delete",name:"mobile.editor.panel.design.delete",onClick:()=>{t.sendEvent(new Qn(_t.DELETE))}}].filter(c=>!c.hide)});return{basicActions:M(()=>{var c,u;const r=((c=n.uiState.selected)==null?void 0:c.num)??0,l=a.uiState.enableText,d=n.uiState.imageSelected;return[{id:"layer",icon:"canvas-opt-layer-top",name:"editor.operation.layer",childClick:h=>{i.sendEvent(new Eo(h.value??""))},child:[{id:"LAYER-TOP",value:"TOP",icon:"canvas-opt-layer-top",name:"editor.operation.layer_top"},{id:"LAYER-DOWN",value:"DOWN",icon:"canvas-opt-layer-down",name:"editor.operation.layer_down"},{id:"LAYER-UP",value:"UP",icon:"canvas-opt-layer-up",name:"editor.operation.layer_up"},{id:"LAYER-BOTTOM",value:"END",icon:"canvas-opt-layer-bottom",name:"editor.operation.layer_end"}]},{id:"align",icon:"canvas-opt-layout",name:"editor.operation.align",hide:r<2,childClick:h=>{i.sendEvent(new xo(h.value??""))},child:[{id:"ALIGN_TYPE.LEFT",value:$e.LEFT,icon:"canvas-opt-align-left",name:"editor.operation.align_left",disable:t.uiState.selectedNum<2},{id:"ALIGN_TYPE.VERTICAL_CENTER",value:$e.VERTICAL_CENTER,icon:"canvas-opt-align-vertical",name:"editor.operation.align_vertical",disable:t.uiState.selectedNum<2},{id:"ALIGN_TYPE.RIGHT",value:$e.RIGHT,icon:"canvas-opt-align-right",name:"editor.operation.align_right",disable:t.uiState.selectedNum<2},{id:"ALIGN_TYPE.TOP",value:$e.TOP,icon:"canvas-opt-align-top",name:"editor.operation.align_top",disable:t.uiState.selectedNum<2},{id:"ALIGN_TYPE.HORIZONTAL_CENTER",value:$e.HORIZONTAL_CENTER,icon:"canvas-opt-align-horizontal",name:"editor.operation.align_horizontal",disable:t.uiState.selectedNum<2},{id:"ALIGN_TYPE.BOTTOM",value:$e.BOTTOM,icon:"canvas-opt-align-bottom",name:"editor.operation.align_bottom",disable:t.uiState.selectedNum<2,dividingRight:!0},{id:$e.HORIZONTAL_DISTRIBUTE,value:$e.HORIZONTAL_DISTRIBUTE,icon:"canvas-opt-distribute-horizontal",name:"editor.operation.distributed_horizontal",disable:t.uiState.selectedNum<3},{id:"ALIGN_TYPE.VERTICAL_DISTRIBUTE",value:$e.VERTICAL_DISTRIBUTE,icon:"canvas-opt-distribute-vertical",name:"editor.operation.distributed_vertical",disable:t.uiState.selectedNum<3}]},{id:"flip",icon:"canvas-opt-flip",name:"editor.operation.flip",childClick:h=>{i.sendEvent(new To({[h.id]:!0}))},child:[{id:"flipX",icon:"canvas-opt-flip-vertical",name:"editor.operation.flip_vertical"},{id:"flipY",icon:"canvas-opt-flip-horizon",name:"editor.operation.flip_horizontal"}]},{id:"layer-move",icon:"canvas-opt-layer-move",name:"editor.layer.move_to",component:_d},{id:"position",icon:"canvas-opt-position",name:"editor.display.position",component:mh},{id:"size",icon:"canvas-opt-size",name:"editor.display.size",component:Nh},{id:"angle",icon:"canvas-opt-angle",name:"mobile.editor.modify_rotation",component:_h},{id:"combine",icon:"canvas-opt-combine",name:"editor.operation.bool",hide:!e.uiState.enableCombine,childClick:h=>{e.sendEvent(new Co(h.value))},child:[{id:"BOOL_OP.UNION",value:Aa.UNION,icon:"canvas-opt-combine-diffrence",name:"editor.operation.bool_union"},{id:"BOOL_OP.DIFFERENCE",value:Aa.DIFFERENCE,icon:"canvas-opt-combine-union",name:"editor.operation.bool_subtract"},{id:"BOOL_OP.INTERSECTION",value:Aa.INTERSECTION,icon:"canvas-opt-combine-intersection",name:"editor.operation.bool_intersect"},{id:"BOOL_OP.XOR",value:Aa.XOR,icon:"canvas-opt-combine-xor",name:"editor.operation.bool_exclude"}]},{id:"font",icon:"canvas-opt-font",name:"mobile.editor.font_setting",hide:!l,component:wv},{id:"font-weld",icon:"canvas-opt-font-weld",name:"editor.display.text_weld",hide:!l||r!==1,disable:fr((((u=n.uiState.selectedAttrs)==null?void 0:u.text)??"").replace(/\s/g,"")).length<2,onClick:()=>{a.sendEvent(Ut.createTextEvent(Ve.textWeld,Ve.textWeld))}},{id:"image-editor",icon:"canvas-opt-image-editor",name:"editor.drawer_title.edit_image",hide:!d,fullScreen:!0,component:jv},{id:"image-filter",icon:"canvas-opt-image-filter",name:"editor.image_filter.filter",hide:!d,component:_p},{id:"image-setting",icon:"canvas-opt-image-adjust",name:"editor.image_adjust.adjust",hide:!d,component:ep}].filter(h=>!h.hide)}),quickActions:s}},jh="mobile.editor.panel.design.quick_title",Kh="mobile.editor.panel.design.basic_title",Xh={class:"panel-content"},qh={key:0},Qh={key:1,class:"panel-header"},Zh={class:"header-title"},Jh={class:"panel-default"},em=G({__name:"FloatingPanel",props:{value:{type:Boolean,default:!1},height:{type:Number,default:0},anchors:{type:Array,default:[0,Math.round(.94*window.innerHeight)]},mask:{type:Boolean,default:!0},title:{type:String,default:"Title"},titleIcon:{type:String,default:"close"},closeOnClickOverlay:{type:Boolean,default:!1},contentDraggable:{type:Boolean,default:!1},panelClass:{type:String,default:""},useHeight:{type:Boolean,default:!1},teleport:{type:String,default:"body"}},emits:["update:value","heightChange","close"],setup(n,{emit:t}){var m;const e=n;Al();const a=y(!1),i=y(0),s=t,{value:o,mask:r,anchors:l}=hn(e),d=((m=l==null?void 0:l.value)==null?void 0:m.length)-1,{useHeight:c,height:u}=hn(e);Wa(()=>{a.value=o.value,c.value?i.value=u.value:i.value=o.value?(l==null?void 0:l.value[d])||window.innerWidth*.6:0}),Ee(a,_=>{});const h=()=>{a.value=!1,s("update:value",!1),s("close")};Wa(()=>{i.value===0&&h()});const p=()=>{r.value&&e.closeOnClickOverlay&&h()},f=_=>{s("heightChange",_)};return(_,S)=>{const k=Ce,A=jr;return g(),j(an,{to:n.teleport},[b("div",null,[w(Ji,{name:"van-fade"},{default:B(()=>[Oe(b("div",{class:"floating-mask",onClick:p},null,512),[[Fe,v(r)&&a.value]])]),_:1}),w(A,mn({height:i.value,"onUpdate:height":S[0]||(S[0]=x=>i.value=x),anchors:v(l),"content-draggable":n.contentDraggable,class:n.panelClass||"floating-panel",style:{transition:"transform 0.4s ease"}},_.$attrs,{onHeightChange:f}),{default:B(()=>[b("div",Xh,[_.$slots.header?(g(),T("div",qh,[aa(_.$slots,"header",{},void 0,!0)])):(g(),T("div",Qh,[b("span",Zh,N(n.title),1),w(k,{class:"header-close f-s-30",color:"#545458",name:n.titleIcon,size:"30px",onClick:h},null,8,["name"])])),b("div",Jh,[aa(_.$slots,"default",{},void 0,!0)])])]),_:3},16,["height","anchors","content-draggable","class"])])],8,["to"])}}}),tm=ae(em,[["__scopeId","data-v-1a9364ce"]]),nm="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALEAAACwCAYAAABAdY9gAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAt9SURBVHgB7d1bbBxXGQfwb2++xOvYji9JDE68QWl4QBAEPMBDSISKeCEtUhEVqVQkEEEKD2lpnkhKQ4JQEdc3Il4QbSohkEjDG31IUiQKUpHSIi5VFa2NHSd2fNn1ddfeS8839jjr2TOzO7szmzln/j9ps854PXHGf5/95lxmiAAAAAAAAAAAAAAAAAAAAAAAAAAelQhpIJ2eOUrR4hMlKo1GypFRAkdlooz441aUItdSqf1jpDjlQ5wen/pFqUxnCRoSjUReSh3cf5EUpnSIEWBvqB5kZUP8fvre8WikfIPAE8Vy/JOPpYZuk4LipKholJ7l4k4mnohz60KwU6lcpsJGQfq5KK1/Qzwp+a6mbIipXD5q3RSLxaivt5va2hIEcrncOmUXl6lYLO7YHo1EP0GKipK6eq0bBvp7EOAaOjraqFf8outE5RDvwD8cbomhtnbxi67TL7u65YRFIu7/f6VUKtHY5IyoK4vkh87OdhoZHqBWiMdEFUx60KYlbpVSsUR+sTvpAmfatMStEBVdIgdH9tKGT2HraEc93wiE2KVEPGY8IDhQToDyEGJQHkIMykOIQXkIMSgPIQblIcSgPIQYlIcQg/IQYlAeQgzKQ4hBeQgxKA8hDrhMJkPXr79uPIMcQhxwP7p8ib721aeMZ5BDiAMum81uPqMltoUQg/IQYlAeQgzKQ4hBeQhxCH37W9+kz3zqKE1OTpAOEOKQ4QC/8srvjAD/9z//Jh0gxCFiBpidfe4cPf7FL5EOcN2JkKgM8PkLF+jMd8/S6lqedICWOASsAf7++RdJJwix5nQPMEOINRaGADOEWFNhCTBDiDUUpgAzhFgzYQswQ4gD7sDBg5vPo6M1XxvGADP0Ewfc+fMX6NixY+LxecfXnXvhe6EMMENLrIBaAWavhjTADC2xJn7/hz8a6/BOnnyCwgYh1kQ9rbWuUE6A8tASt9BGoUD5fMG4+xLfE4/xHZna2xOUSMRaci8+HeGo+Yxniq2s5Ci7tCKCW3Z8Ld+ViW/I2L+nG4F2AUfKJxze+YUlV9MdNwpF2lhapUXx2CXCvHeoF2GuA46Qx7hkmJ7JND1Xl78+PT5Nvb1JGujrNsoOkMOR8VAuv0ETU7OeTjbPZJZpfGLG+OUAObTEHuESYGY241j3RqMRo0zgEoE/Zvz6/PqGY/C5zJi8O0sf/tBA3eXF5UuXtgdAZPjEslze8b0eF4+0ePClhk5sPSsBIfYAB/j+zILt5zm4e0RJwM92OFTL4gRwdmGRChvFqs+7DfJf37xF4+Nj5NLo1vNR8bhJioiQou6MTXGrMWr+vTu5i7q7u6jVnALMvQ17h/ocw2u3T7swc3fcyPBAzRp5fHyc3hRBtrO2mhPvAOvbf5+bm7v98o8v/0p8OEYKBZghxE1wCnC9YbPDLe/E1ANpkPtFq96/Zzc1I5NZ3FHCiCDcPDQ6fIIUhBO7BvFbv18BZtyKjwwPUlwMgljNia47nOg9hBA3iIMqC5gXATaZQTZPAivNzS8RbEKIGyRrKb0McOW/09eTrNrOpYw5dB12CHETKoPsR4BNXP/KWuPs4ioBQtw0M8h+Bdgka42XRQ8DIMSe4CC7DTCP7rk5Odu9u7rnJS/2AQhxTVx7et0TwAGeFN1nPHhR7743f1F2lhRcExfQS4EQOzH7gd2ErRYzwDzcbI7C1bvvjva2qm3rkn7ksEGIbVQOZLgNm53KAJvc7DsejxFUQ4glZCNxzQZZFmBTNBalWB01daGAVlcGIbZwGkquN2xWTgH2s2suLHDkKnDYeDqlTKNh8zLAufx61bYOsY+wQ4i3cJkwNT3naWvpZYB5so51P4107ekIR2ALz0VoZuqjldclBJc51ftpI0CIDYtbizOtghJgfpdYzVWv/Eh2dRAgxAaegG7Fb9XD+/ofeYCZ7F2Cv7/d3bsIEGKj1pSVEYMDvUZQ3PAjwDxvWfYugQA/FPoQywLCy4ncvlX7EWDe5/2Z+artRiu8u/VLsYIKLbGk1uRFnW74FWC7ffLUzARG77aFOsR50e9qLSU4bG4WdrY6wDwlE6XETqEO8YZkGNfN4EGrA8z75Ou0wU7hDrGsX7itvhA/igBjeFou1EdEtkZNtgzIyq+wxWJRY36Gl/sMAxyVBvgVtlYtPtVNqI9MIlF9Oaha1xA2vs7HsLVq8alOQn0tNlnpkFuvb92aGTa+Sg9Pz/QybOa+Y+L7Q4BrC3WIZRNoePEl18r1hMfPsKEfuH7hLidEUKxX8TGuTrlc/1L4Vqx0Bmehf6/q3lU9vJxd9u+iJI2sdAZnoQ9xV1dn1ba1tTwtZFfIa82sdAZ7oQ8xDzF3SoaZ5+YXPQ1YsyudwR5OfWnzer9WXBt7FTAvVjqDPRw92myN+3qqpzZ60VLyfGAMJfsLR28LT2+UXW+Ygzw+8cB1jcwt+YO5LE3dn0OAfYYbz2yJGgMWg9JbDBiBnM1QJrNEvT1JSiY7bG/+Us8dRBFgbyHEFSpH4ezuYMStKz94tI+vjWYGkS/st27cs9l52BoB9h5CbFEryCYOq9ubLvJk9qGBHgTYYziaEhzkQwf2SXstGsGt9mB/D+0b6kOAfYCW2AGf7PGCTO4zli0orYXDy8uJ+nqTdYV3qbBC12f+Ynx8Ys/naLhjL0FtCHEN3CpzC8qB5pE8DjNfE82u9uXgJsUooLli2k3L+/TtMzSVnzY+vjJxlX7zsZ/Qka5DBM4Q4jpxmBOipjUXaXLfceXyJg5rW6Lxa6Ndn3ljO8CMW+Wfpq+IIL9M4AwFWoO4i41bW/PBC0ybqXeXCstV297OvmuEG5whxAHx6Z6PS7dza8ytshtuX686hDggjnR9hL6+/8mq7RzIq1N/kn6N+blf//9VmspN02v3rtGxfzxlPJ7/3w9DE2bUxAHynQPP0J8fvFEVPg7nyaHH6ebCW3T17jXqjifpy0NfoNemXt+uo/k1lV93Y+4t8efP6OcffZF0hxAHSHe8i06PPGOUEJU4nE+/c+ZhSEVw30vfqXqNFQeZ62q7UkUXKCcC5tTwkzTcXt0/3GhpwF11ukOIA+ji4efJK9wSXxWlhs4Q4gDit38vS4Ar4sRP55M8hDigvGyNnXo4dIAQBxTXxadHTpFXuPeCu+F0hBAH2Knhrxg9Fl7g1ljXkzyEOMDMLjev3Jj/m5a1MUIccNzl5tVJ3uZUT/3mYiDEAVQ5nMxdZF7Wxm8vvku6wYhdwBijc5Z5xV7Vxeyehid3aIkDhuvWynnFzMs6ludd6AYhDhi/u8Ee26XfShGEOGD8nqzDJ4q6QYgDhkMsm1fshRdSp7VcfIoTuwA6d+g0nej/rNEd9s/sv6pq5EZwgHVshRlCHFCVk4DeW7ljdLXdnP+78ewGrxi5ePg541lXCLECOID84GFobpU3A7054d2u54K75bgs4dUiukOIFcMTg3ipEj+YuXpjubgZ5mSsi44kDxkXX/GyfznIEGLFce3MjzBD7wQoDyEG5SHEoDyEGJSHEIPyEGJQHkIMykOIQXkIMSgPIQblIcSgPIQYlIcQg/IQYlAepmJa8M3Ic/kNCqJm79CkK4TYYvLuLOXWgxlivoce3xgSdkKILTo726hYLlMQ8f3yoJo2Ic6L1tOL24kPDvTSIOmvUCyRLrQpsNZFiPMBLQOCZnU1ZxwvXWh1lpDJLBk/ILC3vLJGi4vLpBNlywlRtt6KRGi0cluxWKRMdsn4IcUTKPcrlcUBKxaKVLKp90vl0jukKHVDTJHfRqj8rOxz/IPS6e2yFWIU+yUpStly4nBq/00R1osEzRPHMZXaP0aKipDi3k/ffSkaifyAoBGZUpkuHk4NK9sKM+VDzNLpe6NFouOiKj4aiUZ6CByVS+WsKCBuxyh3LZVKZQgAAAAAAAAAAAAAAAAAAAAAAAAAAMLqA/1TdFlCrKs0AAAAAElFTkSuQmCC",am={key:0,class:"processing-data-form"},im={key:1},sm=G({__name:"ParamContent",setup(n){const{t}=fe(),e=Dt(),a=R(Ze),i=$n(),{unit:s}=Ka(i),o=Xe(),{ext:r,info:l,connected:d}=Ka(o),c=M(()=>Dt().canvasId),{deviceValues:u,elementValues:h,elementDataHandler:p,updateSelectedElements:f}=ci(),m=M(()=>(console.log("[当前设备实例]=>",r.value),console.log("[当前画布ID]=>",c.value),r.value&&c.value?r.value.uiApp:"")),_=y([]),S=y([]);ie(()=>a.uiState.selected,O=>{S.value=O.data.map(({id:C,type:P,isFill:I,sourceId:D})=>({id:C,type:P,isFill:I,sourceId:D}))}),Ee([()=>S.value,()=>{var O;return(O=r.value)==null?void 0:O.dataSource}],([O],[C,P])=>{(!co(O,C)||ts(P))&&(f(O),_.value=O)},{immediate:!0});const k=M(()=>zt(gr(_.value,"type").map(O=>O==="BITMAP"?"BITMAP":"VECTOR"))),A=()=>{x(!1)},x=(O=!0)=>{if(c.value&&_.value){const P=_.value.filter(I=>O?I.type==="BITMAP":I.type!=="BITMAP").map(I=>I.id);e.selectSpecDisplays(P)}};return(O,C)=>{var I;const P=Kr;return g(),T(Se,null,[v(r)?(g(),T("div",am,[(g(),j(it((I=m.value)==null?void 0:I.ProcessingDataForm),{key:`${v(r).id}-${c.value}-${v(r).uiAppRenderKey}`,ext:v(r),unit:v(s),connected:v(d),"canvas-id":c.value,elements:_.value,"device-info":v(l),"selected-types":k.value,"element-values":v(h),"device-values":v(u),handler:v(p),"handle-select-vector":A,"handle-select-bitmap":x},null,8,["ext","unit","connected","canvas-id","elements","device-info","selected-types","element-values","device-values","handler"]))])):le("",!0),v(r)?le("",!0):(g(),T("div",im,[w(P,{image:v(nm),"image-size":[88,88],description:v(t)("device.status.please_connect_device"),class:"van-empty-box"},null,8,["image","description"])]))],64)}}}),om=ae(sm,[["__scopeId","data-v-3adf7597"]]),lm=375,gl=G({__name:"EditorPanel",setup(n){const t=R(Ze),e=y("design"),{basicActions:a,quickActions:i}=Gh(),s=M(()=>a.value.length>5),r=window.innerWidth/lm,l=y(s.value?348*r:311*r),d=y([85*r,l.value]),c=y("custom-editor-panel"),{t:u}=fe(),h=y([{id:0,label:u("mobile.editor.panel.basic.design")},{id:1,label:u("mobile.editor.panel.basic.parameter")}]),p=y(!1);ie(()=>t.uiState.isZooming||t.uiState.isTransformTouch,I=>{p.value=I});const f=M(()=>p.value?St(S.value)?d.value[0]:0:d.value[1]),m=y();let _=y(!1);Ee(()=>{var I;return(I=m==null?void 0:m.value)==null?void 0:I.isOnTouch},I=>{_.value=I});const S=y({}),k=I=>{I.id==="image-filter"?$(F.buttonClick,{elementId:q.filter}):I.id==="image-setting"?$(F.buttonClick,{elementId:q.imageAdjust}):I.id==="outline"?$(F.buttonClick,{elementId:q.imageOutline}):I.id==="image-editor"?$(F.buttonClick,{elementId:q.imageEdit}):I.id==="image-traceing"?$(F.buttonClick,{elementId:q.imageTrace}):I.id==="layer"?$(F.buttonClick,{elementId:q.arrange}):I.id==="align"?$(F.buttonClick,{elementId:q.align}):I.id==="flip"?$(F.buttonClick,{elementId:q.flip}):I.id==="layer-move"?$(F.buttonClick,{elementId:q.layerMove}):I.id==="position"?$(F.buttonClick,{elementId:q.position}):I.id==="size"?$(F.buttonClick,{elementId:q.size}):I.id==="angle"?$(F.buttonClick,{elementId:q.angle}):I.id==="font"?$(F.buttonClick,{elementId:q.font}):I.id==="font-weld"&&$(F.buttonClick,{elementId:q.fontWeld}),(I.child||I.component)&&(S.value=I)},A=R(ct),x=R(Nn);ie(()=>A.uiState.selectedIds,(I,D)=>{!co(zi(I),zi(D))&&!x.uiState.imageEditor&&(S.value={})});const O=()=>{S.value={}};je(()=>{e.value=localStorage.getItem("tabName")||"design"});const C=y(Math.random()),P=()=>{C.value=Math.random(),localStorage.setItem("tabName",e.value)};return(I,D)=>{const ee=di,W=ui,U=ba;return g(),T(Se,null,[w(v(tm),{height:f.value,value:v(St)(S.value),anchors:d.value,"panel-class":c.value,mask:!1,"content-draggable":!0,"use-height":p.value,class:oe(["editor-panel guide-editor-panel",{"panel-is-opacity":p.value}]),teleport:".editor-container"},{header:B(()=>[w(W,{active:e.value,"onUpdate:active":D[0]||(D[0]=V=>e.value=V),class:"editor-panel-tabs",onChange:P},{default:B(()=>[w(ee,{title:h.value[0].label,name:"design"},{default:B(()=>[w(v(Rs),{"action-list":v(i),title:v(jh),onSelected:k},null,8,["action-list","title"]),w(v(Rs),{"action-list":v(a),title:v(Kh),onSelected:k},null,8,["action-list","title"])]),_:1},8,["title"]),w(ee,{title:h.value[1].label,name:"parameter"},{default:B(()=>[(g(),j(om,{key:C.value}))]),_:1},8,["title"])]),_:1},8,["active"])]),default:B(()=>[]),_:1},8,["height","value","anchors","panel-class","use-height","class"]),w(U,{show:!v(St)(S.value),position:"bottom",round:!S.value.fullScreen,overlay:!1,"overlay-style":{background:"transparent"},"close-on-click-overlay":!0,closeable:!1,"before-close":O,class:oe(["popup-shadow",{"popup-is-opacity":p.value,"tabs-is-opacity":v(_),fullScreen:S.value.fullScreen}])},{default:B(()=>[S.value.component?(g(),j(it(S.value.component),{key:0,ref_key:"secondComRef",ref:m,onClose:O},null,544)):le("",!0),S.value.child?(g(),j(v(ya),{key:1,data:S.value,onOnClose:O},null,8,["data"])):le("",!0)]),_:1},8,["show","round","class"])],64)}}}),rm={class:"editor-tools-wrap"},cm={class:"btn-container"},dm={class:oe(["tools-wrapper","guide-editor-elements"])},um=["onClick"],vm={class:"setting"},pm={key:0,class:"btn-container-mask"},hm=G({__name:"EditorTools",props:{toolDisabled:{type:Boolean}},emits:["open","openProcessPanel"],setup(n,{emit:t}){const e=R(Gt);console.log("====EditorTools==== 进入画布"),e.sendEvent(new xs),Ee([()=>Xe().currentInstanceId,()=>xn().currentMode,()=>Dt().canvasId],([d,c,u])=>{console.log(`====watch currentInstanceId=${d} currentMode=${c} canvasId=${u}`),e.sendEvent(new xs),e.sendEvent(new Ri),e.sendEvent(new br)},{immediate:!0}),Ee(()=>Xe().connected,d=>{d&&e.sendEvent(new Ri(!0))},{immediate:!0});const a=R(ct),i=R(yo),s=t,o=Yh();tt(()=>i.uiEffect.importSuccess,d=>{console.log("importSuccess =====>",d),d.filePath&&a.sendEvent(new ia({type:zn.File,file:d.filePath}))});let r;ie(()=>i.uiState.showLoading,d=>{d?r=ce.modal.showToast({icon:"loading",msg:"device.status.loading",duration:0,layout:"vertical"}):r==null||r.close()});const l=(d,c)=>{switch(d){case ut.Snapshot:$(F.buttonClick,{elementId:q.photoAlignment}),s("open",c);break;case ut.Image:$(F.buttonClick,{elementId:q.image}),s("open",c);break;case ut.Text:$(F.buttonClick,{elementId:q.text}),a.sendEvent(new ia({type:zn.Text}));break;case ut.Shape:$(F.buttonClick,{elementId:q.shapeList}),s("open",c,d);break;case ut.Graffiti:$(F.buttonClick,{elementId:q.graffiti}),s("open",c);break;case ut.Layer:$(F.buttonClick,{elementId:q.layer}),s("open",c,d);break;case ut.Canvas:$(F.buttonClick,{elementId:q.canvas}),s("open",c,d);break;case ut.Setting:s("openProcessPanel");break}};return(d,c)=>(g(),T("section",rm,[b("div",cm,[b("div",dm,[(g(!0),T(Se,null,Pe(v(o),u=>(g(),T("div",{key:u.id,class:"tool-item",onClick:h=>l(u.id,u.cmp)},[w(v(Ce),{name:u.icon,size:"20px",class:"f-s-20"},null,8,["name"]),b("span",null,N(d.$t(u.label)),1)],8,um))),128))]),b("div",vm,[b("div",{class:"tool-item guide-editor-setting",onClick:c[0]||(c[0]=u=>l(v(ut).Setting,""))},[w(v(Ce),{name:"canvas-tool-setting",size:"20px",class:"f-s-20"}),b("span",null,N(d.$t("mobile.editor.panel.main.setting")),1)])])]),d.toolDisabled?(g(),T("div",pm)):le("",!0)]))}}),mm=ae(hm,[["__scopeId","data-v-83a9d492"]]),fm={key:1,class:"framing-bottom"},gm={class:"common-btn-text"},bm={class:"common-btn-text"},_m={class:"framing-tip-left"},ym={class:"framing-tip-text"},wm={class:"framing-tip-right"},Sm={class:"common-btn-text"},Cm=G({__name:"FramingPanel",props:{show:{type:Boolean},isMovingLaserHead:{type:Boolean},height:{},hideOverlay:{type:Boolean}},emits:["update:show","process"],setup(n,{expose:t,emit:e}){const{t:a}=fe(),i=n,s=e,o=M(()=>p.isShowDeviceErrorModal),r=M(()=>p.newDeviceError),l=M({get:()=>i.show,set:te=>s("update:show",te)}),d=R(sc),c=R(wo),u=R(ns),{deviceValues:h}=ci(),p=Xe(),f=M(()=>p.ext),m=M(()=>{var te;return(te=f.value)==null?void 0:te.info}),_=M(()=>Dt().canvasId),S=y(_r.LASER_PLANE),k=M(()=>p.isInProcessing);Ee(()=>l.value,te=>{var be,X;te&&(S.value=(X=(be=p.dataSource)==null?void 0:be.currentDeviceData)==null?void 0:X.mode)});const A=Xe().currentInstanceId;Ee(()=>Xe().currentInstanceId,te=>{d.sendEvent(new oc(te))},{immediate:!0});const x=M(()=>{var te,be;return(be=(te=f.value)==null?void 0:te.uiApp)==null?void 0:be.PhoneWalkBorderSettings}),O=y(!1);ie(()=>d.uiState.isFrameMode,te=>{O.value=te});const C=y(!1);ie(()=>d.uiState.walkBroderVisible,te=>{C.value=te});const P=M(()=>d.uiState.walkBorderLoading||c.uiState.isWalkBoarderChecking);ie(()=>d.uiState.walkBorderLoading,te=>{console.log("walkBorderLoading",te)});const I=y(!1),D=y(!1);ie(()=>u.uiState.isLoading,te=>{D.value=te});const ee=y(!1);ie(()=>Xe().ext,te=>{ee.value=!!te});const W=M(()=>{const{type:te}=p.info;return p.extId===at.D1Pro&&(h==null?void 0:h.processStartPoint)===Sr.ABSOLUTE&&te===Cr.WIFI&&!p.ext.use008Firmware}),U=()=>{D.value||i.isMovingLaserHead||!ee.value||(O.value?d.sendEvent(new Ts(A)):c.sendEvent(new Fi(un.WalkBoarder)),W.value&&(I.value=!0,setTimeout(()=>{I.value=!1},3e3)))},V=()=>{d.sendEvent(new lc(A,!1))},Q=()=>{d.sendEvent(new Ts(A))},ve=()=>{p.ext.updateWalkBorderTipShow(!1,!1)},ne=()=>{p.ext.updateWalkBorderTipShow(!1,!0)},re=()=>{try{p.ext.uploadWalkBorderGcode006()}catch(te){console.log(te)}};tt(()=>c.uiEffect.checkProcessSuccess,te=>{te.checkType===un.WalkBoarder&&V()}),tt(()=>c.uiEffect.checkProcessFail,te=>{te.checkType===un.WalkBoarder&&ce.modal.showToast({msg:te.text,icon:"warning"})});const ke=()=>{var be;let te=p.extId??"";return((be=ic.get(te))==null?void 0:be.walkBorderReadyImg)||null},Ae=M(()=>({common:{title:a("device.process.framing"),content:W.value?a("device.d1pro.walk_border_forward_back_origin"):a("device.process.walk_border"),confirmTxt:a("device.modal.end"),confirm:Q,cancel:re},F1:{title:a("device.process.extend_walk_border_tip_modal_head"),content:a("device.process.extend_walk_border_tip"),confirmTxt:a("device.modal.confirm"),cancelTxt:a("device.common.never_remain"),confirm:ve,cancel:ne}})),Be=M(()=>p.extId===at.F1?Ae.value.F1:Ae.value.common),Ue=M(()=>{let te=p.extId;return[at.F1,at.F1Ultra].includes(te)}),ue=M(()=>{let te=p.extId,be=[at.F1,at.F1Ultra].includes(te);return O.value&&be}),me=M(()=>{let te=p.extId,be=[at.F1,at.F1Ultra].includes(te);return!l.value&&O.value&&be}),Ne=()=>{l.value=!0},Je=M(()=>{var te,be;return(be=(te=f.value)==null?void 0:te.uiApp)==null?void 0:be.PhoneWalkBorderSettingBottomBtns}),Mt=async()=>{s("process")};return t({showFrameTip:me}),(te,be)=>{var Ie,We;const X=Ce,pe=jt;return g(),T(Se,null,[w(v(yr),{show:l.value,"onUpdate:show":be[0]||(be[0]=Bt=>l.value=Bt),title:te.$t("device.process.framing_settings"),"title-icon":ue.value?"common-round-arrow-down":"common-round-close","teleport-name":"","hide-overlay":Ue.value||te.hideOverlay,"max-height":Ue.value&&!te.hideOverlay?"55vh":"100vh"},{content:B(()=>[aa(te.$slots,"content",{},()=>[x.value?(g(),j(it(x.value),{key:0,ref:"walkBorderRef","theme-mode":"dark",ext:f.value,"device-info":m.value,"canvas-id":_.value,"device-values":v(h),"device-mode":S.value,class:"framing-panel-component"},null,8,["ext","device-info","canvas-id","device-values","device-mode"])):le("",!0)],!0)]),footer:B(()=>[Je.value?(g(),j(it(Je.value),{key:0,class:"go-border-btn",loading:P.value,"device-error-visible":o.value,"is-error-ignore":r.value,ext:v(p).ext,xcsapp:v(ce),"is-in-processing":k.value,onClick:U,onProcess:Mt},null,40,["loading","device-error-visible","is-error-ignore","ext","xcsapp","is-in-processing"])):(g(),T("div",fm,[w(pe,{type:"default",class:oe(["common-default-btn bottom-btn",{"framing-btn-active":P.value||O.value}]),loading:P.value,"loading-text":v(a)("device.process.stop_framing"),onClick:U},{icon:B(()=>[w(X,{name:"process-framing",class:"common-btn-icon"})]),loading:B(()=>[w(X,{name:"mk-toast-loading",class:"common-btn-loading"})]),default:B(()=>[b("span",gm,N(O.value?v(a)("device.process.stop_framing"):v(a)("device.process.framing")),1)]),_:1},8,["loading","loading-text","class"]),w(pe,{type:"primary",class:"common-primary-btn bottom-btn",disabled:!1,onClick:Mt},{icon:B(()=>[w(X,{name:"process-start",class:"common-btn-icon"})]),default:B(()=>[b("span",bm,N(te.$t("device.process.processing")),1)]),_:1})]))]),_:3},8,["show","title","title-icon","hide-overlay","max-height"]),w(v(wr),mn({show:C.value,img:ke()},Be.value,{"confirm-disabled":I.value,onConfirm:(Ie=Be.value)==null?void 0:Ie.confirm,onCancel:(We=Be.value)==null?void 0:We.cancel}),null,16,["show","img","confirm-disabled","onConfirm","onCancel"]),me.value?(g(),T("div",{key:0,class:"framing-tip",onClick:Ne},[b("div",_m,[w(X,{name:"process-framing",class:"framing-tip-icon"}),b("span",ym,N(v(a)("device.process.framing"))+"...",1)]),b("div",wm,[w(pe,{type:"default",loading:P.value,class:"common-default-btn common-btn-small",onClick:U},{default:B(()=>[b("span",Sm,N(v(a)("device.process.stop_framing")),1)]),_:1},8,["loading"])])])):le("",!0)],64)}}}),bl=ae(Cm,[["__scopeId","data-v-a46e8812"]]),xm={class:"framing-container"},Em={class:"framing-tip"},Im={class:"framing-tip-text"},km=G({__name:"FramingMock",setup(n){const t=y(!0),e=y(99),a=y(99);return(i,s)=>(g(),j(it(bl),{show:t.value,"onUpdate:show":s[2]||(s[2]=o=>t.value=o),"hide-overlay":!0},{content:B(()=>[b("div",xm,[b("div",Em,[b("span",Im,N(i.$t("device.process.framing_power_tip")),1)]),w(v(Ct),{value:e.value,"onUpdate:value":s[0]||(s[0]=o=>e.value=o),label:i.$t("device.common.speed")+"(mm/s)",min:0,max:1e3,x:""},null,8,["value","label"]),w(v(Ct),{value:a.value,"onUpdate:value":s[1]||(s[1]=o=>a.value=o),label:i.$t("device.common.power")+"(%)",min:0,max:1e3},null,8,["value","label"])])]),_:1},40,["show"]))}}),Am=ae(km,[["__scopeId","data-v-cf7b9cbc"]]),Tm={key:3,class:"active-svg"},Om=["d"],Dm=G({__name:"GuideEditor",setup(n,{expose:t}){const e=y(),{t:a}=fe(),i={editPanel:{highlight:!0,class:"guide-editor-panel-mock",cmp:gl},framingPanel:{class:"guide-editor-framing-mock",cmp:Am}},s=y(!1),o=y(null),r=y(""),l=k=>k*Math.min(document.documentElement.clientWidth/375,2),d=(k,A)=>(a("ipad.guide.skip"),`
    <div class="progress-text">
      <span>${A}</span>
      <span class="progress-text-total">/4</span>
    </div>
    <img src="${hc}" class="description-right-icon"/></svg-icon>
    <p class="driver-description-text">${k}</p>
    `),c=k=>{var A,x;switch(r.value="",k){case 1:o.value=i.editPanel,Qe(()=>{var D;let P={stageRadius:l(16),popoverOffset:l(40)},I=h(P);e.value.setConfig(I),(D=e.value)==null||D.moveNext()});break;case 2:let O=Xe().extId,C=![at.P1,at.P2].includes(O);o.value=C?i.framingPanel:null,Qe(()=>{var D;let P={popoverOffset:l(40)},I=h(P);e.value.setConfig(I),(D=e.value)==null||D.moveNext()});break;case 3:o.value=null,localStorage.setItem("new-guide-record","edit-guide-complete"),(A=e.value)==null||A.moveNext(),s.value=!1;break;default:(x=e.value)==null||x.moveNext();break}},u=(k,A)=>{console.log("step",A),A.element!==".guide-editor-panel.van-floating-panel"&&Qe(()=>{var O,C,P,I,D,ee;const x=(ee=(D=(I=(P=(C=(O=document.getElementsByClassName("driver-overlay"))==null?void 0:O[0])==null?void 0:C.children)==null?void 0:P[0])==null?void 0:I.attributes)==null?void 0:D.d)==null?void 0:ee.nodeValue.split(`
`);r.value=x[1],console.log("onHighlighted-appEl",x,r.value)})},h=k=>{let A=Xe().extId,x=![at.P1,at.P2].includes(A);return{overlayColor:"#000000",overlayOpacity:.65,popoverOffset:(k==null?void 0:k.popoverOffset)??l(80),showProgress:!1,allowClose:!1,stagePadding:l(0),stageRadius:(k==null?void 0:k.stageRadius)??l(8),nextBtnText:a("mobile.guide.next"),doneBtnText:a("mobile.guide.ok"),disableActiveInteraction:!0,onHighlighted:u,steps:[{element:".guide-editor-setting",popover:{popoverClass:"custom-driver-popover-small",description:d(a("mobile.guide.set_process_attr"),1),showButtons:["next"],side:"top",align:"end",onNextClick:()=>{c(0)}}},{element:".guide-editor-elements",popover:{popoverClass:"custom-driver-popover-small",description:d(a("mobile.guide.add_canvas_elements"),2),showButtons:["next"],side:"top",align:"center",onNextClick:()=>{c(1)}}},{element:".guide-editor-panel.van-floating-panel",popover:{popoverClass:"custom-driver-popover-big",description:d(a("mobile.guide.set_elements_attr"),3),showButtons:["next"],side:"top",align:"center",onNextClick:()=>{c(2)}}},{element:".guide-editor-process",popover:{popoverClass:"custom-driver-popover-big",description:d(a(x?"mobile.guide.set_framing_attr":"mobile.guide.to_process_attr"),4),showButtons:["next"],side:"bottom",align:"end",onNextClick:()=>{c(3)}}}]}},p=()=>{var A;s.value=!0;let k=h();e.value=Lc(k),(A=e.value)==null||A.drive()},f=()=>{var A;let k=(A=e.value)==null?void 0:A.getActiveIndex();console.log("maskClick",k),k>=0&&c(k)};let m=null,_=y(!1);const S=()=>{Dt().clearCanvasSelected(),m=setTimeout(()=>{_.value=!0,p()},500)};return Ee(()=>Ga().currentTempXcs,k=>{!Ur.isEmpty(k)&&!_.value&&S()},{immediate:!0}),je(()=>{}),Yt(()=>{var k;(k=e.value)==null||k.destroy(),clearTimeout(m)}),t({driverObj:e}),(k,A)=>(g(),j(an,{to:"body"},[o.value!==null&&o.value.highlight?(g(),j(it(o.value.cmp),{key:o.value.class,class:oe(o.value.class)},null,8,["class"])):le("",!0),o.value!==null?(g(),T("div",{key:1,class:oe([o.value.class])},[(g(),j(it(o.value.cmp),{key:o.value.class}))],2)):le("",!0),s.value?(g(),T("div",{key:2,class:"guide-mask",onClick:f})):le("",!0),r.value?(g(),T("svg",Tm,[b("path",{d:r.value,class:"active-path"},null,8,Om)])):le("",!0)]))}}),Pm=ae(Dm,[["__scopeId","data-v-3649e77d"]]),Mm={class:"not_device"},Bm={class:"title"},Lm=G({__name:"NotDevice",setup(n){return(t,e)=>(g(),T("div",null,[b("div",Mm,[w(v(wt),{name:"connect_pro",class:"device_img"}),b("div",Bm,N(t.$t("device.status.please_connect_device")),1)])]))}}),zm=ae(Lm,[["__scopeId","data-v-d5486ef1"]]),Rm="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAl5SURBVHgB7Z29ltNGFMfvjPaEdDElNJHz4WWTArPploIldEkROJue5QkgTwD7BFmegKUPJ1BQEpyCpcriNPvFh0QDJabjS5rcK8uO7bXskSyNZuT5nWNsyzL2zt/3zujOnTsMKoDnebVPn6ApROACOKfxUA1AuEKAG59Si2+j+HjrMAYdIUQHH/+L7+k4Dm8vLEC7Xq93wHAYGMjTp95qEIRNFOYc/glNPORCMfj4Q2mj6H+T6N9+W2+BYRghMFno+/fhOufsF2xsErQG5YAWLVqMiXtB4LSWluo+aI62Ao+Iugoagh6kBRDe1lls7QQm9ytEeFkIdhHKs9TUoFVvMcZv6+bGtRG4K6y4rqu1pqDNWHiz0fhmCzSgdIFJ2DAUt6C4gVJZ+Cj0RtlClyZwhSx2Gj6OI66U5bqVC7y357mOI27NgbBDUB8dBHxD9WCMg0IOD19e5Vw8mTdxCRw0rtPfjp7rOihEiQXPq9VOwA9Ddl6FNRduwfNstRNwqU32959fg4IpzIIpUPHxI+AgShT+R5gM9s2bjcbXv0FBFCIwuWT8hf6JD5tgkaEwl527wIeHHs7qROK6YElDISLn2gcfHDy7iOI+BCtuFqJ+mdoQciQ3gZ89e3kZ/zuyXGPixxpSozY8OKC2zIdcXDSJGwTBFlhyxFlfXPzyNszIzAJbcYtkdpFnErjbX0Ru2VIY4aXFxW/uQkYyCxxfCj0B2+cWTYcxdr7RqLchA5kGWbG4NFq24hZPjS47qc0hA5kEjsV1waKKKHBE0UFISWqBMZDxO1hxy6D58WOYeiYqlcA0cWBjy+WBU47X0k5QSA+y7KBKGzoY0jwjG9KUtmA7qNKGGs2ty54sJXCcheCCRQtobl3WVU910dY1a4uUq55qwY4TjdysuPoh5aonWnCcs/wQLNoSzyG3kl7nk98s35lbygGteOK1caLAh4fP1sEOrLSHBlw4TlpNep0nv5Erzd+1ZAcHwYmedqzA1nqNw02y4gQL5lfBYhRJffERgbuLwmy6q2kk9cX86IlhbglfFrVgzOKIdkPXwXHUygOLqXQ++4zVB6sDDVmw4wSrYDGZqK7J4IGF4dcdNHEBOvHo0SN4/Hgb3rx5AydOnISlpSW4cOEClMGDBw/gyZOd/ndZWVmB5eVl0AkqWoN3m73nfReto3u+f/8+bG8/OnJ8efkHWFtbA5XcufMH7OzsHDn+448XSvvBJYFu+njPTfddtG7umaxknLjEzs4/2OB3QBVJ4hJ//fUAPO8F6MSgm+4LLERk2tqwu7s78XVVIk8St8erV69BJ2I33X38/2G2CoZRtMgy4urIYBwjEpiCG6DZnO/JkyekzitK5DTi1utfgWbUekGPSOAg0C9yRY0mO0LNW+Q04p49e1b6x6gSxsJIUx4/OQcasrb2q3KR04hL3+2nn34GPel2uXEfzLSNPasUOa249N10hTE4Hd3TcogPH8Qb0Jx0jZ/+OrlK4vag62FOldLBAIq05CqKS7x7B02u4wAriSJErqq4BAavXI4DLKNSYvMUucriEmHImjTIOg2GkYfIVReX4Jx/gRbMjUxqn0XkeRC3i3BxulAYu2qh1/AyYpHIXcSciBuFLN0F/MfoZSnZRJ6O6eL2oD7YBcNJ465lqIq4SE1pQfAiyUvkColLVEdgYlaRKyZuRKUEJrKKXEVxicoJTJBQx48flz6fzq2iuAQJbPwOm6PQdS7ldMlC56rM8VJJ5QTOmmajOpFPEX6lXPSsOVQVFLmDoUrmQwXIK0GuSiLTxtdcCPESDCfv7MeqiByG8JbHW5sbS9qJg7IS+cqAMdFe4Jy2MDdyp/eZZoXSxK5VL5PJC5xn6PAgcHwwkFnELSNbswyE4G3++eeQqZJ4meQxnzsPIpO2PF6F5oMh5DlZX3GRfdI2vg4WRlhxEZkYVRUZ+99/6Z53n/C/QXOKTLOppsiiRf/GAuvdD6vIoaqayDTAovv+9dHBwQuKzmuXvqM6Qa7oFRSK6CwufhVNp/Vj0Riy1M6KqYSD6gS5KlgyeuR+l9sXGMNa90AjXrzwEks4jJL3ZH1akXUr4YCBq/5OaX2Bjx2DLdCI169fSZ1XVCZGGpF1K+GAtHoP+gLTNRO66RYYRNFpNnlna6oAZ5Bag2X+h+aDdXLT01bNq8qhkhH5+++/A10IAja0W+mQwLGb1mJ2iUo4JNWfUp0gN0lk+o61mnz+lwJag0+OTCPh5dIW3mlTkJQGMdvbj6M+mZLjqKGp+FgZUE2s3d29/nehSncrK2dBF7CL3Wo06leGjo2eRNVZ4k2wLIYxboOOsRPBh4feQyHEKlhMoo3BjTOjB8cm3QUBbIDFKNB6b447npjKgX0xFSZ1wWICPlpvfdwLiWmz+Iu4AhYjQK0SPe7EZCzbFxtBovUSExPfbV+sP9M87USBachtWvhynqDr3kn7FhJTl66gFdMvpHIL1CpAR8bDThWYAtc4/WRdtWaEobgps827dMa7HXBpxcSB1SDSqwutq9YG2vn7vOzJ0gJbV60H6EU3ZFxzj1Trg0+dqm/iB9wESylQ25869fVmmvekXgB+7Bi/wZh5y10qgE9tDylJLTCl9gQBuwQGLXepAD71u4N7EsqSed0ojqqb6DJo3tjoUogGQIOqM2n63UEy1+hoNOropu2ERPGwK1nFJWYqwrK4WL9rZ52Kg9qW2hhmIJel/Xt73jrn4hZYcoPERcvdghnJrXaDFTk/8hKXyLU4x8GBdxGv1khkO/DKRof63Fnd8iC5V1+J9yGm0bULljT4OP13qTt4zY/cK93RiC+OlfpgkaVNbZa3uESh9ZP2959v4q/yKlgSofAjRaiyBDFkKLxA1v6+d40xcR1svzxKhyYO0saW06KkAprtl4ehFYAY7p0pgCH9WaCQvb3nNziPXPa8WrMSqx1EeQ3D2JpvgEYL3FSg0mqHPhdKIl7kRtfMLlSYWNiNadmPhX0+lEwcAaNBmAvVwo8jUi0okdIF7kFCO464KoQ5292Oo2yLHUUbgXvErnsdzOqjqb7J3SCA27oI20M7gXvQYAzvVh0HLuuarkvWim74HpW+KCpQMSvaCjxIT2zO4ReM/axCeZdZHcpH013UQYwQeBRy49jQTbydQ8Gpz3ahGHxsojZVjqN6nrq5XxmMFHgUz/Nq795Fgje7W9bz0/i4Rnsjx9vnumPe1olvEO88g6Pe8C12Bxjwd3wqpm2ChU7jPymV7U6Cj5qeAAAAAElFTkSuQmCC",$m={class:"sheet-content"},Fm={class:"floating-panel-content"},Nm=["src"],Hm={class:"default-name"},Vm={class:"connect-status"},Um={key:1},Wm={class:"unconnect-label"},Ym={key:2,class:"bottom-box current-scroll-none"},Gm={class:"pd16 panel-fixed current-scroll-none"},jm=G({__name:"Index",props:{canvasId:{}},setup(n,{expose:t}){const e=n,{t:a}=fe(),i=uo.isShowProcessingPanel,s=()=>{i.value=!0},o=()=>{i.value=!1},r=os(),l=()=>{m.value||(i.value=!1),localStorage.setItem("DEVICE_SETTING_VISIBLE","0"),r.push(m.value?"/device-setting":"/connect-device")},d=Xe(),{ext:c,extId:u,info:h,isInProcessing:p,isFrameMode:f,connected:m}=Ka(d),_=$n(),{unit:S}=Ka(_),{deviceValues:k,deviceDataHandler:A}=ci(),x=M(()=>{var W;return console.log("[当前设备实例]=>",c.value),console.log("[当前画布ID]=>",e.canvasId),console.log("[当前UI数据]=>",(W=c.value)==null?void 0:W.uiApp),c.value&&e.canvasId?c.value.uiApp:""}),O=()=>{console.log("pushMessage")},C=()=>{console.log("showExtendCalibrationModal")},P=R(xr),I=M(()=>P.uiState.currentData),D=M(()=>{var W,U,V;return(W=I==null?void 0:I.value)!=null&&W.snCode?(U=I==null?void 0:I.value)==null?void 0:U.name:a("device.list.xTool")+((V=I==null?void 0:I.value)==null?void 0:V.extId)}),ee=M(()=>{var W,U;if((W=I==null?void 0:I.value)!=null&&W.snCode){const V=(U=I.value)==null?void 0:U.connectIdentity;return console.log("=====connectType ip:",V),a(V==="192.168.40.1"?"device.list.Hotspot_status":"device.list.wifi_status")}else return a("ipad.connect.not_connect")});return t({open:s}),(W,U)=>{const V=Xr,Q=Ce,ve=qr,ne=ss;return g(),j(ne,{show:v(i),"onUpdate:show":U[0]||(U[0]=re=>qi(i)?i.value=re:null),title:v(a)("mobile.process.processing-setting"),class:"processing-setting-wrap","lazy-render":!1,style:{"max-height":"100%"},"close-icon":v(Rm),onClose:o},{default:B(()=>{var re;return[b("div",$m,[b("div",Fm,[v(u)?(g(),T("section",{key:0,class:"ext-info bottom-box",onClick:rt(l,["stop"])},[w(ve,null,{default:B(()=>[w(V,{class:"cover"},{default:B(()=>{var ke,Ae;return[b("img",{src:((ke=v(c))==null?void 0:ke.info.detailCover)||((Ae=v(c))==null?void 0:Ae.info.cover)},null,8,Nm)]}),_:1}),w(V,{class:"info"},{default:B(()=>{var ke,Ae;return[b("div",Hm,N(D.value),1),b("div",Vm,[b("div",{class:"dot",style:qe({backgroundColor:(ke=I.value)!=null&&ke.connected?"#29be44":"#877f7f"})},null,4),b("span",{class:"status",style:qe({color:(Ae=I.value)!=null&&Ae.connected?"#29be44":"#877f7f"})},N(ee.value),5)])]}),_:1}),w(V,{class:"arrow"},{default:B(()=>[w(Q,{name:"arrow_right",size:"20px",class:"f-s-20"})]),_:1})]),_:1})])):le("",!0),v(u)?le("",!0):(g(),T("section",Um,[b("div",{class:"unconnect-card bottom-box",onClick:rt(l,["stop"])},[b("span",Wm,N(v(a)("device.list.connect")),1),w(Q,{name:"arrow_right",size:"20px",class:"f-s-20"})])])),v(c)?(g(),T("div",Ym,[b("section",Gm,[v(c)?(g(),j(it((re=x.value)==null?void 0:re.ProcessingModeForm),{key:`${v(c).id}-${W.canvasId}-${v(c).uiAppRenderKey}`,ext:v(c),"canvas-id":W.canvasId,"device-info":v(h),"device-values":v(k),"is-in-processing":v(p),"is-frame-mode":v(f),"dis-connect":!v(m),unit:v(S),"xcs-app":v(ce),handler:v(A),onPushMessage:O,onExtendCalibrationModal:C},null,40,["ext","canvas-id","device-info","device-values","is-in-processing","is-frame-mode","dis-connect","unit","xcs-app","handler"])):le("",!0),x.value?le("",!0):(g(),j(zm,{key:1}))])])):le("",!0)])])]}),_:1},8,["show","title","close-icon"])}}}),Km=""+new URL("../assets/pic-camera-photo-tip-815KN4sJ.png",import.meta.url).href,Xm={key:0,class:"wrapper"},qm={class:"header"},Qm={class:"content"},Zm={class:"content-text"},Jm={class:oe({link:!1,block:!0})},ef={class:oe({link:!1,block:!0})},tf={class:oe({link:!1,block:!0})},nf={class:"footer"},af=G({__name:"CameraTipDialog",setup(n){const t=R(Gt),e=M(()=>t.uiState.isShowCameraTipDialog),{t:a}=fe(),i=s=>{vo(s)};return(s,o)=>{const r=vi,l=jt;return g(),j(an,{to:"body"},[e.value?(g(),T("div",Xm,[b("div",qm,[mt(N(v(a)("mobile.editor.camera_location"))+" ",1),le("",!0)]),b("div",Qm,[w(r,{class:"img",src:v(Km)},null,8,["src"]),b("div",Zm,[b("span",Jm," 1."+N(v(a)("mobile.device.camera_photo_tip_1")),1),b("span",ef," 2."+N(v(a)("mobile.device.camera_photo_tip_2")),1),b("span",tf,[mt(" 3."+N(v(a)("mobile.device.camera_photo_tip_3"))+" ",1),b("span",{class:oe({link:!0,block:!1}),onClick:o[0]||(o[0]=d=>i("https://s.xtool.com/doc/mobile/shoot-background-tips"))},N(v(a)("mobile.device.camera_photo_tip_link")),1)]),b("span",{class:oe([{link:!1,block:!0},"ps"])}," PS:"+N(v(a)("mobile.device.camera_photo_tip_ps")),1)])]),b("div",nf,[w(l,{type:"primary",onClick:o[1]||(o[1]=d=>v(t).sendEvent(new(v(Er))))},{default:B(()=>[mt(N(v(a)("mobile.common.iknow")),1)]),_:1}),w(l,{class:"not-continue-tip",onClick:o[2]||(o[2]=d=>v(t).sendEvent(new(v(Ir))))},{default:B(()=>[mt(N(v(a)("device.common.never_remain")),1)]),_:1})])])):le("",!0)])}}}),sf=ae(af,[["__scopeId","data-v-43ce2c60"]]),of=""+new URL("../assets/camera-sticker-tip-ay4hMBwd.png",import.meta.url).href,lf={key:0,class:"wrapper"},rf={class:"header"},cf={class:"content"},df={class:"content-text"},uf={class:oe({link:!1,block:!0})},vf={class:oe({link:!1,block:!0})},pf={class:oe({link:!1,block:!0,ps:!0})},hf={class:"footer"},mf=G({__name:"CameraStickerTipDialog",setup(n){const{t}=fe(),e=R(Gt),a=M(()=>e.uiState.stickerStep===0);return tt(()=>e.uiEffect.showToast,i=>{a.value&&ce.modal.showToast({type:"text",msg:t(i.msgKey),wordBreak:"break-word"})}),Fn(()=>!0),(i,s)=>{const o=vi,r=jt;return g(),j(an,{to:"body"},[a.value?(g(),T("div",lf,[b("div",rf,[mt(N(v(t)("editor.sticker.camera_location"))+" ",1),le("",!0)]),b("div",cf,[w(o,{class:"img",src:v(of)},null,8,["src"]),b("div",df,[b("span",uf,N(v(t)("editor.sticker.tip1")),1),b("span",vf,N(v(t)("editor.sticker.tip2")),1),b("span",pf,N(v(t)("editor.sticker.tip3")),1)])]),b("div",hf,[w(r,{type:"primary",onClick:s[0]||(s[0]=l=>v(e).sendEvent(new(v(kr))))},{default:B(()=>[mt(N(v(t)("editor.sticker.go_calibration")),1)]),_:1})])])):le("",!0)])}}}),ff=ae(mf,[["__scopeId","data-v-f8abdc33"]]),gf=""+new URL("../assets/camera-sticker-guide1-jcgsydA2.png",import.meta.url).href,bf={key:0,class:"wrapper"},_f={class:"header"},yf={class:"content"},wf={class:"content-text"},Sf={class:oe({link:!1,block:!0})},Cf={class:"footer"},xf=G({__name:"StickerStep1Dialog",setup(n){const{t}=fe(),e=R(Gt),a=M(()=>e.uiState.stickerStep===1),i=()=>{e.sendEvent(new Tr)};tt(()=>e.uiEffect.showToast,r=>{a.value&&ce.modal.showToast({type:"text",msg:t(r.msgKey)})});let s=null;ie(()=>e.uiState.measureDistanceLoading,r=>{r?s=ce.modal.showToast({msg:t("editor.sticker.focusing"),icon:"loading",type:"loading",forbidClick:!1,duration:0,uniqueId:"measureDistanceLoading"}):s==null||s.close()});const o=r=>{vo(r)};return Fn(()=>!0),(r,l)=>{const d=vi,c=jt;return g(),j(an,{to:"body"},[a.value?(g(),T("div",bf,[b("div",_f,[mt(N(v(t)("editor.sticker.step1_title"))+" ",1),(g(),j(v(wt),{key:0,name:"close-gray-bg",size:"30px",class:"f-s-30",onClick:i}))]),b("div",yf,[w(d,{class:"img",src:v(gf)},null,8,["src"]),b("div",wf,[b("span",Sf,[mt(N(v(t)("editor.sticker.step1"))+" ",1),b("span",{class:oe({link:!0,block:!1}),onClick:l[0]||(l[0]=u=>o("https://s.xtool.com/tutorials/homemade-stickers"))},N(v(t)("editor.sticker.no_sticker")),1)])])]),b("div",Cf,[w(c,{type:"primary",loading:v(e).uiState.measureDistanceLoading,onClick:l[1]||(l[1]=u=>v(e).sendEvent(new(v(Ar))))},{default:B(()=>[mt(N(v(t)("editor.sticker.next")),1)]),_:1},8,["loading"])])])):le("",!0)])}}}),Ef=ae(xf,[["__scopeId","data-v-a71520fe"]]),If=""+new URL("../assets/camera-sticker-guide2-1kAVuHZX.png",import.meta.url).href,kf=n=>(Qi("data-v-e52f754e"),n=n(),Zi(),n),Af={key:0,class:"wrapper"},Tf={class:"header"},Of={class:"content"},Df={class:"content-text"},Pf={class:oe({link:!1,block:!0})},Mf={class:"content point-wrapper"},Bf={class:"step_list"},Lf={class:"undo-area"},zf=["disabled"],Rf=["disabled"],$f=kf(()=>b("div",null,null,-1)),Ff={class:"footer"},Nf=G({__name:"StickerStep2Dialog",setup(n){const{t}=fe(),e=R(Gt),a=M(()=>e.uiState.stickerStep===2),i=()=>{e.sendEvent(new Mr)};tt(()=>e.uiEffect.showToast,o=>{a.value&&ce.modal.showToast({type:"text",msg:t(o.msgKey),wordBreak:"break-word"})}),tt(()=>e.uiEffect.showConfirmDialog,async o=>{await ce.modal.showConfirmDialog({title:t(o.titleKey),msg:t(o.messageKey),confirmButtonText:t(o.confirmButtonTextKey),cancelButtonText:t(o.cancelButtonTextKey)})&&o.confirmHandle()});const s=M(()=>{const o=e.uiState.posData;return[{name:"1",position:o[0]},{name:"2",position:o[1]},{name:"3",position:o[2]},{name:"4",position:o[3]}]});return Fn(()=>!0),(o,r)=>{const l=vi,d=jt;return g(),j(an,{to:"body"},[a.value?(g(),T("div",Af,[b("div",Tf,[mt(N(v(t)("editor.sticker.step2_title"))+" ",1),(g(),j(v(wt),{key:0,name:"close-gray-bg",size:"30px",class:"f-s-30",onClick:i}))]),b("div",Of,[w(l,{class:"img",src:v(If)},null,8,["src"]),b("div",Df,[b("span",Pf,N(v(t)("editor.sticker.step2")),1)])]),b("div",Mf,[b("div",null,N(v(t)("editor.sticker.markingPoint")),1),b("ul",Bf,[(g(!0),T(Se,null,Pe(s.value,(c,u)=>(g(),T("li",{key:c.name,class:"step_item"},[c.position!==void 0?(g(),j(v(wt),{key:0,name:"point-done",class:"f-s-18",style:{"margin-right":"7.5px"}})):(g(),j(v(wt),{key:1,name:"point-undone",style:{"margin-right":"7.5px"},class:"f-s-18"})),b("span",null,N(c.name),1)]))),128))]),b("div",Lf,[b("button",{disabled:!v(e).uiState.isEnableUndoPos,onClick:r[0]||(r[0]=c=>v(e).sendEvent(new(v(Or))))},[w(v(wt),{class:"f-s-24",name:v(e).uiState.isEnableUndoPos?"undo-white":"undo-gray"},null,8,["name"])],8,zf),b("button",{disabled:!v(e).uiState.isEnableRedoPos,onClick:r[1]||(r[1]=c=>v(e).sendEvent(new(v(Dr))))},[w(v(wt),{class:"f-s-24",name:v(e).uiState.isEnableRedoPos?"redo-white":"redo-gray"},null,8,["name"])],8,Rf)]),$f]),b("div",Ff,[w(d,{type:"primary",disabled:!v(e).uiState.isEnableCompleteSticker,onClick:r[2]||(r[2]=c=>v(e).sendEvent(new(v(Pr))))},{default:B(()=>[mt(N(v(t)("editor.sticker.complete")),1)]),_:1},8,["disabled"])])])):le("",!0)])}}}),Hf=ae(Nf,[["__scopeId","data-v-e52f754e"]]),Vf=G({__name:"Index",setup(n){return(t,e)=>(g(),T("div",null,[w(sf),w(v(ff)),w(v(Ef)),w(v(Hf))]))}}),Uf={class:"second-panel"},Wf=G({__name:"Index",props:{component:{type:Object,default:()=>({})}},emits:["close"],setup(n,{emit:t}){const e=t,a=()=>{e("close")};return(i,s)=>(g(),T("div",Uf,[(g(),j(it(n.component),{onClose:a},null,32))]))}}),Yf={class:"editor-container"},Gf=G({__name:"Index",setup(n){const{t}=fe(),e=R(Fr),a=R(Ze),i=R(ns),s=R(wo),o=R(Nr),r=y(!1),l=y(),d=y(!1),c=R(Nn),u=R(Gt),h=M(()=>u.uiState.isShowCameraTipDialog),p=M(()=>o.uiState.isShowPopup),f=Br(),m=y(!1),_=Xe(),S=M(()=>({ext:_.ext,info:_.info})),k=M(()=>{const H=_.ext;return H&&H.uiApp.RedBlueCalibration?H.uiApp.RedBlueCalibration:""}),A=y();ie(()=>c.uiState.imageEditor,H=>{A.value=H}),ie(()=>a.uiState.selected.num>0||A.value,H=>{d.value=H});const x=y(),O=y(!0),C=(H,xe)=>{O.value=!1,Qe(()=>{O.value=!0,x.value=H,(xe===ut.Shape||xe===ut.Layer)&&(m.value=!0)})},P=M(()=>a.uiState.isZooming||a.uiState.isTransformTouch),I=y();ie(()=>a.uiState.eleSelected&&P.value,H=>{I.value=H});const D=y(!1);ie(()=>a.uiState.subMode==="TEXT_EDIT",H=>{D.value=H});const ee=M(()=>!I.value&&!A.value&&!D.value),W=()=>{x.value="",m.value=!1};ie(()=>e.uiState.enable,H=>{r.value=H});let U;ie(()=>i.uiState.operateLoading,H=>{H?U=ce.modal.showToast({icon:"loading",msg:"device.status.loading",duration:0,layout:"vertical"}):U==null||U.close()});let V;ie(()=>i.uiState.saveLoading,H=>{H?V=ce.modal.showToast({uniqueId:"project_save_toast",icon:"loading",msg:"mobile.common.saving",duration:0}):V==null||V.close()}),tt(()=>i.uiEffect.saveXcsResult,H=>{H.isSuccess?ce.modal.showToast({uniqueId:"project_save_toast",msg:"mobile.common.save_success",icon:"success"}):ce.modal.showToast({uniqueId:"project_save_toast",msg:"mobile.common.save_fail",icon:"error"})});let Q;Os("device.status.taking_picture",H=>{var xe,Ye,we,xt;Q||(Q=ce.modal.showToast({icon:"info",duration:0,msg:((xe=H.message)==null?void 0:xe.contentI18nKey)||"",params:(Ye=H.message)==null?void 0:Ye.contentI18nArgs})),H.isDestroy?(Q==null||Q.close(),Q=void 0):Q.message=t(((we=H.message)==null?void 0:we.contentI18nKey)||"",((xt=H.message)==null?void 0:xt.contentI18nArgs)||"")}),Os("device.status.editor_page",H=>{ce.modal.showMessage(H.message)});let ve;const ne=()=>{ve||(ve=setInterval(()=>{i.sendEvent(new Is(!0))},55e3))},re=()=>{ve&&(clearInterval(ve),ve=null)};let ke=!1;const Ae=()=>{const H=xn().currentMode;ks(H)&&!ke&&(ke=!0,ce.modal.showTipModal({title:t("mobile.common.notice"),content:t("mobile.process.current_mode_not_support"),confirmTxt:t("device.common.confirm"),hasCancel:!1,hasClose:!1,onConfirm:()=>{ke=!1}}))};Yt(()=>{re(),U==null||U.close(),U=void 0,be==null||be.close(),be=void 0,Q==null||Q.close(),Q=void 0,V==null||V.close(),V=void 0,X.value=!1}),tt(()=>i.uiEffect.openTempXcsResult,H=>{H.isSuccess||ce.modal.showToast({msg:"mobile.projects.open_xcs_file_error",icon:"error",type:"html",linkTips:"canvas.message.learn_more",order:-1,openCb:()=>{window.open("https://community.xtool.com/#/making/detail/tips/96")},duration:3e3,bckWhiteColor:!0})});const Be=os(),Ue=y(),ue=y(!1),me=y(),Ne=()=>{(localStorage.getItem("new-guide-record")??"")!=="edit-guide-complete"&&(ue.value=!0)};Fn(()=>{var H,xe;return h.value||p.value||(xe=(H=me.value)==null?void 0:H.driverObj)!=null&&xe.isActive()||Ue.value.showBackDialog||Ue.value.goBack(),!0});const Je=M(()=>Dt().canvasId),{updateCanvasId:Mt}=ci();Ee([()=>Je.value,()=>Xe().currentInstanceId,()=>Xe().connected],()=>{Je.value&&Mt(Je.value)},{immediate:!0}),Ee(()=>xn().currentMode,()=>{Ae()});const te=()=>{l.value.open()};let be;ie(()=>i.uiState.isLoading,H=>{be=H?ce.modal.showToast({msg:"mobile.common.loading",icon:"loading",layout:"vertical"}):be==null?void 0:be.close()}),je(async()=>{var H;if(console.log("openProject:  打开项目editor mounted=====>",Be.currentRoute.value),(H=Be.currentRoute.value.params)==null||H["stack-key-dir"],!Ga().haveOpenProject()){const{filePath:xe,fileId:Ye,fileName:we,tempXcsFileId:xt,source:Lt,isOpenFromCloud:Un}=Be.currentRoute.value.query;if(Un&&Un.toString()=="true"&&ce.modal.showToast({icon:"info",uniqueId:Lr,msg:"cloud.open_file_in_cloud",duration:3e3}),xt)await i.sendEvent(new zr(xt==null?void 0:xt.toString()));else if(Ye)await i.sendEvent(new Rr(Ye.toString(),Lt==null?void 0:Lt.toString()));else{const sn=xe==null?void 0:xe.toString(),mi=we==null?void 0:we.toString();await i.sendEvent(new $r(sn,mi,Lt==null?void 0:Lt.toString()))}i.sendEvent(new $i(!0)),Ae(),ne()}ce.modal.lastKeepAliveMessage&&ce.modal.lastKeepAliveMessage.open({}),Qe(()=>{Ne()})});const X=uo.isShowFramingPane,pe=()=>{var Ye,we;if(!As.getExt())return;if(console.log("mblock -> forceUpdate ",(Ye=f==null?void 0:f.lastCheckResultData())==null?void 0:Ye.forceUpdate),(we=f==null?void 0:f.lastCheckResultData())!=null&&we.forceUpdate){ce.modal.showTipModal({title:t("device.process.before_process_default_data_tips_title"),content:t("device.firmware.force_update_tips"),confirmTxt:t("ipad.dialog.confirm"),hasCancel:!1,onConfirm:()=>{}});return}const xe=xn().currentMode;if(console.log("[当前加工模式]=>",xe),ks(xe)){console.log("[当前连接设备不支持该加工模式]=>",xe),ce.modal.showToast({msg:t("mobile.process.mode_not_support"),icon:"error",duration:3e3});return}s.sendEvent(new rc)};tt(()=>s.uiEffect.checkLengthSuccess,()=>{let H=Xe().extId;[at.P1,at.P2].includes(H)?Ie():X.value=!0}),tt(()=>s.uiEffect.onlyProcessPanelOpen,H=>{l.value.open(),X.value=!1}),tt(()=>s.uiEffect.checkLengthFail,H=>{l.value.open(),X.value=!1,ce.modal.showToast({msg:H.msg,icon:"error",duration:5e3})});const Ie=as(()=>{console.log("startProcess"),i.sendEvent(new Is(!1)),s.sendEvent(new Fi(un.Process,!0))},200);tt(()=>s.uiEffect.checkProcessSuccess,H=>{var xe,Ye,we,xt,Lt,Un;if(H.checkType===un.Process){const sn=As.getExt(),mi=sn.id;let ps=!1,hs="",fi="";if(!((xe=sn.dataSource)!=null&&xe.getOfficialMaterial())){const ms=(Ye=sn.dataSource)==null?void 0:Ye.canvasId,_l=ja().canvasAvailableIdsMap().get(ms),yl=(xt=(we=sn.dataSource)==null?void 0:we.data[ms])==null?void 0:xt.displays,wl=(Un=(Lt=sn.dataSource)==null?void 0:Lt.currentDeviceModeData)==null?void 0:Un.mode;for(const Sl of _l){const Cl=yl[Sl],Ea=Hr(Cl,mi,wl);if(Ea.isPowerChanged){ps=Ea.isPowerChanged,fi=Ea.content,hs=Ea.translateKey;break}}ja().canvasAvailableIdsMap().clear()}if(ps){$(F.dialogShow,{name:Vr.noParameters}),ce.modal.showTipModal({title:t("device.process.before_process_default_data_tips_title"),content:t(hs,{power:fi,cutPressure:fi}),cancelTxt:t("device.process.before_process_default_data_tips_cancel"),confirmTxt:t("device.process.before_process_default_data_tips_confirm"),popZIndex:3e3,hasClose:!1,onCancel:()=>{Bt()},onConfirm:()=>{X.value=!1}});return}Bt()}}),tt(()=>s.uiEffect.checkProcessFail,H=>{H.checkType===un.Process&&We[H.type](H)});const We={[Es.text]:H=>{ce.modal.showToast({msg:H.text,icon:"warning",duration:3e3})},[Es.textWithEvent]:H=>{const{text:xe}=H,{text:Ye="",handler:we=()=>{}}=H.event||{};console.log("==>event ",H),ce.modal.showToast({icon:"warning",type:"html",linkTips:Ye,msg:xe,order:-1,duration:5e3,openCb:()=>{we(Xe().ext.value)},bckWhiteColor:!0})},s1OverDict:H=>{ce.modal.showTipModal({title:t("device.process.edge_collision_prompt_title"),haveIcon:!0,iconName:"msg_warning",popZIndex:3e3,content:t("device.process.edge_collision_prompt"),confirmTxt:t("device.process.edge_collision_prompt_confirm"),cancelTxt:t("device.common.cancel"),onConfirm:()=>{s.sendEvent(new Fi(un.Process))}})}},Bt=async()=>{await Be.push({path:"/process"})},xa=y(),Vn=M(()=>{var H;return(H=xa.value)==null?void 0:H.showFrameTip});return(H,xe)=>(g(),T("div",Yf,[w(v(ed),{id:"processTab",ref_key:"editHeaderRef",ref:Ue,"header-disabled":Vn.value,onClickProcess:pe},null,8,["header-disabled"]),w(v(qc)),Oe(w(v(mm),{class:oe(P.value?"canvas-zoom":""),"tool-disabled":Vn.value,onOpen:C,onOpenProcessPanel:te},null,8,["class","tool-disabled"]),[[Fe,ee.value]]),O.value?(g(),j(v(Wf),{key:0,component:x.value,onClose:W},null,8,["component"])):le("",!0),d.value&&!D.value&&!Vn.value&&!v(X)&&!m.value?(g(),j(v(gl),{key:1})):le("",!0),w(bl,{ref_key:"refFramingPane",ref:xa,show:v(X),"onUpdate:show":xe[0]||(xe[0]=Ye=>qi(X)?X.value=Ye:null),onProcess:v(Ie)},null,8,["show","onProcess"]),Je.value?(g(),j(jm,{key:2,ref_key:"processPanel",ref:l,"canvas-id":Je.value},null,8,["canvas-id"])):le("",!0),w(Vf),ue.value?(g(),j(Pm,{key:3,ref_key:"refGuideEditor",ref:me},null,512)):le("",!0),(g(),j(it(k.value),Tl(Ol(S.value)),null,16))]))}}),rg=ae(Gf,[["__scopeId","data-v-af92dccd"]]);export{rg as default};
