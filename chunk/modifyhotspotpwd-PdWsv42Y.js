import{useViewModel as A,observeEffect as v,useExtCenterStore as w,xcsApp as m,__unplugin_components_0 as F,_export_sfc as G}from"./main-f7BGirYr.js";import{defineComponent as K,ref as s,computed as S,watch as L,onMounted as U,openBlock as W,createElementBlock as $,createVNode as r,unref as n,createBaseVNode as l,toDisplayString as _,withCtx as h,withDirectives as X,vShow as j,Fragment as q,createTextVNode as z}from"./importmap-vue-u6Q_1Jji.js";import{useI18n as J}from"./importmap-vue-i18n-LlhaB8iP.js";import{useRouter as Q}from"./importmap-vue-router-aHGpzyJi.js";import"../assets/index-FfF0Lcw0.js";import{GetHotspotInfoEvent as Y,HotspotConfigViewModel as Z,MODE_DEVICE_CONNECT as ee,SetHotspotInfoEvent as C,HOTSPOT_PASSWORD_MAX_LENGTH as I,HOTSPOT_PASSWORD_MIN_LENGTH as V}from"./hotspotconfigviewmodel-8JYLNcii.js";import{pwdRegex as oe}from"./regexhelpr-tVNfJSeD.js";import{NavBar as te,Field as se,Button as ne}from"./importmap-vant-Ij4SMMwJ.js";const ae={class:"modify-container"},le={class:"modify-header-tip"},ce={class:"enter-tip"},re={class:"input-wrap"},ie={class:"right-lock"},de={class:"right-lock"},me={class:"save-button"},ue=K({__name:"ModifyHotspotPwd",setup(pe){const{t:e}=J(),g=Q(),t=A(Z),b=s(),u=s(!1),p=s(!1),c=s(""),i=s(""),T=S(()=>c.value.length>=8&&i.value.length>=8&&c.value!==i.value),N=S(()=>!(c.value.length>=V&&i.value.length>=V)||T.value),k=()=>{g.back()};L(()=>w().connected,o=>{o||g.go(-2)}),v(()=>t.uiEffect.showToast,o=>{m.modal.showToast({icon:"info",msg:e(o.msgKey),wordBreak:"break-word"})}),v(()=>t.uiEffect.showSuccessToast,o=>{m.modal.showToast({icon:"success",msg:e(o.msgKey),wordBreak:"break-word"})}),v(()=>t.uiEffect.showFailToast,o=>{m.modal.showToast({icon:"error",msg:e(o.msgKey),wordBreak:"break-word"})});const x=o=>o.replace(oe,"");U(()=>{setTimeout(()=>{var o;(o=b.value)==null||o.focus()},100),t.sendEvent(new Y)});const P=s(e("mobile.connect.change_password")),B=s(e("mobile.common.confirm")),M=s(e("mobile.common.cancel")),H=s(e("mobile.connect.modify_password_dialog_tip"));let f=!1;const D=()=>{if(f){console.log("didSave",f);return}if(t.uiState.cur_mode===ee.AP){if(!w().checkDeviceIsIdle()){m.modal.showToast({msg:e("device.process.device_is_working"),wordBreak:"break-word"});return}m.modal.showTipModal({haveIcon:!0,iconName:"msg_info",title:P.value,content:H.value,hasClose:!1,cancelTxt:M.value,confirmTxt:B.value,onConfirm:()=>{f=!0,t.sendEvent(new C(t.uiState.hotspotName,c.value)),setTimeout(()=>{w().closeConnect()},3e3)},onCancel:()=>{}})}else f=!0,t.sendEvent(new C(t.uiState.hotspotName,c.value)),setTimeout(()=>{k()},3e3)};return(o,a)=>{const O=te,y=F,E=se,R=ne;return W(),$(q,null,[r(O,{"left-arrow":"",placeholder:"",title:n(e)("mobile.connect.change_password"),fixed:"",onClickLeft:k},null,8,["title"]),l("div",ae,[l("div",le,_(n(e)("mobile.connect.modify_password_header_tip")),1),l("div",ce,_(n(e)("mobile.connect.please_enter_password_tip")),1),l("div",re,[r(E,{ref_key:"newPasswordRef",ref:b,modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=d=>c.value=d),clearable:"",maxlength:n(I),formatter:x,type:u.value?"text":"password",placeholder:n(e)("mobile.connect.placeholder_new_password"),class:"input-box",border:!1,onClickRightIcon:a[1]||(a[1]=d=>u.value=!u.value)},{"right-icon":h(()=>[l("div",ie,[r(y,{name:u.value?"eye-on":"eye-off",class:"f-s-18"},null,8,["name"])])]),_:1},8,["modelValue","maxlength","type","placeholder"]),r(E,{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=d=>i.value=d),clearable:"",maxlength:n(I),onpaste:"return false",border:!1,formatter:x,type:p.value?"text":"password",placeholder:n(e)("mobile.connect.placeholder_confirm_password"),class:"input-box",onClickRightIcon:a[3]||(a[3]=d=>p.value=!p.value)},{"right-icon":h(()=>[l("div",de,[r(y,{name:p.value?"eye-on":"eye-off",class:"f-s-18"},null,8,["name"])])]),_:1},8,["modelValue","maxlength","type","placeholder"])]),X(l("div",{class:"err-tip"},_(n(e)("mobile.connect.password_inconsistent_tip")),513),[[j,T.value]]),l("div",me,[r(R,{block:"",disabled:N.value,class:"ok-btn",onClick:D},{default:h(()=>[z(_(n(e)("mobile.common.save")),1)]),_:1},8,["disabled"])])])],64)}}}),ke=G(ue,[["__scopeId","data-v-1b61147f"]]);export{ke as default};
