var Ge=Object.defineProperty;var Je=(c,e,t)=>e in c?Ge(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var me=(c,e,t)=>(Je(c,typeof e!="symbol"?e+"":e,t),t),Xe=(c,e,t)=>{if(!e.has(c))throw TypeError("Cannot "+t)};var O=(c,e,t)=>(Xe(c,e,"read from private field"),t?t.call(c):e.get(c)),ue=(c,e,t)=>{if(e.has(c))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(c):e.set(c,t)};import{_export_sfc as T,useNetwork as ie,useViewModel as b,observeState as X,__unplugin_components_0 as Z,router as Ne,useExtCenterStore as P,storeToRefs as xe,MultiConnectViewModel as Ze,sensorsTrack as D,EventNames as z,xcsApp as R,observeEffect as ke,parseJSON as ee,stringifyObject as Re,ButtonNames as he,ProjectSource as je,useCenterStore as Ae,getDomain as ve,axios as qe,getOssProcessedImage as $e,BaseViewModel as et,useGlobalParamStore as tt,CheckNeedReopenTempXcsEvent as ot,appManager as nt,MultiProjectViewModel as st}from"./main-f7BGirYr.js";import"./index-w40geAFS.js";import{UserCenterViewModel as we,RequestUserInfoEvent as ct,GetUserInfoEvent as at,GetUTokenEvent as it,Card as te,LoginEvent as lt}from"./card-QDkFRbbw.js";import"../assets/index-FfF0Lcw0.js";import{useI18n as Q}from"./importmap-vue-i18n-LlhaB8iP.js";import{ref as M,onMounted as le,computed as Y,openBlock as f,createBlock as V,withCtx as S,unref as g,createVNode as _,createBaseVNode as u,defineComponent as F,createElementBlock as I,toDisplayString as U,normalizeStyle as ye,Fragment as G,renderList as J,reactive as oe,mergeProps as ne,toRaw as rt,nextTick as dt,createCommentVNode as se,withDirectives as mt,vShow as ut,onUnmounted as pt,watch as Ue,resolveDynamicComponent as gt,pushScopeId as ht,popScopeId as vt}from"./importmap-vue-u6Q_1Jji.js";import{Image as be,SwipeItem as ft,Swipe as _t,SkeletonAvatar as kt,SkeletonParagraph as wt,Skeleton as At,Empty as yt,Field as It,Picker as Et,Popup as St,NavBar as Mt,PullRefresh as Lt,Loading as Ct}from"./importmap-vant-Ij4SMMwJ.js";import{useRouter as re}from"./importmap-vue-router-aHGpzyJi.js";import{LocalProjectViewModel as Be,ProjectCard as Te,DeleteProjectEvent as Nt,RequestProjectListEvent as xt}from"./projectcard-A3Vctj2I.js";import{ImportFileViewModel as Rt,ImportFileEvent as pe}from"./importfileviewmodel-n9UVAPSW.js";import{ProjectSheet as jt}from"./projectsheet-K9koNuPr.js";import"./griditem.vue_vue_type_style_index_0_scoped_39934db8_lang-w40geAFS.js";import"./index-DkoCfqcs.js";const Ut="data:image/svg+xml,%3csvg%20width='28'%20height='29'%20viewBox='0%200%2028%2029'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='14'%20cy='14.3694'%20r='14'%20fill='%23545458'/%3e%3cpath%20d='M14.3006%2013.4794C15.6375%2013.3318%2016.7199%2012.2493%2016.8675%2010.9124C17.0615%209.15237%2015.6895%207.66504%2013.9688%207.66504C12.3578%207.66504%2011.0518%208.96961%2011.0518%2010.5807V10.5821C11.0518%2012.3027%2012.5405%2013.6734%2014.3006%2013.4794ZM13.9688%2014.3313C12.0218%2014.3313%208.13477%2015.4475%208.13477%2017.6644V18.9142C8.13477%2019.1447%208.32174%2019.3303%208.55088%2019.3303H19.3853C19.6159%2019.3303%2019.8014%2019.1433%2019.8014%2018.9142V17.6644C19.8028%2015.4489%2015.9158%2014.3313%2013.9688%2014.3313Z'%20fill='white'/%3e%3c/svg%3e",bt="data:image/svg+xml;base64,Cjxzdmcgd2lkdGg9IjI4IiBoZWlnaHQ9IjI5IiB2aWV3Qm94PSIwIDAgMjggMjkiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjE0IiBjeT0iMTQuMzY5NCIgcj0iMTQiIGZpbGw9IiM1NDU0NTgiLz4KPHBhdGggZD0iTTE0LjMwMDYgMTMuNDc5NEMxNS42Mzc1IDEzLjMzMTggMTYuNzE5OSAxMi4yNDkzIDE2Ljg2NzUgMTAuOTEyNEMxNy4wNjE1IDkuMTUyMzcgMTUuNjg5NSA3LjY2NTA0IDEzLjk2ODggNy42NjUwNEMxMi4zNTc4IDcuNjY1MDQgMTEuMDUxOCA4Ljk2OTYxIDExLjA1MTggMTAuNTgwN1YxMC41ODIxQzExLjA1MTggMTIuMzAyNyAxMi41NDA1IDEzLjY3MzQgMTQuMzAwNiAxMy40Nzk0Wk0xMy45Njg4IDE0LjMzMTNDMTIuMDIxOCAxNC4zMzEzIDguMTM0NzcgMTUuNDQ3NSA4LjEzNDc3IDE3LjY2NDRWMTguOTE0MkM4LjEzNDc3IDE5LjE0NDcgOC4zMjE3NCAxOS4zMzAzIDguNTUwODggMTkuMzMwM0gxOS4zODUzQzE5LjYxNTkgMTkuMzMwMyAxOS44MDE0IDE5LjE0MzMgMTkuODAxNCAxOC45MTQyVjE3LjY2NDRDMTkuODAyOCAxNS40NDg5IDE1LjkxNTggMTQuMzMxMyAxMy45Njg4IDE0LjMzMTNaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K",Bt={__name:"Index",setup(c){Q();const t=ie().isOnline,n=b(we),p=M(!1);X(()=>n.uiState.isLogin,i=>{console.log("==>userCenter watch",i),p.value=i}),le(()=>{console.log("==>userCenter userIcon onMounted",n.uiState.isLogin),n.sendEvent(new ct),n.sendEvent(new at),n.sendEvent(new it)});const m=Y(()=>{var i;return t.value&&p.value?(i=n.uiState.userInfo)==null?void 0:i.headpic:Ut}),s=()=>{Ne.push("/personal-setting")};return(i,l)=>{const y=be;return f(),V(y,{round:"",fit:"cover",position:"center",class:"person-icon",src:m.value,onClick:s},{loading:S(()=>[_(g(Z),{name:"home-avatar",size:"28px",class:"f-s-28"})]),error:S(()=>[u("img",{src:bt,style:{width:"100%",height:"100%"},alt:""})]),_:1},8,["src"])}}},Tt=T(Bt,[["__scopeId","data-v-97e14ad0"]]),Pt={class:"device-panel-card"},Dt={class:"unconnect-label"},zt={class:"connected-img"},Ft=["src"],Ot={class:"device-detail"},Vt={class:"title"},Qt={class:"device-status"},Wt=F({__name:"ConnectDeviceEntry",setup(c){const{t:e}=Q(),t=re(),n=P(),{ext:p}=xe(n),m=b(Ze),s=Y(()=>m.uiState.currentData),i=Y(()=>{var h,k;return(h=s==null?void 0:s.value)!=null&&h.snCode?(k=s==null?void 0:s.value)==null?void 0:k.name:e("device.list.xTool")+(s==null?void 0:s.value.extId)}),l=Y(()=>{var h,k;if((h=s==null?void 0:s.value)!=null&&h.snCode){const r=(k=s.value)==null?void 0:k.connectIdentity;return console.log("=====connectType ip:",r),e(r==="192.168.40.1"?"device.list.Hotspot_status":"device.list.wifi_status")}else return e("ipad.connect.not_connect")}),y=()=>{var h;D(z.buttonClick,{elementId:"device"}),localStorage.setItem("DEVICE_SETTING_VISIBLE","0"),t.push((h=s==null?void 0:s.value)!=null&&h.connected?"/device-setting":"/connect-device")},L=()=>{D(z.buttonClick,{elementId:"device"}),t.push("/connect-device")};return(h,k)=>{var r,d,E,w;return f(),I("section",Pt,[g(p)?(f(),I("div",{key:1,class:"connected-card",onClick:y},[u("div",zt,[u("img",{src:((r=g(p))==null?void 0:r.info.detailCover)||((d=g(p))==null?void 0:d.info.cover)},null,8,Ft)]),u("div",Ot,[u("div",Vt,U(i.value),1),u("div",Qt,[u("div",{class:"dot",style:ye({backgroundColor:(E=s.value)!=null&&E.connected?"#29be44":"#877f7f"})},null,4),u("span",{class:"status",style:ye({color:(w=s.value)!=null&&w.connected?"#29be44":"#877f7f"})},U(l.value),5)])]),_(g(Z),{name:"arrow_right",size:"20px",class:"f-s-20"})])):(f(),I("div",{key:0,class:"unconnect-card",onClick:L},[u("span",Dt,U(g(e)("device.list.connect")),1),_(g(Z),{name:"arrow_right",size:"20px",class:"f-s-20"})]))])}}}),Kt=T(Wt,[["__scopeId","data-v-94a106d8"]]),fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAL4AAAAcCAYAAADfoAV4AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAVLSURBVHgB7ZyJUtswEIaXKykptCkwff/nawnlakICLfVHrBk3410dtnwE/hkNhx1ltftrtbuSfSAi06Kdi43bor1IPA6LNi9/aliWre6zF9IPriUNx0X7VLSToh1JGv4WbVO0ddGeJQ/Q7Uyay4l8TtYUfC1l2MWd5Bv7GzAUQmOsz8Z9l0X7KdvBxmBe9q2BwS2VawdFm8g44JxHW/I6naGfh6I9STuAZJCtbTn/yFbOZdzH3+Spk+VQMsPN9nUpxLFyH4JgXAzwKmFAwTPjOsq6NvrjO8+kHzxE3Pu1bKme0wJ9nspWF0yCUN3XAV1eSB45kY9JAH+IDEId5EyRZyVbfmRDdWb5whnnLUKA97NWEEf62BVkSEB3V2KPsy3wHZeS7glZeb9IfjBJkfNYBo6qIiHhQuyZxsB8+cCZ5x681rVkntEdACJ1GYrheFJyHmwxk+6AB28ySTvBrnC+8ANY3hzj+DzLLxk/6bsmk8NE/I6nilnk/W3hqKfvDUbdrHTkt1CXILG8XXk+R7beVqLWFxhnn0Y9l7BQ4lD6lRPnOJWBQlMgiRQx/9y4vtnph+XtQHSQMP6WcDABf0Tc75bYOsT044OPTOhlKf/rJxToD10SUlrVMOzic0583kpkke9J0h2RS7ytlQ9dpZY6s8LyHBivbsmCkIvK33iWS7GVDOFjKiUOMXsHry31Y4GxnhrXWdFiJncdcCpUNciVtLBxUspiFQesCfogafaoAp2uy8ZErHN6yDmVAZLfl4Dseum6agyDtkiPIe9kP2B54dgVzYfHot0b160JCNk0m6Q6IQ1M0hvjuqWz3hCSeUNalsW6agyxvjUw7rWUMjZoMavbwGkbkH8TKQvQqk255MSjLyNl6RWhJaebslVJH1qrH3sFp4oT5f85yOSgEerE+IxGNgiaa+9kpfzfkrM3hBIfZVXjtPdSq9+FFj7kPFeiJZ9WeKldW0k+wA8tz8qxW9wIKZsM76VWXwetapWT+DidWEJpcraV5GvQVpPBbWbFChRSq//ABwaPGOKH1OodqPQMMrZriD6Wcmyk6Tx2Vc1tE41PgzuTFUr8kFr97v2cKxn8YaVIaETLWbLT+rZIr4U0OYlPlamtCZodocT31errMIrDSpHQSotWTb0ptJ1RK6/Q5KQKl8seKXL2hhAlUL1J9WjWMYIxQiNU7OGxUJyJXpq0jhpocuY6vwM/TiNl6RU+4p+LrSiWMJ7M8p3j/yb7AetBHJ+uYoEHtapna881TU68fptyEuJY9o19KqsTWDF4SK2eTS2WMs7uUO3RwiG8AZMj50ZPFyBJw5Daxh36mpb3pD4xhU0sTy9l/764+VF0+7lj1dijiZz0YUUDG0kLdY4kb374onUeWqt3g3K7tN9FT3BQNsRp8zxLH4AsGFwb50Tyb9OHOBD0zATS5IRcc8mLVEeXW65FXajDZPA96VP3AHTIuRzO9gz2jHYgmLx9rlx8d0iVBDlvpT+wKg3ySDLYJb6r1VsVHOtIKwP1KZt4cOw1fsKInNv/GtxbF0KBjH2ssEzMexkwDnd+95GeWexTvO+efanxu1OrXcHlUrFo4xmBGIziRQJV4oecqw9dOn1n0/ehxo9hMXAXYQ+6XEg6mSB/F3LiCKjyDf6cliN6yBFjFB+T/RP2WA9EQHqSwLbKXdZ7eHIa3T3C1+StZFbfOBuI3+SdOq4vdI2e2g413cNGhDcxcmrv1cmNFRk/pUaL9HgZBpUyi0NeA6i9QjAWKFCrJ6e+EjBFBvTpHg1MAXp+Lluu5BA5cUqUIlPlzPkKwdy4+werUybRXdyXcAAAAABJRU5ErkJggg==",Ht=""+new URL("../assets/default-banner-guKfxm9w.png",import.meta.url).href,Yt={class:"swiper-wrapper"},Gt=["src"],Jt=["src"],Xt=F({name:"HomeSwiper",__name:"HomeSwiper",props:{list:{}},setup(c){return(e,t)=>{const n=be,p=ft,m=_t;return f(),I("div",Yt,[_(m,{loop:!0,"lazy-render":"","show-indicators":e.list.length>1,autoplay:5e3},{default:S(()=>[(f(!0),I(G,null,J(e.list,s=>(f(),V(p,{key:s.src+s.name,class:"swipe-item",onClick:i=>{var l;return(l=s.callback)==null?void 0:l.call(s)}},{default:S(()=>[_(n,{class:"swiper-image",src:s.src?s.src:g(Ht),fit:"cover"},{loading:S(()=>[u("img",{src:g(fe),alt:""},null,8,Gt)]),error:S(()=>[u("img",{src:g(fe),alt:""},null,8,Jt)]),_:2},1032,["src"])]),_:2},1032,["onClick"]))),128))]),_:1},8,["show-indicators"])])}}}),Zt=T(Xt,[["__scopeId","data-v-8da634f3"]]),qt={class:"empty-wrapper"},$t={class:"empty-add"},eo=F({__name:"RecentlyEmpty",setup(c){const e=b(Rt),t=re(),{t:n}=Q(),p=oe([{key:"new",name:n("mobile.common.add_project"),icon:"add"},{key:"open",name:n("mobile.editor.my_system_file"),icon:"file"},{key:"add",name:n("mobile.editor.open_photo_album"),icon:"picture"},{key:"take",name:n("mobile.common.photo"),icon:"camera"}]),m=l=>{if(!P().ext){R.modal.showSelectDeviceDialog();return}s.value=!1;const{key:y}=l;switch(y){case"new":t.push("/editor");break;case"open":e.sendEvent(new pe(4));break;case"add":e.sendEvent(new pe(1));break;case"take":e.sendEvent(new pe(0));break}},s=M(!1),i=()=>{s.value=!0};return(l,y)=>{const L=Z;return f(),I("div",qt,[u("div",{class:"empty-box",onClick:i},[_(L,{name:"home-add_project",size:"24px",class:"f-s-24"}),u("div",$t,U(l.$t("ipad.home.add_projects")),1)]),_(jt,{value:s.value,"onUpdate:value":y[0]||(y[0]=h=>s.value=h),"action-list":p,onSelect:m},null,8,["value","action-list"])])}}}),to=T(eo,[["__scopeId","data-v-d69b7834"]]),oo={class:"recently-project"},no=F({__name:"RecentlyInfo",setup(c){const t=ie().isOnline,n=b(Be),p=M([]),{t:m}=Q(),s=M(),i=re(),l=k=>{const r=new Date().getTime(),d=Math.floor((r-k)/1e3/60),E=Math.floor((r-k)/1e3);if(d<1)return E+m("ipad.home.my_project.seconds_ago");if(d<60)return d+m("ipad.home.my_project.minutes_ago");const w=Math.round(d/60);return w<24?w+m("ipad.home.my_project.hours_ago"):Math.round(w/24)+m("ipad.home.my_project.days_ago")};X(()=>n.uiState.projectList,k=>{if(t.value)p.value=k.map(r=>{const d=l(r.time);return{id:r.fileId,fileName:r.name,fileImg:r.shot||"",fileText:d,fileType:r.extId||"",isShowProgress:!1}}).splice(0,10),localStorage.setItem("recently_infos",Re(rt(p.value)));else{let r=ee(localStorage.getItem("recently_infos"));r!=null&&r.length&&(p.value=r)}dt(()=>{s.value.scrollLeft="0px"})}),ke(()=>n.uiEffect.deleteProjectResult,k=>{k.isSuccess?R.modal.showToast({msg:m("mobile.projects.delete_success"),icon:"success"}):R.modal.showToast({msg:m("mobile.projects.project_delete_failed"),icon:"error"})});const y=k=>oe([{name:m("mobile.projects.dialog_open_project"),action:"open",data:k},{name:m("mobile.projects.dialog_delete_project"),action:"delete",data:k}]),L=k=>{console.log("action=",k);const{action:r,data:d}=k;if(r==="delete"&&D(z.buttonClick,{buttonName:he.remove,type:"menu"}),!d)return;const E=d,{id:w,fileName:j}=E;switch(r){case"open":h(w,!1);break;case"delete":R.modal.showTipModal({title:m("mobile.projects.dialog_delete_title"),content:m("mobile.projects.dialog_delete_msg"),hasClose:!1,cancelTxt:m("common.msg.cancel"),confirmTxt:m("common.msg.ok"),onConfirm:()=>{n.sendEvent(new Nt(w))}});break}},h=(k,r)=>{D(z.buttonClick,{buttonName:he.open,type:r?"straight":"menu"}),i.push({path:"/editor",query:{fileId:k,source:je.myProject}})};return(k,r)=>(f(),I("div",oo,[u("section",{ref_key:"recentlyRef",ref:s,class:"recently-list list-scroll"},[(f(!0),I(G,null,J(p.value,d=>(f(),V(g(te),ne({key:d.id},{aspectRatio:"auto",borderRadius:12},{class:"recently-card scroll-item"}),{default:S(()=>[_(g(Te),{data:d,"action-list":y(d),"card-type":1,progress:10,onSelectSheet:L,onCardItemClick:E=>h(d.id,!0)},null,8,["data","action-list","onCardItemClick"])]),_:2},1040))),128))],512)]))}}),so=T(no,[["__scopeId","data-v-121c7413"]]),co={class:"project-wrapper"},ao={class:"project-head"},io=F({__name:"RecentlyProject",setup(c){const{t:e}=Q(),t=P(),{connected:n}=xe(t),p=b(Be),m=Y(()=>p.uiState.projectList.length>0),s={aspectRatio:"auto",cardBgc:"#fff",borderRadius:12};return le(()=>{p.sendEvent(new xt)}),(i,l)=>{const y=te;return f(),I("section",co,[u("div",ao,U(g(e)("home.recent.title")),1),m.value?se("",!0):(f(),V(y,ne({key:0},s,{class:["project-card",g(n)&&"connected"]}),{default:S(()=>[_(g(to))]),_:1},16,["class"])),mt(_(g(so),null,null,512),[[ut,m.value]])])}}}),lo=T(io,[["__scopeId","data-v-2fd8a033"]]),ro="data:image/png;base64,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",Ie="/v1",mo="/v2",Ee="store_banner_info_key",Se="store_banner_info_utoken_key",Me="store_recommends_info_key",uo="store_recommends_info_utoken_key";class _e{}class Pe{constructor(e,t){this.link=e,this.openInBrowser=t}}class ${}class De{constructor(e,t){this.id=e,this.type=t}}class ze{constructor(e,t){this.id=e,this.moreLink=t}}class Fe{constructor(e,t){this.url=e,this.title=t}}class Oe{constructor(e,t){this.recommendId=e,this.isLike=t}}class Ve{}class po{getUToken(){return Ae().uToken}getDomain(){return ve()}getUserInfo(){return Ae().userInfo}getConnectedProductId(){return P().getConnectedProductId()}}const ce=new po;function ge(c){return console.log("=>config",c),new Promise((e,t)=>{qe({method:c.method?c.method:"get",timeout:6e4,...c}).then(n=>{n.data.code===0?e(n.data.data):t(n.data)}).catch(n=>t(n))})}const Le=(c=!1)=>{const{domain:e}=ce.getDomain();return c?`${e.url}/community${Ie}/web`:`${e.url}/community${Ie}/xcs`},go=()=>{const{domain:c}=ce.getDomain();return`${c.url}/community${mo}/xcs`};class ho{constructor(){me(this,"currentDownloadFileUrl",M(void 0))}getUtoken(){return ce.getUToken()||""}async getBanners(){return console.log("==>getBanners res: start",this.getUtoken()),await ge({baseURL:Le(),url:"/banners",params:{category:"xcs_home"},headers:{uToken:this.getUtoken()}})}async getRecommends(e){return await ge({baseURL:go(),url:"/blocks",params:{category:"xcs_home",devices:e.join(",")},headers:{uToken:this.getUtoken()}})}async setLikeRecommend(e,t){const n={objectType:"making",objectId:e,revoke:!t};return await ge({baseURL:Le(!0),url:"/action/like",method:"post",data:n,headers:{uToken:this.getUtoken()}})}async getRecommendsInfo(){console.log("==> getRecommendsInfo");const e=ce.getConnectedProductId();console.info("=> 已经使用到的设备productID",e);const t=await this.getRecommends(e);console.log("==>res : ",t);const n=t.map(m=>({...m,items:m.items.map(s=>{var i;return{...s,ossImageUrl:$e(((i=s==null?void 0:s.extra)==null?void 0:i.blockCover)||s.cover,"m_fill,w_400,h_300","webp")}})})),p=Array.from(n);return console.log("==> this.recommends",p),p}openBannerLink(e,t){var n,p;e=`${e}?utm_source=xcs&utm_medium=banner&_channel_track_key=K0EsnClf`,t?(p=(n=window.MeApi)==null?void 0:n.app)==null||p.openBrowser(e):window.MeApi.openNative.openWebInApp(e)}openRecommendDetailsLink(e,t){let n=`${ve().domain.projects}/${t}/${e}`;n+="?utm_source=xcs&utm_medium=case&_channel_track_key=mHl6gpcl",console.log("==> openRecommendDetailsLink url: ",n),window.MeApi.openNative.openWebInApp(n)}openRecommendMoreLink(e,t){let n=`${ve().domain.projects}/column/${e}`;console.log("==> openRecommendMoreLink before url: ",n),t!==""&&(n=t,console.log("==> openRecommendMoreLink url: ",n)),n+="?utm_source=xcs&utm_medium=moreClick&_channel_track_key=6GBot113",window.MeApi.openNative.openWebInApp(n)}async openRecommendProjectInXcs(e){var n;if(console.log("==> openRecommendProjectInXcs url: ",e),this.currentDownloadFileUrl.value)throw console.log("==> openRecommendProjectInXcs has opening: "),R.modal.showToast({msg:"home.recommended.is_file_opening",icon:"info"}),new Error(" ====>openRecommendProjectInXcs 有任务正在打开");this.currentDownloadFileUrl.value=`${e}`;const t=await((n=window.MeApi)==null?void 0:n.fileHelper.openCloudXcs(e));if(console.log("==> open result",t),this.currentDownloadFileUrl.value=void 0,t===-1)throw R.modal.showToast({msg:"home.recommended.file_open_error",icon:"error",duration:3e3}),new Error(" ====> 打开失败");if(typeof t=="string")return t}}const C=new ho;class Qe extends et{createState(){return{isLoadingRecommendProject:!1,currentLoadingRecommendUrl:"",bannersInfos:[],recommendsInfos:[]}}setEventHandler(){this.registerEventHandler(_e,this.getBanners),this.registerEventHandler(Pe,this.openBannerLink),this.registerEventHandler($,this.getRecommends),this.registerEventHandler(De,this.openRecommendDetailsLink),this.registerEventHandler(ze,this.openRecommendMoreLink),this.registerEventHandler(Fe,this.openRecommendProjectInXcs),this.registerEventHandler(Oe,this.handleSetLikeRecommendsEvent),this.registerEventHandler(Ve,this.getCurrentLoadingProjectUrl)}getCacheBanners(){const e=localStorage.getItem(Se);C.getUtoken()!==""&&e&&e===C.getUtoken()?this.updateState({bannersInfos:ee(localStorage.getItem(Ee),{defaultValue:[]})}):this.updateState({bannersInfos:[]})}async getBanners(){try{this.getCacheBanners();const e=await C.getBanners();console.log("==>getBanners res: ",e);const t=Array.from(e);localStorage.setItem(Ee,JSON.stringify(t)),localStorage.setItem(Se,C.getUtoken()),this.updateState({bannersInfos:t})}catch(e){console.log("==>e",e),this.getCacheBanners()}}getCacheRecommends(){this.updateState({recommendsInfos:ee(localStorage.getItem(Me),{defaultValue:[]})})}async getRecommends(){try{this.getCacheRecommends();const e=await C.getRecommendsInfo();console.log("==> getRecommends res ",e.length);const t=[];for(const n of e){const p={id:n.id,title:n.title,moreLink:n.moreLink,item:[]},{items:m}=n,s=Array.from(m),i=[];for(const l of s){const y={id:l.id,title:l.title,type:l.type,deviceName:l.deviceName,createdByHeadpic:l.createdByHeadpic,createdByName:l.createdByName,ossImageUrl:l.ossImageUrl,file:{url:l.xcsFiles[0].url,fileName:l.xcsFiles[0].name},actionSum:{like:l.actionSum.like,unlike:l.actionSum.unlike,view:l.actionSum.view},userAction:{like:l.userAction.like,unlike:l.userAction.unlike,view:l.userAction.view},hasDiscount:l.hasDiscount,forSale:l.forSale,hasRight:l.hasRight,origPrice:l.origPrice,discount:{disPrice:l.discount.disPrice,discountPercent:l.discount.discountPercent},sellTag:l.sellTag};i.push(y)}p.item=i,t.push(p)}console.log("==>getRecommends last result: ",t),localStorage.setItem(Me,JSON.stringify(t)),localStorage.setItem(uo,C.getUtoken()),this.updateState({recommendsInfos:t})}catch(e){console.log(e),this.getCacheRecommends()}}openBannerLink(e){try{C.openBannerLink(e.link,e.openInBrowser)}catch(t){console.error("==>openBannerLink error : ",t)}}openRecommendDetailsLink(e){try{C.openRecommendDetailsLink(e.id,e.type)}catch(t){console.error("==>openRecommendDetailsLink error : ",t)}}openRecommendMoreLink(e){D(z.buttonClick,{elementId:he.seeMore,source:"caseRecommend"});try{C.openRecommendMoreLink(e.id,e.moreLink)}catch(t){console.log("==>openRecommendMoreLink error : ",t)}}async openRecommendProjectInXcs(e){this.updateState({isLoadingRecommendProject:!0});try{const t=await C.openRecommendProjectInXcs(e.url),n=e.title.split(".").slice(0,-1).join(".");this.sendEffect({openRecommendProjectResult:{filePath:t,title:n}})}catch(t){throw this.sendEffect({openRecommendProjectResult:{filePath:void 0,title:""}}),new Error(`open recommend file error====>. [${t}]`)}finally{this.updateState({isLoadingRecommendProject:!1})}}async handleSetLikeRecommendsEvent(e){try{return await C.setLikeRecommend(e.recommendId,e.isLike),!0}catch(t){return console.log("==>handleSetLikeRecommendsEvent error : ",t),!1}}getCurrentLoadingProjectUrl(){C.currentDownloadFileUrl.value&&this.updateState({currentLoadingRecommendUrl:C.currentDownloadFileUrl.value})}}var K,H;const N=class N{static add(e,t){O(N,K).set(e,t)}static addStop(e,t){O(N,H).set(e,t)}static remove(e){O(N,K).delete(e),O(N,H).delete(e)}static onActivity(){N.isActive=!0,O(N,K).forEach(e=>e())}static onPause(){N.isActive=!1,O(N,H).forEach(e=>e())}};K=new WeakMap,H=new WeakMap,ue(N,K,new Map),ue(N,H,new Map),me(N,"isActive",!0);let ae=N;const vo={class:"project-wrapper"},fo={key:0,class:"project-content"},_o={class:"project-head"},ko={class:"project-head-title"},wo=["onClick"],Ao={class:"more-icon"},yo={key:0,class:"recommand-list list-scroll"},Io={key:0},Eo={class:"project-head"},So={class:"project-head-title"},Mo={class:"skeleton-box list-scroll"},Lo={class:"skeleton-img"},Co=["src"],No={class:"skeleton-bottom"},xo={class:"empty-text"},Ce="recommend",Ro=F({__name:"Recommand",setup(c){const{t:e}=Q(),t={aspectRatio:"auto",borderRadius:12},n=re(),p=ie(),m=M(!1),s=p.isOnline,i=b(Qe),l=b(we);M("good");const y=tt(),L=M(!0),h=M([]);le(()=>{console.log("==>recommend onMounted"),i.sendEvent(new $),ae.add(Ce,()=>{i.sendEvent(new $)})}),n.beforeEach((o,v,a)=>{var x;o.path==="/editor"&&((x=d.value)==null||x.close()),a()}),pt(()=>{console.log("==>recommend onUnMounted"),ae.remove(Ce)});const k=o=>{console.log("==>seeMore item",o);const{id:v,moreLink:a}=o;i.sendEvent(new ze(v,a))},r=async o=>{if(console.log("==>clickRecommendLike ",o),!l.uiState.isLogin){l.sendEvent(new lt);return}await i.sendEvent(new Oe(o.id,!o.isLike))?(o.isLike=!o.isLike,o.isLike?(o.likeNum+=1,console.log("==>点赞操作成功")):(o.likeNum-=1,console.log("==>点赞取消操作成功"))):R.modal.showToast({msg:"common.network_error_retry",icon:"error"})};let d=oe({});X(()=>i.uiState.isLoadingRecommendProject,o=>{var v;m.value=o,o?d.value=R.modal.showToast({icon:"loading",msg:"",duration:0,forbidClick:!0,layout:"vertical"}):(v=d.value)==null||v.close(),i.sendEvent(new Ve)}),X(()=>i.uiState.recommendsInfos,o=>{try{const v=[];for(let a=0;a<o.length;a++){const x=[];console.log("==> item.item",o[a].item.length);for(let A=0;A<o[a].item.length&&(x.push({groupId:a,id:o[a].item[A].id,fileName:o[a].item[A].title,createdByName:o[a].item[A].createdByName,fileImg:o[a].item[A].ossImageUrl,fileType:o[a].item[A].deviceName,type:o[a].item[A].type,fileAvatar:o[a].item[A].createdByHeadpic,isLike:o[a].item[A].userAction.like!==0,likeNum:o[a].item[A].actionSum.like,fileUrl:o[a].item[A].file.url,hasDiscount:o[a].item[A].hasDiscount,forSale:o[a].item[A].forSale,hasRight:o[a].item[A].hasRight,discount:{disPrice:o[a].item[A].discount.disPrice,discountPercent:o[a].item[A].discount.discountPercent},origPrice:o[a].item[A].origPrice,sellTag:o[a].item[A].sellTag}),!(x.length>=10));A++);v.push({id:o[a].id,title:o[a].title,moreLink:o[a].moreLink,item:x})}h.value=v,console.log("==>recommends DeviceGroups ",h.value.length)}catch(v){console.log("==>e ",v)}o.length&&(L.value=!1)}),ke(()=>i.uiEffect.openRecommendProjectResult,o=>{var v;o.filePath?(console.log("==>openRecommendProjectResult ",o),(v=d.value)==null||v.close(),setTimeout(()=>{n.push({path:"/editor",query:{filePath:o.filePath,fileName:o.title,source:je.homeCaseRecommend}})},500)):R.modal.showToast({msg:e("ipad.common.failed_to_open_file"),icon:"error"})}),Ue(()=>[s.value,l.uiState.isLogin,y.pageResumeAt],o=>{o[0]&&(console.log("==> isOnline 恢复网络或者登陆状态变化或者回到前台重新获取recommends info"),i.sendEvent(new $))});const E=o=>{let v=[{name:e("ipad.home.recommended.open"),action:"Open",value:"open",data:o},{name:e("ipad.home.recommended.details"),action:"View",value:"details",data:o}];return o.forSale&&!o.hasRight&&(v=[{name:e("home.recommended.buy"),action:"Buy",value:"buy",data:o}]),oe(v)},w=(o,v)=>{if(m.value){console.log("==>isFileLoading "),R.modal.showToast({msg:e("home.recommended.is_file_opening"),icon:"loading"});return}try{const a=o.id,x=o.type;console.log("==>handleDetail ",a,x),i.sendEvent(new De(a,x))}catch(a){console.log("==>handleDetail: ",a)}D(z.caseClick,{blockName:h.value[o.groupId].title,name:o.title,x:parseInt(o.id),buttonName:"details",type:v?"straight":"menu"})},j=o=>{if(console.log("==>handleOpenInXcs item :",o),D(z.caseClick,{blockName:h.value[o.groupId].title,name:o.fileName,x:parseInt(o.id),buttonName:"open",type:"menu"}),m.value){R.modal.showToast({msg:e("home.recommended.is_file_opening"),icon:"loading"});return}const v=o.fileUrl,a=o.fileName;i.sendEvent(new Fe(v,a))},B=o=>{console.log("action=",o);const{value:v,data:a}=o;switch(v){case"open":console.log(v),a&&(console.log("==>handleSelectSheet open ",a),j(a));break;case"buy":console.log("value",v),a&&(console.log("==>handleSelectSheet default ",a),w(a,!1));break;default:console.log(v),a&&(console.log("==>handleSelectSheet default ",a),w(a,!1));break}},q=o=>{try{o&&(console.log("==>cardItemClick ",o),w(o,!0))}catch(v){console.log("==>cardItemClick error ",v)}};return(o,v)=>{const a=Z,x=kt,A=wt,Ke=At,He=yt;return f(),I("div",vo,[g(s)?(f(),I("div",fo,[(f(!0),I(G,null,J(h.value,W=>(f(),I("div",{key:W.id,class:"project-box"},[u("div",_o,[u("div",ko,U(W.title),1),u("div",{class:"tip-more",onClick:de=>k(W)},[u("span",Ao,U(g(e)("home.recommended.more")),1),_(a,{class:"f-s-16",name:"arrow_right",size:"16px"})],8,wo)]),L.value?se("",!0):(f(),I("div",yo,[(f(!0),I(G,null,J(W.item,(de,Ye)=>(f(),V(g(te),ne({key:Ye},t,{class:"recommand-card scroll-item"}),{default:S(()=>[_(g(Te),{data:de,"action-list":E(de),"card-type":2,onSelectSheet:B,onLikeAction:r,onCardItemClick:q},null,8,["data","action-list"])]),_:2},1040))),128))]))]))),128)),L.value?(f(),I("div",Io,[u("div",Eo,[u("div",So,U(g(e)("home.recommended.title")),1)]),_(Ke,{animate:!1,loading:!0},{template:S(()=>[u("div",Mo,[(f(),I(G,null,J([1,2,3],W=>_(g(te),ne({key:W},t,{class:"skeleton-item scroll-item"}),{default:S(()=>[u("div",Lo,[u("img",{src:g(fe),alt:""},null,8,Co)]),u("div",No,[_(x,{"avatar-size":"14"}),_(A,{"row-width":"60%"})])]),_:2},1040)),64))])]),_:1})])):se("",!0)])):(f(),V(He,{key:1,image:g(ro),"image-size":[64,64],description:g(e)("home.recommended.not_error"),class:"van-empty-box"},{default:S(()=>[u("div",xo,U(o.$t("home.recommended.net_error_desc")),1)]),_:1},8,["image","description"]))])}}}),jo=T(Ro,[["__scopeId","data-v-d07fe632"]]),Uo={class:"device-panel-card"},bo=F({__name:"SelectDevice",setup(c){const e=M(""),t=M(!1),n=M([{text:"D1",value:"D1"},{text:"D1Pro",value:"D1Pro"},{text:"D1Pro 2.0",value:"D1Pro 2.0"},{text:"S1",value:"S1"},{text:"F1",value:"F1"},{text:"F1 Ultra",value:"F1Ultra"},{text:"P1",value:"P1"},{text:"P2",value:"P2"},{text:"M1",value:"M1"},{text:"M2",value:"M2"}]),p=P(),m=({selectedOptions:s})=>{t.value=!1,e.value=s[0].text;const i=s[0].value;console.log("[选择调试设备]=>",i),p.changeDevice(i)};return(s,i)=>{const l=It,y=Et,L=St;return f(),I("section",Uo,[_(l,{modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=h=>e.value=h),"is-link":"",readonly:"",label:"选择设备",placeholder:"选择设备开发调试",onClick:i[1]||(i[1]=h=>t.value=!0)},null,8,["modelValue"]),_(L,{show:t.value,"onUpdate:show":i[3]||(i[3]=h=>t.value=h),round:"",position:"bottom"},{default:S(()=>[_(y,{columns:n.value,onCancel:i[2]||(i[2]=h=>t.value=!1),onConfirm:m},null,8,["columns"])]),_:1},8,["show"])])}}}),Bo=T(bo,[["__scopeId","data-v-8083bf28"]]),To=""+new URL("../assets/banner-connect-Wi9Z8rGd.png",import.meta.url).href,We=c=>(ht("data-v-3cfb310f"),c=c(),vt(),c),Po={id:"home",class:"home"},Do={class:"device-container"},zo={class:"home-title"},Fo=We(()=>u("div",null,null,-1)),Oo=We(()=>u("div",null,null,-1)),Vo={key:0,class:"section-wrapper"},Qo={class:"section-wrapper"},Wo={class:"section-wrapper extra-content"},Ko={class:"section-wrapper extra-content"},Ho=F({__name:"Home",setup(c){const{t:e}=Q(),t=b(st),n=b(Qe),p=b(we),s=ie().isOnline,i=[{name:"swiper1",src:To,callback(){}}],l=M(i),y=M(localStorage.getItem("EXT_SELECTOR")==="show");ke(()=>t.uiEffect.checkNeedReopenResult,r=>{var j;const{isNeedReopen:d,tempXcsFileId:E}=r,w=(j=window.MeApi)==null?void 0:j.openFile;if(d)console.log("reopen Editor tempXcsFileId ==> ",E),Ne.push({path:"/editor",query:{tempXcsFileId:E}}),P().connectLastDevice();else{const B=w.getFile();B?(console.log("=========> shareFilePath",B),w.callOpenFileHandler({filePath:B})):P().connectLastDevice()}setTimeout(()=>{w.setFile("")},50)}),le(()=>{n.sendEvent(new _e),P().loadLastDevice(!1).then(()=>{t.sendEvent(new ot)}),nt.isShowProcessingPanel.value=!1}),Ue(()=>[s.value,p.uiState.isLogin],r=>{r[0]&&(console.log("==> isOnline 恢复网络或者登陆状态变化重新获取banner info"),n.sendEvent(new _e))});const L=r=>{const d=[];for(let E=0;E<r.length;E++){const{name:w,cover:j,link:B,openInBrowser:q}=r[E];let o={};o.src=j.coverApp,o.name=w,o.openInBrowser=q,o.callback=()=>{D(z.bannerClick,{x:E+1,total:r.length,name:o.name}),n.sendEvent(new Pe(B,q))},d.push(o)}return console.log("==> banner infos: ",d),d};X(()=>n.uiState.bannersInfos,r=>{console.log("==>observeState homeBanner list: ",r);try{if(s.value)localStorage.setItem("banner_infos",Re(r)),r.length==0?l.value=i:l.value=L(r);else{let d=ee(localStorage.getItem("banner_infos"));d!=null&&d.length&&(l.value=L(d))}}catch(d){console.log("==>observeState homeBanner error: ",d)}});const h=M(!1),k=()=>{setTimeout(()=>{h.value=!1},2e3)};return(r,d)=>{const E=Mt,w=Ct,j=Lt;return f(),I("div",Po,[u("section",Do,[_(E,{fixed:"",placeholder:"","z-index":"100"},{left:S(()=>[u("span",zo,U(g(e)("common.app.name")),1)]),right:S(()=>[(f(),V(gt(Tt)))]),_:1})]),_(j,{modelValue:h.value,"onUpdate:modelValue":d[0]||(d[0]=B=>h.value=B),"head-height":72,class:"home-refresh",onRefresh:k},{pulling:S(()=>[Fo]),loosing:S(()=>[Oo]),loading:S(()=>[_(w,{type:"spinner",size:"24px"})]),default:S(()=>[u("section",null,[_(g(Zt),{list:l.value},null,8,["list"])]),y.value?(f(),I("section",Vo,[_(g(Bo))])):se("",!0),u("section",Qo,[_(g(Kt))]),u("section",Wo,[_(g(lo))]),u("section",Ko,[_(g(jo))])]),_:1},8,["modelValue"])])}}}),ln=T(Ho,[["__scopeId","data-v-3cfb310f"]]);export{ln as default};
