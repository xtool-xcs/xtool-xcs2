(function(){"use strict";const Zr=($,G,B)=>{const[Q,q,R]=$.split(",").map(Number),[j,T,ir]=G.split(",").map(Number),vr=Math.sqrt(Math.pow(j-Q,2)+Math.pow(T-q,2)+Math.pow(ir-R,2));return 1.7333333333333334*B>=vr};function J($,G){this.x=$,this.y=G}function Fr($,G){this.w=$,this.h=G,this.size=$*G,this.arraybuffer=new ArrayBuffer(this.size),this.data=new Int8Array(this.arraybuffer)}var Vr=function(){J.prototype.copy=function(){return new J(this.x,this.y)},Fr.prototype.at=function(v,l){return v>=0&&v<this.w&&l>=0&&l<this.h&&this.data[this.w*l+v]===1},Fr.prototype.index=function(v){var l=new J;return l.y=Math.floor(v/this.w),l.x=v-l.y*this.w,l},Fr.prototype.flip=function(v,l){this.at(v,l)?this.data[this.w*l+v]=0:this.data[this.w*l+v]=1},Fr.prototype.copy=function(){var v=new Fr(this.w,this.h),l;for(l=0;l<this.size;l++)v.data[l]=this.data[l];return v};function $(){this.area=0,this.len=0,this.curve={},this.pt=[],this.minX=1e5,this.minY=1e5,this.maxX=-1,this.maxY=-1}function G(v){this.n=v,this.tag=new Array(v),this.c=new Array(v*3),this.alphaCurve=0,this.vertex=new Array(v),this.alpha=new Array(v),this.alpha0=new Array(v),this.beta=new Array(v)}var B=null,Q=null,q=null,R=[],j,T={isReady:!1,turnpolicy:"minority",turdsize:2,optcurve:!0,alphamax:1,opttolerance:.2,color:"#FD9328"};try{B=document.createElement("img"),Q=document.createElement("canvas"),B.onload=function(){ea(),Yr()}}catch{}function ir(v,l,S){T.isReady&&Lr(),q=new Fr(l,S);var y=v.length,I,H;for(I=0,H=0;I<y;I++,H++)q.data[H]=v[I]<128?1:0;T.isReady=!0}function vr(v,l,S){T.isReady&&Lr(),q=new Fr(l,S);var y=v.length,I,H,sr;for(I=0,H=0;I<y;I+=4,H++)sr=v[I+3],q.data[H]=sr<128?1:0;T.isReady=!0}function lr(v){T.isReady&&Lr(),B.file=v;var l=new FileReader;l.onload=function(S){return function(y){S.src=y.target.result}}(B),l.readAsDataURL(v)}function pr(v){T.isReady&&Lr(),B.src=v}function gr(v){var l;for(l in v)v.hasOwnProperty(l)&&(T[l]=v[l])}function ea(){Q.width=B.width,Q.height=B.height;var v=Q.getContext("2d");v.drawImage(B,0,0)}function Yr(){var v=Q.getContext("2d");q=new Fr(Q.width,Q.height);var l=v.getImageData(0,0,q.w,q.h),S=l.data.length,y,I,H;for(y=0,I=0;y<S;y+=4,I++)H=.2126*l.data[y]+.7153*l.data[y+1]+.0721*l.data[y+2],q.data[I]=H<128?1:0;T.isReady=!0}function _r(v=q){var l=v.copy(),S=new J(0,0),y;function I(U){for(var g=l.w*U.y+U.x;g<l.size&&l.data[g]!==1;)g++;return g<l.size&&l.index(g)}function H(U,g){var V,h,C;for(V=2;V<5;V++){for(C=0,h=-V+1;h<=V-1;h++)C+=l.at(U+h,g+V-1)?1:-1,C+=l.at(U+V-1,g+h-1)?1:-1,C+=l.at(U+h-1,g-V)?1:-1,C+=l.at(U-V,g+h)?1:-1;if(C>0)return 1;if(C<0)return 0}return 0}function sr(U){var g=new $,V=U.x,h=U.y,C=0,X=1,Z;for(g.sign=v.at(U.x,U.y)?"+":"-";g.pt.push(new J(V,h)),V>g.maxX&&(g.maxX=V),V<g.minX&&(g.minX=V),h>g.maxY&&(g.maxY=h),h<g.minY&&(g.minY=h),g.len++,V+=C,h+=X,g.area-=V*X,!(V===U.x&&h===U.y);){var Y=l.at(V+(C+X-1)/2,h+(X-C-1)/2),nr=l.at(V+(C-X-1)/2,h+(X+C-1)/2);nr&&!Y?T.turnpolicy==="right"||T.turnpolicy==="black"&&g.sign==="+"||T.turnpolicy==="white"&&g.sign==="-"||T.turnpolicy==="majority"&&H(V,h)||T.turnpolicy==="minority"&&!H(V,h)?(Z=C,C=-X,X=Z):(Z=C,C=X,X=-Z):nr?(Z=C,C=-X,X=Z):Y||(Z=C,C=X,X=-Z)}return g}function Ar(U){var g=U.pt[0].y,V=U.len,h,C,X,Z,Y,nr;for(Y=1;Y<V;Y++)if(h=U.pt[Y].x,C=U.pt[Y].y,C!==g){for(Z=g<C?g:C,X=U.maxX,nr=h;nr<X;nr++)l.flip(nr,Z);g=C}}for(;S=I(S);)y=sr(S),Ar(y),(S.x!==0||S.y!==0)&&y.area>T.turdsize&&R.push(y)}function Hr(v){function l(){this.data=[0,0,0,0,0,0,0,0,0]}l.prototype.at=function(a,o){return this.data[a*3+o]};function S(a,o,r,t,e){this.x=a,this.y=o,this.xy=r,this.x2=t,this.y2=e}function y(a,o){return a>=o?a%o:a>=0?a:o-1-(-1-a)%o}function I(a,o){return a.x*o.y-a.y*o.x}function H(a,o,r){return a<=r?a<=o&&o<r:a<=o||o<r}function sr(a){return a>0?1:a<0?-1:0}function Ar(a,o){var r=new Array(3),t,e,c;for(r[0]=o.x,r[1]=o.y,r[2]=1,c=0,t=0;t<3;t++)for(e=0;e<3;e++)c+=r[t]*a.at(t,e)*r[e];return c}function U(a,o,r){var t=new J;return t.x=o.x+a*(r.x-o.x),t.y=o.y+a*(r.y-o.y),t}function g(a,o){var r=new J;return r.y=sr(o.x-a.x),r.x=-sr(o.y-a.y),r}function V(a,o){var r=g(a,o);return r.y*(o.x-a.x)-r.x*(o.y-a.y)}function h(a,o,r){var t,e,c,f;return t=o.x-a.x,e=o.y-a.y,c=r.x-a.x,f=r.y-a.y,t*f-c*e}function C(a,o,r,t){var e,c,f,m;return e=o.x-a.x,c=o.y-a.y,f=t.x-r.x,m=t.y-r.y,e*m-f*c}function X(a,o,r){var t,e,c,f;return t=o.x-a.x,e=o.y-a.y,c=r.x-a.x,f=r.y-a.y,t*c+e*f}function Z(a,o,r,t){var e,c,f,m;return e=o.x-a.x,c=o.y-a.y,f=t.x-r.x,m=t.y-r.y,e*f+c*m}function Y(a,o){return Math.sqrt((a.x-o.x)*(a.x-o.x)+(a.y-o.y)*(a.y-o.y))}function nr(a,o,r,t,e){var c=1-a,f=new J;return f.x=c*c*c*o.x+3*(c*c*a)*r.x+3*(a*a*c)*t.x+a*a*a*e.x,f.y=c*c*c*o.y+3*(c*c*a)*r.y+3*(a*a*c)*t.y+a*a*a*e.y,f}function N(a,o,r,t,e,c){var f,m,x,A,L,n,i,d,M,b;return f=C(a,o,e,c),m=C(o,r,e,c),x=C(r,t,e,c),A=f-2*m+x,L=-2*f+2*m,n=f,i=L*L-4*A*n,A===0||i<0?-1:(d=Math.sqrt(i),M=(-L+d)/(2*A),b=(-L-d)/(2*A),M>=0&&M<=1?M:b>=0&&b<=1?b:-1)}function br(a){var o,r,t;a.x0=a.pt[0].x,a.y0=a.pt[0].y,a.sums=[];var e=a.sums;for(e.push(new S(0,0,0,0,0)),o=0;o<a.len;o++)r=a.pt[o].x-a.x0,t=a.pt[o].y-a.y0,e.push(new S(e[o].x+r,e[o].y+t,e[o].xy+r*t,e[o].x2+r*r,e[o].y2+t*t))}function qr(a){var o=a.len,r=a.pt,t,e=new Array(o),c=new Array(o),f=new Array(4);a.lon=new Array(o);var m=[new J,new J],x=new J,A=new J,L=new J,n,i,d,M,b,k,F,u,s=0;for(i=o-1;i>=0;i--)r[i].x!==r[s].x&&r[i].y!==r[s].y&&(s=i+1),c[i]=s;for(i=o-1;i>=0;i--){for(f[0]=f[1]=f[2]=f[3]=0,t=(3+3*(r[y(i+1,o)].x-r[i].x)+(r[y(i+1,o)].y-r[i].y))/2,f[t]++,m[0].x=0,m[0].y=0,m[1].x=0,m[1].y=0,s=c[i],M=i;;){if(n=0,t=(3+3*sr(r[s].x-r[M].x)+sr(r[s].y-r[M].y))/2,f[t]++,f[0]&&f[1]&&f[2]&&f[3]){e[i]=M,n=1;break}if(x.x=r[s].x-r[i].x,x.y=r[s].y-r[i].y,I(m[0],x)<0||I(m[1],x)>0||(Math.abs(x.x)<=1&&Math.abs(x.y)<=1||(A.x=x.x+(x.y>=0&&(x.y>0||x.x<0)?1:-1),A.y=x.y+(x.x<=0&&(x.x<0||x.y<0)?1:-1),I(m[0],A)>=0&&(m[0].x=A.x,m[0].y=A.y),A.x=x.x+(x.y<=0&&(x.y<0||x.x<0)?1:-1),A.y=x.y+(x.x>=0&&(x.x>0||x.y<0)?1:-1),I(m[1],A)<=0&&(m[1].x=A.x,m[1].y=A.y)),M=s,s=c[M],!H(s,i,M)))break}n===0&&(L.x=sr(r[s].x-r[M].x),L.y=sr(r[s].y-r[M].y),x.x=r[M].x-r[i].x,x.y=r[M].y-r[i].y,b=I(m[0],x),k=I(m[0],L),F=I(m[1],x),u=I(m[1],L),d=1e7,k<0&&(d=Math.floor(b/-k)),u>0&&(d=Math.min(d,Math.floor(-F/u))),e[i]=y(M+d,o))}for(d=e[o-1],a.lon[o-1]=d,i=o-2;i>=0;i--)H(i+1,e[i],d)&&(d=e[i]),a.lon[i]=d;for(i=o-1;H(y(i+1,o),d,a.lon[i]);i--)a.lon[i]=d}function Or(a){function o(k,F,u){var s=k.len,K=k.pt,P=k.sums,hr,yr,cr,_,rr,D,Pr,xr,fr,or,O,w,p,E,mr=0;return u>=s&&(u-=s,mr=1),mr===0?(hr=P[u+1].x-P[F].x,yr=P[u+1].y-P[F].y,_=P[u+1].x2-P[F].x2,cr=P[u+1].xy-P[F].xy,rr=P[u+1].y2-P[F].y2,D=u+1-F):(hr=P[u+1].x-P[F].x+P[s].x,yr=P[u+1].y-P[F].y+P[s].y,_=P[u+1].x2-P[F].x2+P[s].x2,cr=P[u+1].xy-P[F].xy+P[s].xy,rr=P[u+1].y2-P[F].y2+P[s].y2,D=u+1-F+s),O=(K[F].x+K[u].x)/2-K[0].x,w=(K[F].y+K[u].y)/2-K[0].y,E=K[u].x-K[F].x,p=-(K[u].y-K[F].y),Pr=(_-2*hr*O)/D+O*O,xr=(cr-hr*w-yr*O)/D+O*w,fr=(rr-2*yr*w)/D+w*w,or=p*p*Pr+2*p*E*xr+E*E*fr,Math.sqrt(or)}var r,t,e,c,f=a.len,m=new Array(f+1),x=new Array(f+1),A=new Array(f),L=new Array(f+1),n=new Array(f+1),i=new Array(f+1),d,M,b;for(r=0;r<f;r++)b=y(a.lon[y(r-1,f)]-1,f),b===r&&(b=y(r+1,f)),b<r?A[r]=f:A[r]=b;for(t=1,r=0;r<f;r++)for(;t<=A[r];)L[t]=r,t++;for(r=0,t=0;r<f;t++)n[t]=r,r=A[r];for(n[t]=f,e=t,r=f,t=e;t>0;t--)i[t]=r,r=L[r];for(i[0]=0,m[0]=0,t=1;t<=e;t++)for(r=i[t];r<=n[t];r++){for(M=-1,c=n[t-1];c>=L[r];c--)d=o(a,c,r)+m[c],(M<0||d<M)&&(x[r]=c,M=d);m[r]=M}for(a.m=e,a.po=new Array(e),r=f,t=e-1;r>0;t--)r=x[r],a.po[t]=r}function Cr(a){function o(Pr,xr,fr,or,O){for(var w=Pr.len,p=Pr.sums,E,mr,Br,Ir,Ur,ur,ar,W,tr,wr,er,z=0;fr>=w;)fr-=w,z+=1;for(;xr>=w;)xr-=w,z-=1;for(;fr<0;)fr+=w,z-=1;for(;xr<0;)xr+=w,z+=1;E=p[fr+1].x-p[xr].x+z*p[w].x,mr=p[fr+1].y-p[xr].y+z*p[w].y,Br=p[fr+1].x2-p[xr].x2+z*p[w].x2,Ir=p[fr+1].xy-p[xr].xy+z*p[w].xy,Ur=p[fr+1].y2-p[xr].y2+z*p[w].y2,ur=fr+1-xr+z*w,or.x=E/ur,or.y=mr/ur,ar=(Br-E*E/ur)/ur,W=(Ir-E*mr/ur)/ur,tr=(Ur-mr*mr/ur)/ur,wr=(ar+tr+Math.sqrt((ar-tr)*(ar-tr)+4*W*W))/2,ar-=wr,tr-=wr,Math.abs(ar)>=Math.abs(tr)?(er=Math.sqrt(ar*ar+W*W),er!==0&&(O.x=-W/er,O.y=ar/er)):(er=Math.sqrt(tr*tr+W*W),er!==0&&(O.x=-tr/er,O.y=W/er)),er===0&&(O.x=O.y=0)}var r=a.m,t=a.po,e=a.len,c=a.pt,f=a.x0,m=a.y0,x=new Array(r),A=new Array(r),L=new Array(r),n=new Array(3),i,d,M,b,k,F=new J;for(a.curve=new G(r),d=0;d<r;d++)M=t[y(d+1,r)],M=y(M-t[d],e)+t[d],x[d]=new J,A[d]=new J,o(a,t[d],M,x[d],A[d]);for(d=0;d<r;d++)if(L[d]=new l,i=A[d].x*A[d].x+A[d].y*A[d].y,i===0)for(M=0;M<3;M++)for(b=0;b<3;b++)L[d].data[M*3+b]=0;else for(n[0]=A[d].y,n[1]=-A[d].x,n[2]=-n[1]*x[d].y-n[0]*x[d].x,k=0;k<3;k++)for(b=0;b<3;b++)L[d].data[k*3+b]=n[k]*n[b]/i;var u,s,K,P,hr,yr,cr,_,rr,D;for(d=0;d<r;d++){for(u=new l,s=new J,F.x=c[t[d]].x-f,F.y=c[t[d]].y-m,M=y(d-1,r),k=0;k<3;k++)for(b=0;b<3;b++)u.data[k*3+b]=L[M].at(k,b)+L[d].at(k,b);for(;;){if(hr=u.at(0,0)*u.at(1,1)-u.at(0,1)*u.at(1,0),hr!==0){s.x=(-u.at(0,2)*u.at(1,1)+u.at(1,2)*u.at(0,1))/hr,s.y=(u.at(0,2)*u.at(1,0)-u.at(1,2)*u.at(0,0))/hr;break}for(u.at(0,0)>u.at(1,1)?(n[0]=-u.at(0,1),n[1]=u.at(0,0)):u.at(1,1)?(n[0]=-u.at(1,1),n[1]=u.at(1,0)):(n[0]=1,n[1]=0),i=n[0]*n[0]+n[1]*n[1],n[2]=-n[1]*F.y-n[0]*F.x,k=0;k<3;k++)for(b=0;b<3;b++)u.data[k*3+b]+=n[k]*n[b]/i}if(K=Math.abs(s.x-F.x),P=Math.abs(s.y-F.y),K<=.5&&P<=.5){a.curve.vertex[d]=new J(s.x+f,s.y+m);continue}if(yr=Ar(u,F),_=F.x,rr=F.y,u.at(0,0)!==0)for(D=0;D<2;D++)s.y=F.y-.5+D,s.x=-(u.at(0,1)*s.y+u.at(0,2))/u.at(0,0),K=Math.abs(s.x-F.x),cr=Ar(u,s),K<=.5&&cr<yr&&(yr=cr,_=s.x,rr=s.y);if(u.at(1,1)!==0)for(D=0;D<2;D++)s.x=F.x-.5+D,s.y=-(u.at(1,0)*s.x+u.at(1,2))/u.at(1,1),P=Math.abs(s.y-F.y),cr=Ar(u,s),P<=.5&&cr<yr&&(yr=cr,_=s.x,rr=s.y);for(k=0;k<2;k++)for(b=0;b<2;b++)s.x=F.x-.5+k,s.y=F.y-.5+b,cr=Ar(u,s),cr<yr&&(yr=cr,_=s.x,rr=s.y);a.curve.vertex[d]=new J(_+f,rr+m)}}function $r(a){var o=a.curve,r=o.n,t=o.vertex,e,c,f;for(e=0,c=r-1;e<c;e++,c--)f=t[e],t[e]=t[c],t[c]=f}function dr(a){var o=a.curve.n,r=a.curve,t,e,c,f,m,x,A,L,n;for(t=0;t<o;t++)e=y(t+1,o),c=y(t+2,o),n=U(1/2,r.vertex[c],r.vertex[e]),m=V(r.vertex[t],r.vertex[c]),m!==0?(f=h(r.vertex[t],r.vertex[e],r.vertex[c])/m,f=Math.abs(f),x=f>1?1-1/f:0,x=x/.75):x=4/3,r.alpha0[e]=x,x>=T.alphamax?(r.tag[e]="CORNER",r.c[3*e+1]=r.vertex[e],r.c[3*e+2]=n):(x<.55?x=.55:x>1&&(x=1),A=U(.5+.5*x,r.vertex[t],r.vertex[e]),L=U(.5+.5*x,r.vertex[c],r.vertex[e]),r.tag[e]="CURVE",r.c[3*e+0]=A,r.c[3*e+1]=L,r.c[3*e+2]=n),r.alpha[e]=x,r.beta[e]=.5;r.alphacurve=1}function kr(a){function o(){this.pen=0,this.c=[new J,new J],this.t=0,this.s=0,this.alpha=0}function r(cr,_,rr,D,Pr,xr,fr){var or=cr.curve.n,O=cr.curve,w=O.vertex,p,E,mr,Br,Ir,Ur,ur,ar,W,tr,wr,er,z,Er,Nr,Dr,Kr,Gr,Tr,Sr,Wr,Qr,Mr;if(_===rr||(p=_,Ir=y(_+1,or),E=y(p+1,or),Br=xr[E],Br===0))return 1;for(ar=Y(w[_],w[Ir]),p=E;p!==rr;p=E)if(E=y(p+1,or),mr=y(p+2,or),xr[E]!==Br||sr(C(w[_],w[Ir],w[E],w[mr]))!==Br||Z(w[_],w[Ir],w[E],w[mr])<ar*Y(w[E],w[mr])*-.999847695156)return 1;if(wr=O.c[y(_,or)*3+2].copy(),er=w[y(_+1,or)].copy(),z=w[y(rr,or)].copy(),Er=O.c[y(rr,or)*3+2].copy(),Ur=fr[rr]-fr[_],Ur-=h(w[0],O.c[_*3+2],O.c[rr*3+2])/2,_>=rr&&(Ur+=fr[or]),Gr=h(wr,er,z),Tr=h(wr,er,Er),Sr=h(wr,z,Er),Wr=Gr+Sr-Tr,Tr===Gr||(Mr=Sr/(Sr-Wr),Qr=Tr/(Tr-Gr),Dr=Tr*Mr/2,Dr===0))return 1;for(Kr=Ur/Dr,ur=2-Math.sqrt(4-Kr/.3),D.c[0]=U(Mr*ur,wr,er),D.c[1]=U(Qr*ur,Er,z),D.alpha=ur,D.t=Mr,D.s=Qr,er=D.c[0].copy(),z=D.c[1].copy(),D.pen=0,p=y(_+1,or);p!==rr;p=E){if(E=y(p+1,or),Mr=N(wr,er,z,Er,w[p],w[E]),Mr<-.5||(Nr=nr(Mr,wr,er,z,Er),ar=Y(w[p],w[E]),ar===0)||(W=h(w[p],w[E],Nr)/ar,Math.abs(W)>Pr)||X(w[p],w[E],Nr)<0||X(w[E],w[p],Nr)<0)return 1;D.pen+=W*W}for(p=_;p!==rr;p=E){if(E=y(p+1,or),Mr=N(wr,er,z,Er,O.c[p*3+2],O.c[E*3+2]),Mr<-.5||(Nr=nr(Mr,wr,er,z,Er),ar=Y(O.c[p*3+2],O.c[E*3+2]),ar===0)||(W=h(O.c[p*3+2],O.c[E*3+2],Nr)/ar,tr=h(O.c[p*3+2],O.c[E*3+2],w[E])/ar,tr*=.75*O.alpha[E],tr<0&&(W=-W,tr=-tr),W<tr-Pr))return 1;W<tr&&(D.pen+=(W-tr)*(W-tr))}return 0}var t=a.curve,e=t.n,c=t.vertex,f=new Array(e+1),m=new Array(e+1),x=new Array(e+1),A=new Array(e+1),L,n,i,d,M=new o,b,k,F,u,s,K,P,hr=new Array(e),yr=new Array(e+1);for(n=0;n<e;n++)t.tag[n]==="CURVE"?hr[n]=sr(h(c[y(n-1,e)],c[n],c[y(n+1,e)])):hr[n]=0;for(F=0,yr[0]=0,b=t.vertex[0],n=0;n<e;n++)k=y(n+1,e),t.tag[k]==="CURVE"&&(u=t.alpha[k],F+=.3*u*(4-u)*h(t.c[n*3+2],c[k],t.c[k*3+2])/2,F+=h(b,t.c[n*3+2],t.c[k*3+2])/2),yr[n+1]=F;for(f[0]=-1,m[0]=0,x[0]=0,i=1;i<=e;i++)for(f[i]=i-1,m[i]=m[i-1],x[i]=x[i-1]+1,n=i-2;n>=0&&(d=r(a,n,y(i,e),M,T.opttolerance,hr,yr),!d);n--)(x[i]>x[n]+1||x[i]===x[n]+1&&m[i]>m[n]+M.pen)&&(f[i]=n,m[i]=m[n]+M.pen,x[i]=x[n]+1,A[i]=M,M=new o);for(L=x[e],s=new G(L),K=new Array(L),P=new Array(L),i=e,n=L-1;n>=0;n--)f[i]===i-1?(s.tag[n]=t.tag[y(i,e)],s.c[n*3+0]=t.c[y(i,e)*3+0],s.c[n*3+1]=t.c[y(i,e)*3+1],s.c[n*3+2]=t.c[y(i,e)*3+2],s.vertex[n]=t.vertex[y(i,e)],s.alpha[n]=t.alpha[y(i,e)],s.alpha0[n]=t.alpha0[y(i,e)],s.beta[n]=t.beta[y(i,e)],K[n]=P[n]=1):(s.tag[n]="CURVE",s.c[n*3+0]=A[i].c[0],s.c[n*3+1]=A[i].c[1],s.c[n*3+2]=t.c[y(i,e)*3+2],s.vertex[n]=U(A[i].s,t.c[y(i,e)*3+2],c[y(i,e)]),s.alpha[n]=A[i].alpha,s.alpha0[n]=A[i].alpha,K[n]=A[i].s,P[n]=A[i].t),i=f[i];for(n=0;n<L;n++)k=y(n+1,L),s.beta[n]=K[n]/(K[n]+P[k]);s.alphacurve=1,a.curve=s}for(var Xr=0;Xr<R.length;Xr++){var Rr=R[Xr];br(Rr),qr(Rr),Or(Rr),Cr(Rr),Rr.sign==="-"&&$r(Rr),dr(Rr),T.optcurve&&kr(Rr)}typeof v=="function"&&(v(),v=null,R=[])}function Jr(v){if(v&&(j=v),!T.isReady){setTimeout(Jr,100);return}return _r(),Hr(),typeof j=="function"&&j(),j=null,R}function Lr(){q=null,R=[],j=null,T.isReady=!1}function na(v,l=0,S=0,y=1,I=1,H){H&&(R=H);function sr(h){function C(N){var br="C "+(h.c[N*3+0].x*v*y+l).toFixed(3)+" "+(h.c[N*3+0].y*v*I+S).toFixed(3)+",";return br+=(h.c[N*3+1].x*v*y+l).toFixed(3)+" "+(h.c[N*3+1].y*v*I+S).toFixed(3)+",",br+=(h.c[N*3+2].x*v*y+l).toFixed(3)+" "+(h.c[N*3+2].y*v*I+S).toFixed(3)+" ",br}function X(N){var br="L "+(h.c[N*3+1].x*v*y+l).toFixed(3)+" "+(h.c[N*3+1].y*v*I+S).toFixed(3)+" ";return br+=(h.c[N*3+2].x*v*y+l).toFixed(3)+" "+(h.c[N*3+2].y*v*I+S).toFixed(3)+" ",br}var Z=h.n,Y,nr="M"+(h.c[(Z-1)*3+2].x*v*y+l).toFixed(3)+" "+(h.c[(Z-1)*3+2].y*v*I+S).toFixed(3)+" ";for(Y=0;Y<Z;Y++)h.tag[Y]==="CURVE"?nr+=C(Y):h.tag[Y]==="CORNER"&&(nr+=X(Y));return nr}var Ar=R.length,U,g;let V="";for(g=0;g<Ar;g++)U=R[g].curve,V+=sr(U);return V}function oa(v){T.isReady&&Lr(),Q=v,Yr()}function ia(v,l,S=q,y=!0){function I(N){function br(dr){var kr="C "+(N.c[dr*3+0].x*v).toFixed(3)+" "+(N.c[dr*3+0].y*v).toFixed(3)+",";return kr+=(N.c[dr*3+1].x*v).toFixed(3)+" "+(N.c[dr*3+1].y*v).toFixed(3)+",",kr+=(N.c[dr*3+2].x*v).toFixed(3)+" "+(N.c[dr*3+2].y*v).toFixed(3)+" ",kr}function qr(dr){var kr="L "+(N.c[dr*3+1].x*v).toFixed(3)+" "+(N.c[dr*3+1].y*v).toFixed(3)+" ";return kr+=(N.c[dr*3+2].x*v).toFixed(3)+" "+(N.c[dr*3+2].y*v).toFixed(3)+" ",kr}var Or=N.n,Cr,$r="M"+(N.c[(Or-1)*3+2].x*v).toFixed(3)+" "+(N.c[(Or-1)*3+2].y*v).toFixed(3)+" ";for(Cr=0;Cr<Or;Cr++)N.tag[Cr]==="CURVE"?$r+=br(Cr):N.tag[Cr]==="CORNER"&&($r+=qr(Cr));return $r}var H=S.w*v,sr=S.h*v,Ar=R.length,U,g,V,h,C,X=[];l==="curve"?(V="black",h="none",C=""):(V="none",h="black",C=' fill-rule="evenodd"');var Z='<svg id="svg" version="1.1" width="'+H+'" height="'+sr+'" xmlns="http://www.w3.org/2000/svg"><path d="',Y='" stroke="'+V+'" fill="'+h+'"'+C+"/></svg>",nr=Z;for(g=0;g<Ar;g++){U=R[g].curve;const N=I(U);X.push(`${Z}${N}${Y}`),nr+=N}return nr+=Y,y?nr:X}return{loadImageFromFile:lr,loadImageFromUrl:pr,loadImageFromGray:ir,setParameter:gr,process:Jr,getTransformPath:na,loadImageFromCanvas:oa,loadImageFromGrayAlpha:vr,getSVG:ia,processPath:Hr,bmToPathlist:_r,img:B,pathlist:R,Bitmap:Fr}}();class zr{constructor(G){G&&this.setup(G)}setup(G){self.addEventListener("message",async B=>{const{type:Q,pid:q,params:R}=B.data,T=await G[Q].apply(null,R);B.ports[0].postMessage({success:!0,pid:q,data:T})}),self.addEventListener("messageerror",async B=>{B.ports[0].postMessage({success:!1,data:null})})}}const jr=$=>{const G={};for(let B=0;B<$.data.length;B+=4){const Q=$.data[B],q=$.data[B+1],R=$.data[B+2];if($.data[B+3]===0)continue;const T=`${Q},${q},${R}`;.2126*Q+.7153*q+.0721*R<180&&(G[T]?G[T].push(B):G[T]=[B])}return G},ra=($,G)=>{const B=new Map,Q=(ir,vr)=>{const lr=Array.from(ir.keys());let pr="";for(let gr=0;gr<lr.length;gr++)if(Zr(vr,lr[gr],G)){pr=lr[gr];break}return pr},R=(ir=>{const vr=Object.entries(ir);vr.sort(function(pr,gr){return gr[1].length-pr[1].length});const lr=new Map;for(const pr of vr)lr.set(pr[0],pr[1]);return lr})($);return Array.from(R.keys()).reduce((ir,vr)=>{var pr;const lr=Q(ir,vr);if(!lr)ir.set(vr,R.get(vr)||[]);else{const gr=((pr=ir.get(lr))==null?void 0:pr.concat(R.get(vr)||[]))||[];ir.set(lr,gr)}return ir},B)},aa=($,G,B)=>{const Q={},q=Array.from($.keys());for(let R=0;R<q.length;R++){const j=new Vr.Bitmap(G,B),T=q[R],ir=$.get(T)||[];for(let vr=0;vr<ir.length;vr++){const lr=ir[vr];j.data[lr/4]=1}Q[T]=j}return Q},ta={imageDataToBitmap:($,G,B,Q)=>{const q=jr($),R=ra(q,G);return aa(R,B,Q)},findPath:($,G,B,Q)=>($=(R=>{const j=new Vr.Bitmap(R.w,R.h);return j.data=R.data,j})($),new Promise(R=>{Vr.setParameter({aberrationThreshold:G,turdsize:B,alphamax:Q}),Vr.bmToPathlist($),Vr.processPath(()=>{const j=Vr.getSVG(1,"curve",$,!1);R(j)})}))};new zr(ta)})();
